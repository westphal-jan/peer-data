{"id": "0810.4401", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "24-Oct-2008", "title": "Efficient Exact Inference in Planar Ising Models", "abstract": "We give polynomial-time algorithms for the exact computation of lowest-energy (ground) states, worst margin violators, partition functions, and marginal probabilities in certain binary undirected graphical models. Our approach provides an interesting alternative to the well-known graph cut paradigm in that it does not impose any submodularity constraints; instead we require planarity to establish a correspondence with perfect matchings (dimer coverings) in an expanded dual graph. We implement a unified framework while delegating complex but well-understood subproblems (planar embedding, maximum-weight perfect matching) to established algorithms for which efficient implementations are freely available. Unlike graph cut methods, we can perform penalized maximum-likelihood as well as maximum-margin parameter estimation in the associated conditional random fields (CRFs), and employ marginal probabilities as well as maximum a posteriori (MAP) states for prediction. Maximum-margin CRF parameter estimation on image denoising and segmentation problems shows our approach to be efficient and effective.", "histories": [["v1", "Fri, 24 Oct 2008 08:49:09 GMT  (685kb,DS)", "http://arxiv.org/abs/0810.4401v1", null], ["v2", "Wed, 17 Dec 2008 06:47:01 GMT  (937kb,DS)", "http://arxiv.org/abs/0810.4401v2", "Fixed a number of bugs in v1; added 10 pages of additional figures, explanations, proofs, and experiments"]], "reviews": [], "SUBJECTS": "cs.LG cs.CV stat.ML", "authors": ["nicol n schraudolph", "dmitry kamenetsky"], "accepted": true, "id": "0810.4401"}, "pdf": {"name": "0810.4401.pdf", "metadata": {"source": "CRF", "title": "Efficient Exact Inference in Planar Ising Models", "authors": ["Nicol N. Schraudolph", "Dmitry Kamenetsky"], "emails": ["nic@schraudolph.org", "dmitry.kamenetsky@nicta.com.au"], "sections": [{"heading": "1. Introduction", "text": "Undirected graphical models are a popular tool in machine learning; they represent the reevaluated power functions of formE \"(y): = \u2211 i\" V \"E\" i (yi) + \u2211 (i, j) \"E\" ij (yi, yj), (1) where the terms range in the first sum over the nodes V = {1, 2,.. n} 2007 2007, and those in the second sum over the edges 2007 2007 2007 2007 2007 V \"2007 2007\" V \"ij (yi, yj).The composition of the node tree provides an efficient framework for exact statistical conclusions in graphs 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 V\" 2007 2007 \"ij (yi, yj).The composition of the node tree 2009 2009 2009 2009 provides an efficient framework for exact statistical conclusions in graphs that trees are smaller cliffs (or can be certified into trees).The resulting algorithms require however time exponentially in 2007 2007 2007 2007 2007 V\" V \"ij (yi, yi) 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007. The tree composition provides an efficient framework for exact statistical conclusions in graphs that trees are smaller cliffs (or trees) 2007 2007 2007 2007 2007 2007. The resulting algorithms 2003 2003 2003 2003 2003\" 2001 2001 2001 2001 2001 2001 2001 2001 2001, i.e. The tree width of the original graph, 81, The tree width of many graphs of practical interest is prohibitively large - for example, for example it grows as O (n) 2003 2003 2003 2003 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 2001, 81, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001,"}, {"heading": "1.1 The Ising Model", "text": "Effective exact conclusion is possible in certain graphical models with binary node names. Here, we focus on Ising models whose energy functions are of the form E: {0, 1} n \u2192 R withE (y): = \u2211 (i, j).E [yi 6 = yj] Eij, (2) where [\u00b7] denotes the indicator function, i.e., the cost of Eij occurs only in states where yi and yj differ. Compared to the general model (1) for binary nodes, (2) there are two additional constraints: zero node energies and edge energies in the form of discrepancy costs. At first glance, these constraints look severe; for example, such systems must obey to the symmetry E (y) = E (\u00ac y), whereby \u00ac y denotes the Boolean negation (one'variable).However, it is known that the addition of a single node model makes the general model (Isy) strong (as)."}, {"heading": "1.2 Energy Minimization via Graph Cuts", "text": "Definition 2 The section C of a binary graphical model G (V, E) induced by the state y > edge 2001 < 0, 1} n is the set C (y): = {(i, j), E: yi 6 = yj}; its weight | C (y) | is the sum of the edge weights of its edges.Each given state y divides the nodes of a binary graphical model into two sets: those designated as \"0\" and those designated as \"1.\" The corresponding graph section is the sum of the edges traversing the partition; since only they contribute discrepancy costs to the output model (2), we must label the edge weights y: | C (y) | = E (y). The lowest energy state of an output model therefore induces its minimally weight-reduced section. Minimum weight-reduced sections can be calculated in polynomial time in graphs whose edge weights are not all negative."}, {"heading": "2. Planarity", "text": "Unlike diagram intersection methods, the inference algorithms described below do not depend on submodularity; instead, they require the model graph to be planar and to be planar embedded. In this section, we review these concepts and discuss the implications for our approach."}, {"heading": "2.1 Embedding Planar Graphs", "text": "In topological graphics, this is formalized in the conception of a rotation system (White and Beineke, 1978, p. 21f): Definition 4 Let G (V, E) be an undirected, connected graph. For each vertex theory, let Ei denote the set of edges in E incident (V, E) be an undirected, connected graph. In topological graphics theory, this is formalized in the conception of a rotation system (White and Beineke, 1978, p. 21f): Definition 4 Let G (V, E) be an undirected, connected graph."}, {"heading": "2.2 The Planarity Constraint", "text": "In Section 1.1, we have assigned a general binary graphical model to an Ising model with an additional bias node; now we require that this Ising model be planar. What does this mean for the original, general model? If all the nodes of the graph are to be connected to the bias node without violating the planarity, the graph must be outer planar, i.e., have a planar embedding in which all its nodes are on the outside - a very strict limitation. However, the situation improves if we do not insist that all nodes are connected to the bias: If only a subset of B-V of nodes has a non-zero bias (4), then the graph must have only B-outer embedding, i.e., a planar embedding in which all nodes in B are on the same surface. The model selection can therefore include the step of selecting an appropriately embedded planar Ising model whose node is connected to the bias node."}, {"heading": "3. Computing Ground States via Maximum-Weight Perfect Matching", "text": "Definition 7 A frustrated cycle O'E of a graph G (V, E) of 1961 with non-zero edge weights w is a simple cycle whose product of edge weights is negative, i.e. a simple cycle is a closed path with no repeated edges or corners.) A weighted graph is called frustrated if it contains frustrated cycles. Note that trees can never be frustrated because they do not contain cycles to begin with. The low-energy (bottom) state y: = argminy E (y) of an unfrustrated output model is easy to find by labeling nodes as we traverse the graph by flipping our binary label whenever we traverse an edge with negative discrepancy costs (as algorithm 1 below has done when called on the intersection C = (i, j)."}, {"heading": "3.1 The Expanded Dual Graph", "text": "Definition 8 The dual G graph (F, E) of an embedded graph G (V > q, E) therefore has a vertex for each face of G, with edges connecting vertices corresponding to adjacent faces (i.e. dividing an edge). Figure 3 (top left) shows the dual for a square face of our plane graph. However, since the nodes in the dual are different, we will (with some misuse of notation) use a single index for two edges and their weights corresponding to the index of the original edge in an arbitrary order of E. Thus, if (i, j) is the kest edge in the (ordered) E, the double edge in the (explicit) form becomes Ek: = Eij."}, {"heading": "3.2 Complementary Perfect Matchings", "text": "Definition 9 A perfect agreement of a graph G (V, E) is therefore a subset M'E of edges in which exactly one edge falls on each vertex. (V, E, E) There is at least one (G) perfect agreement with the weights of its edges. (E) For each section C of an embedded graph G (V, E) there is at least one (G) perfect agreement with its extended dual complementary to C, i.e., E\\ M = C.Proof sketches the complementary E\\ C of the section as a partial agreement of the extended dual."}, {"heading": "3.3 Computing the Ground State", "text": "The Flower Shrinkage Algorithm (Edmonds, 1965a, b) is a sophisticated method for efficiently calculating the perfect match of the maximum weight of a graph. It can be implemented (Mehlhorn and Scha \ufffd fer, 2002) in as little time as O (| E | | V | log | V |) (Galil et al., 1986). Although the Blossom IV code we use (Cook and Rahe, 1999) is asymptotically less efficient - O (| E | V | 2) - we found that it is very fast in practice (Figure 6, left). We can now efficiently calculate the lowest energy state of a planar output model as follows: Find a planar embedding of the model graph (Section 2.1), construct its extended dual (Section 3.1) and run the flower shrinkage algorithm on this basis to calculate its perfect match."}, {"heading": "4. Computing the Partition Function and Marginal Probabilities", "text": "The question we must ask ourselves is whether this is the determinant of a skew-symmetric matrix (Kasteleyn, 1961, 1966), which we can use as the generating function for perfect matrix K. Due to the close relationship with the graph (Section 3.2), we can use this method to calculate Z in (8). First, we convert a planar model of the Ising model into a Boolean matrix."}, {"heading": "4.1 Plane Triangulation", "text": "Definition 12 An embedded graph is plane triangulated iff = 4. Procedure is biconnected and each of its faces (including the external face) is a triangle.Note that plane triangulation is not equivalent to making a graph chordal, although the latter process is sometimes also called \"triangulation.\" For example, the graph in Figure 4a is chordal, but not plane triangulated, because the external face is not triangular, while the one in Figure 4b plane triangulated, but not chordal, because it contains a 4 cycle (bold blue) that does not have a chord.We can plane triangled an embedded graph in linear time by traversing all its faces, inserting chords as necessary as we go along (Algorithm 2).This can generate multiple edges between the same two vertices, as shown in Figure 4c. Care must be taken whencountering single components connected with a perimeter of length two, which could cause the sertion of self-inloop (Figure 4c)."}, {"heading": "4.2 Odd Edge Orientation", "text": "In order to calculate the generating function for perfect assignments, the graph in question (i.e. the extended dual of our model diagram) must be given an odd clockwise orientation. Definition 13 An orientation of an undirected graph G (V, E) is a sentence E \u00b2 oriented edges with | E \u2032 | = | E | such that the number of edges oriented clockwise around each face (except possibly the outer surface) is odd clockwise. Definition 14 (Kasteleyn, 1963) An orientation of an embedded graph is odd clockwise if the number of edges oriented clockwise around each face (except possibly the outer surface) is odd. If we look at Figure 5a: by giving all the inner edges of the 3-clicks of the extended dual an orientation clockwise orientation, we ensure that (a) the inner faces are clockwise, clockwise, all clockwise, all 3-clockwise and clockwise (clockwise)."}, {"heading": "To establish a clockwise odd orientation of the expanded dual, simply orient the edges of the model graph such that all vertices, except possibly one, have an odd in-degree.", "text": "In contrast to earlier constructions (Kasteleyn, 1963; Fisher, 1966; Globerson and Jaakkola, 2007), it does not require subsequent orbits around surfaces and in reality does not refer at all to an embedding of surfaces or a dual graph G \u00b2. Algorithm 3 constructs an odd edge orientation. Input: undirected graph G (V, E) 1. Input: undirected graph G (V, E) 1. Input: undirected graph V: v.visited = wrong; 2. Selection of arbitrary edge (r, s).E \u00b2: = odd (r, s); 4. undirected (r, s); Output: Orientation E \u00b2 of E: in-degree (v).v \u00b2: odd (V, E \u00b2)."}, {"heading": "4.3 Constructing the half-Kasteleyn Bit Matrix", "text": "The Kasteleyn matrix K is an inclined symmetrical matrix constructed from the Ising model diagram, the determinant of which is the square of the partition function. Our construction improves the work of Globerson and Jaakkola (2007) in several ways: \u2022 We use an indexing scheme that eliminates any need to refer to the extended dual of the model diagram (which we therefore do not explicitly construct at all); \u2022 We split the construction of the Kasteleyn matrix into two phases, the first of which is invariant in terms of the discrepancy costs of the model; \u2022 We make the \"half Kasteleyn\" matrix H very compact in the first phase by prefactoring the triangulation edges (see Section 4.4.3) and storing it as a bitmatrix."}, {"heading": "4.3.1 Two-Phase Construction", "text": "In a first phase, we process the structure of the model diagram into a Boolean \"half-Kasteleyn\" matrix H. Discrepancy costs do not flow into H; they are taken into account in a second phase when the full half-Kasteleyn matrix K is constructed from H. This two-phase approach has a number of advantages: \u2022 When working with a large number of isomorphic diagrams (as we do in Section 6), the corresponding half-Kasteleyn matrix must be identical for all of them and must therefore be constructed only once. \u2022 With maximum probability, partition functions and / or margins must be recalculated many times for the same graph, with discrepancy costs varying due to the ongoing adjustment of the model parameters. H remains valid if the discrepancy costs change so that we can only calculate them once in advance, and then reuse them in the parameter estimation loop, as the more compact H cannot be pre-compact, which is very small."}, {"heading": "4.3.2 Indexing Scheme", "text": "Without losing generality, leave E = {e1, e2,.. e | E | E |}. Note that the expanded dual has 2 | E | corners, one on either side of each edge in the model diagram. If we look at the edge ek along its direction in E \u00b2, we label the dual node on the right 2k \u2212 1 and on the left 2k; see Figure 5c for an example. One advantage of this scheme is that sets referring to the edges of the model diagram (as opposed to the inner edges of the cliques of the expanded dual) always refer to the superdiagonal of K. We also expand the rotation system from Section 2.1 to support this indexing scheme: ek = (i, j)."}, {"heading": "4.3.3 Construction Algorithm", "text": "Algorithm 4 constructs H according to the above index scheme in linear time, traversing the edges that meet each vertex of the model diagram once. It deviates from the classic construction of K (Kasteleyn, 1961; Fisher, 1961; Globerson and Jaakkola, 2007) by making only positive entries, and only those that correspond to edges without discrepancy costs, i.e. are added to the cliques of the expanded dual during plane triangulation or internally. All these entries have the value e0 = 1, making H a boolean matrix that can be stored compactly as a bit matrix."}, {"heading": "4.4 Factoring Kasteleyn Matrices", "text": "Standard approaches such as LU factorization can be used to factorize the Kasteleyn matrix K, but not to exploit its skewed symmetry. Here, we develop a numerically stable cholesky-like factorization for uniformly large skewed symmetric matrices that can be used for both the factor K and the prefactor H. Let's start by writing the Kasteleyn matrix asK = 0 c a > \u2212 c 0 b > \u2212 a \u2212 b C, (10) for some scalars c, vectors a and b, and a matrix C that is either empty or the same."}, {"heading": "4.4.1 Partition Function", "text": "Since | R | = 1 and | J | = 1 c 2 i, we have Z = \u221a | K | = \u221a | R > | | J | = \u221a | J | = | E | i = 1 | ci |. (14) The calculation of the product in (14) is susceptible to numerical overflows; this can be easily avoided by directly calculating the log partition function aslnZ = ln \u221a | K | = | E | \u2211 i = 1 ln | ci |. (15)"}, {"heading": "4.4.2 Marginal Probabilities", "text": "To invert K, it can be observed from (12) or (13) that R and J are essentially triangular or diagonal (simply the rows 2k \u2212 1 and 2k, k = 1, 2,... | E |) and are therefore slightly inverted. Then, use K \u2212 1 = R \u2212 1J \u2212 1R \u2212 > to [K \u2212 1] 2k \u2212 1.2k = 2 | E | \u2211 i = 1 2 | E | \u2211 j = 1 [R \u2212 1] 2k \u2212 1, i [J \u2212 1] i, j [R \u2212 >] j, 2k = \u2212 1 ck + | E | \u2211 i = k + 1 dik, (16) where dik: = [R \u2212 1] 2k \u2212 1.2i [R \u2212 1] 2k \u2212 1.2i \u2212 1 [R \u2212 1] 2k \u2212 2k, 2ici."}, {"heading": "4.4.3 Prefactoring", "text": "(Consider the rows and columns of K that correspond to an edge added during triangulation. Re-order K to move those rows and columns to the top left. As the discrepancy cost of a triangulation edge is zero, we now have a unit pivot point c = 1 in (10). This has two interesting consequences: size reduction: the unit pivot point does not affect the value of the partition edge. Since we are not interested in the marginal probability of triangulation edges (which are not part of the original model, after all), we do not need an a or b once we have calculated the Schur complement. We can therefore discard the first two rows and columns of K after factoring (10). If we compare all triangulation edges in this way, the size of K decreases to reach just over the edges of the original issuing model. (This reduces memory consumption and accelerates the subsequent calculation of K after factoring (K)."}, {"heading": "5. Application to CRF Parameter Estimation", "text": "Our algorithms can be applied to regulated maximum probability and maximum margin parameter estimation in conditional random fields (CRFs). In a planar issuing CRF, the discrepancy costs in (2) are calculated as Ek: = \u03b8 > xk, i.e. as inner products between local characteristics (sufficient statistics) xk of the modelled data at each edge k and the corresponding parameters \u03b8 of the model. The conditional distribution P (y | x, \u03b8) (where x represents the union of all local characteristics) is then modelled as Markov random field (8)."}, {"heading": "5.1 Maximum Likelihood", "text": "The estimation of the maximum probability (ML) of the CRF parameters aims to minimize the probability of the L2-regulated negative log likelihoodLML (\u03b8): = 12 x x x 2 \u2212 ln P (y \u0445 | x, \u03b8) = 12 x x x (y \u043a | x) + lnZ (\u03b8 | x) (18) of a given target designation y \u043a, 2 with regulation parameters \u03bb. This is a smooth, convex target that can be optimized by means of batch or online implementation of gradient methods such as LBFGS (Vishwanathan et al., 2006). The gradient of (18) in relation to the Medicare parameters is given by the contribution of the LML (\u03b8) = x-value of the respective edge to the gradient (19)."}, {"heading": "5.2 Maximum Margin", "text": "For maximum margin (MM) parameter estimates (Taskar et al., 2004), we minimize instead LMM (BA) (BA): = 12 x margin (BA) + E (Y) + D (Y) \u2212 min y M (Y), x (20) = 12 x margin (Y) + E (Y) + E (Y) + D (Y), where y (Y) \u2212 d (Y) \u2212 y (Y), x) is the worst margin violator, i.e. the state that in relation to a given target state y \u2212 the margin energy M (Y) \u2212 y (Y) \u2212 d (Y) \u2212 d (Y | y), (21) where d (V) represents a divergence in the state, i.e. the state that in relation to a given target state y \u2212 the margin energy M (Y) \u2212 n (Z) \u2212 n (Z) \u2212 d (Y) \u2212 y | y), (Z), (G) (21), where state space is a divergence in the state space (V)."}, {"heading": "6. Experiments", "text": "We now demonstrate the scalability of our approach to estimating maximum margin CRF parameters (Section 5.2) on two simple image segmentation problems: the synthetic task of double image denociation by Kumar and Hebert (2004, 2006) and the detection of segmentation boundaries in noisy masks from the GrabCut Ground Truth image segmentation database (Rother et al., 2007a)."}, {"heading": "6.1 Synthetic Binary Image Denoising", "text": "Kumar and Hebert (2004, 2006) developed a benchmark binary random field problem based on four hand-drawn images with 64 x 64 pixels (Figure 7, top row).We created 50 instances of each image corrupted with pink noise, produced by merging a white noise image (all pixels i.i.d. equally random) with a Gaussian density of one pixel standard deviation. Original and pink noise images were mixed linearly with signal tonoise (S / N) amplitude ratios of 1: n, n, n, N. Figure 7 shows examples of the resulting noise instances for S / N ratios of 1: 6 (second row) and 1: 7 (fourth row).We then used a 64 x 64-64-square grid (4096 nodes, 8064 edges) planar issuing CRF to denoise the images, using edge energies set on eij."}, {"heading": "6.2 Segmentation Boundary Detection", "text": "To scale our approach further, we designed a simple boundary recognition task based on images from the image segmentation database GrabCut Ground Truth (Rother et al., 2007a). We took 100 x 100 pixel subregions of images representing a segmentation boundary, and corrupted the pink noise segmentation mask created by merging a white noise image (all pixels i.e. equally random) with a Gaussian density with a pixel standard deviation. We then used a planar issuing model to restore the original boundary - namely a 100 x 100 square grid with an additional edge coupled to a high energy, with the prior knowledge that the lower left and upper right corners of the grid represent different regions. AS previously, the energy of the other edges was set to Eij: = < [1, | xi \u2212 xj | the boundary of Comtixxi is small at the node >."}, {"heading": "7. Discussion and Outlook", "text": "We have proposed an alternative algorithmic framework for efficient exact conclusions in binary graphical models that replaces the submodularity constraint of graph intersection methods with a planarity constraint. In addition to being efficient and effective in initial experiments, our approach opens up a number of interesting lines of research that need to be explored: Our algorithms can all be extended to non-planar graphs at an exponential price in the genre of embedding. We are currently developing these extensions, which are proving very useful for graphics that are \"almost\" planar; examples include road networks (where edge crossings occur without ramps) and diagrams that describe the tertiary structure of proteins (Vishwanathan et al., 2007).Our algorithms also provide a basis for efforts to develop efficient non-planetary inference methods."}], "references": [{"title": "On the computational complexity of Ising spin glass models", "author": ["Francisco Barahona"], "venue": "Journal of Physics A: Mathematical, Nuclear and General,", "citeRegEx": "Barahona.,? \\Q1982\\E", "shortCiteRegEx": "Barahona.", "year": 1982}, {"title": "Cholesky-like factorizations of skew-symmetric matrices", "author": ["Peter Benner", "Ralph Byers", "Heike Fassbender", "Volker Mehrmann", "David Watkins"], "venue": "Electronic Transactions on Numerical Analysis,", "citeRegEx": "Benner et al\\.,? \\Q2000\\E", "shortCiteRegEx": "Benner et al\\.", "year": 2000}, {"title": "On the statistical analysis of dirty pictures", "author": ["J. Besag"], "venue": "Journal of the Royal Statistical Society B,", "citeRegEx": "Besag.,? \\Q1986\\E", "shortCiteRegEx": "Besag.", "year": 1986}, {"title": "On the ground states of the frustration model of a spin glass by a matching method of graph theory", "author": ["I. Bieche", "R. Maynard", "R. Rammal", "J.P. Uhry"], "venue": "Journal of Physics A: Mathematical, Nuclear and General,", "citeRegEx": "Bieche et al\\.,? \\Q1980\\E", "shortCiteRegEx": "Bieche et al\\.", "year": 1980}, {"title": "On the cutting edge: Simplified O(n) planarity by edge addition", "author": ["John M. Boyer", "Wendy J. Myrvold"], "venue": "Journal of Graph Algorithms and Applications,", "citeRegEx": "Boyer and Myrvold.,? \\Q2004\\E", "shortCiteRegEx": "Boyer and Myrvold.", "year": 2004}, {"title": "Fast approximate energy minimization via graph cuts", "author": ["Yuri Boykov", "Olga Veksler", "Ramin Zabih"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence,", "citeRegEx": "Boykov et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Boykov et al\\.", "year": 2001}, {"title": "A note on the stable decomposition of skew-symmetric matrices", "author": ["James R. Bunch"], "venue": "Mathematics of Computation,", "citeRegEx": "Bunch.,? \\Q1982\\E", "shortCiteRegEx": "Bunch.", "year": 1982}, {"title": "Computing minimum-weight perfect matchings", "author": ["William Cook", "Andr\u00e9 Rohe"], "venue": "INFORMS Journal on Computing,", "citeRegEx": "Cook and Rohe.,? \\Q1999\\E", "shortCiteRegEx": "Cook and Rohe.", "year": 1999}, {"title": "Paths, trees, and flowers", "author": ["Jack Edmonds"], "venue": "Canadian Journal of Mathematics,", "citeRegEx": "Edmonds.,? \\Q1965\\E", "shortCiteRegEx": "Edmonds.", "year": 1965}, {"title": "Statistical mechanics of dimers on a plane lattice", "author": ["Michael E. Fisher"], "venue": "Physical Review,", "citeRegEx": "Fisher.,? \\Q1961\\E", "shortCiteRegEx": "Fisher.", "year": 1961}, {"title": "On the dimer solution of planar Ising models", "author": ["Michael E. Fisher"], "venue": "Journal of Mathematical Physics,", "citeRegEx": "Fisher.,? \\Q1966\\E", "shortCiteRegEx": "Fisher.", "year": 1966}, {"title": "An O(EV logV ) algorithm for finding a maximal weighted matching in general graphs", "author": ["Zvi Galil", "Silvio Micali", "Harold N. Gabow"], "venue": "SIAM Journal of Computing,", "citeRegEx": "Galil et al\\.,? \\Q1986\\E", "shortCiteRegEx": "Galil et al\\.", "year": 1986}, {"title": "Approximate inference using planar graph decomposition", "author": ["Amir Globerson", "Tommi Jaakkola"], "venue": "Advances in Neural Information Processing Systems 19,", "citeRegEx": "Globerson and Jaakkola.,? \\Q2007\\E", "shortCiteRegEx": "Globerson and Jaakkola.", "year": 2007}, {"title": "Exact maximum a posteriori estimation for binary images", "author": ["D.M. Greig", "B.T. Porteous", "A.H. Seheult"], "venue": "Journal of the Royal Statistical Society B,", "citeRegEx": "Greig et al\\.,? \\Q1989\\E", "shortCiteRegEx": "Greig et al\\.", "year": 1989}, {"title": "Graph embedding with minimum depth and maximum external face", "author": ["Carsten Gutwenger", "Petra Mutzel"], "venue": "Graph Drawing 2003,", "citeRegEx": "Gutwenger and Mutzel.,? \\Q2004\\E", "shortCiteRegEx": "Gutwenger and Mutzel.", "year": 2004}, {"title": "From fields to trees", "author": ["F. Hamze", "N. de Freitas"], "venue": "In Uncertainty in Artificial Intelligence (UAI),", "citeRegEx": "Hamze and Freitas.,? \\Q2004\\E", "shortCiteRegEx": "Hamze and Freitas.", "year": 2004}, {"title": "Kasteleyn. The statistics of dimers on a lattice: I. the number of dimer arrangements on a quadratic lattice", "author": ["W. Pieter"], "venue": null, "citeRegEx": "Pieter,? \\Q1961\\E", "shortCiteRegEx": "Pieter", "year": 1961}, {"title": "Kasteleyn. Dimer statistics and phase transitions", "author": ["W. Pieter"], "venue": "Journal of Mathematical Physics,", "citeRegEx": "Pieter,? \\Q1963\\E", "shortCiteRegEx": "Pieter", "year": 1963}, {"title": "Kasteleyn. Graph theory and crystal physics", "author": ["W. Pieter"], "venue": "Graph Theory and Theoretical Physics,", "citeRegEx": "Pieter,? \\Q1967\\E", "shortCiteRegEx": "Pieter", "year": 1967}, {"title": "Minimizing nonsubmodular functions with graph cuts \u2013 a review", "author": ["Vladimir Kolmogorov", "Carsten Rother"], "venue": "IEEE Trans. Pattern Analysis and Machine Intelligence,", "citeRegEx": "Kolmogorov and Rother.,? \\Q2007\\E", "shortCiteRegEx": "Kolmogorov and Rother.", "year": 2007}, {"title": "What energy functions can be minimized via graph cuts", "author": ["Vladimir Kolmogorov", "Ramin Zabih"], "venue": "IEEE Trans. Pattern Analysis and Machine Intelligence,", "citeRegEx": "Kolmogorov and Zabih.,? \\Q2004\\E", "shortCiteRegEx": "Kolmogorov and Zabih.", "year": 2004}, {"title": "Discriminative fields for modeling spatial dependencies in natural images", "author": ["Sanjiv Kumar", "Martial Hebert"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Kumar and Hebert.,? \\Q2004\\E", "shortCiteRegEx": "Kumar and Hebert.", "year": 2004}, {"title": "Discriminative random fields", "author": ["Sanjiv Kumar", "Martial Hebert"], "venue": "International Journal of Computer Vision,", "citeRegEx": "Kumar and Hebert.,? \\Q2006\\E", "shortCiteRegEx": "Kumar and Hebert.", "year": 2006}, {"title": "GrabCut ground truth database", "author": ["C. Rother", "V. Kolmogorov", "A. Blake", "M. Brown"], "venue": "http: //research.microsoft.com/vision/cambridge/i3l/segmentation/GrabCut.htm,", "citeRegEx": "Rother et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Rother et al\\.", "year": 2007}, {"title": "Optimizing binary MRFs via extended roof duality", "author": ["Carsten Rother", "Vladimir Kolmogorov", "Victor Lempitsky", "Martin Szummer"], "venue": "In Proc. IEEE Conf. Computer Vision and Pattern Recognition,", "citeRegEx": "Rother et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Rother et al\\.", "year": 2007}, {"title": "A version of the bundle idea for minimizing a nonsmooth function: Conceptual idea, convergence analysis, numerical results", "author": ["Helga Schramm", "Jochem Zowe"], "venue": "SIAM J. Optimization,", "citeRegEx": "Schramm and Zowe.,? \\Q1992\\E", "shortCiteRegEx": "Schramm and Zowe.", "year": 1992}, {"title": "Max-margin Markov networks", "author": ["B. Taskar", "C. Guestrin", "D. Koller"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Taskar et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Taskar et al\\.", "year": 2004}, {"title": "Matching Kasteleyn cities for spin glass ground states", "author": ["Creighton K. Thomas", "A. Alan Middleton"], "venue": "Physical Review B,", "citeRegEx": "Thomas and Middleton.,? \\Q2007\\E", "shortCiteRegEx": "Thomas and Middleton.", "year": 2007}, {"title": "Accelerated training conditional random fields with stochastic gradient methods", "author": ["S.V.N. Vishwanathan", "Nicol N. Schraudolph", "Mark Schmidt", "Kevin Murphy"], "venue": "In Proc. Intl. Conf. Machine Learning,", "citeRegEx": "Vishwanathan et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Vishwanathan et al\\.", "year": 2006}, {"title": "Fast computation of graph kernels", "author": ["S.V.N. Vishwanathan", "Karsten Borgwardt", "Nicol N. Schraudolph"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Vishwanathan et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Vishwanathan et al\\.", "year": 2007}, {"title": "Tree-based reparameterization framework for analysis of sum-product and related algorithms", "author": ["Martin J. Wainwright", "Tommi S. Jaakkola", "Alan S. Willsky"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Wainwright et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Wainwright et al\\.", "year": 2003}, {"title": "A new class of upper bounds on the log partition function", "author": ["Martin J. Wainwright", "Tommi S. Jaakkola", "Alan S. Willsky"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Wainwright et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Wainwright et al\\.", "year": 2005}, {"title": "Comparing the mean field method and belief propagation for approximate inference in MRFs", "author": ["Yair Weiss"], "venue": "Advanced Mean Field Methods. MIT Press,", "citeRegEx": "Weiss.,? \\Q2001\\E", "shortCiteRegEx": "Weiss.", "year": 2001}, {"title": "Topological graph theory", "author": ["Arthur T. White", "Lowell W. Beineke"], "venue": "Selected Topics in Graph Theory,", "citeRegEx": "White and Beineke.,? \\Q1978\\E", "shortCiteRegEx": "White and Beineke.", "year": 1978}, {"title": "Planar graph functions for the boost graph library. C++ source code, boost file vault: http://boost-consulting.com/vault/index.php?directory=Algorithms/graph", "author": ["Aaron Windsor"], "venue": null, "citeRegEx": "Windsor.,? \\Q2007\\E", "shortCiteRegEx": "Windsor.", "year": 2007}, {"title": "Understanding belief propagation and its generalizations", "author": ["J.S. Yedidia", "W.T. Freeman", "Y. Weiss"], "venue": "Science & Technology Books,", "citeRegEx": "Yedidia et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Yedidia et al\\.", "year": 2003}], "referenceMentions": [{"referenceID": 2, "context": "A large number of approximate inference techniques have been developed so as to deal with such graphs, such as pseudolikelihood (Besag, 1986), mean field approximation, loopy belief propagation (Weiss, 2001; ar X iv :0 81 0.", "startOffset": 128, "endOffset": 141}, {"referenceID": 19, "context": ") We note that a more elaborate construction can give partial answers in graphs with some negative edge weights (Kolmogorov and Rother, 2007; Rother et al., 2007b), and that a sequence of expansion moves (energy minimizations in binary graphs) can efficiently yield an approximate answer for graphs with discrete but non-binary node labels (Boykov et al.", "startOffset": 112, "endOffset": 163}, {"referenceID": 5, "context": ", 2007b), and that a sequence of expansion moves (energy minimizations in binary graphs) can efficiently yield an approximate answer for graphs with discrete but non-binary node labels (Boykov et al., 2001).", "startOffset": 185, "endOffset": 206}, {"referenceID": 12, "context": "The now widespread use of graph cuts in machine learning to find lowest-energy configurations, in particular in image processing, was pioneered by Greig et al. (1989). Our construction (Figure 1c) differs from that of Kolmogorov and Zabih (2004) (Figure 1d) in that we do not employ the notion of directed edges.", "startOffset": 147, "endOffset": 167}, {"referenceID": 12, "context": "The now widespread use of graph cuts in machine learning to find lowest-energy configurations, in particular in image processing, was pioneered by Greig et al. (1989). Our construction (Figure 1c) differs from that of Kolmogorov and Zabih (2004) (Figure 1d) in that we do not employ the notion of directed edges.", "startOffset": 147, "endOffset": 246}, {"referenceID": 4, "context": "Source code for this step is freely available (Boyer and Myrvold, 2004; Windsor, 2007).", "startOffset": 46, "endOffset": 86}, {"referenceID": 34, "context": "Source code for this step is freely available (Boyer and Myrvold, 2004; Windsor, 2007).", "startOffset": 46, "endOffset": 86}, {"referenceID": 4, "context": "the algorithm of Boyer and Myrvold (2004) which, given any connected graph G as input, produces in linear time either a planar embedding for G or a proof that G is non-planar.", "startOffset": 17, "endOffset": 42}, {"referenceID": 14, "context": "In general, a planar embedding which maximizes a weighted sum over the nodes bordering a given face can be found in linear time (Gutwenger and Mutzel, 2004); by setting node weights to some measure of their bias, such as the magnitude or square of E0i (4), we can thus efficiently obtain the planar Ising model closest (in that measure) to any given planar binary graphical model.", "startOffset": 128, "endOffset": 156}, {"referenceID": 0, "context": "The presence of frustration unfortunately makes the computation of ground states much harder \u2014 in fact, it is known to be NP-hard in general (Barahona, 1982).", "startOffset": 141, "endOffset": 157}, {"referenceID": 0, "context": "The presence of frustration unfortunately makes the computation of ground states much harder \u2014 in fact, it is known to be NP-hard in general (Barahona, 1982). As shown below, the ground state of a planar Ising model can be computed in polynomial time via maximumweight perfect matching on an expanded dual of its embedded graph. A relationship between the states of a planar Ising model and perfect matchings (\u201cdimer coverings\u201d to physicists) was first established by Kasteleyn (1961, 1963, 1967) and Fisher (1961, 1966). Perfect matchings in dual graph constructs were used by Bieche et al. (1980) and Barahona (1982) to compute Ising ground states; below we generalize a simpler construction for triangulated graphs due to Globerson and Jaakkola (2007).", "startOffset": 142, "endOffset": 599}, {"referenceID": 0, "context": "The presence of frustration unfortunately makes the computation of ground states much harder \u2014 in fact, it is known to be NP-hard in general (Barahona, 1982). As shown below, the ground state of a planar Ising model can be computed in polynomial time via maximumweight perfect matching on an expanded dual of its embedded graph. A relationship between the states of a planar Ising model and perfect matchings (\u201cdimer coverings\u201d to physicists) was first established by Kasteleyn (1961, 1963, 1967) and Fisher (1961, 1966). Perfect matchings in dual graph constructs were used by Bieche et al. (1980) and Barahona (1982) to compute Ising ground states; below we generalize a simpler construction for triangulated graphs due to Globerson and Jaakkola (2007).", "startOffset": 142, "endOffset": 619}, {"referenceID": 0, "context": "The presence of frustration unfortunately makes the computation of ground states much harder \u2014 in fact, it is known to be NP-hard in general (Barahona, 1982). As shown below, the ground state of a planar Ising model can be computed in polynomial time via maximumweight perfect matching on an expanded dual of its embedded graph. A relationship between the states of a planar Ising model and perfect matchings (\u201cdimer coverings\u201d to physicists) was first established by Kasteleyn (1961, 1963, 1967) and Fisher (1961, 1966). Perfect matchings in dual graph constructs were used by Bieche et al. (1980) and Barahona (1982) to compute Ising ground states; below we generalize a simpler construction for triangulated graphs due to Globerson and Jaakkola (2007). Working independently, Thomas and Middleton (2007) arrived at the same construction as we did, though their algorithm to compute ground states is less straightforward.", "startOffset": 142, "endOffset": 755}, {"referenceID": 0, "context": "The presence of frustration unfortunately makes the computation of ground states much harder \u2014 in fact, it is known to be NP-hard in general (Barahona, 1982). As shown below, the ground state of a planar Ising model can be computed in polynomial time via maximumweight perfect matching on an expanded dual of its embedded graph. A relationship between the states of a planar Ising model and perfect matchings (\u201cdimer coverings\u201d to physicists) was first established by Kasteleyn (1961, 1963, 1967) and Fisher (1961, 1966). Perfect matchings in dual graph constructs were used by Bieche et al. (1980) and Barahona (1982) to compute Ising ground states; below we generalize a simpler construction for triangulated graphs due to Globerson and Jaakkola (2007). Working independently, Thomas and Middleton (2007) arrived at the same construction as we did, though their algorithm to compute ground states is less straightforward.", "startOffset": 142, "endOffset": 807}, {"referenceID": 11, "context": "It can be implemented (Mehlhorn and Sch\u00e4fer, 2002) to run in as little as O(|E| |V| log |V|) time (Galil et al., 1986).", "startOffset": 98, "endOffset": 118}, {"referenceID": 7, "context": "Although the Blossom IV code we are using (Cook and Rohe, 1999) is asymptotically less efficient \u2014O(|E| |V|2) \u2014 we have found it to be very fast in practice (Figure 6, left).", "startOffset": 42, "endOffset": 63}, {"referenceID": 10, "context": "Our Step 2 simplifies equivalent operations in previous constructions (Kasteleyn, 1963, 1967; Fisher, 1966; Globerson and Jaakkola, 2007), Step 3 differs in that it only sets unit (i.", "startOffset": 70, "endOffset": 137}, {"referenceID": 12, "context": "Our Step 2 simplifies equivalent operations in previous constructions (Kasteleyn, 1963, 1967; Fisher, 1966; Globerson and Jaakkola, 2007), Step 3 differs in that it only sets unit (i.", "startOffset": 70, "endOffset": 137}, {"referenceID": 9, "context": "We can now factor K and compute the partition function as Z = \u221a |K| (Kasteleyn, 1961; Fisher, 1961).", "startOffset": 68, "endOffset": 99}, {"referenceID": 10, "context": "Previously (Fisher, 1966; Globerson and Jaakkola, 2007) this convencience came at a computational price: the edges added during plane triangulation can make factoring and inversion of K (Section 4.", "startOffset": 11, "endOffset": 55}, {"referenceID": 12, "context": "Previously (Fisher, 1966; Globerson and Jaakkola, 2007) this convencience came at a computational price: the edges added during plane triangulation can make factoring and inversion of K (Section 4.", "startOffset": 11, "endOffset": 55}, {"referenceID": 12, "context": "Our construction improves upon the work of Globerson and Jaakkola (2007) in a number of ways: \u2022 We employ an indexing scheme that obviates any need to refer to the expanded dual of the model graph (which we consequently never explicitly construct at all); \u2022 We break construction of the Kasteleyn matrix into two phases, the first of which is invariant with respect to the model\u2019s disagreement costs; \u2022 We make the \u201chalf-Kasteleyn\u201d matrix H computed in the first phase very compact by prefactoring out the triangulation edges (see Section 4.", "startOffset": 43, "endOffset": 73}, {"referenceID": 7, "context": "Left: MAP state calculated via Blossom IV (Cook and Rohe, 1999) on original, triangulated, and octangulated ring.", "startOffset": 42, "endOffset": 63}, {"referenceID": 9, "context": "It deviates from the classical construction of K (Kasteleyn, 1961; Fisher, 1961; Globerson and Jaakkola, 2007) in that it makes only positive entries, and only those corresponding to edges with zero disagreement cost, i.", "startOffset": 49, "endOffset": 110}, {"referenceID": 12, "context": "It deviates from the classical construction of K (Kasteleyn, 1961; Fisher, 1961; Globerson and Jaakkola, 2007) in that it makes only positive entries, and only those corresponding to edges with zero disagreement cost, i.", "startOffset": 49, "endOffset": 110}, {"referenceID": 1, "context": "We factor (10) into (cf. Bunch, 1982; Benner et al., 2000) K = \uf8ee\uf8f0 0 \u22121 0> 1 0 0> a/c b/c I \uf8f9\uf8fb\uf8ee\uf8f0 0 c 0> \u2212c 0 0> 0 0 C\u2032 \uf8f9\uf8fb\uf8ee\uf8f0 0 1 a>/c \u22121 0 b>/c 0 0 I \uf8f9\uf8fb , (11)", "startOffset": 20, "endOffset": 58}, {"referenceID": 28, "context": "This is a smooth, convex objective that can be optimized via batch or online implementations of gradient methods such as LBFGS (Vishwanathan et al., 2006).", "startOffset": 127, "endOffset": 154}, {"referenceID": 26, "context": "2 Maximum Margin For maximum-margin (MM) parameter estimation (Taskar et al., 2004) we instead minimize LMM(\u03b8) := 1 2 \u03bb\u2016\u03b8\u2016 2 + E(y\u2217|x,\u03b8)\u2212min y M(y|y\u2217,x,\u03b8) (20) = 12 \u03bb\u2016\u03b8\u2016 2 + E(y\u2217|x,\u03b8)\u2212 E(\u0177|x,\u03b8) + d(\u0177|y\u2217), where \u0177 := argminy M(y|y\u2217,x,\u03b8) is the worst margin violator, i.", "startOffset": 62, "endOffset": 83}, {"referenceID": 25, "context": "We can minimize (20) via bundle methods, such as the BT bundle trust algorithm (Schramm and Zowe, 1992), making use of the convenient lower bound \u2200\u03b8 : LMM(\u03b8) \u2265 0.", "startOffset": 79, "endOffset": 103}, {"referenceID": 27, "context": "Thomas and Middleton (2007) employ a similar approach to obtain the ground state from a given state y\u2217 by setting up an isomorphic Ising model with disagreement costs (1\u2212 2 [k \u2208 C(y)])Ek.", "startOffset": 0, "endOffset": 28}, {"referenceID": 29, "context": "We are currently developing these extensions, which may prove of great practical value for graphs that are \u201calmost\u201d planar; examples include road networks (where edge crossings arise from overpasses without on-ramps) and graphs describing the tertiary structure of proteins (Vishwanathan et al., 2007).", "startOffset": 274, "endOffset": 301}, {"referenceID": 19, "context": "The QPBO graph cut method (Kolmogorov and Rother, 2007) finds ground states that do not contain any frustrated cycles, and otherwise yields a partial labeling.", "startOffset": 26, "endOffset": 55}], "year": 2017, "abstractText": "We give polynomial-time algorithms for the exact computation of lowest-energy (ground) states, worst margin violators, partition functions, and marginal probabilities in certain binary undirected graphical models. Our approach provides an interesting alternative to the well-known graph cut paradigm in that it does not impose any submodularity constraints; instead we require planarity to establish a correspondence with perfect matchings (dimer coverings) in an expanded dual graph. We implement a unified framework while delegating complex but well-understood subproblems (planar embedding, maximum-weight perfect matching) to established algorithms for which efficient implementations are freely available. Unlike graph cut methods, we can perform penalized maximum-likelihood as well as maximum-margin parameter estimation in the associated conditional random fields (CRFs), and employ marginal probabilities as well as maximum a posteriori (MAP) states for prediction. Maximum-margin CRF parameter estimation on image denoising and segmentation problems shows our approach to be efficient and effective.", "creator": "LaTeX with hyperref package"}}}