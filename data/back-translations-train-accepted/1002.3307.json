{"id": "1002.3307", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "17-Feb-2010", "title": "Graph Zeta Function in the Bethe Free Energy and Loopy Belief Propagation", "abstract": "We propose a new approach to the analysis of Loopy Belief Propagation (LBP) by establishing a formula that connects the Hessian of the Bethe free energy with the edge zeta function. The formula has a number of theoretical implications on LBP. It is applied to give a sufficient condition that the Hessian of the Bethe free energy is positive definite, which shows non-convexity for graphs with multiple cycles. The formula clarifies the relation between the local stability of a fixed point of LBP and local minima of the Bethe free energy. We also propose a new approach to the uniqueness of LBP fixed point, and show various conditions of uniqueness.", "histories": [["v1", "Wed, 17 Feb 2010 17:55:58 GMT  (80kb)", "http://arxiv.org/abs/1002.3307v1", "19 pages, Annual Conference on Neural Information Processing Systems (NIPS 2009), together with the supplementary material"]], "COMMENTS": "19 pages, Annual Conference on Neural Information Processing Systems (NIPS 2009), together with the supplementary material", "reviews": [], "SUBJECTS": "cs.AI cs.DM math-ph math.MP", "authors": ["yusuke watanabe", "kenji fukumizu"], "accepted": true, "id": "1002.3307"}, "pdf": {"name": "1002.3307.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": ["watay@ism.ac.jp", "fukumizu@ism.ac.jp"], "sections": [{"heading": null, "text": "ar Xiv: 100 2.33 07v1 [cs.AI] 17 Fe"}, {"heading": "1 Introduction", "text": "Pearl by pearl, pearl by pearl, pearl by pearl, pearl by pearl, pearl by pearl, pearl by pearl, pearl by pearl, pearl by pearl."}, {"heading": "2 Loopy belief propagation algorithm and the Bethe free energy", "text": "In this article we focus on binary variables, i.e., we assume that the probability distribution over the proposition of variables x = (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i) i (xi) i (xi) i) i (xi) i (xi) i (xi) i (xi) i) xi (xi) i (xi) xi (xi) i (xi) xi (xi) i (xi) i) xi (xi) i (xi) xi) i (xi) i (xi) xi (xi) i (xi) i (xi) (xi) i (xi) i (i) (xi) i (xi) i (xi) i (xi) i (xi) (xi) i (xi) i (xi) i (i) (xi) i (xi) i (xi) i (xi) i (xi) (xi) i (xi) i (xi) (xi) i (xi) i (xi) (xi) i (xi) i (xi) (xi) i (xi) i (xi) (xi) i (xi) (xi (xi) i (xi) i (xi) (xi) i (xi) i (xi) (xi) i (xi) i (xi (xi) (xi) i (xi) i (xi) i (xi) (xi (xi) i (xi) i (xi) i (xi) (xi (xi) i (xi) (xi (xi) i (xi) i (xi) i (xi) (xi) i (xi (xi) i (xi) i (xi) i (xi) i (xi) i (xi) i (xi (xi) i (xi) i (xi) i (xi) (xi) i (xi) i (xi (xi) i (xi) i (xi) i (xi) i (xi) i (xi) (xi (xi) (xi (xi) i (xi) i ("}, {"heading": "3 Zeta function and Hessian of Bethe free energy", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1 Zeta function and Ihara\u2019s formula", "text": "For each undirected edge of G, we are a pair of opposing edges that form a series of directed edges. (For each undirected edge of E, o (e), o (e), and V (e), the origin of e and t (e).V is the endpoint of e (e).E (e) is the inverse edge of e (e), and the corresponding undirected edge of e (e).E (e) is a sequence (e1,., ek) of the directed edges, so that t (ei), o (ei), and ei (e) 6 = e (e).Z / kZ. Two closed geodesics are equivalent when achieved by cyclic permutation of the other. An equivalent class of closed geodesics is called a primary cycle when there is no repeated concentration of a closed geodesics."}, {"heading": "3.2 Main formula", "text": "Theorem 3 (main formula) \u2212 The following equality applies at any point of L (G): (3) \u2212 1 =) det (I \u2212 UM) = det (2), where bij and bi by (5) andui \u2192 j: = \u03c7ij \u2212 mimj1 \u2212 m2j. (13) Proof. (Details of the calculation are given in the supplementary material.) From (6) it is easy to see that the (E, E) block of the Hessian formula is a diagonal matrix given by 2F block. (13) Proof. (The detail of the calculation is given in the supplementary material.) From (6) it is easy to see that the (E) block of the Hessian formula is a diagonal matrix given by 2F block."}, {"heading": "4 Application to positive definiteness conditions", "text": "The convexity of the beta-free energy is an important issue, as it guarantees the uniqueness of the fixed point. (Pakzad et al.) [11] and Heskes [5] derive sufficient conditions of the convexity and show that the beta-free energy is convex for trees and graphs with a cycle. (In this section, instead of such a global structure, we will focus on the local structure of the beta-free energy as an application of the main formula. (Theorem 4, Spec (X), C denotes the set of eigenvalues (spectra), and (X) the spectral radius of a matrix X, i.e., the maximum of eigenvalues. (Theorem 4) is the matrix given by (7). For given (mi) that we are given. (G), U is defined by (13)."}, {"heading": "5 Application to stability analysis", "text": "In this section we discuss the spatial stability of LBP and the spatial structure of bethe-free energy as spatially fixed when it is spatially fixed. Heskes [6] shows that a spatially stable fixed point of sufficiently attenuated LBP is a local minimum of bethe-free energy. Reversal is not necessarily generally true, and we will elucidate the gap between these two properties. First, we consider the LBP update to be a dynamic system. Since the model is binary, each message is parameterized with a single parameter, say, \"minimal.\" The state of the LBP algorithms is expressed in spatial stability by identifying it over the duration of E (~ E) and the updating rule (2) with a transform T to C (~ E) that is new."}, {"heading": "6 Application to uniqueness of LBP fixed point", "text": "The uniqueness of the LBP fixed point is a concern of many studies, since the property guarantees that LBP will find the global minimum of the Bethe-free energy when convergence occurs. The most important approaches to the uniqueness of the approach are to consider an equivalent Minimax problem [5], the contraction property of LBP dynamics [17, 18], and to use the Gibbs theory [19]. We will propose a different differential topological approach to this problem. In our approach, in combination with Theorem 3, the following theorem is the basic procedure. Theorem 7. If we apply the theory 2F (q) 6 = 0 for all q (0) -1 (0) then q."}, {"heading": "7 Concluding remarks", "text": "For binary pair models, we show the link between the edge-zeta function and the free energy of Bethe in Theorem 3, in whose proof the multivariable version of the Ihara formula (Theorem 2) is crucial. After the first submission of this paper, we found that Theorem 3 is extended to a more general class of models, including multinomial models and Gaussian models represented by arbitrary factor diagrams. We will discuss the extended formula and its application in a future paper. Some recent research on LBP has suggested the importance of the Zeta function. In connection with the LDPC code, which is an important application of LBP, Koetter et al [21, 22] show the link between pseudo-code words and the edge-zeta function. On the LBP for the Gaussian graphic model, Johnson et al [23] give zeta-like product formulas of the partition function. While this work is not directly related to our work, it is interesting to follow-up."}, {"heading": "Acknowledgements", "text": "This work was partially supported by Grant-in-Aid for JSPS Fellows 20-993 and Grant-in-Aid for Scientific Research (C) 19500249."}, {"heading": "Supplementary Material for", "text": "\"Graph Zeta Function in Bethe Free Energy and"}, {"heading": "Loopy Belief Propagation\u201d", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "Yusuke Watanabe and Kenji Fukumizu, NIPS 2009", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A Proof of Theorem 2", "text": "The proof: First, we define three linear operators O: C (V) \u00b7 C (E), T: C (E) (E), T: C (E) (E) (E), and T: C (E) (E) as follows: (From) (E): f (E) and g: c (E). We see that M = OT (E), because (E) (E) (E) (E) (E): g (E), where f (V) and g (C) (E). We see that M = OT (E), because (E) (E) (E) (E) (E) (E) (E) (E)."}, {"heading": "B Proof of Theorem 3", "text": "B.1 Explicit formula of derivatives of the Bethe free energy yIn the proof of Theorem 3, the graph G = (V, E) is taken to be a simple graph, i.e., there is no multiple edges and loop-edgeFor the proof, we need explicit expressions of the second derivatives of the Bethe free energy. We list them below. The first derivatives of the Bethe Free Energy are F \u2202 mi = \u2212 hi + (1 \u2212 di) 12% xi = \u00b1 1xi log bi (xi) + 14% Ni xi xi xi, xk), xk = \u00b1 1xi log bik (xi, xk), (19) XI F constij = \u2212 Jij + 14% xi xi, xj = \u00b1 1xixj log bij (xi, xj). (20) The second derivatives of the Bethe Free Energy are XI, xxi xi xi xi xi xi xi xi, mj = (1 \u2212 di) 1 mxi xi xi xi xi, mj = (1 \u2212 di) 1 mxi jj + jjjjj = 1 simpler, jjjj = 1 \u043axi, 1 \u043a\u043a\u043axi = 1."}, {"heading": "B.2 Detailed proof of Theorem 3", "text": "Proof. First, note that the Hessian of the Bethe free energy is a square matrix of size N + M: (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F)) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) (2F) ("}, {"heading": "C Proof of Corollary 2", "text": "Here we prove the limit formula in sequence 2.Proof. We can easily verify that ui \u2192 j (t) = t, amounij E xi, xj = \u00b1 1bij (xi, xj) = 4 \u2212 4M (1 \u2212 t) 2M (1 + t) 2M, and that we are able to check the limit formula in its entirety at this interval, followed by t \u2192 1 det (1 \u2212 t) 2F (t) (1 \u2212 t) M + N \u2212 1 = lim t \u00b2 G (u (t) \u2212 1 (1 \u2212 t) M + N \u2212 1 (4 \u2212 4M (1 \u2212 t) 2M (1 + t) 2M2 \u2212 2N + 4M1) \u2212 1 = lim \u00b2 G (t) \u2212 1 (t) \u2212 1 (1 \u2212 t) \u2212 M \u2212 2 \u2212 N (G \u2212 N).M \u2212 N + 4M) \u2212 1 = lim (1 \u2212 G)."}, {"heading": "D Transformation of messages and proof of Theorem 5", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "D.1 Transformation of messages", "text": "First, we propose a simple observation of the LBP update.Proposal 1. Let us transform messages {\u00b5ti \u2192 j} into messages {\u00b5 \u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441"}, {"heading": "D.2 Proof of Theorem 5", "text": "Proof. We parameterise the messages by \u03b7ti \u2192 j = \u00b5ti \u2192 j (+) / \u00b5 t i \u2192 j (\u2212). It is sufficient to prove the assertion after the transformation and in this parameterisation, because these operations cause similar linearisation matrices. After the transformation, the LBP update is expressed in the following terms: \u03b7 t + 1i \u2192 j = \u2211 xi \u00b2 ji (+, xi). (Theoretically). (Theoretically). (After the transformation). (\u2212 After the transformation, the LBP sum is given in terms as follows. (xi). (Lemi). (Lemi). (xi) = bji (+, xi). (Theoretically). (Theoretically)."}, {"heading": "E.2 Proof of Lemma 1", "text": "First of all, let us prove that it is sufficient to prove the assertion if hi = 0 and Jij = b = b (b = 1) b (b = 1) b (b = 1) b (b) b (b) b (b) b (+ 1) b (b) b (b) b (b) b (r) b (n) b (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n) n (n)."}, {"heading": "E.3 Detailed proof of Theorem 7", "text": "The proof. Definition of a map: L (G) \u2192 RN + M (q) i = q (1 \u2212 di) 12 \u0445 xi = \u00b1 1xi log bi (xi) + 14 \u0445 k + + + + + 1 xi (xi, xk) and bi (xi) are given by q = {mi, \u03c7ij} and L (G). Therefore, we have the following numbers: 0 x x x x (hJ) and 0 x x (B). Figure 6: The graph G.Figure 7: The graph G.Claim. The propositions we make are us. (hJ) The propositions \u2212 1 (G) and 1 (G) are limited and we."}, {"heading": "F Proof of Corollary 4", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "F.1 Detailed proof of Example 2", "text": "In this subsection, we prove the assertion of Corollary 4 for the diagram of Example 2 shown in Figure 6. The + and \u2212 characters represent the interaction of two bodies. It is sufficient to verify that det (I \u2212 BM) > 0 is calculated for any 0 \u2264 \u03b213, \u03b223, \u03b214, \u03b234 < 1 and \u2212 1 < \u03b212 \u2264 0. The diagram G \u00b2 in Figure 7 is calculated by deleting vertices 2 and 4 in G. To calculate this (I \u2212 BM), it is sufficient to take into account G \u00b2. In factdet (I \u2212 BM) = 1 = EQ \u00b2 e1: 0 EQ \u00b2 e2: 0 EQ \u00b2 eQ (1 \u2212 g (p)))) (46) = EP \u00b2 (47) = EQ \u00b2 (I \u2212 BM) \u2212 1 = EQ \u00b2 e1 = EQ \u00b2 e1: 0 EQ \u00b2 e2: 0 EQ \u00b2 eQ = 0, EQ = 2."}, {"heading": "F.2 Other cases", "text": "There are two operations on graphs that do not change the set of primary cycles. The first is the addition or elimination of a vertex of degree two on an edge; the second is the addition or elimination of an edge with a vertex of degree one. With these two operations, all diagrams that have two linear independent cycles are reduced to three types of graphs; the first type is in Figure 7. The other types are in Figure 8. Up to the equivalence of the interactions, all types of signs of two body interactions are listed in Figure 9, except the attractive case. We check the uniqueness for each case in order. Case (1): Proven in Example 2.Case (2): In this case, BM = \u03b2e1 0 0 0 \u03b2e1 0 0 0 0 0 \u03b2e2 0 0 0 \u03b2e2 0 0 0 \u03b2e2 0 0 \u03b2e2 0 0 0 \u03b2e2 0 0 0 0 \u03b2e3 and columns e3."}], "references": [], "referenceMentions": [], "year": 2010, "abstractText": "<lb>We propose a new approach to the analysis of Loopy Belief Propagation (LBP) by<lb>establishing a formula that connects the Hessian of the Bethe free energy with the<lb>edge zeta function. The formula has a number of theoretical implications on LBP.<lb>It is applied to give a sufficient condition that the Hessian of the Bethe free energy<lb>is positive definite, which shows non-convexity for graphs with multiple cycles.<lb>The formula clarifies the relation between the local stability of a fixed point of<lb>LBP and local minima of the Bethe free energy. We also propose a new approach<lb>to the uniqueness of LBP fixed point, and show various conditions of uniqueness.<lb>", "creator": "LaTeX with hyperref package"}}}