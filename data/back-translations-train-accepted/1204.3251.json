{"id": "1204.3251", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "15-Apr-2012", "title": "Plug-in martingales for testing exchangeability on-line", "abstract": "A standard assumption in machine learning is the exchangeability of data, which is equivalent to assuming that the examples are generated from the same probability distribution independently. This paper is devoted to testing the assumption of exchangeability on-line: the examples arrive one by one, and after receiving each example we would like to have a valid measure of the degree to which the assumption of exchangeability has been falsified. Such measures are provided by exchangeability martingales. We extend known techniques for constructing exchangeability martingales and show that our new method is competitive with the martingales introduced before. Finally we investigate the performance of our testing method on two benchmark datasets, USPS and Statlog Satellite data; for the former, the known techniques give satisfactory results, but for the latter our new more flexible method becomes necessary.", "histories": [["v1", "Sun, 15 Apr 2012 10:21:57 GMT  (358kb,D)", "https://arxiv.org/abs/1204.3251v1", "17 pages, 7 figures"], ["v2", "Thu, 28 Jun 2012 09:36:27 GMT  (366kb,D)", "http://arxiv.org/abs/1204.3251v2", "8 pages, 7 figures; ICML 2012 Conference Proceedings"]], "COMMENTS": "17 pages, 7 figures", "reviews": [], "SUBJECTS": "cs.LG stat.ME", "authors": ["valentina fedorova", "alex j gammerman", "ilia nouretdinov", "volodya vovk"], "accepted": true, "id": "1204.3251"}, "pdf": {"name": "1204.3251.pdf", "metadata": {"source": "META", "title": "Plug-in martingales for testing exchangeability on-line", "authors": ["Valentina Fedorova", "Alex Gammerman", "Ilia Nouretdinov"], "emails": ["valentina@cs.rhul.ac.uk", "alex@cs.rhul.ac.uk", "ilia@cs.rhul.ac.uk", "v.vovk@rhul.ac.uk"], "sections": [{"heading": "1. Introduction", "text": "In fact, most of them will be able to play by the rules they have established in the past, and they will be able to play by the rules they have established in the past."}, {"heading": "1.1. Related work", "text": "The first method of testing interchangeability online is described in Vovk et al. (2003). The central testing mechanism is an interchangeability martyrdom. Interchangeability martyrdom is constructed from a sequence of p-values. The algorithm for generating p-values assigns small p-values to unusual examples. It implies the idea of designing martyrdom that would have a large value if too many small p-values were generated, and proposes corresponding power-martyrdoms. Other martyrdoms (simple mixture and sleepy jumper) implement more complicated strategies, but follow the same idea of evaluating small p-values. Ho (2005) applies power-martyrdom to the problem of detecting changes in time-varying data streams. The author shows that small p-values inflate the martyrdom values and suggests using the martyrdom difference test as another problem."}, {"heading": "1.2. This paper", "text": "In this paper, we propose a new, more flexible method for constructing interchangeability martinals for a specific sequence of p-values. The rest of the paper is structured as follows: Section 2 describes the definition of interchangeability martinals. Section 3 describes the construction of interchangeability martinals, explains their basic principles, and compares them with the previously used power martiningals. Section 4 shows experimental results of testing two real data sets for interchangeability; for one of these data sets, power martiningals work satisfactorily, and for the other, the greater flexibility of plug-in martiningals is crucial. Section 5 summarizes the work."}, {"heading": "2. Exchangeability martingales", "text": "In this section, the necessary definitions and results of the previous studies are outlined."}, {"heading": "2.1. Exchangeability", "text": "If we consider a sequence of random variables (Z1, Z2,...) assuming all values in the same sample range, then the common probability distribution P (Z1,.., ZN) of the afinite number of random variables is interchangeable if it is invariant under any permutation of the random variables. The common distribution of an infinite number of random variables (Z1, Z2,...) is interchangeable if the boundary distribution P (Z1,..., ZN) is interchangeable for each N."}, {"heading": "2.2. Martingales for testing", "text": "As in Vovk et al. (2003), the most important tool for testing interchangeability online is martyrdom. The value of martyrdom reflects the strength of the evidence against the assumption of exchangeability. An exchangeability martingale is a sequence of non-negative random variables S0, S1,... that maintain conditional expectation: Sn \u2265 0 Sn = E (Sn + 1 | S1,.., Sn), where E refers to the expected value in relation to each interchangeable distribution of examples. We also start from S0 = 1. Note that we get an equivalent definition when we replace \"any interchangeable distribution of examples\" with \"any distribution under which the examples i.i.d. are.\" (remember the discussion of de Finetti's theorem in Section 1). To understand the idea behind the martyrdom value test, we can imagine a game where a major problem of the capital of one event involves a strategy."}, {"heading": "2.3. On-line calculation of p-values", "text": "Each example zi is the vector that represents a set of attributes xi and a label yi: zi = (xi, yi). In this essay, we use conform predictors to generate a sequence of p-values corresponding to the given examples. The general idea of the conform prediction is to test how well a new example matches the previously observed examples. To this end, a \"non-conformity measurement\" is defined. It is a function that estimates the property of an example relative to others: i = A (zi, {z1,., zn}), algorithm generate 1 p-values in a linear way: (z1, z2,.) data for testing output: (p1, p2,.) sequence of p-values for p: 1, 2,."}, {"heading": "3. Martingales based on p-values", "text": "This section focuses on the second part of the check: Given the order of the p values, a martyrdom is calculated depending on the p values. Let (p1, p2,..) be the order of the p values generated by algorithm 1. let us consider martyrdom Sn of the form Sn = n, i = 1 fi (pi), n = 1, 2,.., (2), denoting fi (p) = fi (p1,.., pi \u2212 1, p) and denoting the function fi (p) as a betting function.To be sure that (2) is indeed a martyrdom, we need the following restriction to the betting functions fi: (p) = 10fi (p) dp = 1, 2,.. Then we can check: E (Sn + 1, S0."}, {"heading": "3.1. Previous results: power and simple mixture martingales", "text": "Previous studies (Vovk et al., 2003) have suggested using a fixed betting function, namely as: i: fi (p) = \u03b5p\u03b5 \u2212 1, where \u03b5 [0, 1] was constructed. Multiple martyrs were constructed using this function. The martyrs of power referred to as M\u03b5n are defined as M\u03b5n = n-i = 1 \u03b5p\u03b5 \u2212 1i. The simple mixture of martyrdom referred to as Mn is the mixture of the martyrs of power over different \u03b5 [0, 1]: Mn = 1 0 M\u03b5nd\u03b5.Such a martyrdom will only grow if there are many small p-values in sequence. This is due to the shape of the betting functions: see Figure 1. If the generated p-values are concentrated in any other part of the unit interval, we cannot expect the martyrdom to grow. Therefore, it might be difficult to reject the assumption of the interchangeability of such sequences."}, {"heading": "3.2. New plug-in approach", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.2.1. Plug-in martingale", "text": "Let us use an estimated probability density function as a betting function fi (p). At each step, the probability density function is estimated using the cumulative p-values: \u03c1i (p) = \u03c1 (p1,.., pi \u2212 1, p), (3), with the \"martingale\" (p1,.., pi \u2212 1, p) the estimation of the probability density function using the p-values p1,.., pi \u2212 1 output according to algorithm 1. Replace these betting functions in (2) we get a new martingale, which we call plug-in martingale. The martingale avoids bets if the p-values are uniformly distributed, but if there is any peak value, it is used for bets. The estimation of a probability density function in our experiments we have the statistical environment and language R. The density function in itsStats package implies the estimation of kernel density with different parameters."}, {"heading": "3.2.2. Assumptions", "text": "Consider an infinite sequence of p-values (p1, p2,.). (This is simply a deterministic sequence.) For their finite sequence (p1,.., pn) we define the corresponding empirical probability measure Pn: for a Borel quantity A in R, Pn (A) = # {i = 1,..., n: pi-quantity A} n. We say that the sequence (p1, p2,..) is stable if there is a probability quantity P on R, so that: 1. Pn weak \u2212 \u2212 \u2212 \u2212 n \u2192 number P; 2. There is a positive continuous density function \u03c1 (p) for P: for each Borel quantity A in R, P (A) = number A (p) dp.Intuitively, stability means that asymptotically the sequence of p-values can be well described by a sequence p \u2212 \u2212 \u2212 n."}, {"heading": "3.2.3. Growth rate of plug-in martingale", "text": "(1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1). (1. (1). (1). (1). (1. (1). (1). (1). (1. (1). (1). (1. (1). (1). (1. (1). (1). (1. (1). (1). (1. (1). (1). (1. (1). (1). (1. (1). (1.). (1.). (1.). (1. (1.). (1.). (1.). (1. (1.). (1.).). (1. (1.). (1.).). (1. (1. (1.).). (1. (1.).). (1. (1.). (1.).). (1. (1.).). (1.).). (1.). (1.). (1.). (1.). (1. (1.).). (1.). (1. (1.).). (1. (1.).).).). (1. (1.). (1.).). (1."}, {"heading": "4. Empirical results", "text": "In this section, we examine the performance of our martingale plug-in and compare it to the simple martingale mix. Two real-world datasets have been tested for interchangeability: the USPS dataset and the Statlog satellite dataset."}, {"heading": "4.1. USPS dataset", "text": "Data The US Postal Service (USPS) dataset consists of 7291 training examples and 2007 test examples of martyr numbers, from 0 to 9. Data was collected from real postcodes. Each example is described by the 256 attributes that represent the pixels for displaying a digit on the 16 x 16 gray image and its caption. It is well known that the examples in this dataset are not perfectly interchangeable (Vovk et al., 2003), and any reasonable test should reject the interchangeability there. In our experiments, we merge the training and testing sets and perform tests for the full dataset of 9298 examples. Figure 2 shows the typical performance of martyr numbers when the interchangeability assumption is certainly fulfilled: All examples were mixed randomly before the test. Figure 4 shows the performance of martyr numbers when the examples arrive in the original order."}, {"heading": "4.2. Statlog Satellite dataset", "text": "Data The Statlog Satellite dataset (Frank & Asuncion, 2010) consists of 6435 satellite images (divided into 4435 training examples and 2000 test examples).Examples are 3 x 3 pixel segments of the satellite image, in which each pixel is described by four spectral values in different spectral bands. Each example is represented by 36 attributes and a caption indicating the classification of the central pixel. Names are numbers from 1 to 7, without 6. Test results are described below. Figure 3 shows the performance of the martyrs for randomly mixed examples of the dataset. As expected, the martyrs do not reject the interchangeability assumption.Figure 5 shows the performance of the martyrs when the examples arrive in the original sequence.The final value for the simple mixture of martyrals is 5.5 x 102 and the final dataset of martyrdom power is 1.8 x 1017."}, {"heading": "5. Discussion and conclusions", "text": "In this paper, we have introduced a new way of constructing martyrdom to test interchangeability online. We have shown that for stable sequences of martyrdom values, the new more adaptive martyrdom asymptotically delivers the best result compared to any other martyrdom with a fixed betting function. Experiments to test two real martyrdom datasets were presented. On the basis of the same sequence of p-values, the plug-in martyrdom extracts approximately the same amount or more information about the data-generating distribution as compared to the previously introduced power martyrdom datasets. Note: Previous studies were based on the natural idea that lack of interchangeability leads to new examples that look strange compared to the old and therefore small p-values (for example, when the data creation mechanism changes its regime and begins to produce a different type of examples). However, this is a situation in which forms of lack of exchangeability are caused by large cluster values We observe the large number of examples:"}, {"heading": "Acknowledgments", "text": "We thank Royal Holloway, University of London, for their continued support and funding of this work. This work was also supported by the EraSysBio + grant SHIPREC of the European Union, BBSRC and BMBF, as well as the VLA Scholarship for Machine Learning. We thank all reviewers for their valuable suggestions for improving the work."}], "references": [{"title": "The Elements of Statistical Learning: Data Mining, Inference, and Prediction", "author": ["T. Hastie", "R. Tibshirani", "J. Friedman"], "venue": null, "citeRegEx": "Hastie et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Hastie et al\\.", "year": 2001}, {"title": "Information Theory and Statistics", "author": ["S. Kullback"], "venue": null, "citeRegEx": "Kullback,? \\Q1959\\E", "shortCiteRegEx": "Kullback", "year": 1959}, {"title": "Etude critique de la notion de collectif", "author": ["J. Ville"], "venue": "GauthierVillars, Paris,", "citeRegEx": "Ville,? \\Q1939\\E", "shortCiteRegEx": "Ville", "year": 1939}, {"title": "Testing exchangeability on-line", "author": ["V. Vovk", "I. Nouretdinov", "A. Gammerman"], "venue": "In Proceedings of the 20th International Conference on Machine Learning (ICML", "citeRegEx": "Vovk et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Vovk et al\\.", "year": 2003}], "referenceMentions": [{"referenceID": 3, "context": "To address this challenge a previous study (Vovk et al., 2003) suggested a way of on-line testing by employing the theory of conformal prediction and calculating exchangeability martingales.", "startOffset": 43, "endOffset": 62}, {"referenceID": 3, "context": "The first procedure of testing exchangeability on-line is described in Vovk et al. (2003). The core testing mechanism is an exchangeability martingale.", "startOffset": 71, "endOffset": 90}, {"referenceID": 3, "context": "The first procedure of testing exchangeability on-line is described in Vovk et al. (2003). The core testing mechanism is an exchangeability martingale. Exchangeability martingales are constructed using a sequence of p-values. The algorithm for generating p-values assigns small p-values to unusual examples. It implies the idea of designing martingales that would have a large value if too many small p-values were generated, and suggests corresponding power martingales. Other martingales (simple mixture and sleepy jumper) implement more complicated strategies, but follow the same idea of scoring on small p-values. Ho (2005) applies power martingales to the problem of change detection in time-varying data streams.", "startOffset": 71, "endOffset": 629}, {"referenceID": 2, "context": "As in Vovk et al. (2003), the main tool for testing exchangeability on-line is a martingale.", "startOffset": 6, "endOffset": 25}, {"referenceID": 3, "context": "Previous studies (Vovk et al., 2003) have proposed to use a fixed betting function \u2200i : fi(p) = \u03b5p\u03b5\u22121, where \u03b5 \u2208 [0, 1].", "startOffset": 17, "endOffset": 36}, {"referenceID": 3, "context": "It is well known that the examples in this dataset are not perfectly exchangeable (Vovk et al., 2003), and any reasonable test should reject exchangeability there.", "startOffset": 82, "endOffset": 101}], "year": 2012, "abstractText": "A standard assumption in machine learning is the exchangeability of data, which is equivalent to assuming that the examples are generated from the same probability distribution independently. This paper is devoted to testing the assumption of exchangeability on-line: the examples arrive one by one, and after receiving each example we would like to have a valid measure of the degree to which the assumption of exchangeability has been falsified. Such measures are provided by exchangeability martingales. We extend known techniques for constructing exchangeability martingales and show that our new method is competitive with the martingales introduced before. Finally we investigate the performance of our testing method on two benchmark datasets, USPS and Statlog Satellite data; for the former, the known techniques give satisfactory results, but for the latter our new more flexible method becomes necessary.", "creator": "LaTeX with hyperref package"}}}