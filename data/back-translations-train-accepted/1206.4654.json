{"id": "1206.4654", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "18-Jun-2012", "title": "A Generalized Loop Correction Method for Approximate Inference in Graphical Models", "abstract": "Belief Propagation (BP) is one of the most popular methods for inference in probabilistic graphical models. BP is guaranteed to return the correct answer for tree structures, but can be incorrect or non-convergent for loopy graphical models. Recently, several new approximate inference algorithms based on cavity distribution have been proposed. These methods can account for the effect of loops by incorporating the dependency between BP messages. Alternatively, region-based approximations (that lead to methods such as Generalized Belief Propagation) improve upon BP by considering interactions within small clusters of variables, thus taking small loops within these clusters into account. This paper introduces an approach, Generalized Loop Correction (GLC), that benefits from both of these types of loop correction. We show how GLC relates to these two families of inference methods, then provide empirical evidence that GLC works effectively in general, and can be significantly more accurate than both correction schemes.", "histories": [["v1", "Mon, 18 Jun 2012 15:25:04 GMT  (543kb)", "http://arxiv.org/abs/1206.4654v1", "ICML2012"]], "COMMENTS": "ICML2012", "reviews": [], "SUBJECTS": "cs.AI cs.LG stat.ML", "authors": ["siamak ravanbakhsh", "chun-nam yu", "russell greiner"], "accepted": true, "id": "1206.4654"}, "pdf": {"name": "1206.4654.pdf", "metadata": {"source": "META", "title": "A Generalized Loop Correction Method  for Approximate Inference in Graphical Models", "authors": ["Siamak Ravanbakhsh", "Russell Greiner"], "emails": ["mravanba@ualberta.ca", "chunnam@ualberta.ca", "rgreiner@ualberta.ca"], "sections": [{"heading": "1. Introduction", "text": "This year, it has reached the stage where it will be able to take the lead."}, {"heading": "2. Framework", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "2.1. Notation", "text": "Suppose that their common probability distribution is factored into a product of non-negative functions: P (X = x): = 1Z-I-F-I (xI), where each I value is a subset of the variable indexes, and xI = {xi | i-I} is the set of values in x indexed by the subset I. Each factor I define is a non-negative function, and F is the collection of indexing subsets I for all factors. In the following, we will use the term \"factor\" interchangeably with the function I and the subset I, and the term \"variable\" is interchangeable for the value xi and the index I. Here, Z is the partition function. This model can be conveniently represented as a two-dimensional diagram called Factor I."}, {"heading": "2.2. Generalized Cavity Distribution", "text": "i. i. i. i. i. i. i. (I). The term \"cavity distribution\" is borrowed from the so-called \"cavity\" methods from statistical physics. (I) \"There is only one way.\" (I) \"There is only one way.\" (I) \"There is only one way.\" (I) \"There is only one way.\" (I) \"There is only one way.\" (I) \"There is only one way.\" (I) \"There is only one way.\" (I) \"There is only one way.\" (I) \"There is only one way.\" (I) \"(I)\" There is only one way. \"(I)\" (I) \"There is only one way.\" (I) \"(I)\" There is only one way. \"(I)\" (I) \"(I)\" There is only one way. \"(I)\" (I) \"(I).\" (I) \"(I).\" (I). \"(I). (I). (I). (I). (I). (I). (I). (I). (I). (I). (I). (I). (I. (I). (I). (I. (I). (I). (I. (I). (I). (I. (I). (I). (I.). (I. (I). (I.). (I. (I.). (I). (I.). (I. (I.). (I.). (I. (I.). (I.). (I. (I.). (I.). (I.). (I. (I.). (I.). (I. (I.). (I.). (I.). (I. (I. (I.). (I.). (I.). (I.). (I.). (I. (I.). (I.). (I.). (I. (I.). (I.). (I). (I). (I."}, {"heading": "3. Generalized Loop Correction", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1. Simple Case: Partitioning Cavity Regions", "text": "In order to introduce our approach, we must first consider a simpler case in which the Cavity R1, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, RP, R"}, {"heading": "3.2. General Cavity Regions", "text": "If we do not abide by the rules, we must abide by the rules. \"In order to avoid this problem, we adopt a strategy that resembles the CVM contributions: For each individual region we form its own region.\" We. \"\" We. \"\" We. \"\" We. \"\" We. \"\" We. \"\" We. \"\" We. \"\" We. \"\" \"We.\" \"\" We. \"\" \"\" \"\" We. \"\" \"\" \"\" We. \"\" \"\" We. \"\" \"\" \"We.\" \"\" \"\" We. \"\" \".\" \"\" \"We.\". \"\" \".\" \"\" \"We.\". \"\" \"\" \"We.\". \"\" \"\".. \"\" \"\" \"We..\" \"\".. \"\" \"\".. \"\" \"\" We. \"\".. \"\" \"..\" \"\" We.. \".\".. \"\". \"\" \"\" \"We.....\" \".\" \"\". \"\". \"\" \"..\" \"\" \"\" \"\" \"We......\" \"\" \"\".. \"\" \"..\" \"\".. \"\" \"..\" \"\" \"..\" \"\".. \".\". \".\" \"\" \"...\". \"\". \".\". \"\". \".\". \".\". \"\".. \"\" \"\" \".\". \".\". \".\".. \".\". \"\" \"\". \".\" \"\". \".\". \".\".. \"\". \"..\" \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\". \".\"."}, {"heading": "4. Experiments", "text": "This section compares various variations of our method against LBP, as well as CVM, LCBP and TreeEP (Minka & Qi, 2003) methods, each of which performs some kind of loop correction.For CVM, we use the double-loop algorithm of (Heskes, 2006), which is slower than GBP but has better convergence characteristics; all methods are applied without attenuation; we terminate each method after a maximum of 1E4 iterations or when the change in probability distribution (or messages) is less than 1E-9. We specify the time in seconds and error for each method as the average of absolute errors in individual variable margins - i.e., xi, v | P (xi = v) \u2212 P (xi = v) |. For each setting, we specify the average results over 10 random instances of the problem."}, {"heading": "4.1. Grids", "text": "We experimented with periodic Ising grids in which xi-1, + 1} is a binary variable and the probability distribution of a setting when xi and xj are connected in the graph is given by P (x).exp (\u2211 i \u03b8ixi + 1 2 \u2211 i, j-I Ji, jxixj), where Ji, j controls variable interactions and \u03b8i defines a single node potential - also known as local field. In general, smaller local fields and larger variable interactions lead to more difficult problems. We sampled local fields independently of N (0, 1) and interactions of N (0, \u03b22). Figure 3 (left) summarizes the results for 6x6 grids for different values of \u03b2.We also experimented with periodic grids of different sizes generated by sampling all factor entries independently of N (0, \u03b21)."}, {"heading": "4.2. Regular Graphs", "text": "We created two sets of experiments with random 3-regular graphs (all nodes have degree 3) over 40 variables. In this case, we used the Ising model when scanning both local fields and couplings independently of N (0, \u03b22). Figure 3 (right) shows the time and error for different \u03b2 values. Figure 4 shows time versus error for graph size between 10 and 100 nodes for \u03b2 = 1. For larger \u03b2s, few instances did not converge within the allocated number of iterations. The results refer to cases where all methods converged."}, {"heading": "4.3. Alarm Network", "text": "Alarm is a Bayesian network with 37 variables and 37 factors. Variables are discrete, but not all are binary, and most factors have more than two variables. Table (1) compares accuracy with the runtime of different methods. GLC with factor domains as regions - i.e. rp = I for I-F - and all loopy clusters provide accurate results up to the convergence threshold."}, {"heading": "4.4. Discussions", "text": "These results show that GLC consistently delivers more accurate results than CVM and LCBP, though often at the expense of higher computing time; they also suggest that this trade-off between time and accuracy cannot be achieved simply by including larger loops in CVM regions. If used with uniform cavity, the performance of GLC (especially GLC +) is similar to the CVM, and GLC appears stable in terms of the total number of GLC implementations in single loops. GLC's time complexity (when using full cavity and using LBP to estimate the cavity distribution) is O (\u03c4MN | X | u + \u03bbM | X | v), which is the number of iterations of GLC, instead of the maximum number of iterations for LBP, M by the number of clusters, N by the number of variables, u = maxp | rp | rp | and mav = rp | rp."}, {"heading": "5. Conclusions", "text": "We have introduced GLC, a deduction method that enables accurate inferences by applying the loop correction schemes of both regional and newer cavity-based methods. Experimental results on benchmarks support the claim that these systems complement each other in difficult problems and that our GLC can successfully use both. We also believe that our scheme motivates possible variations that can also work with graphical models with large Markov ceilings."}, {"heading": "6. Acknowledgements", "text": "We thank the anonymous reviewers for their excellent detailed comments. This research was partly funded by NSERC, Alberta Innovates - Technology Futures (AICML) and Alberta Advanced Education and Technology."}, {"heading": "A. Appendix", "text": "We prove the equality of the GLC to the CVM regions in which each factor does not exceed 2 qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q c q q c q q c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c"}], "references": [{"title": "Stable fixed points of loopy belief propagation are local minima of the Bethe free energy", "author": ["T. Heskes"], "venue": "In NIPS,", "citeRegEx": "Heskes,? \\Q2003\\E", "shortCiteRegEx": "Heskes", "year": 2003}, {"title": "Convexity arguments for efficient minimization of the Bethe and Kikuchi free energies", "author": ["T. Heskes"], "venue": null, "citeRegEx": "Heskes,? \\Q2006\\E", "shortCiteRegEx": "Heskes", "year": 2006}, {"title": "A theory of cooperative phenomena", "author": ["R. Kikuchi"], "venue": "Phys. Rev.,", "citeRegEx": "Kikuchi,? \\Q1951\\E", "shortCiteRegEx": "Kikuchi", "year": 1951}, {"title": "Probabilistic Graphical Models: Principles and Techniques", "author": ["D. Koller", "N. Friedman"], "venue": null, "citeRegEx": "Koller and Friedman,? \\Q2009\\E", "shortCiteRegEx": "Koller and Friedman", "year": 2009}, {"title": "Factor graphs and the sum-product algorithm", "author": ["F Kschischang", "B Frey", "H. Loeliger"], "venue": "IEEE Info Theory,", "citeRegEx": "Kschischang et al\\.,? \\Q1998\\E", "shortCiteRegEx": "Kschischang et al\\.", "year": 1998}, {"title": "Analytic and algorithmic solution of random satisfiability problems", "author": ["M M\u00e9zard", "G Parisi", "R. Zecchina"], "venue": null, "citeRegEx": "M\u00e9zard et al\\.,? \\Q2002\\E", "shortCiteRegEx": "M\u00e9zard et al\\.", "year": 2002}, {"title": "Tree-structured approximations by expectation propagation", "author": ["T Minka", "Y. Qi"], "venue": "In NIPS,", "citeRegEx": "Minka and Qi,? \\Q2003\\E", "shortCiteRegEx": "Minka and Qi", "year": 2003}, {"title": "How to compute loop corrections to the Bethe approximation", "author": ["A Montanari", "T. Rizzo"], "venue": "J Statistical Mechanics,", "citeRegEx": "Montanari and Rizzo,? \\Q2005\\E", "shortCiteRegEx": "Montanari and Rizzo", "year": 2005}, {"title": "Understanding and Improving Belief Propagation", "author": ["J. Mooij"], "venue": "PhD thesis, Radboud U,", "citeRegEx": "Mooij,? \\Q2008\\E", "shortCiteRegEx": "Mooij", "year": 2008}, {"title": "libDAI: A free and open source C++ library for discrete approximate inference in graphical models", "author": ["J. Mooij"], "venue": null, "citeRegEx": "Mooij,? \\Q2010\\E", "shortCiteRegEx": "Mooij", "year": 2010}, {"title": "Loop corrections for approximate inference on factor graphs", "author": ["J Mooij", "H. Kappen"], "venue": "JRML,", "citeRegEx": "Mooij and Kappen,? \\Q2007\\E", "shortCiteRegEx": "Mooij and Kappen", "year": 2007}, {"title": "Probabilistic reasoning in intelligent systems", "author": ["J. Pearl"], "venue": null, "citeRegEx": "Pearl,? \\Q1988\\E", "shortCiteRegEx": "Pearl", "year": 1988}, {"title": "Cluster variation method in statistical physics and probabilistic graphical models", "author": ["A. Pelizzola"], "venue": "J Physics A,", "citeRegEx": "Pelizzola,? \\Q2005\\E", "shortCiteRegEx": "Pelizzola", "year": 2005}, {"title": "On cavity approximations for graphical models", "author": ["T Rizzo", "B Wemmenhove", "H. Kappen"], "venue": "J Physical Review,", "citeRegEx": "Rizzo et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Rizzo et al\\.", "year": 2007}, {"title": "Constructing free energy approximations and generalized belief propagation algorithms", "author": ["J Yedidia", "W Freeman", "Y. Weiss"], "venue": "IEEE Info Theory,", "citeRegEx": "Yedidia et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Yedidia et al\\.", "year": 2005}, {"title": "CCCP algorithms to minimize the Bethe and Kikuchi free energies", "author": ["A. Yuille"], "venue": "Neural Computation,", "citeRegEx": "Yuille,? \\Q2002\\E", "shortCiteRegEx": "Yuille", "year": 2002}], "referenceMentions": [{"referenceID": 4, "context": "This paper will use probabilistic graphical models, focusing on factor graphs (Kschischang et al., 1998), that can represent both Markov Networks and Bayesian Networks.", "startOffset": 78, "endOffset": 104}, {"referenceID": 11, "context": ", no loops), this exact inference is tractable, and can be done by a message passing procedure, Belief Propagation (BP) (Pearl, 1988).", "startOffset": 120, "endOffset": 133}, {"referenceID": 0, "context": "LBP is related to the Bethe approximation to free energy (Heskes, 2003), which is the basis for minimization of more sophisticated energy approximations and provably convergent methods (Yedidia et al.", "startOffset": 57, "endOffset": 71}, {"referenceID": 14, "context": "LBP is related to the Bethe approximation to free energy (Heskes, 2003), which is the basis for minimization of more sophisticated energy approximations and provably convergent methods (Yedidia et al., 2005; Heskes, 2006; Yuille, 2002).", "startOffset": 185, "endOffset": 235}, {"referenceID": 1, "context": "LBP is related to the Bethe approximation to free energy (Heskes, 2003), which is the basis for minimization of more sophisticated energy approximations and provably convergent methods (Yedidia et al., 2005; Heskes, 2006; Yuille, 2002).", "startOffset": 185, "endOffset": 235}, {"referenceID": 15, "context": "LBP is related to the Bethe approximation to free energy (Heskes, 2003), which is the basis for minimization of more sophisticated energy approximations and provably convergent methods (Yedidia et al., 2005; Heskes, 2006; Yuille, 2002).", "startOffset": 185, "endOffset": 235}, {"referenceID": 14, "context": "A representative class of energy approximations is the region-graph methods (Yedidia et al., 2005), which deal with a set of connected variables (called \u201cregions\u201d); these methods subsume both the Cluster Variation Method (CVM) (Pelizzola, 2005; Kikuchi, 1951) and the Junction Graph Method (Aji & McEliece, 2001).", "startOffset": 76, "endOffset": 98}, {"referenceID": 12, "context": ", 2005), which deal with a set of connected variables (called \u201cregions\u201d); these methods subsume both the Cluster Variation Method (CVM) (Pelizzola, 2005; Kikuchi, 1951) and the Junction Graph Method (Aji & McEliece, 2001).", "startOffset": 136, "endOffset": 168}, {"referenceID": 2, "context": ", 2005), which deal with a set of connected variables (called \u201cregions\u201d); these methods subsume both the Cluster Variation Method (CVM) (Pelizzola, 2005; Kikuchi, 1951) and the Junction Graph Method (Aji & McEliece, 2001).", "startOffset": 136, "endOffset": 168}, {"referenceID": 8, "context": "This is the basis for the loop correction schemes by Montanari & Rizzo\u2019s (2005) on pairwise dependencies over binary variables, and also Mooij & Kappen\u2019s (2007) extension to general factor graphs \u2013 called Loop Corrected Belief Propagation (LCBP).", "startOffset": 137, "endOffset": 161}, {"referenceID": 4, "context": "This model can be conveniently represented as a bipartite graph, called the factor graph (Kschischang et al., 1998), which includes two sets of nodes: variable nodes xi, and factor nodes \u03c8I .", "startOffset": 89, "endOffset": 115}, {"referenceID": 5, "context": "The notion of cavity distribution is borrowed from socalled cavity methods from statistical physics (M\u00e9zard & Montanari, 2009), and has been used in analysis and optimization of important combinatorial problems (M\u00e9zard et al., 2002; Braunstein et al., 2002).", "startOffset": 211, "endOffset": 257}, {"referenceID": 8, "context": "Following Mooij (2008), we use variable clamping to estimate higher-order interactions in r: Here, we estimate the partition function Zx r after removing factors in N(r) and fixing x r to each possible assignment.", "startOffset": 10, "endOffset": 23}, {"referenceID": 8, "context": "Following Mooij (2008), we use variable clamping to estimate higher-order interactions in r: Here, we estimate the partition function Zx r after removing factors in N(r) and fixing x r to each possible assignment. Doing this calculation, we have P\u0302 \\r(x r) \u221d Zx r . In our experiments, we use the approximation to the partition function provided using LBP. However there are some alternatives to clamping: conditioning scheme Rizzo et al. (2007) makes it possible to use", "startOffset": 10, "endOffset": 446}, {"referenceID": 12, "context": "Our region-graph construction is similar to CVM (Pelizzola, 2005) \u2013 i.", "startOffset": 48, "endOffset": 65}, {"referenceID": 1, "context": "For CVM, we use the double-loop algorithm of (Heskes, 2006), which is slower than GBP but has better convergence properties.", "startOffset": 45, "endOffset": 59}, {"referenceID": 9, "context": "The evaluations are based on implementation in libdai inference toolbox (Mooij, 2010).", "startOffset": 72, "endOffset": 85}], "year": 2012, "abstractText": "Belief Propagation (BP) is one of the most popular methods for inference in probabilistic graphical models. BP is guaranteed to return the correct answer for tree structures, but can be incorrect or non-convergent for loopy graphical models. Recently, several new approximate inference algorithms based on cavity distribution have been proposed. These methods can account for the effect of loops by incorporating the dependency between BP messages. Alternatively, regionbased approximations (that lead to methods such as Generalized Belief Propagation) improve upon BP by considering interactions within small clusters of variables, thus taking small loops within these clusters into account. This paper introduces an approach, Generalized Loop Correction (GLC), that benefits from both of these types of loop correction. We show how GLC relates to these two families of inference methods, then provide empirical evidence that GLC works effectively in general, and can be significantly more accurate than both correction schemes.", "creator": "LaTeX with hyperref package"}}}