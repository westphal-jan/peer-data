{"id": "1206.4675", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "18-Jun-2012", "title": "Finding Botnets Using Minimal Graph Clusterings", "abstract": "We study the problem of identifying botnets and the IP addresses which they comprise, based on the observation of a fraction of the global email spam traffic. Observed mailing campaigns constitute evidence for joint botnet membership, they are represented by cliques in the graph of all messages. No evidence against an association of nodes is ever available. We reduce the problem of identifying botnets to a problem of finding a minimal clustering of the graph of messages. We directly model the distribution of clusterings given the input graph; this avoids potential errors caused by distributional assumptions of a generative model. We report on a case study in which we evaluate the model by its ability to predict the spam campaign that a given IP address is going to participate in.", "histories": [["v1", "Mon, 18 Jun 2012 15:36:32 GMT  (391kb)", "http://arxiv.org/abs/1206.4675v1", "ICML2012"]], "COMMENTS": "ICML2012", "reviews": [], "SUBJECTS": "cs.CR cs.DC cs.LG", "authors": ["peter haider", "tobias scheffer"], "accepted": true, "id": "1206.4675"}, "pdf": {"name": "1206.4675.pdf", "metadata": {"source": "META", "title": "Finding Botnets Using Minimal Graph Clusterings", "authors": ["Peter Haider", "Tobias Scheffer"], "emails": ["haider@cs.uni-potsdam.de", "scheffer@cs.uni-potsdam.de"], "sections": [{"heading": "1. Introduction", "text": "In fact, it is so that it is a matter of a way in which people put themselves and their environment in the centre. (...) In fact, it is so that they are able to put themselves in the centre of attention. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre. (...) It is as if they put themselves in the centre."}, {"heading": "2. Problem Setting and Evaluation", "text": "The basic truth about the sets of IP addresses that make up each botnet is not available. Instead, we focus on the botnet model's ability to predict observable events. We look at e-mail spam campaigns, which are one of the main activities for which botnets are designed, and which we can easily observe by tracking the flow of e-mail addresses that reach an e-mail service provider. Most spam e-mails are based on a campaign template that is randomly instantiated by the nodes of a botnet, but it is also possible for a botnet process to simultaneously map multiple campaigns based on the same campaign template with a low error rate (Haider & Scheffer, 2009). A single campaign can be spread from the nodes of a single botnet, but it is possible for multiple campaigns and multiple botnets to be used for large campaigns at the same time."}, {"heading": "3. Minimal Graph Clustering", "text": "The input matrix is therefore considered reflexive (Xii = 1 for all i) and symmetrical (Xij = Xji).The result of the cluster process is represented by a reflexive, symmetrical edge selection matrix Y, in which the entries of Yij = 1 indicate that the nodes i and j are assigned to the same cluster, indicating that the messages come from the same botnet.The transitive closure Y + of the matrix Y defines a clustering of the nodes according to Equation 1. Intuitively, the input matrix X can be considered data, while the output matrix Y should be considered the model that justifies clustering the nodes according to Equation 1. Y."}, {"heading": "3.1. Probabilistic Model", "text": "This section derives a probabilistic model for the minimal graph cluster problem. Its most prominent property is that it is not based on a generative model of the graph, but directly models the conditional probability of clustering taking into account the adjacence matrix X. This avoids systematic errors caused by inaccurate distribution assumptions for generating the adjacence matrix X. We define the rear distribution across all reflective and symmetric matrices Y related to X.Definition 2. Let us leave X, 0, 1, n, n, a reflexive and symmetric adjacence matrix X.Then YX, 1, n, n, n, a series of matrices reflexive, symmetrical and minimal related to X.In our application, each node is an element of at most two clicks, because each message is associated with all other messages sent by the same address, and all others matched to.Q.Y."}, {"heading": "3.2. Inference", "text": "The calculation of the rear distribution P (CY | X, \u03b1) is a generalization of the consequence problem for conventional Chinese restaurant process models. If all inputs of X are one, the graph has only one clique and the special case of a Chinese restaurant process. In this case, depending on the concentration of the Y column, the result can be a single cluster of all nodes. In this section we describe a Gibbs sampler that generates unbiased samples from the rear plane. Algorithm 1 mapping space YYi for Gibbs sampler input: Current division matrix Y 1: let q1,. qk be the cliques with element i 2: let Yi."}, {"heading": "3.3. Prediction", "text": "The Gibbs sampler generates a chain Y 0,.., Y T of matrices controlled by the rear P (Y | X, \u03b1). To predict in which campaign a particular IP address a will participate, we can approximate the Bayean conclusion of c (equation 9) using the chain (equation 10). P (s | a, X, \u03b1) = \u2211 Y-YXP (CY | X, \u03b1) P (s | a, CY) (9) \u2248 Y-X (Y-0,..., Y T) P (s | a, CY) (10) Equation 1 splits P (s | a, CY) into two multinomic distributions that can be estimated from the available data."}, {"heading": "4. Case Study", "text": "In this section, we conduct a case study on botnet detection. Since the divine truth about which botnets are currently active and which hosts they are made up of is not available, we evaluate the model for its accuracy in predicting which spam campaigns a particular IP address will participate in. We collect incoming spam emails over an 11-day period in January 2012 from a major email service provider. We select only emails that have been blacklisted due to three content filtering techniques: the first consists of a set of manually maintained regular expressions, each tailored to all the spams of a particular campaign; the second is a list of semi-automatically generated campaign-specific feature sets (Haider & Scheffer, 2009); one feature set consists of words and structuring flags, and is the intersection of all previously observed emails from the campaign; and the third is a blacklist of URs to be linked to."}, {"heading": "4.1. Reference Methods", "text": "We compare the Minimal Graph Clustering Model with three baselines. The first, threshold-based baseline is an agglomerative clustering algorithm based on a heuristic threshold, adapted to Zhuang et al. (2008). It assumes that each campaign is sent by only one botnet. First, each campaign forms its own cluster. Clusters c and c \u00b2 are merged greedily when their share of overlapping IP addresses exceeds a threshold. This fraction is defined as \"edge I\" (\"edge I\": si = sj \"c\" edge C \": si = sj\" edge C \": si = sj\" edge \") 2 | +\" edge I \"(\" edge I \"C\": sj \") 2\" edge C \": si\" edge C \"(\" edge C \": si = sj\" edge C \": si\" sj \") 2.\""}, {"heading": "4.2. Results", "text": "We measure ROC curves; IP addresses where the probability P (s | a, X, \u03b1) of the correct campaign exceeds the threshold are counted as true positives, addresses where the probability of a false campaign exceeds the threshold as false positives. Figure 4 shows ROC curves for the four methods studied. Minimal graph clustering reaches the highest range below the ROC curve of 0.784, compared with 0.675 for threshold-based clusters, 0.671 for spectral clustering, and 0.651 for the generative edge model baseline. The threshold-based method is slightly more accurate than the Minimal Graph Clustering model for low thresholds, and less accurate for all other thresholds. Threshold-based clustering users P (s | c) and P (c | a, C) and consequently P (s | a, C) application examples are ineffective in relation to the current ROC model."}, {"heading": "5. Conclusion and Discussion", "text": "Identification of spam-spreading botnets can be reduced to the problem of clustering e-mail messages in which messages are linked if they originate from the same IP address or match the same campaign template. We developed a probabilistic model that directly describes the conditional likelihood of an attack on the e-mail chain without making distributional assumptions about the generation of observable data. We argue that botnet models can be evaluated in terms of their ability to predict which spam campaign contains a particular IP address. From a case study conducted with an e-mail service provider, we conclude that the minimal graph clustering model performs a number of reference models in terms of its ability to involve the spam campaign in a particular IP address. We argue that the minimum graph clustering model is based on the message model, an HB model that performs a generative message model."}, {"heading": "6. Acknowledgments", "text": "This work was financed by a grant from STRATO AG."}, {"heading": "DiBenedetto, S., Gadkari, K., Diel, N., Steiner, A., Massey,", "text": "D., and Papadopoulos, C. Fingerprinting custom botnet protocol stacks. In Secure Network Protocols (NPSec), 2010 6th IEEE Workshop on, pp. 61-66. IEEE, 2010. Dittrich, D. and Dietrich, S. Discovery techniques for p2p botnets, 2008."}, {"heading": "Goebel, J. and Holz, T. Rishi: Identify bot contaminated", "text": "In: Proceedings of the First Conference on First Workshop on Hot Topics in Understanding Botnets, pp. 8-8. USENIX Association, 2007."}, {"heading": "Gu, G., Perdisci, R., Zhang, J., and Lee, W. Botminer:", "text": "Clustering analysis of network traffic for protocol-and structure-independent botnet detection. In Proceedings of the 17th Conference on Security symposium, pp. 139- 154. USENIX Association, 2008.Haider, P. and Scheffer, T. Bayesian clustering for email campaign detection. In Proceeding of the International Conference on Machine Learning, 2009.Hammersley, J. and Clifford, P. Markov fields on finite graphs and gittices, 1971.Holz, T., Steiner, M., Frederic, D., Biersack, E., and Freiling, F. Measurements and mitigation of peer-to-peerbased botnets: a case study on storm worm. In Proceedings of the USENIX Workshop on Large-Scale Exploits and Emergent Threats, 2008.John, J.P., Moshchuk, S., Gribble, S. D., and Krishnamurthy, A. In Proceedings of the USENIX Workshop on Large-lab S. Grige-S. Screats and Emergent Threats, 2008.."}, {"heading": "Mori, T., Esquivel, H., Akella, A., Shimoda, A., and Goto,", "text": "S. Understanding large-scale spam botnets of Internet edge sites. In Proceedings of the Conference on E-Mail and Anti-Spam. CEAS, 2010.Pitman, J. and Picard, J. Combinatorial stochastic processes. Springer, 2006. ISBN 354030990X.Stern, H. An overview of modern spam tools. In Proceedings of the Conference on Email and Anti-Spam, 2008."}, {"heading": "Xie, Y., Yu, F., Achan, K., Panigrahy, R., Hulten, G., and", "text": "Osipkov, I. Spamming Botnets: Signatures and Features. ACM SIGCOMM Computer Communication Review, 38 (4): 171-182, 2008.Yu, F., Xie, Y., and Ke, Q. Sbotminer: Large scale search bot detection. In Proceedings of the Third ACM International Conference on Web Search and Data Mining, pp. 421-430. ACM, 2010."}, {"heading": "Zhuang, L., Dunagan, J., Simon, D.R., Wang, H.J., and", "text": "Tygar, JD. Characterization of Botnets from Email Spam Records. In Proceedings of the 1st Usenix Workshop on Large-Scale Exploits and Emergent Threats, pp. 1- 9. USENIX Association, 2008."}], "references": [], "referenceMentions": [], "year": 2012, "abstractText": "We study the problem of identifying botnets and the IP addresses which they comprise, based on the observation of a fraction of the global email spam traffic. Observed mailing campaigns constitute evidence for joint botnet membership, they are represented by cliques in the graph of all messages. No evidence against an association of nodes is ever available. We reduce the problem of identifying botnets to a problem of finding a minimal clustering of the graph of messages. We directly model the distribution of clusterings given the input graph; this avoids potential errors caused by distributional assumptions of a generative model. We report on a case study in which we evaluate the model by its ability to predict the spam campaign that a given IP address is going to participate in.", "creator": "LaTeX with hyperref package"}}}