{"id": "1206.6424", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "27-Jun-2012", "title": "Anytime Marginal MAP Inference", "abstract": "This paper presents a new anytime algorithm for the marginal MAP problem in graphical models. The algorithm is described in detail, its complexity and convergence rate are studied, and relations to previous theoretical results for the problem are discussed. It is shown that the algorithm runs in polynomial-time if the underlying graph of the model has bounded tree-width, and that it provides guarantees to the lower and upper bounds obtained within a fixed amount of computational resources. Experiments with both real and synthetic generated models highlight its main characteristics and show that it compares favorably against Park and Darwiche's systematic search, particularly in the case of problems with many MAP variables and moderate tree-width.", "histories": [["v1", "Wed, 27 Jun 2012 19:59:59 GMT  (346kb)", "http://arxiv.org/abs/1206.6424v1", "Appears in Proceedings of the 29th International Conference on Machine Learning (ICML 2012)"]], "COMMENTS": "Appears in Proceedings of the 29th International Conference on Machine Learning (ICML 2012)", "reviews": [], "SUBJECTS": "cs.AI stat.ML", "authors": ["denis deratani mau\u00e1", "cassio polpo de campos"], "accepted": true, "id": "1206.6424"}, "pdf": {"name": "1206.6424.pdf", "metadata": {"source": "META", "title": "Anytime Marginal Maximum a Posteriori Inference", "authors": ["Denis Deratani Mau\u00e1", "Cassio Polpo de Campos"], "emails": ["denis@idsia.ch", "cassio@idsia.ch"], "sections": [{"heading": "1. Introduction", "text": "The maximum a posteriori (MAP) mapping problem is to find an mapping that maximizes the posterior probability of a particular set of variables. To facilitate modeling, the model often includes latent variables that are neither maximized nor observed, but marginalized. It is this more general form of the problem (a.k.a. partial or marginal MAP) that we tackle in this paper. Furthermore, we assume that the probability distribution is presented as a discrete graphical model, the compactness.Computationally, this is a very hard problem, even if all variables are binary, and NP-hard if either the underlying graph is treewidth or there is no latent variable (Park & Darwiche, 2004)."}, {"heading": "2. Notation", "text": "A finite whole set {1, 2,.., n} is defined by [n]. Random variables are represented by uppercase letters, e.g. X, Y, Z; real functions by Greek letters, e.g. X, Harry; sentences by calligraphic letters, e.g. I = [3], P = {\u03c6, \u0432}, S = {I, P}; vectors in bold letters, e.g. V = (X, Y, Z). The number of elements in a set X is represented by | X |. We identify a variable with its example range. Therefore, the finite set of values from which a variable X can proceed is also represented by X. Given a vector of the variable X = (X1,....), Xn), we write X = X1 \u00b7 \u00b7 \u00b7 Xn to denote the space of configurations or assignments of the variable in X."}, {"heading": "3. Graphical Models", "text": "Let us be X = (X1,., Xn) a vector of discrete random variables, J1,.., Jm a collection of index sets that are satisfactory J1,. \u00b7 \u00b7 Jm = [n], and P = {\u03c61,.} a set of factors over vectors XJ1,., XJm, respectively. We refer to P as a graphical model if there is a common probability distribution over assignments x,. X ByPr (X = x) = 1Z,."}, {"heading": "4. Clique-Tree Computation", "text": "Let us convert from a tree to a tree, which is usually converted from a tree to a tree. (...) We say that T is a climatic tree for i, if we have a graphical model for i = 1,. Let P be a graphical model, whose factors are 1,.., It is defined by the sentences XJ1.., XJk, respectively J1., and J1., respectively J1. We say that T is a climatic tree for i, if for i = 1,., k., there is 1,., Ji., so that Ji., we assume that Ji., we are responsible for the ease of exposure and without loss of the tree., if T is a clique tree for i.,."}, {"heading": "5. Propagating Sets", "text": "The question that arises is whether it is a collection of factors obtained in this way, and whether it is a clique tree for this model. Then, it is also a clique tree for every other graphical model obtained by K1,.. Km, is the basis of the factor selection process in Algorithm 2, which performs a search across the space of assignments while making sets of factors about the clique tree.The algorithms resemble factor-triggering factors, but it propagates sets of factors that affect the space of assignment."}, {"heading": "5.1. Pruning", "text": "The trade-off between the quality of the solution and the calculation time is determined by parameters k1,..........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................."}, {"heading": "6. Anytime Inference", "text": "An algorithm available at any time is a procedure that can be interrupted at any time with a reasonable solution, the quality of which is a monotonous function of runtime. Therefore, algorithms always allow a trade-off between computation time and solution quality. We can easily transform the factor-clause elimination into an algorithm available at any time, which continuously improves the lower and upper limits by setting the maximum specified cardinalities k1,..., km. The procedure is described in Algorithm 3. The algorithm available at any time begins by continuing the factor-clause elimination with all maxi algorithms 3. Prerequisite: A clique tree T sets K1,...., Km and integer c1: let k (0) 1 = 1,.... k (0) m = 1, Z (0) l: 0 and Z (n) l: 1)."}, {"heading": "7. Experiments", "text": "The first group, which appears in the first five lines of the book, consists of two people who are all able to find the solution; the second group, which is able to find the solution, which is able to find the solution, which is able to find the solution; the third group, which is able to find the solution, which is able to find the solution; the third group, which is able to find the solution, which is able to find the solution; the third group, which is able to find the solution, which is able to find the solution; the third group, which is able to find the solution, which is able to find the solution; the third group, which is able to enter the solution, which is able to find the solution."}, {"heading": "8. Conclusion", "text": "By conducting experiments with real and synthetic graphical models, we show that the proposed algorithm is competitive compared to the systematic search of Park & Darwiche (2003). Especially if the problems have a moderate tree width but a large search space, our algorithm compares favourably. Unfortunately, the boundaries returned by the algorithm become too loose as the tree width increases, which could be mitigated by breaking down the propagated factors into smaller domains, as in the work of Meek & Wexler (2011)."}, {"heading": "Acknowledgments", "text": "This work was partially supported by the Swiss NSF grants no. 200020 134759 / 1 and 200020 132252."}], "references": [{"title": "New complexity results for MAP in Bayesian networks", "author": ["C.P. de Campos"], "venue": "In IJCAI", "citeRegEx": "Campos,? \\Q2011\\E", "shortCiteRegEx": "Campos", "year": 2011}, {"title": "Message-passing for approximate MAP inference with latent variables", "author": ["J. Jiang", "P. Rai", "III", "H. Daume"], "venue": "In NIPS", "citeRegEx": "Jiang et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Jiang et al\\.", "year": 2011}, {"title": "Probabilistic Graphical Models: Principles and Techniques", "author": ["D. Koller", "N. Friedman"], "venue": null, "citeRegEx": "Koller and Friedman,? \\Q2009\\E", "shortCiteRegEx": "Koller and Friedman", "year": 2009}, {"title": "Variational algorithms for marginal MAP", "author": ["Q. Liu", "A. Ihler"], "venue": "In UAI", "citeRegEx": "Liu and Ihler,? \\Q2011\\E", "shortCiteRegEx": "Liu and Ihler", "year": 2011}, {"title": "Approximating max-sumproduct problems using multiplicative error bounds", "author": ["C. Meek", "Y. Wexler"], "venue": "Bayesian Statistics,", "citeRegEx": "Meek and Wexler,? \\Q2011\\E", "shortCiteRegEx": "Meek and Wexler", "year": 2011}, {"title": "Solving MAP exactly using systematic search", "author": ["J.D. Park", "A. Darwiche"], "venue": "In UAI", "citeRegEx": "Park and Darwiche,? \\Q2003\\E", "shortCiteRegEx": "Park and Darwiche", "year": 2003}, {"title": "Complexity results and approximation strategies for MAP explanations", "author": ["J.D. Park", "A. Darwiche"], "venue": "JAIR, 21:101\u2013133,", "citeRegEx": "Park and Darwiche,? \\Q2004\\E", "shortCiteRegEx": "Park and Darwiche", "year": 2004}], "referenceMentions": [{"referenceID": 0, "context": "A positive result has recently been given by de Campos (2011), which derived a fully polynomial-time approximation scheme when both treewidth and number of states per variable are bounded.", "startOffset": 48, "endOffset": 62}, {"referenceID": 1, "context": "When it is hard, researchers have resorted to loopy belief propagation algorithms (Liu & Ihler, 2011; Jiang et al., 2011) and factor decomposition (Meek & Wexler, 2011).", "startOffset": 82, "endOffset": 121}, {"referenceID": 1, "context": "Variants of this procedure have recently been justified as an approximation by variational inference (Liu & Ihler, 2011; Jiang et al., 2011).", "startOffset": 101, "endOffset": 140}, {"referenceID": 0, "context": "Finally, in the spirit of the result by de Campos (2011) it is possible to show that the anytime algorithm is also a fully polynomial-time approximation scheme for graphical models if we assume that both the treewidth and the number of values a variable can assume are bounded.", "startOffset": 43, "endOffset": 57}], "year": 2012, "abstractText": "This paper presents a new anytime algorithm for the marginal MAP problem in graphical models of bounded treewidth. We show asymptotic convergence and theoretical error bounds for any fixed step. Experiments show that it compares well to a state-of-the-art systematic search algorithm.", "creator": "LaTeX with hyperref package"}}}