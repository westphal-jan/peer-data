{"id": "1206.6459", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "27-Jun-2012", "title": "Bayesian Conditional Cointegration", "abstract": "Cointegration is an important topic for time-series, and describes a relationship between two series in which a linear combination is stationary. Classically, the test for cointegration is based on a two stage process in which first the linear relation between the series is estimated by Ordinary Least Squares. Subsequently a unit root test is performed on the residuals. A well-known deficiency of this classical approach is that it can lead to erroneous conclusions about the presence of cointegration. As an alternative, we present a framework for estimating whether cointegration exists using Bayesian inference which is empirically superior to the classical approach. Finally, we apply our technique to model segmented cointegration in which cointegration may exist only for limited time. In contrast to previous approaches our model makes no restriction on the number of possible cointegration segments.", "histories": [["v1", "Wed, 27 Jun 2012 19:59:59 GMT  (426kb)", "http://arxiv.org/abs/1206.6459v1", "Appears in Proceedings of the 29th International Conference on Machine Learning (ICML 2012)"]], "COMMENTS": "Appears in Proceedings of the 29th International Conference on Machine Learning (ICML 2012)", "reviews": [], "SUBJECTS": "cs.CE cs.LG stat.ME", "authors": ["chris bracegirdle", "david barber"], "accepted": true, "id": "1206.6459"}, "pdf": {"name": "1206.6459.pdf", "metadata": {"source": "META", "title": "Bayesian Conditional Cointegration", "authors": ["Chris Bracegirdle", "David Barber"], "emails": ["c.bracegirdle@cs.ucl.ac.uk", "d.barber@cs.ucl.ac.uk"], "sections": [{"heading": "1. Introduction", "text": "Cointegration is an important concept in time series analysis and refers to the fact that the differences between two time series can be more predictable than each individual time series itself. We make two contributions to this area - firstly, we formulate the determination of whether two series are cointegrated as an instance of Bayesian conclusions in a related probability model, which allows us to incorporate modern statistical and machine learning techniques into the analysis of cointegration and also provides a useful conceptual framework for describing cointegration. The resulting regression estimation algorithm proves to be more robust than estimating the smallest squares to false results. This is what we believe in the presentations of the 29th International Conference on Machine Learning, Edinburgh, Scotland, UK, 2012. Copyright 2012 of the / Owner. Important result that demonstrates a new and coherent approach to the long-standing problem of inconsistency in establishing cohesion. Secondly, two series can only be integrated intermittently - that this is a problem of only three time series."}, {"heading": "1.1. Cointegration", "text": "While individual time series may not be predictable, the relationships between two time series may be more predictable than an integrated sequence. For example, the series x1: T is formed byxt + 1 = xt + 1, yt + 1 = Harris + 1, t \u0445 N (0, 1) both follow an unpredictable random course. However, the future difference xt + 1 = xt \u2212 yt is perfectly predictable given the knowledge of the current price difference. Such instances are common in economic and financial literature; for example, underlying mechanisms such as limited money supply can forge dependencies between time series (Dickey et al., 1991). It is of considerable interest to find pairs of asset price series that are co-integrated - such an estimate of the classic statistical arbitrage strategies known as \"trading pairs.\""}, {"heading": "2. Modelling Cointegration", "text": "Our approach is to build a generative model of observations p (y1: T x1: T, \u03b2sian), where \u03b8 = {\u03b1, \u03b2, \u03c32, \u03c6}. First, we build a generative model for the observations1 y1: T and latent variables 1: Tp (y1: T, 1: T x1: T) = dits t (yt xt, t) p (t t t t xt, 1). \u2212 The faith network (see Barber (2012) for an introduction) for this model is in Figure 1. The probability for the observations is y1: T is determined by p (y1: T x1: T x1: T x1: T). \u2212 The faith network (see Barber (2012) for an introduction) is in Figure 1. The probability for the observation1: T is determined by p (y1: T x1: T x1: T x1: T)."}, {"heading": "3. Bayesian Cointegration", "text": "We can construct a model for estimating both \u03c6 and the parameters \u03b1, \u03b2, \u03c32 by treating \u03c6 as a latent variable and providing a prior distribution. In this case, we need to cointegrate | \u03c6 | < 1, and we can encode this with a uniform distribution p (\u03c6) = U (\u03c6 (\u2212 1, 1)) = 1 2 [\u03c6 (\u2212 1, 1)]. We complete the model specification with a distribution for 1 and form the common model (y1: T, 1: T, \u03c6 x1: T) = p (y1: T 1: T, x1: T) p (1: T) p (\u03c6) from which the boundary model (y1: T, \u03c6 x1: T) = p (\u03c6) and 1: T p (y1: T) p (1: \u03c6) p (1: T) is formed."}, {"heading": "3.1. Inference of \u03c6", "text": "The process 1: T is stationary if 3 < t > = 0 and 2t t t are constant respectively, independent of t. According to the relapse relation for t, the variance fulfills 2t + 1 = \u03c62 2t + \u03c32 and we can therefore ensure that there is 1: T if 21 = \u03c32 / (1 \u2212 \u03c62). We then select p (1 \u2212 2) = N (1 0, \u03c3 2 / (1 \u2212 \u03c62))). The rear p (\u03c6 1: T) is proportional to p (\u03c6) \u221a 1 \u2212 2 exp \u2212 1 2\u04412 [21 (1 \u2212 2) + T \u2211 t = 2 (t \u2212 \u03c6 t \u2212 1) 2], and by completing the square we see that the rear p (\u03c6 1: T) is proportional to a shortened Gaussian distribution with a prefactor (subject to normalization), p (\u03c6) + T \u2212 1 \u2212 12 \u2212 1 1 1 2 2 2, with the rear T having an abbreviated Gaussian distribution with a prefactor (\u03c6 1: T) of a shortened Gausan abbreviated Gausan distribution with a prefactor (subject to normalization), p (\u03c6) + T \u2212 2 \u2212 2), p (2) 2 \u2212 2 2."}, {"heading": "3.2. Estimating \u03b1, \u03b2, \u03c32", "text": "We are interested in setting the parameters. \u2212 p \u2212 p \u2212 p \u2212 p (1: T) p (1: T) p (1: T) p (1: T) p (1: T) p (1: T) p (1: T).Since \u03c6 is a latent variable, it is convenient to do this using the expectation maximisation algorithm. p (h) log for the observations and h for the latent variables EM based on the Kullback Leibler limit 0 \u2264 KL (p) p (h) p (h) q (h) p (h) p (v) p (v) p (v) \u2265 < log p (h, v) > q (h) p (h) p (h) q (h) v) p (h) p (h) p (v) p) p (v) p (p) \u2265 < log p (h, v) p)."}, {"heading": "4. The Random Walk model", "text": "A primary concern in economic literature is to test the co-integration hypothesis for series, and the analogy to our Bayesian generative model is to compare the probabilities of the above co-integration model and a random walk (RW) model; the probability for 1: T a RW then becomes according to the Bayes factor p (y1: T x1: T; \u03c6 = 1) p (y1: T x1: T; < 1) p (1: T) p (1: T) p (1: T) p (1: T x1: T; p (t) p (1: T x1: T; p) p (t) p (p (t) p (p (t) p (1: T) p (1: T) p (1: T; 1 T; 1: 1 T; 1: 1 T; 1: 1 T &p; 1 T &p; 1 T &p (1: T; 1 T) &p; 1 T &p (1: T) p; 1 T &p; 1 T (1: T) p; 1 T (1: 1 T) p; 1 T &p; 1 T &p (t) p (1: T) p; 1 T &p (1: T) p; 1 T (t) p (1: 1 T) p; 1 T &p; 1 T (t) p: 1: 1 T (t) p; 1: 1 T (t) p (1: 1: 1 T) p; 1 T (t &p (t) p (1: 1: T) p; 1 T: 1: 1 T (t) p; 1: 1: 1 T (t) p (t) p; 1 t &p; 1 T: 1: 1 T: 1: 1 T (t; 1: 1 T: 1 t) p (t."}, {"heading": "4.1. Point Estimation", "text": "Both the counter and the denominator of the Bayes factor are functions in the variance \u03c32, and we set \u03c3 for each of the two models according to ML. The estimate for \u03c32 for the RW model is based on the principle of \u03c3 \u0445 2 = 1T \u2212 1 T \u2211 t = 2 (t \u2212 t \u2212 1) 2. Note that here t depends on \u03b1 and \u03b2, and we are now discussing possible ways of determining point estimates for these parameters. There are three primary options: (i) Find the parameters according to the OLS and use these values for both the cointegration and the RW model; (ii) Find the parameters according to ML in the cointegration model and use the same parameters for the RW model; and (iii) Find the parameters for each of the cointegration and RW models according to ML. Conceptually, our interest is to first estimate a cointegration relationship according to ML and secondly to calculate whether this relationship is more random and whether the third option is the ASS."}, {"heading": "5. Intermittent Cointegration", "text": "A good example is the gas pipeline between Bacton, UK, and Zeebrugge, Belgium, which allows gas to flow between the two countries, thus providing a direct link in the gas price at each end. If the pipeline is closed for maintenance each year, the link between the prices is temporarily interrupted. Kim (2003) showed that classic tests for cointegration cannot detect a relationship, although there is one for part of the series. < C The following model attempts to detect a cointegration relationship between two series, while allowing regions if the relationship is indeed random. 5Differing decision thresholds correspond to different levels of equality before 1 in the RW model. < C The following model attempts to detect a cointegration relationship between two series, while allowing regions if the relationship is more random."}, {"heading": "5.2. Likelihood", "text": "It is useful to evaluate the probability to (i) ensure that the probability is maximized, and (ii) provide a convergence criterion. Fortunately, the probability is easy to calculate, since the value is given by the product of the normalization constant from each step of the filter recursion, p (1: T) = p (1) T-T = 2 p (t 1: t \u2212 1) = p (1) T-T = 2 twoat each Zt during filtering, see the supplementary material."}, {"heading": "5.3. Learning", "text": "For this problem of regime change, the latent variables h \u2192 {i2: T, \u03c62: T}, and the observations remain as before, v \u2192 1: T. Relevant for the optimal solution is the sum of the square shapes with varying \u03c6t, (t \u2212 \u03c6t \u2212 1) 2 = 2t \u2212 2 t \u2212 1 < \u03c6t > + 2t \u2212 1 \u03c62 derived in Section 3.2. By retaining the first and second (non-central) moments of each component found during filtering, the linear equation system for regression parameters can be solved precisely in this switching model and the estimation of variance updated accordingly."}, {"heading": "5.4. Point Estimate of \u03c6t", "text": "While our model gives a distribution over \u03c6t for each point in time to reflect our approach Sep 2010 Sep 2011 11,522.5Sep 2010 Sep 2011 \u2212 0.6 \u2212 0.4 \u2212 0.200.20.4Sep 2010 Sep 2011 00.20.40.60.81Sep 2010 Sep 2011 \u2212 0.200.20.40.60.811.2Figure 6. Learning results for interconnector gas prices - maintenance is performed every September. We show (NW) the price range xt, yt; (SW) residues that do not match the final estimates for \u03b1, \u03b2; (NE) filtered (blue) and smoothed (red) posterior for random walk it = 1; and (SE) the maximum posterior marginal result for \u0441t. to other intermittent cointegration methods that only give point estimates, we can take eachi \u0442t = arg max it p (it 1: T) and then calculate the posterior (subordinate)."}, {"heading": "6. Experiments", "text": "We consider real-world applications for the intermittent cointegration model. For these experiments, we performed the inference and learning algorithm for the parameters \u03b8 = {\u03b1, \u03b2, \u03c3} initialized by the OLS and used the state transition distributions fixed on values corresponding to our a priori belief in the cointegration regimes."}, {"heading": "6.1. Gas Prices", "text": "As mentioned in paragraph 5, the interconnector pipeline is a natural gas pipeline under the sea: we have calculated the prices for UK gas 6 and for Zeebrugge x the prices for Zeebrugge 7. There are approximately 6UK SAP natural gas prices have been converted to kWh using 1 kWh = 29,3072222 therm.245 price days per year from www.nationalgrid.com / uk / gas / Data.7The pipeline closes annually for two weeks, so we specified the transitional state distribution accordingly. The algorithm achieves convergence within four minutes with parameters \u03b1, \u03b2 showing co-integration between the annual maintenance period, see Figure 6."}, {"heading": "6.2. Euro-area Bond Yields", "text": "We use the switching model of cointegration to find regions of cointegration that we expect to be maintained until the yield on Greek debt soars as the Greek debt burden takes its toll. Results are shown in Figure 7; inference and learning takes about five minutes. This is an example where the data over the time window shown in the figure show no cointegration according to the classic test (Dickey-Fuller test shows the p-value 0.927241 and does not reject the random zero hypothesis), but the intermittent cointegration model shows a segment of cointegration - the classic test exists in the detected region and fails for the remaining time. While our approach is both flexible and simple, there are limitations. In particular, the switching model 8Bond yield data was obtained from Reuters.that the regions of cointegration are governed by a time-invariant linear relationship."}, {"heading": "7. Discussion", "text": "We introduced two new techniques for estimating a linear cointegration relationship for time series. First, the method in Section 3 allows estimating a linear relationship between variables, and we showed that our resulting algorithm is less likely to create a false relationship than the classic OLS unit approach. The advantage of our approach is that it leads to a fast O (T) algorithm for testing cointegration. A natural extension would be to consider a more complete Bayesian analysis and to marginalize all parameters in both the cointegration and the random-walk model. Second, we developed a circuit model to detect a relationship and regimes in which this relationship is a random occurrence. While the model has an obvious limitation (shared by other existing intermittent cointegration models), it has the advantage of fast exact inference, scaling O (T 2). Another natural extension would be to include the variation of regiments that can also be included."}, {"heading": "Acknowledgements", "text": "We thank Ricardo Silva for useful discussions."}, {"heading": "A. Sequential inference of \u03c6", "text": "In view of a sequence of \"observations\" 1: \u2212 T we describe here a method for sequential updating of the posterior distribution p (\u2212 1) = U (1 R), which represents our belief that 1 can assume any real value and use a recursive update routine - see for example Barber (2012).First, we start with the previous p (\u03c6) = U (\u2212 1, 1 R) and then update the distribution by placing the posterior after observing each. For one, there is no update that we can perform since p (\u03c6 1) p (? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p? p p? p? p? p? p? p? p? p? p p? p? p? p p? p? p? p? p p? p? p? p p? p p? p p? p? p p? p? p? p p p p? p p? p? p? p p? p p? p p p? p? p? p? p? p? p? p p? p p p? p? p p p p? p? p p p? p? p? p p p? p? p? p p p? p? p? p p p p? p? p"}], "references": [{"title": "Bayesian Reasoning and Machine Learning", "author": ["D. Barber"], "venue": null, "citeRegEx": "Barber,? \\Q2012\\E", "shortCiteRegEx": "Barber", "year": 2012}, {"title": "Switch-Reset Models : Exact and Approximate Inference", "author": ["C. Bracegirdle", "D. Barber"], "venue": "In AISTATS,", "citeRegEx": "Bracegirdle and Barber,? \\Q2011\\E", "shortCiteRegEx": "Bracegirdle and Barber", "year": 2011}, {"title": "A primer on cointegration with an application to money and income", "author": ["D.A. Dickey", "D.W. Jansen", "D.L. Thornton"], "venue": "Federal Reserve Bank of St. Louis Review,", "citeRegEx": "Dickey et al\\.,? \\Q1991\\E", "shortCiteRegEx": "Dickey et al\\.", "year": 1991}, {"title": "Developments in the study of cointegrated economic variables", "author": ["C.W.J. Granger"], "venue": "Oxford Bulletin of Economics and Statistics,", "citeRegEx": "Granger,? \\Q1986\\E", "shortCiteRegEx": "Granger", "year": 1986}, {"title": "Applied Time Series Modelling", "author": ["R. Harris", "R. Sollis"], "venue": "nal of Econometrics,", "citeRegEx": "Harris and Sollis,? \\Q1996\\E", "shortCiteRegEx": "Harris and Sollis", "year": 1996}], "referenceMentions": [{"referenceID": 2, "context": "In the economics and finance literature such instances are common; for example underlying mechanisms such as limited money supply may forge dependencies between time-series (Dickey et al., 1991).", "startOffset": 173, "endOffset": 194}, {"referenceID": 3, "context": "Testing for and estimating a cointegration relationship is classically a two-step process (Granger, 1986).", "startOffset": 90, "endOffset": 105}, {"referenceID": 3, "context": "Testing for and estimating a cointegration relationship is classically a two-step process (Granger, 1986). Firstly, the regression equation is estimated based on a simple ordinary least squares (OLS) fit to minimise \u2211 t(yt\u2212\u03b1\u2212\u03b2xt) (which we show is equivalent to maximum likelihood (ML) parameter optimisation assuming that \u03c6 = 0 in a corresponding model). Subsequently, a test for a unit root in the residuals is performed using the Dickey-Fuller test, see for example Harris & Sollis (2003), which tests the hypothesis that \u03c6 = 1 against the alternative |\u03c6| < 1 (for |\u03c6| < 1 the series is stationary and non-stationary otherwise).", "startOffset": 91, "endOffset": 492}, {"referenceID": 0, "context": "The belief network (see Barber (2012) for an introduction) for this model is given in figure 1.", "startOffset": 24, "endOffset": 38}, {"referenceID": 0, "context": "The model is therefore an example of the \u2018reset model\u2019 as set out by Bracegirdle & Barber (2011), and we apply such results here.", "startOffset": 83, "endOffset": 97}, {"referenceID": 0, "context": "However, we appeal to the result of Bracegirdle & Barber (2011) that by indexing the components in the filtered posterior according to the number of observations since a switch to cointegration, the smoothing recursion can be written exactly.", "startOffset": 50, "endOffset": 64}], "year": 2012, "abstractText": "Cointegration is an important topic for timeseries, and describes a relationship between two series in which a linear combination is stationary. Classically, the test for cointegration is based on a two stage process in which first the linear relation between the series is estimated by Ordinary Least Squares. Subsequently a unit root test is performed on the residuals. A well-known deficiency of this classical approach is that it can lead to erroneous conclusions about the presence of cointegration. As an alternative, we present a framework for estimating whether cointegration exists using Bayesian inference which is empirically superior to the classical approach. Finally, we apply our technique to model segmented cointegration in which cointegration may exist only for limited time. In contrast to previous approaches our model makes no restriction on the number of possible cointegration segments.", "creator": "LaTeX with hyperref package"}}}