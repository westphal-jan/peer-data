{"id": "1501.01239", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "6-Jan-2015", "title": "On the Relationship between Sum-Product Networks and Bayesian Networks", "abstract": "In this paper, we establish some theoretical connections between Sum-Product Networks (SPNs) and Bayesian Networks (BNs). We prove that every SPN can be converted into a BN in linear time and space in terms of the network size. The key insight is to use Algebraic Decision Diagrams (ADDs) to compactly represent the local conditional probability distributions at each node in the resulting BN by exploiting context-specific independence (CSI). The generated BN has a simple directed bipartite graphical structure. We show that by applying the Variable Elimination algorithm (VE) to the generated BN with ADD representations, we can recover the original SPN where the SPN can be viewed as a history record or caching of the VE inference process. To help state the proof clearly, we introduce the notion of {\\em normal} SPN and present a theoretical analysis of the consistency and decomposability properties. We conclude the paper with some discussion of the implications of the proof and establish a connection between the depth of an SPN and the tree-width of its corresponding BN.", "histories": [["v1", "Tue, 6 Jan 2015 17:14:11 GMT  (496kb,D)", "https://arxiv.org/abs/1501.01239v1", "17 pages"], ["v2", "Thu, 30 Apr 2015 18:15:12 GMT  (584kb,D)", "http://arxiv.org/abs/1501.01239v2", "Full version of the same paper to appear at ICML-2015"]], "COMMENTS": "17 pages", "reviews": [], "SUBJECTS": "cs.AI stat.ML", "authors": ["han zhao", "mazen melibari", "pascal poupart"], "accepted": true, "id": "1501.01239"}, "pdf": {"name": "1501.01239.pdf", "metadata": {"source": "META", "title": "On the Relationship between Sum-Product Networks and Bayesian Networks", "authors": ["Han Zhao", "Mazen Melibari", "Pascal Poupart"], "emails": ["HAN.ZHAO@UWATERLOO.CA", "MMELIBAR@UWATERLOO.CA", "PPOUPART@UWATERLOO.CA"], "sections": [{"heading": "1. Introduction", "text": "This year is the highest in the history of the country."}, {"heading": "2. Related Work", "text": "In fact, it is such that most of us will be able to go to another world, in which they can go to another world, in which they are able to explore another world, in which they are able to explore another world, in which they are able to explore another world, in which they are able to explore another world, in which they are able to live in another world, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live in which they live, in which they live, in which they live, in which they live in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live."}, {"heading": "3. Preliminaries", "text": "We begin with the introduction of the notation used in this thesis. We use 1: N to abbreviate the notation {1, 2,.., N}. We use an uppercase letter X to denote a random variable, and a bold uppercase letter X1: N to denote a set of random variables X1: N = {X1,., XN}. Similarly, a lowercase letter x is used to denote a value taken by X, and a bold lowercase letter X1: N to denote a common value taken by the corresponding vector X1: N of random variables. We can omit the subscript 1: N of X1: N and x1: N if it is clear from context. For a random variable X1: J, we use x i, j: J to list all values taken by Xi."}, {"heading": "3.1. Bayesian Network", "text": "Consider a problem whose domain is characterized by a series of random variables X1: N with finite support. Common probability distribution via X1: N can be characterized by a Bayesian network that is a DAG in which nodes represent random variables and edges represent probable dependencies between variables. In a BN, we also use the terms \"nodes\" and \"variable\" interchangeably. For each variable in a BN, there is a local conditional probability distribution (CPD) via the variable in the BN. The structure of a BN encodes conditional independence between the variables in the BN. Let X1, X2,.., XN be a topological order of all nodes in a BN3 and let Xi be the parent set of the node Xi in the BN."}, {"heading": "3.2. Algebraic Decision Diagram", "text": "We first give a formal definition of algebraic decision diagrams (ADDs) for variables with Boolean domains and then extend the definition to domains that correspond to arbitrary finite sequences. Definition 1 (Algebraic decision diagrams (Bahar et al., 1997). An algebraic decision diagram (ADD) is a graphical representation of a real function with Boolean input variables: f: {0, 1} N 7 \u2192 R, where the graph is a rooted DAG. There are two types of nodes in an ADD. Terminal nodes whose out-degree is 0 are associated with real values. Internal nodes whose out-degree is associated with Boolean variables Xn, n: N. For each internal node Xn: Xn, the left outer edge of Xn is X.X."}, {"heading": "3.3. Sum-Product Network", "text": "In fact, it is a way in which people are able to determine for themselves what they want and what they want. (...) In fact, it is a way in which people are able to decide what they want. (...) In fact, it is a way in which people are able to decide what they want. (...) It is as if people are able to decide what they want. (...) It is as if they want, as if they want, as if they want, as if they want, as if they want, as if they want, as if they want, as if they want, as if they want, as if they want, as if they want. \"(...)"}, {"heading": "4. Main Results", "text": "In this area, we are able to realize the aforementioned results in the way that they are able to correct and correct the aforementioned errors."}, {"heading": "4.1. Normal Form", "text": "In order to demonstrate this, we must first take the following measures: \"We must strive for a solution.\" (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution.\" (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution.\" (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution.\" (\"We must strive for a solution.\") (\"We must strive for a solution.\" (\"We must strive for a solution.\") (\"We must strive for a solution.\" We must strive for a solution. \") (\" We must strive for a solution. \"(\" We must strive for a solution. \") (\" We must strive for a solution. \"We must strive for a solution.\") (\"We must strive for a solution.\" (\"We must strive for a solution.\") (We must strive for a solution. \"We must strive for a solution.\" (\"We must strive for a solution.\") (\"We must strive for a solution.\" We must strive for a solution. \"(\" We must strive for a solution. \") (\" We must strive for a solution. \"We must strive for a solution.\" (\"We must strive for a solution.\") (\"We must strive for a solution.\") (\"We must strive for a solution. (\" We must strive for a solution. \"We must strive for a solution.\") (\"We must strive for a solution. (\" We must strive for a solution. \"We must strive for a solution."}, {"heading": "4.2. SPN to BN", "text": "To construct a BN, we must transform the SPN into a normal form, otherwise we can transform it into a normal form in which they can associate a hidden variable with a hidden variable. (Hv = i) Since it is normal that we have a normal structure, we must associate ourselves in a normal way with a hidden variable. (Hv = i) Since we have a normal structure, we can create a hidden discrete variable Hv with multinomial distribution Prv = i. (Hv = i) for each sum node S. Thus, S can be thought of as the definition of a common probability distribution over X1: N and H = {Hv = H = H)."}, {"heading": "4.3. BN to SPN", "text": "It is well known that the two candidates are two candidates who stand in the first row and then stand in the second row. \"It is not yet clear whether they will stand in the second row,\" he says. \"But it is not yet clear whether they will stand in the third row.\""}, {"heading": "5. Discussion", "text": "This year, it has come to the point where it will be able to put itself at the top, \"he said in an interview with the\" Welt am Sonntag. \""}, {"heading": "6. Conclusion", "text": "In this paper, we establish a precise link between BNs and SPNs by providing a constructive algorithm for transformation between these two models. To simplify the proof, we introduce the notion of a normal SPN and describe the relationship between consistency and decomposition in SPNs. We analyze the effects of the depth of SPNs on the tree width of the corresponding BNs. Our work also provides a new direction for future research on SPNs and BNs. Structural and parameter learning algorithms for SPNs can now be used to indirectly learn BNs with ADD. In the resulting BNs, correlations are expressed not through connections between observed variables, but through hidden variables, which are ancestors of correlated observed variables. The structure of the resulting BNs can be used to study probable dependencies and causal relationships between the variables of the original SPNs. It would also be interesting to explore the opposite directions, as there is already a large literature on them."}], "references": [{"title": "Sum-product networks for modeling activities with stochastic structure", "author": ["Amer", "Mohamed R", "Todorovic", "Sinisa"], "venue": "In Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "Amer et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Amer et al\\.", "year": 2012}, {"title": "Algorithms and complexity results for #SAT and bayesian inference", "author": ["Bacchus", "Fahiem", "Dalmao", "Shannon", "Pitassi", "Toniann"], "venue": "In Foundations of Computer Science,", "citeRegEx": "Bacchus et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Bacchus et al\\.", "year": 2003}, {"title": "Algebraic decision diagrams and their applications", "author": ["Bahar", "R Iris", "Frohm", "Erica A", "Gaona", "Charles M", "Hachtel", "Gary D", "Macii", "Enrico", "Pardo", "Abelardo", "Somenzi", "Fabio"], "venue": "Formal methods in system design,", "citeRegEx": "Bahar et al\\.,? \\Q1997\\E", "shortCiteRegEx": "Bahar et al\\.", "year": 1997}, {"title": "The good old davis-putnam procedure helps counting models", "author": ["Birnbaum", "Elazar", "Lozinskii", "Eliezer L"], "venue": "arXiv preprint arXiv:1106.0218,", "citeRegEx": "Birnbaum et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Birnbaum et al\\.", "year": 2011}, {"title": "Graph-based algorithms for boolean function manipulation", "author": ["Bryant", "Randal E"], "venue": "Computers, IEEE Transactions on,", "citeRegEx": "Bryant and E.,? \\Q1986\\E", "shortCiteRegEx": "Bryant and E.", "year": 1986}, {"title": "On contrastive divergence learning", "author": ["Carreira-Perpinan", "Miguel A", "Hinton", "Geoffrey E"], "venue": "In Proceedings of the tenth international workshop on artificial intelligence and statistics,", "citeRegEx": "Carreira.Perpinan et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Carreira.Perpinan et al\\.", "year": 2005}, {"title": "Compiling bayesian networks using variable elimination", "author": ["Chavira", "Mark", "Darwiche", "Adnan"], "venue": "In IJCAI,", "citeRegEx": "Chavira et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Chavira et al\\.", "year": 2007}, {"title": "Compiling relational bayesian networks for exact inference", "author": ["Chavira", "Mark", "Darwiche", "Adnan", "Jaeger", "Manfred"], "venue": "International Journal of Approximate Reasoning,", "citeRegEx": "Chavira et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Chavira et al\\.", "year": 2006}, {"title": "Language modeling with sum-product networks", "author": ["Cheng", "Wei-Chen", "Kok", "Stanley", "Pham", "Hoai Vu", "Chieu", "Hai Leong", "Chai", "Kian Ming A"], "venue": "In Fifteenth Annual Conference of the International Speech Communication Association,", "citeRegEx": "Cheng et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Cheng et al\\.", "year": 2014}, {"title": "A differential approach to inference in bayesian networks", "author": ["Darwiche", "Adnan"], "venue": "In UAI, pp", "citeRegEx": "Darwiche and Adnan.,? \\Q2000\\E", "shortCiteRegEx": "Darwiche and Adnan.", "year": 2000}, {"title": "Decomposable negation normal form", "author": ["Darwiche", "Adnan"], "venue": "Journal of the ACM (JACM),", "citeRegEx": "Darwiche and Adnan.,? \\Q2001\\E", "shortCiteRegEx": "Darwiche and Adnan.", "year": 2001}, {"title": "A perspective on knowledge compilation", "author": ["Darwiche", "Adnan", "Marquis", "Pierre"], "venue": "In IJCAI,", "citeRegEx": "Darwiche et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Darwiche et al\\.", "year": 2001}, {"title": "Shallow vs. deep sum-product networks", "author": ["Delalleau", "Olivier", "Bengio", "Yoshua"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "Delalleau et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Delalleau et al\\.", "year": 2011}, {"title": "Learning the architecture of sum-product networks using clustering on variables", "author": ["Dennis", "Aaron", "Ventura", "Dan"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "Dennis et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Dennis et al\\.", "year": 2012}, {"title": "Discriminative learning of sum-product networks", "author": ["Gens", "Robert", "Domingos", "Pedro"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "Gens et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Gens et al\\.", "year": 2012}, {"title": "Learning the structure of sum-product networks", "author": ["Gens", "Robert", "Domingos", "Pedro"], "venue": "In Proceedings of The 30th International Conference on Machine Learning,", "citeRegEx": "Gens et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Gens et al\\.", "year": 2013}, {"title": "Solving map exactly by searching on compiled arithmetic circuits", "author": ["Huang", "Jinbo", "Chavira", "Mark", "Darwiche", "Adnan"], "venue": "In AAAI,", "citeRegEx": "Huang et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Huang et al\\.", "year": 2006}, {"title": "Learning DNF by decision trees", "author": ["Pagallo", "Giulia"], "venue": "In IJCAI,", "citeRegEx": "Pagallo and Giulia.,? \\Q1989\\E", "shortCiteRegEx": "Pagallo and Giulia.", "year": 1989}, {"title": "Greedy part-wise learning of sum-product networks", "author": ["Peharz", "Robert", "Geiger", "Bernhard C", "Pernkopf", "Franz"], "venue": "In Machine Learning and Knowledge Discovery in Databases,", "citeRegEx": "Peharz et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Peharz et al\\.", "year": 2013}, {"title": "Modeling speech with sum-product networks: Application to bandwidth extension", "author": ["Peharz", "Robert", "Kapeller", "Georg", "Mowlaee", "Pejman", "Pernkopf", "Franz"], "venue": "In Acoustics, Speech and Signal Processing (ICASSP),", "citeRegEx": "Peharz et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Peharz et al\\.", "year": 2014}, {"title": "Sum-product networks: A new deep architecture", "author": ["Poon", "Hoifung", "Domingos", "Pedro"], "venue": "In Proc. 12th Conf. on Uncertainty in Artificial Intelligence,", "citeRegEx": "Poon et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Poon et al\\.", "year": 2011}, {"title": "Learning sum-product networks with direct and indirect variable interactions", "author": ["Rooshenas", "Amirmohammad", "Lowd", "Daniel"], "venue": "In Proceedings of The 31st International Conference on Machine Learning,", "citeRegEx": "Rooshenas et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Rooshenas et al\\.", "year": 2014}, {"title": "On the hardness of approximate reasoning", "author": ["Roth", "Dan"], "venue": "Artificial Intelligence,", "citeRegEx": "Roth and Dan.,? \\Q1996\\E", "shortCiteRegEx": "Roth and Dan.", "year": 1996}, {"title": "Performing bayesian inference by weighted model counting", "author": ["Sang", "Tian", "Beame", "Paul", "Kautz", "Henry A"], "venue": "In AAAI,", "citeRegEx": "Sang et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Sang et al\\.", "year": 2005}, {"title": "Probabilistic diagnosis using a reformulation of the INTERNIST-1/QMR knowledge base", "author": ["Shwe", "Michael A", "B Middleton", "DE Heckerman", "M Henrion", "EJ Horvitz", "HP Lehmann", "Cooper", "GF"], "venue": "Methods of information in Medicine,", "citeRegEx": "Shwe et al\\.,? \\Q1991\\E", "shortCiteRegEx": "Shwe et al\\.", "year": 1991}, {"title": "Exploiting causal independence in bayesian network inference", "author": ["Nevin Lianwen", "Poole", "David"], "venue": "Machine Learning,", "citeRegEx": "Lianwen et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Lianwen et al\\.", "year": 2008}], "referenceMentions": [{"referenceID": 2, "context": "We prove in this paper that by adopting Algebraic Decision Diagrams (ADDs) (Bahar et al., 1997) to represent the CPDs at each node in a BN, every SPN can be converted into a BN in linear time and space complexity in the size of the SPN.", "startOffset": 75, "endOffset": 95}, {"referenceID": 18, "context": "Fourth, our construction and analysis provides a new direction for learning the parameter/structure of BNs since the SPNs produced by the algorithms that learn SPNs (Dennis & Ventura, 2012; Gens & Domingos, 2013; Peharz et al., 2013; Rooshenas & Lowd, 2014) can be converted into BNs.", "startOffset": 165, "endOffset": 257}, {"referenceID": 1, "context": "Exact probabilistic reasoning has a close connection with propositional logic and weighted model counting (Roth, 1996; Gomes et al., 2008; Bacchus et al., 2003; Sang et al., 2005).", "startOffset": 106, "endOffset": 179}, {"referenceID": 23, "context": "Exact probabilistic reasoning has a close connection with propositional logic and weighted model counting (Roth, 1996; Gomes et al., 2008; Bacchus et al., 2003; Sang et al., 2005).", "startOffset": 106, "endOffset": 179}, {"referenceID": 16, "context": "As an example, ACs have been studied and used extensively in both knowledge representation and probabilistic inference (Darwiche, 2000; Huang et al., 2006; Chavira et al., 2006).", "startOffset": 119, "endOffset": 177}, {"referenceID": 7, "context": "As an example, ACs have been studied and used extensively in both knowledge representation and probabilistic inference (Darwiche, 2000; Huang et al., 2006; Chavira et al., 2006).", "startOffset": 119, "endOffset": 177}, {"referenceID": 6, "context": ", 2006; Chavira et al., 2006). Rooshenas & Lowd (2014) recently showed that ACs and SPNs can be converted mutually without an exponential blow-up in both time and space.", "startOffset": 8, "endOffset": 55}, {"referenceID": 18, "context": "Later, automatic structure learning algorithms were developed to build tree-structured SPNs directly from data (Dennis & Ventura, 2012; Peharz et al., 2013; Gens & Domingos, 2013; Rooshenas & Lowd, 2014).", "startOffset": 111, "endOffset": 203}, {"referenceID": 19, "context": "SPNs have also been applied to various fields and have generated promising results, including activity modeling (Amer & Todorovic, 2012), speech modeling (Peharz et al., 2014) and language modeling (Cheng et al.", "startOffset": 154, "endOffset": 175}, {"referenceID": 8, "context": ", 2014) and language modeling (Cheng et al., 2014).", "startOffset": 30, "endOffset": 50}, {"referenceID": 2, "context": "Definition 1 (Algebraic Decision Diagram (Bahar et al., 1997)).", "startOffset": 41, "endOffset": 61}, {"referenceID": 2, "context": "Readers are referred to Bahar et al. (1997) for more detailed and thorough discussions about ADDs.", "startOffset": 24, "endOffset": 44}, {"referenceID": 24, "context": "Similarly, approximate inference is required in bipartite diagnostic BNs such as the Quick Medical Reference network (Shwe et al., 1991) since causal independence is insufficient to reduce the complexity, while CSI is not present or not exploited.", "startOffset": 117, "endOffset": 136}], "year": 2015, "abstractText": "In this paper, we establish some theoretical connections between Sum-Product Networks (SPNs) and Bayesian Networks (BNs). We prove that every SPN can be converted into a BN in linear time and space in terms of the network size. The key insight is to use Algebraic Decision Diagrams (ADDs) to compactly represent the local conditional probability distributions at each node in the resulting BN by exploiting context-specific independence (CSI). The generated BN has a simple directed bipartite graphical structure. We show that by applying the Variable Elimination algorithm (VE) to the generated BN with ADD representations, we can recover the original SPN where the SPN can be viewed as a history record or caching of the VE inference process. To help state the proof clearly, we introduce the notion of normal SPN and present a theoretical analysis of the consistency and decomposability properties. We conclude the paper with some discussion of the implications of the proof and establish a connection between the depth of an SPN and a lower bound of the tree-width of its corresponding BN.", "creator": "LaTeX with hyperref package"}}}