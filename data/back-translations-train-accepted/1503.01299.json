{"id": "1503.01299", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "4-Mar-2015", "title": "Telling cause from effect in deterministic linear dynamical systems", "abstract": "Inferring a cause from its effect using observed time series data is a major challenge in natural and social sciences. Assuming the effect is generated by the cause trough a linear system, we propose a new approach based on the hypothesis that nature chooses the \"cause\" and the \"mechanism that generates the effect from the cause\" independent of each other. We therefore postulate that the power spectrum of the time series being the cause is uncorrelated with the square of the transfer function of the linear filter generating the effect. While most causal discovery methods for time series mainly rely on the noise, our method relies on asymmetries of the power spectral density properties that can be exploited even in the context of deterministic systems. We describe mathematical assumptions in a deterministic model under which the causal direction is identifiable with this approach. We also discuss the method's performance under the additive noise model and its relationship to Granger causality. Experiments show encouraging results on synthetic as well as real-world data. Overall, this suggests that the postulate of Independence of Cause and Mechanism is a promising principle for causal inference on empirical time series.", "histories": [["v1", "Wed, 4 Mar 2015 12:48:44 GMT  (1136kb)", "http://arxiv.org/abs/1503.01299v1", "This article is under review for a peer-reviewed conference"]], "COMMENTS": "This article is under review for a peer-reviewed conference", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["naji shajarisales", "dominik janzing", "bernhard sch\u00f6lkopf", "michel besserve"], "accepted": true, "id": "1503.01299"}, "pdf": {"name": "1503.01299.pdf", "metadata": {"source": "CRF", "title": "Telling cause from effect in deterministic linear dynamical systems", "authors": ["Naji Shajarisales", "Dominik Janzing", "Bernhard Sch\u00f6lkopf", "Michel Besserve"], "emails": ["michel.besserve}@tuebingen.mpg.de"], "sections": [{"heading": null, "text": "ar Xiv: 150 3.01 299v 1 [cs.A I] Deriving a cause from the use of observed time series data is a major challenge in the natural and social sciences. Assuming that the effect is generated by the cause through a linear system, we propose a new approach based on the hypothesis that nature selects the \"cause\" and the \"mechanism that generates the effect from the cause\" independently of each other. We assume that the power spectrum of the causative time series does not correlate with the question of the transmission function of the linear filter that produces the effect. While most causal detection methods for time series are based primarily on noise, our method is based on asymmetries of power spectrum density properties that can be exploited even in the context of deterministic systems. We describe mathematical assumptions in a deterministic model in which the causal direction is identifiable."}, {"heading": "1 Introduction", "text": "In fact, we are able to go in search of a solution that meets the needs of the people."}, {"heading": "2 Spectral Independence Criterion (SIC)", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "2.1 Notations and model description", "text": "We refer to a sequence of real or complex numbers a = [at], t \"Z\" as a deterministic time series. (...) Its discrete Fourier transformation is defined by the square l2 norm: [...] such a process [...] can also facilitate the Z transformation of aa (z) = [...] such a process is the square l2 norm: [...] such a process [...] can also facilitate the Z transformation of aa (z) = [... t. \"(...) The energy of the deterministic time series is the square l2 norm: [...] such a process [...] is stationary.\" (...] We assume that the causal mechanism is a (deterministic) linear time invariant (LTI) filter. That is, the causal mechanism is formalized by the confrontation of X."}, {"heading": "2.2 Definition of SIC", "text": "Let us assume that exactly one of the following two alternatives is true: (1) X causes Y or (2) Y causes X. We assume that there are no unobserved common causes for X and Y. Our causal consequence problem is thus reduced to a binary decision. In the sense of the ICM, we assume that in case (1) X and h should not contain information about each other and our spectral dependency criterion (SIC). (SIC) assumes that the input power does not correlate with the amplification factor, that is, < Sxx | h = < Sxx > < | 2 >, (3) where < f > = SIC f (1 f) is the variance of the unit frequency, i.e. < Sxx | h < h < h < s > < Sxx > < s > < Sxx > < Sxx > is a difference where we consider the average intensity of the signal to be constant (SIC)."}, {"heading": "2.3 Quantifying violation of SIC", "text": "To assess the extent to which such a relationship exists, we introduce a scalable invariant expression \u03c1X \u2192 Y, which we call the spectral dependency ratio (SDR) from X to Y: \u03c1X \u2192 Y: = < Syy > < Sxx > < Syy / Sxx > (5) Here, the value 1 signifies independence, which becomes clearer by as\u03c1X \u2192 Y = Cov [Sxx, | h | 2] < Sxx > < Syy / Sxx > + 1. Finally, we find that \u03c1X \u2192 Y can be written in terms of total performance and energy: \u03c1X \u2192 Y = P (Y) P (X) | | h | | 22We define Y \u2192 X by swapping the roles of X and Y: < Sltxx > &ltty; Sylltty; &ltty & Syllty (6)."}, {"heading": "2.4 Identifiability results", "text": "In order to identify the true causal direction of SIC, it is necessary to show that \u03c1X \u2192 q = q and \u03c1Y \u2192 X assume characteristic values that provide information about this problem. The following first result explicitly shows how dependency measurements relate in both directions: Statement 2. (Forward-backward inequality) For a given linear filter with PSD Sxx input, PSD Syy output, and a non-constant modulus transmission function h resulting from this, we have have\u03c1X \u2192 Y.Y \u2192 X < 1. (7) In addition, when a specific linear filter with PSD Sxx input is selected, output PSD Syy and a non-constant modulus transmission function h resulting from any measurement variable is applied. (7) Furthermore, when a specific linear filter with PSD Sxx input is selected, output PSxx and a non-constant modulus transmission function is applied."}, {"heading": "2.5 Relation to the Trace Condition", "text": "Let X and Y be n-dimensional variables related by the linear structural equation Y = AX + E, where A is a m \u00b7 n structural matrix and E is a n-dimensional disturbance variable independent of X. [10] postulate the following condition of independence between the covariance matrix of the input distribution matrix X and A: Postulate 2 (trace condition).\u03c4m (A\u0445XA T) = \u03c4n (\u0445X) \u03c4n (A TA), (10) approximately where \u03c4n (B) meets the renormalized trace tr (B) / n.The postulate can be justified by the random matrix theory with large m if A and \u0441\u0442Y systems are selected independently of priors that meet suitable symmetries."}, {"heading": "3 SIC for vector autoregressive models", "text": "The causality of SIC and Granger is based on completely different assumptions, but both apply to linear time series models. In this section we will examine the classic vector-autoregressive model (VAR), which is used in Granger causality from the SIC perspective to better understand the relationship."}, {"heading": "3.1 VAR model", "text": "We assume that the observed time series are generated by a VAR model in such a way that x Granger causes y.Xt = \u0445 kakXt \u2212 k + \u0445t (12) Yt = \u0445 kbkYt \u2212 k + \u0445 kckXt \u2212 k + \u0445t (13). Both the sound concepts \u0438 and \u0439 in this expression are i.i.d normal sounds."}, {"heading": "3.2 Applying SIC to VAR models", "text": "We would like to describe this expression in such a way that Y is achieved by a deterministic linear time-invariant filter. We observe that the VAR model can be used as a linear time-invariant filter if we neglect additive noise. In fact, the mechanism is the following ARX model (autoregressive with eXogenous input) [13].Yt = \u2211 kbkYt \u2212 k + \u2211 kckXt \u2212 k (14). Using basic properties of the Z-transform, we can derive the following analytical expressions of the input PSD-Sxx: Sxx (\u03bd) = | n \u00b2 (\u03bd) | 2 = | n \u00b2 (exp (2\u03c0i\u03bd)) | 2, withn \u00b2 (z) = 11 \u2212 kakz \u2212 k. Furthermore, the transmission function corresponding to the mechanism in the eq equation will be independent."}, {"heading": "3.3 Comparison of SIC and Granger causality", "text": "The bivariate VAR model above is the typical model in which the Granger causality works. To recall the idea of the latter, it should be noted that it deduces that there is an influence from X to Y if the prediction of Y from its past by taking into account the past of X. If this is rephrased in relation to conditional independence, it is concluded that X causes Y if Yt is not unconditionally independent of Xt \u2212 1, Xt \u2212 2,..., because then noise is the only remaining source of uncertainty. Without knowing that Xt \u2212 1, Xt \u2212 2,... the knowledge of Xt \u2212 1, Xt \u2212 2,... reduces the variance of Yt, because Yt \u2212 1, Yt \u2212 2,... then noise is the only remaining source of uncertainty. Without knowing that Xt \u2212 1, Xt \u2212 2,...,... we have additional uncertainty due to the contribution of Granger \u2212 2,..."}, {"heading": "3.4 Sensitivity to Time Lag", "text": "Consider two time series {Xt} and {Yt} in which {Xt} is a white noise and for a given c, Yt = cYt \u2212 1 + Xt \u2212 1. It is easy to see that this type of input and output can be simulated using an IIR filter with (a1, a2) = (1, c) and b1 = 1 in (eq. (17) and the rest of the coefficients are zero (see definition of the coefficients in Section 4.1). The infinite DAG for this causal structure is in Fig. 1. Now, if there was a measurement delay of the length k for Y, the observed values would be a new time series, say Y, where Y-t = Yt \u2212 k. Although the ground truth X \u2192 Y is independent of k, Granger causality indicates only the correct causal structure if k \u2264 0 (where there is a delay in measuring X, but not)."}, {"heading": "4 Experiments", "text": "In this section, we examine our causal inference algorithm using synthetic experiments and apply it to multiple real datasets."}, {"heading": "4.1 Synthetic Data: ARMA filters and processes", "text": "We designed synthetic experiments to evaluate the validity of the SIC approach. The process of data generation is as follows: The LTI system S models the mechanism within the family of ARMA (FO, BO) filters with parameters (a, b) defined by input / output difference equation: yn = 1 a0 (FO \u2211 i = 0bixn \u2212 i + BO \u2211 j = 1ajyn \u2212 j). (17) For these filters, FO is known as feedback forward method and BO is the feedback difference equation. ai's and bi's are usually known as feedback coefficients. Note that when FO (S) = 0, the system is referred to as an autoregressive filter. Alternatively, BO (S) = 0 corresponds to the family of finite impulse response (FIR) or moving average filters. Whenever BO (S) 6 = 0, the filter has IR."}, {"heading": "4.2 Real World Examples", "text": "We have tried our method on several examples of real data where the basic truth about the causal structure of the data is known a priori and the data is labeled in such a way that the basic truth is X \u2192 Y. In the first two examples, we have shown the difference of the SDR in both directions as a function of the window length used in the Welch method, which is shown in Fig. 4."}, {"heading": "4.2.1 Gas Furnace [4]", "text": "This dataset consists of 296 time points, where X is the gas rate consumed by a gas oven and Y is the CO2 rate generated. Fig. 4 shows \u03c1X \u2192 Y \u2212 \u03c1Y \u2192 X relative to the window length, which was between 50 and 150 points. As shown, the difference is always positive and our method is able to correctly derive the correct causal direction regardless of the window length. TiMiNO and Granger causality have correctly identified the basic truth in this case as well [19]. Algorithm 1 SIC Inference1: Procedure SIC Inference1: Procedure SIC Inference (X, Y) 2: Sxx \u2190 Spectrum of X 3: Syy \u2190 Spectrum of Y 4: Calculation \u03c1X \u2192 Y and Y \u2192 X with (equivalent (5) 5: Inference step: 6: if ICX \u2192 Y > Y \u2192 X then 7: Return X \u2192 Y 8: otherwise 9: Return Y \u2192 X"}, {"heading": "4.2.2 Old Faithful Geyser [2]", "text": "N = 298: X contains the duration of an eruption and Y the time interval until the next eruption of the Old Faithful geyser. Figure 4 shows the difference in the SDR as a function of the win-dow length with the same configuration as the gas furnace experiment. Here, too, the correct causal direction is derived from our method regardless of the window length, as in Fig. 4. In this case, TiMiNO correctly identifies the cause from the effect, but neither linear nor nonlinear Granger causality derives the correct causal direction [19]."}, {"heading": "4.2.3 LFP recordings of the Rat Hippocampus", "text": "It is known that, unlike neocortex, where connectivity between areas is bidirectional, monosynaptic connections between multiple regions of the hippocampus are largely unidirectional [1]. An important example of such connectivity is between the CA3 and CA1 subfields [1]. Despite this anatomical fact, a study of causality based on Local Field Potential (LFP) records of CA1 and CA3 of the rat hippocampus during sleep reports explains that Granger causality has strong bidirectional relationships between the two areas [3], the possible reasons for such an outcome as feedback loops involving the cortex and medial septum, and diffuse connections ranging from CA1 to CA3. To make a comparison with Granger causality, we applied our framework to records from these regions using a publicly available dataset1 [16, 17]."}, {"heading": "4.2.4 Characterizing the Echo", "text": "In this experiment, we used an open source database of the room impulse response function (IRF) available in the Open AIR library.3 We selected the IRFs for Elevden Hall, Elevden, Suffolk, England, and Hamilton Mausoleum, Hamilton, Scottland.3 We intertwined these signals with 30 \u00b1 5 second segments of two classic pieces of music: the first movement of Vivaldi's Winter Concerto, consisting of 9190656 data points, and the Lacrimosa of Mozart's Requiem, consisting of 8842752 points, both. \"Wav\" files at the rate of 44100Hz. Regardless of the segment, the forward SDR is considerably larger than the backward SDR, as in Fig. 6. In another experiment, we used a computer segment to play the pieces listed above in the World Recorded Hall (we labeled LDR in environment 12)."}, {"heading": "5 Conclusion", "text": "We have introduced a causal discovery method for time series based on the SIC postulate, assuming an LTI relationship for a specific pair of time series X and Y, so that either X \u2192 Y or Y \u2192 X. Theoretical justifications for this postulate are provided to lead to identifiability. Interestingly, the method provides one and extended the recently proposed approach of the trace method for setting time series. Encouraging experimental results have also been presented on real and synthetic data. In particular, this method has proven to be more effective than linear Granger causality on LFP recordings of CA1 and CA3 hippocampus brain areas of rats, assuming it assumes a fundamental causal direction from CA3 to CA1 based on anatomy. We suggest that this method offers a new perspective for causal conclusions in time series that may be fundamentally different from the causality of the granule."}, {"heading": "6 Proof of Proposition 2", "text": "Lemma 1. For f-L2 (I) positive, not constant, so that 1 / f-L2 (I), we have \"If\" (x), \"If\" (x), \"If\" (x), \"If\" (x). \u2212 1f (x) \u2212 Inequality is strict, because f and 1 / f are not collinear (otherwise f would be constant). < f-L1 (I) positive, not constant, so that 1 / f-L1 (I) and \"Prosume\" (x) are strict, because f and 1 / f are not collinear (otherwise f would be constant)."}, {"heading": "7 Proof of Theorem 1", "text": "To prove this theory, we rely on a theory from [10] and a sequence we derive from it. (Theorem 3 (Concentration of the Measurement Quantity for Finite Dimensional Linear Relations). (10) Let us assume that a given covariance matrix and an assumption A + Mn \u00b7 m (R) is also a given matrix. (Then, if you create a given matrix X = U3 by selecting a given orthogonal matrix U from O (n) then together with A, it fulfills the trace state in probability if n tends to infinity.) More precisely, there is a given matrix: = 1 \u2212 exp (n \u2212 1) principle 2), which is a constant where a constant arises (AxA) \u2212 n (X)."}, {"heading": "8 Proof of Theorem 2", "text": "In this section we will give proof that the TDR (see definition 2) is able to derive this result (see definition 2) of the order N for the linear system above us to obtain the following matrix relation: Y - N + 1... Y - N + 1... Y - N \u2212 2 Y - N \u2212 1 h \u2212 1 h \u2212 1 h0 h0 \u00b7 h \u2212 1 h0 \u00b7 h \u2212 2N + 2... h2N \u2212 2 h2N \u2212 3 \u00b7 h2N \u2212 3 \u00b7 h2N \u2212 1 h2N \u2212 2."}], "references": [], "referenceMentions": [], "year": 2015, "abstractText": "<lb>Inferring a cause from its effect using observed time series data is a major challenge in natural<lb>and social sciences. Assuming the effect is generated by the cause trough a linear system,<lb>we propose a new approach based on the hypothesis that nature chooses the \u201ccause\u201d and the<lb>\u201cmechanism that generates the effect from the cause\u201d independent of each other. We therefore<lb>postulate that the power spectrum of the time series being the cause is uncorrelated with the<lb>square of the transfer function of the linear filter generating the effect. While most causal<lb>discovery methods for time series mainly rely on the noise, our method relies on asymmetries of<lb>the power spectral density properties that can be exploited even in the context of deterministic<lb>systems. We describe mathematical assumptions in a deterministic model under which the<lb>causal direction is identifiable with this approach. We also discuss the method\u2019s performance<lb>under the additive noise model and its relationship to Granger causality. Experiments show<lb>encouraging results on synthetic as well as real-world data. Overall, this suggests that the<lb>postulate of Independence of Cause and Mechanism is a promising principle for causal inference<lb>on empirical time series.", "creator": "LaTeX with hyperref package"}}}