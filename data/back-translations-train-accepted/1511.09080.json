{"id": "1511.09080", "review": {"conference": "aaai", "VERSION": "v1", "DATE_OF_SUBMISSION": "29-Nov-2015", "title": "Exploiting Anonymity in Approximate Linear Programming: Scaling to Large Multiagent MDPs (Extended Version)", "abstract": "Many exact and approximate solution methods for Markov Decision Processes (MDPs) attempt to exploit structure in the problem and are based on factorization of the value function. Especially multiagent settings, however, are known to suffer from an exponential increase in value component sizes as interactions become denser, meaning that approximation architectures are restricted in the problem sizes and types they can handle. We present an approach to mitigate this limitation for certain types of multiagent systems, exploiting a property that can be thought of as \"anonymous influence\" in the factored MDP. Anonymous influence summarizes joint variable effects efficiently whenever the explicit representation of variable identity in the problem can be avoided. We show how representational benefits from anonymity translate into computational efficiencies, both for general variable elimination in a factor graph but in particular also for the approximate linear programming solution to factored MDPs. The latter allows to scale linear programming to factored MDPs that were previously unsolvable. Our results are shown for the control of a stochastic disease process over a densely connected graph with 50 nodes and 25 agents.", "histories": [["v1", "Sun, 29 Nov 2015 20:02:29 GMT  (196kb,D)", "https://arxiv.org/abs/1511.09080v1", null], ["v2", "Sat, 20 Feb 2016 20:39:03 GMT  (225kb,D)", "http://arxiv.org/abs/1511.09080v2", "Extended version of AAAI 2016 paper"]], "reviews": [], "SUBJECTS": "cs.AI cs.MA", "authors": ["philipp robbel", "frans a oliehoek", "mykel j kochenderfer"], "accepted": true, "id": "1511.09080"}, "pdf": {"name": "1511.09080.pdf", "metadata": {"source": "CRF", "title": "Exploiting Anonymity in Approximate Linear Programming: Scaling to Large Multiagent MDPs (Extended Version)", "authors": ["Philipp Robbel", "Frans A. Oliehoek", "Mykel J. Kochenderfer"], "emails": [], "sections": [{"heading": "1 Introduction", "text": "In fact, the fact is that most of us are able to survive ourselves, and that they are able to survive themselves, \"he said in an interview with the\" New York Times. \"\" I don't think I'm able to survive myself, \"he said in an interview with the\" New York Times. \"\" I don't think I'm able to survive myself, \"he said in an interview with the\" New York Times. \"\" I don't think I'm able to survive myself. \"\" I don't think I'm able to survive myself. \"\" I don't think I'm able to survive myself. \"\" I don't think I'm able to survive myself. \""}, {"heading": "2 Background", "text": "We will first discuss the necessary background to factored multiagent MDPs and their efficient solution methods, which are based on the factorization of values."}, {"heading": "2.1 Factored Multiagent MDPs", "text": "Markov decision-making processes are a general framework for decision-making under uncertainty (Kochenderfer 2015; Puterman 2005).An infinite horizon Markov decision-making process (MDP) is defined by the tuple < S, A, T, R, \u03b3 >, where S = {s1,.., s | S |} and A = {a1,.., a | A |} are the finite sets of states and actions, T the transition probability function, the P (s \u2032 | s, a), R (s, a) the immediate reward function, and A = [0, 1] the discount factor of the problem. Factored MDPs (FMDPs) exploit the structure in the state space S and define the system state by assigning it to the state variables X = {X1,.., Xn}. Transition and reward variability is broken down into a double-edged temporary Bayesian network (2TN)."}, {"heading": "2.2 Control of Epidemics on Graphs", "text": "The dynamics of the disease outbreak follow a version of the \"susceptible-infected-susceptible\" (SIS) model with homogeneous model parameters in the network (Bailey 1957).The dynamics of the disease outbreak have been studied in detail for many years, but few approaches address the complex control problem of epidemic processes (Nowzari, Preciado and Pappas 2015; Ho et al. 2015).The dynamics of the SIS with homogeneous parameters is modeled as FMMDP as follows. We define the network as a (directed or undirected) diagram G = (V, E) with controlled and uncontrolled links V = (Vc, Vu) and as a border image VMDP."}, {"heading": "2.3 Efficient Solution of Large FMMDPs", "text": "We build on the work of Guestrin et al. (2003), which presents approximate solutions for FMDPs that are particularly scalable in terms of the number of agents, representing the global Q-value function as the sum of appropriately selected smaller value function components, each defined by a subset of state and action variables. (Dechter 2013), where the maximizing configuration can be found using methods such as variable elimination (VE) that avoid exponential elimination of many activities. To calculate a factored linear value function, the same authors present an efficient method to exponentially represent the configuration in approximate linear programming (ALP)."}, {"heading": "ALP", "text": "The approximate linear programming (ALP) variant introduced by (Guestrin et al. 2003) allows this by implicitly using the aforementioned VE technique (Puterman 2005).The basic ALP formulation for an infinite horizon discounted MDP method, which spans the best approximation (in a weighted L1 norm sense) to the optimal value function in space (Puterman 2005).The basic ALP formulation for an infinite horizon discounted MDP base choice h1,., hk is given by: min w function in space spanned by the basic functions (Puterman 2005).The basic ALP formulation for an infinite horizon discounted MDP base choice h1,., hk is given by: min w function i wihi (x) s.t."}, {"heading": "3 Anonymous Influence", "text": "The ALP solution method is based on the assumption that PU can be efficiently performed in the factor diagram, which is comprised of the local functions that make up the maximum constraint of Equation 8, i.e. that the application areas of all intermediate terms remain small during PU. This assumption is often violated in many diagrams of interest, e.g. in disease control, where nodes may have large inputs or outputs. In this section, we develop a new approach to deal with larger circumferences in PU than were previously feasible, based on the realization that in the class of graphic problems considered here, only the common effects of variable sets - and not their identity - are sufficient to accurately describe the factors that occur in the maximum constraint and are manipulated during PU. We are introducing a new representation that is exponentially smaller than the equivalent complete coding of intermediate terms and show the VE remains correct."}, {"heading": "3.1 Mixed-Mode Functions", "text": "We define aggregator functions to summarize the \"anonymous influence\" of a number of variables. In the disease-spreading scenario, for example, the number of active parents is clearly defined if the identity of the parent nodes is not relevant to represent Ti. The following definitions formalize this intuition. Definition 2 (Count Aggregator): Leave Z = {Z1,.. Z | Z |} is defined as a set of binary variables, Zi [0, 1}. The Countaggregator (CA) # {Z}: Z1 \u00d7."}, {"heading": "3.2 Compact Representation of MMFs", "text": "Just as CAFs is a mixed modus function f (a, b, c) can always be converted to an equivalent function without this function being superimposed (b, c, c, c, c) (b, c, c, c, c, c). A mixed mode function f: X, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c, c,"}, {"heading": "4 Efficient Variable Elimination", "text": "Here we describe how AUGMENT and REDUCE are implemented efficiently in order to work directly on the redundant representation of MMFs. Our goal is to use the compact representation within the VE algorithm, i.e. not to break up functional areas as much as possible. Particular care should be taken, as we have previously observed that reduced representations contain inconsistent entries."}, {"heading": "Augment", "text": "AUGMENT (g, h) returns a function f which is defined as follows: \u0445x, y, k1 and 0,.., N1, k2, 0,.., N2, f (x, y, k1, k2) = g (x, k1) + h (y, k2). (11) The implementation simply loops over all x, y, k1, k2 to calculate all entries (which may be consistent or inconsistent)."}, {"heading": "Reduce", "text": "REDUCE eliminates a variable by maximizing it. At this point, we will show how this operation is implemented for MMFs that directly use the redundant representation. Let g (x, y, z, # 1 (a, b, z), # 2 (b, c)) be an MMF with redundant representation g (x, y, z, k1, k2). We distinguish different cases: 1. Calculate a correct variable: If we calculate x, f (y, z, k1, k2), max {g (x, k1, k2), maxix (z, k1, k1, k2). If we calculate a correct variable: If we calculate a, f (x, y, z, k2), max {g (x, k1, k2), maxix (z, k1, k2)."}, {"heading": "Correctness of RR-VE", "text": "We refer to VE with the elementary operations defined as redundant representation VE (RR-VE) as above. RRVE is correct, i.e. it comes to the same solution as VE with the full tabular representation of intermediate functions. However, the proof depends on the following two terms: Lemma 2. If the input functions are correctly defined on their consistent entries, AUGMENT will be correct. Proof. the implementation of AUGMENT as in (11) can result in an f containing inconsistent entries. Specifically, this will happen if the scopes of # 1, # 2 contain a common variable. However, if we use f later, we will only query consistent entries, i.e. if the function f (x, y, # 1) # contains correct entries."}, {"heading": "5 Exploiting Anonymity in the ALP", "text": "The results for RR-VE can be evaluated in the ALP solution method introduced in Section 2.3. The nonlinear maximum constraint in Eq.8 is defined by functions ci, \u03b3gi \u2212 hi-hi-H and reward factors Rj, j = 1,.., r, which are all locally recorded and collectively comprise a factor graph. As previously outlined, a VE method using this factor graph can translate the nonlinear constraint into a series of linear constraints that are reduced compared to the standard formulation of ALP. The key finding of this section is that for a class of factored (M) MDPs defined with counting aggregator functions in the 2TBN (i.e. the very ones that support anonymous influence), the same intuition about reduced representations as in the previous section implements the correct representation of the equation of equations (VDPs) the non-linear maximum constraint of the constraints of the constraints."}, {"heading": "6 Experimental Evaluation", "text": "We evaluate our methods using undirected disease propagation diagrams with 30 and 50 nodes. Since the obtained value functions are identical for both methods, the focus of this evaluation is on runtime performance using a random sample set of diagrams. We then look at a disease control problem with 25 agents in a tightly connected 50-node diagram that cannot be solved with normal ALP. Problems of this magnitude (| S | = 250, | A | = 225) are prohibitively large for exact solution methods and are usually solved heuristically. To evaluate the quality of the RR-ALP solution, we evaluate its political performance against vaccination heuristics in the simulation. In all experiments, we use indicator functions IXi, IX-i variable for each state (covering the two valents, healthy, infected rates) and the cost of recovery (R = 1) and Vnode (R = 0.1)."}, {"heading": "Runtime Comparison", "text": "We use Graph tool (Peixoto 2014) to generate 10 random graphs with an out-degree k sampled from P (k), 1 / k, k [1, 10]. Therefore, the out-degrees per node vary in [1, 10]; the mean out-degree in the graphs of the test set ranges from 2.8 (graph 1) to 4.2 (graph 10). Figure 3 illustrates a subset of the resulting grids. Runtime results comparing the VE / ALP method with RR-VE / RR-ALP are summarized in Table 1. The last three columns show the relative size of each measure, i.e. the efficiency gains of the methods that exploit anonymous influences in each of the 10 random graphs, and the ALP runtimes to solve the value function after the constraints have been calculated. The last three columns show the relative size of the individual measurement fluxes, i.e. the anonymous gains in the efficiencies."}, {"heading": "Policy Performance", "text": "In this section, we present the results of political simulation for three different disease control policies across two random graphs (30 nodes with 15 agents and 50 nodes with 25 agents, both with a maximum out-degree per node on 15 neighbors).The problem of disease control via both graphs is unfeasible for regular VE / ALP due to the exponential increase of intermediate factors during VE. We compare the solution of our RR-ALP method with a random policy and a heuristic policy that applies a vaccination action to Xi in the current state and belongs to the controlled Vc nodes in the chart. Heuristics are reactive and do not provide predictive vaccination when some of their parent nodes are infected. We refer to them as \"copystate\" heuristic in our assessment."}, {"heading": "7 Related Work", "text": "In fact, it is not the case that one sees oneself in the position of trumping oneself, but that one sees oneself in the position of trumping oneself and trumping oneself. \"(S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S. S."}, {"heading": "8 Conclusions and Future Work", "text": "This paper introduces the concept of \"anonymous influence\" in large factor-based multi-agent MDPs and shows how it can be used to scale the elimination of variables and approximate linear programming beyond what has been solved.The key idea is that representative as well as computational benefits result from thinking about the influence of variable sets rather than the variable identity in the factor diagram.These results apply to both single- and multi-agent factorial MDPs and are exact reductions that yield the identical result to the normal VE / ALP while greatly expanding the class of solvable diagrams."}, {"heading": "Acknowledgments", "text": "F.O. is supported by NWO Innovational Research Incentives Scheme Veni # 639.021.336."}, {"heading": "A Correctness of Redundant Representation VE", "text": "Here we prove Lemma 3, which is used to show the correctness of the redundant representation VE (RR-VE) in section 4."}, {"heading": "Correctness of Reduce", "text": "We must show that for one function g (x, y, z, # 1 (a, b, c) max (b) max (b) max (max) x (max) x (max) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (x) x (x) x (x) x (x) x (x) x (x) x (x) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x x (z) x x (z) x x x x (z) x x x x x (x) x x x x x x x x (z) x x x x x x x x x) x x x x x (z) x x x x x x x x x x (z) x x x (z) x x x (z) x x x x (z) x x x x (z) x) x x x (z) x x (z) x x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x x (z) x (z) x (z) x x (z) x (z) x (z) x (z) x (z) x (z) x (z (z) x (z) x (z) x x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x (z) x x (z) x (z) x"}], "references": [], "referenceMentions": [], "year": 2016, "abstractText": "Many exact and approximate solution methods for Markov Decision Processes (MDPs) exploit structure in the problem and are based on factorization of the value function. Especially multiagent settings, however, are known to suffer from an exponential increase in value component sizes as interactions become denser, meaning that approximation architectures are restricted in the problem sizes and types they can handle. We present an approach to mitigate this limitation for certain types of multiagent systems, exploiting a property that can be thought of as \u201canonymous influence\u201d in the factored MDP. Anonymous influence summarizes joint variable effects efficiently whenever the explicit representation of variable identity in the problem can be avoided. We show how representational benefits from anonymity translate into computational efficiencies, both for variable elimination in a factor graph and for the approximate linear programming solution to factored MDPs. Our methods scale to factored MDPs that were previously unsolvable, such as the control of a stochastic disease process over densely connected graphs with 50 nodes and 25 agents.", "creator": "LaTeX with hyperref package"}}}