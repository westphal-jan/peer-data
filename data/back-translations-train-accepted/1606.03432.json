{"id": "1606.03432", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "10-Jun-2016", "title": "Scan Order in Gibbs Sampling: Models in Which it Matters and Bounds on How Much", "abstract": "Gibbs sampling is a Markov Chain Monte Carlo sampling technique that iteratively samples variables from their conditional distributions. There are two common scan orders for the variables: random scan and systematic scan. Due to the benefits of locality in hardware, systematic scan is commonly used, even though most statistical guarantees are only for random scan. While it has been conjectured that the mixing times of random scan and systematic scan do not differ by more than a logarithmic factor, we show by counterexample that this is not the case, and we prove that that the mixing times do not differ by more than a polynomial factor under mild conditions. To prove these relative bounds, we introduce a method of augmenting the state space to study systematic scan using conductance.", "histories": [["v1", "Fri, 10 Jun 2016 19:24:10 GMT  (285kb,D)", "http://arxiv.org/abs/1606.03432v1", null]], "reviews": [], "SUBJECTS": "cs.LG cs.AI stat.ML", "authors": ["bryan d he", "christopher de sa", "ioannis mitliagkas", "christopher r\u00e9"], "accepted": true, "id": "1606.03432"}, "pdf": {"name": "1606.03432.pdf", "metadata": {"source": "META", "title": "Scan Order in Gibbs Sampling: Models in Which it Matters and Bounds on How Much", "authors": ["Bryan He", "Christopher De Sa", "Ioannis Mitliagkas"], "emails": ["bryanhe@stanford.edu", "cdesa@stanford.edu", "imit@stanford.edu", "chrismre@stanford.edu"], "sections": [{"heading": "1 Introduction", "text": "The question we have to ask is whether this is a random way of randomly selecting the boundary distributions of some variants of interest. [8] Some applications include different computer systems that in popular libraries such as OpenBUGS [16], FACTORIE [17], JAGS [18], and MADlib [14] quickly produce precise samples for many models and quickly produce precise results so that they can be used in popular libraries such as OpenBUGS [16], FACTORIE [18], and MADlib [14], and MADlib [14]."}, {"heading": "2 Related Work", "text": "Recent work has made progress in analyzing the Gibbs sampling mixing time, but there are still some major limitations to our understanding. In particular, most known results are known only for certain models or for random sampling only. For example, mixing times for Mallows model [1, 4] and chart colors [5] are known for both random and systematic sampling, but these are not applicable to general models. On the other hand, it has been shown that random sampling times are mixed for models that meet structural conditions - such as with near-modular energy functions [10] or with limited hierarchy width and factor weights [2] - but corresponding results for systematic sampling are not known. The big exception to these limitations is Dobrushin's state, which guarantees that O (n log n) sampling for both random sampling and systematic sampling [6, 13]."}, {"heading": "3 Models in Which Scan Order Matters", "text": "Despite a lack of theoretical results regarding the effect of the scan order on mixing times, it is generally assumed that the scan order has only a small effect on the mixing time. In this section, we can first define relevant terms and give some common assumptions regarding the scan order. Afterwards, we give several counter-examples showing that the scan order can have asymptotic effects on the mixing time. Mixing time is the minimum number of steps required to guarantee that the total variation distance between the true and estimated distributions is below a given threshold. Formally, the mixing time of a stochastic process P with transition matrix P (t) after t steps and stationary distribution p. 55] tmix (P,)."}, {"heading": "3.1 Sequence of Dependencies", "text": "The first model we describe is the sequence of dependencies model (Figure 1). The goal of this model is to explore the question of how fast a scan can can be by constructing a model, for which a scan-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A-A"}, {"heading": "3.2 Two Islands", "text": "In fact, it is a matter of how people are able to determine themselves how they want to behave and how they want to behave. (...) It is also a matter of how people are able to behave. (...) It is as if they were able to behave. (...) It is as if they were able to behave. (...) It is as if they were able to move. (...) It is as if they were able to determine themselves. (...) It is as if they were able to determine themselves. (...) It is as if they were able to determine themselves. (...) It is as if they were able to determine themselves. (...)"}, {"heading": "3.3 Discrete Pyramid", "text": "In the discrete pyramid model (Figure 1c) introduced by Roberts and Rosenthal [20], there are n binary variables xi, and the mass is evenly distributed over all states in which at most an xi is true. In this model, the mixing time of the random scan O (n) is asymptotically better than that of the systematic scan for permutations that all have the same mixing time, O (n3)."}, {"heading": "4 Experiments", "text": "In this section, we perform several experiments to illustrate the effect of the scan arrangement on the mixing times. First, in Figure 2a, we plot the mixing times of the models in Section 3 depending on the number of variables. These experiments confirm our results on the asymptotic scaling of the mixing time, and show that the scan arrangement can have a significant impact on the mixing time even for small models. (Due to the exponential state space of the two-island model, we modify it slightly to make the calculation of the mixing times feasible: we simplify the model by considering only the states adjacent to the bridge, and assume that the states on each island are immediately mixed.) In the following experiments, we will consider a modified version of the two-island model, in which the mass of the bridge state is set to 0.1 of the mass of the other states to allow the effect of the scan to be clear."}, {"heading": "5 Relative Bounds on Mixing Times via Conductance", "text": "This raises the question of how different the mixing times of different scans can be. In this section, we will deduce the following weaker - but correct - versions of those by Diaconis [3] and Levin et al. [15] One of the obstacles to proving this behavior is that the systematic scan chain is not reversible. A standard method for handling non-reversible Markov chains is to study a lazy version of the Markov chain instead. 9] In the lazy version of a Markov chain, each step has a 1 / 2 chance of remaining in its current state and acts as a normal step."}, {"heading": "6 Conclusion", "text": "We investigated the effects of the scan sequence on the mixing times of Gibbs samplers and found that the scan sequence can have an asymptotic effect on the mixing times of certain models. These models defy the conventional wisdom about the scan sequence and show that we cannot freely change the scan sequence without taking into account the resulting changes in the mixing times. Furthermore, we found limits to the mixing times of different scan sequences that replace a common guess about the mixing times of random scans and systematic scan."}, {"heading": "Acknowledgments", "text": "The authors acknowledge their support for: DARPA FA8750-12-2-0335; NSF IIS-1247701; NSF CCF-1111943; DOE 108845; NSF CCF-1337375; DARPA FA8750-13-2-0039; NSF IIS-1353606; ONR N000141210041 and N000141310129; NIH U54EB020405; NSF DGE-114747; DARPA's SIMPLEX program; Oracle; NVIDIA; Huawei; SAP Labs; Sloan Research Fellowship; Moore Foundation; American Family Insurance; Google; and Toshiba. The views and conclusions expressed in this material are those of the authors and should not be interpreted as necessarily representing the official guidelines or recommendations of DARPA, AFRL, NSF, ONR, NIH or the U.S. government."}, {"heading": "A Additional Models in Which Scan Order Matters", "text": "rrrrrcnlhsrc\u00fceGsrteh nvo nde eeisrrcnlhsrtee\u00fccnlhSe rf\u00fc ide eeisrteeSrtee\u00fcgn rf\u00fc ide eeisrteeSn, nlrteeew sasd ide eeisrrsrsrteeSn ni red eeisrmtlcnlhSe ni red eeisrmtlrtlrteeeeeeSn in the eeisrrdne eeisrrrrrrcehnlrteeSn ni rf\u00fc ni nlrrrf\u00fc, nlrdne sasd sasd nlrf\u00fc ide eeisrrrrrrrdne nlrrteeeeeeeeeeeeeeeeeeeaeSrrrdne nrrrrrrru ni nlrrrrrrrlrrrru ni ni ni, nlrrrrrrrrrrrrrrrrrrrrteeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeecue luuicue luicue rrrni, rrrrni rrrrrrrrrrrrruifuirni, rrruifuifuifuifuifuefuecuececeeceeeeeeeceeeeeeeecue rni rrrrrrrrni, rrrrrrrrrrrrrrrrrrrnnnnnnnnnnnnnnnnnnnnnnnnnnnnn"}, {"heading": "B Priors in the Sequence of Dependencies", "text": "To simplify the analysis of the sequence of dependencies, we assumed that the priors of the variables were strong enough to mix the correct variable in O (n) time. In this section, we show that if M = 0 (n), the best systematic scan mixes in O (n) time, then the best systematic scan cannot mix O (n2) time. Let's first assume that M = 0 (n), then the best systematic scan mixes in O (n) time, and if M = o (n), then the best systematic scan cannot mix the O (n2) time.Suppose that M = 1 (n) -1 + cn > 1 \u2212 cn. The probability of the transition from si \u2212 1 to si, when the xi variable is sampled, is best that this sweep = 1 + cn = constant."}, {"heading": "C Bridge Efficiency with Normal Mass on Bridge", "text": "In the analysis of the model of the two islands, we assume that the bridge has a negligible mass. We now analyze the mixing times without assuming that the bridge has a low mass. The same asymptotic behavior still occurs. Even if the bridge has the same mass as the other states, it still acts as a bottleneck for the model. If the n is sufficiently large, the islands will mix quickly in comparison and reach the bridge, so that the mixing time is still inversely proportional to the bridge efficiency. However, if the bridge has the same mass as the other states, scanning a variable while traveling on the bridge will only have a 1 / 2 probability of moving away from the bridge."}, {"heading": "D Proofs for Section 5", "text": "In this section, we prove our relative limits at the mixing times (theorem 1 = 1 = 1 = 1 = 1 = 1 = 1 = 1 (2 = 1 = 1 = 1 = 1 = 1 = 1 = 1 (2 = 1)). We prove this assertion by showing that the application of the transition matrix for augmented random scan or augmented systematic scan does not change this distribution.For augmented random scan (x, i)) P (x, i), y (x), y (x), y (x), y)))))), x (x) n \u00b7 P (x), (x), (x), y (x), y (x), y (x), y (x), y (x), y (x), y (i), i (i), x, i (i)."}], "references": [{"title": "Mixing times of the biased card shuffling and the asymmetric exclusion process", "author": ["Itai Benjamini", "Noam Berger", "Christopher Hoffman", "Elchanan Mossel"], "venue": "Transactions of the American Mathematical Society,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2005}, {"title": "Rapidly mixing gibbs sampling for a class of factor graphs using hierarchy width", "author": ["Christopher De Sa", "Ce Zhang", "Kunle Olukotun", "Christopher R\u00e9"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2015}, {"title": "Some things we\u2019ve learned (about markov chain monte carlo)", "author": ["Persi Diaconis"], "venue": null, "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2013}, {"title": "Analysis of systematic scan metropolis algorithms using iwahori-hecke algebra techniques", "author": ["Persi Diaconis", "Arun Ram"], "venue": "The Michigan Mathematical Journal,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2000}, {"title": "Systematic scan for sampling colorings", "author": ["Martin Dyer", "Leslie Ann Goldberg", "Mark Jerrum"], "venue": "The Annals of Applied Probability,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2006}, {"title": "Dobrushin conditions and systematic scan", "author": ["Martin Dyer", "Leslie Ann Goldberg", "Mark Jerrum"], "venue": "Combinatorics, Probability and Computing,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2008}, {"title": "Incorporating non-local information into information extraction systems by gibbs sampling", "author": ["Jenny Rose Finkel", "Trond Grenager", "Christopher Manning"], "venue": "In Proceedings of the 43rd Annual Meeting on Association for Computational Linguistics,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2005}, {"title": "Sampling-based approaches to calculating marginal densities", "author": ["Alan E. Gelfand", "Adrian F.M. Smith"], "venue": "Journal of the American Statistical Association,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1990}, {"title": "Stochastic relaxation, gibbs distributions, and the bayesian restoration of images", "author": ["Stuart Geman", "Donald Geman"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 1984}, {"title": "Sampling from probabilistic submodular models", "author": ["Alkis Gotovos", "Hamed Hassani", "Andreas Krause"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2015}, {"title": "Finding scientific topics", "author": ["Thomas L. Griffiths", "Mark Steyvers"], "venue": "Proceedings of the National Academy of Sciences,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2004}, {"title": "Convergence rate of incremental gradient and newton methods", "author": ["Mert G\u00fcrb\u00fczbalaban", "Asu Ozdaglar", "Pablo Parrilo"], "venue": "arXiv preprint arXiv:1510.08562,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2015}, {"title": "A simple condition implying rapid mixing of single-site dynamics on spin systems", "author": ["Thomas P. Hayes"], "venue": "In 2006 47th Annual IEEE Symposium on Foundations of Computer Science (FOCS\u201906),", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2006}, {"title": "The madlib analytics library: or mad skills, the sql", "author": ["Joseph M Hellerstein", "Christoper R\u00e9", "Florian Schoppmann", "Daisy Zhe Wang", "Eugene Fratkin", "Aleksander Gorajek", "Kee Siong Ng", "Caleb Welton", "Xixuan Feng", "Kun Li"], "venue": "Proceedings of the VLDB Endowment,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2012}, {"title": "Markov chains and mixing times", "author": ["David Asher Levin", "Yuval Peres", "Elizabeth Lee Wilmer"], "venue": "American Mathematical Society,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2009}, {"title": "The bugs project: Evolution, critique and future directions", "author": ["David Lunn", "David Spiegelhalter", "Andrew Thomas", "Nicky Best"], "venue": "Statistics in medicine,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2009}, {"title": "Factorie: Probabilistic programming via imperatively defined factor graphs", "author": ["Andrew McCallum", "Karl Schultz", "Sameer Singh"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2009}, {"title": "Jags: A program for analysis of bayesian graphical models using gibbs sampling", "author": ["Martyn Plummer"], "venue": "In Proceedings of the 3rd international workshop on distributed statistical computing,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2003}, {"title": "Beneath the valley of the noncommutative arithmetic-geometric mean inequality: conjectures, case-studies, and consequences", "author": ["Benjamin Recht", "Christopher R\u00e9"], "venue": "In Proceedings of the 25th Annual Conference on Learning Theory,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2012}, {"title": "Surprising convergence properties of some simple gibbs samplers under various scans", "author": ["Gareth O. Roberts", "Jeffrey S. Rosenthal"], "venue": "International Journal of Statistics and Probability,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2015}, {"title": "An architecture for parallel topic models", "author": ["Alexander Smola", "Shravan Narayanamurthy"], "venue": "Proceedings of the VLDB Endowment,", "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2010}, {"title": "Towards high-throughput gibbs sampling at scale: A study across storage managers", "author": ["Ce Zhang", "Christopher R\u00e9"], "venue": "In Proceedings of the 2013 ACM SIGMOD International Conference on Management of Data,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2013}, {"title": "Segmentation of brain mr images through a hidden markov random field model and the expectation-maximization algorithm", "author": ["Yongyue Zhang", "Michael Brady", "Stephen Smith"], "venue": "IEEE Transactions on Medical Imaging,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2001}], "referenceMentions": [{"referenceID": 7, "context": "A major use of Gibbs sampling is marginal inference: the estimation of the marginal distributions of some variables of interest [8].", "startOffset": 128, "endOffset": 131}, {"referenceID": 8, "context": "Some applications include various computer vision tasks [9, 23, 24], information extraction [7], and latent Dirichlet allocation for topic modeling [11].", "startOffset": 56, "endOffset": 67}, {"referenceID": 22, "context": "Some applications include various computer vision tasks [9, 23, 24], information extraction [7], and latent Dirichlet allocation for topic modeling [11].", "startOffset": 56, "endOffset": 67}, {"referenceID": 6, "context": "Some applications include various computer vision tasks [9, 23, 24], information extraction [7], and latent Dirichlet allocation for topic modeling [11].", "startOffset": 92, "endOffset": 95}, {"referenceID": 10, "context": "Some applications include various computer vision tasks [9, 23, 24], information extraction [7], and latent Dirichlet allocation for topic modeling [11].", "startOffset": 148, "endOffset": 152}, {"referenceID": 15, "context": "Gibbs sampling is simple to implement and quickly produces accurate samples for many models, so it is widely used and available in popular libraries such as OpenBUGS [16], FACTORIE [17], JAGS [18], and MADlib [14].", "startOffset": 166, "endOffset": 170}, {"referenceID": 16, "context": "Gibbs sampling is simple to implement and quickly produces accurate samples for many models, so it is widely used and available in popular libraries such as OpenBUGS [16], FACTORIE [17], JAGS [18], and MADlib [14].", "startOffset": 181, "endOffset": 185}, {"referenceID": 17, "context": "Gibbs sampling is simple to implement and quickly produces accurate samples for many models, so it is widely used and available in popular libraries such as OpenBUGS [16], FACTORIE [17], JAGS [18], and MADlib [14].", "startOffset": 192, "endOffset": 196}, {"referenceID": 13, "context": "Gibbs sampling is simple to implement and quickly produces accurate samples for many models, so it is widely used and available in popular libraries such as OpenBUGS [16], FACTORIE [17], JAGS [18], and MADlib [14].", "startOffset": 209, "endOffset": 213}, {"referenceID": 20, "context": "From the hardware efficiency perspective, systematic scans are clearly superior [21, 22].", "startOffset": 80, "endOffset": 88}, {"referenceID": 21, "context": "From the hardware efficiency perspective, systematic scans are clearly superior [21, 22].", "startOffset": 80, "endOffset": 88}, {"referenceID": 19, "context": "Recently, Roberts and Rosenthal [20] described a model in which systematic scan mixes more slowly than random scan by a polynomial factor; this disproves direction (1) of this conjecture.", "startOffset": 32, "endOffset": 36}, {"referenceID": 0, "context": "For example, mixing times are known for Mallow\u2019s model [1, 4], and colorings of a graph [5] for both random and systematic scan, but these are not applicable to general models.", "startOffset": 55, "endOffset": 61}, {"referenceID": 3, "context": "For example, mixing times are known for Mallow\u2019s model [1, 4], and colorings of a graph [5] for both random and systematic scan, but these are not applicable to general models.", "startOffset": 55, "endOffset": 61}, {"referenceID": 4, "context": "For example, mixing times are known for Mallow\u2019s model [1, 4], and colorings of a graph [5] for both random and systematic scan, but these are not applicable to general models.", "startOffset": 88, "endOffset": 91}, {"referenceID": 9, "context": "On the other hand, random scan has been shown to mix in polynomial time for models that satisfy structural conditions \u2013 such as having close-to-modular energy functions [10] or having bounded hierarchy width and factor weights [2] \u2013 but corresponding results for for systematic scan are not known.", "startOffset": 169, "endOffset": 173}, {"referenceID": 1, "context": "On the other hand, random scan has been shown to mix in polynomial time for models that satisfy structural conditions \u2013 such as having close-to-modular energy functions [10] or having bounded hierarchy width and factor weights [2] \u2013 but corresponding results for for systematic scan are not known.", "startOffset": 227, "endOffset": 230}, {"referenceID": 5, "context": "The major exception to these limitations is Dobrushin\u2019s condition, which guarantees O(n log n) mixing for both random scan and systematic scan [6, 13].", "startOffset": 143, "endOffset": 150}, {"referenceID": 12, "context": "The major exception to these limitations is Dobrushin\u2019s condition, which guarantees O(n log n) mixing for both random scan and systematic scan [6, 13].", "startOffset": 143, "endOffset": 150}, {"referenceID": 11, "context": "In contrast to Gibbs sampling, avoiding \u201cbad permutations\u201d in the IGM is known to be important to ensure fast convergence [12, 19].", "startOffset": 122, "endOffset": 130}, {"referenceID": 18, "context": "In contrast to Gibbs sampling, avoiding \u201cbad permutations\u201d in the IGM is known to be important to ensure fast convergence [12, 19].", "startOffset": 122, "endOffset": 130}, {"referenceID": 19, "context": "Model tmix(R) min \u03b1 tmix(S\u03b1) max \u03b1 tmix(S\u03b1) Sequence of Dependencies n n n Two Islands 2 2 n2 Discrete Pyramid [20] n n n Memorize and Repeat n n n Soft Dependencies n n n", "startOffset": 111, "endOffset": 115}, {"referenceID": 2, "context": "(2) Diaconis [3] and Levin et al.", "startOffset": 13, "endOffset": 16}, {"referenceID": 19, "context": "For completeness, we also discuss the discrete pyramid model introduced by Roberts and Rosenthal [20] (which contradicts the conjectured choice of F2).", "startOffset": 97, "endOffset": 101}, {"referenceID": 19, "context": "3 Discrete Pyramid In the discrete pyramid model (Figure 1c) introduced by Roberts and Rosenthal [20], there are n binary variables xi, and the mass is uniformly distributed over all states where at most one xi is true.", "startOffset": 97, "endOffset": 101}, {"referenceID": 2, "context": "In this section, we derive the following weaker \u2013 but correct \u2013 version of the conjecture stated by Diaconis [3] and Levin et al.", "startOffset": 109, "endOffset": 112}, {"referenceID": 14, "context": "[15].", "startOffset": 0, "endOffset": 4}], "year": 2016, "abstractText": "Gibbs sampling is a Markov Chain Monte Carlo sampling technique that iteratively samples variables from their conditional distributions. There are two common scan orders for the variables: random scan and systematic scan. Due to the benefits of locality in hardware, systematic scan is commonly used, even though most statistical guarantees are only for random scan. While it has been conjectured that the mixing times of random scan and systematic scan do not differ by more than a logarithmic factor, we show by counterexample that this is not the case, and we prove that that the mixing times do not differ by more than a polynomial factor under mild conditions. To prove these relative bounds, we introduce a method of augmenting the state space to study systematic scan using conductance.", "creator": "LaTeX with hyperref package"}}}