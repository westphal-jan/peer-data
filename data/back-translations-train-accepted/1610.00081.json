{"id": "1610.00081", "review": {"conference": "AAAI", "VERSION": "v1", "DATE_OF_SUBMISSION": "1-Oct-2016", "title": "Deep Spatio-Temporal Residual Networks for Citywide Crowd Flows Prediction", "abstract": "Forecasting the flow of crowds is of great importance to traffic management and public safety, yet a very challenging task affected by many complex factors, such as inter-region traffic, events and weather. In this paper, we propose a deep-learning-based approach, called ST-ResNet, to collectively forecast the in-flow and out-flow of crowds in each and every region through a city. We design an end-to-end structure of ST-ResNet based on unique properties of spatio-temporal data. More specifically, we employ the framework of the residual neural networks to model the temporal closeness, period, and trend properties of the crowd traffic, respectively. For each property, we design a branch of residual convolutional units, each of which models the spatial properties of the crowd traffic. ST-ResNet learns to dynamically aggregate the output of the three residual neural networks based on data, assigning different weights to different branches and regions. The aggregation is further combined with external factors, such as weather and day of the week, to predict the final traffic of crowds in each and every region. We evaluate ST-ResNet based on two types of crowd flows in Beijing and NYC, finding that its performance exceeds six well-know methods.", "histories": [["v1", "Sat, 1 Oct 2016 03:56:13 GMT  (3061kb,D)", "http://arxiv.org/abs/1610.00081v1", null], ["v2", "Tue, 10 Jan 2017 09:53:16 GMT  (2262kb,D)", "http://arxiv.org/abs/1610.00081v2", "AAAI 2017"]], "reviews": [], "SUBJECTS": "cs.AI cs.LG", "authors": ["junbo zhang", "yu zheng", "dekang qi"], "accepted": true, "id": "1610.00081"}, "pdf": {"name": "1610.00081.pdf", "metadata": {"source": "CRF", "title": "Deep Spatio-Temporal Residual Networks for Citywide Crowd Flows Prediction", "authors": ["Junbo Zhang", "Yu Zheng", "Dekang Qi"], "emails": ["v-deq}@microsoft.com"], "sections": [{"heading": "1 Introduction", "text": "This year it has come to the point that it will only be a matter of time before it will happen, until it does."}, {"heading": "2 Preliminaries", "text": "In this section, we briefly address the problem of predicting flows of people (Zhang et al. 2016; Hoang, Zheng and Singh 2016) and formally present the deep residual learning (He et al. 2016)."}, {"heading": "2.1 Formulation of Crowd Flows Problem", "text": "Definition 1 (Region (Pang et al. 2011) There are many definitions of a place in terms of different granularities and semantic meanings. In this study, we divide a city into an I \u00b7 J grid map based on the longitude and latitude in which a grid denotes a region, as shown in Figure 2 (a) Definition 2 (In & Out flows (Zhang et al. 2016)) Let P be a collection of trajectories in the tenth time interval. For a grid (i, j) located at the ith series and the jth column, the influences and outflows of the masses in the time interval t are each asxin, i, jt = Tr P | 1 \u00b7 gk \u2212 1 6 (i, j), which lies at the ith series and the jth column, defining the influences and outflows of the masses in the time interval t."}, {"heading": "2.2 Deep Residual Learning", "text": "Deep residual learning (He et al. 2015) allows neural folding networks to have a super-deep structure of over 100 layers, even over 1000 layers, and this method has shown state-of-the-art results in several sophisticated recognition tasks, including image classification, object recognition, segmentation and localization (He et al. 2015). Formally, a residual unit with identity mapping (He et al. 2016) is defined as: X (l + 1) = X (l) + F (X (l)))) (1), where X (l) and X (l + 1) are the input or output of the lth residual unit; F is a residual function, e.g. a stack of two 3 x 3 folding layers in (He et al. 2015). The central idea of residual learning is to learn the additive residual function F in relation to X (l) (He et al. 2016)."}, {"heading": "3 Deep Spatio-Temporal Residual Networks", "text": "Figure 3 represents the architecture of ST-ResNet, which consists of four main components, each of which models the temporal proximity, period, trend and external influences. As shown in the upper right part of Figure 3, we first turn to the in-flow and out-flow through a city using the approach presented in Definitions 1 and 2 at each time interval. Then, we divide the timeline into three fragments, which denote the most recent time, near history and distant history. The two-channel flow matrices of the intervals in each time fragment are then fed individually into the first three components to model the above three temporal properties: proximity, period and trend. The first three components share the same network structure with a revolutionary neural network, followed by a sequence of residual units. Such a structure captures the spatial dependence between near and distant regions. In the external components, we extract some features from external data by integrating them into the first components."}, {"heading": "3.1 Structures of the First Three Components", "text": "The first three components (i.e. proximity, period, trend) share the same network structure, which consists of two sub-components: confrontation and residual unit, as shown in Figure 4.Convolution. A city usually has a very large size, comprising many regions with different distances. Intuitively, the flow of masses in nearby regions is interdependent, which can effectively lead to dependence between distant regions. To grasp the spatial dependence of all regions, we need to design a CNN with many layers, because a convolution only takes into account the proximity of dependencies, which we have limited by the size of their cores."}, {"heading": "3.2 The Structure of the External Component", "text": "Traffic flows can be influenced by many complex external factors, such as weather and event. Figure 5 (a) shows that traffic flows during the holidays (Chinese Spring Festival) can differ significantly from traffic flows during normal days. Figure 5 (b) shows that heavy rain significantly reduces traffic flows in the office area compared to the same day last week. Let's not be the feature vector that represents these external factors in the predicted time interval t. In our implementation, we mainly take into account weather, holiday and metadata (i.e. day of the week, day of the week / weekend).The details are introduced in Table 1. To predict traffic flows in the time interval t, the holiday event and metadata can be determined directly. However, the weather in the future time interval t is not known. Instead, you can use the forecast weather in the time interval t or the approximate weather in the time interval. Formally, we stack two completely connected layers to the first layer, where each layer can be followed by the second layer."}, {"heading": "3.3 Fusion", "text": "In this section, we discuss how to merge four components in Figure 3. First, we merge the first three components q = q with a parametric matrix-based fusion method, which is then further combined with the external component. Figure 6 (a) and (d) shows the ratio between arbitrary two in-flow intervals in two different time intervals, which implies temporal proximity. The curves from two different regions all show an empirical time correlation in time series, namely in-flows of the most recent time intervals are more relevant than those in distant time intervals, which implies temporal proximity. Two curves have different shapes, which have different properties of region closure. Figures 6 (b) and (e) show time intervals in all time intervals. We can see the apparent daily periodicity in all of these three regions."}, {"heading": "3.4 Algorithms and Optimization", "text": "Algorithm 1 sketches the ST ResNet training process. We first construct \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 q = q = 6 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7"}, {"heading": "4 Experiments", "text": "In this section, we evaluate our ST-ResNet based on two types of crowdflows in Beijing and NYC based on 6 baselines."}, {"heading": "4.1 Settings", "text": "In fact, we are able to put ourselves at the top, \"he said in an interview with the German Press Agency.\" We have to put ourselves at the top, \"he said.\" We have to put ourselves at the top, \"he said.\" We have to put ourselves at the top. \""}, {"heading": "4.3 Results on BikeNYC14", "text": "Table 3 shows the results of our model and other baselines on BikeNYC14. Because BikeNYC14 differs from TaxiBJ, it consists of two different types of crowd flows, including new flow and end flow (Hoang, Zheng and Singh 2016). Here, we use a total of 4 residual units ST-ResNet and consider the metadata as external features such as DeepST (Zhang et al. 2016). ST-ResNet has a relatively lower RMSE by 14.8% to 37.1% than these baselines, showing that our proposed model performs well in other prediction tasks."}, {"heading": "5 Related Work", "text": "There is some work to predict the movement of an individual based on their local history (Fan et al. 2015; Song et al. 2014), mainly predicting millions, if not billions, of individual mobility lanes rather than the aggregated flows of people in a region. Such a task can require enormous computational resources, and it is always not necessary for the public safety application scenario. Another branch of research focuses on predicting road speed and traffic volume (Abadi, Rajabioun and Ioannou 2015; Silva, Kang and Airoldi 2015), with most of them predicting a single or some road segment (Chen, Chen and Qian 2014; Xu et al. 2014) rather than on speed and volume throughout the city. Recently, researchers have begun to focus on predicting urban traffic flows (Hoang, Zheng and Singh 2016; Zhang et al. 2016)."}, {"heading": "6 Conclusions and Future Work", "text": "In this paper, we have proposed a novel, deep learning model for a spatio-temporal prediction problem, namely the prediction of mass flows in each region of a city, based on historical trajectory data, weather data and events. We evaluate our model on two types of mass flows in Beijing and New York City, achieving performance well above 6 basic methods, confirming that our model is better and applicable to the prediction of mass flows. In the future, we will consider more different types of flows (e.g. taxi / truck / bus data, telephone signal data, subway map thrust data) and use them all to generate many more types of flows, and predict all of these flows collectively through appropriate fusion mechanisms."}], "references": [{"title": "Traffic flow prediction for road transportation networks with limited traffic data", "author": ["A. Abadi", "T. Rajabioun", "P.A. Ioannou"], "venue": "IEEE Transactions on Intelligent Transportation Systems 16(2):653\u2013662.", "citeRegEx": "Abadi et al\\.,? 2015", "shortCiteRegEx": "Abadi et al\\.", "year": 2015}, {"title": "Road traffic congestion monitoring in social media with hinge-loss markov random fields", "author": ["P.-T. Chen", "F. Chen", "Z. Qian"], "venue": "2014 IEEE International Conference on Data Mining, 80\u201389. IEEE.", "citeRegEx": "Chen et al\\.,? 2014", "shortCiteRegEx": "Chen et al\\.", "year": 2014}, {"title": "Keras", "author": ["F. Chollet"], "venue": "https://github.com/ fchollet/keras.", "citeRegEx": "Chollet,? 2015", "shortCiteRegEx": "Chollet", "year": 2015}, {"title": "Citymomentum: an online approach for crowd behavior prediction at a citywide level", "author": ["Z. Fan", "X. Song", "R. Shibasaki", "R. Adachi"], "venue": "Proceedings of the 2015 ACM International Joint Conference on Pervasive and Ubiquitous Computing, 559\u2013569. ACM.", "citeRegEx": "Fan et al\\.,? 2015", "shortCiteRegEx": "Fan et al\\.", "year": 2015}, {"title": "Deep residual learning for image recognition", "author": ["K. He", "X. Zhang", "S. Ren", "J. Sun"], "venue": "arXiv preprint arXiv:1512.03385.", "citeRegEx": "He et al\\.,? 2015", "shortCiteRegEx": "He et al\\.", "year": 2015}, {"title": "Identity mappings in deep residual networks", "author": ["K. He", "X. Zhang", "S. Ren", "J. Sun"], "venue": "arXiv preprint arXiv:1603.05027.", "citeRegEx": "He et al\\.,? 2016", "shortCiteRegEx": "He et al\\.", "year": 2016}, {"title": "Forecasting citywide crowd flows based on big data", "author": ["M.X. Hoang", "Y. Zheng", "A.K. Singh"], "venue": "ACM SIGSPATIAL 2016.", "citeRegEx": "Hoang et al\\.,? 2016", "shortCiteRegEx": "Hoang et al\\.", "year": 2016}, {"title": "Batch normalization: Accelerating deep network training by reducing internal covariate shift", "author": ["S. Ioffe", "C. Szegedy"], "venue": "Proceedings of the 32nd International Conference on Machine Learning, ICML 2015, Lille, France, 6-11 July 2015, 448\u2013456.", "citeRegEx": "Ioffe and Szegedy,? 2015", "shortCiteRegEx": "Ioffe and Szegedy", "year": 2015}, {"title": "Supervised learning of image restoration with convolutional networks", "author": ["V. Jain", "J.F. Murray", "F. Roth", "S. Turaga", "V. Zhigulin", "K.L. Briggman", "M.N. Helmstaedter", "W. Denk", "H.S. Seung"], "venue": "2007 IEEE 11th International Conference on Computer Vision, 1\u20138. IEEE.", "citeRegEx": "Jain et al\\.,? 2007", "shortCiteRegEx": "Jain et al\\.", "year": 2007}, {"title": "Adam: A method for stochastic optimization", "author": ["D. Kingma", "J. Ba"], "venue": "arXiv preprint arXiv:1412.6980.", "citeRegEx": "Kingma and Ba,? 2014", "shortCiteRegEx": "Kingma and Ba", "year": 2014}, {"title": "ImageNet classification with deep convolutional neural networks", "author": ["A. Krizhevsky", "I. Sutskever", "G.E. Hinton"], "venue": "Advances in neural information processing systems, 1097\u20131105.", "citeRegEx": "Krizhevsky et al\\.,? 2012", "shortCiteRegEx": "Krizhevsky et al\\.", "year": 2012}, {"title": "Gradient-based learning applied to document recognition", "author": ["Y. LeCun", "L. Bottou", "Y. Bengio", "P. Haffner"], "venue": "Proceedings of the IEEE 86(11):2278\u20132324.", "citeRegEx": "LeCun et al\\.,? 1998", "shortCiteRegEx": "LeCun et al\\.", "year": 1998}, {"title": "Traffic prediction in a bike-sharing system", "author": ["Y. Li", "Y. Zheng", "H. Zhang", "L. Chen"], "venue": "Proceedings of the 23rd SIGSPATIAL International Conference on Advances in Geographic Information Systems, 33. ACM.", "citeRegEx": "Li et al\\.,? 2015", "shortCiteRegEx": "Li et al\\.", "year": 2015}, {"title": "Fully convolutional networks for semantic segmentation", "author": ["J. Long", "E. Shelhamer", "T. Darrell"], "venue": "Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, 3431\u20133440.", "citeRegEx": "Long et al\\.,? 2015", "shortCiteRegEx": "Long et al\\.", "year": 2015}, {"title": "Deep multiscale video prediction beyond mean square error", "author": ["M. Mathieu", "C. Couprie", "Y. LeCun"], "venue": "arXiv preprint arXiv:1511.05440.", "citeRegEx": "Mathieu et al\\.,? 2015", "shortCiteRegEx": "Mathieu et al\\.", "year": 2015}, {"title": "Rectified linear units improve restricted boltzmann machines", "author": ["V. Nair", "G.E. Hinton"], "venue": "Proceedings of the 27th International Conference on Machine Learning (ICML-10), 807\u2013814.", "citeRegEx": "Nair and Hinton,? 2010", "shortCiteRegEx": "Nair and Hinton", "year": 2010}, {"title": "On mining anomalous patterns in road traffic streams", "author": ["L.X. Pang", "S. Chawla", "W. Liu", "Y. Zheng"], "venue": "International Conference on Advanced Data Mining and Applications, 237\u2013251. Springer.", "citeRegEx": "Pang et al\\.,? 2011", "shortCiteRegEx": "Pang et al\\.", "year": 2011}, {"title": "Predicting traffic volumes and estimating the effects of shocks in massive transportation systems", "author": ["R. Silva", "S.M. Kang", "E.M. Airoldi"], "venue": "Proceedings of the National Academy of Sciences 112(18):5643\u20135648.", "citeRegEx": "Silva et al\\.,? 2015", "shortCiteRegEx": "Silva et al\\.", "year": 2015}, {"title": "Prediction of human emergency behavior and their mobility following large-scale disaster", "author": ["X. Song", "Q. Zhang", "Y. Sekimoto", "R. Shibasaki"], "venue": "Proceedings of the 20th ACM SIGKDD international conference on Knowledge discovery and data mining, 5\u201314. ACM.", "citeRegEx": "Song et al\\.,? 2014", "shortCiteRegEx": "Song et al\\.", "year": 2014}, {"title": "Theano: A Python framework for fast computation of mathematical expressions", "author": ["Theano Development Team."], "venue": "arXiv e-prints abs/1605.02688.", "citeRegEx": "Team.,? 2016", "shortCiteRegEx": "Team.", "year": 2016}, {"title": "Accurate and interpretable bayesian mars for traffic flow prediction", "author": ["Y. Xu", "Q.-J. Kong", "R. Klette", "Y. Liu"], "venue": "IEEE Transactions on Intelligent Transportation Systems 15(6):2457\u20132469.", "citeRegEx": "Xu et al\\.,? 2014", "shortCiteRegEx": "Xu et al\\.", "year": 2014}, {"title": "DNN-based prediction model for spatial-temporal data", "author": ["J. Zhang", "Y. Zheng", "D. Qi", "R. Li", "X. Yi"], "venue": "ACM SIGSPATIAL 2016, https://www.microsoft.com/enus/research/publication/dnn-based-prediction-modelspatial-temporal-data.", "citeRegEx": "Zhang et al\\.,? 2016", "shortCiteRegEx": "Zhang et al\\.", "year": 2016}, {"title": "Forecasting fine-grained air quality based on big data", "author": ["Y. Zheng", "X. Yi", "M. Li", "R. Li", "Z. Shan", "E. Chang", "T. Li"], "venue": "Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, 2267\u20132276. ACM.", "citeRegEx": "Zheng et al\\.,? 2015", "shortCiteRegEx": "Zheng et al\\.", "year": 2015}], "referenceMentions": [{"referenceID": 21, "context": "In this paper, we predict two types of crowd flows (Zhang et al. 2016): in-flow and out-flow, as shown in Figure 1.", "startOffset": 51, "endOffset": 70}, {"referenceID": 21, "context": "In this section, we briefly revisit the crowd flows prediction problem (Zhang et al. 2016; Hoang, Zheng, and Singh 2016) and formally introduce the deep residual learning (He et al.", "startOffset": 71, "endOffset": 120}, {"referenceID": 5, "context": "2016; Hoang, Zheng, and Singh 2016) and formally introduce the deep residual learning (He et al. 2016).", "startOffset": 86, "endOffset": 102}, {"referenceID": 16, "context": "Definition 1 (Region (Pang et al. 2011)) There are many definitions of a location in terms of different granularities and semantic meanings.", "startOffset": 21, "endOffset": 39}, {"referenceID": 21, "context": "Definition 2 (In- & Out-flows (Zhang et al. 2016)) Let P be a collection of trajectories at the t time interval.", "startOffset": 30, "endOffset": 49}, {"referenceID": 4, "context": "Deep residual learning (He et al. 2015) allows convolution neural networks to have a super deep structure of over-100 layers, even over-1000 layers.", "startOffset": 23, "endOffset": 39}, {"referenceID": 4, "context": "And this method has shown state-of-the-art results on multiple challenging recognition tasks, including image classification, object detection, segmentation and localization (He et al. 2015).", "startOffset": 174, "endOffset": 190}, {"referenceID": 5, "context": "Formally, a residual unit with an identity mapping (He et al. 2016) is defined as:", "startOffset": 51, "endOffset": 67}, {"referenceID": 4, "context": ", a stack of two 3\u00d73 convolution layers in (He et al. 2015).", "startOffset": 43, "endOffset": 59}, {"referenceID": 5, "context": "The central idea of the residual learning is to learn the additive residual function F with respect to X (He et al. 2016).", "startOffset": 105, "endOffset": 121}, {"referenceID": 11, "context": "Intuitively, the flow of crowds in nearby regions may affect each other, which can be effectively handled the convolutional neural network (CNN) that have shown its powerful ability to hierarchically capture spatial structural information (LeCun et al. 1998).", "startOffset": 239, "endOffset": 258}, {"referenceID": 8, "context": "Being different from the classical CNN, we do not use subsampling, but only convolutions (Jain et al. 2007).", "startOffset": 89, "endOffset": 107}, {"referenceID": 7, "context": "ReLU) and regularization techniques are applied (Ioffe and Szegedy 2015; Krizhevsky, Sutskever, and Hinton 2012; Nair and Hinton 2010).", "startOffset": 48, "endOffset": 134}, {"referenceID": 15, "context": "ReLU) and regularization techniques are applied (Ioffe and Szegedy 2015; Krizhevsky, Sutskever, and Hinton 2012; Nair and Hinton 2010).", "startOffset": 48, "endOffset": 134}, {"referenceID": 4, "context": "To address this issue, we employ residual learning (He et al. 2015) in our model, which have been demonstrated to be very effective for training a super deep neural networks of over-1000 layers.", "startOffset": 51, "endOffset": 67}, {"referenceID": 7, "context": "We also attempt Batch Normalization (BN) (Ioffe and Szegedy 2015) which are added before ReLU.", "startOffset": 41, "endOffset": 65}, {"referenceID": 9, "context": "Then, ST-ResNet is trained via backpropagation and Adam (Kingma and Ba 2014) (lines 7-11).", "startOffset": 56, "endOffset": 76}, {"referenceID": 22, "context": "\u2022 ST-ANN: It first extracts spatial (nearby 8 regions\u2019 value) and temporal (8 previous time intervals) features, then fed into an artificial neural network (Zheng et al. 2015).", "startOffset": 156, "endOffset": 175}, {"referenceID": 21, "context": "\u2022 DeepST (Zhang et al. 2016): a DNN-based prediction model for spatio-temporal data, which shows state-of-theart results on crowd flows prediction.", "startOffset": 9, "endOffset": 28}, {"referenceID": 2, "context": "The python libraries, including Theano (Theano Development Team 2016) and Keras (Chollet 2015), are used to build our models.", "startOffset": 80, "endOffset": 94}, {"referenceID": 2, "context": "The learnable parameters are initialized using a uniform distribution with the default parameter in Keras (Chollet 2015).", "startOffset": 106, "endOffset": 120}, {"referenceID": 9, "context": "The Adam (Kingma and Ba 2014) is used for optimization.", "startOffset": 9, "endOffset": 29}, {"referenceID": 21, "context": "Here, we adopt a total of 4-residual-unit ST-ResNet, and consider the meta data as external features like DeepST (Zhang et al. 2016).", "startOffset": 113, "endOffset": 132}, {"referenceID": 21, "context": "The results of ARIMA, SARIMA, VAR and 4 DeepST variants are taken from (Zhang et al. 2016).", "startOffset": 71, "endOffset": 90}, {"referenceID": 3, "context": "There are some work to predict an individual\u2019s movement based on their location history (Fan et al. 2015; Song et al. 2014).", "startOffset": 88, "endOffset": 123}, {"referenceID": 18, "context": "There are some work to predict an individual\u2019s movement based on their location history (Fan et al. 2015; Song et al. 2014).", "startOffset": 88, "endOffset": 123}, {"referenceID": 20, "context": "Most of them are predicting a single or some road segments (Chen, Chen, and Qian 2014; Xu et al. 2014), rather than citywide speed and volume.", "startOffset": 59, "endOffset": 102}, {"referenceID": 21, "context": "Recently, the researchers start to focus on the city-scale traffic flows prediction (Hoang, Zheng, and Singh 2016; Zhang et al. 2016; Li et al. 2015).", "startOffset": 84, "endOffset": 149}, {"referenceID": 12, "context": "Recently, the researchers start to focus on the city-scale traffic flows prediction (Hoang, Zheng, and Singh 2016; Zhang et al. 2016; Li et al. 2015).", "startOffset": 84, "endOffset": 149}, {"referenceID": 21, "context": "In the previous work (Zhang et al. 2016), we proposed employing a deep neural network based prediction model for spatio-temporal data.", "startOffset": 21, "endOffset": 40}], "year": 2016, "abstractText": "Forecasting the flow of crowds is of great importance to traffic management and public safety, yet a very challenging task affected by many complex factors, such as inter-region traffic, events and weather. In this paper, we propose a deep-learningbased approach, called ST-ResNet, to collectively forecast the in-flow and out-flow of crowds in each and every region through a city. We design an end-to-end structure of STResNet based on unique properties of spatio-temporal data. More specifically, we employ the framework of the residual neural networks to model the temporal closeness, period, and trend properties of the crowd traffic, respectively. For each property, we design a branch of residual convolutional units, each of which models the spatial properties of the crowd traffic. ST-ResNet learns to dynamically aggregate the output of the three residual neural networks based on data, assigning different weights to different branches and regions. The aggregation is further combined with external factors, such as weather and day of the week, to predict the final traffic of crowds in each and every region. We evaluate ST-ResNet based on two types of crowd flows in Beijing and NYC, finding that its performance exceeds six well-know methods.", "creator": "TeX"}}}