{"id": "1610.02591", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "8-Oct-2016", "title": "Solving Marginal MAP Problems with NP Oracles and Parity Constraints", "abstract": "Arising from many applications at the intersection of decision making and machine learning, Marginal Maximum A Posteriori (Marginal MAP) Problems unify the two main classes of inference, namely maximization (optimization) and marginal inference (counting), and are believed to have higher complexity than both of them. We propose XOR_MMAP, a novel approach to solve the Marginal MAP Problem, which represents the intractable counting subproblem with queries to NP oracles, subject to additional parity constraints. XOR_MMAP provides a constant factor approximation to the Marginal MAP Problem, by encoding it as a single optimization in polynomial size of the original problem. We evaluate our approach in several machine learning and decision making applications, and show that our approach outperforms several state-of-the-art Marginal MAP solvers.", "histories": [["v1", "Sat, 8 Oct 2016 22:32:35 GMT  (1736kb,D)", "http://arxiv.org/abs/1610.02591v1", null], ["v2", "Tue, 29 Nov 2016 21:22:06 GMT  (3225kb,D)", "http://arxiv.org/abs/1610.02591v2", null]], "reviews": [], "SUBJECTS": "cs.AI", "authors": ["yexiang xue", "zhiyuan li", "stefano ermon", "carla p gomes", "bart selman"], "accepted": true, "id": "1610.02591"}, "pdf": {"name": "1610.02591.pdf", "metadata": {"source": "CRF", "title": "Solving Marginal MAP Problems with NP Oracles and Parity Constraints", "authors": ["Yexiang Xue", "Zhiyuan Li", "Carla P. Gomes", "Bart Selman"], "emails": ["yexiang@cs.cornell.edu", "lizhiyuan13@mails.tsinghua.edu.cn", "ermon@cs.stanford.edu", "gomes@cs.cornell.edu", "selman@cs.cornell.edu"], "sections": [{"heading": "1 Introduction", "text": "This year it is as far as never before in the history of the Federal Republic of Germany."}, {"heading": "2 Preliminaries", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "2.1 Problem Definition", "text": "Allow A = {0, 1} m the amount of all possible assignments to binary variables a1,.., am and X = {0, 1} n the amount of assignments to binary variables x1,.., xn. Allow w (x, a): X \u00b7 A \u2192 R + to be a function that maps any assignment to a non-negative value. Typical queries about a probabilistic model therefore include the maximization task that requires the calculation of maxa \u00b2 A w (a), and the marginal follow task \u2211 x \u00b2 X w (x) that goes substantially beyond X. The following marginal maximum A posteriori problem (marginal MAP) is a common follow task that combines the two aforementioned follow tasks with each other: max a \u00b2 A \u00b2 x x w (x), x x w (x), x \u00b2, x \u00b2, x \u00b2, x \u00b2, x \u00b2, x \u00b2, x \u00b2, x \u00b2, x \u00b2, x \u00b2, x, x \u00b2, x \u00b2, x \u00b2, x \u00b2, x \u00b2, x, x \u00b2, x, \u00b2, x, \u00b2, \u00b2 x, \u00b2, \u00b2, \u00b2 x, \u00b2, \u00b2, \u00b2, x, \u00b2, \u00b2, \u00b2, x, \u00b2, \u00b2, \u00b2, x, \u00b2, \u00b2, x, \u00b2, \u00b2, x, \u00b2, x, \u00b2, \u00b2, \u00b2, x, x, \u00b2, \u00b2, \u00b2, x, \u00b2, x, \u00b2, \u00b2, x, x, \u00b2, x, \u00b2, \u00b2, x, \u00b2, \u00b2, x, \u00b2, x, \u00b2, x, \u00b2, x, x, \u00b2, \u00b2, x, x, \u00b2, x, x, \u00b2, x, x, \u00b2, \u00b2, x, x, x, x, x, \u00b2, x, x, \u00b2, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x,"}, {"heading": "2.2 Counting by Hashing and Optimization", "text": "Our approach is based on a current theoretical result that transforms a counting problem into a series of optimization problems [6, 7, 2, 1]. A family of functionsH = {h: {0, 1} n \u2192 {0, 1} k} is considered pairs independent if the following two conditions apply to each function h randomly selected from the H family: (1) the random variable h (0, 1) n, the random variable h (x) is uniformly divided into {0, 1} k and (2) b: 0, 1} k, {0, 1} n, x1, 6 = x2, the random variables h (x1) and h (x2) are independent."}, {"heading": "3 XOR_MMAP Algorithm", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1 Binary Case", "text": "We first solve the marginal MAP problem for the binary case in which the function w: A \u00b7 X \u2192 {0, 1} results either 0 or 1. We extend the result to the weighted case in the next section. Due to the link to decision making, in which a solution often represents decision variables, we call a fixed mapping to the vector a = a0 a \"solution strategy.\" To simplify the notation, we use W (a0) to represent the set {x) = 1}, and use W (a0, hk) to represent the set {x _ X: w (a0, x) = 1 and hk (x) = 0}, in which hk of a pair-wise independent function family, the cards X to {0, 1} k. We write # w (a0) as an abbreviation for the counting."}, {"heading": "3.2 Extension to the Weighted Case", "text": "In this section, we will examine the more general case where w (a, x) takes non-negative real numbers instead of integers (x, 1). Unlike [6], we choose our proof from the unweighted case because it can effectively be avoided to model the median [5], which is difficult to encode in integral programming. Let us leave w: A \u00b7 X \u2192 R +, and M = maxa, x (a, x).Definition 3.4. We define the embedding of Sa (w, l) of X \u00b7 {0, 1} l as: Sa (w, l) l as: Sa (x) = {(x, y) | M = max."}, {"heading": "4 Experiments", "text": "We evaluate our proposed XOR _ MMAP algorithm against two baselines - the Sample Average Approximation (SAA) [15] and the Mixed Loopy Belief Propagation (Mixed LBP) [10]. These two baselines are selected to represent the two most common classes of methods that approach the embedded sum in MMAP problems in two different ways. SAA approaches the intractable sum with a finite number of samples, while the Mixed LBP uses a variable approach. We received the Mixed LBP implementation from the author of the [10] and we use their default parameter settings. As marginal MAP problems are generally very hard and there is currently no exact solution that scales to reasonably large instances, our main comparison is on the relative optimum gap: we get the solution for each approach first. Then we compare the difference in objective function log xx."}, {"heading": "5 Conclusion", "text": "We propose XOR _ MMAP, a novel constant approximation algorithm for solving the marginal MAP problem. Our approach addresses the persistent counting subproblem of requests to NP oracles, which is subject to additional parity constraints. In our algorithm, the entire problem can be solved by a single optimization. We evaluate our approach with respect to multiple machine learning and decision applications. We are able to show that XOR _ MMAP outperforms several state-of-the-art marginal MAP solvers. XOR _ MMAP offers a new approach to solving the marginal MAP problem and opens the door to new research directions and applications in real-world areas."}, {"heading": "Acknowledgments", "text": "This research was supported by the National Science Foundation (Price Code: 0832782, 1522054, 1059284)."}], "references": [{"title": "Stochastic integration via error-correcting codes", "author": ["Dimitris Achlioptas", "Pei Jiang"], "venue": "In Proc. Uncertainty in Artificial Intelligence,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2015}, {"title": "Hashing-based approximate probabilistic inference in hybrid domains", "author": ["Vaishak Belle", "Guy Van den Broeck", "Andrea Passerini"], "venue": "In Proceedings of the 31st Conference on Uncertainty in Artificial Intelligence (UAI),", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2015}, {"title": "Greedy layer-wise training of deep networks", "author": ["Yoshua Bengio", "Pascal Lamblin", "Dan Popovici", "Hugo Larochelle"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2006}, {"title": "Compiling relational bayesian networks for exact inference", "author": ["Mark Chavira", "Adnan Darwiche", "Manfred Jaeger"], "venue": "Int. J. Approx. Reasoning,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2006}, {"title": "Embed and project: Discrete sampling with universal hashing", "author": ["Stefano Ermon", "Carla P. Gomes", "Ashish Sabharwal", "Bart Selman"], "venue": "In Advances in Neural Information Processing Systems (NIPS),", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2013}, {"title": "Taming the curse of dimensionality: Discrete integration by hashing and optimization", "author": ["Stefano Ermon", "Carla P. Gomes", "Ashish Sabharwal", "Bart Selman"], "venue": "In Proceedings of the 30th International Conference on Machine Learning,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2013}, {"title": "Low-density parity constraints for hashing-based discrete integration", "author": ["Stefano Ermon", "Carla P. Gomes", "Ashish Sabharwal", "Bart Selman"], "venue": "In Proceedings of the 31th International Conference on Machine Learning,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2014}, {"title": "Reducing the dimensionality of data with neural networks", "author": ["Geoffrey Hinton", "Ruslan Salakhutdinov"], "venue": null, "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2006}, {"title": "Message-passing for approximate MAP inference with latent variables", "author": ["Jiarong Jiang", "Piyush Rai", "Hal Daum\u00e9 III"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2011}, {"title": "Variational algorithms for marginal MAP", "author": ["Qiang Liu", "Alexander T. Ihler"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2013}, {"title": "AND/OR search for marginal MAP", "author": ["Radu Marinescu", "Rina Dechter", "Alexander T. Ihler"], "venue": "In Proceedings of the Thirtieth Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2014}, {"title": "Pushing forward marginal MAP with best-first search", "author": ["Radu Marinescu", "Rina Dechter", "Alexander T. Ihler"], "venue": "Proceedings of the Twenty-Fourth International Joint Conference on Artificial Intelligence,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2015}, {"title": "Complexity results and approximation strategies for map explanations", "author": ["James D. Park", "Adnan Darwiche"], "venue": "J. Artif. Int. Res.,", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2004}, {"title": "Decomposition bounds for marginal MAP", "author": ["Wei Ping", "Qiang Liu", "Alexander T. Ihler"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2015}, {"title": "Maximizing the spread of cascades using network design", "author": ["Daniel Sheldon", "Bistra N. Dilkina", "Adam N. Elmachtoub", "Ryan Finseth", "Ashish Sabharwal", "Jon Conrad", "Carla P. Gomes", "David B. Shmoys", "William Allen", "Ole Amundsen", "William Vaughan"], "venue": "In UAI,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2010}, {"title": "Scheduling conservation designs for maximum flexibility via network cascade optimization", "author": ["Shan Xue", "Alan Fern", "Daniel Sheldon"], "venue": "J. Artif. Intell. Res. (JAIR),", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2015}, {"title": "Avicaching: A two stage game for bias reduction in citizen science", "author": ["Yexiang Xue", "Ian Davies", "Daniel Fink", "Christopher Wood", "Carla P. Gomes"], "venue": "In Proceedings of the 15th International Conference on Autonomous Agents and Multiagent Systems (AAMAS),", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2016}], "referenceMentions": [{"referenceID": 12, "context": "The Marginal MAP Problem is known to be NPPP-complete [13], which is commonly believed to be even harder than MAP inference (NP-hard) and marginal inference (#P-complete).", "startOffset": 54, "endOffset": 58}, {"referenceID": 9, "context": "As a supporting evidence, MMAP problems are NP-hard even on tree structured probabilistic graphical models [10].", "startOffset": 107, "endOffset": 111}, {"referenceID": 9, "context": "One class of approaches [10, 9, 12, 11, 14] use various variational forms to represent the intractable sum.", "startOffset": 24, "endOffset": 43}, {"referenceID": 8, "context": "One class of approaches [10, 9, 12, 11, 14] use various variational forms to represent the intractable sum.", "startOffset": 24, "endOffset": 43}, {"referenceID": 11, "context": "One class of approaches [10, 9, 12, 11, 14] use various variational forms to represent the intractable sum.", "startOffset": 24, "endOffset": 43}, {"referenceID": 10, "context": "One class of approaches [10, 9, 12, 11, 14] use various variational forms to represent the intractable sum.", "startOffset": 24, "endOffset": 43}, {"referenceID": 13, "context": "One class of approaches [10, 9, 12, 11, 14] use various variational forms to represent the intractable sum.", "startOffset": 24, "endOffset": 43}, {"referenceID": 14, "context": "As another family of approaches, Sample Average Approximation (SAA) [15, 16] uses a fixed set of samples to represent the intractable sum, which then transforms the entire problem into a restricted optimization, only considering a finite number of samples.", "startOffset": 68, "endOffset": 76}, {"referenceID": 15, "context": "As another family of approaches, Sample Average Approximation (SAA) [15, 16] uses a fixed set of samples to represent the intractable sum, which then transforms the entire problem into a restricted optimization, only considering a finite number of samples.", "startOffset": 68, "endOffset": 76}, {"referenceID": 5, "context": "[6, 7] recently proposed an alternative approach to approximate intractable counting problems.", "startOffset": 0, "endOffset": 6}, {"referenceID": 6, "context": "[6, 7] recently proposed an alternative approach to approximate intractable counting problems.", "startOffset": 0, "endOffset": 6}, {"referenceID": 14, "context": "As a specific example, we consider a network design application to maximize the spread of cascades [15].", "startOffset": 99, "endOffset": 103}, {"referenceID": 16, "context": "As a second example in crowdsourcing domain [17], probabilistic models are used to model people\u2019s behaviors.", "startOffset": 44, "endOffset": 48}, {"referenceID": 5, "context": "Our approach is based on a recent theoretical result that transforms a counting problem to a series of optimization problems [6, 7, 2, 1].", "startOffset": 125, "endOffset": 137}, {"referenceID": 6, "context": "Our approach is based on a recent theoretical result that transforms a counting problem to a series of optimization problems [6, 7, 2, 1].", "startOffset": 125, "endOffset": 137}, {"referenceID": 1, "context": "Our approach is based on a recent theoretical result that transforms a counting problem to a series of optimization problems [6, 7, 2, 1].", "startOffset": 125, "endOffset": 137}, {"referenceID": 0, "context": "Our approach is based on a recent theoretical result that transforms a counting problem to a series of optimization problems [6, 7, 2, 1].", "startOffset": 125, "endOffset": 137}, {"referenceID": 5, "context": "It\u2019s possible to show that HA,b is pairwise independent [6, 7].", "startOffset": 56, "endOffset": 62}, {"referenceID": 6, "context": "It\u2019s possible to show that HA,b is pairwise independent [6, 7].", "startOffset": 56, "endOffset": 62}, {"referenceID": 5, "context": "[6]) For a fixed solution strategy a0 \u2208 A, \u2022 Suppose #w(a0) \u2265 20 , then for any k \u2264 k0, with probability 1 \u2212 2 c (2c\u22121)2 , Algorithm XOR_Binary(w, a0, k \u2212 c)=true.", "startOffset": 0, "endOffset": 3}, {"referenceID": 5, "context": "[6] developed a random algorithm that gives a constant factor approximation to counting problems, which corresponds to running XOR_Binary multiple times for each k, and selecting the largest k that XOR_Binary procedure returns true most of the time.", "startOffset": 0, "endOffset": 3}, {"referenceID": 5, "context": "Unlike in [6], we choose to build our proof from the unweighted case because it can effectively avoid modeling the median [5], which is difficult to encode in integer programming.", "startOffset": 10, "endOffset": 13}, {"referenceID": 4, "context": "Unlike in [6], we choose to build our proof from the unweighted case because it can effectively avoid modeling the median [5], which is difficult to encode in integer programming.", "startOffset": 122, "endOffset": 125}, {"referenceID": 14, "context": "We evaluate our proposed algorithm XOR_MMAP against two baselines \u2013 the Sample Average Approximation (SAA) [15] and the Mixed Loopy Belief Propagation (Mixed LBP) [10].", "startOffset": 107, "endOffset": 111}, {"referenceID": 9, "context": "We evaluate our proposed algorithm XOR_MMAP against two baselines \u2013 the Sample Average Approximation (SAA) [15] and the Mixed Loopy Belief Propagation (Mixed LBP) [10].", "startOffset": 163, "endOffset": 167}, {"referenceID": 9, "context": "We obtained the Mixed LBP implementation from the author of [10] and we use their default parameter settings.", "startOffset": 60, "endOffset": 64}, {"referenceID": 3, "context": "The counting problem corresponding to a fixed action strategy a is solved using the exact solver ACE [4].", "startOffset": 101, "endOffset": 104}, {"referenceID": 2, "context": "We first learn a two-layer deep belief network [3, 8] from a 14-by-14 MNIST dataset.", "startOffset": 47, "endOffset": 53}, {"referenceID": 7, "context": "We first learn a two-layer deep belief network [3, 8] from a 14-by-14 MNIST dataset.", "startOffset": 47, "endOffset": 53}, {"referenceID": 14, "context": "We refer the reader to [15] for more background knowledge.", "startOffset": 23, "endOffset": 27}], "year": 2017, "abstractText": "Arising from many applications at the intersection of decision making and machine learning, Marginal Maximum A Posteriori (Marginal MAP) Problems unify the two main classes of inference, namely maximization (optimization) and marginal inference (counting), and are believed to have higher complexity than both of them. We propose XOR_MMAP, a novel approach to solve the Marginal MAP Problem, which represents the intractable counting subproblem with queries to NP oracles, subject to additional parity constraints. XOR_MMAP provides a constant factor approximation to the Marginal MAP Problem, by encoding it as a single optimization in polynomial size of the original problem. We evaluate our approach in several machine learning and decision making applications, and show that our approach outperforms several state-of-the-art Marginal MAP solvers.", "creator": "LaTeX with hyperref package"}}}