{"id": "1702.05563", "review": {"conference": "ACL", "VERSION": "v1", "DATE_OF_SUBMISSION": "18-Feb-2017", "title": "On the Equivalence of Holographic and Complex Embeddings for Link Prediction", "abstract": "We show the equivalence of two state-of-the-art link prediction/knowledge graph completion methods: Nickel et al's holographic embedding and Trouillon et~al.'s complex embedding. We first consider a spectral version of the holographic embedding, exploiting the frequency domain in the Fourier transform for efficient computation. The analysis of the resulting method reveals that it can be viewed as an instance of the complex embedding with certain constraints cast on the initial vectors upon training. Conversely, any complex embedding can be converted to an equivalent holographic embedding.", "histories": [["v1", "Sat, 18 Feb 2017 03:38:12 GMT  (122kb,D)", "http://arxiv.org/abs/1702.05563v1", null], ["v2", "Sat, 11 Mar 2017 11:30:19 GMT  (119kb,D)", "http://arxiv.org/abs/1702.05563v2", null], ["v3", "Fri, 22 Sep 2017 10:06:53 GMT  (132kb,D)", "http://arxiv.org/abs/1702.05563v3", "This is a slightly modified version of the paper of the same title that appeared in ACL 2017"]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["katsuhiko hayashi", "masashi shimbo"], "accepted": true, "id": "1702.05563"}, "pdf": {"name": "1702.05563.pdf", "metadata": {"source": "CRF", "title": "On the Equivalence of Holographic and Complex Embeddings for Link Prediction", "authors": ["Katsuhiko Hayashi", "Masashi Shimbo"], "emails": ["hayashi.katsuhiko@lab.ntt.co.jp", "shimbo@is.naist.jp"], "sections": [{"heading": null, "text": "We show the equivalence of two state-of-the-art methods for completing link predictions / knowledge graphs: Nickel et al's holographic embedding and Trouillon et al's complex embedding. First, we consider a spectral version of holographic embedding, using the frequency domain in the Fourier transformation for efficient calculations. Analysis of the resulting method shows that it can be regarded as an example of the complex embedding with certain limitations exerted on the initial vectors during training. Conversely, any complex embedding can be converted into an equivalent holographic embedding."}, {"heading": "1 Introduction", "text": "The completion of the knowledge diagram concerns the extension of missing knowledge in an incomplete knowledge base. It can be considered a task of link prediction, and in recent years various approaches based on vector embedding have been proposed (Bordes et al., 2011; Socher et al., 2013; Guu et al., 2015; Yang et al., 2015; Nickel et al., 2016; Trouillon et al., 2016b). The holographic embedding (Nickel et al., 2016) is one of the most advanced methods along this line of research. In this paper we show for the first time that holographic embedding can be fully trained in the frequency domain induced by the Fourier transform, thereby reducing the calculation time of the scoring function from O (n logn) to O (n). Analysis of the resulting method shows that the holographic embedding and trouillon et al are comparable to the state of the art (2016dob)."}, {"heading": "2 Preliminaries", "text": "For a vector v, [v] j represents the j th component of v. For a complex scalar z, vector z, and matrix Z, zT and ZT each denote the transposition of z and Z, and z, z, and Z their complex conjugates. Let x = [x0 \u00b7 \u00b7 xn \u2212 1] T-Rn, y = [y0 \u00b7 \u00b7 \u00b7 yn \u2212 1] T-Rn. Note, however, that the vector indexes start from 0 for the convenience of notation. The circular convolution of x and y, which is densed by x-y, is defined by [x \u2212 y] j = n \u2212 1 element k = 0 x [(j \u2212 k) mod n] yk. (1) Similarly, the circular correlation x x x x is defined."}, {"heading": "3 Holographic embedding for knowledge graph completion", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1 Knowledge graph completion", "text": "Let E and R be finite sets of entities or (binary) relations about entities. For each relationship r (s, o) and each pair s we are interested in whether r (s, o) holds 1; we write r (s, o) = + 1 if it holds, and r (s, o) = \u2212 1 if not. To be precise, we must design a training set D = R \u00b7 E \u00b7 {\u2212 1, + 1} so that (r, s, o, y), which y = r (s, o) indicates, conceives a function f: R \u00b7 E \u00b7 E \u2192 R so that f (r, s, o) gives an estimated number of points for r (s, o) = + 1 for triples (r, s, o) not observed inD; function f should give a higher value for triples (r, s, o) if r (s, o) gives a lower value for those which are less probable."}, {"heading": "3.2 Holographic embedding (HolE)", "text": "Nickel et al. (2016) proposed a holographic embedding (hole E) to complete knowledge graphs. Using training data D, this method learns the vector embedding ek-Rn of units k-E and the embedding wr-Rn of relationships r-R. The score for triple (r, s, o) is then given by fHolE (r, s, o) = wr \u00b7 (es? eo). (4) Equation (4) can be evaluated in time O (n logn) if it is calculated? eo by equation (3)."}, {"heading": "4 Spectral training of HolE", "text": "Nickel et al. (2016) used DFT and the resulting \"frequency vectors\" to efficiently calculate the circular correlation. In this section, we expand this technique further and look at the formation of HolE exclusively in the frequency domain. That is, real-value embedding ek, wr, Rn in the original \"time\" domain is abolished, and instead we train their DFT counterparts \u03b5k = F (ek), p and p (wr).Cn in the frequency domain. This formulation eliminates the need for DFT / inverse DFT, which is the largest computational bottleneck in HolE. Specifically, the scoring function of Eq. (4) in O (n) time can be directly derived from \u03b5k and p).1 Depending on the context, the letter r is used either as an index to an element in R or the binary relationship it signified.In fact, equivalents in the frequency domain are required not only for convolution, but for all relations ()."}, {"heading": "4.1 Conjugate symmetry of spectral components", "text": "A complex vector is called symmetric (or hermitic) if it is odd for j = 0 (n \u2212 j) mod n], for j = 0,..., n \u2212 1, or, in other words, if it can be written in the formularity, if it is odd, if it is odd, if it is n / 2 flip (\u03b3)] T, if it is linear, if it is n, for some g \u00b2 Cdn / 2e \u2212 1, for some g \u00b2 Cdn / 2e \u2212 1, with 1 \u00b2 R. The DFT F (x) is conjugated symmetrical if and only if x is a real vector. Therefore, maintaining the conjugate symmetry of \"frequency vectors\" is the key to ensure that their \"time\" counterparts remain in real space."}, {"heading": "4.2 Initialization and value update in frequency domain", "text": "Typically, at the beginning of the training hole E each individual embedding is initialized by a random vector. If we train hole E in the frequency domain, we could first generate a random real vector, treat it as a vector hole E in the time domain, and calculate its DFT as the initial value in the frequency domain. An alternative, simpler approach is to directly generate a random complex vector that is symmetrical, and use it as the initial frequency vector. This guarantees that the inverse DFT is a real vector, i.e., there is a valid corresponding image in the time domain. During the stochastic gradient descent (SGD), vectors \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, \u03b5s, ether, and vice versa factor that does not exist in this, symmetry, and symmetry."}, {"heading": "4.3 Real-valued dot product", "text": "In the scoring function of hole E (equation (4)), the point product is used to generate a real \"score\" from two vectors, wr and es \u00af eo. Similarly, in equation (6), the point product is applied to phenomena that are rated complex. However, as long as the conjugate symmetry of these vectors is maintained, their point product is always real. This follows from parseval's theorem; the inverse DFTs of these frequency vectors are real, and hence their point product. Therefore, the point product of the corresponding frequency vectors must also be real, according to equation (5)."}, {"heading": "4.4 Space requirement", "text": "In our spectral representation of hole E, however, it is sufficient to maintain only the first billion / 2c components to specify the frequency vector, since the vector is symmetrical. Moreover, these are real values. Thus, to specify a spectral representation of hole E, we need exactly n floating-point numbers that can be stored in the same amount of memory as the original hole E needs."}, {"heading": "5 Relation to Trouillon et al.\u2019s complex embedding", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "5.1 Complex embedding (CompE)", "text": "Trouillon et al. (2016b) proposed a method for embedding knowledge graphs called complex embedding (CompE), which is the same as Nickel et al. (2016b); the embedding of entities and the completion of relationships must be learned. However, in their model, these vectors are complex and are based on the self-decomposition of complex matrices Xr = EWr ET, which encode r-R between entities, where Xr-C | E | \u00d7 | E |, E = [e1,..., e-E |] T-C | E | \u00d7 n and Wr-diag (wr) \u03a6Cn \u00d7 n is a diagonal matrix (with diagonal elements wr-Cn). In practice, we must be Xr a real matrix, since its (r, s) component defines the score for (r, s, o) and for this purpose, simply extract the re-rehix."}, {"heading": "5.2 Equivalence of holographic and complex embeddings", "text": "Note Re (z) = Re (z) and the definition of the complex (Hermitian) q product, i.e., a \u00b7 b = aTb, we can Eq. (7) asfCompE (r, s, o) = Re (wr \u00b7 (es) ed product, i.e., where conjugation is now placed over it and not eo. In Eq. (8), we can immediately see a striking similarity to Eq. (6), the scoring function for HolE. The complex embedding extracts the real part of the complex dot product, whereas in our spectral version of HolE (spectral version of HolE), Dot product is guaranteed to be real because all embedding conjugate symmetry. In fact, Eq. (6) can be written equally asfHolE (r, s) that Holes (s, o) = 1n Re (r \u00b7 s)."}, {"heading": "6 Conclusion", "text": "We have shown that the holographic embedding (borehole E) can be calculated completely in the frequency range, which shortens the calculation time of the scoring function from O (n logn) to O (n). In particular, we have shown that the conjugate symmetry of the frequency vectors is maintained by stochastic gradient descent, which guarantees the existence of the corresponding holographic embedding in the original space (time range). In addition, we have determined the equivalence of borehole E and the complex embedding: the spectral version of borehole E is subsumed by the complex embedding as a special case in which the conjugate symmetry is imposed on embedding. Conversely, each complex embedding has an equivalent borehole."}], "references": [{"title": "Learning structured embeddings of knowledge bases", "author": ["Antoine Bordes", "Jason Weston", "Ronan Collobert", "Yoshua Bengio"], "venue": "In Proceedings of the 25th AAAI Conference on Artificial Intelligence (AAAI", "citeRegEx": "Bordes et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Bordes et al\\.", "year": 2011}, {"title": "Traversing knowledge graphs in vector space", "author": ["Kelvin Guu", "John Miller", "Percy Liang"], "venue": "In Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing (EMNLP", "citeRegEx": "Guu et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Guu et al\\.", "year": 2015}, {"title": "The link prediction problem for social networks", "author": ["David Liben-Nowell", "Jon Kleinberg"], "venue": "In Proceedings of the 12nd Annual ACM International Conference on Information and Knowledge Management (CIKM", "citeRegEx": "Liben.Nowell and Kleinberg.,? \\Q2003\\E", "shortCiteRegEx": "Liben.Nowell and Kleinberg.", "year": 2003}, {"title": "Holographic embeddings of knowledge graphs", "author": ["Maximilian Nickel", "Lorenzo Rosasco", "Tomaso Poggio"], "venue": "In Proceedings of the 30th AAAI Conference on Artificial Intelligence (AAAI \u201916),", "citeRegEx": "Nickel et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Nickel et al\\.", "year": 2016}, {"title": "Mathematics of the Discrete Fourier Transform (DFT): with Audio Applications", "author": ["Julius O. III Smith"], "venue": "W3K Publishing,", "citeRegEx": "Smith.,? \\Q2007\\E", "shortCiteRegEx": "Smith.", "year": 2007}, {"title": "Reasoning with neural tensor networks for knowledge base completion", "author": ["R. Socher", "D. Chen", "C.D. Manning", "A.Y. Ng"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "Socher et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Socher et al\\.", "year": 2013}, {"title": "Decomposing real square matrices via unitary diagonalization", "author": ["Th\u00e9o Trouillon", "Christopher R. Dance", "\u00c9ric Gaussier", "Guillaume Bouchard"], "venue": "arXiv.math eprint 1605.07103,", "citeRegEx": "Trouillon et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Trouillon et al\\.", "year": 2016}, {"title": "Complex embeddings for simple link prediction", "author": ["Th\u00e9o Trouillon", "Johannes Welbl", "Sebastian Riedel", "\u00c9ric Gaussier", "Guillaume Bouchard"], "venue": "In Proceedings of the 33rd International Conference on Machine Learning (ICML", "citeRegEx": "Trouillon et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Trouillon et al\\.", "year": 2016}, {"title": "Embedding entities and relations for learning and inference in knowledge bases", "author": ["B. Yang", "W. Yih", "X. He", "J. Gao", "L. Deng"], "venue": "In Proceedings of the 3rd International Conference on Learning Representations (ICLR \u201915),", "citeRegEx": "Yang et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Yang et al\\.", "year": 2015}], "referenceMentions": [{"referenceID": 0, "context": "It can be viewed as a task of link prediction, and various approaches based on vector embedding have been proposed in recent years (Bordes et al., 2011; Socher et al., 2013; Guu et al., 2015; Yang et al., 2015; Nickel et al., 2016; Trouillon et al., 2016b).", "startOffset": 131, "endOffset": 256}, {"referenceID": 5, "context": "It can be viewed as a task of link prediction, and various approaches based on vector embedding have been proposed in recent years (Bordes et al., 2011; Socher et al., 2013; Guu et al., 2015; Yang et al., 2015; Nickel et al., 2016; Trouillon et al., 2016b).", "startOffset": 131, "endOffset": 256}, {"referenceID": 1, "context": "It can be viewed as a task of link prediction, and various approaches based on vector embedding have been proposed in recent years (Bordes et al., 2011; Socher et al., 2013; Guu et al., 2015; Yang et al., 2015; Nickel et al., 2016; Trouillon et al., 2016b).", "startOffset": 131, "endOffset": 256}, {"referenceID": 8, "context": "It can be viewed as a task of link prediction, and various approaches based on vector embedding have been proposed in recent years (Bordes et al., 2011; Socher et al., 2013; Guu et al., 2015; Yang et al., 2015; Nickel et al., 2016; Trouillon et al., 2016b).", "startOffset": 131, "endOffset": 256}, {"referenceID": 3, "context": "It can be viewed as a task of link prediction, and various approaches based on vector embedding have been proposed in recent years (Bordes et al., 2011; Socher et al., 2013; Guu et al., 2015; Yang et al., 2015; Nickel et al., 2016; Trouillon et al., 2016b).", "startOffset": 131, "endOffset": 256}, {"referenceID": 3, "context": "Holographic embedding (Nickel et al., 2016) is one of the state-of-the-art methods along this line of research.", "startOffset": 22, "endOffset": 43}, {"referenceID": 0, "context": "It can be viewed as a task of link prediction, and various approaches based on vector embedding have been proposed in recent years (Bordes et al., 2011; Socher et al., 2013; Guu et al., 2015; Yang et al., 2015; Nickel et al., 2016; Trouillon et al., 2016b). Holographic embedding (Nickel et al., 2016) is one of the state-of-the-art methods along this line of research. In this paper, we first show that holographic embedding can be trained entirely in the frequency domain induced by the Fourier transform, thereby reducing the computation time of the scoring function from O(n logn) to O(n). The analysis of the resulting method reveals that holographic embedding and Trouillon et al. (2016b)\u2019s complex embedding, which is another state-of-the-art method for knowledge graph completion, differ only in terms of the constraints on the initial values and how a real-valued score is obtained from complex-valued dot product.", "startOffset": 132, "endOffset": 695}, {"referenceID": 2, "context": "Thus, the task is basically that of link prediction (Liben-Nowell and Kleinberg, 2003).", "startOffset": 52, "endOffset": 86}, {"referenceID": 3, "context": "2 Holographic embedding (HolE) Nickel et al. (2016) proposed holographic embedding (HolE) for knowledge graph completion.", "startOffset": 31, "endOffset": 52}, {"referenceID": 4, "context": "This relation is known as Parseval\u2019s theorem (also called the power theorem (Smith, 2007)), and it states that dot products in two domains are equal up to scaling.", "startOffset": 76, "endOffset": 89}, {"referenceID": 6, "context": "Trouillon et al. (2016a) showed that any real matrix Xr can be expressed in this form.", "startOffset": 0, "endOffset": 25}], "year": 2017, "abstractText": "We show the equivalence of two state-of-the-art link prediction/knowledge graph completion methods: Nickel et al\u2019s holographic embedding and Trouillon et al.\u2019s complex embedding. We first consider a spectral version of the holographic embedding, exploiting the frequency domain in the Fourier transform for efficient computation. The analysis of the resulting method reveals that it can be viewed as an instance of the complex embedding with certain constraints cast on the initial vectors upon training. Conversely, any complex embedding can be converted to an equivalent holographic embedding.", "creator": "LaTeX with hyperref package"}}}