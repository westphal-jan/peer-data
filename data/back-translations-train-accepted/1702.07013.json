{"id": "1702.07013", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "22-Feb-2017", "title": "Learning Hawkes Processes from Short Doubly-Censored Event Sequences", "abstract": "Many real-world applications require robust algorithms to learn point process models based on a type of incomplete data --- the so-called short doubly-censored (SDC) event sequences. In this paper, we study this critical problem of quantitative asynchronous event sequence analysis under the framework of Hawkes processes by leveraging the general idea of data synthesis. In particular, given SDC event sequences observed in a variety of time intervals, we propose a sampling-stitching data synthesis method --- sampling predecessor and successor for each SDC event sequence from potential candidates and stitching them together to synthesize long training sequences. The rationality and the feasibility of our method are discussed in terms of arguments based on likelihood. Experiments on both synthetic and real-world data demonstrate that the proposed data synthesis method improves learning results indeed for both time-invariant and time-varying Hawkes processes.", "histories": [["v1", "Wed, 22 Feb 2017 21:41:05 GMT  (8685kb,D)", "https://arxiv.org/abs/1702.07013v1", null], ["v2", "Wed, 7 Jun 2017 20:36:45 GMT  (7714kb,D)", "http://arxiv.org/abs/1702.07013v2", null]], "reviews": [], "SUBJECTS": "cs.LG math.PR stat.ML", "authors": ["hongteng xu", "dixin luo", "hongyuan zha"], "accepted": true, "id": "1702.07013"}, "pdf": {"name": "1702.07013.pdf", "metadata": {"source": "META", "title": "Learning Hawkes Processes from Short Doubly-Censored Event Sequences", "authors": ["Hongteng Xu", "Dixin Luo", "Hongyuan Zha"], "emails": ["HXU42@GATECH.EDU", "DIXIN.LUO@UTORONTO.CA", "ZHA@CC.GATECH.EDU"], "sections": [{"heading": "1. Introduction", "text": "This year, it is only a matter of time before an agreement is reached."}, {"heading": "2. Related Work", "text": "An event sequence can be represented as s = {(ti, ci)} Mi = 1, where timestamp ti (2016) in an observation window (Tb, Te) and events i (2015) in a series of event types C = {1,..., C}. A dot process is a random process model that records event sequences as instances in which Nc = {Nc (t) and Nc (t) can be characterized by their conditional intensity the number of type c events occurring at or before time. (t) A dot process works by its conditional intensity (t). (t) [dNc) | HCt] / dt, where c (ti, ci) and HCt = {ti < t, ci (C) is the set of history. It represents the expected instantaneous rate of events in the face of historical records (Daley & Vere-Jones, 2007)."}, {"heading": "3. Learning from SDC Event Sequences", "text": "Suppose that the original complete event sequences are in a long observation window. However, in practice, the observation window could be segmented into several intervals (Tnb, Tne} Nn = 1), and we can only observe Kn SDC sequences (snk) Kn k = 1 in the n-th interval (n = 1,..., N). Although we can still use maximum probability estimators to learn Hawkes processes, i.e., lower \u2212 \u2211 n, k logL (snk), (3) the SDC event sequences would cause overpass problems and loss of trigger patterns. Can we do better in such a situation? In this paper, we propose a data synthesis method based on a sampling stitching mechanism that extends SDC event sequences to longer and improves the robustness of learning algorithms."}, {"heading": "3.1. Data Synthesis via Sampling-Stitching", "text": "Let us interpret the k-th SDC event sequence at the n-th interval as snk =. Since its predecessor is not available if we know the parameters of our model directly via (3), we actually make a strong assumption on our data that there is no event that happens before snk (or previous events are too far away from snk to have an impact on s n k). Obviously, this assumption is questionable - it is likely that there are influential events that happen before snk. (4) A more reasonable strategy is to enumerate potential predecessors and maximize the expected log probability over the entire observation window: mineral n, k It is questionable whether the HCTn b [logL, snk]; (4) Here, Ex-D (f x)] represents the expectation of the function f (x) that we use random variable x-yielding on a distribution D. s, HCTnb means any history before T, n, and L (the probability is snk)."}, {"heading": "3.2. Justification", "text": "After applying our data synthesis method, we obtain many sewn event sequences that can be used as examples for estimating Es \u0445 HCTn b [logL ([s, snk]; \u044b). Specifically, we can rewrite the learning problem using the sewn sequences in (4) approximately asmin\u044b \u2212 \u2211 sstitch \u0441S (sstitch) logL (sstitch; \u044b), (7), which is actually the minimal cross-entropy estimation. p (sstitch) represents the \"true\" probability that the sewn sequence occurs, estimated on the basis of the definition in (1). Our data synthesis method uses the information from timestamps and (optional) characteristics and makes time (which) is very likely to occur in situations (1)."}, {"heading": "3.3. Feasibility", "text": "It should be noted that our data synthesis method is only suitable for those complicated point processes whose historical events have \u03b2 = influence on current and future events. In particular, we are analyzing the feasibility of our method for several typical point processes. Our data synthesis method cannot improve learning outcomes if the event sequences are generated using Poisson processes. For Poisson processes, the event rate of future events is independent of historical events. In other words, the intensity function of each interval can be learned independently based on the SDC event sequences. The sewn sequences do not provide us with additional information. For Hawkes processes whose intensity function is defined as (2), our data synthesis method can improve the robustness of the learning algorithm in general. In particular, we are looking at a \"long\" event sequence generated by a Hawkes process in the timeframe."}, {"heading": "4. Implementation for Hawkes Processes", "text": "The proposed model in (9) reflects many common characteristics of real-world events. First, infectivity between different types of events should change smoothly with increasing age of patients. Gaussian basic representation applied guarantees smoothness of infectivity function. Second, the trigger kernel measures the decrease in infectivity over time. Depending on existing work, the decay of infection is exponential, which has been verified in many real-world data (Zhou et al., 2013a; Kobayashi & Lambiotte, 2016; Choi et al al al al., 2015) For learning processes of SDC event sequences, we combine our data synthesis with an EM-based method of process acquisition."}, {"heading": "5. Experiments", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "5.1. Implementation Details", "text": "In order to demonstrate the usefulness of our data synthesis method, we combine it with different learning algorithms of the Hawkes processes and accordingly learn different models from the SDC event sequences. For time-invariant Hawkes processes, we consider two learning algorithms - our EM-based learning algorithm and the Least Squares (LS) algorithm in (Eichler et al., 2016). For time-varying Hawkes processes, we apply our EM-based learning algorithm. In the following experiments, we use Gaussian basic functions: \u03bam (t) = exp ((((t \u2212 tm) 2 / \u0441\u0442) with center tm and bandwidth \u0441\u0442. Number and bandwidth of the base can be adjusted according to the basic selection method proposed in (Xu et al., 2016a). In addition, we set V = 10 \u2212 4, \u03b3 = 1 and \u0441s = 1 in our algorithm."}, {"heading": "5.2. Synthetic Data", "text": "This year, it has come to the point where we will be able to look for a solution that is capable of finding a solution, \"he said.\" We have never found a solution, \"he said.\" We have never found a solution, \"he said.\" We have never found a solution, \"he said.\" We have never found a solution, \"he said."}, {"heading": "5.3. Real-World Data", "text": "This year, it has come to the point where it will be able to put itself at the top, \"he said in an interview with the\" Welt am Sonntag. \""}, {"heading": "6. Conclusion", "text": "In this paper, we propose a novel data synthesis method to learn Hawkes processes from SDC event sequences. Using temporal information and optional features, we measure the similarities between different SDC event sequences and estimate the distribution of potential long event sequences. Using a sampling mechanism, we successfully synthesize a large amount of long event sequences and learn point processes. We test our method for both time invariant and time varying Hawkes processes. Experiments show that our data synthesis method improves the robustness of learning algorithms for different models. In the future, we plan to analyze our data synthesis method more theoretically and quantitatively and apply it to more applications.Known gems are supported in part by NSF DMS-1317424, NIH R01 GM108341, NSFC 61628203, U1609220 and the Key Program of Shanghai Science and Technology Commission C01700."}], "references": [{"title": "Some limit theorems for hawkes processes and application to financial statistics", "author": ["Bacry", "Emmanuel", "Delattre", "Sylvain", "Hoffmann", "Marc", "Muzy", "Jean-Francois"], "venue": "Stochastic Processes and their Applications,", "citeRegEx": "Bacry et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Bacry et al\\.", "year": 2013}, {"title": "Constructing disease network and temporal progression model via context-sensitive hawkes process", "author": ["Choi", "Edward", "Du", "Nan", "Chen", "Robert", "Song", "Le", "Sun", "Jimeng"], "venue": "In ICDM,", "citeRegEx": "Choi et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Choi et al\\.", "year": 2015}, {"title": "Bootstrap confidence regions for the intensity of a poisson point process", "author": ["Cowling", "Ann", "Hall", "Peter", "Phillips", "Michael J"], "venue": "Journal of the American Statistical Association,", "citeRegEx": "Cowling et al\\.,? \\Q1996\\E", "shortCiteRegEx": "Cowling et al\\.", "year": 1996}, {"title": "Analysis of doubly-censored survival data, with application to aids", "author": ["De Gruttola", "Victor", "Lagakos", "Stephen W"], "venue": "Biometrics, pp", "citeRegEx": "Gruttola et al\\.,? \\Q1989\\E", "shortCiteRegEx": "Gruttola et al\\.", "year": 1989}, {"title": "Adapting a clinical comorbidity index for use with icd9-cm administrative databases", "author": ["Deyo", "Richard A", "Cherkin", "Daniel C", "Ciol", "Marcia A"], "venue": "Journal of clinical epidemiology,", "citeRegEx": "Deyo et al\\.,? \\Q1992\\E", "shortCiteRegEx": "Deyo et al\\.", "year": 1992}, {"title": "The jackknife, the bootstrap and other resampling plans, volume 38", "author": ["Efron", "Bradley"], "venue": null, "citeRegEx": "Efron and Bradley.,? \\Q1982\\E", "shortCiteRegEx": "Efron and Bradley.", "year": 1982}, {"title": "Graphical modeling for multivariate hawkes processes with nonparametric link functions", "author": ["Eichler", "Michael", "Dahlhaus", "Rainer", "Dueck", "Johannes"], "venue": "Journal of Time Series Analysis,", "citeRegEx": "Eichler et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Eichler et al\\.", "year": 2016}, {"title": "Local Likelihood for Intervalcensored and Aggregated Point Process Data", "author": ["Fan", "Chun-Po Steve"], "venue": "PhD thesis, University of Toronto,", "citeRegEx": "Fan and Steve.,? \\Q2009\\E", "shortCiteRegEx": "Fan and Steve.", "year": 2009}, {"title": "Bootstrapping autoregressions with conditional heteroskedasticity of unknown form", "author": ["Gon\u00e7alves", "S\u0131lvia", "Kilian", "Lutz"], "venue": "Journal of Econometrics,", "citeRegEx": "Gon\u00e7alves et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Gon\u00e7alves et al\\.", "year": 2004}, {"title": "A thinned block bootstrap variance estimation procedure for inhomogeneous spatial point patterns", "author": ["Guan", "Yongtao", "Loh", "Ji Meng"], "venue": "Journal of the American Statistical Association,", "citeRegEx": "Guan et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Guan et al\\.", "year": 2007}, {"title": "A cluster process representation of a self-exciting process", "author": ["Hawkes", "Alan G", "Oakes", "David"], "venue": "Journal of Applied Probability,", "citeRegEx": "Hawkes et al\\.,? \\Q1974\\E", "shortCiteRegEx": "Hawkes et al\\.", "year": 1974}, {"title": "Mimic-iii, a freely accessible critical care database", "author": ["Johnson", "Alistair EW", "Pollard", "Tom J", "Shen", "Lu", "Lehman", "Li-wei H", "Feng", "Mengling", "Ghassemi", "Mohammad", "Moody", "Benjamin", "Szolovits", "Peter", "Celi", "Leo Anthony", "Mark", "Roger G"], "venue": "Scientific data,", "citeRegEx": "Johnson et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Johnson et al\\.", "year": 2016}, {"title": "Gaussian process regression bootstrapping: exploring the effects of uncertainty in time course data", "author": ["Kirk", "Paul DW", "Stumpf", "Michael PH"], "venue": null, "citeRegEx": "Kirk et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Kirk et al\\.", "year": 2009}, {"title": "Survival analysis: techniques for censored and truncated data", "author": ["Klein", "John P", "Moeschberger", "Melvin L"], "venue": "Springer Science & Business Media,", "citeRegEx": "Klein et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Klein et al\\.", "year": 2005}, {"title": "Tideh: Timedependent hawkes process for predicting retweet dynamics", "author": ["Kobayashi", "Ryota", "Lambiotte", "Renaud"], "venue": "arXiv preprint arXiv:1603.09449,", "citeRegEx": "Kobayashi et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Kobayashi et al\\.", "year": 2016}, {"title": "Multitask multi-dimensional hawkes processes for modeling event sequences", "author": ["Luo", "Dixin", "Xu", "Hongteng", "Zhen", "Yi", "Ning", "Xia", "Zha", "Hongyuan", "Yang", "Xiaokang", "Zhang", "Wenjun"], "venue": "In IJCAI,", "citeRegEx": "Luo et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Luo et al\\.", "year": 2015}, {"title": "Learning mixtures of markov chains from aggregate data with structural constraints", "author": ["Luo", "Dixin", "Xu", "Hongteng", "Zhen", "Yi", "Dilkina", "Bistra", "Zha", "Hongyuan", "Yang", "Xiaokang", "Zhang", "Wenjun"], "venue": "Transactions on Knowledge and Data Engineering,", "citeRegEx": "Luo et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Luo et al\\.", "year": 2016}, {"title": "The neural hawkes process: A neurally self-modulating multivariate point process", "author": ["Mei", "Hongyuan", "Eisner", "Jason"], "venue": "arXiv preprint arXiv:1612.09328,", "citeRegEx": "Mei et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Mei et al\\.", "year": 2016}, {"title": "The stationary bootstrap", "author": ["Politis", "Dimitris N", "Romano", "Joseph P"], "venue": "Journal of the American Statistical association,", "citeRegEx": "Politis et al\\.,? \\Q1994\\E", "shortCiteRegEx": "Politis et al\\.", "year": 1994}, {"title": "Multiple Imputation for Nonresponse in Surveys, volume 307", "author": ["Rubin", "Donald B"], "venue": null, "citeRegEx": "Rubin and B.,? \\Q2009\\E", "shortCiteRegEx": "Rubin and B.", "year": 2009}, {"title": "Poisson point processes: imaging, tracking, and sensing", "author": ["Streit", "Roy L"], "venue": "Springer Science & Business Media,", "citeRegEx": "Streit and L.,? \\Q2010\\E", "shortCiteRegEx": "Streit and L.", "year": 2010}, {"title": "Estimation of the mean function of point processes based on panel count data", "author": ["J Sun", "Kalbfleisch", "JD"], "venue": "Statistica Sinica,", "citeRegEx": "Sun et al\\.,? \\Q1995\\E", "shortCiteRegEx": "Sun et al\\.", "year": 1995}, {"title": "Nonparametric estimation of a survivorship function with doubly censored data", "author": ["Turnbull", "Bruce W"], "venue": "Journal of the American Statistical Association,", "citeRegEx": "Turnbull and W.,? \\Q1974\\E", "shortCiteRegEx": "Turnbull and W.", "year": 1974}, {"title": "Inference for shared-frailty survival models with left-truncated data", "author": ["Van den Berg", "Gerard J", "Drepper", "Bettina"], "venue": "Econometric Reviews,", "citeRegEx": "Berg et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Berg et al\\.", "year": 2016}, {"title": "Two estimators of the mean of a counting process with panel count data", "author": ["Wellner", "Jon A", "Zhang", "Ying"], "venue": "Annals of Statistics,", "citeRegEx": "Wellner et al\\.,? \\Q2000\\E", "shortCiteRegEx": "Wellner et al\\.", "year": 2000}, {"title": "Trailer generation via a point process-based visual attractiveness model", "author": ["Xu", "Hongteng", "Zhen", "Yi", "Zha", "Hongyuan"], "venue": "In IJCAI,", "citeRegEx": "Xu et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Xu et al\\.", "year": 2015}, {"title": "Learning granger causality for hawkes processes", "author": ["Xu", "Hongteng", "Farajtabar", "Mehrdad", "Zha", "Hongyuan"], "venue": "In ICML,", "citeRegEx": "Xu et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Xu et al\\.", "year": 2016}, {"title": "Pinfer: Learning to infer concurrent request paths from system kernel events", "author": ["Xu", "Hongteng", "Ning", "Xia", "Zhang", "Hui", "Rhee", "Junghwan", "Jiang", "Guofei"], "venue": "In ICAC,", "citeRegEx": "Xu et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Xu et al\\.", "year": 2016}, {"title": "Icu patient flow prediction via discriminative learning of mutually-correcting processes", "author": ["Xu", "Hongteng", "Wu", "Weichang", "Nemati", "Shamim", "Zha", "Hongyuan"], "venue": "arXiv preprint arXiv:1602.05112,", "citeRegEx": "Xu et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Xu et al\\.", "year": 2016}, {"title": "Mixture of mutually exciting processes for viral diffusion", "author": ["Yang", "Shuang-Hong", "Zha", "Hongyuan"], "venue": "In ICML,", "citeRegEx": "Yang et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Yang et al\\.", "year": 2013}, {"title": "Seismic: A selfexciting point process model for predicting tweet popularity", "author": ["Zhao", "Qingyuan", "Erdogdu", "Murat A", "He", "Hera Y", "Rajaraman", "Anand", "Leskovec", "Jure"], "venue": "In KDD,", "citeRegEx": "Zhao et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Zhao et al\\.", "year": 2015}, {"title": "Learning social infectivity in sparse low-rank networks using multidimensional hawkes processes", "author": ["Zhou", "Ke", "Zha", "Hongyuan", "Song", "Le"], "venue": "In AISTATS,", "citeRegEx": "Zhou et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Zhou et al\\.", "year": 2013}, {"title": "Learning triggering kernels for multi-dimensional hawkes processes", "author": ["Zhou", "Ke", "Zha", "Hongyuan", "Song", "Le"], "venue": "In ICML,", "citeRegEx": "Zhou et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Zhou et al\\.", "year": 2013}], "referenceMentions": [{"referenceID": 30, "context": "For example, a tweet of a twitter user may trigger further responses from her friends (Zhao et al., 2015).", "startOffset": 86, "endOffset": 105}, {"referenceID": 1, "context": "A disease of a patient may trigger other complications (Choi et al., 2015).", "startOffset": 55, "endOffset": 74}, {"referenceID": 25, "context": ", self-triggering (Hawkes & Oakes, 1974) or self-correcting (Xu et al., 2015).", "startOffset": 60, "endOffset": 77}, {"referenceID": 30, "context": "Hawkes processes provide us with a physically-meaningful model to capture the infectivity among various events, which are used in social network analysis (Zhou et al., 2013b; Zhao et al., 2015), behavior analysis (Yang & Zha, 2013; Luo et al.", "startOffset": 154, "endOffset": 193}, {"referenceID": 15, "context": ", 2015), behavior analysis (Yang & Zha, 2013; Luo et al., 2015) and financial analysis (Bacry et al.", "startOffset": 27, "endOffset": 63}, {"referenceID": 0, "context": ", 2015) and financial analysis (Bacry et al., 2013).", "startOffset": 31, "endOffset": 51}, {"referenceID": 16, "context": ", 2016b), aggregated (Luo et al., 2016) and extremely-short sequences (Xu et al.", "startOffset": 21, "endOffset": 39}, {"referenceID": 2, "context": "The bootstrap methods above are also used to learn point processes (Cowling et al., 1996; Guan & Loh, 2007; Kirk & Stumpf, 2009).", "startOffset": 67, "endOffset": 128}, {"referenceID": 15, "context": ", low-rank (Luo et al., 2015) and group-sparse regularizers (Xu et al.", "startOffset": 11, "endOffset": 29}, {"referenceID": 1, "context": "According to existing work, the decay of infectivity is exponential approximately, which has been verified in many real-world data (Zhou et al., 2013a; Kobayashi & Lambiotte, 2016; Choi et al., 2015).", "startOffset": 131, "endOffset": 199}, {"referenceID": 15, "context": "Following existing work in (Luo et al., 2015; Zhou et al., 2013a; Xu et al., 2016a), we assume the infectivity connections among different event types to be sparse and impose a `1-norm regularizer on the coefficient tensor A, i.", "startOffset": 27, "endOffset": 83}, {"referenceID": 6, "context": "For time-invariant Hawkes processes, we consider two learning algorithms \u2014 our EMbased learning algorithm and the least squares (LS) algorithm in (Eichler et al., 2016).", "startOffset": 146, "endOffset": 168}, {"referenceID": 6, "context": "To demonstrate the universality of our method, besides our EM-based algorithm, we apply our method to the Least Squares (LS) algorithm (Eichler et al., 2016).", "startOffset": 135, "endOffset": 157}, {"referenceID": 11, "context": "Besides synthetic data, we also test our method on realworld data, including the LinkedIn data collected by ourselves and the MIMIC III data set (Johnson et al., 2016).", "startOffset": 145, "endOffset": 167}, {"referenceID": 4, "context": "For each patient, her/his admission time stamps and diseases (represented via the ICD-9 codes (Deyo et al., 1992)) are recorded as an event sequence, and her/his profile (includ-", "startOffset": 94, "endOffset": 113}, {"referenceID": 1, "context": "As aforementioned, some work (Choi et al., 2015) has been done to extract timeinvariant disease network from admission records.", "startOffset": 29, "endOffset": 48}], "year": 2017, "abstractText": "Many real-world applications require robust algorithms to learn point processes based on a type of incomplete data \u2014 the so-called short doublycensored (SDC) event sequences. We study this critical problem of quantitative asynchronous event sequence analysis under the framework of Hawkes processes by leveraging the idea of data synthesis. Given SDC event sequences observed in a variety of time intervals, we propose a sampling-stitching data synthesis method \u2014 sampling predecessors and successors for each SDC event sequence from potential candidates and stitching them together to synthesize long training sequences. The rationality and the feasibility of our method are discussed in terms of arguments based on likelihood. Experiments on both synthetic and real-world data demonstrate that the proposed data synthesis method improves learning results indeed for both timeinvariant and time-varying Hawkes processes.", "creator": "LaTeX with hyperref package"}}}