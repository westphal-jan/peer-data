{"id": "1708.06846", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "22-Aug-2017", "title": "On Relaxing Determinism in Arithmetic Circuits", "abstract": "The past decade has seen a significant interest in learning tractable probabilistic representations. Arithmetic circuits (ACs) were among the first proposed tractable representations, with some subsequent representations being instances of ACs with weaker or stronger properties. In this paper, we provide a formal basis under which variants on ACs can be compared, and where the precise roles and semantics of their various properties can be made more transparent. This allows us to place some recent developments on ACs in a clearer perspective and to also derive new results for ACs. This includes an exponential separation between ACs with and without determinism; completeness and incompleteness results; and tractability results (or lack thereof) when computing most probable explanations (MPEs).", "histories": [["v1", "Tue, 22 Aug 2017 23:02:11 GMT  (254kb)", "http://arxiv.org/abs/1708.06846v1", "In Proceedings of the Thirty-fourth International Conference on Machine Learning (ICML)"]], "COMMENTS": "In Proceedings of the Thirty-fourth International Conference on Machine Learning (ICML)", "reviews": [], "SUBJECTS": "cs.AI cs.LG", "authors": ["arthur choi", "adnan darwiche"], "accepted": true, "id": "1708.06846"}, "pdf": {"name": "1708.06846.pdf", "metadata": {"source": "META", "title": "On Relaxing Determinism in Arithmetic Circuits", "authors": ["Arthur Choi", "Adnan Darwiche"], "emails": ["<aychoi@cs.ucla.edu>,", "<darwiche@cs.ucla.edu>."], "sections": [{"heading": null, "text": "ar Xiv: 170 8.06 846v 1 [cs.A I] 2 2A ug2 017est in learning tractable probabilistic representations. Arithmetic circuits (ACs) were among the first proposed tractable representations, some of which are cases of ACs with weaker or stronger properties. In this paper we provide a formal basis under which variants of ACs can be compared and where the exact roles and semantics of their different properties can be made more transparent. This allows us to place some recent developments of ACs in a clearer perspective and also derive new results for ACs, including an exponential separation between ACs with and without determinism, completeness and incompleteness of results, and tractability results (or their absence) in calculating the most likely explanations (MPEs)."}, {"heading": "1. Introduction", "text": "This year it is more than ever before."}, {"heading": "2. Arithmetic Circuits", "text": "This is a distribution question when the classical tabular representation of a factor f (X) is clearly exponential in the number of variables X, but it enables an efficient answer to key probability questions. The interest in a more concise representation of these factors using arithmetic circuits, while maintaining the ability to answer some of these questions efficiently, is maintained in a more concise representation of these factors using arithmetic circuits, while maintaining the ability to answer some of these questions efficiently."}, {"heading": "3. Decomposability and Smoothness", "text": "This property has also been used by the algorithms proposed in (Lowd & Domingos, 2008) as a basis for defining arithmetic circuits.The variables of n, designated vars (n), are all variables X (n), which include all variables X (n) that appear on or under any indicator.An arithmetic circuit can be decomposed; the variables of n, designated vars (n), are all variables X (n).The property of smoothness (Darwiche, 2001b) has also been used for probable reasoning."}, {"heading": "4. Determinism", "text": "The property of determinism (Darwiche, 2001a) has been used for probable conclusions in (Darwiche, 2003) by converting it into arithmetic circuits that are deterministic; it has also been converted by the algorithm of (Lowd & Domingos, 2008) for learning arithmetic circuits; the property was later referred to as selectivity in the work on SPNs, initially in (Peharz et al.); the terminology of our current formulation would amount to the following: an arithmetic circuit is deterministic in terms of two of each of its complete subcircuits that contradict each other; we will adopt a weaker definition that allows for contradictory subcircuits as long as it has a non-zero coefficient in most of them."}, {"heading": "5. The Impact of Relaxing Determinism", "text": "We consider two new implications of relaxing determinism, one positive and one negative. We also address an apparent paradox: How could a representation (decomposable and smooth ACs) allow the calculation of marginals (a complete problem) but not simply replace the calculation of MPE (a complete problem)? We remember that the complexity class NP in the class PPP. The positive implication is that a relaxed determinism can lead to exponentially smaller arithmetic circuits. Theorem 4 (separation) There is a family of factors fn (1) in which there is a decompatible and smooth arithmetic circuit. (2) There is a decompatible and smooth circuit that calculates the marginals of fn, with a magnitude polynomial in n; (2) any deterministic, decomposed and smooth circuit that calculates the marginal of fn."}, {"heading": "Acknowledgements", "text": "This work was partially supported by the NSF grant # IIS1514253, the ONR grant # N00014-15-1-2339, and the DARPA XAI grant # N66001-17-2-4032. We thank YooJung Choi, Umut Oztok, Yujia Shen, and Guy Van den Broeck for comments and discussions on this paper."}, {"heading": "A. Proofs", "text": "The question that arises is whether the problem is a problem based on a CNF (this is essentially an instance of Cook's theorem).The satisfaction of CNF mappings corresponds to the solutions of the D-MPE query, which we can reduce to satisfaction with a D-MPE. (This is essentially an instance of Cook's theorem).The satisfaction of CNF mappings corresponds to the solutions of the D-MPE query, which we can bring to satisfaction with a D-MPE. (This is essentially an instance of Cook's theorem). (The satisfaction of CNF mappings corresponds to the solutions of the D-MPE query, which we can count on a D-PR query.) We construct a boolean circuit that takes inputs x and the outputs are true if f (x) > k and false."}], "references": [{"title": "Knowledge compilation meets communication complexity", "author": ["Bova", "Simone", "Capelli", "Florent", "Mengel", "Stefan", "Slivovsky", "Friedrich"], "venue": "In Proceedings of the Twenty-Fifth International Joint Conference on Artificial Intelligence (IJCAI),", "citeRegEx": "Bova et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Bova et al\\.", "year": 2016}, {"title": "On the robustness of most probable explanations", "author": ["Chan", "Hei", "Darwiche", "Adnan"], "venue": "In Proceedings of the 22nd Conference in Uncertainty in Artificial Intelligence (UAI),", "citeRegEx": "Chan et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Chan et al\\.", "year": 2006}, {"title": "On probabilistic inference by weighted model counting", "author": ["Chavira", "Mark", "Darwiche", "Adnan"], "venue": "Artificial Intelligence,", "citeRegEx": "Chavira et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Chavira et al\\.", "year": 2008}, {"title": "On the tractable counting of theory models and its application to truth maintenance and belief revision", "author": ["Darwiche", "Adnan"], "venue": "Journal of Applied Non-Classical Logics,", "citeRegEx": "Darwiche and Adnan.,? \\Q2001\\E", "shortCiteRegEx": "Darwiche and Adnan.", "year": 2001}, {"title": "Decomposable negation normal form", "author": ["Darwiche", "Adnan"], "venue": "Journal of the ACM,", "citeRegEx": "Darwiche and Adnan.,? \\Q2001\\E", "shortCiteRegEx": "Darwiche and Adnan.", "year": 2001}, {"title": "A logical approach to factoring belief networks", "author": ["Darwiche", "Adnan"], "venue": "In Proceedings of KR,", "citeRegEx": "Darwiche and Adnan.,? \\Q2002\\E", "shortCiteRegEx": "Darwiche and Adnan.", "year": 2002}, {"title": "A differential approach to inference in Bayesian networks", "author": ["Darwiche", "Adnan"], "venue": "J. ACM,", "citeRegEx": "Darwiche and Adnan.,? \\Q2003\\E", "shortCiteRegEx": "Darwiche and Adnan.", "year": 2003}, {"title": "Modeling and Reasoning with Bayesian Networks", "author": ["Darwiche", "Adnan"], "venue": null, "citeRegEx": "Darwiche and Adnan.,? \\Q2009\\E", "shortCiteRegEx": "Darwiche and Adnan.", "year": 2009}, {"title": "A knowledge compilation", "author": ["Darwiche", "Adnan", "Marquis", "Pierre"], "venue": "map. JAIR,", "citeRegEx": "Darwiche et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Darwiche et al\\.", "year": 2002}, {"title": "Results from the probabilistic inference evaluation of UAI-08", "author": ["Darwiche", "Adnan", "Dechter", "Rina", "Choi", "Arthur", "Gogate", "Vibhav", "Otten", "Lars"], "venue": null, "citeRegEx": "Darwiche et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Darwiche et al\\.", "year": 2008}, {"title": "New complexity results for MAP in Bayesian networks", "author": ["de Campos", "Cassio Polpo"], "venue": "In Proceedings of the 22nd International Joint Conference on Artificial Intelligence (IJCAI),", "citeRegEx": "Campos and Polpo.,? \\Q2011\\E", "shortCiteRegEx": "Campos and Polpo.", "year": 2011}, {"title": "Greedy structure search for sum-product networks", "author": ["Dennis", "Aaron W", "Ventura", "Dan"], "venue": "In Proceedings of the Twenty-Fourth International Joint Conference on Artificial Intelligence (IJCAI),", "citeRegEx": "Dennis et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Dennis et al\\.", "year": 2015}, {"title": "The sum-product theorem: A foundation for learning tractable models", "author": ["Friesen", "Abram L", "Domingos", "Pedro M"], "venue": "In Proceedings of the 33nd International Conference on Machine Learning (ICML),", "citeRegEx": "Friesen et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Friesen et al\\.", "year": 2016}, {"title": "Algebraic model counting", "author": ["Kimmig", "Angelika", "Van den Broeck", "Guy", "De Raedt", "Luc"], "venue": "CoRR, abs/1211.4475,", "citeRegEx": "Kimmig et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Kimmig et al\\.", "year": 2012}, {"title": "Algebraic model counting", "author": ["Kimmig", "Angelika", "Van den Broeck", "Guy", "De Raedt", "Luc"], "venue": "International Journal of Applied Logic,", "citeRegEx": "Kimmig et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Kimmig et al\\.", "year": 2016}, {"title": "Probabilistic sentential decision diagrams", "author": ["Kisa", "Doga", "Van den Broeck", "Guy", "Choi", "Arthur", "Darwiche", "Adnan"], "venue": "In KR,", "citeRegEx": "Kisa et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Kisa et al\\.", "year": 2014}, {"title": "Learning arithmetic circuits", "author": ["Lowd", "Daniel", "Domingos", "Pedro M"], "venue": "In Proceedings of the 24th Conference in Uncertainty in Artificial Intelligence (UAI),", "citeRegEx": "Lowd et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Lowd et al\\.", "year": 2008}, {"title": "Approximation complexity of maximum a posteriori inference in sumproduct", "author": ["Mau\u00e1", "Denis Deratani", "de Campos", "Cassio Polpo"], "venue": "networks. CoRR,", "citeRegEx": "Mau\u00e1 et al\\.,? \\Q2017\\E", "shortCiteRegEx": "Mau\u00e1 et al\\.", "year": 2017}, {"title": "Complexity results and approximation strategies for MAP explanations", "author": ["Park", "James D", "Darwiche", "Adnan"], "venue": "J. Artif. Intell. Res. (JAIR),", "citeRegEx": "Park et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Park et al\\.", "year": 2004}, {"title": "Learning selective sum-product networks", "author": ["Peharz", "Robert", "Gens", "Domingos", "Pedro M"], "venue": "In LTPM workshop,", "citeRegEx": "Peharz et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Peharz et al\\.", "year": 2014}, {"title": "On the latent variable interpretation in sum-product networks", "author": ["Peharz", "Robert", "Gens", "Pernkopf", "Franz", "Domingos", "Pedro"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence (TPAMI),", "citeRegEx": "Peharz et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Peharz et al\\.", "year": 2016}, {"title": "Sum-product networks: A new deep architecture", "author": ["Poon", "Hoifung", "Domingos", "Pedro M"], "venue": "In UAI, pp", "citeRegEx": "Poon et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Poon et al\\.", "year": 2011}, {"title": "Learning sumproduct networks with direct and indirect variable interactions", "author": ["Rooshenas", "Amirmohammad", "Lowd", "Daniel"], "venue": "In ICML, pp", "citeRegEx": "Rooshenas et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Rooshenas et al\\.", "year": 2014}, {"title": "On the hardness of approximate reasoning", "author": ["Roth", "Dan"], "venue": "Artif. Intell.,", "citeRegEx": "Roth and Dan.,? \\Q1996\\E", "shortCiteRegEx": "Roth and Dan.", "year": 1996}, {"title": "Tractable operations for arithmetic circuits of probabilistic models", "author": ["Shen", "Yujia", "Choi", "Arthur", "Darwiche", "Adnan"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "Shen et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Shen et al\\.", "year": 2016}, {"title": "Finding MAPs for belief networks is NP-hard", "author": ["Shimony", "Solomon Eyal"], "venue": "Artif. Intell.,", "citeRegEx": "Shimony and Eyal.,? \\Q1994\\E", "shortCiteRegEx": "Shimony and Eyal.", "year": 1994}, {"title": "A unified approach for learning the parameters of sum-product networks", "author": ["Zhao", "Han", "Poupart", "Pascal", "Gordon", "Geoffrey J"], "venue": "In Advances in Neural Information Processing Systems 29 (NIPS),", "citeRegEx": "Zhao et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Zhao et al\\.", "year": 2016}], "referenceMentions": [{"referenceID": 26, "context": "They were also adopted in (Dennis & Ventura, 2015; Zhao et al., 2016) to motivate SPN learning algorithms.", "startOffset": 26, "endOffset": 69}, {"referenceID": 13, "context": "Before we discuss determinism, we note that decomposability and determinism were exploited recently in tractable, propositional reasoning within a semi-ring setting; initially in (Kimmig et al., 2012; 2016), then followed by (Friesen & Domingos, 2016).", "startOffset": 179, "endOffset": 206}, {"referenceID": 19, "context": "The property was later called selectivity in the works on SPNs, initially in (Peharz et al., 2014).", "startOffset": 77, "endOffset": 98}, {"referenceID": 9, "context": "Another method yields circuits that can sometimes be exponentially smaller, and is implemented in the publicly available ace system (Chavira & Darwiche, 2008); see also (Darwiche et al., 2008) for an empirical evaluation of this system in one of the UAI inference evaluations.", "startOffset": 169, "endOffset": 192}, {"referenceID": 20, "context": "This oversight was noticed in later works (Peharz et al., 2016; Mau\u00e1 & de Campos, 2017).", "startOffset": 42, "endOffset": 87}, {"referenceID": 20, "context": "(Peharz et al., 2016) proposed a polytime algorithm that converts an SPN into one that is deterministic and smooth (called an augmented SPN), but this new SPN computes a different factor than the one computed by the original SPN.", "startOffset": 0, "endOffset": 21}, {"referenceID": 20, "context": "We now have the following result, whose proof expands the one given in (Peharz et al., 2016) for SPNs based on the above observations; see also (Mau\u00e1 & de Campos, 2017) for an in-depth discussion of MPE hardness on SPNs.", "startOffset": 71, "endOffset": 92}, {"referenceID": 15, "context": "Before we further discuss the impact of relaxing determinism, we point to a new class of arithmetic circuits, the Probabilistic Sentential Decision Diagram (PSDD) (Kisa et al., 2014), which imposes stronger versions of decomposability and determinism.", "startOffset": 163, "endOffset": 182}, {"referenceID": 24, "context": "This enables the multiplication of two ACs in polytime, which is otherwise hard under the standard versions of these properties (Shen et al., 2016).", "startOffset": 128, "endOffset": 147}, {"referenceID": 0, "context": "Proof (Bova et al., 2016) identifies a family of Boolean functions (the Sauerhoff functions) Sn that have decomposable NNFs (DNNFs) with sizes polynomial in n, but where their deterministic DNNFs (d-DNNFs) must have sizes exponential in n.", "startOffset": 6, "endOffset": 25}, {"referenceID": 0, "context": "Previously known separations were conditional on the polynomial hierarchy not collapsing (Darwiche & Marquis, 2002), but (Bova et al., 2016) does not make such an assumption (and neither do we).", "startOffset": 121, "endOffset": 140}, {"referenceID": 20, "context": "This MPE algorithm was used on selective SPNs (equivalent to deterministic and decomposable ACs) in (Peharz et al., 2016).", "startOffset": 100, "endOffset": 121}, {"referenceID": 14, "context": "It was also adapted to algebraic model counting (AMC) in (Kimmig et al., 2016) and to Sum-Product Functions (SPFs) in (Friesen & Domingos, 2016).", "startOffset": 57, "endOffset": 78}, {"referenceID": 14, "context": "Determinism was not required in (Kimmig et al., 2016).", "startOffset": 32, "endOffset": 53}, {"referenceID": 0, "context": "Hence, ifAC\u2032n had a sub-exponential size, then function Sn would have a sub-exponentially sized d-DNNF, which we know does not exist (Bova et al., 2016).", "startOffset": 133, "endOffset": 152}, {"referenceID": 9, "context": "As mentioned earlier, these methods can yield relatively small circuits for some graphical models with very high treewidth (Chavira & Darwiche, 2008; Darwiche et al., 2008).", "startOffset": 123, "endOffset": 172}], "year": 2017, "abstractText": "The past decade has seen a significant interest in learning tractable probabilistic representations. Arithmetic circuits (ACs) were among the first proposed tractable representations, with some subsequent representations being instances of ACs with weaker or stronger properties. In this paper, we provide a formal basis under which variants on ACs can be compared, and where the precise roles and semantics of their various properties can be made more transparent. This allows us to place some recent developments on ACs in a clearer perspective and to also derive new results for ACs. This includes an exponential separation between ACs with and without determinism; completeness and incompleteness results; and tractability results (or lack thereof) when computing most probable explanations (MPEs).", "creator": "LaTeX with hyperref package"}}}