{"id": "1103.0605", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "3-Mar-2011", "title": "Loopy Belief Propagation, Bethe Free Energy and Graph Zeta Function", "abstract": "We propose a new approach to the theoretical analysis of Loopy Belief Propagation (LBP) and the Bethe free energy (BFE) by establishing a formula to connect LBP and BFE with a graph zeta function. The proposed approach is applicable to a wide class of models including multinomial and Gaussian types. The connection derives a number of new theoretical results on LBP and BFE. This paper focuses two of such topics. One is the analysis of the region where the Hessian of the Bethe free energy is positive definite, which derives the non-convexity of BFE for graphs with multiple cycles, and a condition of convexity on a restricted set. This analysis also gives a new condition for the uniqueness of the LBP fixed point. The other result is to clarify the relation between the local stability of a fixed point of LBP and local minima of the BFE, which implies, for example, that a locally stable fixed point of the Gaussian LBP is a local minimum of the Gaussian Bethe free energy.", "histories": [["v1", "Thu, 3 Mar 2011 04:40:19 GMT  (476kb)", "http://arxiv.org/abs/1103.0605v1", null]], "reviews": [], "SUBJECTS": "cs.AI cs.DM", "authors": ["yusuke watanabe", "kenji fukumizu"], "accepted": false, "id": "1103.0605"}, "pdf": {"name": "1103.0605.pdf", "metadata": {"source": "CRF", "title": null, "authors": ["Yusuke Watanabe", "Kenji Fukumizu"], "emails": ["watay@ism.ac.jp", "fukumizu@ism.ac.jp"], "sections": [{"heading": null, "text": "ar Xiv: 110 3.06 05v1 [cs.AI] 3Keywords: loopy faith propagation, graphical models, Bethe free energy, graph zeta function, Ihara-Bass formula"}, {"heading": "1. Introduction", "text": "In fact, it is so that most of them are able to survive themselves, and that they are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...) Most of them are able to survive themselves. (...)"}, {"heading": "2. Preliminaries", "text": "In this section we summarize the background of graphical models and LBP. In Section 2.1 we introduce graphical models in the form of hypergraphs. Section 2.2 introduces the LBPalgorithm. The free energy of Bethe, which is an alternative language for the formulation of the LBP algorithm, is discussed in Section 2.3."}, {"heading": "2.1 Graphical models", "text": "An ordinary graph G = (V, E) consists of the vertex diagram V and a series of hyperedges F. A hyperedge is a non-empty subset of V. For each vertex i-V, the structures of i are defined as follows: Alpha structure H = (V, F) consists of a set of vertices V and a set of hyperedges F. A hyperedge is a non-empty subset of V. For each vertex i-V, the neighbors of i structure are defined by alpha: = Alpha structure F | i-alpha diagram. Similarly, the neighbors of alpha hyperedge H are defined by alpha hyperedge. The degrees of i and alpha are given by di: = Ni and alpha: = Alpha hyperedge: = = Alpha hyperedge. If all degrees of hyperedges are two, then the hyperedge is identified."}, {"heading": "2.2 Loopy Belief Propagation algorithm", "text": "Considering a graphical model, our task is to solve inference problems such as the calculation of marginal / conditional density functions and the partition function. Faith Propagation (BP) efficiently calculates the exact margins of a common distribution factored in by a tree-structured factor graph. Loopy Belief Propagation (LBP) is a heuristic application of the algorithm for factor diagrams with cycles that shows successful performance on various problems.First, in Section 2.2.1, we present a collection of exponential families called the inference family to formulate the LBP algorithm. In order to draw conclusions using LBP, we need to repair an inference family that \"includes\" the given graphical model. Our formulation is a variant of Wainwright et al. (2003a) approach that fully evaluates sufficient statistics on the LBP algorithm. The details of the LBP algorithm are described in subsections 2.2."}, {"heading": "2.2.1 Exponential families and Inference family", "text": "To illustrate this, here we summarize the basic facts about the exponential families. Let's be (X, B, \u03bd) a measurement space. For given n real evaluated functions (sufficient statistics) \u03c6 (x) = (\u03c61 (x),. < n (x), an exponential family is defined by Byp (x; \u03b8) = exp (N \u00b2), range beyond the specified capabilities (x \u00b2), range beyond the specified ranges (x), range beyond the specified ranges (x), range beyond the specified ranges (x), range beyond the specified ranges (x), range beyond the specified ranges (x). < n), where int is designated the interior of the specified values. We always assume that the Hessian of this function (i.e. the covariance matrix) is immutable. The derivation of the log function is referred to as a bijective function."}, {"heading": "2.2.2 LBP algorithm", "text": "The LBP algorithm calculates the approximate marginality of a given graphic model. (...) The LBP algorithm calculates the approximate marginality of a given graphic model. (...) The LBP algorithm calculates the approximate marginality of a given graphic model. (...) The LBP algorithm calculates the approximate marginality of a given graphic model. (...) The LBP algorithm calculates the approximate marginality of a given graphic model. (...) The LBP algorithm calculates the approximate marginality of a given graphic model. (...) The LBP algorithm calculates the approximate marginality of a given model. (...) The LBP algorithm calculates the approximate marginality of a given model. (...) The approximate marginality size of a given graphic model. (...) The LBP algorithm calculates the approximate marginality of a given model."}, {"heading": "2.3 Bethe free energy and characterization of LBP fixed points", "text": "The Bethe approximation was initiated by Bethe (1935) and has proved to be essentially equivalent to LBP (by Yedidia et al. (2001). The modern formula for the representation of the approximation is a variation problem of the Bethe-free energy (An, 1988). In this subsection we summarize these facts in our settings. First, we should introduce the free energy function of Bethe, since the Bethe-free energy function is a mathematically tractable approximation of the Gibbs-free energy function. For the given graphical model, the free energy FGibbs is a convex function over the set of probability distributions p = (xi) defined by FGibbs."}, {"heading": "3. Graph zeta function", "text": "s graph-zeta function was originally introduced by Y. Ihara (1966) for a particular algebraic object and was abstracted and extended by J. P. Serre (1980), Sunada (1986), and Bass (1992) to be defined on any finite graph. Edge-zeta function is a multivariable generalization of the Ihara graph-zeta function that allows for any scalar weight for any directed edge (Strong and Terras, 1996). In addition to these graph-zeta functions, we introduce a graph-zeta function defined on hypergraphs with matrix weights.The central result of this section is the Ihara-bass determinant in Section 3.2. This formula plays an important role in deriving the positive section 3.4 in the definition."}, {"heading": "3.1 Definition of the graph zeta function", "text": "D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D) E (D). (D). (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D. D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D). D (D (D). (D). D (D). D (D). D (D (D). D (D). D (D). D (D). D (D). D (D (D). D). D (D). D (D). D (D (D). D (D). D. (D). D. (D. D. (D. (D). (D). (D). D. D. (D). (D. (D). D). (D). D. (D). D. (D. (D. (D). (D). (D). (D). (D). (D). (D). (D). (D). (D. (D). (D). (D). (D). (D). (D). (D"}, {"heading": "3.2 Determinant formula of Ihara-Bass type", "text": "In the previous subsection, we have shown that the Zeta function is expressed as a determinant of size, magnitude, and magnitude. (In this subsection, we show another determinant expression with additional assumptions about matrix weights. The formula is called the Ihara-Bass determinant formula and plays a key role in the proofs of theory 10 and theorem 11. In the rest of this subsection, we fix a set of positive integers {ri} i associated with depressions. Let us leave {u\u03b1i \u2192 j} determinant formations F, i, j \u03b1 \u03b1 \u03b1 - it will be a set of matrices. (In the rest of this subsection, we fix a set of positive integers {ri} i - V, which is the argument of the Zeta function, is thatre: = rt (e) and ue \u00b2 determinant forms e: It (e) is a set of matrices ui (e)."}, {"heading": "3.3 Ihara-Bass type determinant formula on ordinary graphs", "text": "In this area, we are able to formulate the definitions and the formula above for a better understanding. (V, F) In this area, the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition of the definition"}, {"heading": "3.4 Positive definiteness condition", "text": "The Ihara-Bass determinant formula refers to the matrices M (u) and (IrV \u2212 D + W). In the later sections, we see that M (u) corresponds to the derivative of the LBP actualization and (IrV \u2212 D + W) is closely related to the Hessian function of free energy Bethe. The following theorem is fundamental to prove Theorem 14.Theorem 10 that u = {u\u03b1i \u2192 j} \u03b1F, i, j \u00b2 \u03b1 is the u\u03b1i \u2192 j = u\u03b1j \u2192 i and \u0102u\u03b1i \u2192 j < 1, where the theorem's theorem is an arbitrary operator standard. If the spec (M \u2212 u) - C r R \u2265 1, where Spec (\u00b7) denotes the set of eigenvalues, then (IrV \u2212 D + W) is the set of eigenvalues, then (IrV \u2212 W) is a positive definitive matrix."}, {"heading": "4. Main theoretical results", "text": "In this section we establish the connection between the diagram zeta function and the Bethe function of free energy. These results form the basis for the analyses in later sections. In section 4.1 we demonstrate a formula with the Ihara-Bass determinant formula proven in the previous section. The formula shows a concrete relationship between the Bethe function of free energy and the diagram zeta function. In section 4.2 we specify a condition that the Hessian of the Bethe function of free energy is positively defined."}, {"heading": "4.1 Bethe-zeta formula", "text": "In this subsection we show that the determinant of the Hessian formula of the Bethe-free energy function corresponds essentially to the reciprocal function of the zeta. < p > p > p > p > p > p > p > p > p > p > p > p > p > p (p) p > p (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p. (p) p."}, {"heading": "4.2 Positive definiteness condition", "text": "In this section we derive a condition that guarantees the positivity of the Bethe eigenenergy function. It is based on Theorem 10, which provides a condition that the matrix (I \u2212 D + W) is unambiguously positive with respect to the matrix M (u). As we have seen in the proof of the previous theorem, the matrix 2F and (I \u2212 D + W) are essentially the same. Before we provide the proof of the theorem, we point to the following fact that we can give the matrix L (u) using Eq (24). Then Spec (u) gives the matrix (R) with respect to the matrix Cr (R) as a definitive matrix (2F). It implies that we can change the matrix weighting."}, {"heading": "5. Analysis of positive definiteness and convexity of BFE", "text": "The free energy function of the Bethe is not necessarily convex, although it is an approximation of the free energy function of the Gibbs, which is convex. Non-convexity of the free energy of the Bethe can lead to several fixed points. Pakzad and Anantharam (2002) and Heskes (2004) have derived sufficient conditions of convexity and have shown that the free energy of the Bethe is convex for trees and diagrams with a cycle. In this section we will focus not only on such a global structure, but on the local structure of the free energy function of the Bethe, i.e. the Hessian. Our approach derives the region in which the positive definition is broken. All results are based on the techniques developed in the previous section. In Section 5.1 we will analyze the region in which the free energy function of the Bethe is positively defined as applying the positive definitive condition."}, {"heading": "5.1 Region of positive definite and convexity condition", "text": "In this subsection, we simplify Theorem 14 and explicitly see that if the equity matrices of the pseudomarginals are sufficiently small, the Hessian equity matrix is positively defined. \u2212 \u2212 These \"smallness criteria\" depend exclusively on the graph geometry. In the following, we select the equity standard, which is equal to the maximum individual value. \u2212 It is generally known that the standard of a correlation coefficient matrix is less than 1 assuming that the variance covariance matrix is not degenerative. Korollar17 (Positive Definitive Definitive Region) Read the Perron-Frobenius equity values of M, and the definitionLX equity matrix of M, and the definition condition of L (I)."}, {"heading": "5.2 Convexity of restricted Bethe free energy function", "text": "Our analysis so far has not been about the given compatibility function, as it disappears in the second derivatives. Not only the graph structure, but also the compatibility functions influence the properties of LBP and the free Bethe energy. In this section we will show a method for dealing with the compatibility functions. We see that understanding the positive definitive region helps us to derive a uniqueness condition from LBP."}, {"heading": "5.2.1 Restricted Bethe free energy function", "text": "Firstly, we make simple observations. Since convictions are given by equation (10,11), they must fulfill the following condition: For each factor there is {\u03b8 \"(xi) >, where inequality is the natural parameter of equality (x\u03b1). (See Equation (6) In other words, we can say that all convictions are always contained in the following subset of L: S (\u0432): = {\u043e\u0432\u043e\u0432\u043e\u0432\u043e\u0432\u043e\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u043e\u0432\u043e\u0432\u043e\u0432\u043e\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0438\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441\u0441fliflifliflifliflifliflifliflifliflifliflifliflifliflifliflifliflifliflifliflifliflifliflifliflifliflifli"}, {"heading": "5.2.2 Convexity condition and uniqueness", "text": "In the following, we will analyze the (strict) convexity of the restricted bethe function of free energy. Our focus is on multi-commercial models. As a result, we will provide a new condition that guarantees uniqueness. As of Proposition 19, the LBP fixed point is unique if F block is strictly convex. From the standpoint of approximate conclusion, the uniqueness of the LBP fixed point is a preferred property. As the LBP algorithm is interpreted as the variation problem of the Bethe function of free energy, an LBP fixed point that corresponds to the global minimum is considered the best. If we find the unique fixed point of the LBP algorithm, it is guaranteed to be the global minimum of F. To understand the convexity of F, we will analyze the Hessian region. It turns out that the positive definition of the Hessian is equivalent to this function."}, {"heading": "If \u03c1(M(W )) < 1 then F\u0302 is strictly convex. Therefore, LBP has the unique fixed point.", "text": "Theorem 14 and sentence 16 show that \"2F\" is clearly positive. In principle, we can calculate the weights W on the basis of the compatibility functions. However, it requires optimizations with respect to f; we can use standard numerical maximization techniques (Venkataraman, 2009). We leave it to the development of efficient methods for calculating the values for future work. For binary paired cases, we have a useful formula W {i, j} i, j (\u0441i, j) = tanh (| Jij |), where we use \"i, j (xi, xj), eJijxixj + hixi + hjxj\" (Watanabe and Fukumizu, 2009). Theorem 21 applies to an arbitrary LBP. However, for Gaussian cases, in this section W {i, jxj} we get no effect on the rest."}, {"heading": "5.2.3 Comparison to Mooij\u2019s condition", "text": "For multinomial models, there are several papers that provide sufficient conditions for the uniqueness characteristic. Heskes (2004) analyzed the uniqueness problem by looking at an equivalent min-max problem. Other authors analyzed the convergence characteristic rather than the uniqueness. The LBP algorithm is said to be convergent when the messages converge to the unique fixed point regardless of the initial message. By definition, this property is stronger than the uniqueness. Tatikonda and Jordan (2002) used the Gibbs measure theory and showed that the uniqueness of the Gibbs measure implies the convergence of the LBP algorithm. Ihler et al. (2006) and Mooij and Kappen (2007) derived sufficient conditions for convergence by studying conditions that make the LBP measurement a contraction."}, {"heading": "If \u03c1(M(N )) < 1, then LBP is convergent. Therefore, LBP has a unique fixed point.", "text": "Interestingly, this condition is similar to our theorem 21; both are given with weights in relation to the spectral radius of the directed edge matrix, M. The comparison of this condition is reduced to that of Wij (\u03b1 \u03b1) and Nij (\u03b1 \u03b1). (Remember the positive matrices X and Y, \u03c1 (X) \u2264 \u03c1 (Y), if Xij \u2264 Yij.) For binary pairings, the conditions match; it is not difficult to verify whether Wij = Nij = tanh (| Jij |). By numerical calculation, we assume that Wij (\u0432 \u03b1) \u2264 Nij (\u03b1) is always valid. In Figure 7, we show a diagram for the case of convergence (x1, x2, x3) = Exp (Kx1x2x3 + 0.3 \u0445ltxxi), where the convergence of convergence is and the convergence of convergence."}, {"heading": "6. Analysis of stability of LBP", "text": "In this section, we analyze the relationships between the local stability of LBP and the local structure of the beta-free energy around an LBP fixed point. As LBP is not the gradient descent of the beta-free energy function, such a relationship is not necessarily obvious. From the standpoint of the variation formulation, we hope to find the minima. In the celebrated work of Yedidia et al. (2001), they have empirically determined that locally stable LBP fixed points are local minima of the beta-free energy function; Heskes (2002) have shown the fact for multinomic cases. Below, we expand the result in two directions: First, we derive the conditions of local stability and local minimality with respect to the eigenvalues of the matrixM (u), which directly implies the above fact. Second, the result is extended to LBPs formulated by conclusions that include both multinomic and Gaussian cases. This is possible because our analysis is based on the techniques developed in section 4."}, {"heading": "6.1 LBP as a dynamical system", "text": "Firstly, we consider the LBP update as a dynamic system. At any time, the state of the algorithm is specified by the set of messages {mt\u03b1 \u2192 i}, which with its natural parameters \u00b5t = {\u00b5t\u03b1 \u2192 i}. With respect to the parameters, the update rule Eq. (9) is written as follows. (0) + 1\u03b1 \u2192 i = [BP]. (1) [BP]. (where \u03b1 = {i1,.), d\u03b1 = [Ni1r\u03b1t\u03b2 \u2192 i1,.) i) is the i-th component (i-th component (i-te). (0-p). (BP). (where \u03b1 = {i1,.), d\u03b1 = k and vice versa (\u00b7) i). (T) is the i-th component (i-th component (i-elle). To get this equation, after multiplied Eq. (9)."}, {"heading": "In other words, at an LBP fixed point \u03b7 \u2208 L, the differentiation of T is", "text": "T \u2032 = M (u), where u = {u\u03b1i \u2192 j} is given by Equation (24). Proof First, we consider the case that j = N\u03b1 r i and \u03b2 \u00b2 Nj r\u03b1. Another case is i = j and \u03b1, \u03b2 \u00b2 Ni (\u03b1 = \u03b2). Then the derivative \u0430 \u2212 1i \u00a5\"ri\" - 1Covb\u03b1 [\u03c6i, \u03c6j]. In other cases, the derivative is trivially null. The relationship j \u00b2 r i and \u03b2 \u00b2 r \u03b1 is written as (\u03b2 \u2192 j) (\u03b1 \u2192 i) in subsection 3.1. It is noteworthy that the elements of the sequence are expressed explicitly by the matrix."}, {"heading": "6.2 Spectral conditions", "text": "To suppress the oscillatory behavior of LBP, attenuation of the actualization of T \u00b2: = (1 \u2212) T + (I) will sometimes be useful, where 0 \u2264 (u) is a damping force at an LBP fixed point and I the identity matrix. As we summarize in the following theorem, local stability is determined by the linearization T \u00b2 at the fixed point. Since T \u00b2 is nothing else than M (u) at an LBP fixed point, Theorem 14 implies relations between local stability and the Hessian Bethe Free Energy function.Theorem 24 Let GDP is an LBP fixed point and assumes that T \u00b2 (\u00b5) is a minimum of energy."}, {"heading": "6.3 Special cases: gaps between stability and local minimality", "text": "Here we focus on two special cases: binary pair attractive models and pair fixed mean Gaussian models. Note that a binary pair-wise graphical model [1] becomes attractive if Jij \u2265 0, where the stable fixed points of LBP and the local minima of the Bethe function of free energy are less different. Consider the following situation: We have continuously parameterized compatibility functions {2), which are stable when the stable fixed points of LBP and the local minima of the Bethe function of free energy are less different. Consider the following situation: We have continuously parameterized compatibility functions {3 (t), which are constants of LBP and the local minima of Bethe function of free energy."}, {"heading": "7. Summary and discussions", "text": "We have shown that this compound provides powerful tools for analyzing the free energy of Bethe and LBP; key theorems are described in Section 4. In Section 5, based on the theorems, we analyzed the (non-) convexity of the free energy function of Bethe. Roughly speaking, the positive definitive region of the free energy functions of Bethe shrinks when the Perron-Frobenius eigenvalue of the directed edge matrix becomes large or equivalent, as the pole of the Ihara-zeta function comes closest to the origin. We have shown that such knowledge can be used to derive the property of LBP. In Section 6, we have shown that the local stability of LBP implies a local minimality of the free energy of Bethe, as long as LBP is well defined within a class of exponential families. A key observation is that the matrix M (u) is equal to the linearization of the energy of BP, that the formula of the LBP function to limit function is exact."}, {"heading": "7.1 Path forward", "text": "In this subsection, we list a few directions of future research that go beyond the results of this paper. In a subsequent paper (Watanabe and Fukumizu, 2011), we will further use the link between LBP, Bethe free energy and the graph-zeta function to analyze the LBP fixed point equation, focusing on binary pair models. We will characterize the class of signed graph on which the uniqueness of the LBP fixed point is guaranteed. Note that the characters at the edges represent those of the interactions (i.e. sgn Jij), which is in contrast to those of previous research and the result in Section 5, where the strength of the interactions (i.e. | Jij |) is limited. In Section 5.2, we have derived a condition for convexity for the restricted Bethe free energy function. Unfortunately, the expression of the weight W contains free operators and is not easy to calculate directly."}, {"heading": "Acknowledgments", "text": "This work was partially supported by Grant-in-Aid for JSPS Fellows 20-993 and Grant-in-Aid for Scientific Research (C) 22300098."}, {"heading": "Appendix A.", "text": "In the analyses of this paper, we sometimes reduce the number of particles to the number of particles. Therefore, it is important to understand the number of particles on the spectral radius of the particles of the particles of the particles Particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle-particle"}], "references": [{"title": "A note on the cluster variation method", "author": ["G. An"], "venue": "Journal of Statistical Physics,", "citeRegEx": "An.,? \\Q1988\\E", "shortCiteRegEx": "An.", "year": 1988}, {"title": "Bayesian compressive sensing via belief propagation", "author": ["D. Baron", "S. Sarvotham", "R.G. Baraniuk"], "venue": "Signal Processing, IEEE Transactions on,", "citeRegEx": "Baron et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Baron et al\\.", "year": 2010}, {"title": "Zeta functions of finite graphs and representations of p-adic groups", "author": ["K. Hashimoto"], "venue": null, "citeRegEx": "Hashimoto.,? \\Q1990\\E", "shortCiteRegEx": "Hashimoto.", "year": 1990}, {"title": "Learning in graphical models", "author": ["M.I. Jordan"], "venue": "Kluwer Academic Publishers,", "citeRegEx": "Jordan.,? \\Q1998\\E", "shortCiteRegEx": "Jordan.", "year": 1998}, {"title": "Zeta functions of finite graphs", "author": ["M. Kotani", "T. Sunada"], "venue": "Journal of Mathematical Sciences. The University of Tokyo,", "citeRegEx": "Kotani and Sunada.,? \\Q2000\\E", "shortCiteRegEx": "Kotani and Sunada.", "year": 2000}, {"title": "Factor graphs and the sum-product algorithm", "author": ["F.R. Kschischang", "B.J. Frey", "H.A. Loeliger"], "venue": "IEEE Transactions on information theory,", "citeRegEx": "Kschischang et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Kschischang et al\\.", "year": 2001}, {"title": "Walk-sums and belief propagation in Gaussian graphical models", "author": ["D.M. Malioutov", "J.K. Johnson", "A.S. Willsky"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "Malioutov et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Malioutov et al\\.", "year": 2006}, {"title": "Maximum likelihood estimation using composite likelihoods for closed exponential families", "author": ["K.V. Mardia", "J.T. Kent", "G. Hughes", "C.C. Taylor"], "venue": null, "citeRegEx": "Mardia et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Mardia et al\\.", "year": 2009}, {"title": "Turbo decoding as an instance of Pearl\u2019s \u201dbelief propagation", "author": ["R.J. McEliece", "D.J.C. MacKay", "J.F. Cheng"], "venue": "algorithm. IEEE J. Sel. Areas Commun.,", "citeRegEx": "McEliece et al\\.,? \\Q1998\\E", "shortCiteRegEx": "McEliece et al\\.", "year": 1998}, {"title": "Analytic and algorithmic solution of random satisfiability problems", "author": ["M. Mezard", "G. Parisi", "R. Zecchina"], "venue": null, "citeRegEx": "Mezard et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Mezard et al\\.", "year": 2002}, {"title": "Weighted zeta functions of graphs", "author": ["H. Mizuno", "I. Sato"], "venue": "Journal of Combinatorial Theory, Series B,", "citeRegEx": "Mizuno and Sato.,? \\Q2004\\E", "shortCiteRegEx": "Mizuno and Sato.", "year": 2004}, {"title": "On the properties of the Bethe approximation and loopy belief propagation on binary networks", "author": ["J.M. Mooij", "H.J. Kappen"], "venue": "Journal of Statistical Mechanics: Theory and Experiment,", "citeRegEx": "Mooij and Kappen.,? \\Q2005\\E", "shortCiteRegEx": "Mooij and Kappen.", "year": 2005}, {"title": "Sufficient conditions for convergence of the sum-product algorithm", "author": ["J.M. Mooij", "H.J. Kappen"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Mooij and Kappen.,? \\Q2007\\E", "shortCiteRegEx": "Mooij and Kappen.", "year": 2007}, {"title": "Loopy belief propagation for approximate inference: An empirical study", "author": ["K. Murphy", "Y. Weiss", "M.I. Jordan"], "venue": "Proc. of Uncertainty in AI,", "citeRegEx": "Murphy et al\\.,? \\Q1999\\E", "shortCiteRegEx": "Murphy et al\\.", "year": 1999}, {"title": "A note on the zeta function of a graph", "author": ["S. Northshield"], "venue": "Journal of Combinatorial Theory, Series B,", "citeRegEx": "Northshield.,? \\Q1998\\E", "shortCiteRegEx": "Northshield.", "year": 1998}, {"title": "Belief propagation and statistical physics", "author": ["P. Pakzad", "V. Anantharam"], "venue": "Conference on Information Sciences and Systems,", "citeRegEx": "Pakzad and Anantharam.,? \\Q2002\\E", "shortCiteRegEx": "Pakzad and Anantharam.", "year": 2002}, {"title": "Probabilistic Reasoning in Intelligent Systems: Networks of Plausible Inference", "author": ["J. Pearl"], "venue": null, "citeRegEx": "Pearl.,? \\Q1988\\E", "shortCiteRegEx": "Pearl.", "year": 1988}, {"title": "Cluster variation method in statistical physics and probabilistic graphical models", "author": ["A. Pelizzola"], "venue": "Journal of Physics A: Mathematical General,", "citeRegEx": "Pelizzola.,? \\Q2005\\E", "shortCiteRegEx": "Pelizzola.", "year": 2005}, {"title": "Zeta functions of finite graphs and coverings", "author": ["H.M. Stark", "A.A. Terras"], "venue": "Advances in Mathematics,", "citeRegEx": "Stark and Terras.,? \\Q1996\\E", "shortCiteRegEx": "Stark and Terras.", "year": 1996}, {"title": "The zeta function of a hypergraph", "author": ["C.K. Storm"], "venue": "The Electronic Journal of Combinatorics,", "citeRegEx": "Storm.,? \\Q2006\\E", "shortCiteRegEx": "Storm.", "year": 2006}, {"title": "Nonparametric belief propagation and facial appearance estimation", "author": ["E.B. Sudderth", "A.T. Ihler", "W.T. Freeman", "A.S. Willsky"], "venue": "In IEEE International Conference on Computer Vision and Pattern Recognition,", "citeRegEx": "Sudderth et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Sudderth et al\\.", "year": 2002}, {"title": "L-functions in geometry and some applications", "author": ["T. Sunada"], "venue": "Lecture Notes in Math,", "citeRegEx": "Sunada.,? \\Q1986\\E", "shortCiteRegEx": "Sunada.", "year": 1986}, {"title": "Loopy belief propagation and Gibbs measures", "author": ["S. Tatikonda", "M.I. Jordan"], "venue": "Uncertainty in AI,", "citeRegEx": "Tatikonda and Jordan.,? \\Q2002\\E", "shortCiteRegEx": "Tatikonda and Jordan.", "year": 2002}, {"title": "Applied optimization with MATLAB programming", "author": ["P. Venkataraman"], "venue": null, "citeRegEx": "Venkataraman.,? \\Q2009\\E", "shortCiteRegEx": "Venkataraman.", "year": 2009}, {"title": "Tree-based reparameterization framework for analysis of sum-product and related algorithms", "author": ["M.J. Wainwright", "T.S. Jaakkola", "A.S. Willsky"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Wainwright et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Wainwright et al\\.", "year": 2003}, {"title": "Tree-reweighted belief propagation algorithms and approximate ML estimation by pseudomoment matching", "author": ["M.J. Wainwright", "T.S. Jaakkola", "A.S. Willsky"], "venue": "In Workshop on Artificial Intelligence and Statistics,", "citeRegEx": "Wainwright et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Wainwright et al\\.", "year": 2003}, {"title": "MAP estimation via agreement on trees: message-passing and linear programming", "author": ["M.J. Wainwright", "T.S. Jaakkola", "A.S. Willsky"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Wainwright et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Wainwright et al\\.", "year": 2005}, {"title": "Variational inference in graphical models: The view from the marginal polytope", "author": ["M.J. Wainwright", "M.I. Jordan"], "venue": "In proceedings of the annual Allerton Conference on Communication, Control, and Computing,", "citeRegEx": "Wainwright and Jordan.,? \\Q2003\\E", "shortCiteRegEx": "Wainwright and Jordan.", "year": 2003}, {"title": "Graphical models, exponential families, and variational inference", "author": ["M.J. Wainwright", "M.I. Jordan"], "venue": "Foundations and Trends in Machine Learning,", "citeRegEx": "Wainwright and Jordan.,? \\Q2008\\E", "shortCiteRegEx": "Wainwright and Jordan.", "year": 2008}, {"title": "On the uniquness of the solution of belief propagation equation", "author": ["W. Watanabe", "K. Fukumizu"], "venue": "in preparation,", "citeRegEx": "Watanabe and Fukumizu.,? \\Q2011\\E", "shortCiteRegEx": "Watanabe and Fukumizu.", "year": 2011}, {"title": "Discrete geometric analysis of message passing algorithm on graphs", "author": ["Y Watanabe"], "venue": "Ph.D thesis,", "citeRegEx": "Watanabe.,? \\Q2010\\E", "shortCiteRegEx": "Watanabe.", "year": 2010}, {"title": "Graph zeta function in the Bethe free energy and loopy belief propagation", "author": ["Y. Watanabe", "K. Fukumizu"], "venue": "Advances in Neural Information Processing Systems,", "citeRegEx": "Watanabe and Fukumizu.,? \\Q2009\\E", "shortCiteRegEx": "Watanabe and Fukumizu.", "year": 2009}, {"title": "Correctness of local probability propagation in graphical models with loops", "author": ["Y. Weiss"], "venue": "Neural Computation,", "citeRegEx": "Weiss.,? \\Q2000\\E", "shortCiteRegEx": "Weiss.", "year": 2000}, {"title": "MAP estimation, linear programming and belief propagation with convex free energies", "author": ["Y. Weiss", "C. Yanover", "T. Meltzer"], "venue": "Uncertainty in Artificial Intelligence,", "citeRegEx": "Weiss et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Weiss et al\\.", "year": 2007}, {"title": "Graphical models in applied multivariate statistics", "author": ["J. Whittaker"], "venue": "Wiley Publishing,", "citeRegEx": "Whittaker.,? \\Q2009\\E", "shortCiteRegEx": "Whittaker.", "year": 2009}, {"title": "Fractional belief propagation", "author": ["W. Wiegerinck", "T. Heskes"], "venue": "Advances in Neural Information Processing Systems,", "citeRegEx": "Wiegerinck and Heskes.,? \\Q2003\\E", "shortCiteRegEx": "Wiegerinck and Heskes.", "year": 2003}, {"title": "Generalized belief propagation", "author": ["J.S. Yedidia", "W.T. Freeman", "Y. Weiss"], "venue": "Advances in Neural Information Processing Systems,", "citeRegEx": "Yedidia et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Yedidia et al\\.", "year": 2001}, {"title": "Constructing free-energy approximations and generalized belief propagation algorithms", "author": ["J.S. Yedidia", "W.T. Freeman", "Y. Weiss"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Yedidia et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Yedidia et al\\.", "year": 2005}], "referenceMentions": [{"referenceID": 34, "context": "In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998).", "startOffset": 212, "endOffset": 256}, {"referenceID": 16, "context": "In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998).", "startOffset": 212, "endOffset": 256}, {"referenceID": 3, "context": "In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998).", "startOffset": 212, "endOffset": 256}, {"referenceID": 17, "context": "Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002).", "startOffset": 96, "endOffset": 157}, {"referenceID": 8, "context": "Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002).", "startOffset": 96, "endOffset": 157}, {"referenceID": 9, "context": "Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002).", "startOffset": 96, "endOffset": 157}, {"referenceID": 3, "context": "In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998). Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002). Typically, such probability distributions are derived from random variables that only have local interactions/constraints. This factorization structure is clearly visualized by a graph, called factor graph. Since the inference problems on graphical models, such as computation of marginal/conditional density functions and partition functions, are in general intractable for large graphs, Loopy Belief Propagation (LBP) has been proposed as an efficient approximation method applicable to any graph-structured density functions. Originally, Belief Propagation (BP) algorithm was proposed by Pearl (1988) to compute exactly the marginals for tree-structured graphical", "startOffset": 243, "endOffset": 1021}, {"referenceID": 13, "context": "Some researchers have found that LBP, an extended use of BP for graphs with cycles, shows good approximation with high potential applicability (Murphy et al., 1999; McEliece et al., 1998).", "startOffset": 143, "endOffset": 187}, {"referenceID": 8, "context": "Some researchers have found that LBP, an extended use of BP for graphs with cycles, shows good approximation with high potential applicability (Murphy et al., 1999; McEliece et al., 1998).", "startOffset": 143, "endOffset": 187}, {"referenceID": 36, "context": "After the proposal, many extensions and variants have been studied (Yedidia et al., 2001; Sudderth et al., 2002; Wainwright et al., 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al.", "startOffset": 67, "endOffset": 137}, {"referenceID": 20, "context": "After the proposal, many extensions and variants have been studied (Yedidia et al., 2001; Sudderth et al., 2002; Wainwright et al., 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al.", "startOffset": 67, "endOffset": 137}, {"referenceID": 26, "context": "After the proposal, many extensions and variants have been studied (Yedidia et al., 2001; Sudderth et al., 2002; Wainwright et al., 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al.", "startOffset": 67, "endOffset": 137}, {"referenceID": 1, "context": ", 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al., 2005; Baron et al., 2010).", "startOffset": 156, "endOffset": 196}, {"referenceID": 32, "context": "One theoretical challenge of LBP is that the algorithm may have many fixed points; the uniqueness is generally guaranteed only for trees and one-cycle graphs (Weiss, 2000).", "startOffset": 158, "endOffset": 171}, {"referenceID": 32, "context": "If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000).", "startOffset": 194, "endOffset": 207}, {"referenceID": 15, "context": "Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002).", "startOffset": 70, "endOffset": 99}, {"referenceID": 18, "context": "To derive the formula, we extend the definition of existing graph zeta functions and related Ihara-Bass formula (Stark and Terras, 1996; Bass, 1992).", "startOffset": 112, "endOffset": 148}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al.", "startOffset": 0, "endOffset": 219}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph.", "startOffset": 0, "endOffset": 243}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree.", "startOffset": 0, "endOffset": 392}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree. The purpose of this paper is to provide a novel discrete geometric approach to analysis of the LBP algorithm. The starting point of our study is a question: \u201cHow are the behaviors of the LBP algorithm affected by the geometry of the graph?\u201d If the graph is a tree (L)BP works nicely; it terminates in a finite step at the unique fixed point and gives the exact marginals. If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000). Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002). Existence of multiple cycles, however, breaks down these nice properties. There have not been many researches that elucidate the effects of cycles on LBP in detail beyond \u201ctree or non-tree\u201d classification. While a notable exception is the walk-sum analysis by Johnson et al. (2006) and Malioutov et al.", "startOffset": 0, "endOffset": 1508}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree. The purpose of this paper is to provide a novel discrete geometric approach to analysis of the LBP algorithm. The starting point of our study is a question: \u201cHow are the behaviors of the LBP algorithm affected by the geometry of the graph?\u201d If the graph is a tree (L)BP works nicely; it terminates in a finite step at the unique fixed point and gives the exact marginals. If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000). Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002). Existence of multiple cycles, however, breaks down these nice properties. There have not been many researches that elucidate the effects of cycles on LBP in detail beyond \u201ctree or non-tree\u201d classification. While a notable exception is the walk-sum analysis by Johnson et al. (2006) and Malioutov et al. (2006), it is limited to the Gaussian case.", "startOffset": 0, "endOffset": 1536}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree. The purpose of this paper is to provide a novel discrete geometric approach to analysis of the LBP algorithm. The starting point of our study is a question: \u201cHow are the behaviors of the LBP algorithm affected by the geometry of the graph?\u201d If the graph is a tree (L)BP works nicely; it terminates in a finite step at the unique fixed point and gives the exact marginals. If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000). Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002). Existence of multiple cycles, however, breaks down these nice properties. There have not been many researches that elucidate the effects of cycles on LBP in detail beyond \u201ctree or non-tree\u201d classification. While a notable exception is the walk-sum analysis by Johnson et al. (2006) and Malioutov et al. (2006), it is limited to the Gaussian case. This paper proposes a method based on a new connection between LBP, Bethe free energy, and a graph zeta function. Graph zeta functions, originally introduced by Ihara (1966), are popular graph characteristics defined by the products over the prime cycles.", "startOffset": 0, "endOffset": 1747}, {"referenceID": 35, "context": "As the fundamentals, we consider the local properties of the Bethe free energy by elucidating the positive definiteness of its Hessian, while there are many studies on modifications and convexifications of the Bethe free energy function (Wiegerinck and Heskes, 2003; Wainwright et al., 2003b; Weiss et al., 2007).", "startOffset": 237, "endOffset": 312}, {"referenceID": 33, "context": "As the fundamentals, we consider the local properties of the Bethe free energy by elucidating the positive definiteness of its Hessian, while there are many studies on modifications and convexifications of the Bethe free energy function (Wiegerinck and Heskes, 2003; Wainwright et al., 2003b; Weiss et al., 2007).", "startOffset": 237, "endOffset": 312}, {"referenceID": 11, "context": "By numerical examples, we demonstrate that our new uniqueness condition covers a wider region than the one given by Mooij and Kappen (2007) for the examples.", "startOffset": 116, "endOffset": 140}, {"referenceID": 11, "context": "By numerical examples, we demonstrate that our new uniqueness condition covers a wider region than the one given by Mooij and Kappen (2007) for the examples. In the second application, we clarify a relation between the local structure of the Bethe free energy function and the local stability of a LBP fixed point. Such a relation is not necessarily obvious, since LBP is not derived as the gradient descent of the Bethe free energy. In this line of studies, for multinomial models Heskes (2002) shows that a locally stable fixed point of LBP is a local minimum of the Bethe free energy.", "startOffset": 116, "endOffset": 496}, {"referenceID": 4, "context": "Factor graphs are introduced by Kschischang et al. (2001). Any probability density function on X = \u220fi\u2208V Xi is trivially graphically factorized with respect to the \u201cone-factor hypergraph\u201d, where the unique factor includes all vertices.", "startOffset": 32, "endOffset": 58}, {"referenceID": 0, "context": "Any probability density function on X = \u220fi\u2208V Xi is trivially graphically factorized with respect to the \u201cone-factor hypergraph\u201d, where the unique factor includes all vertices. It is more informative if the factorization involves factors of small size. Our implicit assumption throughout this paper is that for all factors \u03b1, X\u03b1 = \u220f iXi are small enough, in the sense of cardinality or dimension, to be handled efficiently by computers. 2.2 Loopy Belief Propagation algorithm Given a graphical model, our task is to solve inference problem such as computation of marginal/conditional density functions and the partition function. Belief Propagation (BP) efficiently computes the exact marginals of a joint distribution that is factorized according to a tree-structured factor graph; Loopy Belief Propagation (LBP) is a heuristic application of the algorithm for factor graphs with cycles, showing successful performance in various problems. First, in Subsection 2.2.1, we introduce a collection of exponential families called inference family to formulate the LBP algorithm. In order to perform inferences using LBP, we have to fix an inference family that \u201cincludes\u201d the given graphical model. Our formulation is a variant of the approach by Wainwright et al. (2003a), where over-complete sufficient statistics are exploited.", "startOffset": 0, "endOffset": 1268}, {"referenceID": 7, "context": "This type of condition on exponential families is also considered in other litterateurs (Mardia et al., 2009).", "startOffset": 88, "endOffset": 109}, {"referenceID": 5, "context": "The procedures of the LBP algorithm is as follows (Kschischang et al., 2001).", "startOffset": 50, "endOffset": 76}, {"referenceID": 0, "context": "The modern formulation for presenting the approximation is a variational problem of the Bethe free energy (An, 1988).", "startOffset": 106, "endOffset": 116}, {"referenceID": 35, "context": "3 Bethe free energy and characterization of LBP fixed points The Bethe approximation was initiated by Bethe (1935) and was found to be essentially equivalent to LBP by Yedidia et al. (2001). The modern formulation for presenting the approximation is a variational problem of the Bethe free energy (An, 1988).", "startOffset": 168, "endOffset": 190}, {"referenceID": 3, "context": "See Wainwright and Jordan (2008) for more details.", "startOffset": 19, "endOffset": 33}, {"referenceID": 0, "context": "As shown by Pakzad and Anantharam (2002), the Bethe free energy function is convex if the factor graph has at most one cycle.", "startOffset": 23, "endOffset": 41}, {"referenceID": 0, "context": "As shown by Pakzad and Anantharam (2002), the Bethe free energy function is convex if the factor graph has at most one cycle. Therefore, the minimization of the Bethe free energy is easy for these cases. In general, however, the convexity of F is broken as the nullity of the underlying factor graph becomes large, yielding multiple minima. Though the functions \u03c6\u03b1 and \u03c6i are convex, the negative coefficients (1\u2212di) makes the function F complex. The positive-definiteness of the Hessian of the Bethe free energy will be analyzed in Section 4 and 5. The Bethe free energy function gives an alternative description of the LBP fixed points. The following fact is shown by Yedidia et al. (2001); LBP finds a stationary point of the Bethe free energy function, which is a necessary condition of the minimality.", "startOffset": 23, "endOffset": 692}, {"referenceID": 18, "context": "The edge zeta function is a multivariable generalization of Ihara\u2019s graph zeta function, allowing arbitrary scalar weight for each directed edge (Stark and Terras, 1996).", "startOffset": 145, "endOffset": 169}, {"referenceID": 4, "context": "d\u03b1 = 2 for all \u03b1 \u2208 F ), these definitions reduce to standard definitions (Kotani and Sunada, 2000).", "startOffset": 73, "endOffset": 98}, {"referenceID": 18, "context": "Serre (1980), Sunada (1986) and Bass (1992).", "startOffset": 14, "endOffset": 28}, {"referenceID": 18, "context": "Serre (1980), Sunada (1986) and Bass (1992). The edge zeta function is a multivariable generalization of Ihara\u2019s graph zeta function, allowing arbitrary scalar weight for each directed edge (Stark and Terras, 1996).", "startOffset": 14, "endOffset": 44}, {"referenceID": 19, "context": "Moreover, for general hypergraphs, we obtain the onevariable hypergraph zeta function by setting all matrix weights to be the same scalar u (Storm, 2006).", "startOffset": 140, "endOffset": 153}, {"referenceID": 18, "context": "If H is a graph and re = 1 for all e \u2208 ~ E, this zeta function reduces to the edge zeta function by Stark and Terras (1996). If in addition all these scalar weights are set to be equal, i.", "startOffset": 100, "endOffset": 124}, {"referenceID": 18, "context": "This type of determinant formula is well known in the context of graph zeta functions; in fact this theorem is a straightforward generalization of Theorem 3 of Stark and Terras (1996). In the next section we derive a new determinant formula of the zeta function by manipulating the matrix M(u) in the above determinant.", "startOffset": 160, "endOffset": 184}, {"referenceID": 18, "context": "The simplification of this matrix obtained by setting re = 1 and u = 1 is called directed edge matrix and denoted by M (Stark and Terras, 1996).", "startOffset": 119, "endOffset": 143}, {"referenceID": 4, "context": "Kotani and Sunada (2000) call this matrix a Perron-Frobenius operator.", "startOffset": 0, "endOffset": 25}, {"referenceID": 18, "context": "This zeta function is the matrix weight extension of the edge zeta function analyzed by Stark and Terras (1996). Since the degree of every hyperedge is equal to two for a graph, the matrix W\u03b1 defined in Eq.", "startOffset": 88, "endOffset": 112}, {"referenceID": 4, "context": "See Kotani and Sunada (2000); Stark and Terras (1996) for others.", "startOffset": 4, "endOffset": 29}, {"referenceID": 4, "context": "See Kotani and Sunada (2000); Stark and Terras (1996) for others.", "startOffset": 4, "endOffset": 54}, {"referenceID": 4, "context": "See Kotani and Sunada (2000); Stark and Terras (1996) for others. A combinatorial proof is given by Foata and Zeilberger (1999). 3.", "startOffset": 4, "endOffset": 128}, {"referenceID": 0, "context": "An intuitive understanding of this result, based on the Legendre duality of two types of the Bethe free energy functions is discussed by Watanabe (2010)", "startOffset": 0, "endOffset": 153}, {"referenceID": 29, "context": "For binary and pairwise case, this formula is first shown by Watanabe and Fukumizu (2009). Case 2: Fixed-mean Gaussian inference family Let G = (V,E) be a graph.", "startOffset": 61, "endOffset": 90}, {"referenceID": 0, "context": "Analysis of positive definiteness and convexity of BFE The Bethe free energy function is not necessarily convex though it is an approximation of the Gibbs free energy function, which is convex. Non-convexity of the Bethe free energy can lead to multiple fixed points. Pakzad and Anantharam (2002) and Heskes (2004) have derived sufficient conditions of the convexity and shown that the Bethe free energy is convex for trees and graphs with one cycle.", "startOffset": 0, "endOffset": 297}, {"referenceID": 0, "context": "Analysis of positive definiteness and convexity of BFE The Bethe free energy function is not necessarily convex though it is an approximation of the Gibbs free energy function, which is convex. Non-convexity of the Bethe free energy can lead to multiple fixed points. Pakzad and Anantharam (2002) and Heskes (2004) have derived sufficient conditions of the convexity and shown that the Bethe free energy is convex for trees and graphs with one cycle.", "startOffset": 0, "endOffset": 315}, {"referenceID": 0, "context": "For multinomial case, Pakzad and Anantharam (2002) have shown that the Bethe free energy function is convex if the hypergraph has at most one cycle.", "startOffset": 33, "endOffset": 51}, {"referenceID": 23, "context": "However, it requires optimizations with respect to f ; we can use standard numerical maximization techniques (Venkataraman, 2009).", "startOffset": 109, "endOffset": 129}, {"referenceID": 31, "context": "For binary pairwise case, we have a useful formulaW {i,j} i,j (\u03a8i,j) = tanh(|Jij |), where \u03a8i,j(xi, xj) \u221d eJijxixj+hixi+hjxj (Watanabe and Fukumizu, 2009).", "startOffset": 125, "endOffset": 154}, {"referenceID": 21, "context": "However, it requires optimizations with respect to f ; we can use standard numerical maximization techniques (Venkataraman, 2009). We leave developing efficient methods for computing the values for future works. For binary pairwise case, we have a useful formulaW {i,j} i,j (\u03a8i,j) = tanh(|Jij |), where \u03a8i,j(xi, xj) \u221d eJijxixj+hixi+hjxj (Watanabe and Fukumizu, 2009). Theorem 21 holds for an arbitrary LBP. However, for Gaussian cases we obtain W {i,j} i,j = 1, yielding no meaningful implications. Therefore, in the rest of this section, we focus on multinomial cases. 5.2.3 Comparison to Mooij\u2019s condition For multinomial models, there are several works that give sufficient conditions for the uniqueness property. Heskes (2004) analyzed the uniqueness problem by considering an equivalent min-max problem.", "startOffset": 110, "endOffset": 731}, {"referenceID": 3, "context": "Tatikonda and Jordan (2002) utilized the theory of Gibbs measure, and showed that the uniqueness of the Gibbs measure implies the convergence of LBP algorithm.", "startOffset": 14, "endOffset": 28}, {"referenceID": 12, "context": "(See numerical experiments in (Mooij and Kappen, 2007).", "startOffset": 30, "endOffset": 54}, {"referenceID": 10, "context": "(2006) and Mooij and Kappen (2007) derived sufficient conditions for the convergence by investigating conditions that make the LBP update a contraction; for pairwise case, their conditions are essentially the same.", "startOffset": 11, "endOffset": 35}, {"referenceID": 0, "context": "Another reason is that numerical experiments by Mooij and Kappen (2007) suggests that Mooij\u2019s condition is far superior to the condition of Heskes.", "startOffset": 0, "endOffset": 72}, {"referenceID": 0, "context": "Another reason is that numerical experiments by Mooij and Kappen (2007) suggests that Mooij\u2019s condition is far superior to the condition of Heskes. (See numerical experiments in (Mooij and Kappen, 2007).) The Mooij\u2019s condition is stated as follows. Theorem 22 (Mooij and Kappen (2007)) Define", "startOffset": 0, "endOffset": 285}, {"referenceID": 0, "context": "Analysis of stability of LBP In this section, we analyze relations between the local stability of LBP and the local structure of the Bethe free energy around an LBP fixed point. Since LBP is not the gradient descent of the Bethe free energy function, such a relation is not necessarily obvious. From the view point of the variational formulation, we hope to find the minima. In the celebrated paper by Yedidia et al. (2001), they empirically found that locally stable LBP fixed points 25", "startOffset": 0, "endOffset": 424}, {"referenceID": 0, "context": "Another case is i = j and \u03b1, \u03b2 \u2208 Ni (\u03b1 6= \u03b2). Then, the derivative is \u2202\u039b i \u2202\u03b7i \u2202(\u039b\u03b1)i \u2202\u03b8\u03b1:i \u2212 I = 0 because Varbi [\u03c6i] = Varb\u03b1 [\u03c6i] from Eq. (13). In other cases, the derivative is trivially zero. The relation j \u2208 N\u03b1 r i and \u03b2 \u2208 Nj r \u03b1 will be written as (\u03b2 \u2192 j) \u21c0 (\u03b1 \u2192 i) in Subsection 3.1. It is noteworthy that the elements of the linearization matrix is explicitly expressed by the fixed point beliefs. 6.2 Spectral conditions Let T be the LBP update map. A fixed point \u03bc\u2217 is called locally stable8 if LBP starting with a point sufficiently close to \u03bc\u2217 converges to \u03bc\u2217. To suppress oscillatory behaviors of LBP, damping of update T\u01eb := (1 \u2212 \u01eb)T + \u01ebI is sometimes useful, where 0 \u2264 \u01eb < 1 is a damping strength and I is the identity matrix. As we will summarize in the following theorem, the local stability is determined by the linearization T \u2032 at the fixed point. Since T \u2032 is nothing but M(u) at an LBP fixed point, Theorem 14 implies relations between the local stability and the Hessian of the Bethe free energy function. Theorem 24 Let \u03bc\u2217 be an LBP fixed point and assume that T \u2032(\u03bc\u2217) has no eigenvalues of unit modulus for simplicity. Then the following statements hold. 8. This property is often referred to as asymptotically stable Guckenheimer and Holmes (1990).", "startOffset": 0, "endOffset": 1275}, {"referenceID": 29, "context": "In a sequel paper (Watanabe and Fukumizu, 2011), we further exploit the connection between LBP, Bethe free energy and graph zeta function to analyze the LBP fixed point equation, focusing on binary pairwise models.", "startOffset": 18, "endOffset": 47}, {"referenceID": 11, "context": "Theorem 25 extends Theorem 2 of Mooij and Kappen (2005), which discusses only the case of binary pairwise models with vanishing local fields hi = 0 and the trivial fixed point (i.", "startOffset": 32, "endOffset": 56}, {"referenceID": 35, "context": "The connection between graph zeta, Bethe free energy and LBP can be extended to a more general class of free energies including fractional and tree-reweighted types (Wiegerinck and Heskes, 2003; Wainwright et al., 2003b).", "startOffset": 165, "endOffset": 220}, {"referenceID": 19, "context": "Theorem 27 (Hypergraph Hashimoto\u2019s theorem (Hashimoto, 1989; Storm, 2006)) Let \u03c7(H) := |V |+ |F | \u2212 | ~ E| be the Euler number of H.", "startOffset": 43, "endOffset": 73}, {"referenceID": 3, "context": "(30) are given by Kotani and Sunada (2000). For arbitrary hypergraph, \u03b6H(u) has a pole at u = 1 because det(I \u2212 M) = 0.", "startOffset": 18, "endOffset": 43}, {"referenceID": 2, "context": "The original version of this theorem is proved by Hashimoto (1989, 1990). Theorem 27 (Hypergraph Hashimoto\u2019s theorem (Hashimoto, 1989; Storm, 2006)) Let \u03c7(H) := |V |+ |F | \u2212 | ~ E| be the Euler number of H. lim u\u21920 \u03b6H(u) (1\u2212 u) = \u03c7(H)\u03ba(BH ), where \u03ba(BH) is the number of spanning trees of the bipartite graph BH . (BH is the bipartite graph representation of the hypergraph H.) Proof For a graph G = (V,E), Hashimoto (1989, 1990) proved that lim u\u21921 ZG(u) (1\u2212 u) |\u22121 = \u22122 (|E| \u2212 |V |)\u03ba(G), where \u03ba(G) is the number of spanning tree of G. A simple proof is given by Northshield (1998). Since there is a one-to-one correspondence between PH and PBH , we have \u03b6H(u) = ZBH ( \u221a u).", "startOffset": 50, "endOffset": 584}, {"referenceID": 18, "context": "Proof of Theorem 6 The following proof proceeds in an analogous manner with Theorem 3 in Stark and Terras (1996). First define a differential operator H := \u2211", "startOffset": 89, "endOffset": 113}], "year": 2011, "abstractText": "We propose a new approach to the theoretical analysis of Loopy Belief Propagation (LBP) and the Bethe free energy (BFE) by establishing a formula to connect LBP and BFE with a graph zeta function. The proposed approach is applicable to a wide class of models including multinomial and Gaussian types. The connection derives a number of new theoretical results on LBP and BFE. This paper focuses two of such topics. One is the analysis of the region where the Hessian of the Bethe free energy is positive definite, which derives the non-convexity of BFE for graphs with multiple cycles, and a condition of convexity on a restricted set. This analysis also gives a new condition for the uniqueness of the LBP fixed point. The other result is to clarify the relation between the local stability of a fixed point of LBP and local minima of the BFE, which implies, for example, that a locally stable fixed point of the Gaussian LBP is a local minimum of the Gaussian Bethe free energy.", "creator": "LaTeX with hyperref package"}}}