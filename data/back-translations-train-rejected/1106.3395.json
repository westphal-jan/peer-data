{"id": "1106.3395", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "17-Jun-2011", "title": "Decoding finger movements from ECoG signals using switching linear models", "abstract": "One of the major challenges of ECoG-based Brain-Machine Interfaces is the movement prediction of a human subject. Several methods exist to predict an arm 2-D trajectory. The fourth BCI Competition gives a dataset in which the aim is to predict individual finger movements (5-D trajectory). The difficulty lies in the fact that there is no simple relation between ECoG signals and finger movement. We propose in this paper to decode finger flexions using switching models. This method permits to simplify the system as it is now described as an ensemble of linear models depending on an internal state. We show that an interesting accuracy prediction can be obtained by such a model.", "histories": [["v1", "Fri, 17 Jun 2011 06:53:47 GMT  (2056kb)", "http://arxiv.org/abs/1106.3395v1", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["r\\'emi flamary", "alain rakotomamonjy"], "accepted": false, "id": "1106.3395"}, "pdf": {"name": "1106.3395.pdf", "metadata": {"source": "CRF", "title": "Decoding finger movements from ECoG signals using switching linear models", "authors": ["R\u00e9mi Flamary"], "emails": ["remi.flamary@insa-rouen.fr", "alain.rakoto@insa-rouen.fr"], "sections": [{"heading": null, "text": "ar Xiv: 110 6.33 95v1 [cs.LG] 1 7Ju n"}, {"heading": "1 Introduction", "text": "In fact, their only way of communicating with each other is by using their electroencephalogram signals. BrainComputer interfaces (BCI) research aims to develop systems that help disabled people communicate with machines. Non-invasive BCIs have recently shown a lot of interest in their simple protocol for implanting sensors on the scalp [1,2]. Moreover, although the electroencephalogram signals have been absorbed by the skull, these BCIs have shown great performance and they can be used by real amyotrophic sclerosis (ALS) patients."}, {"heading": "2 Dataset", "text": "For this thesis, the fourth set of data from the BCI Competition IV [12] was used. Subjects were 3 epileptic patients who placed platinum electrode grids on the surface of their brains. The number of electrodes varied between 48 and 64 depending on the subject and their position on the cortex was unknown. Electrocorticographic (ECoG) signals from the subject were recorded when scanned at 1 KHz using BCI2000 [13]. A bandpass filter from 0.15 to 200 Hz was applied to the ECoG signals. The subject's finger reflection was recorded at 25 Hz and recorded at 1 KHz. Due to the detection process, a delay appears between the finger movement and the measured ECoG signal. To correct this time delay, we apply the 37 ms delay proposed in the dataset description (12), the correction consists of 10 minutes of the ECoG signal per CI data set."}, {"heading": "3 Finger flexion decoding using switching linear models", "text": "In this section, we present the complete methodology that we have used to solve the problem of estimating finger bending from ECoG signals. In the first part, we propose an overview of the switching models, then we describe how we learn the function that estimates which finger is about to move, then we discuss the linear models associated with each moving finger, and finally we briefly describe how the complete method works in the decryption stage."}, {"heading": "3.1 Overview", "text": "In order to obtain an efficient prediction of finger diffraction, we hypothesized that for such movements, the brain can be understood as a switching model. This means that the measured ECoG signals and finger movements are inextricably linked to an internal state k. In our case, this state corresponds to each finger movement, k = 1 for the thumb to k = 5 for the baby finger or k = 6 for no finger movement. In this case, we used mutually exclusive states, because the experimental setup under consideration specifies that only one or no finger moves. Figure 1 gives the picture of our decoding scheme of finger movements. Essentially, the idea is that based on some features extracted from the ECoG signals, the internal hidden state triggering the switching finger models can be estimated. This state then allows the system to select a suitable model Hk (x) to estimate all finger diffractions, where x = a feature extracted from the ECoG signals to form the vector. For this complete function, we must delegitimize the \u00b7 G (to estimate the function)."}, {"heading": "3.2 Moving finger estimation", "text": "The way in which we move is shaped by the way in which we move. (...) The way in which we move is shaped by the way in which we move. (...) The way in which we move is shaped by the way in which we move, by the way in which we move. (...) The way in which we move is influenced by the way in which we move. (...) The way in which we move is influenced by the way in which we move, by the way in which we move. (...) The way in which we move is influenced by the way in which we move, by the way in which we move. \"(...) The way in which we move is what we move.\" (...)"}, {"heading": "3.3 Learning finger flexion models", "text": "Here we will discuss the model that relates the ECoG data and finger movements for all possible values of k. In other words, assuming that a given finger, say the index, will move (as predicted by our finger motion estimation), we have built an estimate of all finger movements. Therefore, for each k we will learn a linear model gk, j (x) = x-Th (k) j with j = 1, \u00b7 \u00b7, 5, x-a feature vector and h (k) j a weight vector indexed by the moving finger k and the finger j whose flexions are to be estimated. We have chosen a linear model as they have been shown to provide good performance for decoding movements from ECoG [10,9].At a time t in which the feature vector xt was reached by the same line as Pistohl et al al al al al al al al al al al al al al. [10] In fact, we use filtered time samples."}, {"heading": "3.4 Decoding finger movement", "text": "When all models are learned, the decoding scheme given in Figure 1 results. Given the two character vectors xt and x-t at a time t, the estimate of finger position is obtained as follows: y = x-x-Tt H-k with k = argmax k xttck (4), where y-t is a row vector containing the estimated finger movement, k-t is the finger to move, x-t is the extracted character at a time t, and H-k-t is the estimated linear model for the state k."}, {"heading": "4 Results", "text": "In this section, we present the performance of our switching model decoder. First, we explain how all the parameters of the models were set, then we present some results that help us understand the contribution of the different parts of our models. Finally, we evaluate our approach and compare ourselves with the results of the BCI competition."}, {"heading": "4.1 Parameter selection", "text": "With this method, we select the number of selected channels, the time delay used for feature extraction, and the regularization term of Equivalent (2).Likewise, all parameters (\u03c4, the number of selected channels, and ecology) required for estimating Hk have been adjusted to optimize the model performance of the validation sets. In this part of the model selection, the size of the training and validation sets vary depending on k and they are summarized in Table 1 for topic 1."}, {"heading": "4.2 Evaluating of the linear models Hk", "text": "Models Hk correspond to the linear regressions between the ECoG characteristics and the bends of the fingers when the k-th finger moves. To evaluate these models, the signals used are extracted in the same way as the learning sets yk and X-k (see Figure 4), but assuming that the true segmentation of finger movements is known. To evaluate these models, we measure the cross-correlation between the true yk and the estimated finger diffraction X-kh-k only when the finger k moves. The correlations are in Table 2. We observe that by means of linear regression between the ECoG signals and the finger diffractions, we achieve a correlation of 0.46 (averaged over fingers and subjects). These results correspond to those obtained for predicting the armband (Schalk [9] reached 0.5 and Pistohl [10] reached 0.43)."}, {"heading": "4.3 Evaluating the switching decoder method", "text": "To contribute to the efficiency of the switching model decoder and each block of the decoder we hidden three different results: First, for a particular finger, we calculate the estimated finger reflection using a linear model that was learned on all samples (including those in which the finger does not move), then we estimated the finger reflections using a single linear model while we know the exact sequence of the hidden states, and finally we use our switching decoder with the estimated hidden states. To make a baseline comparison with our switching models decoder, we have estimated the finger reflections using a single linear model that was trained with all time samples, the obtained correlations are in Table 3a and the regression results can be seen on the upper plots of Figure 5. We can see that the correlation is rather low than the fact that without switching the models flexibility is achieved."}, {"heading": "4.4 Discussion and future works", "text": "The results presented in the previous section correspond to the method used for the BCI Competition.We first note that the best performance received by Liang et al. [15] gives a correlation of about 0.46. Their method takes into account amplitude modulation over time to cope with the abrupt change in finger diffraction amplitude over time. Such an approach is similar to ours in that they try to distinguish situations in which fingers move or not. Then we believe that our approach can be improved in several ways.In fact, we opt for linear models depending on the internal states, but [10] suggested using a Kalman filter to decipher motion. This approach can be applied to the use of switch scale filters in the switch model decoder. In addition, our approach to estimating the sequence of hidden states can be greatly improved. Liang [15] suggested using Power Spectral Densities of the ECoG as characteristics, and we believe that these features can be added and used in the sequence."}, {"heading": "5 Conclusions", "text": "In this article, we present a method for decoding finger reflections from ECoG signals, based on switching linear models. Our approach was tested on BCI Competition IV dataset 4 and came second in the competition. Results show that the switch model approach delivers a better result than the use of a unique model. In addition, an accurate finger reflection assessment can be achieved when using an exact sequence of hidden states that shows the interest of the switch models. In future work, we plan to improve the result of the switch model decoders through two different approaches: on the one hand, we can use more general models as linear ones for motion forecasting (switching calendar filters, non-linear regression), on the other hand, we can improve the sequence labeling over time through a new approach and by using new features derived from the ECoG signals."}], "references": [{"title": "Control of a two-dimensional movement signal by a noninvasive brain-computer interface in humans", "author": ["J.R. Wolpaw", "D.J. McFarland"], "venue": "Proceedings of the National Academy of Sciences of the United States of America 101(51)", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2004}, {"title": "The BCI competition 2003: progress and perspectives in detection and discrimination of EEG single trials", "author": ["B. Blankertz", "K.R. Muller", "G. Curio", "T. Vaughan", "G. Schalk", "J. Wolpaw", "A. Schlogl", "C. Neuper", "G. Pfurtscheller", "T. Hinterberger", "M. Schroder", "N. Birbaumer"], "venue": "IEEE Transactions on Biomedical Engineering 51(6)", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2004}, {"title": "A p300-based brain-computer interface: Initial tests by als patients", "author": ["E. Sellers", "E. Donchin"], "venue": "Clinical Neurophysiology 117(3)", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2006}, {"title": "A braincomputer interface for people with amyotrophic lateral sclerosis", "author": ["F. Nijboer", "E. Sellers", "J. Mellinger", "M. Jordan", "T. Matuz", "A. Furdea", "U. Mochty", "D. Krusienski", "T. Vaughan", "J. Wolpaw", "N. Birbaumer", "A. Kubler"], "venue": "Clinical Neurophysiology 119(8)", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2008}, {"title": "A brain-computer interface using electrocorticographic signals in humans", "author": ["G.S.E. Leuthardt", "J. Wolpaw", "J. Ojemann", "D. Moran"], "venue": "Journal of Neural Engineering 1", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2004}, {"title": "Classifying eeg and ecog signals without subject training for fast bci implementation: Comparison of non-paralysed and completely paralysed subjects", "author": ["N. Hill", "T. Lal", "M. Schroeder", "T. Hinterberger", "B. Wilhem", "F. Nijboer", "U. Mochty", "G. Widman", "C. Elger", "B. Scholkoepf", "A. Kuebler", "N. Birbaumer"], "venue": "IEEE Transactions on Neural Systems and Rehabilitation Engineering 14(2)", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2006}, {"title": "Classifying Event-Related Desynchronization in EEG, ECoG and MEG signals", "author": ["N. Hill", "T. Lal", "M. Tangermann", "T. Hinterberger", "G. Widman", "Elger", "B. Scholkoepf", "N. Birbaumer"], "venue": "Toward Brain-Computer Interfacing. MIT Press", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2007}, {"title": "Generalized features for electrocorticographic bci", "author": ["P. Shenoy", "K. Miller", "J. Ojemann", "R. Rao"], "venue": "IEEE Trans. On Biomedical Engineering 55", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2008}, {"title": "Decoding twodimensional movement trajectories using electrocorticographic signals in humans", "author": ["G. Schalk", "J. Kubanek", "K.J. Miller", "N.R. Anderson", "E.C. Leuthardt", "J.G. Ojemann", "D. Limbrick", "D. Moran", "L.A. Gerhardt", "J.R. Wolpaw"], "venue": "Journal of Neural Engineering 4(3)", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2007}, {"title": "Prediction of arm movement trajectories from ecog-recordings in humans", "author": ["T. Pistohl", "T. Ball", "A. Schulze-Bonhage", "A. Aertsen", "C. Mehring"], "venue": "Journal of Neuroscience Methods 167(1)", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2008}, {"title": "Independently coupled hmm switching classifier for a bimodel brainmachine interface", "author": ["S. Darmanjian", "S.P. Kim", "M.C. Nechyba", "J. Principe", "J. Wessberg", "M.A.L. Nicolelis"], "venue": "Machine Learning for Signal Processing, 2006. Proceedings of the 2006 16th IEEE Signal Processing Society Workshop on.", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2006}, {"title": "Prediction of finger flexion: 4th brain-computer interface data competition", "author": ["K.J. Miller", "G.Shalk"], "venue": "BCI Competition IV", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2008}, {"title": "Bci2000: a general-purpose brain-computer interface (bci) system", "author": ["G. Schalk", "D. McFarland", "T. Hinterberger", "N. Birbaumer", "J. Wolpaw"], "venue": "Biomedical Engineering, IEEE Transactions on 51(6)", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2004}, {"title": "Algorithms for multiple basis pursuit denoising", "author": ["A. Rakotomamonjy"], "venue": "Workshop on Sparse Approximation.", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2009}, {"title": "Decoding finger flexion using amplitude modulation from band-specific ecog", "author": ["N. Liang", "L. Bougrain"], "venue": "European Symposium on Artificial Neural Networks ESANN.", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2009}, {"title": "Conditional random fields: Probabilistic models for segmenting and labeling sequence data", "author": ["J. Lafferty", "A.McCallum", "F. Pereira"], "venue": "Proc. 18th International Conf. on Machine Learning.", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2001}, {"title": "Sequence labelling svms trained in one pass", "author": ["A. Bordes", "N. Usunier", "L. Bottou"], "venue": "In Daelemans, W., Goethals, B., Morik, K., eds.: Machine Learning and Knowledge Discovery in Databases: ECML PKDD 2008. Lecture Notes in Computer Science, LNCS 5211, Springer", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2008}], "referenceMentions": [{"referenceID": 0, "context": "Non-invasive BCIs have recently received a lot of interest because of their easy protocol for sensors implantation on the scalp surface [1,2].", "startOffset": 136, "endOffset": 141}, {"referenceID": 1, "context": "Non-invasive BCIs have recently received a lot of interest because of their easy protocol for sensors implantation on the scalp surface [1,2].", "startOffset": 136, "endOffset": 141}, {"referenceID": 2, "context": "Furthermore, although the electroencephalogram signals have been recorded through the skull, those BCI have shown great performance capabilities, and can be used by real Amyotrophic Lateral Sclerosis (ALS) patients [3,4].", "startOffset": 215, "endOffset": 220}, {"referenceID": 3, "context": "Furthermore, although the electroencephalogram signals have been recorded through the skull, those BCI have shown great performance capabilities, and can be used by real Amyotrophic Lateral Sclerosis (ALS) patients [3,4].", "startOffset": 215, "endOffset": 220}, {"referenceID": 4, "context": "Feasibility of invasive-based BCI have been proven by several recent papers [5,6,7,8].", "startOffset": 76, "endOffset": 85}, {"referenceID": 5, "context": "Feasibility of invasive-based BCI have been proven by several recent papers [5,6,7,8].", "startOffset": 76, "endOffset": 85}, {"referenceID": 6, "context": "Feasibility of invasive-based BCI have been proven by several recent papers [5,6,7,8].", "startOffset": 76, "endOffset": 85}, {"referenceID": 7, "context": "Feasibility of invasive-based BCI have been proven by several recent papers [5,6,7,8].", "startOffset": 76, "endOffset": 85}, {"referenceID": 8, "context": "[9] which has proven that ECoG recordings can lead to multiple-degree BCI control.", "startOffset": 0, "endOffset": 3}, {"referenceID": 9, "context": "[10], these two works have considered the problem of predicting arm movements from ECoG signals.", "startOffset": 0, "endOffset": 4}, {"referenceID": 10, "context": "While such an idea of switching models have already been successfully used for arm movement prediction on monkeys from micro-electrode array measures [11], here, we develop a specific approach adapted to finger movements.", "startOffset": 150, "endOffset": 154}, {"referenceID": 11, "context": "The global method has been tested on the 4th Dataset of the BCI Competition IV[12].", "startOffset": 78, "endOffset": 82}, {"referenceID": 11, "context": "For this work, the fourth dataset from the BCI Competition IV [12] was used.", "startOffset": 62, "endOffset": 66}, {"referenceID": 12, "context": "Electrocorticographic (ECoG) signals of the subject were recorded at a 1KHz sampling using BCI2000 [13].", "startOffset": 99, "endOffset": 103}, {"referenceID": 11, "context": "To correct this time-lag we apply the 37 ms delay proposed in the dataset description [12] to the ECoG signals.", "startOffset": 86, "endOffset": 90}, {"referenceID": 11, "context": "Note that the fourth finger was not used for evaluation in the competition since its movements were proven to be correlated with the other one movements [12].", "startOffset": 153, "endOffset": 157}, {"referenceID": 13, "context": "Problem (2) has been solved using the block-coordinate descent algorithm proposed by Rakotomamonjy [14].", "startOffset": 99, "endOffset": 103}, {"referenceID": 9, "context": "We have chosen a linear model since they have been shown to provide good performances for decoding movements from ECoG [10,9].", "startOffset": 119, "endOffset": 125}, {"referenceID": 8, "context": "We have chosen a linear model since they have been shown to provide good performances for decoding movements from ECoG [10,9].", "startOffset": 119, "endOffset": 125}, {"referenceID": 9, "context": "[10].", "startOffset": 0, "endOffset": 4}, {"referenceID": 8, "context": "This results correspond to those obtained for the arm trajectory prediction (Schalk [9] obtained 0.", "startOffset": 84, "endOffset": 87}, {"referenceID": 9, "context": "5 and Pistohl [10] obtained 0.", "startOffset": 14, "endOffset": 18}, {"referenceID": 14, "context": "[15] gives a correlation of about 0.", "startOffset": 0, "endOffset": 4}, {"referenceID": 9, "context": "Indeed, we choose to use linear models depending on the internal states, but [10] proposed to use a kalman filter for the decoding of movement.", "startOffset": 77, "endOffset": 81}, {"referenceID": 14, "context": "Liang [15] proposed to use Power Spectral Densities of the ECoG channel as features and we believe that these features may be added and used in the sequence labeling.", "startOffset": 6, "endOffset": 10}, {"referenceID": 10, "context": "In our method the features are low-pass filtered in order to increase recognition performance, but other sequence labeling methods like HMM [11] have been used in BCI.", "startOffset": 140, "endOffset": 144}, {"referenceID": 15, "context": "Other sequence labeling methods like Conditional Random Fields [16] known to outperform HMM in some case or Sequence SVM [17] may be used to get a better sequence of hidden states.", "startOffset": 63, "endOffset": 67}, {"referenceID": 16, "context": "Other sequence labeling methods like Conditional Random Fields [16] known to outperform HMM in some case or Sequence SVM [17] may be used to get a better sequence of hidden states.", "startOffset": 121, "endOffset": 125}], "year": 2011, "abstractText": "One of the major challenges of ECoG-based Brain-Machine Interfaces is the movement prediction of a human subject. Several methods exist to predict an arm 2-D trajectory. The fourth BCI Competition gives a dataset in which the aim is to predict individual finger movements (5-D trajectory). The difficulty lies in the fact that there is no simple relation between ECoG signals and finger movement. We propose in this paper to decode finger flexions using switching models. This method permits to simplify the system as it is now described as an ensemble of linear models depending on an internal state. We show that an interesting accuracy prediction can be obtained by such a model.", "creator": "LaTeX with hyperref package"}}}