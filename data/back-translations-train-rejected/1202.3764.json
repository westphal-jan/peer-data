{"id": "1202.3764", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "14-Feb-2012", "title": "Adjustment Criteria in Causal Diagrams: An Algorithmic Perspective", "abstract": "Identifying and controlling bias is a key problem in empirical sciences. Causal diagram theory provides graphical criteria for deciding whether and how causal effects can be identified from observed (nonexperimental) data by covariate adjustment. Here we prove equivalences between existing as well as new criteria for adjustment and we provide a new simplified but still equivalent notion of d-separation. These lead to efficient algorithms for two important tasks in causal diagram analysis: (1) listing minimal covariate adjustments (with polynomial delay); and (2) identifying the subdiagram involved in biasing paths (in linear time). Our results improve upon existing exponential-time solutions for these problems, enabling users to assess the effects of covariate adjustment on diagrams with tens to hundreds of variables interactively in real time.", "histories": [["v1", "Tue, 14 Feb 2012 16:41:17 GMT  (181kb)", "http://arxiv.org/abs/1202.3764v1", null]], "reviews": [], "SUBJECTS": "cs.AI", "authors": ["johannes textor", "maciej liskiewicz"], "accepted": false, "id": "1202.3764"}, "pdf": {"name": "1202.3764.pdf", "metadata": {"source": "CRF", "title": "Adjustment Criteria in Causal Diagrams: An Algorithmic Perspective", "authors": ["Johannes Textor"], "emails": ["textor@tcs.uni-luebeck.de", "liskiewi@tcs.uni-luebeck.de"], "sections": [{"heading": null, "text": "The theory of causal diagrams provides graphical criteria to determine whether and how causal effects from observed (non-experimental) data can be identified by covariate fit. At this point, we demonstrate equivalences between existing and new adaptation criteria and provide a new simplified but still equivalent notion of dseparation, leading to efficient algorithms for two important tasks in causal diagram analysis: (1) listing minimal covariate adjustments (with polynomial delay) and (2) identifying the subdiagram involved in distortion paths (in linear time). Our results improve existing exponential time solutions to these problems, which allow users to assess the effects of covariant adjustments on diagrams with dozens to hundreds of variables interactively in real time."}, {"heading": "1 Introduction and Motivation", "text": "A notorious problem affecting the calculation of probability in causal structures is bias. For example, we could investigate whether regular coffee drinking (C) increases the risk of having a heart attack (H). Such a study could be compromised by a disregarded genetic predisposition (U) that causes an increased preference for coffee drinking, but also for smoking (S), which increases the risk of having a heart attack. These causal influences suggest that an observed relationship between C and H is counteracted by U, indicating the correctness of the causal relationships between the variables of interest [9]. The paths from U to C and H in this diagram suggest that a constant relationship between C and H can be observed."}, {"heading": "2 Contributions", "text": "This is because most criteria are given as path properties, and even diagrams with only dozens of variables and edges can contain millions of paths. Analyzing such diagrams lends itself well to automation by a computer program. In 2010, at least three programs for analyzing causal diagrams were introduced: Knueppel's DAG program [6]; Breitling's dagR [3]; and Kyono's Commentator [7]. But even these programs still have their problems with large diagrams [3], in which diagrams with dozens of variables are intractable. We argue that the root of these problems is not that existing criteria are well suited to algorithmic implementation. For example, the aforementioned programs contain functions for listing all minimal adjustments."}, {"heading": "3 Preliminaries", "text": "We use the following terms from the causal diagram literature, most of which are identical with their standard graph theory counterparts. However, we would like to point out to readers who are not familiar with causal diagrams that the notion of a path in a causal diagram is actually a bit different from the usual notion of a path in a directed graph (here called a directed or causal path). A graph is a tuple G = (V, E) of branches (nodes) V and directed edges E (u, v), v V, v V, u V = v. \"Generally, a mixed graph is a tuple G = (V) of branches V and directed or undirected edges E (V)."}, {"heading": "4 Criteria for Adjustment and Biasing Paths", "text": "This section is divided into two parts: In the first part, we show that the solid but incomplete backdoor criterion for recognizability of the causal effect corresponds to the slightly more complex but solid and complete criterion recently proposed by Shpitser et al. [12], taking into account only minimal adjustments, and these results apply to all directed acyclic graphs with the following property: Definition 4.1 (X-Loop-Freeness). A DAG G = (V, E) is X-V-free in relation to the vertex if it does not contain a directed path \u03c0 = v1,..., vk, with k \u2265 3, v1, vk-X and v2,..., vk \u2212 1 6-X.G is always X-loop-free if X is a singleton theorem. For an example, DAG G, which is not X-loop-free, see Figure 2."}, {"heading": "4.1 Equivalence of Adjustment Criteria in", "text": "In fact, it is so that it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, and in which it is about a way, and in which it is about a way, and in which it is about a way, and in which it is about a way, and in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, in which it is about a way, and in which it is about a way, and in which it is about a way, and in which it is about a way, and in which it is about a way, and in which it is about a way, and in which it is about a way, and in which it is about a way and in which it is about a way, and in which it is about a way and in which it is about a way, and in which it is about a way, and in which it is about a way and in which it is about a way, and in which it is about a way and in which it is a way and in which it is a way and in which it is a way and in which it is a way, and in which it is a way and in which it is a way and in which it is a way and in which it is a way and in which it is a way, and in which it is a way and in which it is a way and in which it is a way and in which it is a way and in which it is a way, and in which it is a way and in which it is a way and in which it is a way and in which it is a way and in which it is a way and in which it is a way and in which it is a way and in which it is a way in which it is a way and it is a way and in which it is a way and in which it is a way in which it is"}, {"heading": "5 Algorithmic Applications", "text": "The results of the previous section have brought the criteria for covariate fit in causal diagrams closer to standard graph theory, which we can now use to obtain efficient algorithms for two important problems related to causal diagram analysis."}, {"heading": "5.1 Enumerating Minimal Adjustment Sets", "text": "It is not only a problem that we can solve, but also a problem that we can solve by listing all causal effects from X to Y. It shows that this problem can be reduced in linear time in the following way: Problem 5.2 (list of minimum adjustments), we can solve the above problem by listing all causal effects from X to Y. It shows that this problem can be reduced in linear time to the following: Problem 5.2 (list of minimum adjustments), we can list the above problem instead all minimum D separators from G to Y."}, {"heading": "5.2 Identifying Bias in Insufficiently Adjusted Diagrams", "text": "The question is whether we are able to create a complete list of paths that quickly turn out to be the number of variables that in such cases produce a compressed representation of the paths themselves. However, the most natural compressed representation of a list of paths in a graph is a complete list of paths that quickly become prohibitive as the number of variables increases."}, {"heading": "6 Conclusion", "text": "These algorithms form the basis of our online tool DAGitty (dagitty.net), which provides a graphical user interface for analyzing causal diagrams [14]. With the new algorithms, DAGitty is able to analyze causal diagrams in real time with dozens of variables, including some that were insoluble from previous programs. DAGitty's open source code can be used as an additional reference to the algorithms presented here. Future work could develop similar algorithms for other customization methods such as door-to-door adjustment [9]."}], "references": [{"title": "An algorithm for finding minimum d-separating sets in belief networks", "author": ["S. Acid", "L.M.D. Campos"], "venue": "Proceedings of UAI 1996, pages 3\u201310,", "citeRegEx": "1", "shortCiteRegEx": null, "year": 1996}, {"title": "Limitations of the application of fourfold tables to hospital data", "author": ["J. Berkson"], "venue": "Biometrics Bulletin, 2(3):47\u2013 53,", "citeRegEx": "2", "shortCiteRegEx": null, "year": 1946}, {"title": "dagR: A suite of R functions for directed acyclic graphs", "author": ["L. Breitling"], "venue": "Epidemiology, 21(1):586\u2013587,", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2010}, {"title": "Finding common ancestors and disjoint paths in DAGs", "author": ["D. Eppstein"], "venue": "Technical Report 95-52, Univ. of California, Irvine,", "citeRegEx": "4", "shortCiteRegEx": null, "year": 1995}, {"title": "Finding the k shortest paths", "author": ["D. Eppstein"], "venue": "SIAM J. Comput., 28(2):652\u2013673,", "citeRegEx": "5", "shortCiteRegEx": null, "year": 1998}, {"title": "DAG program: identifying minimal sufficient adjustment sets", "author": ["S. Kn\u00fcppel", "A. Stang"], "venue": "Epidemiology, 21(1):159,", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2010}, {"title": "Commentator: A front-end userinterface module for graphical and structural equation modeling", "author": ["T.M. Kyono"], "venue": "Technical Report R-364, University of California, Los Angeles,", "citeRegEx": "7", "shortCiteRegEx": null, "year": 1998}, {"title": "Independence properties of directed markov fields", "author": ["S.L. Lauritzen"], "venue": null, "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1990}, {"title": "Causality", "author": ["J. Pearl"], "venue": "Cambridge U. Press,", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2000}, {"title": "Modern Epidemiology", "author": ["K.J. Rothman", "S. Greenland", "T.L. Lash"], "venue": "Wolters Kluwer,", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2008}, {"title": "Bayes-ball: The rational pastime", "author": ["R.D. Shachter"], "venue": "Proceedings of UAI 1998, pages 480\u2013487,", "citeRegEx": "11", "shortCiteRegEx": null, "year": 1998}, {"title": "On the validity of covariate adjustment for estimating causal effects", "author": ["I. Shpitser", "T. VanderWeele", "J. Robins"], "venue": "Proceedings of UAI 2010, pages 527\u2013536. AUAI Press,", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2010}, {"title": "Space-optimal, backtracking algorithms to list the minimal vertex separators of a graph", "author": ["K. Takata"], "venue": "Discrete Applied Mathematics, 158:1660\u20131667,", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2010}, {"title": "DAGitty: A graphical tool for analyzing causal diagrams", "author": ["J. Textor", "J. Hardt", "S. Kn\u00fcppel"], "venue": "Epidemiology,", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2011}, {"title": "Finding minimal dseparators", "author": ["J. Tian", "A. Paz", "J. Pearl"], "venue": "Technical Report R-254, University of California, Los Angeles,", "citeRegEx": "15", "shortCiteRegEx": null, "year": 1998}], "referenceMentions": [{"referenceID": 8, "context": "These causal influences can be modeled as a causal diagram G = C \u2190 U \u2192 S \u2192 H, whose arrows indicate the directionality of causal relationships between the variables of interest [9].", "startOffset": 177, "endOffset": 180}, {"referenceID": 1, "context": "Because H is a common descendant of R and S, this opens a biasing path between R and S, which leads to so-called Berksonian bias [2] \u2013 hence, our \u201cinteresting\u201d observation is merely an artifact.", "startOffset": 129, "endOffset": 132}, {"referenceID": 9, "context": "In general, any type of bias that can be expressed in the formal framework of causal diagrams corresponds to a certain type of path, called a biasing path [10].", "startOffset": 155, "endOffset": 159}, {"referenceID": 8, "context": "Within the mathematical theory behind causal diagrams [9], graphical identification criteria have been derived that tell us whether \u2013 and how \u2013 we may dissect the causal effect from bias by covariate adjustment, provided that we know the causal relationships between exposure, outcome, and covariates in our study.", "startOffset": 54, "endOffset": 57}, {"referenceID": 5, "context": "In 2010, at least three programs were presented for analyzing causal diagrams: The DAG program by Kn\u00fcppel [6]; dagR by Breitling [3]; and Com-", "startOffset": 106, "endOffset": 109}, {"referenceID": 2, "context": "In 2010, at least three programs were presented for analyzing causal diagrams: The DAG program by Kn\u00fcppel [6]; dagR by Breitling [3]; and Com-", "startOffset": 129, "endOffset": 132}, {"referenceID": 6, "context": "mentator by Kyono [7].", "startOffset": 18, "endOffset": 21}, {"referenceID": 2, "context": "However, even these programs still have their problems with large diagrams [3], to the extent that diagrams with tens of variables can be intractable.", "startOffset": 75, "endOffset": 78}, {"referenceID": 11, "context": "[12].", "startOffset": 0, "endOffset": 4}, {"referenceID": 8, "context": "We prove that when restricting our attention to minimal adjustments, this is equivalent to Pearl\u2019s sufficient, but not necessary, back-door criterion [9].", "startOffset": 150, "endOffset": 153}, {"referenceID": 7, "context": "This way we also obtain a complete criterion for minimal covariate adjustment in terms of the moral graph [8].", "startOffset": 106, "endOffset": 109}, {"referenceID": 0, "context": "[1, 15]).", "startOffset": 0, "endOffset": 7}, {"referenceID": 14, "context": "[1, 15]).", "startOffset": 0, "endOffset": 7}, {"referenceID": 8, "context": "1 (d-Connectivity and d-Separation [9]).", "startOffset": 35, "endOffset": 38}, {"referenceID": 7, "context": "2 (Moral Graph [8]).", "startOffset": 15, "endOffset": 18}, {"referenceID": 8, "context": "To define the causal effect of X on Y we use Pearl\u2019s do(x) notation [9], which intuitively corresponds to an idealized experiment in which the variables inX can be set to given values; in the causal diagram, this would correspond to removing all edges entering X, disconnecting directed influences stemming from the parent variables of X.", "startOffset": 68, "endOffset": 71}, {"referenceID": 8, "context": "4 (Adjustment [9]).", "startOffset": 14, "endOffset": 17}, {"referenceID": 11, "context": "[12] if we consider only minimal adjustments.", "startOffset": 0, "endOffset": 4}, {"referenceID": 11, "context": "[12] but there is no set Z \u2032 fulfilling the back-door criterion by Pearl [9].", "startOffset": 0, "endOffset": 4}, {"referenceID": 8, "context": "[12] but there is no set Z \u2032 fulfilling the back-door criterion by Pearl [9].", "startOffset": 73, "endOffset": 76}, {"referenceID": 11, "context": "[12], and is the first complete criterion for covariate adjustment.", "startOffset": 0, "endOffset": 4}, {"referenceID": 11, "context": "2 (Adjustment Criterion [12]).", "startOffset": 24, "endOffset": 28}, {"referenceID": 8, "context": "\u2022 (Back-door Criterion [9]) Z satisfies the back-door criterion relative to (X,Y ) if (i) no element in Z is a descendant of X and (ii) Z d-separates X and Y in G \u0304 X .", "startOffset": 23, "endOffset": 26}, {"referenceID": 11, "context": "[12] write instead \u201c.", "startOffset": 0, "endOffset": 4}, {"referenceID": 7, "context": "[8] and has been used e.", "startOffset": 0, "endOffset": 3}, {"referenceID": 6, "context": "by Kyono [7].", "startOffset": 9, "endOffset": 12}, {"referenceID": 11, "context": "5 ([12], Lemma 1).", "startOffset": 3, "endOffset": 7}, {"referenceID": 0, "context": "Algorithms for similar problems were presented by Acid and Campos [1] and Tian et al.", "startOffset": 66, "endOffset": 69}, {"referenceID": 14, "context": "[15].", "startOffset": 0, "endOffset": 4}, {"referenceID": 12, "context": "For more information on polynomial delay algorithms, we refer to the nice introduction in Takata\u2019s paper [13].", "startOffset": 105, "endOffset": 109}, {"referenceID": 12, "context": "Applying the moral graph criterion, this boils down to a simple adaptation of an algorithm by Takata [13] that lists all minimal X-Y -separators of an undirected graph with polynomial delay O(nm) and total space requirement O(n), where m is the number of", "startOffset": 101, "endOffset": 105}, {"referenceID": 12, "context": "The space requirement is O(n), which is asymptotically optimal [13].", "startOffset": 63, "endOffset": 67}, {"referenceID": 10, "context": "Second, one might consider using Shachter\u2019s \u201cBayes-Ball\u201d algorithm [11] that performs an extended depth-first search to find out if X and Y are d-separated by Z.", "startOffset": 67, "endOffset": 71}, {"referenceID": 3, "context": "To this end, we generalize an algorithm presented by Eppstein [4, 5] to find disjoint directed paths from common ancestors to vertex sets X and Y in DAGs, which corresponds to the special case Z = \u2205 of our problem.", "startOffset": 62, "endOffset": 68}, {"referenceID": 4, "context": "To this end, we generalize an algorithm presented by Eppstein [4, 5] to find disjoint directed paths from common ancestors to vertex sets X and Y in DAGs, which corresponds to the special case Z = \u2205 of our problem.", "startOffset": 62, "endOffset": 68}, {"referenceID": 3, "context": "Then we compute the bottleneck numbers B(v) through a trivial extension of the O(|V |+ |E|) algorithm by Eppstein [4].", "startOffset": 114, "endOffset": 117}, {"referenceID": 13, "context": "net), which provides a graphical user interface for analyzing causal diagrams [14].", "startOffset": 78, "endOffset": 82}, {"referenceID": 8, "context": "Future work could develop similar algorithms for other adjustment methods like front-door adjustment [9].", "startOffset": 101, "endOffset": 104}], "year": 2011, "abstractText": "Identifying and controlling bias is a key problem in empirical sciences. Causal diagram theory provides graphical criteria for deciding whether and how causal effects can be identified from observed (nonexperimental) data by covariate adjustment. Here we prove equivalences between existing as well as new criteria for adjustment and we provide a new simplified but still equivalent notion of dseparation. These lead to efficient algorithms for two important tasks in causal diagram analysis: (1) listing minimal covariate adjustments (with polynomial delay); and (2) identifying the subdiagram involved in biasing paths (in linear time). Our results improve upon existing exponential-time solutions for these problems, enabling users to assess the effects of covariate adjustment on diagrams with tens to hundreds of variables interactively in real time.", "creator": "TeX"}}}