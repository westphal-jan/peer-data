{"id": "1205.2624", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "9-May-2012", "title": "Convexifying the Bethe Free Energy", "abstract": "The introduction of loopy belief propagation (LBP) revitalized the application of graphical models in many domains. Many recent works present improvements on the basic LBP algorithm in an attempt to overcome convergence and local optima problems. Notable among these are convexified free energy approximations that lead to inference procedures with provable convergence and quality properties. However, empirically LBP still outperforms most of its convex variants in a variety of settings, as we also demonstrate here. Motivated by this fact we seek convexified free energies that directly approximate the Bethe free energy. We show that the proposed approximations compare favorably with state-of-the art convex free energy approximations.", "histories": [["v1", "Wed, 9 May 2012 17:23:13 GMT  (1289kb)", "http://arxiv.org/abs/1205.2624v1", "Appears in Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence (UAI2009)"]], "COMMENTS": "Appears in Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence (UAI2009)", "reviews": [], "SUBJECTS": "cs.AI cs.LG", "authors": ["ofer meshi", "ariel jaimovich", "amir globerson", "nir friedman"], "accepted": false, "id": "1205.2624"}, "pdf": {"name": "1205.2624.pdf", "metadata": {"source": "CRF", "title": "Convexifying the Bethe Free Energy", "authors": ["Ofer Meshi", "Ariel Jaimovich", "Amir Globerson", "Nir Friedman"], "emails": ["meshi@cs.huji.ac.il", "arielj@cs.huji.ac.il", "gamir@cs.huji.ac.il", "nir@cs.huji.ac.il"], "sections": [{"heading": "1 Introduction", "text": "The calculation of probabilities and marginal probabilities is a critical sub-task in applications of graphical models. Since the calculation of the exact answers is often unfeasible, there is a growing need for approximate conclusions. An important class of approximation methods are variation methods [7], which represent conclusions regarding the minimization of free energy. In the last decade, these lines of work have been proven empirically successful by the formulation of loopy beliefs regarding the optimization of free energy and have been used in a variety of applications. [10] The pioneering work of Yedidia et al. [20] These lines were formulated by the formulation of loopic beliefs regarding the optimization of free energy, an approximate free energy functionality."}, {"heading": "2 Free Energy Approximations", "text": "Probabilistic models provide a concise language for determining complex common probabilities across many variables by factoring the distribution into a product using local potentials. Let's call x-Xn a vector of n discrete random variables (1), focusing on subsets of parameters (or factors) in which the common probability is given by: p (x; \u03b8) = 1Z (0) exp {0) exp {0) empirical distribution of variables and factors (xi) (1) corresponding to the subset of parameters (or factors), and Z (\u03b8) is the partition function used to normalize distribution. We call marginal distributions of variables and factors by \u00b5\u03b1 (x\u03b1) or the vector of all marginal variables by \u00b5.In the face of such a model, we are as interested in calculating marginal probabilities as well as partition functionality."}, {"heading": "3 Message Passing Algorithms", "text": "The optimization problem in Eq. (5) can be solved with general optimization tools. Although not all of these algorithms are demonstrably convergent, it is assumed that it is a fixed point of Eq. (5). Furthermore, if the entropy Hc (\u00b5) is concave, this is the global optimum of Eq. (5). Most existing algorithms assume that Eq = 1. Since we want to examine a broader range of approximations in this work, we derive updates for the more general case (for each case 6 = 0). Our derivative, which closely follows those of Yedidia et al., results from the following rules of actualization: m\u03b1 \u2192 Qi (xi) = m0xi \u2212 \u2212 \u2212 i (xi) \u2212 c\u03b1 \u2212 Qi + Qi + Qi \u2192 Qi (Qi) = Qi (Qi) - Qi (Qi) (Qi) - Qi - (Qi) (Qi) (Qi) (Qi) - (Qi)."}, {"heading": "4 Properties of Counting Number Space", "text": "Considering a specific model of counting numbers, different entropy approximations result. But what are good numbers and how can we find them for a specific model? A desirable property of counting numbers is that they lead to concave entropy, as in Section 2. However, there are several reasons for selecting them. However, one thing is clear, that the optimization is globally optimal. The other is that the true entropy H (\u00b5) itself is concave [14].Another approach to deriving good numbers is to limit ourselves to c, that optimization with Hc (\u00b5) is accurate for at least some values of satisfaction. For example, let us assume that we have a model in which the number of entropy (x\u03b1) = 0 for all alpha numbers (i.e., a fully factored model) we should limit that these models are correctly optimized? It is easy to see that c is satisfactory: empci + i."}, {"heading": "5 Approximating Bethe", "text": "The experiments in the previous section show that the free energy of Bethe performs well in a variety of parameter settings. As we would like to work with convex free energies, a key question is which of the convex free energies comes closest to the performance of Bethe. Below, we describe several approaches to obtain counters that meet the above requirements, divided into static approximations that determine the counters only based on the structure of the model, and adaptive approximations that also take the model parameters into account."}, {"heading": "5.1 Static Approximations", "text": "Following the insights of the previous section, it is natural to try to combine the convexity constraints of Eq. (7) and Eq. (8) with the validity constraints defined by Eq. (11) Within this subspace, it is an easy choice to find the counters closest to the Euclidean distance to the Bethe counters. To provide clarity, we use the vector of the Bethe counters as bi = 1 \u2212 di and b\u03b1 = 1. We define the convex Bethe-c approach as the solution to the optimization problems. \u2212 b (13) s.t. ci, c\u03b1 fulfill Eq. (7,8,11).This limited optimization problem can be formulated and solved as a square program. A similar approach has recently been studied by Hazan and Shashua [4]. However, it is not clear that the L2 metric in the number is sufficient to approach the principle."}, {"heading": "5.2 Adaptive Approximations", "text": "The approximations we have studied so far are based on the structure of the model alone and were not aligned with its parameters. Intuitively, a good approximation should place more emphasis on \"stronger\" interactions than on weaker ones. Indeed, Wainwright et al. [13], introducing a method for determining the optimal weights in TRW (referred to as TRW-opt), includes TRW entropy of upper limits of actual entropy H (\u00b5) and thus the corresponding variable approximation in Eq. (5), results in an upper limit on the true partition function. Wainwright et al. so we are looking for numbers that minimize this upper limit. Here, we present a different and simpler approach to adaptive adjustment of the counts. As in the previous section, our motivation is to approximate the performance of the term approximation using convex free energies. One strategy is to look only at c where Hc (MP) lies."}, {"heading": "6 Discussion", "text": "The study of convex free energies was originally motivated by the realization that loopy belief propagation was the optimization of non-convex free energies. It was therefore set out to alleviate the problem of non-convexity in the Bethe optimization method, and has indeed led to elegant algorithmic message transmission solutions for convex free energies. Another interesting application of convex free energies was the optimization of Bethe (or Kikuchi) free energies via sequences of local convex approximations. [6] Although this led to faster optimization, it still inherited the local optimization problem of Bethe optimization. More recently, convex free energies have proven to be particularly useful in the context of model selection. [12] Despite these advantages, in terms of the quality of approximation, convex free energies are often not competitive with Bethe and indeed perform poorer performance across a wide range of parameters as we show."}, {"heading": "Acknowledgements", "text": "We thank Talya Meltzer, Shai Shalev-Shwartz, Raanan Fatal and Yair Wei\u00df for their helpful comments. This research was partially supported by a grant from the Israel Science Foundation."}, {"heading": "A Results for other graphs", "text": "In Figure 6, we show results for adaptive approximations on fully connected graphs over 10 nodes. As you can see, the results are very similar to those of grids. Figure 7 shows similar results for 10 \u00d7 10 grids."}], "references": [{"title": "Inference from iterative simulation using multiple sequences", "author": ["A. Gelman", "D.B. Rubin"], "venue": "Statistical Science,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 1992}, {"title": "Approximate inference using conditional entropy decompositions", "author": ["A. Globerson", "T. Jaakkola"], "venue": "In AISTATS,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2007}, {"title": "Convergent propagation algorithms via oriented trees", "author": ["A. Globerson", "T. Jaakkola"], "venue": "In UAI,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2007}, {"title": "Convergent message-passing algorithms for inference over general graphs with convex free energy", "author": ["T. Hazan", "A. Shashua"], "venue": "In UAI,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2008}, {"title": "Convexity arguments for efficient minimization of the Bethe and Kikuchi free energies", "author": ["T. Heskes"], "venue": "Journal of Artificial Intelligence Research,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2006}, {"title": "Approximate inference and constrained optimization", "author": ["T. Heskes", "K. Albers", "B. Kappen"], "venue": "In UAI,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2003}, {"title": "An introduction to variational approximations methods for graphical models", "author": ["M.I. Jordan", "Z. Ghahramani", "T. Jaakkola", "L.K. Saul"], "venue": "Learning in Graphical Models. Kluwer, Dordrecht,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 1998}, {"title": "The volume of relaxed boolean-quadric and cut polytopes", "author": ["C.W. Ko", "J. Lee", "E. Steingr\u0131\u0301msson"], "venue": "Discrete Math.,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1997}, {"title": "Divergence measures and message passing", "author": ["T.P. Minka"], "venue": "Technical Report MSR-TR-2005-173, Microsoft Research,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2005}, {"title": "Loopy belief propagation for approximate inference: An empirical study", "author": ["K. Murphy", "Y. Weiss"], "venue": "In UAI,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 1999}, {"title": "Estimation and marginalization using kikuchi approximation methods", "author": ["P. Pakzad", "V. Anantharam"], "venue": "Neural Computation,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2005}, {"title": "Estimating the \u201dwrong\u201d graphical model: Benefits in the computation-limited setting", "author": ["M.J. Wainwright"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2006}, {"title": "A new class of upper bounds on the log partition function", "author": ["M.J. Wainwright", "T.S. Jaakkola", "A.S. Willsky"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2005}, {"title": "Graphical models, exponential families, and variational inference", "author": ["M.J. Wainwright", "M.I. Jordan"], "venue": "Foundations and Trends in Machine Learning,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2008}, {"title": "Map estimation, linear programming and belief propagation with convex free energies", "author": ["Y. Weiss", "C. Yanover", "T. Meltzer"], "venue": "In UAI,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2007}, {"title": "On the choice of regions for generalized belief propagation", "author": ["M. Welling"], "venue": "In UAI,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2004}, {"title": "Belief optimization for binary networks : A stable alternative to loopy belief propagation", "author": ["M. Welling", "Y. Teh"], "venue": "In UAI,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2001}, {"title": "Approximations with reweighted generalized belief propagation", "author": ["W. Wiegerinck"], "venue": "In AISTATS,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2005}, {"title": "Fractional belief propagation", "author": ["W. Wiegerinck", "T. Heskes"], "venue": "In NIPS,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2003}, {"title": "Generalized belief propagation", "author": ["J.S. Yedidia", "W.T. Freeman", "Y. Weiss"], "venue": "In NIPS,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2001}, {"title": "Constructing free energy approximations and generalized belief propagation algorithms", "author": ["J.S. Yedidia", "W.T. Freeman", "Y. Weiss"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2005}, {"title": "CCCP algorithms to minimize the bethe and kikuchi free energies: Convergent alternatives to belief propagation", "author": ["A. Yuille"], "venue": "Neural Computation,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2002}], "referenceMentions": [{"referenceID": 6, "context": "An important class of approximations are variational methods [7] that pose inference in terms of minimizing the free energy functional.", "startOffset": 61, "endOffset": 64}, {"referenceID": 9, "context": "In the last decade, loopy belief propagation (LBP), a simple local message passing procedure, proved to be empirically successful and was used in a variety of applications [10].", "startOffset": 172, "endOffset": 176}, {"referenceID": 19, "context": "[20] merged these lines of work by formulating loopy belief propagation in terms of optimizing the Bethe free energy, an approximate free energy functional.", "startOffset": 0, "endOffset": 4}, {"referenceID": 16, "context": "Several approaches have been introduced to fix the non-convergence issue, so that LBP provably converges to a local optimum of the Bethe free energy [17, 22].", "startOffset": 149, "endOffset": 157}, {"referenceID": 21, "context": "Several approaches have been introduced to fix the non-convergence issue, so that LBP provably converges to a local optimum of the Bethe free energy [17, 22].", "startOffset": 149, "endOffset": 157}, {"referenceID": 1, "context": "To alleviate this problem, several works [2, 6, 13, 15] construct convex free energy approximations, for which there is a single global optimum.", "startOffset": 41, "endOffset": 55}, {"referenceID": 5, "context": "To alleviate this problem, several works [2, 6, 13, 15] construct convex free energy approximations, for which there is a single global optimum.", "startOffset": 41, "endOffset": 55}, {"referenceID": 12, "context": "To alleviate this problem, several works [2, 6, 13, 15] construct convex free energy approximations, for which there is a single global optimum.", "startOffset": 41, "endOffset": 55}, {"referenceID": 14, "context": "To alleviate this problem, several works [2, 6, 13, 15] construct convex free energy approximations, for which there is a single global optimum.", "startOffset": 41, "endOffset": 55}, {"referenceID": 2, "context": "Convexity also paved the way for the introduction of provably convergent message-passing algorithms for calculating likelihood and marginal probabilities [3, 4].", "startOffset": 154, "endOffset": 160}, {"referenceID": 3, "context": "Convexity also paved the way for the introduction of provably convergent message-passing algorithms for calculating likelihood and marginal probabilities [3, 4].", "startOffset": 154, "endOffset": 160}, {"referenceID": 1, "context": "Moreover, some of these approximations provide upper bounds on the partition function [2, 13].", "startOffset": 86, "endOffset": 93}, {"referenceID": 12, "context": "Moreover, some of these approximations provide upper bounds on the partition function [2, 13].", "startOffset": 86, "endOffset": 93}, {"referenceID": 13, "context": "A class of popular approximate inference approaches are the variational methods that rely on the following exact formulation of logZ(\u03b8) [14]:", "startOffset": 136, "endOffset": 140}, {"referenceID": 13, "context": "The setM(G) is known as the marginal polytope associated with a graph G [14].", "startOffset": 72, "endOffset": 76}, {"referenceID": 20, "context": "As for the entropy term, a family of entropy approximations with a long history in statistical physics is based on a weighted sum of local entropies Hc(\u03bc) = \u2211 r crHr(\u03bcr), where r are subsets of variables (regions) and the coefficients cr are called counting numbers [21].", "startOffset": 266, "endOffset": 270}, {"referenceID": 15, "context": ", [16, 18]).", "startOffset": 2, "endOffset": 10}, {"referenceID": 17, "context": ", [16, 18]).", "startOffset": 2, "endOffset": 10}, {"referenceID": 20, "context": "The Bethe entropy approximation Hb(\u03bc) is defined by choosing c\u03b1 = 1, ci = 1 \u2212 di (where di = |{\u03b1 : i \u2208 \u03b1}|) [21].", "startOffset": 108, "endOffset": 112}, {"referenceID": 12, "context": "[13].", "startOffset": 0, "endOffset": 4}, {"referenceID": 4, "context": "More recently, Heskes [5] derived a set of sufficient condition for c\u03b1, ci to yield a concave function.", "startOffset": 22, "endOffset": 25}, {"referenceID": 19, "context": "[20] many message passing algorithms have been proposed for optimizing variational approximations.", "startOffset": 0, "endOffset": 4}, {"referenceID": 20, "context": "[21], then Eq.", "startOffset": 0, "endOffset": 4}, {"referenceID": 13, "context": "The other is that the true entropy H(\u03bc) is itself concave [14].", "startOffset": 58, "endOffset": 62}, {"referenceID": 20, "context": "(11) variablevalid, as the variables are counted correctly in Hc(\u03bc) [21].", "startOffset": 68, "endOffset": 72}, {"referenceID": 20, "context": "(12) are valid [21] as they have the appealing property of not over- or under-counting variables and factors in the approximate entropy Hc(\u03bc).", "startOffset": 15, "endOffset": 19}, {"referenceID": 10, "context": "Furthermore, for tree structured distributions it has been shown that only valid counting numbers can yield exact results [11].", "startOffset": 122, "endOffset": 126}, {"referenceID": 1, "context": "The field parameters \u03b8i were drawn uniformly from the range [\u2212\u03c9F , \u03c9F ], and the interaction parameters \u03b8i,j were drawn either from the range [\u2212\u03c9I , \u03c9I ] or from [0, \u03c9I ] to obtain mixed or attractive potentials respectively [2, 13].", "startOffset": 225, "endOffset": 232}, {"referenceID": 12, "context": "The field parameters \u03b8i were drawn uniformly from the range [\u2212\u03c9F , \u03c9F ], and the interaction parameters \u03b8i,j were drawn either from the range [\u2212\u03c9I , \u03c9I ] or from [0, \u03c9I ] to obtain mixed or attractive potentials respectively [2, 13].", "startOffset": 225, "endOffset": 232}, {"referenceID": 1, "context": "In fact, we note that to the best of our knowledge all free energy approximations suggested in the literature obey this variable-valid constraint [2, 4, 13, 19, 21].", "startOffset": 146, "endOffset": 164}, {"referenceID": 3, "context": "In fact, we note that to the best of our knowledge all free energy approximations suggested in the literature obey this variable-valid constraint [2, 4, 13, 19, 21].", "startOffset": 146, "endOffset": 164}, {"referenceID": 12, "context": "In fact, we note that to the best of our knowledge all free energy approximations suggested in the literature obey this variable-valid constraint [2, 4, 13, 19, 21].", "startOffset": 146, "endOffset": 164}, {"referenceID": 18, "context": "In fact, we note that to the best of our knowledge all free energy approximations suggested in the literature obey this variable-valid constraint [2, 4, 13, 19, 21].", "startOffset": 146, "endOffset": 164}, {"referenceID": 20, "context": "In fact, we note that to the best of our knowledge all free energy approximations suggested in the literature obey this variable-valid constraint [2, 4, 13, 19, 21].", "startOffset": 146, "endOffset": 164}, {"referenceID": 3, "context": "A similar approach was recently studied by Hazan and Shashua [4].", "startOffset": 61, "endOffset": 64}, {"referenceID": 7, "context": "Volume computations over such polytopes are generally difficult, but in some special cases may be solved in closed form [8].", "startOffset": 120, "endOffset": 123}, {"referenceID": 0, "context": "To determine when the random walk is close to the stationary distribution, we apply a heuristic convergence test by running in parallel several chains from different random starting points and comparing their statistics [1].", "startOffset": 220, "endOffset": 223}, {"referenceID": 12, "context": "We compare their performance with the Bethe approximation and the TRW approximation using a uniform distribution over four spanning trees (see [13]) 2.", "startOffset": 143, "endOffset": 147}, {"referenceID": 12, "context": "[13], in each trial we set \u03c9F to a fixed value and gradually increase the interaction strength \u03c9I .", "startOffset": 0, "endOffset": 4}, {"referenceID": 1, "context": "These results are consistent with previous studies [2, 4, 13].", "startOffset": 51, "endOffset": 61}, {"referenceID": 3, "context": "These results are consistent with previous studies [2, 4, 13].", "startOffset": 51, "endOffset": 61}, {"referenceID": 12, "context": "These results are consistent with previous studies [2, 4, 13].", "startOffset": 51, "endOffset": 61}, {"referenceID": 12, "context": "[13], introduce a method for finding the optimal weights in TRW (denoted TRW-opt).", "startOffset": 0, "endOffset": 4}, {"referenceID": 8, "context": "Where Cvv is the variable-valid subspace and I\u03b1(\u03bc\u03b1) = \u2211 i\u2208\u03b1Hi(\u03bci)\u2212H\u03b1(\u03bc\u03b1) is the multi-information of the distribution \u03bc\u03b1 (see also [9]).", "startOffset": 131, "endOffset": 134}, {"referenceID": 12, "context": "[13]: Proposition 5.", "startOffset": 0, "endOffset": 4}, {"referenceID": 12, "context": "Given this gradient, we can use a conditional gradient algorithm as in [13] to minimize max\u03bc F\u0303c[\u03bc,\u03b8] over the set of c that gives an upper bound on Bethe.", "startOffset": 71, "endOffset": 75}, {"referenceID": 13, "context": "More importantly, while finding the optimal counting numbers in TRW is computationally hard for non-pairwise models [14], our method is naturally applicable in the more general setting.", "startOffset": 116, "endOffset": 120}, {"referenceID": 5, "context": "Another interesting application of convex free-energies was for optimizing Bethe (or Kikuchi) free energies via sequences of local convex approximations [6].", "startOffset": 153, "endOffset": 156}, {"referenceID": 11, "context": "More recently, convex free energy variants were shown to be particularly useful in the context of model selection [12].", "startOffset": 114, "endOffset": 118}], "year": 2009, "abstractText": "The introduction of loopy belief propagation (LBP) revitalized the application of graphical models in many domains. Many recent works present improvements on the basic LBP algorithm in an attempt to overcome convergence and local optima problems. Notable among these are convexified free energy approximations that lead to inference procedures with provable convergence and quality properties. However, empirically LBP still outperforms most of its convex variants in a variety of settings, as we also demonstrate here. Motivated by this fact we seek convexified free energies that directly approximate the Bethe free energy. We show that the proposed approximations compare favorably with state-of-the art convex free energy approximations.", "creator": "TeX"}}}