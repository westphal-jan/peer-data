{"id": "1206.3232", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "13-Jun-2012", "title": "AND/OR Importance Sampling", "abstract": "The paper introduces AND/OR importance sampling for probabilistic graphical models. In contrast to importance sampling, AND/OR importance sampling caches samples in the AND/OR space and then extracts a new sample mean from the stored samples. We prove that AND/OR importance sampling may have lower variance than importance sampling; thereby providing a theoretical justification for preferring it over importance sampling. Our empirical evaluation demonstrates that AND/OR importance sampling is far more accurate than importance sampling in many cases.", "histories": [["v1", "Wed, 13 Jun 2012 12:33:40 GMT  (365kb)", "http://arxiv.org/abs/1206.3232v1", "Appears in Proceedings of the Twenty-Fourth Conference on Uncertainty in Artificial Intelligence (UAI2008)"]], "COMMENTS": "Appears in Proceedings of the Twenty-Fourth Conference on Uncertainty in Artificial Intelligence (UAI2008)", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["vibhav gogate", "rina dechter"], "accepted": false, "id": "1206.3232"}, "pdf": {"name": "1206.3232.pdf", "metadata": {"source": "CRF", "title": "AND/OR Importance Sampling", "authors": ["Vibhav Gogate"], "emails": ["vgogate@ics.uci.edu", "dechter@ics.uci.edu"], "sections": [{"heading": null, "text": "In contrast to the meaning sampling, AND / OR meaning stores samples in the AND / OR space and then extracts a new mean from the stored samples. We demonstrate that samples with AND / OR meaning can have a lower variance than samples with meaning, providing a theoretical justification for preferring them to a meaning sampling. Our empirical analysis shows that in many cases, samples with AND / OR meaning are much more accurate than samples with meaning."}, {"heading": "1 Introduction", "text": "Many problems in graphical models such as calculating the probability of evidence in Bayesian networks, solving counting in constraint networks, and calculating the partition function in Markov random fields are summation problems defined as the sum of a function across a domain. Because these problems are NP-hard, sample-based techniques are often used to approximate the sum. The focus of the current work is on importance sample sampling. The main idea in the Importance sample sampling [Geweke, 1989, Rubinstein, 1981] is to transform the summation problem into the calculation of a weighted average across the domain by using a special distribution called a suggestion (or meaning)."}, {"heading": "2 Preliminaries", "text": "A faith network (BN) is a graphical model R = (X, D, P), where X = {X1,.., Xn} is a set of random variables over multi-value domains D = {D1,.., Dn}. In the face of a directed acyclic diagram G over X, P = {Pi}, where Pi = P (Xi | pa (Xi))) are conditional probability tables (CPTs) linked to each Xi. pa (Xi), pa (Xi) is the set of the parents of the variables Xi in G. A faith network represents a probability distribution over X, P (X) = Pi = 1P (Xi | pa (Xi))."}, {"heading": "2.1 AND/OR search spaces", "text": "We can calculate the probability of proofs by searching by collecting probabilities over the search space of instantiated variables. < D > In the simplest case, this process defines an OR search tree whose nodes partially represent variable mappings. This search space does not capture the structure of the underlying graphical model. To address this problem, Dechter and Mateescu, 2007] introduced the notion of AND / OR search space. In the face of a directed rooted tree R = (X, D, P), its AND / OR search space is driven by a pseudo-tree defined below. Definition 2.3 (pseudo-tree) is called an incorrect graph G = (V, E), a directed rooted tree T = (V, E) is defined as a pseudo-tree defined below."}, {"heading": "2.2 Computing Probability of Evidence Using Importance Sampling", "text": "The import sample [Rubinstein, 1981] is a simulation technique commonly used to evaluate the sum, M = \u2211 x | X f (x) for any real function f. The idea is to generate samples x1,.., xN from a supply distribution Q (satisfactory f (x) > 0 \u21d2 Q (x) > 0) and then estimate M as follows: M = \u2211 x \u00b2 x (x) = f (xi) Q (xi) (3) w is often referred to as sample weight. It is known that the expected value E (M) = M [Rubinstein, 1981]. To calculate the probability of evidence by meaning, we use the substitution form: f (x) = Xi \u2212 j = 1 P (Xi)."}, {"heading": "3 AND/OR importance sampling", "text": "We first discuss the calculation expectation according to parts that form the backbone of the AND / OR importance sample. Afterwards, we formally present the AND / OR importance sample scheme and derive its properties."}, {"heading": "3.1 Estimating Expectation by Parts", "text": "In Eq.2, the expectation of a multivariable function is calculated by summing up Q = Q = Q (Q) components (Q = Q), since this method is clearly inefficient because it does not take into account the decomposition of the multivariable function, as we have shown below. Consider the tree model given in Figure 2 (a). Let A = a and B = b be the proof variables. Let Q (ZXY) = Q (Z) Q (Y) parts given in Figure 2 (a). Let us assume that f (Z), f (XZ), f (Z) P (A = a | X) and f (Z) Z (Z) are the expectation (B = b | Y). We can express the probability of evidence P (a, b) = XYZZ (Z)."}, {"heading": "3.2 Computing Sample Mean in AND/OR-space", "text": "We define the term of an AND / OR sample tree, which is limited to the generated samples and used to calculate the AND / OR sample. The names on this AND / OR tree are set to reflect the meaning of the sample. (Definition) The definition is such that Anc (Xi) is a subset of all ancestors of Xi in T. A sequence of mappings (samples) S and a complete AND / OR search tree is such. (Samples) S and a complete AND / OR search tree is such. (Samples) S and a complete AND / OR search tree is such. (Samples) A complete AND / OR sample tree is such. (Sample)"}, {"heading": "4 Variance Reduction", "text": "In this section, we demonstrate that the mean of the AND / OR sample may have a lower variance than the mean of the sample, which is calculated using sampling of meaning (Eq.3). THEOREM 4.1 (Variance Reduction) Variance of the AND / OR sample is less than or equal to the variance of the meaning of the sample. Suppose we have three random variables X, Y, and Z with the following relationship: X and Y are independently given Z (similar to our example Bayesian network). The expression for the variance derived here can be used in a production step (induction is performed on the node of the pseudo-tree) to prove the meaning of the sampling sample."}, {"heading": "5 Estimation in AND/OR graphs", "text": "Next, we describe a more powerful algorithm for estimating the mean value in AND / OR space by moving from AND / OR trees to AND / OR graphs as represented in [Dechter and Mateescu, 2007]. An AND / OR tree can contain nodes that contain identical sub-trees as a sample. If such unifiable nodes are merged, the tree becomes a graph and its size shrinks. Some unifiable nodes can be identified from contexts defined below. Definition 5.1 (context) is defined as a faith network and the corresponding AND / OR search tree SAOT relative to a pseudo-tree T, the context of any AND node < Xi, xi > SAOT, is defined as a set of ancestors of Xi in T associated with Xi and the descendants of Xi.The context is achieved by merging all contexts unifiable AND / OR nodes."}, {"heading": "6 Experimental Evaluation", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "6.1 Competing Algorithms", "text": "It has been shown that the calculation of the supply distribution from the output of a Generalized Belief Propagation Scheme of Iterative Join Graph Propagation (IJGP) yields better empirical performance than other available decisions [Gogate and Dechter, 2005]. Therefore, we use the output of IJGP to calculate the supply distribution Q. The complexity of IJGP is exponential in time and space in its i-limit, a parameter that limits the cluster size. We used an i-limit of 5 in all our experiments. We experimented with three sample algorithms for benchmarks that have no determinism: (a) (pure) IJGP sampling, (b) AND / OR tree sampling, and (c) AND / OR diagram IJGP sampling."}, {"heading": "6.1.1 Results", "text": "We experimented with three sets of benchmark belief networks (a) Random Networks, (b) Linkage Networks and (c) Grid Networks. Note that only shortcuts and Grid Networks have zero probabilities on which we can sample SampleSearch.The exact P (e) for most cases is available from the UAI 2006 competition web-site.Our results are shown in Figures 4-6. Each figure shows the approximate probability of proofs as a function of time.The bold line in each figure shows the exact probability of proofs. The reader can visualize the error from the distance between the approximate curves and the exact line. Due to lack of space, we show only a portion of our results. Each figure shows the number of variables n, the maximum domain size d and the number of evidence nodes."}, {"heading": "7 Related Work and Summary", "text": "The work presented in this paper is related to the work of [Hernndez and Moral, 1995, Kj\u00e6rulff, 1995, Dawid et al., 1994], who perform sampling on the basis of a crossing tree. [Kj\u00e6rulff, 1995, Dawid et al., 1994] The main idea in these essays is to perform the transmission of messages to a crossing tree by replacing messages that are too difficult to calculate due to their sample-based inaccuracies. [Kj\u00e6rulff, 1995, Dawid et al., 1994] Gibbs use sampling, while [Hernndez and Moral, 1995] use sampling to approximate the messages. Similar to recent work on Rao-Blackwellised Sampling such as [Bidyuk and Dechter, 2003, Paskin, 2004, Gogate and Dechter, 2005] the reduction of variance in these crossing trees is achieved on the basis of sampling systems, because some exact calculations are performed; in contrast to the radio-odication and blackwell sampling theory, sampliance is achieved."}, {"heading": "Acknowledgements", "text": "This work was partially supported by NSF under grant numbers IIS-0331707, IIS-0412854 and IIS-0713118 as well as NIH grant R01-HG004175-02."}], "references": [{"title": "An empirical study of w-cutset sampling for bayesian networks", "author": ["Bidyuk", "Dechter", "B. 2003] Bidyuk", "R. Dechter"], "venue": "In Proceedings of the 19th Annual Conference on Uncertainty in Artificial Intelligence (UAI-03)", "citeRegEx": "Bidyuk et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Bidyuk et al\\.", "year": 2003}, {"title": "Ais-bn: An adaptive importance sampling algorithm for evidential reasoning in large bayesian networks", "author": ["Cheng", "Druzdzel", "J. 2000] Cheng", "M.J. Druzdzel"], "venue": "J. Artif. Intell. Res. (JAIR),", "citeRegEx": "Cheng et al\\.,? \\Q2000\\E", "shortCiteRegEx": "Cheng et al\\.", "year": 2000}, {"title": "Hybrid propagation in junction trees", "author": ["Dawid et al", "A.P. 1994] Dawid", "U. Kjaerulff", "S.L. Lauritzen"], "venue": "In IPMU\u201994,", "citeRegEx": "al. et al\\.,? \\Q1994\\E", "shortCiteRegEx": "al. et al\\.", "year": 1994}, {"title": "AND/OR search spaces for graphical models", "author": ["Dechter", "Mateescu", "R. 2007] Dechter", "R. Mateescu"], "venue": "Artificial Intelligence,", "citeRegEx": "Dechter et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Dechter et al\\.", "year": 2007}, {"title": "Optimizing exact genetic linkage computations", "author": ["Fishelson", "Geiger", "M. 2003] Fishelson", "D. Geiger"], "venue": "RECOMB", "citeRegEx": "Fishelson et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Fishelson et al\\.", "year": 2003}, {"title": "Approximate inference algorithms for hybrid bayesian networks with discrete constraints. UAI2005", "author": ["Gogate", "Dechter", "V. 2005] Gogate", "R. Dechter"], "venue": null, "citeRegEx": "Gogate et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Gogate et al\\.", "year": 2005}, {"title": "Samplesearch: A scheme that searches for consistent samples", "author": ["Gogate", "Dechter", "V. 2007] Gogate", "R. Dechter"], "venue": "AISTATS", "citeRegEx": "Gogate et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Gogate et al\\.", "year": 2007}, {"title": "Mixing exact and importance sampling propagation algorithms in dependence graphs", "author": ["Hernndez", "Moral", "L.D. 1995] Hernndez", "S. Moral"], "venue": "International Journal of Approximate Reasoning,", "citeRegEx": "Hernndez et al\\.,? \\Q1995\\E", "shortCiteRegEx": "Hernndez et al\\.", "year": 1995}, {"title": "Importance sampling algorithms for Bayesian networks: Principles and performance", "author": ["Yuan", "Druzdzel", "C. 2006] Yuan", "M.J. Druzdzel"], "venue": "Mathematical and Computer Modelling", "citeRegEx": "Yuan et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Yuan et al\\.", "year": 2006}], "referenceMentions": [], "year": 2008, "abstractText": "The paper introduces AND/OR importance sampling for probabilistic graphical models. In contrast to importance sampling, AND/OR importance sampling caches samples in the AND/OR space and then extracts a new sample mean from the stored samples. We prove that AND/OR importance sampling may have lower variance than importance sampling; thereby providing a theoretical justification for preferring it over importance sampling. Our empirical evaluation demonstrates that AND/OR importance sampling is far more accurate than importance sampling in many cases.", "creator": "gnuplot 4.2 patchlevel 2 "}}}