{"id": "1206.6872", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "27-Jun-2012", "title": "A Self-Supervised Terrain Roughness Estimator for Off-Road Autonomous Driving", "abstract": "We present a machine learning approach for estimating the second derivative of a drivable surface, its roughness. Robot perception generally focuses on the first derivative, obstacle detection. However, the second derivative is also important due to its direct relation (with speed) to the shock the vehicle experiences. Knowing the second derivative allows a vehicle to slow down in advance of rough terrain. Estimating the second derivative is challenging due to uncertainty. For example, at range, laser readings may be so sparse that significant information about the surface is missing. Also, a high degree of precision is required in projecting laser readings. This precision may be unavailable due to latency or error in the pose estimation. We model these sources of error as a multivariate polynomial. Its coefficients are learned using the shock data as ground truth -- the accelerometers are used to train the lasers. The resulting classifier operates on individual laser readings from a road surface described by a 3D point cloud. The classifier identifies sections of road where the second derivative is likely to be large. Thus, the vehicle can slow down in advance, reducing the shock it experiences. The algorithm is an evolution of one we used in the 2005 DARPA Grand Challenge. We analyze it using data from that route.", "histories": [["v1", "Wed, 27 Jun 2012 16:30:05 GMT  (373kb)", "http://arxiv.org/abs/1206.6872v1", "Appears in Proceedings of the Twenty-Second Conference on Uncertainty in Artificial Intelligence (UAI2006)"]], "COMMENTS": "Appears in Proceedings of the Twenty-Second Conference on Uncertainty in Artificial Intelligence (UAI2006)", "reviews": [], "SUBJECTS": "cs.CV cs.LG cs.RO", "authors": ["david stavens", "sebastian thrun"], "accepted": false, "id": "1206.6872"}, "pdf": {"name": "1206.6872.pdf", "metadata": {"source": "META", "title": "A Self-Supervised Terrain Roughness Estimator for Off-Road Autonomous Driving", "authors": ["David Stavens"], "emails": ["stavens@robotics.stanford.edu", "thrun@robotics.stanford.edu"], "sections": [{"heading": "1 INTRODUCTION", "text": "In fact, we are able to monitor and monitor ourselves, \"he told the German Press Agency in an interview with\" Welt am Sonntag. \""}, {"heading": "2 RELATED WORK", "text": "There has been extensive work on terramechanics (Bekker, 1956; Bekker, 1969; Wong, 1989), guiding autonomous vehicles through rough terrain. Early work in the field relies on precise a priori models of the terrain. Recent work (Iagnemma et al., 2004; Brooks & Iagnemma, 2005; Shimoda et al., 2005) deals with the problem of online roughness. However, the sensors used in this work are proprioceptive and require the robot to travel across terrain for classification. In this paper, we predict the roughness of laser data so that the vehicle can estimate roughness prior to hitting rough terrain. Numerous techniques for laser perception exist in the literature, including the application to off-road driving (Shoemaker et al., 1999; Urmson et al., 2004) Those who capture errors in the 3-D point cloud are particularly relevant to our work."}, {"heading": "3 THE 3-D POINT CLOUD", "text": "Our vehicle uses a scanner laser mounted on the roof as shown in the figure. Specific laser generates ranges of 181 angular positions at 75 Hz with an angular resolution of 5 degrees. Scanning takes place in a single plane that is slightly tilted downwards as shown in the figure. In the absence of obstacles, a scanner creates a line that is orthogonal to the driving direction of the vehicle. However, detecting obstacles requires the third dimension. This is achieved by vehicle movements, 3-D measurements are integrated over time into a 3-D point cloud. Integrating data over time is not without problems. It requires an estimate of the coordinates at which a measurement was performed - in short, the robot is one."}, {"heading": "4 SURFACE CLASSIFICATION", "text": "This section describes the function for evaluating the 3-D point clouds. The point clouds are obtained by comparing adjacent measuring points (separately). The function for this comparison takes into account a number of characteristics (including elapsed time) which it evaluates using a number of parameters. However, the optimization of these parameters is described in Section 6.After the projection, as described in paragraph 3, a single 3-D laser point has six characteristics relevant to our approach: its 3DOF (x, y, z) position, the time it was observed, and the first derivatives of the estimated role of the vehicle and the pitch of the measurement. These results in the following vector of characteristics for each laser point Li: Li = [x, z, p]. (1) Our algorithm compares characteristics in pairs, resulting in a square evaluation of size N2 for N points."}, {"heading": "5 DATA LABELING", "text": "The step to data labeling assigns target values for Rcombined to the terrain fields. This allows the definition of a supervised learning algorithm to optimize the parameters in our model (a total of 14)."}, {"heading": "5.1 RAW DATA FILTERING", "text": "In particular, the z-axis accelerometer is used. However, in addition to surface roughness, the IMU measures two factors. Firstly, individual shock events cause resonant vibrations in the vehicle suspension. This is problematic because we want to link individual shock events with specific, local surface data. Vibrations create an additive effect that can cause individual events to overlap, making it difficult to interpret in isolation.Secondly, the gravity vector is present in the z-acceleration data.From the axis perspective, the vector is constantly changing with the pitch of the vehicle and the road. This vector must be removed to generate the true shock value. To address these problems, we filter the IMU data with a 40-tap FIR filter. The filter removes 0-10Hz from the input. The distance of 0Hz addresses the gravity vector problem."}, {"heading": "5.2 CALCULATING THE SHOCK INDEX", "text": "Next, our approach calculates a series of speed-independent coefficients of robustness from the measured shock values. These coefficients are used as target values for the self-monitored learning process. This step is necessary because raw shock filtering is strongly influenced by vehicle speed. The faster we drive over rugged terrain, the stronger the perceived z-acceleration is. Without speed compensation, the labeling step and thus the learning breaks down. (This is especially true since the data was collected with a speed regulator that automatically slows down after entering rough terrain.) The general dependence on perceived vertical acceleration and vehicle speed is not linear. Empirically, however, we find that it can be approached with precision by a linear function in the operational range of interest. Fig. 5 shows empirical data on Stanley crossing a static obstacle at different speeds."}, {"heading": "6 LEARNING THE PARAMETERS", "text": "We now have a suitable method for calculating target values for terrain cleanliness. Therefore, we are moving to the learning method to find the parameters of the model, which are obtained in paragraph 4.The data for training are obtained during the driving of the vehicle. For each covered terrain we calculate a value Rcombined. When the vehicle crosses the field, the corresponding robustness coefficient is calculated as above. The objective function for learning (which we seek to maximize) is of the form: Tp \u2212 Fp (6), where Tp and Fp are the true or false positive classification rates.A true positive course occurs when a road area whose robustness coefficient exceeds a threshold chosen by the user specifies that the value of the patch of combined elements exceeds \u00b5. The trade-off parameter \u03bb is arbitrarily selected by the user."}, {"heading": "7 EXPERIMENTAL RESULTS", "text": "Our algorithm was developed after the 2005 DARPA Grand Challenge, which aims to replace an algorithm that reactively adjusts velocity based on measured shocks (Thrun et al., 2006b). However, since we calculate speed-independent robustness coefficients, the data recorded during the race can easily be used for training and evaluation. Our experiments use miles 60 to 70 of the 2005 Grand Challenge Route as a training set and miles 70 to 80 as a test set. The 10-mile test set contains 887,878 laser points and 11,470 shock \"events\" whose intensity ranges from completely negligible (.02 Gs) to very severe (fast.5 Gs). The 10-mile test set contains 1,176,375 laser points and 13,325 shock \"events.\" The intensity again ranges from negligible (.02 Gs) to severe (above.6 Gs). All laser points fall within 30 cm of the terrain."}, {"heading": "7.1 SENSITIVITY VERSUS SPECIFICITY", "text": "We analyze the sensitivity to the specificity of our method by means of Receiver Operating Characteristic (ROC) curves. For comparison, we also include the ROC curves for the actual terrain classification used during the race (Thrun et al., 2006a). However, these methods are not completely comparable. The method in (Thrun et al., 2006a) was used for steering decisions, not for speed control. Furthermore, it was trained by human driving, not by a self-monitored learning approach. Nevertheless, both methods add numbers to points in a 3-D point cloud that roughly correspond to the robustness of the terrain. We use the method in (Thrun et al., 2006a) to generate a vector W. Separate trained parameters are then used to detect positive points in a 3-D point cloud that roughly correspond to the robustness of the terrain. We use the method in (Thrun et al, 2006a) to generate a Vector."}, {"heading": "7.2 EFFECT ON THE VEHICLE", "text": "As mentioned above, we used a different approach to speed control during the race (Thrun et al., 2006b), the vehicle slowed down after the acceleration sensors detected impassable terrain, and the parameters of deceleration and speed were adapted to human driving by machine learning. As the roughness is spatially correlated, we found that this method is very effective, but it did not allow the vehicle to anticipate impassable terrain, so the vehicle experienced more shocks than necessary. To understand how much improvement our new method offers, we compare it to the reactive approach used in the race. The only software change is the mechanism that triggers the speed reduction. By anticipating impassable terrain, our new method should enable faster completion times with lower shocks than previously possible. Indeed, this is the case. The results are shown in Figure 7. The graph showing the vertical axis we were experiencing the shock."}, {"heading": "8 DISCUSSION", "text": "We have presented a novel, self-monitored learning approach to estimating the roughness of outdoor terrain. Our main application is the detection of small interruptions that can cause significant shock for a high-speed robotic vehicle. By slowing, the vehicle can reduce the shock it experiences. Estimating the roughness requires detecting very small surface discontinuities - often of a few centimeters. Therefore, the problem is much more difficult than finding obstacles. Our approach monitors the actual vertical accelerations caused by the unevenness of the ground. From this, it extracts a robustness coefficient. A self-monitored learning method is then used to predict this coefficient from the laser data. In this way, the vehicle can safely slow down before it hits rough surfaces. The approach in this paper was formulated (and implemented) as a method of offline learning, but it can also be used as a significant learning method to improve the speed of our vehicle."}, {"heading": "Acknowledgments", "text": "David Stavens \"doctoral thesis is supported by the David Cheriton Stanford Graduate Fellowship (SGF). Gabe Hoffmann of the Stanford Racing Team developed the 40-faucet FIR filter, which is used to extract vehicle shocks, which is thankfully acknowledged."}], "references": [{"title": "Theory of Land Locomotion", "author": ["G. Bekker"], "venue": "University of Michigan.", "citeRegEx": "Bekker,? 1956", "shortCiteRegEx": "Bekker", "year": 1956}, {"title": "Introduction to Terrain-Vehicle Systems", "author": ["G. Bekker"], "venue": "University of Michigan.", "citeRegEx": "Bekker,? 1969", "shortCiteRegEx": "Bekker", "year": 1969}, {"title": "A method for registration of 3D shapes", "author": ["P. Besl", "N. McKay"], "venue": "Transactions on Pattern Analysis and Machine Intelligence,", "citeRegEx": "Besl and McKay,? \\Q1992\\E", "shortCiteRegEx": "Besl and McKay", "year": 1992}, {"title": "Vibration-Based Terrain Classification for Planetary Exploration Rovers", "author": ["C.A. Brooks", "K. Iagnemma"], "venue": "IEEE Transactions on Robotics,", "citeRegEx": "Brooks and Iagnemma,? \\Q2005\\E", "shortCiteRegEx": "Brooks and Iagnemma", "year": 2005}, {"title": "Self-Supervised Monocular Road Detection in Desert Terrain", "author": ["H. Dahlkamp", "A. Kaehler", "D. Stavens", "S. Thrun", "G. Bradski"], "venue": "Proceedings of the Robotics Science and Systems Con-", "citeRegEx": "Dahlkamp et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Dahlkamp et al\\.", "year": 2006}, {"title": "On-Line Terrain Parameter Estimation for Planetary Rovers", "author": ["K. Iagnemma", "S. Kang", "H. Shibly", "S. Dubowsky"], "venue": "IEEE Transactions on Robotics and Automation. To appear", "citeRegEx": "Iagnemma et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Iagnemma et al\\.", "year": 2004}, {"title": "A new extension of the Kalman filter to nonlinear systems. In: International Symposium on Aerospace/Defense Sensing, Simulate and Controls", "author": ["S. Julier", "J. Uhlmann"], "venue": null, "citeRegEx": "Julier and Uhlmann,? \\Q1997\\E", "shortCiteRegEx": "Julier and Uhlmann", "year": 1997}, {"title": "Rough Terrain Autonomous Mobility, Part 1: A Theoretical Analysis of Requirements", "author": ["A. Kelly", "A. Stentz"], "venue": "Autonomous Robots,", "citeRegEx": "Kelly and Stentz,? \\Q1998\\E", "shortCiteRegEx": "Kelly and Stentz", "year": 1998}, {"title": "Rough Terrain Autonomous Mobility, Part 2: An Active Vision, Predictive Control Approach", "author": ["A. Kelly", "A. Stentz"], "venue": "Autonomous Robots,", "citeRegEx": "Kelly and Stentz,? \\Q1998\\E", "shortCiteRegEx": "Kelly and Stentz", "year": 1998}, {"title": "A Behavior-Based System for Off-Road Navigation", "author": ["D. Langer", "J. Rosenblatt", "M. Hebert"], "venue": "IEEE Transactions of Robotic and Automation,", "citeRegEx": "Langer et al\\.,? \\Q1994\\E", "shortCiteRegEx": "Langer et al\\.", "year": 1994}, {"title": "High-Speed Obstacle Avoidance using Monocular Vision and Reinforcement Learning", "author": ["J. Michels", "A. Saxena", "A. Ng"], "venue": "Proceedings of the Seventeenth International Conference on Machine Learning (ICML)", "citeRegEx": "Michels et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Michels et al\\.", "year": 2005}, {"title": "Efficient Variants of the ICP Algorithm", "author": ["S. Rusinkiewicz", "M. Levoy"], "venue": "Proc. Third International Conference on 3D Digital Imaging and Modeling (3DIM). Quebec City, Canada: IEEEComputer Society", "citeRegEx": "Rusinkiewicz and Levoy,? \\Q2001\\E", "shortCiteRegEx": "Rusinkiewicz and Levoy", "year": 2001}, {"title": "Learning Depth from Single Monocular Images", "author": ["A. Saxena", "S. Chung", "A. Ng"], "venue": "Proceedings of Conference on Neural Information Processing Systems (NIPS)", "citeRegEx": "Saxena et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Saxena et al\\.", "year": 2005}, {"title": "Potential Field Navigation of High Speed Unmanned Ground Vehicles in Uneven Terrain", "author": ["S. Shimoda", "Y. Kuroda", "K. Iagnemma"], "venue": "Proceedings of the IEEE International Conference on Robotics and Automation (ICRA)", "citeRegEx": "Shimoda et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Shimoda et al\\.", "year": 2005}, {"title": "Demo III: Department of Defense testbed for unmanned ground mobility", "author": ["C. Shoemaker", "J. Bornstein", "S. Myers", "B. Brendle"], "venue": "Proceedings of SPIE,", "citeRegEx": "Shoemaker et al\\.,? \\Q1999\\E", "shortCiteRegEx": "Shoemaker et al\\.", "year": 1999}, {"title": "Probabilistic Terrain Analysis for High-Speed Desert Driving", "author": ["S. Thrun", "M. Montemerlo", "Aron", "Andrei"], "venue": "Proceedings of the Robotics Science and Systems Conference", "citeRegEx": "Thrun et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Thrun et al\\.", "year": 2006}, {"title": "High Speed Naviga", "author": ["C. Urmson", "J. Anhalt", "M. Clark", "T. Galatali", "J.P. Gonzalez", "J. Gowdy", "A. Gutierrez", "S. Harbaugh", "M. Johnson-Roberson", "H. Kato", "P.L. Koon", "K. Peterson", "B.K. Smith", "S. Spiker", "E. Tryzelaar", "W.L. Whittaker"], "venue": null, "citeRegEx": "Urmson et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Urmson et al\\.", "year": 2004}, {"title": "Terramechanics and Off-Road Vehicles", "author": ["J. Wong"], "venue": "Elsevier.", "citeRegEx": "Wong,? 1989", "shortCiteRegEx": "Wong", "year": 1989}], "referenceMentions": [{"referenceID": 9, "context": "The result is used to adjust the direction of vehicle motion (Kelly & Stentz, 1998a; Kelly & Stentz, 1998b; Langer et al., 1994; Urmson et al., 2004).", "startOffset": 61, "endOffset": 149}, {"referenceID": 16, "context": "The result is used to adjust the direction of vehicle motion (Kelly & Stentz, 1998a; Kelly & Stentz, 1998b; Langer et al., 1994; Urmson et al., 2004).", "startOffset": 61, "endOffset": 149}, {"referenceID": 0, "context": "There has been extensive work on Terramechanics (Bekker, 1956; Bekker, 1969; Wong, 1989), the guidance of autonomous vehicles through rough terrain.", "startOffset": 48, "endOffset": 88}, {"referenceID": 1, "context": "There has been extensive work on Terramechanics (Bekker, 1956; Bekker, 1969; Wong, 1989), the guidance of autonomous vehicles through rough terrain.", "startOffset": 48, "endOffset": 88}, {"referenceID": 17, "context": "There has been extensive work on Terramechanics (Bekker, 1956; Bekker, 1969; Wong, 1989), the guidance of autonomous vehicles through rough terrain.", "startOffset": 48, "endOffset": 88}, {"referenceID": 5, "context": "More recent work (Iagnemma et al., 2004; Brooks & Iagnemma, 2005; Shimoda et al., 2005) addresses the problem of online terrain roughness estimation.", "startOffset": 17, "endOffset": 87}, {"referenceID": 13, "context": "More recent work (Iagnemma et al., 2004; Brooks & Iagnemma, 2005; Shimoda et al., 2005) addresses the problem of online terrain roughness estimation.", "startOffset": 17, "endOffset": 87}, {"referenceID": 14, "context": "Numerous techniques for laser perception exist in the literature, including its application to off-road driving (Shoemaker et al., 1999; Urmson et al., 2004).", "startOffset": 112, "endOffset": 157}, {"referenceID": 16, "context": "Numerous techniques for laser perception exist in the literature, including its application to off-road driving (Shoemaker et al., 1999; Urmson et al., 2004).", "startOffset": 112, "endOffset": 157}, {"referenceID": 12, "context": "For example, (Saxena et al., 2005) and (Michels et al.", "startOffset": 13, "endOffset": 34}, {"referenceID": 10, "context": ", 2005) and (Michels et al., 2005) use learning to reason about depth in a single monocular image.", "startOffset": 12, "endOffset": 34}, {"referenceID": 4, "context": "It was also used for visual road detection in the DARPA Grand Challenge (Dahlkamp et al., 2006).", "startOffset": 72, "endOffset": 95}], "year": 2006, "abstractText": "Accurate perception is a principal challenge of autonomous off-road driving. Perceptive technologies generally focus on obstacle avoidance. However, at high speed, terrain roughness is also important to control shock the vehicle experiences. The accuracy required to detect rough terrain is significantly greater than that necessary for obstacle avoidance. We present a self-supervised machine learning approach for estimating terrain roughness from laser range data. Our approach compares sets of nearby surface points acquired with a laser. This comparison is challenging due to uncertainty. For example, at range, laser readings may be so sparse that significant information about the surface is missing. Also, a high degree of precision is required when projecting laser readings. This precision may be unavailable due to latency or error in pose estimation. We model these sources of error as a multivariate polynomial. The coefficients of this polynomial are obtained through a self-supervised learning process. The \u201clabels\u201d of terrain roughness are automatically generated from actual shock, measured when driving over the target terrain. In this way, the approach provides its own training labels. It \u201ctransfers\u201d the ability to measure terrain roughness from the vehicle\u2019s inertial sensors to its range sensors. Thus, the vehicle can slow before hitting rough terrain. Our experiments use data from the 2005 DARPA Grand Challenge. We find our approach is substantially more effective at identifying rough surfaces and assuring vehicle safety than previous methods \u2013 often by as much as 50%.", "creator": " TeX output 2006.05.20:2326"}}}