{"id": "1302.6937", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "27-Feb-2013", "title": "Online Convex Optimization Against Adversaries with Memory and Application to Statistical Arbitrage", "abstract": "In many online learning scenarios the loss functions are not memoryless, but rather depend on history. Our first contribution is a complete characterization of sufficient and necessary conditions for learning with memory, accompanied with a novel algorithm for this framework that attains the optimal O(\\sqrt{T})-regret. This improves previous online learning algorithms that guaranteed O(T^{2/3}) regret and required more stringent conditions. As an application of the new technique, we address the classical problem in finance of constructing mean reverting portfolios. We design an efficient online learning algorithm for this problem, and provide guarantees for its performance. We complement our theoretical findings with an empirical study that verifies our theoretical results on financial data.", "histories": [["v1", "Wed, 27 Feb 2013 17:46:43 GMT  (43kb)", "http://arxiv.org/abs/1302.6937v1", "16 pages, 3 figures"], ["v2", "Tue, 10 Jun 2014 07:41:36 GMT  (48kb)", "http://arxiv.org/abs/1302.6937v2", "22 pages, 2 figures"]], "COMMENTS": "16 pages, 3 figures", "reviews": [], "SUBJECTS": "cs.LG", "authors": ["oren anava", "elad hazan", "shie mannor"], "accepted": false, "id": "1302.6937"}, "pdf": {"name": "1302.6937.pdf", "metadata": {"source": "CRF", "title": "Online Learning for Loss Functions with Memory and Applications to Statistical Arbitrage", "authors": ["Oren Anava", "Elad Hazan", "Shie Mannor"], "emails": ["soanava@tx.technion.ac.il", "ehazan@ie.technion.ac.il", "shie@ee.technion.ac.il"], "sections": [{"heading": null, "text": "ar Xiv: 130 2.69 37v1 [cs.LG] 2 7 \u221a T) repentance. This improves previous online learning algorithms that guaranteed O (T 2 / 3) repentance and required stricter conditions. As an application of the new technique, we address the classic financial problem of building portfolios with medium reversal. We design an efficient online learning algorithm for this problem and provide guarantees of its performance. We supplement our theoretical findings with an empirical study that confirms our theoretical results on financial data."}, {"heading": "1 Introduction", "text": "In many online learning processes, the environment is not entirely unknown to policymakers, and policymakers regret their current state and future rewards. We are particularly concerned about scenarios in which this historical effect is relatively short-term and simple. This model was first discussed in information theory, with regard to encryption and encryption applications."}, {"heading": "1.1 Related work", "text": "Statistical arbitrage, and in particular pair trading strategies, originally occurred in the mid-1980s [EG87]. Since then, much has been done on the problem of putting together medium reversal portfolios, mostly using co-integration techniques (see [Vid11] for more comprehensive information).In order to quantify the amount of medium reversal in different portfolios, various proxies are often proposed, such as zero crossing and predictability [Sch11, D'A11].In this work, we consider a new medium reversal proxy aimed at maximizing fluctuation and keeping the mean close to zero. Furthermore, classic co-integration techniques require a familiarization period before applying a trading strategy (see for example [AL10, AM12]), but the online approach does not require that in addition to the performance guarantee against the best medium reversal of the portfolio retrospectively."}, {"heading": "2 Online learning with memory", "text": "Online learning is a game theory optimization framework in which an online player makes a decision he deems necessary and in which he suffers a loss, ft (xt).The loss function ft is chosen by an almighty opponent with full knowledge of our learning algorithm (see, for example, [CBL06]).Here we consider the following expansion. In iterating t, an online player chooses a decision xt, in which K is the decision made. Then, an opponent chooses a loss function ft: Km \u2192 R, and the online player suffers a loss of ft (xt \u2212 m + 1,.., xt).Note that the loss in iterating t depends on the player's previous m \u2212 1 decisions, as well as on his current decision.Our goal within this framework is to minimize the sum of losses over the predefined number of iterations T. A reasonable benchmark is to try not to be much worse than the total loss we have defined by the best decision we have made in retrospect \u2212 T (2)."}, {"heading": "2.1 Algorithm and analysis", "text": "Assuming 3, the functions {gt} Tt = 1 are convex, and therefore we can apply the online gradient descent (OGD) (OGD) algorithm of [Zin03] with some modifications. \u2212 \u2212 \u2212 \u2212 \u2212 \u2212 T with memory 1: Input: Learning rate. 2: Select x1% K at will. 3: for t = 1 to T do 4: Play xt and suffer loss ft (xt \u2212 m + 1,.., xt).5: Set xt + 1% K (xt \u2212 gt (xt)) 6: End forHere, \u0432K is the Euclidean projection on K, i.e.K (y) = argmin x.1The iterations in which t < m are ignored, as we assume that the loss per iteration is limited by a constant."}, {"heading": "3 Application to finance", "text": "In this section, we will use the technique we have just developed to find and exploit statistical arbitrage possibilities. Broadly speaking, the goal is to synthetically create a portfolio with medium reversal, taking advantage of the correlation between similar assets. In other words, we are looking for a strategy that maintains the weights of predefined assets so that the combined portfolio is a medium reversal. In a first step, we will define a criterion for measuring mean reversal, i.e. empirically well behaved behavior. Unfortunately, this criterion is not convex (like most other previously considered criteria), and we will define a semi-defined relaxation to address the problem. Another difficulty arises from the nature of the problem: weights of an iteration affect future performance, so memory inevitably comes into the image.We will continue with the formal definition of the new criterion of mean reversal, its semi-defined relaxation, and the use of our new algorithm for learning memory in this model."}, {"heading": "3.1 Problem definition", "text": "The tendency to return to the mean is not a quantifiable criterion for the mean inversion, and the literature addresses several proxies to grasp the notion of the mean inversion, e.g. in [Sch11, D'A11]. In this thesis, we present a new criterion for the mean inverse effectiveness: low squared mean and high variance. Since short selling is allowed, the norm of x x x x x can be the sum of the prices of n assets at present t, and by xt \u2212 Rn a distribution of weights across these assets (we allow short selling, hence xt can contain negative entries). Since short selling is allowed, the norm of x x x x can be the sum of x values determined by the credit flexibility of the reverse. Thus, we assume that without loss of generality 2 = 1, and define the following loss function: ft (xt \u2212 m \u2212 1,)."}, {"heading": "3.2 Parameter setting", "text": "In this section we use the following parameters and notations: 1. The decision set K is defined as follows: K = {X | X is PSD and Tr (X) = 1}. From this definition we can bind the diameter of K by supX, Y-K, X-Y, X-Y, F-D = \u221a 2, if HQ-F refers to the Frobenius norm. 2. There is G > 0, i.e. sup (xt-m + 1,..., xt), t-ft (xt-m + 1,..., xt). It follows that ft is continuous for the Lipshitz constant G Lipshitz, and also sup Xt, t-t, t-t-ht (Xt) and F-G. The value of G clearly depends on the prices of the assets we consider, and its calculation is done accordingly."}, {"heading": "3.3 Algorithm and analysis", "text": "Algorithm 2 Online Statistical Arbitrage (OSA) 1: Input: Learning Rate \u03b7, X0 = 1nIn \u00b7 n: Randomize x0 \u0445 X0. 3: for t = 1 to (T \u2212 1) do 4: Set Xt \u2190 K (Xt \u2212 1 \u2212 \u03b7) ht (Xt) 5: Set xt = xt \u2212 1 w.p (1 \u2212 1 m) T), 6: Otherwise, Randomize xt. 7: Play xt and suffer loss ft (xt \u2212 m + 1,.,., xt). 8: end forHere refers to the following projection on K (X \u2212 1 m) = arg min Y K X \u2212 Y F. Also xt Xt refers to the eigenvector decomposition of the matrix Xt. mxt, we represent Xt."}, {"heading": "4 Experiments", "text": "The following experiments show the effectiveness of the proposed algorithms under two different settings. In the first setting, we look at the Dow Jones index (30 stocks) and apply our criterion to isolate subsets of stocks that exhibit a maximum degree of medium reversal. In the second setting, we look at pairs of sector-related stocks and apply the proposed algorithm to construct portfolios with medium reversal (\"pairs trading\")."}, {"heading": "4.1 Comparison method", "text": "We compare the amount of the mean inversion of the various portfolios with the Portmanteau test of [LB78]. This test aims to determine whether a process is close to a sound-only process and can therefore be effectively applied in our case as a measure of the mean inversion. More precisely, we define \u2206 t = xTt yt \u2212 xTt \u2212 1yt \u2212 1 as the daily change of our portfolio, and consequently Qm ({t} Tt = 1) = T (T + 2) L \u0445 k = 1 (k) 2 T \u2212 k) as a Portmanteau statistic, whereas (k) = \u2211 T = k + 1 \u0445 t-k \u0445 Tt = 1 \u0445 2 is the sample autocorrelation with delay k, and L is the number of autocorrelation delays (selected to be 20 by default). Under the zero hypothesis, the asymptotic trade distribution of Qm \u2212 square with L-grades is."}, {"heading": "4.2 Data set", "text": "In the first setting, we look at the time series of the daily closing prices of all 30 stocks in the Dow Jones. In the second setting, we look at the time series of the daily closing prices of 8 stock pairs. The selection of the pairs is based on their sector affiliation (finance, energy, telecommunications services, etc.) In both settings, we use data taken from Yahoo! Finance between the date 01 / 01 / 2008 and 01 / 02 / 2013."}, {"heading": "4.3 Isolating mean reverting portfolio", "text": "In this setting, we test our criterion for the Dow Jones index (30 stocks) and isolate subsets of stocks that have a high average yield, which can be done by setting a certain threshold and adding only those stocks with corresponding weights above that threshold to our portfolio. We compare the performance of our criterion for different values of \u03bb (remember that a higher value of \u03bb corresponds to fluctuating portfolios).This setting aims to test the effect of the \u03bb parameter in the proposed criterion. Figure 1 clearly shows that the proposed algorithm generates distributions that mean to reverse portfolios regardless of the value of \u03bb. The significance of the Portmanteau test is clear for all three values in Table 1. Supplementary material contains detailed information on the proposed portfolios for each of the values of \u03bb."}, {"heading": "4.4 Pairs trading", "text": "In this setting, we compare the performance of the proposed algorithm (OSA) with the trading strategy of distributing the weight proportional to the price of the shares (this strategy is called a \"benchmark\"), i.e. we assume that the average prices (over a certain period) of shares A and B are $10 and $20. Then, we would sell two shares of A for every share of B that we buy, or vice versa. We also compare the performance with the offline optimal distribution of weights (this strategy is called \"off-opt\"), which results from our criterion: x = argmin xT; t = m (m \u2212 1 \u00b2 i = 0xT yt \u2212 i) 2 \u2212 p \u00b7 m \u2212 1 \u0432i = 0 (xT yt \u2212 i) 2. In all runs, we use the parameters \u00b2 = 2 and m = 5, which were chosen arbitrarily. In Tables 2 and 3, one can clearly see the advantage of the proposed algorithm (OSA) over the pure benchmark services (pure measurement oils = T and the application of i\u00df)."}, {"heading": "5 Conclusion", "text": "Motivated by financial applications, we have considered the setting of online learning with memory and have developed efficient and asymptotically optimal remorse algorithms for this general setting. Application to the construction of mean reversing instruments will be examined theoretically and empirically. Research directions remain: First, while the proposed algorithm for online learning with memory framework is optimal in the number of T iterations, the optimal dependence on the memory parameter m remains unknown. We suspect that the limit of regret is narrow. Second, it would be interesting to explore the optimal trading strategy in conjunction with a mean reversing portfolio."}], "references": [{"title": "Statistical arbitrage in the US equities market", "author": ["Marco Avellaneda", "Jeong-Hyun Lee"], "venue": "Quantitative Finance,", "citeRegEx": "Avellaneda and Lee.,? \\Q2010\\E", "shortCiteRegEx": "Avellaneda and Lee.", "year": 2010}, {"title": "Optimal portfolio selection in nonlinear arbitrage spreads", "author": ["Hamad Alsayed", "Frank McGroarty"], "venue": "European Journal of Finance,", "citeRegEx": "Alsayed and McGroarty.,? \\Q2012\\E", "shortCiteRegEx": "Alsayed and McGroarty.", "year": 2012}, {"title": "Prediction, learning, and games", "author": ["N. Cesa-Bianchi", "G. Lugosi"], "venue": null, "citeRegEx": "Cesa.Bianchi and Lugosi.,? \\Q2006\\E", "shortCiteRegEx": "Cesa.Bianchi and Lugosi.", "year": 2006}, {"title": "Identifying small mean-reverting portfolios", "author": ["Alexandre D\u2019Aspremont"], "venue": "Quant. Finance,", "citeRegEx": "D.Aspremont.,? \\Q2011\\E", "shortCiteRegEx": "D.Aspremont.", "year": 2011}, {"title": "Co-Integration and Error Correction: Representation, Estimation, and Testing", "author": ["Robert F. Engle", "C.W.J. Granger"], "venue": null, "citeRegEx": "Engle and Granger.,? \\Q1987\\E", "shortCiteRegEx": "Engle and Granger.", "year": 1987}, {"title": "Pairs trading: performance of a relative-value arbitrage", "author": ["Evan Gatev", "William N. Goetzmann", "K. Geert Rouwenhorst"], "venue": "Review of Financial Studies,", "citeRegEx": "Gatev et al\\.,? \\Q1999\\E", "shortCiteRegEx": "Gatev et al\\.", "year": 1999}, {"title": "Dynamic portfolio selection in arbitrage", "author": ["J. Jurek", "H. Yang"], "venue": "SSRN eLibrary,", "citeRegEx": "Jurek and Yang.,? \\Q2006\\E", "shortCiteRegEx": "Jurek and Yang.", "year": 2006}, {"title": "On a measure of lack of fit in time series models", "author": ["G.M. Ljung", "G.E.P. Box"], "venue": null, "citeRegEx": "Ljung and Box.,? \\Q1978\\E", "shortCiteRegEx": "Ljung and Box.", "year": 1978}, {"title": "On sequential strategies for loss functions with memory", "author": ["N. Merhav", "E. Ordentlich", "G. Seroussi", "M.J. Weinberger"], "venue": "IEEE Trans. Inf. Theor.,", "citeRegEx": "Merhav et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Merhav et al\\.", "year": 2006}, {"title": "Financial Markets and Trading: An Introduction to Market Microstructure and Trading Strategies (Wiley Finance). Wiley, 1 edition", "author": ["Anatoly B. Schmidt"], "venue": null, "citeRegEx": "Schmidt.,? \\Q2011\\E", "shortCiteRegEx": "Schmidt.", "year": 2011}, {"title": "Pairs Trading: Quantitative Methods and Analysis", "author": ["G. Vidyamurthy"], "venue": "Wiley Finance. Wiley,", "citeRegEx": "Vidyamurthy.,? \\Q2011\\E", "shortCiteRegEx": "Vidyamurthy.", "year": 2011}, {"title": "Markov decision processes with arbitrary reward processes", "author": ["Jia Yuan Yu", "Shie Mannor", "Nahum Shimkin"], "venue": "Math. Oper. Res.,", "citeRegEx": "Yu et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Yu et al\\.", "year": 2009}, {"title": "Online convex programming and generalized infinitesimal gradient ascent", "author": ["M. Zinkevich"], "venue": "In ICML,", "citeRegEx": "Zinkevich.,? \\Q2003\\E", "shortCiteRegEx": "Zinkevich.", "year": 2003}], "referenceMentions": [], "year": 2017, "abstractText": "In many online learning scenarios the loss functions are not memoryless, but rather depend on history. Our first contribution is a complete characterization of sufficient and necessary conditions for learning with memory, accompanied with a novel algorithm for this framework that attains the optimal O( \u221a T )-regret. This improves previous online learning algorithms that guaranteed O(T ) regret and required more stringent conditions. As an application of the new technique, we address the classical problem in finance of constructing mean reverting portfolios. We design an efficient online learning algorithm for this problem, and provide guarantees for its performance. We complement our theoretical findings with an empirical study that verifies our theoretical results on financial data.", "creator": "LaTeX with hyperref package"}}}