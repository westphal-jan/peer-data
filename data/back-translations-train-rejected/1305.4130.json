{"id": "1305.4130", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "17-May-2013", "title": "Belief Propagation for Linear Programming", "abstract": "Belief Propagation (BP) is a popular, distributed heuristic for performing MAP computations in Graphical Models. BP can be interpreted, from a variational perspective, as minimizing the Bethe Free Energy (BFE). BP can also be used to solve a special class of Linear Programming (LP) problems. For this class of problems, MAP inference can be stated as an integer LP with an LP relaxation that coincides with minimization of the BFE at ``zero temperature\". We generalize these prior results and establish a tight characterization of the LP problems that can be formulated as an equivalent LP relaxation of MAP inference. Moreover, we suggest an efficient, iterative annealing BP algorithm for solving this broader class of LP problems. We demonstrate the algorithm's performance on a set of weighted matching problems by using it as a cutting plane method to solve a sequence of LPs tightened by adding ``blossom'' inequalities.", "histories": [["v1", "Fri, 17 May 2013 16:40:43 GMT  (176kb,D)", "http://arxiv.org/abs/1305.4130v1", "To appear in ISIT 2013"]], "COMMENTS": "To appear in ISIT 2013", "reviews": [], "SUBJECTS": "cs.AI cs.DS", "authors": ["andrew gelfand", "jinwoo shin", "michael chertkov"], "accepted": false, "id": "1305.4130"}, "pdf": {"name": "1305.4130.pdf", "metadata": {"source": "CRF", "title": "Belief Propagation for Linear Programming", "authors": ["Andrew E. Gelfand", "Jinwoo Shin", "Michael Chertkov"], "emails": ["agelfand@ics.uci.edu", "jshin@us.ibm.com", "chertkov@lanl.gov"], "sections": [{"heading": null, "text": "In this context, it should be noted that this project is a project, which is a project that is primarily a project, which is a project that is primarily a project."}, {"heading": "II. PRELIMINARIES", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A. Graphical Model", "text": "Let Z = [Zi] be a collection of n random variables, each of which takes values in a finite alphabet Zi = zi. Let the common probability distribution of the Z factor flow into a product of real, positive functions, where z\u03b1 = [zi: i-Q] each defines Xiv: 130 5.41 30v1 [cs.AI] 17 May 201 3 via a subset of variables: Pr [Z = z]. The MAP assignment z is defined as: z-Q-Q-Q-Q-Q (z\u03b1), where z\u03b1 = [zi: i-Q] the arguments of the factor \u03b1. z is called a valid assignment when Pr [Z = z] > 0 x-P is defined."}, {"heading": "C. Bethe Free Energy and BPLP", "text": "Faith (BP) is an approximate computational marginal algorithm that works by sending messages along the edges of the factor chart. We describe the algorithm for the GM in (3). Messages from factor node j to variable node i are called mji and messages in the opposite direction are called mij. Messages are updated as follows: for each xi xi (1), mji (xi), mji (xi) xi (xi) where we have introduced (called) a parameter T > 0. (xSj) s: Any factor or variable node in the factor chart is associated with a faith bj (xSj)."}, {"heading": "III. EQUIVALENCE BETWEEN LP AND BPLP", "text": "Now we give the main result of the paper.Theorem II.1. For each (fixed) j applies: \u2022 If Pj has only 0-1 integral vertices (i.e. extreme points) for all j, then LP \u2264 BPLP. \u2022 LP \u2265 BPLP (without any conditions). Theorem IIII.1 implies the following corollar.Korollar.Korollar.III.2. If Aji is for all i, j, then LP = BPLP.Proof: Korollar.III.1 and the fact that each vertex of a polyp can be expressed as a unique solution for a \"facial system\" (see e.g. [20].Note that the condition of corridor III.1 and the fact that each vertex of a polyp can be described as unique."}, {"heading": "A. Proof for LP \u2264 BPLP", "text": "Here we prove that if x = [xi] meets the constraints of LP (5), normalized beliefs exist, so that [bi (1)] = [xi], [bi (0)] = [1 \u2212 xi] and {bi, bj] meet the constraints of BPLP. Starting from the condition of theorem III.1, the polytopic Pj has only 0-1 integral vertices. Then, according to Carathe's odor theorem [21], any point [xi] in the polytopic can be expressed as a convex combination of 0-1 vertibles, with coefficients corresponding to values of {bj} in the convex combination and bi (0) and bi (1) in the description of the BPLP polytope corresponding to variables 1 \u2212 xi and xi in the LP polytope, respectively."}, {"heading": "B. Proof for LP \u2265 BPLP", "text": "Here we prove that if {bi, bj} fulfills the constraints of the BPLP, then [xi = bi (1)] also fulfills the constraints of the LP. As mentioned above, bi (0) is redundant as bi (0) = 1 \u2212 bi (1) within the BPLP polytope, from which we derive [i] Sj Ajixi = [i] Sj Aji-xSj: xi = 1bj (xSj) = [i] Sj Aji-xSj-xibj (xSj) = [i] Sj-Sj Ajixi-bj (xSj) \u2264 xSj-djbj (xSj) = dj-xSj (xSj) = dj, where (10) was used in the inequality level."}, {"heading": "IV. ANNEALING BP FOR SOLVING LPS", "text": "In this section we propose the following annealing version of BP as LP solver: mt + 1ji (xi) \u2190 m ji (xi) 1 \u2212 \u03b1t \u00b2 xSj (xSj) 1 \u2212 \u03b1t exp (\u03b1tci Tt xi) 1 \u2212 k Ei\\ j mtki (xi) \u03b1tmt + 1j (xSj) 1 / Tt \u00b2 e (xi) 1 \u2212 \u03b1t exp (\u03b1tci Tt xi) 1 \u2212 k Ei\\ j (xi) \u03b1tbt + 1j (xSj) 1 (xSj) 1 / Tt \u00b2 e (xSj) 1 \u2212 p (xi) bt + 1i (xi).exp (ci Tt xi).S mtki (xi) where (0, 1], Tt > 0, mtij, mtji, btj, btj, btj, bti."}, {"heading": "V. EXPERIMENTS WITH MATCHINGS", "text": "In this section, we show that BP annealing with sufficient attenuation can be used to perform sequential LP relaxations on the weighted matching problem in Section II-D. We point out that our approach here differs from previous work on solving the weighted matching problem using BP because we look at the sum product shape of BP. Work in [5], [6] shows that the maximum product BP approaches the MAP solution (and thus finds the maximum weight match) when the relaxation at the matching ILP without flowers is tight. However, if this LP is not tight, the maximum product is not converted. The connection between BPLP and LP made in the previous section tells us that the MAP solution of the LP corresponds to flowers (i.e. m-bl-LP). We show that an annealed summary product BP can be used to solve the bl-LP."}], "references": [{"title": "Constructing free-energy approximations and generalized belief propagation algorithms,", "author": ["J. Yedidia", "W. Freeman", "Y. Weiss"], "venue": "Info. Theory, IEEE Trans. on,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2005}, {"title": "Modern Coding Theory", "author": ["T.J. Richardson", "R.L. Urbanke"], "venue": "Cambridge University Press", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2008}, {"title": "Information", "author": ["M. Mezard", "A. Montanari"], "venue": "physics, and computation, ser. Oxford Graduate Texts. Oxford: Oxford Univ. Press", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2009}, {"title": "Graphical models", "author": ["M.J. Wainwright", "M.I. Jordan"], "venue": "exponential families, and variational inference,\u201d Foundations and Trends in Machine Learning, vol. 1, no. 1, pp. 1\u2013305", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2008}, {"title": "Max-product for maximum weight matching: Convergence, correctness, and lp duality,", "author": ["M. Bayati", "D. Shah", "M. Sharma"], "venue": "Info. Theory, IEEE Trans. on,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2008}, {"title": "Belief propagation and lp relaxation for weighted matching in general graphs,", "author": ["S. Sanghavi", "D. Malioutov", "A. Willsky"], "venue": "Info. Theory, IEEE Trans. on,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2011}, {"title": "and Y", "author": ["D. Gamarnik", "D. Shah"], "venue": "Wei, \u201cBelief propagation for min-cost network flow: convergence & correctness,\u201d in SODA", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2010}, {"title": "Exactness of belief propagation for some graphical models with loops,", "author": ["M. Chertkov"], "venue": "Journal of Statistical Mechanics: Theory and Experiment,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2008}, {"title": "Using linear programming to decode binary linear codes,", "author": ["J. Feldman", "M. Wainwright", "D. Karger"], "venue": "Info. Theory, IEEE Trans. on,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2005}, {"title": "Towards low-complexity linearprogramming decoding,", "author": ["P.O. Vontobel", "R. Koetter"], "venue": "6th International ITG-Conference on Source and Channel Coding,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2006}, {"title": "An efficient pseudocodeword search algorithm for linear programming decoding of LDPC codes,", "author": ["M. Chertkov", "M. Stepanov"], "venue": "Info. Theory, IEEE Trans. on,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2008}, {"title": "and M", "author": ["A. Dimakis", "A. Gohari"], "venue": "Wainwright, \u201cGuessing facets: Polytope structure and improved lp decoder,\u201d Info. Theory, IEEE Trans. on, vol. 55, no. 8, pp. 3479 \u20133487", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2009}, {"title": "Convex relaxation methods for graphical models: Lagrangian and maximum entropy approaches,", "author": ["J. Johnson"], "venue": "Ph.D. dissertation, MIT, Department of Electrical Engineering and Computer Science,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2008}, {"title": "Approximate inference in graphical models using lp relaxations,", "author": ["D. Sontag"], "venue": "Ph.D. dissertation, MIT, Department of Electrical Engineering and Computer Science,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2010}, {"title": "and M", "author": ["S. Kudekar", "J.K. Johnson"], "venue": "Chertkov, \u201cImproved linear programming decoding using frustrated cycles,\u201d CoRR, vol. abs/1105.4665", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2011}, {"title": "and S", "author": ["K. Chandrasekaran", "L.A. V\u00e9gh"], "venue": "Vempala, \u201cThe cutting plane method is polynomial for perfect matchings,\u201d CoRR, vol. abs/1207.5813", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2012}, {"title": "Factor graphs and the sum-product algorithm,", "author": ["F. Kschischang", "B. Frey", "H.-A. Loeliger"], "venue": "Info. Theory, IEEE Trans. on,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2001}, {"title": "Paths", "author": ["J. Edmonds"], "venue": "trees, and flowers,\u201d Canadian Journal of mathematics, vol. 17, no. 3, pp. 449\u2013467", "citeRegEx": "19", "shortCiteRegEx": null, "year": 1965}, {"title": "Combinatorial Optimization : Polyhedra and Efficiency (Algorithms and Combinatorics)", "author": ["A. Schrijver"], "venue": null, "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2004}, {"title": "Map estimation", "author": ["Y. Weiss", "C. Yanover", "T. Meltzer"], "venue": "linear programming, and belief propagation with convex free energies,\u201d in UAI", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2007}, {"title": "Cccp algorithms to minimize the bethe and kikuchi free energies: Convergent alternatives to belief propagation,", "author": ["A.L. Yuille"], "venue": "Neural Computation,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2002}, {"title": "and A", "author": ["S. Sanghavi", "D. Shah"], "venue": "Willsky, \u201cMessage-passing for max-weight independent set,\u201d in NIPS", "citeRegEx": "24", "shortCiteRegEx": null, "year": 2007}], "referenceMentions": [{"referenceID": 0, "context": "Graphical Models (GMs) provide a useful representation for reasoning in a range of scientific fields [1], [2], [3], [4].", "startOffset": 101, "endOffset": 104}, {"referenceID": 1, "context": "Graphical Models (GMs) provide a useful representation for reasoning in a range of scientific fields [1], [2], [3], [4].", "startOffset": 106, "endOffset": 109}, {"referenceID": 2, "context": "Graphical Models (GMs) provide a useful representation for reasoning in a range of scientific fields [1], [2], [3], [4].", "startOffset": 111, "endOffset": 114}, {"referenceID": 3, "context": "Graphical Models (GMs) provide a useful representation for reasoning in a range of scientific fields [1], [2], [3], [4].", "startOffset": 116, "endOffset": 119}, {"referenceID": 4, "context": "This inspiring result was shown for GMs in which well known optimization problems - namely, the matching problem [5], [6] and min-cost network flow problem [7] - were posed as MAP inference tasks.", "startOffset": 113, "endOffset": 116}, {"referenceID": 5, "context": "This inspiring result was shown for GMs in which well known optimization problems - namely, the matching problem [5], [6] and min-cost network flow problem [7] - were posed as MAP inference tasks.", "startOffset": 118, "endOffset": 121}, {"referenceID": 6, "context": "This inspiring result was shown for GMs in which well known optimization problems - namely, the matching problem [5], [6] and min-cost network flow problem [7] - were posed as MAP inference tasks.", "startOffset": 156, "endOffset": 159}, {"referenceID": 4, "context": "When the weighted matching problem is formulated as a MAP inference task, BPLP is equivalent to the relaxed matching ILP - explaining the success of BP in these GMs [5], [6], [8]! The connection between LP relaxations and BPLP (also called LPdecoding) has also been discussed in the coding literature [9], [10], [11], [12], [13].", "startOffset": 165, "endOffset": 168}, {"referenceID": 5, "context": "When the weighted matching problem is formulated as a MAP inference task, BPLP is equivalent to the relaxed matching ILP - explaining the success of BP in these GMs [5], [6], [8]! The connection between LP relaxations and BPLP (also called LPdecoding) has also been discussed in the coding literature [9], [10], [11], [12], [13].", "startOffset": 170, "endOffset": 173}, {"referenceID": 7, "context": "When the weighted matching problem is formulated as a MAP inference task, BPLP is equivalent to the relaxed matching ILP - explaining the success of BP in these GMs [5], [6], [8]! The connection between LP relaxations and BPLP (also called LPdecoding) has also been discussed in the coding literature [9], [10], [11], [12], [13].", "startOffset": 175, "endOffset": 178}, {"referenceID": 8, "context": "When the weighted matching problem is formulated as a MAP inference task, BPLP is equivalent to the relaxed matching ILP - explaining the success of BP in these GMs [5], [6], [8]! The connection between LP relaxations and BPLP (also called LPdecoding) has also been discussed in the coding literature [9], [10], [11], [12], [13].", "startOffset": 301, "endOffset": 304}, {"referenceID": 9, "context": "When the weighted matching problem is formulated as a MAP inference task, BPLP is equivalent to the relaxed matching ILP - explaining the success of BP in these GMs [5], [6], [8]! The connection between LP relaxations and BPLP (also called LPdecoding) has also been discussed in the coding literature [9], [10], [11], [12], [13].", "startOffset": 306, "endOffset": 310}, {"referenceID": 10, "context": "When the weighted matching problem is formulated as a MAP inference task, BPLP is equivalent to the relaxed matching ILP - explaining the success of BP in these GMs [5], [6], [8]! The connection between LP relaxations and BPLP (also called LPdecoding) has also been discussed in the coding literature [9], [10], [11], [12], [13].", "startOffset": 312, "endOffset": 316}, {"referenceID": 11, "context": "When the weighted matching problem is formulated as a MAP inference task, BPLP is equivalent to the relaxed matching ILP - explaining the success of BP in these GMs [5], [6], [8]! The connection between LP relaxations and BPLP (also called LPdecoding) has also been discussed in the coding literature [9], [10], [11], [12], [13].", "startOffset": 324, "endOffset": 328}, {"referenceID": 12, "context": "It provides a practical certificate of exactness/integrality for MAP inference when using BP and has also suggested strategies for improving upon BP\u2019s results, by adding constraints that reduce the BPLP integrality gap [14], [15], [16].", "startOffset": 219, "endOffset": 223}, {"referenceID": 13, "context": "It provides a practical certificate of exactness/integrality for MAP inference when using BP and has also suggested strategies for improving upon BP\u2019s results, by adding constraints that reduce the BPLP integrality gap [14], [15], [16].", "startOffset": 225, "endOffset": 229}, {"referenceID": 14, "context": "It provides a practical certificate of exactness/integrality for MAP inference when using BP and has also suggested strategies for improving upon BP\u2019s results, by adding constraints that reduce the BPLP integrality gap [14], [15], [16].", "startOffset": 231, "endOffset": 235}, {"referenceID": 4, "context": "We extend the work in [5], [6] by empirically demonstrating that annealing BP can be used to solve LP-relaxations to the weighted matching problems requiring Edmonds\u2019 blossom inequalities.", "startOffset": 22, "endOffset": 25}, {"referenceID": 5, "context": "We extend the work in [5], [6] by empirically demonstrating that annealing BP can be used to solve LP-relaxations to the weighted matching problems requiring Edmonds\u2019 blossom inequalities.", "startOffset": 27, "endOffset": 30}, {"referenceID": 15, "context": "If coupled with the method for finding a tight LP relaxation of \u2018polynomial\u2019 size in [17], annealing BP could be used in a novel, distributed approximation algorithm for the weighted matching problem.", "startOffset": 85, "endOffset": 89}, {"referenceID": 16, "context": "A Graphical Model (GM) represents the above factorization using a bi-partite graph, known as a Factor Graph [18], where each factor \u03b1 \u2208 F is connected to the variables in its argument.", "startOffset": 108, "endOffset": 112}, {"referenceID": 0, "context": "BP for the GM in (3) can be interpreted as a variational optimization procedure in which the messages and beliefs minimize the Bethe Free Energy (BFE) functional [1]", "startOffset": 162, "endOffset": 165}, {"referenceID": 0, "context": "It is known [1] that if BP converges, it finds a minimum (possibly local) of the BFE.", "startOffset": 12, "endOffset": 15}, {"referenceID": 0, "context": "The straightforward LP relaxation of m-ILP is formed by replacing xe \u2208 {0, 1} by xe \u2208 [0, 1].", "startOffset": 86, "endOffset": 92}, {"referenceID": 17, "context": "The LP can be made tight, as famously shown by Edmonds [19], by adding a set of blossom inequalities: m-bl-LP : max \u2211 e\u2208E wexe (13) s.", "startOffset": 55, "endOffset": 59}, {"referenceID": 0, "context": "\u2211 e\u2208\u03b4(i) xe \u2264 1, \u2200i \u2208 V \u2211 e\u2208E(S) xe \u2264 |S|\u22121 2 , \u2200S \u2208 S xe \u2208 [0, 1].", "startOffset": 60, "endOffset": 66}, {"referenceID": 18, "context": "[20].", "startOffset": 0, "endOffset": 4}, {"referenceID": 19, "context": "To overcome both issues, one can use a convex modification of the BFE function [22], and the known convergent variant to BP (providing sufficient damping), called CCCP, to find its minimum [23].", "startOffset": 79, "endOffset": 83}, {"referenceID": 20, "context": "To overcome both issues, one can use a convex modification of the BFE function [22], and the known convergent variant to BP (providing sufficient damping), called CCCP, to find its minimum [23].", "startOffset": 189, "endOffset": 193}, {"referenceID": 4, "context": "Support for natural message initialization comes from [5], [6], [7], [24], where for certain GMs the natural initial messages are needed to prevent BP from converging to an undesirable fixed point.", "startOffset": 54, "endOffset": 57}, {"referenceID": 5, "context": "Support for natural message initialization comes from [5], [6], [7], [24], where for certain GMs the natural initial messages are needed to prevent BP from converging to an undesirable fixed point.", "startOffset": 59, "endOffset": 62}, {"referenceID": 6, "context": "Support for natural message initialization comes from [5], [6], [7], [24], where for certain GMs the natural initial messages are needed to prevent BP from converging to an undesirable fixed point.", "startOffset": 64, "endOffset": 67}, {"referenceID": 21, "context": "Support for natural message initialization comes from [5], [6], [7], [24], where for certain GMs the natural initial messages are needed to prevent BP from converging to an undesirable fixed point.", "startOffset": 69, "endOffset": 73}, {"referenceID": 4, "context": "The work in [5], [6] demonstrated that max-product BP will converge to the MAP solution (and therefore find the maximum weight matching) if the relaxation to the matching ILP without blossoms is tight.", "startOffset": 12, "endOffset": 15}, {"referenceID": 5, "context": "The work in [5], [6] demonstrated that max-product BP will converge to the MAP solution (and therefore find the maximum weight matching) if the relaxation to the matching ILP without blossoms is tight.", "startOffset": 17, "endOffset": 20}], "year": 2013, "abstractText": "Belief Propagation (BP) is a popular, distributed heuristic for performing MAP computations in Graphical Models. BP can be interpreted, from a variational perspective, as minimizing the Bethe Free Energy (BFE). BP can also be used to solve a special class of Linear Programming (LP) problems. For this class of problems, MAP inference can be stated as an integer LP with an LP relaxation that coincides with minimization of the BFE at \u201czero temperature\u201d. We generalize these prior results and establish a tight characterization of the LP problems that can be formulated as an equivalent LP relaxation of MAP inference. Moreover, we suggest an efficient, iterative annealing BP algorithm for solving this broader class of LP problems. We demonstrate the algorithm\u2019s performance on a set of weighted matching problems by using it as a cutting plane method to solve a sequence of LPs tightened by adding \u201cblossom\u201d inequalities.", "creator": "LaTeX with hyperref package"}}}