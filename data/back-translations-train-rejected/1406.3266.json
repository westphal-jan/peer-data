{"id": "1406.3266", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "12-Jun-2014", "title": "Event and Anomaly Detection Using Tucker3 Decomposition", "abstract": "Failure detection in telecommunication networks is a vital task. So far, several supervised and unsupervised solutions have been provided for discovering failures in such networks. Among them unsupervised approaches has attracted more attention since no label data is required. Often, network devices are not able to provide information about the type of failure. In such cases the type of failure is not known in advance and the unsupervised setting is more appropriate for diagnosis. Among unsupervised approaches, Principal Component Analysis (PCA) is a well-known solution which has been widely used in the anomaly detection literature and can be applied to matrix data (e.g. Users-Features). However, one of the important properties of network data is their temporal sequential nature. So considering the interaction of dimensions over a third dimension, such as time, may provide us better insights into the nature of network failures. In this paper we demonstrate the power of three-way analysis to detect events and anomalies in time-evolving network data.", "histories": [["v1", "Thu, 12 Jun 2014 15:33:11 GMT  (427kb,D)", "http://arxiv.org/abs/1406.3266v1", null]], "reviews": [], "SUBJECTS": "cs.AI", "authors": ["hadi fanaee-t", "m\\'arcia d b oliveira", "jo\\~ao gama", "simon malinowski", "ricardo morla"], "accepted": false, "id": "1406.3266"}, "pdf": {"name": "1406.3266.pdf", "metadata": {"source": "CRF", "title": "Event and Anomaly Detection Using Tucker3 Decomposition", "authors": ["Hadi Fanaee-T", "M\u00e1rcia Oliveira", "Jo\u00e3o Gama", "Simon Malinowski", "Ricardo Morla"], "emails": ["hadi.fanaee@fe.up.pt", "marcia@liaad.up.pt", "jgama@fep.up.pt", "sjfm@inescporto.pt", "ricardo.morla@inescporto.pt"], "sections": [{"heading": null, "text": "Keywords: Event Detection, Anomaly Detection, Tensor decomposition, Tucker3 Citation: Hadi Fanaee-T et al., Event and Anomaly detection using Tucker3 Decom-position, In Proceedings of 20th European Conference on Artificial Intelligence (ECAI '2013) Ubiquitous Data Mining Workshop, pp. 8-12, vol. 1, 27 to 31 August 2012, Montpellier, France."}, {"heading": "1 Introduction", "text": "Event detection can be briefly described as the task of detecting unusual behavior of a system during a certain period of time. On the other hand, anomaly detection 1LIAAD-INESC TEC, FEUP-University of Porto, hadi.fanaee @ fe.up.pt 2LIAAD-INESC TEC, FEP-University of Porto, marcia @ liaad.up.pt 3LIAAD-INESC TEC, FEP-University of Porto, jgama @ fep.up.pt 4INESC TEC, FEUP-University of Porto, sjfm @ inescporto.pt 5INESC TEC, FEUP-University of Porto, ricardo.morla @ inescporto.ptar Xiv: 140 6.32 66v1 [cs.AI] 12 juconcentrates on detecting abnormal points. So clearly it is different from event detection as it only takes into account the points, as a group of points considered by the individual work of the two steps."}, {"heading": "1.1 Anomaly Detection", "text": "Anomaly is a pattern in the data that does not correspond to the expected behavior [2]. The detection of anomalies has a wide range of applications in the detection of computer networks, medical informatics and the detection of credit card fraud. A considerable amount of research has been devoted to solving this problem, but our focus is on unattended methods. Anomaly detection techniques can be divided into five groups [2]: classification-based, cluster-based, closest, statistical methods, information theory methods and spectral methods. On the basis of this classification, our method is classified into the group of spectral methods. These approaches first break down the high-dimensional data into a lower dimensional space and then assume that normal and abnormal data points differ significantly from each other. This advantage: 1) They can be used in both unattended and supervised settings. 2) You can detect anomalies manually in high-dimensional data (as opposed to cluster data) and not request them in cluster data (3)."}, {"heading": "1.2 Event Detection", "text": "Due to the enormous amount of sequential data generated by sensors, event detection has become an emerging problem with multiple applications in the real world. Event is a significant event or pattern that is unusual compared to the normal behavior patterns of a system [3]. These can be natural phenomena or manual system interaction. Some examples of events can include an attack on the network, bioterrorist activities, epidemics, damage to an airplane, ruptured pipes, forest fires, etc. A real system behaves normally most of the time until an anomaly occurs that can cause damage to the system. As the effects of an event are a priori not known in the system, detecting and characterizing abnormal events is a challenge. This is why we cannot evaluate different algorithms most of the time. One solution could be the injection of artificial events into the normal data. However, as the construction of a realistic event pattern is not trivial [6]."}, {"heading": "1.3 Hidden Markov Models", "text": "Hidden Markov models (HMMs) have been used for at least the last three decades in signal processing, especially in the field of speech recognition, and have also been used in many other fields such as bioinformatics (e.g. biological sequence analysis), environmental studies (e.g. earthquake and wind detection), and finance (financial time series). HMMs have become popular for their simplicity and general mathematical tractability [11]. HMMs are often used to describe complex probability distributions in time series and are well adapted to model time dependencies in such series. HMMs assume that the observation distribution does not follow a normal distribution and is generated by various processes. Each process depends on the state of an underlying and unobserved Markov process [6]. Markov process describes this property that, given the value Xt, the values of Xn, n t, do not depend on the probability of observation."}, {"heading": "1.4 Three-way data analysis", "text": "Traditional data analysis techniques such as PCA, clustering, regression, etc. are only able to model two-dimensional data and do not take into account the interaction between more than two dimensions. However, in several real phenomena there is a mutual relationship between more than two dimensions (e.g. a 3D tensor (user \u00d7 characteristics \u00d7 time)) and therefore they should be analyzed from a three-dimensional perspective. Three-way analyses take into account all interdependencies between the different dimensions and provide a compact representation of the original tensor in low-dimensional spaces. The most common three-dimensional analysis models are Tucker2, Tucker3 and PARAFAC [4], which are generalized versions of a two-mode main component model or, more precisely, SVD."}, {"heading": "1.4.1 Tucker3 Model", "text": "The Tucker3 model splits a three-mode tensor X into a series of component matrices A, B, C and a small core tensor G. The following mathematical equation shows the decomposition: Xijk'P \u2211 p = 1 Q \u2211 q = 1 R \u2211 r = 1 Gpqr \u00b7 aip \u00b7 bjq \u00b7 ckr (1) where P, Q and R are parameters of the Tucker3 model and represent the number of components maintained in the first, second and third modes of the tensor. This decomposition is illustrated in Figure 1."}, {"heading": "2 Problem definition", "text": "One of the most significant problems in telecommunications systems, such as IP / TV, is detection of anomalies at both network and user levels. To investigate this, target users are typically equipped with a device in their modem that sends an automatic notification message to the central server when the connection of a client on the network is lost or restored. These modems are ubiquitous and geographically dispersed; modeling such behavior is not easy because the number of notification messages during the period of analysis is not the same for each user. For example, a user may face 40 connection problems within an hour, generating 40 messages, while others may have 5 or even no problems at all. By default, detection problems occur, for each time there is a measurement via one or more sensors. In the context of our application, such measurements do not take place at regular time points, as user modems (or sensors) only send messages to a server when two unexpected problems occur."}, {"heading": "3 Data set", "text": "The raw data set contains the user notification messages on each line including their occurrences. As already mentioned, it is not possible to use this data directly in our modeling approach, so some pre-processing steps have been performed. In addition to the obtained HMM parameters for each hour and for each user, we have added additional features such as mean, variance, entropy and number of messages per hour to our feature vector. We have created two separate data sets, each of which spans a period of one month, corresponding to 720 hours. In one set we selected 102 users from and in another 909 users, the latter dataset being an extended version of the former. We then transformed both data sets into the record format. These data sets are displayed in a format of Tucker3 input sensor (Figure 1) in Table 2, where I, J, K represent users, features or hour modes."}, {"heading": "4 Experiments", "text": "This section is divided into three subsections according to the steps mentioned in the Introduction section. In subsection 1, we explain how to recognize abnormal users. In the next subsection, we describe how to create user trajectories. In the last subsection, we explain how to cluster the trajectories using hierarchical clustering and recognize events using user trajectories."}, {"heading": "4.1 Abnormal Users", "text": "We applied Tucker3 model to both datasets X102 and X909 by specifying a MATLAB package for three components Q for only three components of the PCA, which we call three-mode component analysis (Tucker3) [4]. Prior to this, we performed ANOVA test [4] to see the importance of three-way and two-way interaction in the data. Results of this test are presented in Table 3. ANOVAMax 2D represents the maximum value achieved by various combinations of two-way models (e.g. I-J, J-K, I-K, I-K, I-K). Larger numbers are obtained for three-dimensional interaction (ANOVA 3D), which shows that there is a mutual interaction between the three dimensions in both datasets, which is better with three-way modeling such as Tucker3, than with two-way modeling such as we do, with two-way modeling such as we do, with two-way modeling 1. The next step is A.P Equation."}, {"heading": "4.2 User Trajectories", "text": "Visualization methods such as those we have presented in Figure 3 are not able to show the evolving behavior of users over time. We need another solution to understand the behavior of users over time. One solution is to project users onto a decomposed attribute space (matrix B of Figure 1) for each time. However, since both of our selected parameters Q have equal to 2, this means that after designing the user on attribute space we must have a coordinate of (x, y) for each time and for each user. The process of generating these coordinates is shown in Figure 4. B (: 1) and B (: 2), the two components representing the original entities of attribute mode and X represent the three-order tensor (see Figure 1). The rows of the front matrix are the users corresponding to the characteristics, and the third mode (the hours) represents the three-order tensor."}, {"heading": "4.3 Event Detection from user trajectories", "text": "Although user histories can be useful if the number of users is too large, the individual analysis of each track can become a cumbersome task. If we notice that a group of user histories behave similarly, this can be understood as something abnormal on their network level. Then, some prevention or monitoring operations can be performed more quickly. To explore this goal, we used agglomerative hierarchical clustering toolbox from MATLAB to cluster user histories. We defined the Euclidean distance between each point in the histories as our removal function and Ward's criterion as a linkage criterion. We tested different values of disabling from 0.6 to 1.2 to examine the cluster structure. The most suitable cluster structure was defined for a distance of 1 that cuts the tree to a level corresponding to these three clusters."}, {"heading": "5 Conclusion and Future works", "text": "Our results suggest that Tucker3 is a robust method for detecting abnormal users in situations where there are interactions between the three dimensions.From the decomposition of the tensor, we can define user histories, and the histories allow us to observe the behavior of these users over time. We were able to identify two types of abnormal users: those that exhibit frequent abnormal behavior over the entire period, and those that are associated with one or a few severe abnormal behaviors over the time.Without recourse to analyzing the time histories of the user, it would have been more difficult to detect such facts. In addition, we have identified three events from the clusters of user histories that occurred over three time periods on the network.The result of this work can be used in a real network monitoring system to identify errors in the quickest times.In this work, we did not consider the spatial relationship between users and other users."}], "references": [{"title": "A novel pcabased network anomaly detection", "author": ["C. Callegari", "L. Gazzarrini", "S. Giordano", "M. Pagano", "T. Pepe"], "venue": "In Communications (ICC),", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2011}, {"title": "Anomaly detection: A survey", "author": ["V. Chandola", "A. Banerjee", "V. Kumar"], "venue": "ACM Computing Surveys (CSUR)", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2009}, {"title": "Three-way component analysis: Principles and illustrative application", "author": ["H.A. Kiers", "I.V. Mechelen"], "venue": "Psychological methods", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2001}, {"title": "A tutorial on hidden markov models and selected applications in speech recognition", "author": ["L. Rabiner"], "venue": "Proceedings of the IEEE", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 1989}, {"title": "Wavelet-based monitoring in modern biosurveillance", "author": ["G. Shmueli"], "venue": "Technical Report RHS-06-002, Robert H. Smith School", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2005}, {"title": "A novel anomaly detection scheme based on principal component classifier", "author": ["Shyu", "M.-L", "S.-C. Chen", "K. Sarinnapakorn", "L. Chang"], "venue": null, "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2003}, {"title": "A revealing introduction to hidden markov models", "author": ["M. Stamp"], "venue": "http://www. cs.sjsu.edu/faculty/stamp/RUA/HMM. [Online; accessed March", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2004}, {"title": "Identifying intrusions in computer networks with principal component analysis", "author": ["W. Wang", "R. Battiti"], "venue": "In Availability, Reliability and Security,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2006}, {"title": "A novel intrusion detection method based on principle component analysis in computer security", "author": ["W. Wang", "X. Guan", "X. Zhang"], "venue": "In Advances in Neural Networks-ISNN", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2004}, {"title": "Hidden Markov models for time series: an introduction using R", "author": ["W. Zucchini", "I.L. MacDonald"], "venue": null, "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2009}], "referenceMentions": [{"referenceID": 1, "context": "Anomaly is as a pattern in the data that does not conform to the expected behavior [2].", "startOffset": 83, "endOffset": 86}, {"referenceID": 1, "context": "Anomaly detection techniques can be classified into five groups [2]: classification-based, clustering-based, nearest neighbor based, statistical methods, information theory-based methods and spectral methods.", "startOffset": 64, "endOffset": 67}, {"referenceID": 7, "context": "Two of the most important applications of PCA during recent years has been in the domain of intrusion detection [9, 10] and traffic anomaly detection [1, 7].", "startOffset": 112, "endOffset": 119}, {"referenceID": 8, "context": "Two of the most important applications of PCA during recent years has been in the domain of intrusion detection [9, 10] and traffic anomaly detection [1, 7].", "startOffset": 112, "endOffset": 119}, {"referenceID": 0, "context": "Two of the most important applications of PCA during recent years has been in the domain of intrusion detection [9, 10] and traffic anomaly detection [1, 7].", "startOffset": 150, "endOffset": 156}, {"referenceID": 5, "context": "Two of the most important applications of PCA during recent years has been in the domain of intrusion detection [9, 10] and traffic anomaly detection [1, 7].", "startOffset": 150, "endOffset": 156}, {"referenceID": 4, "context": "However, construction of a realistic event pattern is not trivial [6].", "startOffset": 66, "endOffset": 69}, {"referenceID": 9, "context": "HMMs became popular for its simplicity and general mathematical tractability [11].", "startOffset": 77, "endOffset": 81}, {"referenceID": 4, "context": "Each process is dependent on the state of an underlying and unobserved Markov process [6].", "startOffset": 86, "endOffset": 89}, {"referenceID": 6, "context": "Using notations of [8] let:", "startOffset": 19, "endOffset": 22}, {"referenceID": 2, "context": "More details about these algorithms can be found in [4].", "startOffset": 52, "endOffset": 55}, {"referenceID": 2, "context": "The most common three-way analysis models are Tucker2, Tucker3, and PARAFAC [4] which are generalized versions of two-mode principal component model or, more specifically, SVD.", "startOffset": 76, "endOffset": 79}, {"referenceID": 3, "context": "To solve this, every time-series of \u2206T relative to a given user is modeled by a 2-state HMM obtained by the Baum-Welch algorithms [5].", "startOffset": 130, "endOffset": 133}, {"referenceID": 2, "context": "We applied Tucker3 model to both datasets X102 and X909 by employing a MATLAB package called Three-mode component analysis (Tucker3) [4].", "startOffset": 133, "endOffset": 136}, {"referenceID": 2, "context": "Before that, we performed ANOVA test [4] to see the significance of three-way and two-way interaction in the data.", "startOffset": 37, "endOffset": 40}, {"referenceID": 2, "context": "In [4] the scree test method is proposed as a guideline to choose these parameters.", "startOffset": 3, "endOffset": 6}], "year": 2014, "abstractText": "Failure detection in telecommunication networks is a vital task. So far, several supervised and unsupervised solutions have been provided for discovering failures in such networks. Among them unsupervised approaches has attracted more attention since no label data is required. Often, network devices are not able to provide information about the type of failure. In such cases the type of failure is not known in advance and the unsupervised setting is more appropriate for diagnosis. Among unsupervised approaches, Principal Component Analysis (PCA) is a well-known solution which has been widely used in the anomaly detection literature and can be applied to matrix data (e.g. Users-Features). However, one of the important properties of network data is their temporal sequential nature. So considering the interaction of dimensions over a third dimension, such as time, may provide us better insights into the nature of network failures. In this paper we demonstrate the power of three-way analysis to detect events and anomalies in time-evolving network data.", "creator": "LaTeX with hyperref package"}}}