{"id": "1502.00245", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "1-Feb-2015", "title": "Injury risk prediction for traffic accidents in Porto Alegre/RS, Brazil", "abstract": "This study describes the experimental application of Machine Learning techniques to build prediction models that can assess the injury risk associated with traffic accidents. This work uses an freely available data set of traffic accident records that took place in the city of Porto Alegre/RS (Brazil) during the year of 2013. This study also provides an analysis of the most important attributes of a traffic accident that could produce an outcome of injury to the people involved in the accident.", "histories": [["v1", "Sun, 1 Feb 2015 12:57:40 GMT  (1443kb,D)", "http://arxiv.org/abs/1502.00245v1", null]], "reviews": [], "SUBJECTS": "cs.LG cs.AI", "authors": ["christian s perone"], "accepted": false, "id": "1502.00245"}, "pdf": {"name": "1502.00245.pdf", "metadata": {"source": "CRF", "title": "Injury risk prediction for traffic accidents in Porto Alegre/RS, Brazil (draft)", "authors": ["Christian S. Perone"], "emails": [], "sections": [{"heading": null, "text": "Index terms - risk assessment of injuries, classification, traffic accidents, machine learning.I. INTRODUCTIONStatistics provided by EPTC [1] - the Administration of Traffic in Porto Alegre / RS (Brazil) - shows that in 2013 about 22,447 traffic accidents took place in the city of Porto Alegre, an average of 1,870 traffic accidents per month. According to Saunier et al. [2], the social cost of traffic accidents is the biggest side effect of road traffic. The cost of deaths, injuries and property damage, as well as medical care and traffic delays are responsible for a significant impact on the financing of the individuals involved, cities and the government. According to Brazil's National Traffic Department (DENATRAN), the average cost of an accident (in federal roads) without casualties is R $16,840.00, for accidents with victims of these costs rises to R $86,032.00 and for accidents with fatalities, the cost is R $18,41.000.34, descriptive factors of road safety."}, {"heading": "II. RELATED WORK", "text": "Attempts were made to look for existing accident analysis practice in the city of Porto Alegre, but no published work related to the application of machine learning techniques by the Traffic Control Centre (EPTC) in Porto Alegre was found. Limited descriptive analyses were published on the site of the Traffic Control Centre [1], but no in-depth analyses of the factors or injury risk assessment were published by the Traffic Control Centre. Lack of standardisation for the data collection process and for the data itself between different traffic control centres worldwide makes the comparison of the experimental results very limited. Beshah et al. [4] examined a rich dataset comprising 14,254 accidents described with 48 attributes that contained information relating to road users (drivers, pedestrians and passengers), vehicles and roads. In their study, two predictive modeling methods were used: CART and Random Forests. The experimental results obtained by means of the CART analysis were most effective in assessing the risk of injury (the AUC), while the risk of injury (the AUC curve was below 0.27)."}, {"heading": "III. PROPOSED APPROACH", "text": "The work described in this paper aims to evaluate various machine learning techniques in order to create a predictive model for assessing the risk of injury of traffic accident events according to Xiv: 150 2.00 245v 1 [cs.L G] 1F eb2 0152 based on data collected by a traffic control center. Since the risk of injury is dichotomous in relation to the dependent variable, this facilitates the use of binary classifiers used in this study, such as logistic regression or support vector machines. This paper also evaluates the relationship between the outcome of traffic accidents and the possible contributing factors to an effort to understand which are the most important factors in an accident with injury outcome."}, {"heading": "IV. EXPERIMENTAL METHODOLOGY", "text": "This section describes the data set used, as well as the tools and algorithms used to perform the analysis."}, {"heading": "A. Traffic Accident Data Set", "text": "The dataset used in this study is from Datapoa [5], an initiative of Porto Alegre Municipality to provide open data access to many datasets related to the city itself. Datapoa's traffic accident dataset is licensed under the Open Database License (ODbL) [6], which is an attribution and share-like license for databases. Although the time span of available datasets for traffic accidents extends from 2000 to 2013, only the data from the most recent dataset was used (the dataset refers to the accidents that occurred in 2013).The dataset consists of 20,798 accident datasets described with 44 attributes. Some attributes of the dataset are irrelevant to the purpose of this study and many attributes also included duplicate data or invalid datasets, so cleanup was required before using the dataset."}, {"heading": "B. Tools", "text": "To generate thermal images of the spatial distribution of accidents, this study used the Django GIS Brasil framework [7], an open source project by the same author of the study that aggregates spatial information related to Brazilian territory. To analyze the data, the author used Pandas [8], an open source library that provides powerful data structures and data analysis tools for the Python programming language. In this study, Scikit Learning [9] - an open source framework for machine learning for the Python language - was also used to perform data preprocessing and generate predictive models."}, {"heading": "C. Machine Learning Techniques", "text": "In this study, the following algorithms were used as classifiers for assessing the risk of injury: logistic regression, support vector machines, naive bayes, K-next neighbors, and random forests. Details of the deployment, parameterization, and evaluation techniques of models used to evaluate predictive models will be described in the next sections."}, {"heading": "D. Logistic Regression", "text": "The logistic regression used in this study is the logistic regression present in the scikit-learn framework [9], which in turn uses the LIBLINEAR [10] implementation of logistic regression. LIBLINEAR implementation solves the following optimization problem: min w1 2 wTw + C l \u2211 i = 1% (w; xi, yi) (1) In the face of a number of instance-label pairs (xi, yi), i = 1,..., l where C is the penalty parameter and \u0442 (w; xi, yi) is the loss function for logistic regression as follows: log (1 + e \u2212 jiw T xi) (2) In this study, we used L2 regulated logistic regression with penalty C equal to 1.0."}, {"heading": "E. Support Vector Machines", "text": "The Support Vector Machine (SVM) of scikit-learn [9] used in this thesis is based on the implementation of LIBSVM [11], a C-Support Vector Classification. Further details on the implementation of the algorithm can be found in the explanatory LIBSVM [11] original paper. The SVM algorithm was parameterized with a linear kernel and with 9.0 as the error term, both parameters were selected by hyperparameter optimization through a non-exhaustive grid search between different kernel types (RBF, polynomial and linear) with different error dates and gamma values."}, {"heading": "F. Naive Bayes", "text": "The Naive-Bayes algorithm used in this study also comes from scikit-learn [9]. The various Naive-Bayes classifiers implemented in scikit-learn differ mainly in their assumptions regarding the distribution of P (xi | y) [9]. The author chose the Gaussian Naive Bayes, where the probability of the characteristics of Gaussian origin is: P (xi | y) = 1 \u221a 2\u03c0\u03c32y exp (\u2212 (xi \u2212 \u00b5y) 22\u03c32y) (3) And where the parameters \u03c3y and \u00b5y are estimated with maximum probability [9]."}, {"heading": "G. K-nearest neighbors", "text": "The K-next neighbors (kNN) algorithm used in this study was also derived from scikit-learn [9], which provides both unattended and monitored adjacent learning methods. kNN succeeded in a large number of classification and regression problems despite the simplicity of the algorithm, and the number of neighbors used in this study (for the k value) is 8. This value was also determined using a non-exhaustive hyperparameter optimization by the grid search technique. [3] Attributes scaling was also performed prior to the use of kNN to ensure that the distance measure assigns the same weight to each variable."}, {"heading": "H. Random Forests", "text": "The author of the paper also used random forests from scikit-learn [9] as a binary classifier and also to evaluate the importance of traits to understand which are the most important factors in predicting the risk of injury. Random forests are a combination of tree predictors in which each tree depends on the values of a randomly selected vector independently and with the same distribution for all trees in the forest [12]. Compared to the original Brainman [12] publication, the Scikit Learn implementation combines classifiers by calculating its probable prediction, rather than having each classifier matched for a single class [13]. Random forests were also used to evaluate the risk of injury and the importance of factors in the Beshah study [4] mentioned above. The number of estimators used (trees in the forest) was 200, with this number selected by network search using non-exhaustive hyperparameter optimization."}, {"heading": "I. Model Evaluation", "text": "To evaluate the prediction models trained in this study, the author used cross-validation with a train data set containing 60% of the instances from the original dataset and a test data set containing 40% of the original dataset. Both the training and the test data set were randomly taken from the original dataset. To evaluate the prediction models, the author used the Area Under the Curve (AUC) - calculated according to the trapezoidal rule - of the Receiver Operating Characteristic (ROC), a graphical graph showing the performance of a binary classifier that varies the discrimination threshold. In this study, the curve was plotted using the true positive rate against the false positive rate at different threshold settings (one for each different prediction result from each model). Also, complementary to the ROC and AUC, is the predictability: The author of this study has calculated tables that calculate the precision of the F1, the recall, and each score for each prediction model."}, {"heading": "J. Data Cleansing", "text": "Some accident records in the dataset had an invalid date / time format, and because the number of invalid datasets was very small (less than 5) compared to the number of valid datasets (more than 20,790), these datasets were simply removed from the dataset without any significant loss in the experimental analysis."}, {"heading": "V. EXPERIMENTAL ANALYSIS", "text": "This section provides a brief descriptive analysis of the data set used as well as the experimental results using various predictive models and their model evaluations."}, {"heading": "A. Data set analysis", "text": "It is only a matter of time before that happens, that it happens."}, {"heading": "B. Model evaluation", "text": "The results of the study (Precision, F1-Score) with test data for logistics and support Vector Machine (SVM) are shown in Table VI, the results for Naive Bayes and the closest neighbors are shown in Table VII and the results for the evaluation of forests. ROC curves and the average value for each model are also very similar."}, {"heading": "VI. CONCLUSIONS AND FUTURE WORK", "text": "As we can see, the experimental results showed that predictive models for assessing the risk of injury can be created with good accuracy, even with limited data sets, such as the one used in this study, which lacks information on drivers, victims and vehicle movements. These results, together with the analysis of variable importance, can be used by the traffic management agencies to understand the data sets provided with even greater depth than the limited descriptive analysis carried out today by these agencies. TABLE IX ATTRIBUTE IMPORTANCESImportance Attributes Name Description0.2108 MOTO The number of motorcycles involved is 0.0948 CAR The number of cars involved. 0.0925 TIPO ACIDATROPELAMENTO If the type of accident was passed. 0.0391 LOCALLOGRADOURO If the accident happened on a normal road. 0.0368 CLOCALCRUAMTO If the accident happened on an intersection."}], "references": [{"title": "Estat\u0131\u0301sticas", "author": ["EPTC"], "venue": "11 2014. [Online]. Available: http://www2. portoalegre.rs.gov.br/eptc/default.php?p secao=203", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2014}, {"title": "Investigating collision factors by mining microscopic data of vehicle conflicts and collisions", "author": ["N. Saunier", "N. Mourji", "B. Agard"], "venue": "90th Transportation Research Board Annual Meeting, vol. 2237, pp. 41\u201350, 2011.", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2011}, {"title": "Impactos sociais e econ\u00f4micos dos acidentes de tr\u00e2nsito nas rodovias brasileiras", "author": ["DENATRAN"], "venue": "December 2006. [Online]. Available: http://www.denatran.gov.br/publicacoes/download/ custos acidentes transito.pdf", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2006}, {"title": "Pattern recognition and knowledge discovery from road traffic accident data in ethiopia: Implications for improving road safety", "author": ["T. Beshah", "D. Ejigu", "A. Abraham", "V. Snasel", "P. Kromer"], "venue": "World Congress on Information and Communication Technologies (WICT), pp. 1241\u20131246, December 2011.", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2011}, {"title": "Datapoa", "author": ["Prefeitura de Porto Alegre e Poa Digital"], "venue": "November 2014. [Online]. Available: http://datapoa.com.br/dataset/acidentes-de-transito", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2014}, {"title": "Odbl 1.0 license", "author": ["Open Data Commons"], "venue": "November 2014. [Online]. Available: http://opendatacommons.org/licenses/odbl/summary", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2014}, {"title": "Django GIS Brasil", "author": ["C.S. Perone", "G. Wainer", "L. Nunes"], "venue": "November 2014. [Online]. Available: http://django-gis-brasil.readthedocs.org", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2014}, {"title": "pandas: a foundational python library for data analysis and statistics", "author": ["W. McKinney"], "venue": "2011, PyHPC2011. [Online]. Available: http://pandas.pydata.org/talks.html  6", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2011}, {"title": "Scikit-learn: Machine Learning in Python", "author": ["F. Pedregosa", "G. Varoquaux", "A. Gramfort", "V. Michel", "B. Thirion", "O. Grisel", "M. Blondel", "P. Prettenhofer", "R. Weiss", "V. Dubourg", "J. Vanderplas", "A. Passos", "D. Cournapeau", "M. Brucher", "M. Perrot", "E. Duchesnay"], "venue": "Journal of Machine Learning Research, vol. 12, pp. 2825\u20132830, 2011.", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2011}, {"title": "LIBLINEAR: A library for large linear classification", "author": ["R.-E. Fan", "K.-W. Chang", "C.-J. Hsieh", "X.-R. Wang", "C.-J. Lin"], "venue": "Journal of Machine Learning Research, vol. 9, pp. 1871\u20131874, 2008.", "citeRegEx": "10", "shortCiteRegEx": null, "year": 1871}, {"title": "LIBSVM: A library for support vector machines", "author": ["C.-C. Chang", "C.-J. Lin"], "venue": "ACM Transactions on Intelligent Systems and Technology, vol. 2, pp. 27:1\u201327:27, 2011, software available at http://www.csie.ntu. edu.tw/\u223ccjlin/libsvm.", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2011}, {"title": "Random forests", "author": ["L. Breiman"], "venue": "Mach. Learn., vol. 45, no. 1, pp. 5\u201332, Oct. 2001. [Online]. Available: http://dx.doi.org/10.1023/A: 1010933404324", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2001}, {"title": "Ensemble methods", "author": ["scikit learn"], "venue": "December 2014. [Online]. Available: http://scikit-learn.org/stable/modules/ensemble.html", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2014}, {"title": "Probabilistic outputs for support vector machines and comparisons to regularized likelihood methods", "author": ["J.C. Platt"], "venue": "ADVANCES IN LARGE MARGIN CLASSIFIERS. MIT Press, 1999, pp. 61\u201374.", "citeRegEx": "14", "shortCiteRegEx": null, "year": 1999}, {"title": "Bias in random forest variable importance measures: Illustrations, sources and a solution", "author": ["C. Strobl", "A.-L. Boulesteix", "A. Zeileis", "T. Hothorn"], "venue": "BMC bioinformatics, vol. 8, no. 1, p. 25, 2007.", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2007}], "referenceMentions": [{"referenceID": 0, "context": "Statistics provided by EPTC [1] \u2013 the traffic managing agency in Porto Alegre/RS (Brazil) \u2013 shows that in 2013, approximately 22.", "startOffset": 28, "endOffset": 31}, {"referenceID": 1, "context": "[2], the social cost of road collisions is the largest side effect of road transportation .", "startOffset": 0, "endOffset": 3}, {"referenceID": 2, "context": "According to Brazilian National Traffic Department (DENATRAN) [3], the average cost for an accident (in federal highways) without victims is R$ 16.", "startOffset": 62, "endOffset": 65}, {"referenceID": 3, "context": "Descriptive analysis of the situation in road safety and road accidents are important, but understanding the factors related with dangerous situations and patterns in data is of even greater importance [4].", "startOffset": 202, "endOffset": 205}, {"referenceID": 0, "context": "Only limited descriptive analysis were published on the site of the traffic agency [1], but no deeper analysis of the factors or injury risk assessment were published by the traffic managing agency.", "startOffset": 83, "endOffset": 86}, {"referenceID": 3, "context": "[4] explored a rich data set, comprising of 14.", "startOffset": 0, "endOffset": 3}, {"referenceID": 1, "context": "[2] investigated the collision factors and processes (i.", "startOffset": 0, "endOffset": 3}, {"referenceID": 1, "context": "[2] avoided the use of algorithms with a \u201cblack box\u201d nature like ANNs (Artificial Neural Networks) or SVMs (Support Vector Machines) and used C4.", "startOffset": 0, "endOffset": 3}, {"referenceID": 1, "context": "In their work, they found an strong relationship between the evasive actions and the interaction outcome: in most collisions (62 out of 82), no evasive action was attempted [2].", "startOffset": 173, "endOffset": 176}, {"referenceID": 4, "context": "The data set used in this study was obtained through Datapoa [5], an initiative from the city hall of Porto Alegre to provide open data access to many data sets related with the city itself.", "startOffset": 61, "endOffset": 64}, {"referenceID": 5, "context": "The traffic accident data set available at the Datapoa is licensed under the Open Database License (ODbL) [6], which is an Attribution and Share-Alike license for databases.", "startOffset": 106, "endOffset": 109}, {"referenceID": 6, "context": "To plot heat maps with the geospatial distribution of the accidents, this study used the framework Django GIS Brasil [7], an open source project from the same author of this study, that aggregates geospatial information related with the Brazilian territory.", "startOffset": 117, "endOffset": 120}, {"referenceID": 7, "context": "To provide data analysis, the author used Pandas [8], an open source library providing high-performance, data structures and data analysis tools for the Python programming language.", "startOffset": 49, "endOffset": 52}, {"referenceID": 8, "context": "This study also used scikit-learn [9] \u2013 an open source Machine Learning framework for the Python language \u2013 to perform data pre-processing and to build the predictive models.", "startOffset": 34, "endOffset": 37}, {"referenceID": 8, "context": "The Logistic Regression used in this study is the Logistic Regression present in the scikit-learn framework [9], which in turn uses the LIBLINEAR [10] implementation of the Logistic Regression.", "startOffset": 108, "endOffset": 111}, {"referenceID": 9, "context": "The Logistic Regression used in this study is the Logistic Regression present in the scikit-learn framework [9], which in turn uses the LIBLINEAR [10] implementation of the Logistic Regression.", "startOffset": 146, "endOffset": 150}, {"referenceID": 8, "context": "The Support Vector Machine (SVM) from scikit-learn [9] used in this work is based on the LIBSVM [11] implementation, which is a C-Support Vector Classification.", "startOffset": 51, "endOffset": 54}, {"referenceID": 10, "context": "The Support Vector Machine (SVM) from scikit-learn [9] used in this work is based on the LIBSVM [11] implementation, which is a C-Support Vector Classification.", "startOffset": 96, "endOffset": 100}, {"referenceID": 10, "context": "For more details about the algorithm implementation, please refer to the elucidative LIBSVM [11] original paper.", "startOffset": 92, "endOffset": 96}, {"referenceID": 8, "context": "The Naive Bayes algorithm used in this study is also from scikit-learn [9].", "startOffset": 71, "endOffset": 74}, {"referenceID": 8, "context": "The different Naive Bayes classifiers implement in scikit-learn differ mainly by the assumptions they make regarding the distribution of P (xi | y) [9].", "startOffset": 148, "endOffset": 151}, {"referenceID": 8, "context": "And where the parameters \u03c3y and \u03bcy are estimated using maximum likelihood [9].", "startOffset": 74, "endOffset": 77}, {"referenceID": 8, "context": "The K-nearest neighbors (kNN) algorithm used in this study is also from scikit-learn [9], which provides both unsupervised and supervised neighbors-based learning methods.", "startOffset": 85, "endOffset": 88}, {"referenceID": 8, "context": "The author of the paper also used Random Forests from scikit-learn [9] as a binary classifier and also to evaluate the feature importance in order to understand which are the most important factors while predicting the injury risk.", "startOffset": 67, "endOffset": 70}, {"referenceID": 11, "context": "Random forests are a combination of tree predictors, where each tree depends on the values of a random vector sampled independently and with the same distribution for all trees in the forest [12].", "startOffset": 191, "endOffset": 195}, {"referenceID": 11, "context": "When compared with the original publication from Brainman [12], the scikit-learn implementation combines classifiers by averaging their probabilistic prediction, instead of letting each classifier vote for a single class [13].", "startOffset": 58, "endOffset": 62}, {"referenceID": 12, "context": "When compared with the original publication from Brainman [12], the scikit-learn implementation combines classifiers by averaging their probabilistic prediction, instead of letting each classifier vote for a single class [13].", "startOffset": 221, "endOffset": 225}, {"referenceID": 3, "context": "Random Forests were also used to assess injury risk and the importance of factors in the aforementioned study done by Beshah [4].", "startOffset": 125, "endOffset": 128}, {"referenceID": 13, "context": "Since some algorithms used in this study didn\u2019t have a natural probability estimate outcome like Logistic Regression has for each class, the author hence used different estimating techniques in order to be able to compare the ROC and AUC between different classifiers: 1) Support Vector Machines: In this case, the probability estimates were calculated by LIBSVM using Platt scaling [14].", "startOffset": 383, "endOffset": 387}, {"referenceID": 14, "context": "[15], Random Forests have been successfully applied to various problems and within a very short period of time, random forests have become a major data analysis tool, that performs well in comparison with many standard methods.", "startOffset": 0, "endOffset": 4}], "year": 2015, "abstractText": "This study describes the experimental application of Machine Learning techniques to build prediction models that can assess the injury risk associated with traffic accidents. This work uses an freely available data set of traffic accident records that took place in the city of Porto Alegre/RS (Brazil) during the year of 2013. This study also provides an analysis of the most important attributes of a traffic accident that could produce an outcome of injury to the people involved in the accident.", "creator": "LaTeX with hyperref package"}}}