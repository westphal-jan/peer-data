{"id": "1502.00598", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "2-Feb-2015", "title": "Lock in Feedback in Sequential Experiments", "abstract": "We often encounter situations in which an experimenter wants to find, by sequential experimentation, $x_{max} = \\arg\\max_{x} f(x)$, where $f(x)$ is a (possibly unknown) function of a well controllable variable $x$. Taking inspiration from physics and engineering, we have designed a new method to address this problem. In this paper, we first introduce the method in continuous time, and then present two algorithms for use in sequential experiments. Through a series of simulation studies, we show that the method is effective for finding maxima of unknown functions by experimentation, even when the maximum of the functions drifts or when the signal to noise ratio is low.", "histories": [["v1", "Mon, 2 Feb 2015 20:00:13 GMT  (1387kb,D)", "http://arxiv.org/abs/1502.00598v1", "7 Pages, 4 Figures"], ["v2", "Tue, 3 Feb 2015 08:11:33 GMT  (1387kb,D)", "http://arxiv.org/abs/1502.00598v2", "7 Pages, 4 Figures"], ["v3", "Tue, 12 Jan 2016 08:20:21 GMT  (1825kb,D)", "http://arxiv.org/abs/1502.00598v3", "20 Pages, 7 Figures"]], "COMMENTS": "7 Pages, 4 Figures", "reviews": [], "SUBJECTS": "cs.LG", "authors": ["maurits kaptein", "davide iannuzzi"], "accepted": false, "id": "1502.00598"}, "pdf": {"name": "1502.00598.pdf", "metadata": {"source": "META", "title": "Thompson sampling with the online bootstrap", "authors": ["Maurits Kaptein", "Davide Iannuzzi"], "emails": [], "sections": [{"heading": "1. Introduction", "text": "We often come across situations where an experimenter wants to find out how to solve the problem through sequential experiments, especially through the use of interactive technologies. To solve this problem in physics and engineering applications, scientists have routinely implemented techniques based on the idea of systematically changing the value of controllable variables over time and subsequently how these changes affect the dependent variables. Applications of the problem of finding arg maxx f (x) are diverse and prominent across a much broader range of fields. For example, companies in economics might be able to manipulate the properties of a product (~ x), such as the price, and observe revenue (y). The exact functional relationship between product features and revenue might not be known, but sequentially (for examples see Kung al., 2002; Jiang al, 2011)."}, {"heading": "2. Finding the maximum of a curve with a lock-in algorithm: a short introduction", "text": "Suppose that y is a continuous function f of x: y = f (x). Let's assume that x corresponds with time: x (t) = x0 + A cos (p) (1) imsart-generic ver. 2011 / 11 / 15 File: arXiv _ Lockin.tex Date: October 6, 2017where \"s is the angular frequency of oscillation, x0 its central value, and A its amplitude. For relatively small values of A, Taylor expansion f (x) by x0 to the second order, you get: y (t) = f (x0) + (x0) \u2212 x0 \u2212 A cos (x0 \u2212 A cos) (f) x x x x x x\" s. \""}, {"heading": "3. Algorithm for LiF in experiments", "text": "To simplify the notation, we will index sequential measurements by yt, where t = 1,..., t = T denotes the length - possibly infinite - of the experiment performed to find arg maxx f (x). In discrete time, we can use the same procedure as above, starting with x0 and oscillating around x0 for each sample with a known frequency \u03c9 and known amplitude A: xt = x0 + A cos\u03c9t (11) imsart-generic ver. 2011 / 11 / 15 File: arXiv _ Lockin.tex Date: October 6, 2017, which will result in measurements generated by yt = f (x0 + A cos\u03c9t) + t (12) imsart-generic."}, {"heading": "3.1. LiF-I: Batch updates of x0", "text": "Our first implementation of LiF (referred to as LiF-I) is presented in algorithm 1. In this implementation, we sum up observations yt, which we multiply by cos (\u03c9t), for a batch period of length T, after which we update x0. Variable y-V-V contains a running sum, which is used for integration. \u2022 Algorithm 1 Implementation of LiF-I for the single variable maximization in the data stream using a batch approach. Required: x0, A, T, \u03b3, yn-V = 2-T for t = 1,..., T do xt = x0 + A-V-V-V (x0 + A-V) + t yp-V-V (t mod T = = = 0) then y-V = y-V-V-V-V / Tx0, y-V-V-V = 0end forThe tuning parameters for LiF-I, which are generally specified by the selection, we should update with some of these observations, we will summarize them for a period of time only V \u2022 In this case, we will add up some of these observations for a duration Y \u2022 cos."}, {"heading": "3.2. LiF-II: Continuous updates of x0", "text": "For some applications, the batch updates of x0 - as implied by the continuous time analysis and defined in algorithm 1 - may not be feasible. Algorithm 2 is a modified version of LiF (referred to as LiF-II), in which x0 is updated with each observation. LiF-II begins by padding a buffer of length T, which we designate by the vector ~ y\u03c9 = {NA1,..., NAT}, after which each observation results in an update of x0. In the algorithm description, the values yt \u2212 T,. yt are stored in the vector ~ y\u03c9. By defining the learning rate as \u03b3 T, the tuning parameters in LiF-II are the same as in LiF-I. Algorithm 2 Implementation of LiF-II for individual variable maximization in the data stream using a batch. Required: x0, A, T, used, used, used, used, used, cosmic, cosmic."}, {"heading": "4. Simulation study 1: Comparison of Batched and streaming LiF and examination of tuning parameters", "text": "In this section, we will use simulation to examine the differences between LiF-I and LiF-II, and the effects of tuning parameters A, T and \u03b3 in a situation where y = f (x) is measured noiselessly. Figure 1 shows the performance of LiF for T = 10000 using the following tuning parameter settings \u2022 x0 = \u2212 5.imsart generic use 2011 / 11 / 15 File: arXiv _ Lockin.tex Date: 6 October 2017 \u2022 T: 10, 100, 100} \u2022 A: 1, 1, 2, 10} \u2022 The rows of Figure 1 (top down) show decreasing values of Liv-X, while the columns (left to right) show increasing values of T."}, {"heading": "5. Simulation study 2: Effects of noise", "text": "In order to investigate the effects of (measurement) noise on the performance of LiF-II, we repeat the simulations described in section 4 using the data generation model described in Eq.14 with \u0445 N (0, \u03c32) and \u03c32 \u0445 {10, 100, 1000, 10000}. We select tuning parameters: x0 = \u2212 5, A = 1, T = 100, \u03b3 = 1. In contrast to the simulations presented in section 4, we repeat the method m = 100 times: Figure 3 shows the average x0 over the 100 simulation runs and the 95% confidence limits. Figure 3 shows that LiF-II performs very well even in the situation in which the noise levels are high. Imsart generic version 2011 / 11 / 15: arXiv _ Lockin.tex Date: 6 October 2017"}, {"heading": "6. Simulation study 3: Performance of LiF in cases of concept drift", "text": "One of the advantages of Lock in Feedback compared to other methods of determining xmax is the fact that LiF can also be used to find a maximum of a function in cases of concept drift (Gaber et al., 2005): Even if f (x) changes over time, LiF provides a method to visualize the value of the treatment x close to the max. To illustrate this latter benefit of LiF, we set up a simulation using the following data generation model: f (x, t) = \u2212 2 ((x \u2212.0025t) \u2212 5) 2 + (14), where the (x \u2212.0025t) ensures that during the current of t = 0 to t = 104 = T the value of xmax changes from 5 to 30. We select x0 = \u2212 20 (note the different starting position compared to the previous simulations), A = 1, T = 100, \u03b3 = 1 and \u03c32 = 10. We examine the performance of LiF-II in this concept."}, {"heading": "7. Discussion and Future work", "text": "In this paper, we presented Lock in Feedback as a method to find arg maxx f (x) by sequential experiments. the method is attractive because it a) does not require the function form of f (x) to be known to derive its maximum, b) behaves well in situations where high-noise measurements are made, and c) allows to track the maximum of a function, even if this function changes over time. arXiv _ Lockin.tex file 2011 / 11 / 15: arXiv _ Lockin.tex file 2011 / 11 / 15: arXiv _ Lockin.tex file: October 6, 2017behind LiF, which shows how known (or imposed) oscillations in x can be used to determine the derivative (s) of f (x) that can then be used to find arg maxx f (x)."}, {"heading": "7.1. LiF for higher dimensional problems.", "text": "In this paper, we have demonstrated the use of LiF only in cases where x is scalar. However, if x is a vector, a very similar approach can be used to find the maximum of the function f (~ x) in more than one dimension. In the two-dimensional case, LiF can be extended by oscillating both elements of x at different frequencies: x1, t = 1.0 + A1 cos\u03c91tx2, t = x2.0 + A2 cos\u03c92tAfter oscillating both elements of x, we observe yt = f (x1, t, x2, t) and we can obtain information about the gradient by separate calculation: y1, \u03c9 = yt cos\u03c91ty2, \u03c9 = yt cos\u03c92tThis simple extension allows the use of LiF in higher dimensions. Apart from the fact that it should not be a multiple of each other, the effects of the tuning parameters and the performance of this higher-dimensional version of LiF must be further investigated."}, {"heading": "7.2. LiF and optimal design", "text": "Often, the problem of finding arg maxx f (x) is solved by conducting an experiment to estimate f (x) according to which the solution can be derived analytically; there is a large literature on designing optimal experiments to estimate the parameters of f (x) when its functional form is known (Antille und Weinberg, 2000; Myung and Pitt, 2009b); future work should examine the efficiency of LiF in comparison to methods where one first performs an (optimal) experiment to estimate f (x) before deriving arg maxx f (x); and the robust generic version 2011 / 11 / 15 file: arXiv _ Lockin.tex Date: October 6, 2017 to model misspecifications should be investigated: One advantage of LiF over methods where f (x) is investigated by experiments is that f (x) need not be known anywhere in the process."}, {"heading": "7.3. LiF in continuous bandit problems", "text": "The problem of finding arg maxx f (x) can also be considered a bandit problem. In such a formalization, the selected values of x represent the actions chosen by the experimenter according to which the rewards y are observed. Here, one is interested in finding a policy - a method to select values of x taking into account the previous observations - that maximizes the R = \u2211 yt.2. In such an environment, one would not only care about finding xmax, but one would like to be efficient in the search. Efficiency can be quantified here in the form of regret: the performance of the search process can be compared with that observed by xmax. LiF could be an efficient method for solving such (continuous) bandit problem. However, in order for LiF to be an asymptotically optimal solution to the continuously evaluated bandit problem, the learning costs directly related to the amplitude of the induced oscillation should be reduced over time: \u21d2 0."}, {"heading": "7.4. Conclusion", "text": "In this paper, we have presented LiF as a method for determining arg maxx f (x). LiF is attractive because it a) does not require knowledge of f (x), b) works well in high-noise situations, and c) works well in concept drift cases. We have provided two algorithms to implement LiF in a simple scalar case. However, future work should examine higher-dimensional implementations of LiF and relationships to other known approaches to find arg maxx f (x)."}, {"heading": "Appendix A: Algorithm for finding the exact maximum of a", "text": "Suppose that the curve y = f (x) is a parabola: y = \u2212 \u03b1 (x \u2212 x0) 2 + \u03b3Clear, f (x) has a maximum for x = x0. Moreover, the second derivative is always equal to \u2212 2\u03b1, regardless of the value of x. Interestingly, the value of \u03b1 can easily be extracted from the data collected during the lock-in procedure. To this end, y (t) must be multiplied by cos (2\u03c9t). Following the steps described in Equivalent 5, Equivalent 6 and Equivalent 10, we obtain: y2\u03c9 = TA28 (Xiv _ Lockin.tex date: October 6, 2017, which allows us to calculate as equivalent x = x0."}], "references": [{"title": "A Study of D-optimal Designs Efficiency for Polynomial Regression", "author": ["G. Antille", "A. Weinberg"], "venue": "Universit\u00e9 de Gen\u00e8ve, Facult\u00e9 des sciences \u00e9conomiques et sociales, D\u00e9partement d\u2019\u00e9conom\u00e9trie.", "citeRegEx": "Antille and Weinberg,? 2000", "shortCiteRegEx": "Antille and Weinberg", "year": 2000}, {"title": "Bandit Problems: Sequential Allocation of Experiments", "author": ["D.A. Berry", "B. Fristedt"], "venue": "Springer. 2For simplicity we are not discussing discounting or rewards that are a function of the", "citeRegEx": "Berry and Fristedt,? 1985", "shortCiteRegEx": "Berry and Fristedt", "year": 1985}, {"title": "imsart-generic ver. 2011/11/15", "author": ["observable y"], "venue": "file: arXiv_Lockin.tex date: October", "citeRegEx": "y.,? \\Q2017\\E", "shortCiteRegEx": "y.", "year": 2017}, {"title": "Pure exploration in finitely-armed and continuous-armed bandits", "author": ["S. Bubeck", "R. Munos", "G. Stoltz"], "venue": "Theoretical Computer Science, 412(19):1832\u2013 1852.", "citeRegEx": "Bubeck et al\\.,? 2011", "shortCiteRegEx": "Bubeck et al\\.", "year": 2011}, {"title": "Mining data streams", "author": ["M.M. Gaber", "A. Zaslavsky", "S. Krishnaswamy"], "venue": "ACM SIGMOD Record, 34(2):18.", "citeRegEx": "Gaber et al\\.,? 2005", "shortCiteRegEx": "Gaber et al\\.", "year": 2005}, {"title": "Optimizing E-tailer Profits and Customer Savings: Pricing Multistage Customized Online Bundles", "author": ["Y. Jiang", "J. Shang", "C.F. Kemerer", "Y. Liu"], "venue": "Marketing Science, 30(4):737\u2013752.", "citeRegEx": "Jiang et al\\.,? 2011", "shortCiteRegEx": "Jiang et al\\.", "year": 2011}, {"title": "Pricing on the Internet", "author": ["M. Kung", "K.B. Monroe", "J.L. Cox"], "venue": "Journal of Product & Brand Management, 11(2):274\u2013288.", "citeRegEx": "Kung et al\\.,? 2002", "shortCiteRegEx": "Kung et al\\.", "year": 2002}, {"title": "Optimal design of clinical trials comparing several treatments with a control", "author": ["I.C. Marschner"], "venue": "Pharmaceutical statistics, 6(1):23\u201333.", "citeRegEx": "Marschner,? 2007", "shortCiteRegEx": "Marschner", "year": 2007}, {"title": "Lock-in amplifiers: principles and applications, volume 1", "author": ["M.L. Meade"], "venue": "Mike Meade.", "citeRegEx": "Meade,? 1983", "shortCiteRegEx": "Meade", "year": 1983}, {"title": "Bayesian adaptive optimal design of psychology experiments", "author": ["J. Myung", "M. Pitt"], "venue": "Proceedings of the 2nd International Workshop in Sequential Methodologies (IWSM2009), pages 1\u20136.", "citeRegEx": "Myung and Pitt,? 2009a", "shortCiteRegEx": "Myung and Pitt", "year": 2009}, {"title": "Optimal experimental design for model discrimination", "author": ["J.I. Myung", "M.A. Pitt"], "venue": "Psychological review, 116(3):499.", "citeRegEx": "Myung and Pitt,? 2009b", "shortCiteRegEx": "Myung and Pitt", "year": 2009}, {"title": "A gentle introduction to optimal design for regression models", "author": ["T.E. O\u2019Brien", "G.M. Funk"], "venue": null, "citeRegEx": "O.Brien and Funk,? \\Q2003\\E", "shortCiteRegEx": "O.Brien and Funk", "year": 2003}, {"title": "Online Learning, Stability, and Stochastic Gradient Descent", "author": ["T. Poggio", "S. Voinea", "L. Rosasco"], "venue": "Artificial Intelligence, 8(11):11.", "citeRegEx": "Poggio et al\\.,? 2011", "shortCiteRegEx": "Poggio et al\\.", "year": 2011}, {"title": "Thermal dose determination in cancer therapy", "author": ["S.A. Sapareto", "W.C. Dewey"], "venue": "International Journal of Radiation Oncology*Biology*Physics, 10(6):787\u2013800.", "citeRegEx": "Sapareto and Dewey,? 1984", "shortCiteRegEx": "Sapareto and Dewey", "year": 1984}, {"title": "Frequency-domain description of a lock-in amplifier", "author": ["J.H. Scofield"], "venue": "American Journal of Physics, 62(2):129.", "citeRegEx": "Scofield,? 1994", "shortCiteRegEx": "Scofield", "year": 1994}], "referenceMentions": [{"referenceID": 5, "context": "The exact functional relationship between product features and revenue might not be known but can sequentially be sampled (for examples see Kung et al., 2002; Jiang et al., 2011) (especially using modern interactive communication technologies, such as, for instance, e-commerce).", "startOffset": 122, "endOffset": 178}, {"referenceID": 7, "context": "The problem also presents itself in the medical sciences when considering the dose of medication or composition of nutrition: often researchers seek for an optimal dosage according to some observable criterion, but the functional relationship between the dosage and the outcome measure is unknown (see, e.g., Sapareto and Dewey, 1984; Marschner, 2007).", "startOffset": 297, "endOffset": 351}, {"referenceID": 9, "context": "The problem can be approached as an optimal design problem, in which the main aim is to design an experiment that efficiently provides us with information regarding f(~x) (see, e.g., O\u2019Brien and Funk, 2003; Myung and Pitt, 2009a).", "startOffset": 171, "endOffset": 229}, {"referenceID": 1, "context": "However, one could also frame the problem as a bandit problem (Berry and Fristedt, 1985), where the actions a \u2208 A are the choice for the (continuous) value of x, and the rewards at each interaction rt are (some function of) y (Bubeck et al.", "startOffset": 62, "endOffset": 88}, {"referenceID": 3, "context": "However, one could also frame the problem as a bandit problem (Berry and Fristedt, 1985), where the actions a \u2208 A are the choice for the (continuous) value of x, and the rewards at each interaction rt are (some function of) y (Bubeck et al., 2011).", "startOffset": 226, "endOffset": 247}, {"referenceID": 8, "context": "This approach relies on the possibility of making the variable x oscillate at a fixed frequency and to look at the response of the dependent variable y at the very same frequency by means of a lock-in amplifier (Meade, 1983).", "startOffset": 211, "endOffset": 224}, {"referenceID": 8, "context": "This approach is widely used in a very large number of applications, both in industry and research (Meade, 1983), and is the basis for the Lock-in Feedback (LiF) method we introduce in this paper.", "startOffset": 99, "endOffset": 112}, {"referenceID": 12, "context": "This can be interpreted, and tuned, akin learn-rates in, for instance, stochastic gradient descent methods (Poggio et al., 2011).", "startOffset": 107, "endOffset": 128}, {"referenceID": 4, "context": "One of the advantages of Lock in Feedback as opposed to other methods of finding xmax is the fact that LiF can also be used to find a maximum of a function in cases of concept drift (Gaber et al., 2005): even when f(x) changes over time, LiF provides a method to keep the value of the treatment x close to xmax.", "startOffset": 182, "endOffset": 202}, {"referenceID": 0, "context": "There is a large literature on designing optimal experiment to to estimate the parameters of f(x) when its functional form is known (Antille and Weinberg, 2000; Myung and Pitt, 2009b).", "startOffset": 132, "endOffset": 183}, {"referenceID": 10, "context": "There is a large literature on designing optimal experiment to to estimate the parameters of f(x) when its functional form is known (Antille and Weinberg, 2000; Myung and Pitt, 2009b).", "startOffset": 132, "endOffset": 183}], "year": 2017, "abstractText": "Abstract: We often encounter situations in which an experimenter wants to find, by sequential experimentation, xmax = arg maxx f(x), where f(x) is a (possibly unknown) function of a well controllable variable x. Taking inspiration from physics and engineering, we have designed a new method to address this problem. In this paper, we first introduce the method in continuous time, and then present two algorithms for use in sequential experiments. Through a series of simulation studies, we show that the method is effective for finding maxima of unknown functions by experimentation, even when the maximum of the functions drifts or when the signal to noise ratio is low.", "creator": "LaTeX with hyperref package"}}}