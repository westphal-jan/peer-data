{"id": "1503.01002", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "3-Mar-2015", "title": "Projection onto the capped simplex", "abstract": "We provide a simple and efficient algorithm for computing the Euclidean projection of a point onto the capped simplex---a simplex with an additional uniform bound on each coordinate---together with an elementary proof. Both the MATLAB and C++ implementations of the proposed algorithm can be downloaded at", "histories": [["v1", "Tue, 3 Mar 2015 16:40:17 GMT  (10kb)", "http://arxiv.org/abs/1503.01002v1", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["weiran wang", "canyi lu"], "accepted": false, "id": "1503.01002"}, "pdf": {"name": "1503.01002.pdf", "metadata": {"source": "CRF", "title": null, "authors": ["Weiran Wang"], "emails": ["weiranwang@ttic.edu", "canyilu@gmail.com"], "sections": [{"heading": null, "text": "ar Xiv: 150 3.01 002v 1 [cs.L G] 3M arWe offer a simple and efficient algorithm for calculating the euclidean projection of a point on the truncated simplex, formally defined asmin x \u0418x \u2212 y-2 s.t. x 1 = s, 0 \u2264 x \u2264 1, together with an elementary proof. Both the MATLAB and C + + + implementation of the proposed algorithm can be downloaded from https: / / eng.ucmerced.edu / people / wwang5."}, {"heading": "1 The Problem", "text": "In this report we consider the following optimization problem in x-RD1 2-x-y-2 (1a) s.t. x-1 = s (1b) 0- \u2264 x-1, (1c) where s-cube and a hyperplane with normal 1. Alternatively, the realizable quantity is the simplex {x: x-0, x-1 = s with additional constraints x-1, so we call it the capped simplex. Problem 1 is a square program and the objective function is strictly convex, so there is a unique solution which we call x-0, x-1 = s."}, {"heading": "2 The algorithm", "text": "We provide an O (D2) algorithm for solving (1) in algorithm 1.Algorithm 1 for the euclidean projection of a vector on the section of the cube. Input: y-RD is sorted in ascending order: y1 \u2264 y2 \u2264 \u00b7 \u2264 yD. 1: Set y0 = \u2212 \u221e and yD + 1 = \u221e, calculate subtotals T0 = 0 and Tk = \u2211 k = 1 yk, k = 1,..., D.2: for a = 0, 1,.., D do 3: if (s = = D \u2212 a) & & (ya + 1 \u2212 ya \u2265 1) then 4: Set b = a. 5: break 6: end if 7: for b = + 1,.., D do 8: Compute \u03b3 = s + b \u2212 n + Ta \u2212 a.9: if (ya + \u03b3 \u2264 0) & (ya + 1 > 0) (yb + 1, < end: yb & < < < < < 1)."}, {"heading": "3 The proof", "text": "As already mentioned, (1) has a unique solution characterized by its KKT system (Nocedal and Wright, 2006).The Lagrange function of the problem is: < \u2212 \u2212 \u2212 \u2212 \u2212 \u2212 \u2212 \u2212 \u2212 \u2212 \u2212 Solution = 12 \u0445 x \u2212 \u2212 y 2 \u2212 x (1 \u2212 x) \u2212 p (1 x \u2212 s), where \u03b1 = [\u03b11,. < < and \u03b2 \u2212 \u2212 p = [1,. \u2212 p] are the Lagrange multipliers for the inequality constraints x 0 and 1 \u2212 x (1 \u2212 s) respectively the Lagrange multiplier for the equality constraint. For the optimal solution x of the following KT conditions, xi \u2212 yi \u2212 p \u2212 \u2212 p \u2212 p \u2212 p \u2212 p \u2212 p = 0, i = 1,.,., D (2a) xi \u00b2, i =."}, {"heading": "4 Experiment", "text": "In this section we demonstrate the effectiveness of our proposed method in algorithm 1 to the solution (1). We compare our method with other two solvers, the first is the CVX package (Grant and Boyd, 2012), a general convex program solver that transforms the problem into a semi-defined program and then applies the internal scoring method, and the second is the MATLAB command lsqlin to solve the limited linear smallest squares. We implement algorithm 1 in both MATLAB and C + +, and execute all the experiments in MATLAB (the C + code is compiled inside MATLAB and the Mex file is used). All experiments are performed on a PC with an Intel Core 2 quad CPU Q9550 frequency 2.83GH and 8GB main memory, under Windows 7 and MATLAB version 8.0. We generate y and s using the MATLAB command, the results are repeated (margin = 0.5 D), 1 and 1 (D), respectively."}], "references": [{"title": "Distributed optimization and statistical learning via the alternating direction method of multipliers", "author": ["S. Boyd", "N. Parikh", "E. Chu", "B. Peleato", "J. Eckstein"], "venue": "Foundations and Trends in Machine Learning,", "citeRegEx": "Boyd et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Boyd et al\\.", "year": 2011}, {"title": "Efficient projections onto the l1-ball for learning in high dimensions", "author": ["J. Duchi", "S. Shalev-Shwartz", "Y. Singer", "T. Chandra"], "venue": "Proc. of the 25th Int. Conf. Machine Learning", "citeRegEx": "Duchi et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Duchi et al\\.", "year": 2008}, {"title": "CVX: Matlab software for disciplined convex programming, version 2.0 beta", "author": ["M. Grant", "S. Boyd"], "venue": null, "citeRegEx": "Grant and Boyd.,? \\Q2012\\E", "shortCiteRegEx": "Grant and Boyd.", "year": 2012}, {"title": "Numerical Optimization. Springer Series in Operations Research and Financial Engineering", "author": ["J. Nocedal", "S.J. Wright"], "venue": null, "citeRegEx": "Nocedal and Wright.,? \\Q2006\\E", "shortCiteRegEx": "Nocedal and Wright.", "year": 2006}, {"title": "Projection onto the probability simplex: An efficient algorithm with a simple proof, and an application", "author": ["W. Wang", "M.\u00c1. Carreira-Perpi\u00f1\u00e1n"], "venue": null, "citeRegEx": "Wang and Carreira.Perpi\u00f1\u00e1n.,? \\Q2013\\E", "shortCiteRegEx": "Wang and Carreira.Perpi\u00f1\u00e1n.", "year": 2013}], "referenceMentions": [{"referenceID": 1, "context": "This problem is a slight generalization of the projection onto the probability simplex (see Duchi et al., 2008; Wang and Carreira-Perpi\u00f1\u00e1n, 2013 and the references therein), which is a special case of (1) by setting s = 1 and can be solved exactly with O(D logD) time complexity. An elementary proof of the corresponding algorithm can be found in Wang and Carreira-Perpi\u00f1\u00e1n (2013) and the cost mainly comes from sorting the dimensions of y.", "startOffset": 92, "endOffset": 381}, {"referenceID": 3, "context": "3 The proof As mentioned earlier, (1) has a unique solution which is characterized by its KKT system (Nocedal and Wright, 2006).", "startOffset": 101, "endOffset": 127}, {"referenceID": 0, "context": "And yet another approach is to apply the Alternating Direction Method of Multipliers (Boyd et al., 2011), which introduces another copy of the variables x and alternately optimize each copy with simple steps while encouraging the two copies to agree.", "startOffset": 85, "endOffset": 104}], "year": 2015, "abstractText": "We provide a simple and efficient algorithm for computing the Euclidean projection of a point onto the capped simplex, formally defined as min x\u2208RD 1 2 \u2016x\u2212 y\u20162 s.t. x1 = s, 0 \u2264 x \u2264 1, together with an elementary proof. Both the MATLAB and C++ implementations of the proposed algorithm can be downloaded at https://eng.ucmerced.edu/people/wwang5.", "creator": "LaTeX with hyperref package"}}}