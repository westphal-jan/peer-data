{"id": "1503.02328", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "8-Mar-2015", "title": "Financial Market Prediction", "abstract": "Given financial data from popular sites like Yahoo and the London Exchange, the presented paper attempts to model and predict stocks that can be considered \"good investments\". Stocks are characterized by 125 features ranging from gross domestic product to EDIBTA, and are labeled by discrepancies between stock and market price returns. An artificial neural network (Self-Organizing Map) is fitted to train on more than a million data points to predict \"good investments\" given testing stocks from 2013 and after.", "histories": [["v1", "Sun, 8 Mar 2015 21:45:07 GMT  (5294kb,D)", "http://arxiv.org/abs/1503.02328v1", "12 pages"]], "COMMENTS": "12 pages", "reviews": [], "SUBJECTS": "cs.CE cs.LG", "authors": ["mike wu"], "accepted": false, "id": "1503.02328"}, "pdf": {"name": "1503.02328.pdf", "metadata": {"source": "CRF", "title": "Financial Market Prediction", "authors": ["Mike H. Wu"], "emails": [], "sections": [{"heading": null, "text": "Using financial data from popular sites such as Yahoo and the London Exchange, the paper attempts to model and predict stocks that can be considered \"good investments.\" Stocks have 125 features ranging from gross domestic product to EDIBTA, and are characterized by discrepancies between equity and market price returns. An artificial neural network (self-organizing map) is equipped to train on more than one million data points to predict \"good investments\" in the face of test stocks from 2013 and beyond. Keywords: finance, CUSUM, SOM, market, prediction, machine, learning."}, {"heading": "1. Introduction", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "1.1. Statement of Purpose", "text": "The motivation for such a project is the conception and application of modern machine learning algorithms in the financial sector. The following topics are highlighted: \u2022 Tuning of a cumulative sum algorithm by means of comprehensive search and post-consolidation. \u2022 Labelling of test data on a trained map with weighted, fragmented and nested SOM units."}, {"heading": "1.2. Background Information", "text": "Rather, it would be desirable to design a mechanism to automate the investment process that fully describes what it means to be a \"successful stock value\" and is able to identify future examples thereof. Most examples of financial forecasting algorithms use pre-defined indicators from manual analysis, which often require a specified time span and are often full of nonlinearity and irregularities, resulting in highly orchestrated and arguably inconsistent models. Similar experiments have previously included various other artificial neural networks such as SVM and LSSVM. In this specific preprint submitted to arXiv on March 10, 2015, arXiv: 150 3.02 328v 1 [cs.C E] 8M ar2 01case, the SOM is selected for its ability to split heterogeneous data into several homogeneous regions. Given the statistical similarity in the SOM regions mentioned, it may be probable that the financial series are homogeneous."}, {"heading": "2. Methods", "text": "The following sections give an overview of the algorithm used for market forecasting."}, {"heading": "2.1. Data Extraction", "text": "Financial statistics for a large proportion of existing companies worldwide are available online free of charge. As part of this project, all data has been extracted from the London Stock Exchange and Yahoo Finance. Due to limited availability, only companies in the NYSE and NASDAQ markets have been considered (future work may include the FTSE / LSE). Several restrictions have been maintained to ensure the quality of future testing / training, some of which are: \u2022 Only companies with at least 9 years of available quarterly reports will be eligible for inclusion. \u2022 Only companies with adequate basic statistical data will be considered for inclusion. Under the relevant restrictions, initial data has been drawn from over 6,500 companies, each of which contains data from 40 quarters (10 years). Each company has data on share prices, comparable market prices and a list of 125 features, including but not limited to PE ratio, gross profit margin, interest rates, inventory, debt, industry comparison rates, EBIDTA, revenues, cash flow, etc."}, {"heading": "2.2. Feature Vector Creation", "text": "Given a large amount of data, it is important to format the selection in vectors.An important part of the creation of vectors is \"cherry-picking,\" where data series must be preserved.All vectors are organized by start and end time in such a way that all vectors with time intervals in which no stock or market price data is available are immediately discarded.22 out of 2,500 such companies were discarded due to lack of price data.For the market price, the TickerGPSC was used to estimate S & P500 fluctuations, which were considered a good representative of market change.In addition, vectors without data for important ratios such as PE or EDIBTA were discarded, all other missing characteristics were replaced by crude NaN (because financial data is considered chaotic, about 30% of all data were classified as NaN indicators).Given a feature without data for important ratios such as PE or EDIBTA, this data was discarded, with NaN values removed only 41%."}, {"heading": "2.3. Feature Selection", "text": "Although the Self-Organizing Map (SOM) is rather lenient in terms of the number of features (i.e. performs a variation of the feature selection itself), it is still important to reduce the features to a more reasonable number (i.e., more than 81). However, three different methods have been implemented: Principal Component Analysis (PCA), Extra Trees Classifier (EXT), Recursive Feature Extraction (RFE). These three were selected for their preservation of the feature identity.Since every interested user of such an algorithm, it is desirable to return to him / her the features that best explain the variance of the data and the decisions made. RFE and EXT merely rank functions, and PCA produces a decipherable linear combination of vectors that can all be easily understood and explained. \u2022 2.3.1 PCA PCA PCA PCA PCA PCA PCA PCA PCA is an intuitive choice as it does not require labels to be effective."}, {"heading": "2.4. Vector Labeling (CUSUM)", "text": "In this case, it is helpful to know the labels of the training data in order to detect the timing of rapid shifts in the cumulative composition of the share price. (t1, t2, t3, t3, tn, tVectors) Vt1, Vt2, Vt3, Vt3, Vtn."}, {"heading": "2.5. Model Usage (SOM)", "text": "A U-matrix (UMAT) is the matrix of Euclidean distances between the code book vectors of neighboring neurons, and a labeled component level (LCP) is the projection of the known training labels onto a piece of UMAT. If the good and bad clusters in the LCP coincide with clusters of \"narrow\" nodes in UMAT, the label can be considered good."}, {"heading": "2.5.1. Observations", "text": "Although the good clusters in the LCP coincided with UMAT, there is a seemingly random mix of good and bad mini-clusters that makes it indivisible. \u2022 EXT and RFE yielded very similar results. Choosing between the two may not be particularly important, especially given that the two often prioritize the same characteristics. \u2022 Medium-sized CUSUM is the best choice. Small CUSUM does not seem to define clear clusters in the LCP, while large CUSUM seems to blur everything, meaning that there are clusters with hardly any good and hardly any bad investments. Provided the final configuration was an EXT with medium-sized CUSUM labeling, with both parametric and non-parametric T tests used depending on interval normality."}, {"heading": "2.6. Testing Procedure", "text": "The general marking takes place by finding the most suitable SOM unit (BMU) for each test vector on the basis of a distance criterion. Since several vectors are projected onto the same SOM units, everyone can vote for the marking of this SOM unit as a good or bad investment unit. The vector is then labelled by majority vote."}, {"heading": "2.6.1. Custom Additions", "text": "\u2022 Fractionation Instead of making majority decisions, it is more interesting to keep the share of good investment votes in the total votes for each SOM unit, allowing for a ranking and less loss of information. \u2022 Weighting To change this, gi is the number of \"good\" votes, bi the number of \"bad\" votes, and wi is a new variable representing a weight. Then, the label for each vector i should be edited to wi \u0445 (gi / bi). The simplest example would be wi = gi. \u2022 Convolution Given the nature of a matrix, it is more convincing that a SOM unit represents a \"good investment\" if the neighbors also represent \"good investments\" rather than a single SOM unit. To represent this mathematically, it is a type of kernel (i.e. 5 SOM units) that weights a voluminous U unit against a voluminous unit, while the voluminous U unit represents another x-weighted."}, {"heading": "2.7. Additional Algorithms", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "2.7.1. Minimum Sample Size Calculation", "text": "This calculation is very important because a too small interval would lead to wrong estimates and wrong conclusions. For example, let us assume that the client has decided for this project that the relative minimum yield is acceptable at 5% and 80% test performance for a certain efficiency variable X.Let \u03c0 (\u03c4) be the performance, n be the sample size, \u03c6 be a quantitative function of the normal distribution, \u03c32 be the sample variance. Moreover, let tstart be, tending to be the time at the beginning, end of a certain interval. Define share return SR as the end / start, where Sx is the price of the share at that time. Define the market yield as MR as the trend / Mtstart."}, {"heading": "3. Results", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1. Features Selected", "text": "The following features are used for training / testing: high PE ratio, long-term debt / total capital, pre-tax profit margin, EBITDA per share, return on assets (ROA), normalized close PE ratio, shares outstanding, cash flow per share, price / non-cash book ratio, profit margin after tax, working capital as a% of price, price / equity ratio, price / equity ratio, interest rate as% of capital invested, normalized net profit margin, total assets per share, R & D as% of sales, normalized ROA, net profit margin, working capital per share, dividend per share, return on average equity, normalized return on equity, leverage ratio, revenue per $inventory."}, {"heading": "3.2. Top Ten Companies To Invest In", "text": "Below is the raw data of the 10 largest companies (in order) to invest in (specified test data for 2013 and beyond): MICT, CXDC, ITRN, TDG, XIN, WX, FTK, SPU, GURE, PWRD"}, {"heading": "4. Discussion/Rationale", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "4.1. Features Selected", "text": "Interestingly, many of the selected features overlap with those mentioned in the literature, which provides some informal credibility. Browne's novel The Small Book of Investment, for example, speaks of a similar ranking and emphasizes awareness of price-to-earnings ratios, debt ratios, profit margins, returns, and price-book ratios, all of which EXT rates as very important."}, {"heading": "4.2. Top Ten Companies", "text": "As an analysis of the ten companies selected, it is instructive to make a brief description of the individual companies.1. Ticker: MICT Name: Micronet Enertec Technologies, Inc. Data: April 1, 2013 to June 30, 2013 Industry: Aerospace / Defense (Industrial Goods) Location: New Jersey, US2. Ticker: CXDC Name: China XD Plastics Company Ltd. Data: April 1, 2013 to June 30, 2013 Industry: Wireless Communication, GPS, Location Technology (Technology) Location: Azour, Israel4. Ticker: TDG Name: TransDigm Group Incorporated Dates: July 1, 2013 to September 30, 2013 Industry: Aerospace / Defense (Industrial Goods) Location Technology: Chin."}, {"heading": "5. Conclusion", "text": "With the exception of SPU and MICT, all companies selected as \"good investments\" experienced a significant increase in share prices from April 2013 to January 2015. All of these stocks can be described as parabolic, including some large peaks between 2013 and 2015. Some of the companies experienced large sudden jumps and others showed more continuous gradual growth. Note that this model does not assist in the sale of shares. However, if a customer had bought all 10 shares in April 2013, he / she would have earned a large sum, with the exceptions being SPU and MICT. Note with the MICT chart that there was a particularly large earnings peak in March, which continued to grow after April, justifying his / her position as a top 10, but immediately after May 2013 the stock plummeted and converged to a price below the purchase price."}, {"heading": "Acknowledgements", "text": "The author thanks Irina Higgins for the helpful support of this tutorial. AppendixThe entire development and production code is included in the Dropbox folder. See the following link: https: / / www.dropbox.com / home / Mike / wu-marketpredictor-project. This includes three segments: Python scripts (production code for feature selection, feature vector creation, result analysis, vector labeling), iPython notebooks (corresponding development code) and MATLAB scripts (SOM implementation and data scraping)."}], "references": [{"title": "The Little Book of Value Investing", "author": ["Christopher H. Browne"], "venue": null, "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2007}, {"title": "Predicting bankruptcy using neural networks and other classification methods: The influence of variable selection techniques on model", "author": ["Philippe du Jardin"], "venue": "accuracy. Neurocomputing", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2010}, {"title": "Self-Organized Formation of Topologically Correct Feature Maps", "author": ["Teuvo Kohonen"], "venue": "Biological Cybernetics", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 1982}], "referenceMentions": [], "year": 2015, "abstractText": "Given financial data from popular sites like Yahoo and the London Exchange, the presented paper attempts to model and predict stocks that can be considered \u201dgood investments\u201d. Stocks are characterized by 125 features ranging from gross domestic product to EDIBTA, and are labeled by discrepancies between stock and market price returns. An artificial neural network (Self-Organizing Map) is fitted to train on more than a million data points to predict \u201dgood investments\u201d given testing stocks from 2013 and after.", "creator": "LaTeX with hyperref package"}}}