{"id": "1506.05849", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "18-Jun-2015", "title": "An Iterative Convolutional Neural Network Algorithm Improves Electron Microscopy Image Segmentation", "abstract": "To build the connectomics map of the brain, we developed a new algorithm that can automatically refine the Membrane Detection Probability Maps (MDPM) generated to perform automatic segmentation of electron microscopy (EM) images. To achieve this, we executed supervised training of a convolutional neural network to recover the removed center pixel label of patches sampled from a MDPM. MDPM can be generated from other machine learning based algorithms recognizing whether a pixel in an image corresponds to the cell membrane. By iteratively applying this network over MDPM for multiple rounds, we were able to significantly improve membrane segmentation results.", "histories": [["v1", "Thu, 18 Jun 2015 23:11:40 GMT  (353kb)", "http://arxiv.org/abs/1506.05849v1", null]], "reviews": [], "SUBJECTS": "cs.NE cs.LG", "authors": ["xundong wu"], "accepted": false, "id": "1506.05849"}, "pdf": {"name": "1506.05849.pdf", "metadata": {"source": "CRF", "title": "An Iterative Convolutional Neural Network Algorithm Improves Electron Microscopy Image Segmentation", "authors": [], "emails": [], "sections": [{"heading": "1 Introduction", "text": "In fact, it is such that most of them will be able to go into another world, in which they are able to move, in which they are able to move, in which they move, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live in which they live, in which they live, in which they live, in which they live, in which they live in which they live, in which they live, in which they live, in which they live, in which they live in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they live, in which they, in which they live, in which they live, in which they, in which they, in which they live, in which they, in which they"}, {"heading": "3 System description and result", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3 .1 Da ta se t descr ip t io n", "text": "The data set used in this experiment consists of two stacks of EM images used in the ISBI 2012 EM segmentation challenge. One stack contains 30 EM images and associated labels for training. The other stack also contains 30 images with hidden labels."}, {"heading": "3 .2 B a se co nv o lut io na l ne tw o rk t ra in ing", "text": "The network used in this part is analogous to the convolutional network implemented by Ciresan. [8] However, it can be replaced by another algorithm that generates a high quality membrane detection probability map. To distinguish the two networks, we call this base network CNN and the iteration Convolutional Neural Network I-CNN from here. As in the work of Ciresan [8], CNN is designed to increase the probability of whether the pixel is in the center of a particular image patch (65x65 size), is a membrane pixel. The difference is that our network has 4 convolutionary layers, a fully connected layer and a soft-max layer. Rectified activation functions are used in the network where a soft-max function is used. Also, similar to the work of Ciresan Ciresan [8], we extend the dataset by rotation, flipping and mirroring images in total of 8 different transformations."}, {"heading": "3 . 3 Genera t io n o f M DPM f o r t ra in ing se t i ma g e s", "text": "In the next section, we describe our approach to refining the probability map for better segmentation accuracy. The idea here is to train another revolutionary network that can refine the raw MDPM to achieve better segmentation performance. For this task, we use the raw MDPM with its corresponding segment map to train the network. To train an I-CNN that can refine an MDPM to achieve the final segmentation map, we need the MDPM that we can train with. If we apply the CNN described in the last section to the image set that was used to train CNN, the maps have severe overadjustment and therefore cannot be used for training. To overcome this, we have performed a tenfold split across the training set so that the network is trained with ten different versions of splits, each containing 27 training images and 3 omitted images. After training each model, the method will apply the appropriate 3 omitted images to generate the appropriate probability maps."}, {"heading": "3 .4 I t era t iv e co nv o lut io n neura l ne tw o rk", "text": "The pixel-by-pixel probability map generated from the network described in the last section showed high pixel-by-pixel accuracy, but lacked local consistency in specific areas (see Figures 1 & 2), which is incompatible with the spatial continuity of the cell membrane. In the approach described in the last two sections, contextual information is used in mind with the implicit model of cell membrane-spatial continuity, although contextual information is used to generate probability values, these probabilities are generated independently, which can leave gaps in a continuous boundary and ultimately lead to an inferior quality connector. On the other hand, we want to allow information with greater range outside the patch window (in our typical case 65x65 pixels) that spreads into the window and improves detection probability."}, {"heading": "3 .5 Resu l t", "text": "As shown in Figure 1, when we apply iteratively I-CNN to the MDPM, the first thing we notice is that by iteratively refining the probability, we gradually remove the noise in the map. After 16 rounds, the map turns out to be a map with fairly clear boundaries vs. blurred boundaries in the original MDPM. More importantly, when we zoom into areas where CNN cannot draw an affirmative conclusion about pixels, as shown in Figure 2, we can see that ICNN is able to integrate information in a neighborhood to detect (blue arrows) a section of the membrane that is shown with low probability but with good spatial continuity, and finally labels the section with high confidence and closes gaps at the boundary. At the same time, ICNN can identify noise pixels and areas (red arrow) that do not appear like a section of the membrane's surface and are eventually removed completely."}, {"heading": "4 Conclusion and Discussion", "text": "The new algorithm presented in this paper learns the diversity of membrane morphology distribution; it forces these constraints by iterating on an MDPM, refining it to adjust a membrane morphology distribution learned from the training data. However, through this process we can achieve much better consistency in adjacent pixels. A big improvement, measured by margin errors, was achieved over the original MDPM result by applying ICNN iteratively over MDPM, gathering information in the local neighborhood and obtaining significantly better consistency in adjacent pixels."}], "references": [{"title": "W", "author": ["B. Andres", "U. Kothe", "M. Helmstaedter"], "venue": "Denk, F.A. Hamprecht Segmentation of SBFSEM volume data of neural tissue by hierarchical classification. Pattern recognition, Springer", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2008}, {"title": "Contour detection and hierarchical image segmentation", "author": ["P. Arbelaez", "M. Maire", "C. Fowlkes", "J. Malik"], "venue": "Pattern Analysis and Machine Intelligence, IEEE Transactions on. 33", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2011}, {"title": "Contour detection and hierarchical image segmentation", "author": ["P. Arbelaez", "M. Maire", "C. Fowlkes", "J. Malik"], "venue": "Pattern Analysis and Machine Intelligence, IEEE Transactions on. 33", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2011}, {"title": "Network anatomy and in vivo physiology of visual cortical neurons", "author": ["D.D. Bock", "W.C.A. Lee", "A.M. Kerlin", "M.L. Andermann", "G. Hood", "A.W. Wetzel", "S. Yurgenson", "E.R. Soucy", "H.S. Kim", "R.C. Reid"], "venue": "Nature. 471", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2011}, {"title": "An integrated micro-and macroarchitectural analysis of the Drosophila brain by computer-assisted serial section electron microscopy", "author": ["A. Cardona", "S. Saalfeld", "S. Preibisch", "B. Schmid", "A. Cheng", "J. Pulokas", "P. Tomancak", "V. Hartenstein"], "venue": "PLoS biology. 8", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2010}, {"title": "Semi-automated reconstruction of neural circuits using electron microscopy", "author": ["D.B. Chklovskii", "S. Vitaladevuni", "L.K. Scheffer"], "venue": "Current opinion in neurobiology. 20", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2010}, {"title": "Deep neural networks segment neuronal membranes in electron microscopy images. In Advances in neural information processing systems (NIPS), 2843-2851", "author": ["D. Ciresan", "A. Giusti", "L.M. Gambardella", "J. Schmidhuber"], "venue": null, "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2012}, {"title": "Image Super-Resolution Using Deep Convolutional Networks", "author": ["C. Dong", "C.C. Loy", "K. He", "X. Tang"], "venue": "arXiv preprint arXiv:1501.00092.", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2014}, {"title": "Scene parsing with multiscale feature learning", "author": ["C. Farabet", "C. Couprie", "L. Najman", "Y. LeCun"], "venue": "purity trees and optimal covers. In International Conference on Machine Learning (ICML)", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2012}, {"title": "Multi-hypothesis crfsegmentation of neural tissue in anisotropic EM volumes, Arxiv preprint.(2011)", "author": ["J. Funke", "B.r. Andres", "F.A. Hamprecht", "A. Cardona", "M. Cook"], "venue": null, "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2011}, {"title": "Decomposing a scene into geometric and semantically consistent regions", "author": ["S. Gould", "R. Fulton", "D. Koller"], "venue": "International Conference on Computer Vision (ICCV)", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2009}, {"title": "Boundary learning by optimization with topological constraints", "author": ["V. Jain", "B. Bollmann", "M. Richardson", "D.R. Berger", "M.N. Helmstaedter", "K.L. Briggman", "W. Denk", "J.B. Bowden", "J.M. Mendenhall", "W.C. Abraham"], "venue": "Computer Vision and Pattern Recognition (CVPR)", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2010}, {"title": "Supervised learning of image restoration with convolutional networks", "author": ["V. Jain", "J.F. Murray", "F. Roth", "S. Turaga", "V. Zhigulin", "K.L. Briggman", "M.N. Helmstaedter", "W. Denk", "H.S. Seung"], "venue": "In International Conference on Computer Vision (ICCV)", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2007}, {"title": "Natural image denoising with convolutional networks. In Advances in neural information processing systems (NIPS), 769-776", "author": ["V. Jain", "S. Seung"], "venue": null, "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2009}, {"title": "Detection of neuron membranes in electron microscopy images using a serial neural network architecture", "author": ["E. Jurrus", "A.R. Paiva", "S. Watanabe", "J.R. Anderson", "B.W. Jones", "R.T. Whitaker", "E.M. Jorgensen", "R.E. Marc", "T. Tasdizen"], "venue": "Medical image analysis. 14", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2010}, {"title": "Associative hierarchical crfs for object class image segmentation", "author": ["L. Ladicky", "C. Russell", "P. Kohli", "P.H. Torr"], "venue": "In IEEE 12th International Conference on Computer Vision (ICCV),", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2009}, {"title": "Watershed merge forest classification for electron microscopy image stack segmentation", "author": ["T. Liu", "M. Seyedhosseini", "M. Ellisman", "T. Tasdizen"], "venue": "In IEEE International Conference on Computer Vision (ICCV)", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2013}, {"title": "Watershed merge tree classification for electron microscopy image segmentation", "author": ["T. Liu", "E. Jurrus", "M. Seyedhosseini", "M. Ellisman", "T. Tasdizen"], "venue": "International Conference on Pattern Recognition (ICPR)", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2012}, {"title": "Fully convolutional networks for semantic segmentation", "author": ["J. Long", "E. Shelhamer", "T. Darrell"], "venue": "arXiv preprint arXiv:1411.4038.", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2014}, {"title": "The human connectome: a structural description of the human brain", "author": ["O. Sporns", "G. Tononi", "R. Kotter"], "venue": "PLoS computational biology. 1", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2005}, {"title": "Superparsing: scalable nonparametric image parsing with superpixels", "author": ["J. Tighe", "S. Lazebnik"], "venue": "Computer Vision\u2212ECCV 2010, Springer", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2010}], "referenceMentions": [{"referenceID": 3, "context": "For example, a typical image set of the V1 area of a mouse brain with resolution of 4\u00d74\u00d745 nm produces 12TB of data[5].", "startOffset": 115, "endOffset": 118}, {"referenceID": 6, "context": "The post-processing can be simple, for example, simple thresholding, or creating a smooth probability map by using a median filter [8].", "startOffset": 131, "endOffset": 134}, {"referenceID": 8, "context": "Other more graphical models based on region merge/clustering techniques such as superpixel [10] and watershed merge [18;19]have also been applied on this or similar tasks to refine segmentation on top of a detection map.", "startOffset": 91, "endOffset": 95}, {"referenceID": 2, "context": "The quality of membrane detection can be directly measured by the pixels error, but just like in contour detection, a high quality membrane detection does not guarantee a good segmentation [4].", "startOffset": 189, "endOffset": 192}, {"referenceID": 11, "context": "The quality of the segmentation can be measured by the Rand index[13], which measures the resemblance of two clusters of segmentations.", "startOffset": 65, "endOffset": 69}, {"referenceID": 6, "context": "In a typical MDPM such as the one from Ciresan\u2019s work [8] the detection probability of every pixel is made in isolation, which increases the possibility of having gaps in the boundaries.", "startOffset": 54, "endOffset": 57}, {"referenceID": 9, "context": "[11] used a tree structure for segmentation hypothesis and reach segmentation with MAP inference in a CRF.", "startOffset": 0, "endOffset": 4}, {"referenceID": 7, "context": "Our approach is also related to the image super resolution convolutional neural network [9] where a convolutional neural network is trained to restore high resolution from low resolution images, and to de-noise network [15] where the purpose is to restore a noisy image.", "startOffset": 88, "endOffset": 91}, {"referenceID": 13, "context": "Our approach is also related to the image super resolution convolutional neural network [9] where a convolutional neural network is trained to restore high resolution from low resolution images, and to de-noise network [15] where the purpose is to restore a noisy image.", "startOffset": 219, "endOffset": 223}, {"referenceID": 6, "context": "The network used in this part is analogous to the convolutional network implemented by Ciresan [8].", "startOffset": 95, "endOffset": 98}, {"referenceID": 6, "context": "As in the work of Ciresan [8], CNN is trained to yield the probability of whether the pixel at the center of a given image patch (65x65 size) is a membrane pixel.", "startOffset": 26, "endOffset": 29}, {"referenceID": 6, "context": "Also, similar to the work of Ciresan[8], we augment the dataset by rotation, flipping and mirroring images in a total of 8 different transformations.", "startOffset": 36, "endOffset": 39}, {"referenceID": 6, "context": "As reported by Ciresan [8], we sampled the example patches evenly from both membrane and non-membrane classes for the training of both CNN and ICNN networks.", "startOffset": 23, "endOffset": 26}, {"referenceID": 6, "context": "Also similar to Ciresan work [8], we trained a bias correction curve to correct for bias caused by this sampling process.", "startOffset": 29, "endOffset": 32}, {"referenceID": 6, "context": "The resulting map is submitted to the ISBI challenge 2012 server for evaluation; the score is shown in Table 1 compared against the congregated result (averaged results from multiple networks output) published by Ciresan [8].", "startOffset": 221, "endOffset": 224}, {"referenceID": 6, "context": "Since this part is not the focus of this work, we did not attempt to implement multiple networks of different architectures for better precision [8].", "startOffset": 145, "endOffset": 148}, {"referenceID": 6, "context": "Convolutional network in [8] 0.", "startOffset": 25, "endOffset": 28}, {"referenceID": 18, "context": "[20] and other groups, developed full convolutional neural network that can avoid this redundant computation cost by converting a patch-wise trained convolutional neural network to a network that is able to efficiently process a whole image.", "startOffset": 0, "endOffset": 4}], "year": 2015, "abstractText": "To build the connectomics map of the brain, we developed a new algorithm that can automatically refine the Membrane Detection Probability Maps (MDPM) generated to perform automatic segmentation of electron microscopy (EM) images. To achieve this, we executed supervised training of a convolutional neural network to recover the removed center pixel label of patches sampled from a MDPM. MDPM can be generated from other machine learning based algorithms recognizing whether a pixel in an image corresponds to the cell membrane. By iteratively applying this network over MDPM for multiple rounds, we were able to significantly improve membrane segmentation results.", "creator": "Acrobat PDFMaker 9.0 for Word"}}}