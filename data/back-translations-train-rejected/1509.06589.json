{"id": "1509.06589", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "22-Sep-2015", "title": "Graph Kernels exploiting Weisfeiler-Lehman Graph Isomorphism Test Extensions", "abstract": "In this paper we present a novel graph kernel framework inspired the by the Weisfeiler-Lehman (WL) isomorphism tests. Any WL test comprises a relabelling phase of the nodes based on test-specific information extracted from the graph, for example the set of neighbours of a node. We defined a novel relabelling and derived two kernels of the framework from it. The novel kernels are very fast to compute and achieve state-of-the-art results on five real-world datasets.", "histories": [["v1", "Tue, 22 Sep 2015 13:21:08 GMT  (120kb,D)", "http://arxiv.org/abs/1509.06589v1", null]], "reviews": [], "SUBJECTS": "cs.LG cs.AI", "authors": ["giovanni da san martino", "nicol\\`o navarin", "alessandro sperduti"], "accepted": false, "id": "1509.06589"}, "pdf": {"name": "1509.06589.pdf", "metadata": {"source": "CRF", "title": "Graph Kernels exploiting Weisfeiler-Lehman Graph Isomorphism Test Extensions", "authors": ["Giovanni Da San Martino", "Nicol\u00f2 Navarin", "Alessandro Sperduti"], "emails": ["dasan@math.unipd.it", "nnavarin@math.unipd.it", "sperduti@math.unipd.it"], "sections": [{"heading": "1 Introduction", "text": "A typical approach to solving machine learning tasks on structured data is to project the input data onto a vector attribute space and then perform the learning in such a space. Ideally, a good projection should ensure that non-isorphic data is represented by various vectors in the attribute space, i.e. that they are injective. If high-dimensional data, such as graphs, are involved, specific challenges arise, especially from the mathematical point of view. Core methods are considered to be one of the most successful machine learning techniques for structured data, replacing explicit projection in the attribute space with the calculation of a symmetric semi-definitive positive similarity function, which is called the core function. A great advantage of core methods methods is that they are very large, possibly infinite, features associated with a computational task by the learning algorithm."}, {"heading": "2 Weisfeiler-Lehman Isomorphism Test and Extensions", "text": "A graph is not directed if (vi, vj) such a graph is not directed, if (vi, vj) such a graph (vi, vj) such a graph is not directed, if (vi, vj) such a graph is not directed, if (vi, vj) such a graph (vi, vj) such a graph (vj) such a graph (vj) such a graph (vj) is such a graph that (vi, vi) such a graph (vi, vj) such a graph (vn) is such a graph, if vn the path is a cycle. The distance d (vi, vj) between nodes vi, vj is the length of a shortest path linking them. We can now describe the Weisfeiler-Lehman function tests and a few extensions [2], all based on a reformulation process of the nodes of a graph."}, {"heading": "3 Weisfeiler-Lehman kernel framework", "text": "Consider a function \u03c0r (G, v) depending on a parameter r, with 1 \u2264 r \u2264 K. There is a graph G = (V, E, L) that differs from the original graph only in the naming function. Definition (G, G) is any kernel for graphs that we will call the base kernel. (2) Since the functions in eq. (1) are well defined and the extended Weisfeiler-Lehman kernels with h iterations, depth K and base kernel k () is defined as: WLKh (G). (2) Since the functions in eq. (1) are well defined and the extended WeisfeilerLehman kernels of eq. (2) is a finite sum of positive functions."}, {"heading": "4 Experimental results", "text": "In this section, we will compare the two kernels, which in Section 3 are compared against other state-of-the-art kernels on five real datasets. We will consider the Fast Subtree Kernel [14], the ODD-STh Kernel [5] (described in Section 3), and the NSPDK Kernel [3], which calculates the exact matches between the pairs of subgraphs with controlled size and distance. To evaluate the performance of the proposed kernels, we will consider five real datasets: CAS1, CPDB [10], AIDS [20], NCI1 [18], NCI1 [18], and GDD [7]. All datasets represent binary classification problems. The first four datasets contain chemical compounds, which are represented as graphs where the nodes represent the atoms (labeled by the atom type) and the connections between them. In chemical compounds, there are no self-loops."}, {"heading": "5 Conclusions and future work", "text": "This work proposed a new framework for the definition of graph cores, based on a generalization of the one-dimensional WL test, which can be instantiated with any kernel for graphs as base cores. In particular, we analyzed two cases inspired by the Decompositional DAG's graph cores [5], both cores exhibiting state-of-the-art predictive power on five real-world datasets, with a computational load that grows on such datasets only linearly with respect to kernel parameters. As future work, we will explore other members of the framework."}], "references": [{"title": "Shortest-Path Kernels on Graphs", "author": ["K.M. Borgwardt", "H.-P. Kriegel"], "venue": "ICDM, pages 74\u201381,", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2005}, {"title": "An optimal lower bound on the number of variables for graph identification", "author": ["J.-Y. Cai", "M. Furer", "N. Immerman"], "venue": "Combinatorica, 12(4):389\u2013410, Dec.", "citeRegEx": "2", "shortCiteRegEx": null, "year": 1992}, {"title": "Fast neighborhood subgraph pairwise distance kernel", "author": ["F. Costa", "K. De Grave"], "venue": "In ICML,", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2010}, {"title": "Martino, N", "author": ["G. Da Sa"], "venue": "Navarin, and A. Sperduti. A memory efficient graph kernel. In The 2012 International Joint Conference on Neural Networks (IJCNN). Ieee, June", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2012}, {"title": "Martino, N", "author": ["G. Da Sa"], "venue": "Navarin, and A. Sperduti. A Tree-Based Kernel for Graphs. SDM, pages 975\u2013986,", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2012}, {"title": "A new refinement procedure for graph isomorphism algorithms", "author": ["M. de Oliveira Oliveira", "F. Greve"], "venue": "Electronic Notes in Discrete Mathematics,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2005}, {"title": "Distinguishing Enzyme Structures from Non-enzymes Without Alignments", "author": ["P.D. Dobson", "A.J. Doig"], "venue": "Journal of Molecular Biology, 330(4):771\u2013783,", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2003}, {"title": "On Graph Kernels : Hardness Results and Efficient Alternatives", "author": ["T. Gartner", "P. Flach", "S. Wrobel"], "venue": "Lecture notes in computer science, pages 129\u2013143,", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2003}, {"title": "Efficient Path Kernels for Reaction Function Prediction", "author": ["M. Heinonen", "N. V\u00e4lim\u00e4ki", "V. M\u00e4kinen", "J. Rousu"], "venue": "Bioinformatics Models, Methods and Algorithms,", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2012}, {"title": "Data mining and machine learning techniques for the identification of mutagenicity inducing substructures and structure activity relationships of noncongeneric compounds", "author": ["C. Helma", "T. Cramer", "S. Kramer", "L. De Raedt"], "venue": "Journal of chemical information and computer sciences, 44(4):1402\u201311,", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2004}, {"title": "Marginalized kernels between labeled graphs", "author": ["H. Kashima", "K. Tsuda", "A. Inokuchi"], "venue": "In ICML, pages 321\u2013328. AAAI Press,", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2003}, {"title": "Graph kernels based on tree patterns for molecules", "author": ["P. Mah\u00e9", "J.-P. Vert"], "venue": "Machine Learning, 75(1):3\u201335, Oct.", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2008}, {"title": "The complexity of McKay\u2019s canonical labeling algorithm", "author": ["T. Miyazaki"], "venue": "Groups and Computation II,", "citeRegEx": "13", "shortCiteRegEx": null, "year": 1997}, {"title": "Fast subtree kernels on graphs", "author": ["N. Shervashidze", "K. Borgwardt"], "venue": "In NIPS, pages 1660\u20131668,", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2009}, {"title": "Efficient graphlet kernels for large graph comparison", "author": ["N. Shervashidze", "K. Mehlhorn", "T.H. Petri", "S.V.N. Vishwanathan", "K. Borgwardt"], "venue": "In AISTATS, volume 5, pages 488\u2013495,", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2009}, {"title": "Fast Computation of Graph Kernels", "author": ["S.V.N. Vishwanathan", "K.M. Borgwardt", "N.N. Schraudolph"], "venue": "In NIPS, pages 1449\u20131456,", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2006}, {"title": "Fast Kernels for String and Tree Matching", "author": ["S.V.N. Vishwanathan", "A.J. Smola"], "venue": "In S. Becker, S. Thrun, and K. Obermayer, editors, NIPS, pages 569\u2013576. MIT Press,", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2002}, {"title": "Comparison of descriptor spaces for chemical compound retrieval and classification", "author": ["N. Wale", "I. Watson", "G. Karypis"], "venue": "Knowledge and Information Systems, 14(3):347\u2013375,", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2008}, {"title": "On construction and identification of graphs", "author": ["B. Weisfeiler"], "venue": "Lecture Notes in Mathematics,", "citeRegEx": "19", "shortCiteRegEx": null, "year": 1976}, {"title": "New soluble-formazan assay for HIV-1 cytopathic effects: application to high-flux screening of synthetic and natural products for AIDS-antiviral activity", "author": ["O.S. Weislow", "R. Kiser", "D.L. Fine", "J. Bader", "R.H. Shoemaker", "M.R. Boyd"], "venue": "Journal of the National Cancer Institute, 81(8):577\u2013586,", "citeRegEx": "20", "shortCiteRegEx": null, "year": 1989}], "referenceMentions": [{"referenceID": 17, "context": "In many real world learning problems, input data are naturally represented as graphs [18][20].", "startOffset": 85, "endOffset": 89}, {"referenceID": 19, "context": "In many real world learning problems, input data are naturally represented as graphs [18][20].", "startOffset": 89, "endOffset": 93}, {"referenceID": 7, "context": "Unfortunately, any kernel function for graphs, whose correspondent feature space projection is injective, is as hard to compute as deciding whether two graphs are isomorphic [8], which is believed to be a NP-Hard problem.", "startOffset": 174, "endOffset": 177}, {"referenceID": 10, "context": "Such substructures include walks [11] [12] [16], paths [1] [9], specific types of subgraphs [3] [15] and tree structures [5].", "startOffset": 33, "endOffset": 37}, {"referenceID": 11, "context": "Such substructures include walks [11] [12] [16], paths [1] [9], specific types of subgraphs [3] [15] and tree structures [5].", "startOffset": 38, "endOffset": 42}, {"referenceID": 15, "context": "Such substructures include walks [11] [12] [16], paths [1] [9], specific types of subgraphs [3] [15] and tree structures [5].", "startOffset": 43, "endOffset": 47}, {"referenceID": 0, "context": "Such substructures include walks [11] [12] [16], paths [1] [9], specific types of subgraphs [3] [15] and tree structures [5].", "startOffset": 55, "endOffset": 58}, {"referenceID": 8, "context": "Such substructures include walks [11] [12] [16], paths [1] [9], specific types of subgraphs [3] [15] and tree structures [5].", "startOffset": 59, "endOffset": 62}, {"referenceID": 2, "context": "Such substructures include walks [11] [12] [16], paths [1] [9], specific types of subgraphs [3] [15] and tree structures [5].", "startOffset": 92, "endOffset": 95}, {"referenceID": 14, "context": "Such substructures include walks [11] [12] [16], paths [1] [9], specific types of subgraphs [3] [15] and tree structures [5].", "startOffset": 96, "endOffset": 100}, {"referenceID": 4, "context": "Such substructures include walks [11] [12] [16], paths [1] [9], specific types of subgraphs [3] [15] and tree structures [5].", "startOffset": 121, "endOffset": 124}, {"referenceID": 4, "context": "Such kernels, with the exception of the ones in [5] and [9], are computationally too demanding to be used with large datasets and are effective when the correspondent features are relevant for the current task.", "startOffset": 48, "endOffset": 51}, {"referenceID": 8, "context": "Such kernels, with the exception of the ones in [5] and [9], are computationally too demanding to be used with large datasets and are effective when the correspondent features are relevant for the current task.", "startOffset": 56, "endOffset": 59}, {"referenceID": 13, "context": "Kernel has been proposed [14].", "startOffset": 25, "endOffset": 29}, {"referenceID": 18, "context": "The kernel computes a rough approximation of the one-dimensional Weisfeiler-Lehman isomorphism test [19], with the explicit goal of being fast to compute.", "startOffset": 100, "endOffset": 104}, {"referenceID": 1, "context": "We can now describe the Weisfeiler-Lehman isomorphism test and a few extensions [2] [6], which are all based on a relabelling process of the nodes of a graph G = (V,E,L).", "startOffset": 80, "endOffset": 83}, {"referenceID": 5, "context": "We can now describe the Weisfeiler-Lehman isomorphism test and a few extensions [2] [6], which are all based on a relabelling process of the nodes of a graph G = (V,E,L).", "startOffset": 84, "endOffset": 87}, {"referenceID": 12, "context": "Note that i\u2217 \u2264 |V | for the 1-dim WL test [13].", "startOffset": 42, "endOffset": 46}, {"referenceID": 5, "context": "Their idea is to enrich the type of information used in the relabelling phase [6], [13].", "startOffset": 78, "endOffset": 81}, {"referenceID": 12, "context": "Their idea is to enrich the type of information used in the relabelling phase [6], [13].", "startOffset": 83, "endOffset": 87}, {"referenceID": 12, "context": "The extension proposed by Miyazaki [13] considers the colour of the nodes up to distance K: \u03c0(G, v) = {(l, u)|u \u2208 V, d(v, u) = l \u2264 K}; \u03c0(G, v) elements, i.", "startOffset": 35, "endOffset": 39}, {"referenceID": 5, "context": "[6], h() is defined on paths, which are ordered according to the sequence of labels of the nodes in the path.", "startOffset": 0, "endOffset": 3}, {"referenceID": 4, "context": "In order to have a canonical representation for the DAG Dr(v), the ordering for DAG nodes described in [5] is used.", "startOffset": 103, "endOffset": 106}, {"referenceID": 3, "context": "The function h() assigns a unique numerical value to each DAG, and it can be implemented efficiently as presented in [4].", "startOffset": 117, "endOffset": 120}, {"referenceID": 4, "context": "Then it can be shown that |Dr| is O(\u03c1) [5], where \u03c1 is the maximum node outdegree.", "startOffset": 39, "endOffset": 42}, {"referenceID": 4, "context": "Computing all the indices Li\u03c0r () for a graph G has worst-case time complexity O(|Dr||V | log |Dr||V |) (see [5] for details).", "startOffset": 109, "endOffset": 112}, {"referenceID": 16, "context": "Finally, k() can be defined as any kernel for trees applied to T (v) and T (v\u2032), for example the subtree kernel (ST) [17]:", "startOffset": 117, "endOffset": 121}, {"referenceID": 4, "context": "By using the algorithm described in [5], the complexity of computing eq.", "startOffset": 36, "endOffset": 39}, {"referenceID": 13, "context": "The Fast Subtree Kernel (FS) counts the number of identical subtree patterns of depth h [14].", "startOffset": 88, "endOffset": 92}, {"referenceID": 4, "context": "The ODD-STh, described in [5], is an instance of the WLDDK of eq.", "startOffset": 26, "endOffset": 29}, {"referenceID": 13, "context": "We considered the Fast Subtree kernel [14], the ODD-STh kernel [5] (described in section 3) and the NSPDK kernel [3] , that computes the exact matches between pairs of subgraphs with controlled size and distance.", "startOffset": 38, "endOffset": 42}, {"referenceID": 4, "context": "We considered the Fast Subtree kernel [14], the ODD-STh kernel [5] (described in section 3) and the NSPDK kernel [3] , that computes the exact matches between pairs of subgraphs with controlled size and distance.", "startOffset": 63, "endOffset": 66}, {"referenceID": 2, "context": "We considered the Fast Subtree kernel [14], the ODD-STh kernel [5] (described in section 3) and the NSPDK kernel [3] , that computes the exact matches between pairs of subgraphs with controlled size and distance.", "startOffset": 113, "endOffset": 116}, {"referenceID": 9, "context": "datasets: CAS1, CPDB [10], AIDS [20], NCI1 [18] and GDD [7].", "startOffset": 21, "endOffset": 25}, {"referenceID": 19, "context": "datasets: CAS1, CPDB [10], AIDS [20], NCI1 [18] and GDD [7].", "startOffset": 32, "endOffset": 36}, {"referenceID": 17, "context": "datasets: CAS1, CPDB [10], AIDS [20], NCI1 [18] and GDD [7].", "startOffset": 43, "endOffset": 47}, {"referenceID": 6, "context": "datasets: CAS1, CPDB [10], AIDS [20], NCI1 [18] and GDD [7].", "startOffset": 56, "endOffset": 59}, {"referenceID": 4, "context": "For more information about the datasets, please refer to [5].", "startOffset": 57, "endOffset": 60}, {"referenceID": 13, "context": "For parameter selection we adopt a technique commonly referred to as nested K-fold cross validation following [14].", "startOffset": 110, "endOffset": 114}, {"referenceID": 4, "context": "In particular, we analyzed two instances inspired by the Decompositional DAGs graph kernels [5].", "startOffset": 92, "endOffset": 95}], "year": 2015, "abstractText": "In this paper we present a novel graph kernel framework inspired the by the Weisfeiler-Lehman (WL) isomorphism tests. Any WL test comprises a relabelling phase of the nodes based on test-specific information extracted from the graph, for example the set of neighbours of a node. We defined a novel relabelling and derived two kernels of the framework from it. The novel kernels are very fast to compute and achieve state-of-the-art results on five real-world datasets.", "creator": "LaTeX with hyperref package"}}}