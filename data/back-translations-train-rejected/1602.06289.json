{"id": "1602.06289", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "19-Feb-2016", "title": "Learning to SMILE(S)", "abstract": "This paper shows how one can directly apply natural language processing (NLP) methods to classification problems in cheminformatics. Connection between these seemingly separate fields is shown by considering standard textual representation of compound, SMILES. The problem of activity prediction against a target protein is considered, which is a crucial part of computer aided drug design process. Conducted experiments show that this way one can not only outrank state of the art results of hand crafted representations but also gets direct structural insights into the way decisions are made.", "histories": [["v1", "Fri, 19 Feb 2016 20:48:19 GMT  (253kb)", "http://arxiv.org/abs/1602.06289v1", null]], "reviews": [], "SUBJECTS": "cs.CL", "authors": ["stanis{\\l}aw jastrz\\k{e}bski", "damian le\\'sniak", "wojciech marian czarnecki"], "accepted": false, "id": "1602.06289"}, "pdf": {"name": "1602.06289.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": ["stanislaw.jastrzebski@uj.edu.pl"], "sections": [{"heading": null, "text": "ar Xiv: 160 2.06 289v 1 [cs.C L"}, {"heading": "1 Introduction", "text": "Computer-aided drug design has become a very popular technique for accelerating the process of finding new biologically active substances by drastically reducing the number of substances to be tested in the laboratory. Crucial part of this process is virtual screening, in which one looks at a series of molecules and predicts whether the molecules will bind to a particular protein. This research focuses on ligand-based virtual screening, in which the problem is modeled as a supervised binary classification task, using only knowledge about ligands (drug candidates) rather than using information about the target (protein).One of the most under-represented areas of deep learning (DL) is probably cheminformatics [Unterthiner et al., 2014, Bengio et al., 2012] mainly due to the fact that data is naturally presented as graphs and there are few direct ways to apply DL in such an environment [Unterthiner et al., 2014, Bengio et al., 2012]."}, {"heading": "1.1 Representing molecules", "text": "The standard method of displaying compounds in a chemical database is called SMILES, which is merely a chain of atoms and bonds that construct the molecule (see Fig. 1), using a particular path over the graph. Surprisingly, this representation is rarely used as a basis for machine learning (ML) [Worachartcheewan et al., 2014, Toropov et al., 2010].Most of the classic ML models used in chemical informatics (such as Support Vector Machines or Random Forest) work with constant vector representation through some predefined embedding (so-called fingerprints).As a result, many such fingerprints have been proposed over the years [Hall and Kier, 1995, Steinbeck et al., 2003]. One of the most common is the substructural - analog - bag representations in NLP, where fingerprints are defined as a set of diagram templates (SMARTS) that are then used to relate the molecule to produce it."}, {"heading": "1.2 Analogy to sentiment analysis", "text": "The most important contribution of this paper is the identification of the analogy to NLP and, in particular, sentiment analysis, which is directly tested on the SMILES representation by applying state-of-the-art methods [Mesnil et al., 2014]. The analogy is motivated by two facts: First, small local structural changes can imply large general changes in activity (see Fig. 2), just as sentiment is a function of the feelings of different sentences and their compounds, which is the main argument for the effectiveness of DL methods in this task [Socher et al., 2013]. Second, the compound diagram is surprisingly almost always a tree. To confirm this assertion, we calculate molecular diameters, defined as the maximum across all atoms of the minimum distance between given atom and the longest carbon chain in the molecule. It seems that molecules analyzed in practice have a diameter between 1 and 6 with an average of 4."}, {"heading": "2 Experiments", "text": "Five datasets are considered. In addition to SMILES, two basic fingerprint compounds are used, namely MACCS Ewing et al. [2006] and Klekota-Roth Klekota and Roth [2008] (KR; is considered state of the art in substructural representation [Czarnecki et al., 2015]. Each dataset is relatively small (mean size is 3000) and most datasets are slightly unbalanced (with an average class ratio of about 1: 2). Thus, it is not worth using numbers 1: SMILES produced for the compound in the figure is N (c1) ccc1N.Figure 2: Replacing highlighted carbon atoms with nitrogen renders compounds inactive. Figure 3: Visualization of CNN size 5 filters for active (top row) and inactive molecules."}, {"heading": "2.1 Results", "text": "The results are presented in Table 1. Firstly, the performance of simple n-gram models (SVM, RF) is close to the hand-crafted state-of-the-art representation, suggesting that potentially any NLP classifier working with n-gram representation could be applicable. Perhaps even more interesting is that the current state-of-the-art model for mood analysis - CNN - outperforms traditional models (albeit by a small margin) despite its small dataset size. Hyperparameters selected for CNN (CONTEXT) are similar to the parameters reported in [Johnson and Zhang, 2015]. In particular, maximum merging (as opposed to average pooling) and moderately large regions (5 and 3) performed best (see Figure 3). This effect for NLP strongly correlates with the fact that a small portion of the set can greatly contribute to general mood, confirming the claimed molecular mood analogously."}, {"heading": "3 Conclusions", "text": "This paper focuses on the problem of predicting the activity of compounds without handmade features used to represent complex molecules. Analogies presented to NLP problems, and in particular sentiment analysis, followed by experiments conducted using state-of-the-art methods from both NLP and chemical informatics, seem to confirm that one can indeed learn directly from the raw string representation of SMILES rather than currently using it. In particular, experiments conducted show that CNN-based solutions, although trained on relatively small datasets, can in fact surpass state-of-the-art methods based on structural fingerprints in ligand virtual screening tasks, while offering the opportunity to easily integrate unattended and semi-monitored techniques into the models using huge databases of chemical compounds. It seems that chemical informatics can greatly benefit from NLP and further research in this direction should be undertaken."}, {"heading": "Acknowledgments", "text": "The first author was supported by the grant number DI 2014 / 016644 of the Polish Ministry of Science and Higher Education."}], "references": [{"title": "Unsupervised feature learning and deep learning: A review and new perspectives", "author": ["Yoshua Bengio", "Aaron Courville", "Pascal Vincent"], "venue": "CoRR, abs/1206.5538,", "citeRegEx": "Bengio et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Bengio et al\\.", "year": 2012}, {"title": "Robust optimization of svm hyperparameters in the classification of bioactive compounds", "author": ["Wojciech Marian Czarnecki", "Sabina Podlewska", "Andrzej Bojarski"], "venue": "Journal of Cheminformatics,", "citeRegEx": "Czarnecki et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Czarnecki et al\\.", "year": 2015}, {"title": "Multi-task neural networks for QSAR predictions", "author": ["George Dahl", "Navdeep Jaitly", "Ruslan Salakhutdinov"], "venue": "CoRR, abs/1406.1231,", "citeRegEx": "Dahl et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Dahl et al\\.", "year": 2014}, {"title": "Semi-supervised sequence learning", "author": ["Andrew Dai", "Quoc Viet Le"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Dai and Le.,? \\Q2015\\E", "shortCiteRegEx": "Dai and Le.", "year": 2015}, {"title": "Convolutional networks on graphs for learning molecular fingerprints", "author": ["David Kristjanson Duvenaud", "Dougal Maclaurin", "Jorge Aguilera-Iparraguirre", "Rafael G\u00f3mez-Bombarelli", "Timothy Hirzel", "Al\u00e1n Aspuru-Guzik", "Ryan Prescott Adams"], "venue": "CoRR, abs/1509.09292,", "citeRegEx": "Duvenaud et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Duvenaud et al\\.", "year": 2015}, {"title": "Novel 2d fingerprints for ligandbased virtual screening", "author": ["Todd Ewing", "J. Christian Baber", "Miklos Feher"], "venue": "Journal of Chemical Information and Modeling,", "citeRegEx": "Ewing et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Ewing et al\\.", "year": 2006}, {"title": "Electrotopological state indices for atom types: A novel combination of electronic, topological, and valence state information", "author": ["Lowell Hall", "Lemont Kier"], "venue": "Journal of Chemical Information and Computer Sciences,", "citeRegEx": "Hall and Kier.,? \\Q1995\\E", "shortCiteRegEx": "Hall and Kier.", "year": 1995}, {"title": "Deep convolutional networks on graphstructured data", "author": ["Mikael Henaff", "Joan Bruna", "Yann LeCun"], "venue": "CoRR, abs/1506.05163,", "citeRegEx": "Henaff et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Henaff et al\\.", "year": 2015}, {"title": "Effective use of word order for text categorization with convolutional neural networks", "author": ["Rie Johnson", "Tong Zhang"], "venue": "In NAACL HLT 2015, The 2015 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies,", "citeRegEx": "Johnson and Zhang.,? \\Q2015\\E", "shortCiteRegEx": "Johnson and Zhang.", "year": 2015}, {"title": "Exploring the limits of language modeling. volume abs/1602.02410, 2016", "author": ["Rafal Jozefowicz", "Oriol Vinyals", "Mike Schuster", "Noam Shazeer", "Yonghui Wu"], "venue": "URL http://arxiv.org/abs/1602.02410", "citeRegEx": "Jozefowicz et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Jozefowicz et al\\.", "year": 2016}, {"title": "Character-aware neural language models", "author": ["Yoon Kim", "Yacine Jernite", "David Sontag", "Alexander Rush"], "venue": "CoRR, abs/1508.06615,", "citeRegEx": "Kim et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Kim et al\\.", "year": 2015}, {"title": "Chemical substructures that enrich for biological activity", "author": ["Justin Klekota", "Frederick Roth"], "venue": "Bioinformatics, 24(21):2518\u20132525,", "citeRegEx": "Klekota and Roth.,? \\Q2008\\E", "shortCiteRegEx": "Klekota and Roth.", "year": 2008}, {"title": "Ensemble of generative and discriminative techniques for sentiment analysis of movie reviews", "author": ["Gr\u00e9goire Mesnil", "Tomas Mikolov", "Marc\u2019Aurelio Ranzato", "Yoshua Bengio"], "venue": "CoRR, abs/1412.5335,", "citeRegEx": "Mesnil et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Mesnil et al\\.", "year": 2014}, {"title": "Strategies for training large scale neural network language models", "author": ["Tomas Mikolov", "Anoop Deoras", "Daniel Povey", "Luk\u00e1s Burget", "Jan Cernock\u00fd"], "venue": "IEEE Workshop on Automatic Speech Recognition & Understanding,", "citeRegEx": "Mikolov et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Mikolov et al\\.", "year": 2011}, {"title": "Rnnlm-recurrent neural network language modeling toolkit", "author": ["Tomas Mikolov", "Stefan Kombrink", "Anoop Deoras", "Lukar Burget", "Jan Cernocky"], "venue": "Proc. of the 2011 ASRU Workshop,", "citeRegEx": "Mikolov et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Mikolov et al\\.", "year": 2011}, {"title": "A multidimensional analysis of machine learning methods performance in the classification of bioactive compounds", "author": ["Sabina Smusz", "Rafa\u0142 Kurczab", "Andrzej Bojarski"], "venue": "Chemometrics and Intelligent Laboratory Systems,", "citeRegEx": "Smusz et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Smusz et al\\.", "year": 2013}, {"title": "Recursive Deep Models for Semantic Compositionality Over a Sentiment Treebank", "author": ["Richard Socher", "Alex Perelygin", "Jean Wu", "Jason Chuang", "Christopher D. Manning", "Andrew Ng", "Christopher Potts"], "venue": "In Proceedings of the 2013 Conference on Empirical Methods in Natural Language Processing,", "citeRegEx": "Socher et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Socher et al\\.", "year": 2013}, {"title": "The chemistry development kit (cdk): An open-source java library for chemo- and bioinformatics", "author": ["Christoph Steinbeck", "Yongquan Han", "Stefan Kuhn", "Oliver Horlacher", "Edgar Luttmann", "Egon Willighagen"], "venue": "Journal of Chemical Information and Computer Sciences,", "citeRegEx": "Steinbeck et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Steinbeck et al\\.", "year": 2003}, {"title": "Smiles-based optimal descriptors: Qsar modeling of carcinogenicity by balance of correlations with ideal slopes", "author": ["Andrey Toropov", "Alla Toropova", "E Benfenati"], "venue": "European journal of medicinal chemistry,", "citeRegEx": "Toropov et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Toropov et al\\.", "year": 2010}, {"title": "Deep learning as an opportunity in virtual screening", "author": ["Thomas Unterthiner", "Andreas Mayr", "G\u00fcnter Klambauer", "Marvin Steijaert", "J\u00f6rg Wenger", "Hugo Ceulemans", "Sepp Hochreiter"], "venue": "Deep Learning and Representation", "citeRegEx": "Unterthiner et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Unterthiner et al\\.", "year": 2014}, {"title": "Large-scale qsar study of aromatase inhibitors using smiles-based descriptors", "author": ["Apilak Worachartcheewan", "Prasit Mandi", "Virapong Prachayasittikul", "Alla Toropova", "Andrey Toropov", "Chanin Nantasenamat"], "venue": "Chemometrics and Intelligent Laboratory Systems,", "citeRegEx": "Worachartcheewan et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Worachartcheewan et al\\.", "year": 2014}], "referenceMentions": [{"referenceID": 7, "context": ", 2012], mostly due the fact that data is naturally represented as graphs and there are little direct ways of applying DL in such setting [Henaff et al., 2015].", "startOffset": 138, "endOffset": 159}, {"referenceID": 2, "context": "Notable examples of DL successes in this domain are winning entry to Merck competition in 2012 [Dahl et al., 2014] and Convolutional Neural Network (CNN) used for improving data representation [Duvenaud et al.", "startOffset": 95, "endOffset": 114}, {"referenceID": 4, "context": ", 2014] and Convolutional Neural Network (CNN) used for improving data representation [Duvenaud et al., 2015].", "startOffset": 86, "endOffset": 109}, {"referenceID": 12, "context": "The main contribution of this paper is identifying analogy to NLP and specifically sentiment analysis, which is tested by applying state of the art methods [Mesnil et al., 2014] directly to SMILES representation.", "startOffset": 156, "endOffset": 177}, {"referenceID": 16, "context": "2), just like sentiment is a function of sentiments of different clauses and their connections, which is the main argument for effectiveness of DL methods in this task [Socher et al., 2013].", "startOffset": 168, "endOffset": 189}, {"referenceID": 1, "context": "[2006] and Klekota\u2013Roth Klekota and Roth [2008] (KR; considered state of the art in substructural representation [Czarnecki et al., 2015]).", "startOffset": 113, "endOffset": 137}, {"referenceID": 4, "context": "Except SMILES, two baseline fingerprint compound representations are used, namely MACCS Ewing et al. [2006] and Klekota\u2013Roth Klekota and Roth [2008] (KR; considered state of the art in substructural representation [Czarnecki et al.", "startOffset": 88, "endOffset": 108}, {"referenceID": 4, "context": "Except SMILES, two baseline fingerprint compound representations are used, namely MACCS Ewing et al. [2006] and Klekota\u2013Roth Klekota and Roth [2008] (KR; considered state of the art in substructural representation [Czarnecki et al.", "startOffset": 88, "endOffset": 149}, {"referenceID": 8, "context": "For CNN, purely supervised version of CONTEXT, current state of the art in sentiment analysis [Johnson and Zhang, 2015], is used.", "startOffset": 94, "endOffset": 119}, {"referenceID": 8, "context": "Hyperparameters selected for CNN (CONTEXT) are similar to the parameters reported in [Johnson and Zhang, 2015].", "startOffset": 85, "endOffset": 110}, {"referenceID": 3, "context": "One alternative is to consider semi-supervised version of RNN [Dai and Le, 2015].", "startOffset": 62, "endOffset": 80}], "year": 2016, "abstractText": "This paper shows how one can directly apply natural language processing (NLP) methods to classification problems in cheminformatics. Connection between these seemingly separate fields is shown by considering standard textual representation of compound, SMILES. The problem of activity prediction against a target protein is considered, which is a crucial part of computer aided drug design process. Conducted experiments show that this way one can not only outrank state of the art results of hand crafted representations but also gets direct structural insights into the way decisions are made.", "creator": "dvips(k) 5.991 Copyright 2011 Radical Eye Software"}}}