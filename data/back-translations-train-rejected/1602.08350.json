{"id": "1602.08350", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "26-Feb-2016", "title": "Large-Scale Detection of Non-Technical Losses in Imbalanced Data Sets", "abstract": "Non-technical losses (NTL) such as electricity theft cause significant harm to our economies, as in some countries they may range up to 40% of the total electricity distributed. Detecting NTLs requires costly on-site inspections. Accurate prediction of NTLs for customers using machine learning is therefore crucial. To date, related research largely ignore that the two classes of regular and non-regular customers are highly imbalanced, that NTL proportions may change and mostly consider small data sets, often not allowing to deploy the results in production. In this paper, we present a comprehensive approach to assess three NTL detection models for different NTL proportions in large real world data sets of 100Ks of customers: Boolean rules, fuzzy logic and Support Vector Machine. This work has resulted in appreciable results that are about to be deployed in a leading industry solution. We believe that the considerations and observations made in this contribution are necessary for future smart meter research in order to report their effectiveness on imbalanced and large real world data sets.", "histories": [["v1", "Fri, 26 Feb 2016 14:49:29 GMT  (108kb)", "https://arxiv.org/abs/1602.08350v1", null], ["v2", "Tue, 25 Jul 2017 04:44:12 GMT  (108kb)", "http://arxiv.org/abs/1602.08350v2", "Proceedings of the Seventh IEEE Conference on Innovative Smart Grid Technologies (ISGT 2016)"]], "reviews": [], "SUBJECTS": "cs.LG cs.AI", "authors": ["patrick o glauner", "re boechat", "lautaro dolberg", "radu state", "franck bettinger", "yves rangoni", "diogo duarte"], "accepted": false, "id": "1602.08350"}, "pdf": {"name": "1602.08350.pdf", "metadata": {"source": "CRF", "title": "Large-Scale Detection of Non-Technical Losses in Imbalanced Data Sets", "authors": ["Patrick Glauner", "Andre Boechat", "Lautaro Dolberg", "Radu State", "Franck Bettinger", "Yves Rangoni", "Diogo Duarte"], "emails": ["first.last@uni.lu", "first.last@choiceholding.com"], "sections": [{"heading": null, "text": "This year is the highest in the history of the country."}, {"heading": "II. RELATED WORK", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A. Literature review", "text": "In fact, most of them will be able to do so without being able to play by the rules."}, {"heading": "B. Challenge of supervised learning for anomaly detection", "text": "It should be noted that most NTL detection methods are monitored, and detection of anomalies - a superclass of NTL - is generally difficult to learn for the reasons stated in [16]: (i) anomalies data sets contain a very small number of positive examples and a large number of negative examples, resulting in unbalanced classes, (ii) it is used for many different types of anomalies, since it is difficult for any algorithm to learn from only a few positive examples what the anomalies might look like, and (iii) there may also be future anomalies that may look completely different from all the anomalies learned so far. In contrast, supervised learning works best for (i) a large number of positive and negative examples, (ii) if there are enough positive examples so that the algorithm can get a sense of what positive examples might look like, and (iii) future positive examples are likely to be similar to those in the training set."}, {"heading": "III. NTL DETECTION", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A. Data", "text": "The data used in this paper comes from a Brazilian electricity provider. It consists of three parts: (i) ~ 700K customer data such as location, type, etc., (ii) ~ 31M monthly consumption data from January 2011 to January 2015 such as consumption in kWh, meter reading date and number of days between meters, and (iii) ~ 400K inspection data such as presence of fraud or irregularities, type of NTL and inspection notes. Most inspections do not find NTLs, making the classes highly unbalanced. In order for the models to be applicable to other regions or countries, they must be evaluated based on different NTL proportions. Therefore, the data has been substamped using 17 different NTL proportions levels: 0%, 0.1%, 1%, 2%, 3%, 4%, 5%, 10%, 20%, 30%, 60%, 70%, 90% and 100%. Each sample contains ~ 100K."}, {"heading": "B. Models", "text": "(1), (2), (2), (2), (2), (2, 2, \"(2,\"), (2, \"(2,\"), (2, \"), (2,\" (2, \"), (2,\" (2, \"), (2, (2,\"), (2, \", (2,\"), (2, \"), (2,\"), (2, \"(2,\"), (2, \"), (2,\"), (2, (2, \"), (2, (2,\"), (2, (2), (2, \"), (2,\"), (2, (2), (2, \"), (2, (2,\"), (2, (2, \"), (2, (2,\"), (2, (2, \"), (2, (2,\"), (2, (2,), (2, (2,), (2,), (2, (), (2, (2,), (2,), (2, (2,), (2, (2,), (2, (2,), (), (2, (2,), (2,), (2, (), (2, (2,), (2, (), (2,), (2, (2,), (2,),), (2), (2, (2,), (2), (2, (2, (), (2), (2, (), (2), (2,), (, (2),), (2), (2, (,),), (2,), (, (2), (2), (, (2,), (2,), (2), (2,), (, (2,), (, (2,), (2, (,), (2,), (2,), (, (2,), (, (2,), (2,),), (2,), (, (2), (2,), ((, ("}, {"heading": "IV. EVALUATION", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A. Metrics", "text": "In many classification problems, the classification rate, or accuracy, is used as a performance measure. However, given the number of true positives (TP), true negatives (TN), false positives (FP) and false negatives (FN): ACC = TP + TN TP + TN + FP + FN. However, many publications ignore that for unbalanced classes it is of little significance. In an NTL detection example, a data set of 990 negative and 10 positive test examples is also called true positive rate (TPR) or sensitivity: Recall = TP TP + FN. This example clearly shows that other performance measures must be used for NTL detection. Recall is a measure of the proportion of true positives."}, {"heading": "B. Methodology", "text": "Comparing the three classifiers, the AUC performance metric is used for the different levels of NTL fraction, which are listed in Section III-A. However, we have evaluated different values for the number of recent readings N. Only customers with complete time series of the last N months prior to each inspection are considered. The larger N, the less data is available. At least 12 months should be considered to represent seasonal effects. Experiments for the last 12, 18 and 24 months have been conducted for which 12 months have been proven to produce the best results, as the other experiments lead to an overhaul. Due to the lack of space, these results are excluded. SVM is the only classifier that requires training in our experiments. As it is a binary classifier, it could not be explicitly trained to NTL proportions of 0% and 100%."}, {"heading": "D. Comparison of classifier performance", "text": "For different NTL proportions, the change in the test AUC for the Boolean and fuzzy systems and the SVM system is shown in Fig. 1. The Boolean classifier has an AUC < 0.5 for all NTL proportions, and therefore performs worse than random guesses. However, the same applies to the fuzzy system, except for an NTL portion of 0.1%. The SVM performs only (significantly) better than random guesses for NTL proportions between 50% and 80%. In view of the theory of fuzzy systems and their potential, the parameters of the fuzzy system were optimized using stochastic gradient derivation (SGD) for each of the 15 binary NTL proportions: 0.1% to 90%. From the 15 optimized fuzzy systems, this is selected and tested with the largest AUC test result for bozzy systems."}, {"heading": "E. Discussion", "text": "Optimized fuzzy and SVM models trained to 30% and 60% NTL, respectively, result in significantly higher AUC values. However, both models perform very differently, as the optimized fuzzy system is more conservative in NTL production. In contrast, the optimized SVM is more optimized and also leads to higher FPR. In general, neither model can be called better than the other, as selecting the appropriate model from these two is subject to business decisions. However, this work also shows that NTL classifiers that only use the consumption profile are limited. Therefore, it is desirable to use more features such as location, inspection notes, etc., another problem with the real data is the potential bias of the inspections, so that this sample does not represent the overall customer population."}, {"heading": "V. CONCLUSION AND FUTURE WORK", "text": "In this paper, we have proposed three models for NTL detection for large datasets of 100K customers: Boolean, Fuzzy and Support Vector Machine. Unlike other results published in the literature, the optimized fuzzy and SVM models have been evaluated for different NTL proportions of real-world unbalanced consumption data, both of which have an AUC > 0.5 for all NTL proportions > 0.1% and significantly exceed simple Boolean or non-optimized fuzzy models. The improved models will soon be used in a product from CHOICE Technologies. The contribution methodology is necessary for future smart meter research to report their effectiveness in unbalanced and large datasets from the real-world. We plan to evaluate uncontrolled methods, in particular deep learning, to more accurately detect NTL by finding hidden correlations in the data. In addition, we plan to use other features in our models, such as the overall location and the cost latency, and to optimize the cost of electricity by examining the features."}], "references": [{"title": "Adaptation of Fuzzy Inference System Using Neural Learning", "author": ["A. Abraham"], "venue": "Fuzzy Systems Engineering, Studies in Fuzziness and Soft Computing,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2005}, {"title": "Detection and identification of abnormalities in customer consumptions in power distribution systems", "author": ["E. dos Angelos", "O. Saavedra", "O. Cortes", "A. De Souza"], "venue": "IEEE Transactions on Power Delivery,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2011}, {"title": "Autonomous Learning Systems: From Data Streams to Knowledge in Real-time\u201d, Wiley, ISBN: 978-1-119-95152-0", "author": ["Plamen Angelov"], "venue": null, "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2012}, {"title": "Support Vector Machine With Adaptive Parameters in Financial Time Series Forecasting", "author": ["L.J. Cao", "F.E.H. Tay"], "venue": "IEEE Transactions on Neural Networks,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2003}, {"title": "LIBSVM: A library for support vector machines", "author": ["Chih-Chung Chang", "Chih-Jen Lin"], "venue": "ACM Transactions on Intelligent Systems and Technology,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2011}, {"title": "High Performance Computing for Detection of Electricity Theft", "author": ["S.S.S.R. Depuru", "L. Wang", "V. Devabhaktuni", "R.C. Green"], "venue": "International Journal of Electrical Power & Energy Systems,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2013}, {"title": "Smart grid energy fraud detection using artificial neural networks", "author": ["V. Ford", "A. Siraj", "W. Eberle"], "venue": "IEEE Symposium on Computational Intelligence Applications in Smart Grid (CIASG),", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2014}, {"title": "Handwritten digit recognition using statistical and rule-based decision fusion", "author": ["D. Gorgevik", "D. Cakmakov", "V. Radevski"], "venue": "11th Mediterranean Electrotechnical Conference (MELECON), pp.131-135", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2002}, {"title": "The area under an ROC curve with limited information", "author": ["W.B. van den Hout"], "venue": "Medical Decision Making,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2003}, {"title": "Survey of fraud detection techniques", "author": ["Y. Kou", "C.-T. Lu", "S. Sirwongwattana", "Y.-P. Huang"], "venue": "IEEE International Conference on Networking, Sensing and Control, vol. 2, pp. 749-754", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2004}, {"title": "J", "author": ["M. Di Martino", "F. Decia"], "venue": "Molinelli and Alicia Fernandez, \u201cImproving electric fraud detection using class imbalance strategies\u201d", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2012}, {"title": "Detection of abnormalities and electricity theft using genetic Support Vector Machines,", "author": ["J. Nagi", "K.S. Yap", "S.K. Tiong", "S.K. Ahmed", "A.M. Mohammad"], "venue": "IEEE Region 10 Conference on TENCON", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2008}, {"title": "Improving SVM-Based Nontechnical Loss Detection in Power Utility Using the Fuzzy Inference System", "author": ["J. Nagi", "K.S. Yap", "S.K. Tiong", "S.K. Ahmed", "F. Nagi"], "venue": "IEEE Transactions on Power Delivery,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2011}, {"title": "Nontechnical loss detection for metered customers in power utility using support vector machines", "author": ["J. Nagi", "K.S. Yap", "S.K. Tiong", "S.K. Ahmed", "M. Mohamad"], "venue": "IEEE Transactions on Power Delivery,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2010}, {"title": "Machine Learning", "author": ["A. Ng"], "venue": "Coursera", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2014}, {"title": "Cavaretti, \u201cA New Method for the Computation of Technical Losses in Electrical Power Distribution Systems", "author": ["C.C.B. de Oliveira", "N. Kagan", "A. Meffe", "J.L.S.L. Caparroz"], "venue": "Proceedings ClRED,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2001}, {"title": "Irregularity detection on low tension electric installations by neural network ensembles", "author": ["C. Muniz", "K. Figueiredo", "M.M.B.R. Vellasco", "G. Chavez", "M.A.C. Pacheco"], "venue": "IEEE - INNS - ENNS International Joint Conference on Neural Networks,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2009}, {"title": "V", "author": ["F. Pedregosa", "G. Varoquaux", "A. Gramfort"], "venue": "Michel, V., B. Thirion, et al., \u201cScikit-learn: Machine Learning in Python\u201d, Journal of Machine Learning Research, vol. 12, pp. 2825-2830", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2011}, {"title": "Fast Non-Technical Losses Identification Through Optimum-Path Forest", "author": ["C.C.O. Ramos", "A.N. Souza", "J.P. Papa", "A.X. Falcao"], "venue": "15th International Conference on Intelligent System Applications to Power Systems (ISAP),", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2009}, {"title": "Electricity theft detection using smart meter data,", "author": ["S. Sahoo", "D. Nikovski", "T. Muso", "K. Tsuru"], "venue": "IEEE Power & Energy Society Innovative Smart Grid Technologies Conference (ISGT),", "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2015}, {"title": "frbs: Fuzzy Rule-Based Systems for Classification and Regression in R", "author": ["Lala Septem Riza", "Christoph Bergmeir", "Francisco Herrera", "Jose Manuel Benitez"], "venue": "Journal of Statistical Software,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2015}, {"title": "SVMs Modeling for Highly Imbalanced Classification", "author": ["Y. Tang", "Y.-Q. Zhang", "N.V. Chawla", "S. Krasser"], "venue": "IEEE Transactions on Systems, Man, and Cybernetics, Part B: Cybernetics,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2009}, {"title": "An overview of statistical learning theory", "author": ["Vladimir N. Vapnik"], "venue": "IEEE Transactions on Neural Networks,", "citeRegEx": "24", "shortCiteRegEx": "24", "year": 1999}, {"title": "Spark: cluster computing with working sets", "author": ["M. Zaharia", "M. Chowdhury", "M.J. Franklin", "S. Shenker", "I. Stoica"], "venue": "HotCloud\u201910 Proceedings of the 2nd USENIX conference on Hot topics in cloud computing", "citeRegEx": "25", "shortCiteRegEx": null, "year": 2010}], "referenceMentions": [{"referenceID": 5, "context": "There are different estimates of the financial losses caused by NTLs and they can range up to 40% of the total electricity distributed in countries such as Brazil, India, Malaysia or Lebanon [6], [14].", "startOffset": 191, "endOffset": 194}, {"referenceID": 12, "context": "There are different estimates of the financial losses caused by NTLs and they can range up to 40% of the total electricity distributed in countries such as Brazil, India, Malaysia or Lebanon [6], [14].", "startOffset": 196, "endOffset": 200}, {"referenceID": 5, "context": "They are also of relevance in developed countries, for example estimates of NTLs in the US range from USD 1-6 billion [6].", "startOffset": 118, "endOffset": 121}, {"referenceID": 9, "context": "NTL detection can be treated as a special case of fraud detection, for which a general survey is provided in [10].", "startOffset": 109, "endOffset": 113}, {"referenceID": 7, "context": "approaches have their justification and neither is generally better or worse than the other one in artificial intelligence [8].", "startOffset": 123, "endOffset": 126}, {"referenceID": 15, "context": "One method to detect NTLs is to calculate the energy balance [17], which requires topological information of the network.", "startOffset": 61, "endOffset": 65}, {"referenceID": 13, "context": "Support Vector Machines (SVM) are used in [15], working on daily average consumption features of the last 24 months for less than 400 highly imbalanced training examples, ignoring the class imbalance in the results reported.", "startOffset": 42, "endOffset": 46}, {"referenceID": 12, "context": "That work is combined with fuzzy logic [14] or genetic algorithms [13], focusing on an optimization of the SVM output.", "startOffset": 39, "endOffset": 43}, {"referenceID": 11, "context": "That work is combined with fuzzy logic [14] or genetic algorithms [13], focusing on an optimization of the SVM output.", "startOffset": 66, "endOffset": 70}, {"referenceID": 5, "context": "A rule-based expert system system outperforms a SVM in [6] for an unknown amount of customers, focusing on high performance implementations.", "startOffset": 55, "endOffset": 58}, {"referenceID": 1, "context": "Fuzzy logic following C-means fuzzy clustering is applied to a data set of ~20K customers in [2].", "startOffset": 93, "endOffset": 96}, {"referenceID": 16, "context": "Furthermore, neural networks using handcrafted features calculated from the consumption time series plus customer-specific pre-computed attributes are used in [18] for ~1K balanced customers.", "startOffset": 159, "endOffset": 163}, {"referenceID": 6, "context": "Applying smart half-hour meter readings of three weeks of ~6K customers are fed into a neural network in [7].", "startOffset": 105, "endOffset": 108}, {"referenceID": 18, "context": "Optimum-path forest are applied to NTL detection in [20] for ~10K customers outperforming different SVMs and a neural network.", "startOffset": 52, "endOffset": 56}, {"referenceID": 19, "context": "A different method is to estimate NTLs by subtracting an estimate of the technical losses from the overall losses [21].", "startOffset": 114, "endOffset": 118}, {"referenceID": 10, "context": "The class imbalance problem of electricity theft detection has initially been addressed in [11].", "startOffset": 91, "endOffset": 95}, {"referenceID": 14, "context": "Anomaly detection - a superclass of NTL - is generally challenging to learn in a supervised manner for the reasons stated in [16]: (i) anomaly data sets contain a very small number of positive examples and large number of negative examples, resulting in imbalanced classes, (ii) it is used for many different kinds of anomalies as it is hard for any algorithm to learn from just a few positive examples what the anomalies might look like and (iii) there may be also future anomalies which may look completely different to any of the anomalous examples learned so far.", "startOffset": 125, "endOffset": 129}, {"referenceID": 2, "context": "2) Fuzzy logic: Fuzzy systems [3] have a long tradition in control applications allowing to implement expert knowledge in a softer decision making process.", "startOffset": 30, "endOffset": 33}, {"referenceID": 2, "context": "In this paper, the 14 Boolean rules were fuzzified and incorporated in a Mamdani fuzzy system using the centroid defuzzification method [3].", "startOffset": 136, "endOffset": 139}, {"referenceID": 20, "context": "However, these parameters could be optimized using: (i) gradient techniques [22], (ii) genetic algorithms [22] or (iii) neuro-fuzzy systems [1].", "startOffset": 76, "endOffset": 80}, {"referenceID": 20, "context": "However, these parameters could be optimized using: (i) gradient techniques [22], (ii) genetic algorithms [22] or (iii) neuro-fuzzy systems [1].", "startOffset": 106, "endOffset": 110}, {"referenceID": 0, "context": "However, these parameters could be optimized using: (i) gradient techniques [22], (ii) genetic algorithms [22] or (iii) neuro-fuzzy systems [1].", "startOffset": 140, "endOffset": 143}, {"referenceID": 22, "context": "3) Support Vector Machine: A Support Vector Machine (SVM) [24] is a maximum margin classifier, i.", "startOffset": 58, "endOffset": 62}, {"referenceID": 3, "context": "Therefore, a SVM is less prone to overfitting than other classifiers, such as a neural network [4].", "startOffset": 95, "endOffset": 98}, {"referenceID": 13, "context": "Inspired by [15], for M customers {0, 1, .", "startOffset": 12, "endOffset": 16}, {"referenceID": 8, "context": "While in many applications multiple thresholds are used to generate points plotted in a ROC curve, the AUC can also be computed for a single point, when connecting it with straight lines to (0, 0) and (1, 1) as shown in [9]: AUC = Recall+Specificity 2 .", "startOffset": 220, "endOffset": 223}, {"referenceID": 17, "context": "The SVM classifier was implemented in Python using scikit-learn [19], which builds on top of LIBSVM [5].", "startOffset": 64, "endOffset": 68}, {"referenceID": 4, "context": "The SVM classifier was implemented in Python using scikit-learn [19], which builds on top of LIBSVM [5].", "startOffset": 100, "endOffset": 103}, {"referenceID": 23, "context": "Also, we are planning to make our implementations faster and more scalable using Apache Spark [25].", "startOffset": 94, "endOffset": 98}], "year": 2017, "abstractText": "Non-technical losses (NTL) such as electricity theft cause significant harm to our economies, as in some countries they may range up to 40% of the total electricity distributed. Detecting NTLs requires costly on-site inspections. Accurate prediction of NTLs for customers using machine learning is therefore crucial. To date, related research largely ignore that the two classes of regular and non-regular customers are highly imbalanced, that NTL proportions may change and mostly consider small data sets, often not allowing to deploy the results in production. In this paper, we present a comprehensive approach to assess three NTL detection models for different NTL proportions in large real world data sets of 100Ks of customers: Boolean rules, fuzzy logic and Support Vector Machine. This work has resulted in appreciable results that are about to be deployed in a leading industry solution. We believe that the considerations and observations made in this contribution are necessary for future smart meter research in order to report their effectiveness on imbalanced and large real world data sets.", "creator": "LaTeX with hyperref package"}}}