{"id": "1605.05142", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "17-May-2016", "title": "Automatic Classification of Irregularly Sampled Time Series with Unequal Lengths: A Case Study on Estimated Glomerular Filtration Rate", "abstract": "A patient's estimated glomerular filtration rate (eGFR) can provide important information about disease progression and kidney function. Traditionally, an eGFR time series is interpreted by a human expert labelling it as stable or unstable. While this approach works for individual patients, the time consuming nature of it precludes the quick evaluation of risk in large numbers of patients. However, automating this process poses significant challenges as eGFR measurements are usually recorded at irregular intervals and the series of measurements differs in length between patients. Here we present a two-tier system to automatically classify an eGFR trend. First, we model the time series using Gaussian process regression (GPR) to fill in `gaps' by resampling a fixed size vector of fifty time-dependent observations. Second, we classify the resampled eGFR time series using a K-NN/SVM classifier, and evaluate its performance via 5-fold cross validation. Using this approach we achieved an F-score of 0.90, compared to 0.96 for 5 human experts when scored amongst themselves.", "histories": [["v1", "Tue, 17 May 2016 12:46:46 GMT  (1078kb,D)", "http://arxiv.org/abs/1605.05142v1", null]], "reviews": [], "SUBJECTS": "cs.LG cs.CE", "authors": ["santosh tirunagari", "simon bull", "norman poh"], "accepted": false, "id": "1605.05142"}, "pdf": {"name": "1605.05142.pdf", "metadata": {"source": "CRF", "title": "AUTOMATIC CLASSIFICATION OF IRREGULARLY SAMPLED TIME SERIES WITH UNEQUAL LENGTHS: A CASE STUDY ON ESTIMATED GLOMERULAR FILTRATION RATE", "authors": ["Santosh Tirunagari", "Simon Bull", "Norman Poh"], "emails": ["n.poh}@surrey.ac.uk"], "sections": [{"heading": null, "text": "Index terms - eGFR, Gaussian process regression, KNN, SVM, CKD, AKI."}, {"heading": "1. INTRODUCTION", "text": "This year, it is closer than ever before in the history of the country."}, {"heading": "2. THE \u2018HANNAH\u2019 DATASET", "text": "The data set used in this paper includes the eGFR time series of 488 patients treated at East Kent University Hospital and was collected as part of a study to understand the characteristics of acute kidney injury and its effects on chronic kidney disease. Each eGFR patient was classified by five experts as either stable, linear or gradual change. However, for the purpose of this work we grouped together the unstable (linear and gradual) trends and tried to differentiate only between stable and unstable time series. This is because clinicians are largely busy distinguishing between patients with and those without stable eGFR measurements, as this allows them to identify patients who are likely to require further monitoring (those with unstable measurements). Of the 488 patients 260 (53.3%) have stable time series and 228 (46.7%) have unstable time series, while 275 (56.4%) were male and 213 (43.6%) were female."}, {"heading": "3. METHODOLOGY", "text": "The proposed automatic eGFR trend classification pipeline consists of a regression step followed by a classification step as shown in Figure 3. The unequal length of the eGFR series for each patient is modeled using GPR, creating a fixed size vector with 50 observations of the registered age of the patient. This fixed size vector is then given as input to a standard monitored classification algorithm to classify the eGFR series as stable or unstable."}, {"heading": "3.1. Gaussian Process Regression", "text": "A Gaussian process (GP) is a collection of random variables, each finite survey having a common Gaussian distribution (11). GPs characterize the probability distribution via functions by a specified mean function d (x) and a covariance function k (x, x) [12]. To describe a real process f (x) as GP, we write: f (x) \u00b2 GP (d), k (x, x). Here d (x) = E {d (x)} and k (x, x). () = E {(d) \u2212 d (x)."}, {"heading": "3.2. Classification Details & Performance Evaluation", "text": "Here we have used K-NNs and SVMs for this purpose, as they are known for their high classification accuracy. Euclidean distance measure was used for the K-NN classifier, with K = 3. For SVMs, the radial base core was evaluated with \u03c3 = 10. The performance was evaluated using a 5-fold cross validation, evaluating the performance for each fold using the F-score. Let Y be the predictor of the classifier and \u03c9 the basic truth. Then, the stable / unstable classification of an eGFR series is based on the following: Decision (Y) = {stable if y = 1 unstable otherwise, (4) This can lead to the following results: (i) a true positive (TP \u00b2 y = 1, \u03c9 = 1;), (ii) a false positive (FP \u00b2) and an actual accuracy (F \u00b2)."}, {"heading": "3.3. Groundtruth", "text": "For each eGFR time series, five nephrologists are given one of three labels: stable, linear, or with a step change. Here, both linear and step change are considered to be unstable trends. The class designation assigned to an eGFR time series is based on the consensus of these five comments. To evaluate the performance of an individual expert, we compared their labels with those of the other experts and derived the F score for the respective expert."}, {"heading": "4. EXPERIMENTS & RESULTS", "text": "Our experimental procedures and objectives were as follows: \u2022 Classification using derived statistics: In order to provide a basis for evaluating the performance benefits of eGFR time series equalization, we investigated whether it was possible to classify eGFR trends only on the basis of basic statistics derived from the time series. \u2022 Classification using eGFR eGFR time series eGFR eGFR eGFR time series eGFR eGFR eGFR eGFR time series eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR eGFR e"}, {"heading": "4.1. Derived Statistics", "text": "For each patient, we derived four statistics from their series of eGFR measurements: the age at which eGFR measurements were taken (\u2206 a), the range of eGFR measurements (\u2206 g), the mean age at which a patient had his eGFR measured (\u00b5a) and the mean eGFR value (\u00b5g). From Figure 4 (a), we can see that \u00b5a is negatively correlated with \u00b5g, showing that eGFR tends to decrease as a patient ages. In addition, patients with an unstable trend tend to have a lower microg value. Patients with a higher microg value also tend to have their eGFR measured over a longer period of time (Figure 4 (b)), possibly because a higher mean eGFR value means that the patient is less likely to suffer from complications leading to their eGFR not being measured any more. Since patients with unstable GFR trends tend to have both a lower SVG and a higher statistic value than those with a higher trend 71."}, {"heading": "4.2. eGFR Time Series Equalisation", "text": "Using the GPR model that we learned from each patient's eGFR time series, we re-sampled 50 evenly distributed data points between the ages of 30 and 90 for each patient to ensure that not only are the re-sampled time series of all patients equally long, but that the time interval between measurements is the same. However, although the model has relatively small variations in the age at which a patient has measurements, the deviation increases significantly outside this range. For example, in Figure 5, the patient had recorded his eGFR between the ages of 55 and 75, and as a result, the GPR model that matches their measurements shows smaller variations within that age range. The performance of the K-NN classifier and the SVM that were trained on the resampled data points was 0.57 and 0.43, respectively; lower than what was only achieved by derived statistics (Table 2).For each patient, we also used the GFR model, which was divided by their FRP within each patient's eGPR model."}, {"heading": "4.3. Combining Statistics & Equalisation", "text": "In the previous GPR experiments, only the newly sampled eGFR values were taken into account, equating the problem of trend classification with that of pattern matching, as the concept of time is not taken into account. Since we believe that age information is likely to be important in classifying trends, we reintroduce this information by creating a feature vector for each patient consisting of the four derived statistics and the 50 evenly re-sampled data points within the age range over which the patient has eGFR measurements. By reintroducing the derived statistics, the F score for the K-NN classifier increased from 0.87 to 0.90 and for the SVM from 0.86 to 0.89 (Table 2)."}, {"heading": "4.4. Comparison with Interpolation", "text": "Instead of using GPR to compensate for the eGFR lengths, we could have used linear interpolation, so that the structure and trend of the eGFR series can be maintained without generating fixed size vectors (as shown in Figure 7). A K-NN classifier and SVM, who trained data generated in this way, had an F score of 0.84 and 0.87, respectively. Combined with the derived statistics, the F score of the K-NN classifier improved to 0.86, while the F score of the SVM remained the same. However, the results for both classifiers were lower than for the compensation performed with GPR, possibly due to the smoother adjusted curve generated by GPR."}, {"heading": "5. CONCLUSION & DISCUSSION", "text": "It is important that we are able to enable our patients to solve their problems quickly and precisely."}, {"heading": "6. REFERENCES", "text": "[1] Norman Poh and Simon de Lusignan, \"Calibrating longitudinal egfr in patience records saved in clinical practices using a mixture of linear regressions,\" in International Workshop Pattern Recognition for Healthcare Analytics, 21st International Conference on Pattern Recognition (ICPR), 2012. [2] Norman Poh, Santosh Tirunagari, and David Windridge, \"Challenges in designing an online health platform for personalized analytics,\" in Computational Intelligence in Big Data (CIBD), 2014 IEEE Symposium on. IEEE, 2014, pp. 1-6. [3] Michael Schulz and Karl Stattegger, \"Spectrum analysis of unequal spaced paleoclimatic time series,\" Computers & Geosciences, vol., vol. 23, no. 929-945, 1997."}], "references": [{"title": "Calibrating longitudinal egfr in patience records stored in clinical practices using a mixture of linear regressions", "author": ["Norman Poh", "Simon de Lusignan"], "venue": "International Workshop  on Pattern Recognition for Healthcare Analytics, 21st International Conference on Pattern Recognition (ICPR), 2012.", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2012}, {"title": "Challenges in designing an online healthcare platform for personalised patient analytics", "author": ["Norman Poh", "Santosh Tirunagari", "David Windridge"], "venue": "Computational Intelligence in Big Data (CIBD), 2014 IEEE Symposium on. IEEE, 2014, pp. 1\u20136.", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2014}, {"title": "Spectrum: Spectral analysis of unevenly spaced paleoclimatic time series", "author": ["Michael Schulz", "Karl Stattegger"], "venue": "Computers & Geosciences, vol. 23, no. 9, pp. 929\u2013945, 1997.", "citeRegEx": "3", "shortCiteRegEx": null, "year": 1997}, {"title": "New method of sparse parameter estimation in separable models and its use for spectral analysis of irregularly sampled data", "author": ["Petre Stoica", "Prabhu Babu", "Jian Li"], "venue": "Signal Processing, IEEE Transactions on, vol. 59, no. 1, pp. 35\u201347, 2011.", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2011}, {"title": "Comparison of correlation analysis techniques for irregularly sampled time series", "author": ["Kira Rehfeld", "Norbert Marwan", "Jobst Heitzig", "J\u00fcrgen Kurths"], "venue": "Nonlinear Processes in Geophysics, vol. 18, no. 3, pp. 389\u2013404, 2011.", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2011}, {"title": "Time series models for spectral analysis of irregular data far beyond the mean data rate", "author": ["Piet Broersen"], "venue": "Measurement Science and Technology, vol. 19, no. 1, pp. 14, 2008.", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2008}, {"title": "Time-scale and time-frequency analyses of irregularly sampled astronomical time series", "author": ["C. Thiebaut", "S. Roques"], "venue": "EURASIP J. Appl. Signal Process., vol. 2005, pp. 2486\u20132499, 2005.", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2005}, {"title": "Specially weighted moving averages with repeated application of the ema operator", "author": ["Ulrich M\u00fcller"], "venue": "2000.", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2000}, {"title": "A kernel-based framework for medical big-data analytics", "author": ["David Windridge", "Miroslaw Bober"], "venue": "Interactive Knowledge Discovery and Data Mining in Biomedical Informatics, pp. 197\u2013208. Springer, 2014.", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2014}, {"title": "Classification of sparse and irregularly sampled time series with mixtures of expected gaussian kernels and random features", "author": ["Steven Cheng-Xian Li", "Benjmain Marlin"], "venue": "31st Conference on Uncertainty in Artificial Intelligence, 2015.", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2015}, {"title": "Gaussian processes for machine learning", "author": ["Christopher KI Williams", "Carl Edward Rasmussen"], "venue": "the MIT Press, vol. 2, no. 3, pp. 4, 2006.", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2006}, {"title": "Gaussian processes for machine learning (gpml) toolbox", "author": ["Carl Edward Rasmussen", "Hannes Nickisch"], "venue": "The Journal of Machine Learning Research, vol. 11, pp. 3011\u20133015, 2010.", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2010}, {"title": "Gpstuff: Bayesian modeling with gaussian processes", "author": ["Jarno Vanhatalo", "Jaakko Riihim\u00e4ki", "Jouni Hartikainen", "Pasi Jyl\u00e4nki", "Ville Tolvanen", "Aki Vehtari"], "venue": "The Journal of Machine Learning Research, vol. 14, no. 1, pp. 1175\u20131179, 2013.", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2013}], "referenceMentions": [{"referenceID": 0, "context": "It plays a central role in both the management of people with chronic diseases and epidemiology research involving longitudinal data with ten or more years of observations [1].", "startOffset": 172, "endOffset": 175}, {"referenceID": 1, "context": "Missing values are an inevitable consequence of the difficulty of ensuring that patients return for regular follow up measurements [2], while unequal lengths are a result of patients with differing ages and conditions receiving measurements with different frequency (Figure 1).", "startOffset": 131, "endOffset": 134}, {"referenceID": 2, "context": "If the time series is to be analysed directly, then approaches such as spectral analysis [3, 4] and kernel-based methods [5] have been used to extract causal structure or statistics from data in fields such as asar X iv :1 60 5.", "startOffset": 89, "endOffset": 95}, {"referenceID": 3, "context": "If the time series is to be analysed directly, then approaches such as spectral analysis [3, 4] and kernel-based methods [5] have been used to extract causal structure or statistics from data in fields such as asar X iv :1 60 5.", "startOffset": 89, "endOffset": 95}, {"referenceID": 4, "context": "If the time series is to be analysed directly, then approaches such as spectral analysis [3, 4] and kernel-based methods [5] have been used to extract causal structure or statistics from data in fields such as asar X iv :1 60 5.", "startOffset": 121, "endOffset": 124}, {"referenceID": 5, "context": "tronomy [6, 7], palaeontology [5] and economics [8].", "startOffset": 8, "endOffset": 14}, {"referenceID": 6, "context": "tronomy [6, 7], palaeontology [5] and economics [8].", "startOffset": 8, "endOffset": 14}, {"referenceID": 4, "context": "tronomy [6, 7], palaeontology [5] and economics [8].", "startOffset": 30, "endOffset": 33}, {"referenceID": 7, "context": "tronomy [6, 7], palaeontology [5] and economics [8].", "startOffset": 48, "endOffset": 51}, {"referenceID": 8, "context": "In this study, classification was performed after equalising eGFR series lengths using Gaussian processes, which are particularly useful for predicting patient outcomes [9], and have been used previously when classifying irregular time series data [10].", "startOffset": 169, "endOffset": 172}, {"referenceID": 9, "context": "In this study, classification was performed after equalising eGFR series lengths using Gaussian processes, which are particularly useful for predicting patient outcomes [9], and have been used previously when classifying irregular time series data [10].", "startOffset": 248, "endOffset": 252}, {"referenceID": 10, "context": "A Gaussian process (GP) is a collection of random variables, any finite collection of which has a joint Gaussian distribution [11].", "startOffset": 126, "endOffset": 130}, {"referenceID": 11, "context": "GPs characterise the probability distribution over functions by a specified mean function d\u0304(x) and a covariance function k(x,x\u2032) [12].", "startOffset": 130, "endOffset": 134}, {"referenceID": 12, "context": "The GPstuff toolbox 1 [13], was used for modelling the eGFR time series, with the hyperparameters for the squared exponential kernel tuned using maximum a posteriori estimates.", "startOffset": 22, "endOffset": 26}], "year": 2016, "abstractText": "A patient\u2019s estimated glomerular filtration rate (eGFR) can provide important information about disease progression and kidney function. Traditionally, an eGFR time series is interpreted by a human expert labelling it as stable or unstable. While this approach works for individual patients, the time consuming nature of it precludes the quick evaluation of risk in large numbers of patients. However, automating this process poses significant challenges as eGFR measurements are usually recorded at irregular intervals and the series of measurements differs in length between patients. Here we present a two-tier system to automatically classify an eGFR trend. First, we model the time series using Gaussian process regression (GPR) to fill in \u2018gaps\u2019 by resampling a fixed size vector of fifty time-dependent observations. Second, we classify the resampled eGFR time series using a K-NN/SVM classifier, and evaluate its performance via 5-fold cross validation. Using this approach we achieved an F-score of 0.90, compared to 0.96 for 5 human experts when scored amongst themselves.", "creator": "LaTeX with hyperref package"}}}