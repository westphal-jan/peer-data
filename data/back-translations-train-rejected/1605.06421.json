{"id": "1605.06421", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "20-May-2016", "title": "Root-cause analysis for time-series anomalies via spatiotemporal causal graphical modeling", "abstract": "Modern distributed cyber-physical systems encounter a large variety of anomalies and in many cases, they are vulnerable to catastrophic fault propagation scenarios due to strong connectivity among the sub-systems. In this regard, root-cause analysis becomes highly intractable due to complex fault propagation mechanisms in combination with diverse operating modes. This paper presents a new data-driven framework for root-cause analysis for addressing such issues. The framework is based on a spatiotemporal feature extraction scheme for multivariate time series built on the concept of symbolic dynamics for discovering and representing causal interactions among subsystems of a complex system. We propose sequential state switching ($S^3$) and artificial anomaly association ($A^3$) methods to implement root-cause analysis in an unsupervised and semi-supervised manner respectively. Synthetic data from cases with failed pattern(s) and anomalous node are simulated to validate the proposed approaches, then compared with the performance of vector autoregressive (VAR) model-based root-cause analysis. The results show that: (1) $S^3$ and $A^3$ approaches can obtain high accuracy in root-cause analysis and successfully handle multiple nominal operation modes, and (2) the proposed tool-chain is shown to be scalable while maintaining high accuracy.", "histories": [["v1", "Fri, 20 May 2016 16:17:59 GMT  (336kb)", "http://arxiv.org/abs/1605.06421v1", "Submitted to NIPS 2016"]], "COMMENTS": "Submitted to NIPS 2016", "reviews": [], "SUBJECTS": "cs.LG", "authors": ["chao liu", "kin gwn lore", "soumik sarkar"], "accepted": false, "id": "1605.06421"}, "pdf": {"name": "1605.06421.pdf", "metadata": {"source": "CRF", "title": "Root-cause analysis for time-series anomalies via spatiotemporal causal graphical modeling", "authors": ["Chao Liu"], "emails": ["cliu5@iastate.edu", "kglore@iastate.edu", "soumiks@iastate.edu"], "sections": [{"heading": null, "text": "ar Xiv: 160 5.06 421v 1 [cs.L G"}, {"heading": "1 Introduction", "text": "With the advent of ubiquitous sensors, advanced computing, and strong connectivity, modern distributed cyber-physical systems (CPSs) such as power plants, integrated buildings, transportation grids, and power grids have enormous potential for increased efficiency, robustness, and resilience. From the performance monitoring perspective, anomalies and root cause analyses of such systems are applied, technical challenges arise from a large number of subsystems that are highly interactive and operate in different modes. For the purpose of root cause analysis of anomalies in complex systems, the Granger causality is applied to model system-wide behavior and capture the variation that can be used to implement root cause analyses."}, {"heading": "2 Background and preliminaries", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "2.1 Spatiotemporal pattern network (STPN)", "text": "STPN modeling involves partitioning / discretization, followed by Lernmarkov machines. While details can be found in [11, 9], we provide a brief description of completeness. Consider a multivariate time series, X = {XA (t), t \u00b7 N, A = 1, 2, \u00b7 \u00b7 \u00b7, n}, where n is the number of variables or dimensions of the time series that corresponds to the number of nodes in the graphical modeling. Let X denote a series of partitioning / discretiring functions [12], X: X (t) \u2192 S that put a general dynamic system (time series X (t)) into a symbol sequence S with an alphabet set. Different partitioning approaches have been suggested in the literature, e.g. a unified partitioning (UP), maximum entropy partitioning (MEP, used for the present study)."}, {"heading": "2.2 Unsupervised anomaly detection with spatiotemporal causal graphical modeling", "text": "A data-based framework for system-wide detection of anomalies is proposed in [9], known as the STPN + RBM model. Steps to learn the STPN + RBM model are: 1. Learn APs and RPs (individual node behavior and paired interaction behavior) from the multivariate training symbol sequences. 2. Consider short symbol sequences from the training sequences and evaluate each short sub-sequence. 3. For a sub-sequence based on a user-defined threshold, assign status 0 or 1 to each AP and RP; therefore, each sub-sequence results in a binary vector of length L, with L = # AP + # RP. 4. An RBM is used to model the system-wide behavior with nodes in the visible layer that correspond to APs and RPs. 5. The RBM is trained using binary vectors generated from nominal training sequences."}, {"heading": "3 Methods", "text": "In fact, it is a way in which people are able, in which they are able to change the world, and in which they are able to change the world."}, {"heading": "4 Results and discussions", "text": "Synthetic datasets are created using the Vector Autoregressive Method (VAR) to simulate anomalies in patterns / nodes used to evaluate the performance of S3 and A3 methods."}, {"heading": "4.1 Anomaly in pattern(s)", "text": "Dataset: Anomaly in pattern (s) is defined as the modification of one or more causal relationships (while simultaneously defining anomaly), resulting in a modified / switched pattern in the context of the STPN. A 5-node system is defined and represented in Figure 3, including six different nominal modes. Cycles (1 \u2192 2 \u2192 1, 1 \u2192 2 \u2192 3 \u2192 1, 2 \u2192 2) and loops (4 \u2192 4) are included in the models. Graphic models are used to simulate multiple nominal modes. Anomalies are simulated by breaking up specific patterns in the diagram; 30 cases are formed, including 5 cases in a failed pattern, 10 cases in three failed patterns, and 5 cases in four failed patterns. Multivariate time series data (referred to as Dataset1) are generated using the VAR process that follows the one of the causality definition in the graphical models performance evaluations: root solution, 5 failed: root solution, and 3 failed patterns: 3 and 3 failed patterns."}, {"heading": "4.2 Anomaly in node(s)", "text": "The figure also shows that there are some variations in causality between normal nodes, indicating that causality detection is more difficult with the existence of cycles and loops. Generated datasets are referred to as dataset2. For scalability analysis, a 30-node system with VAR procedures is further defined, causality detection applied is more difficult with the existence of cycles and loops. Generated datasets are referred to as dataset2. For scalability analysis, a 30-node system with VAR procedures is further defined, causality detection applied is more difficult with the existence of cycles and loops. Generated datasets are referred to as dataset2."}, {"heading": "5 Conclusions", "text": "Based on spatio-temporal causal graphical modeling, this paper presents two approaches - sequential state change (S3) and artificial anomaly (A3) - to cause analysis in complex cyber-physical systems. Synthetic data validates the proposed approaches and demonstrates high accuracy in detecting failed patterns and diagnosing the abnormal node. Advantages of the proposed methods include -1. Ability to deal with multiple nominal methods: The STPN + RBM framework is able to learn multiple modes as nominal, corresponding to different modes of operation in most physical systems (e.g. complex cyber-physical systems). The approaches proposed in this paper enjoy this benefit and are validated with data 1.2. Accuracy: The proposed approaches - S3 and A3 - demonstrate high accuracy in cause analysis with synthetic data. Furthermore, the approach shows considerable credibility in determining simultaneous patterns."}], "references": [{"title": "Root cause diagnosis of plant-wide oscillations using granger causality", "author": ["Tao Yuan", "S Joe Qin"], "venue": "Journal of Process Control,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2014}, {"title": "Identification of probabilistic graphical network model for root-cause diagnosis in industrial processes", "author": ["Junichi Mori", "Vladimir Mahalec", "Jie Yu"], "venue": "Computers & Chemical Engineering,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2014}, {"title": "J\u00e4ms\u00e4-Jounela. Fault propagation analysis of oscillations in control loops using data-driven causality and plant connectivity", "author": ["Rinat Landman", "Jukka Kortela", "Q Sun", "S-L"], "venue": "Computers & Chemical Engineering,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2014}, {"title": "Granger causality for timeseries anomaly detection", "author": ["Huida Qiu", "Yan Liu", "Niranjan A Subrahmanya", "Weichang Li"], "venue": "In Data Mining (ICDM),", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2012}, {"title": "Dynamic time warping based causality analysis for root-cause diagnosis of nonstationary fault processes. IFAC-PapersOnLine", "author": ["Gang Li", "Tao Yuan", "S Joe Qin", "Tianyou Chai"], "venue": null, "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2015}, {"title": "Dynamic uncertain causality graph for knowledge representation and probabilistic reasoning: Statistics base, matrix, and application", "author": ["Qin Zhang", "Chunling Dong", "Yan Cui", "Zhihui Yang"], "venue": "Neural Networks and Learning Systems, IEEE Transactions on,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2014}, {"title": "Scalable anomaly detection and isolation in cyberphysical systems using bayesian networks", "author": ["S. Krishnamurthy", "S. Sarkar", "A. Tewari"], "venue": "In Proceedings of ASME Dynamical Systems and Control Conference,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2014}, {"title": "An unsupervised spatiotemporal graphical modeling approach to anomaly detection in distributed CPS", "author": ["Chao Liu", "Sambuddha Ghosal", "Zhanhong Jiang", "Soumik Sarkar"], "venue": "In Proceedings of the International Conference of Cyber-Physical Systems, (Vienna,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2016}, {"title": "Reducing the dimensionality of data with neural networks", "author": ["G. Hinton", "R. Salakhutdinov"], "venue": "Science, 313.5786:504\u2013507,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2006}, {"title": "Sensor fusion for fault detection and classification in distributed physical processes", "author": ["Soumalya Sarkar", "Soumik Sarkar", "Nurali Virani", "Asok Ray", "Murat Yasar"], "venue": "Frontiers in Robotics and AI,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2014}, {"title": "Review and comparative evaluation of symbolic dynamic filtering for detection of anomaly patterns", "author": ["C. Rao", "A. Ray", "S. Sarkar", "M. Yasar"], "venue": "Signal, Image and Video Processing,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2009}, {"title": "Maximally bijective discretization for data-driven modeling of complex systems", "author": ["Soumik Sarkar", "Abhishek Srivastav", "Madhusudana Shashanka"], "venue": "In American Control Conference (ACC),", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2013}, {"title": "A composite discretization scheme for symbolic identification of complex systems", "author": ["Soumik Sarkar", "Abhishek Srivastav"], "venue": "Signal Processing,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2016}, {"title": "A practical guide to training restricted boltzmann machines", "author": ["Geoffrey E Hinton"], "venue": "In Neural Networks: Tricks of the Trade,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2012}, {"title": "Hierarchical feature extraction for efficient design of microfluidic flow patterns", "author": ["Kin Gwn Lore", "Daniel Stoecklein", "Michael Davies", "Baskar Ganapathysubramanian", "Soumik Sarkar"], "venue": "In Proceedings of The 1st International Workshop on \u201cFeature Extraction: Modern Questions and Challenges\u201d,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2015}, {"title": "A discovery algorithm for directed cyclic graphs", "author": ["Thomas Richardson"], "venue": "In Proceedings of the Twelfth international conference on Uncertainty in artificial intelligence,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 1996}, {"title": "Discovering cyclic causal models by independent components analysis", "author": ["Gustavo Lacerda", "Peter L Spirtes", "Joseph Ramsey", "Patrik O Hoyer"], "venue": "In Proceedings of the Twenty-Fourth Conference Annual Conference on Uncertainty in Artificial Intelligence", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2008}, {"title": "Investigating directed cortical interactions in time-resolved fmri data using vector autoregressive modeling and granger causality mapping", "author": ["Rainer Goebel", "Alard Roebroeck", "Dae-Shik Kim", "Elia Formisano"], "venue": "Magnetic resonance imaging,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2003}], "referenceMentions": [{"referenceID": 0, "context": "With multivariate time series data, studies show that the causality from and to the fault variable presents differences and can be used to reason the root-cause [1\u20134].", "startOffset": 161, "endOffset": 166}, {"referenceID": 1, "context": "With multivariate time series data, studies show that the causality from and to the fault variable presents differences and can be used to reason the root-cause [1\u20134].", "startOffset": 161, "endOffset": 166}, {"referenceID": 2, "context": "With multivariate time series data, studies show that the causality from and to the fault variable presents differences and can be used to reason the root-cause [1\u20134].", "startOffset": 161, "endOffset": 166}, {"referenceID": 3, "context": "[5] derived neighborhood similarity and coefficient similarity from Granger-Lasso algorithm, to compute anomaly score and ascertain threshold for", "startOffset": 0, "endOffset": 3}, {"referenceID": 4, "context": "[6] to determine the causal direction between pairs of faulty variables in order to overcome the shortcoming of Granger causality in nonstationary time series.", "startOffset": 0, "endOffset": 3}, {"referenceID": 5, "context": "A dynamic uncertain causality graph is proposed for probabilistic reasoning and applied to fault diagnosis of generator system of nuclear power plant [7].", "startOffset": 150, "endOffset": 153}, {"referenceID": 6, "context": "Also, Bayesian network has been applied in cyber-physical systems to implement anomaly detection and root-cause analysis [8].", "startOffset": 121, "endOffset": 124}, {"referenceID": 7, "context": "In this context, we present a semi-supervised tool for root-cause analysis in complex systems based on a data driven framework proposed for system-wide time-series anomaly detection in distributed complex system [9], and using a spatiotemporal feature extraction scheme built on the concept of symbolic dynamics for discovering and representing causal interactions between the subsystems.", "startOffset": 212, "endOffset": 215}, {"referenceID": 8, "context": "We present two approaches for root-cause analysis, namely the sequential state switching (S, based on free energy concept of a Restricted Boltzmann Machine, RBM [10]) and artificial anomaly association (A, a multi-label classification framework using deep neural networks, DNN).", "startOffset": 161, "endOffset": 165}, {"referenceID": 9, "context": "While details can be found in [11, 9], we are providing brief description for completeness.", "startOffset": 30, "endOffset": 37}, {"referenceID": 7, "context": "While details can be found in [11, 9], we are providing brief description for completeness.", "startOffset": 30, "endOffset": 37}, {"referenceID": 10, "context": "Let X denote a set of partitioning/discretization functions [12], X : X(t) \u2192 S, that transform a general dynamic system (time series X(t)) into a symbol sequence S with an alphabet set \u03a3.", "startOffset": 60, "endOffset": 64}, {"referenceID": 11, "context": "Various partitioning approaches have been proposed in the literature, such as uniform partitioning (UP), maximum entropy partitioning (MEP, used for the present study), maximally bijective discretization (MBD) [13] and statistically similar discretization (SSD) [14].", "startOffset": 210, "endOffset": 214}, {"referenceID": 12, "context": "Various partitioning approaches have been proposed in the literature, such as uniform partitioning (UP), maximum entropy partitioning (MEP, used for the present study), maximally bijective discretization (MBD) [13] and statistically similar discretization (SSD) [14].", "startOffset": 262, "endOffset": 266}, {"referenceID": 7, "context": "2 Unsupervised anomaly detection with spatiotemporal causal graphical modeling A data-driven framework for system-wide anomaly detection is proposed in [9], noted as the STPN+RBM model.", "startOffset": 152, "endOffset": 155}, {"referenceID": 7, "context": "Anomaly is detected by identifying its high energy state, which can be captured using the Kullback-Leibler Distance (KLD) metric [9].", "startOffset": 129, "endOffset": 132}, {"referenceID": 13, "context": "Free energy is defined as the energy that a single visible layer pattern would need to have in order to have the same probability as all of the configurations that contain v [15], which has the following expression: F (v) = \u2212 \u2211", "startOffset": 174, "endOffset": 178}, {"referenceID": 7, "context": "Algorithm 1 Root-cause analysis with sequential state switching (S) method 1: procedure STPN+RBM MODELING \u22b2 Algorithm 1 in [9] 2: Online process of computing likelihoods/probabilities of APs & RPs 3: Training RBM to achieve low energy state, using binary vectors from nominal subsequences 4: end procedure 5: procedure ANOMALY DETECTION \u22b2 Algorithm 2 in [9] 6: Online anomaly detection via the probability of the current state via trained RBM 7: end procedure 8: procedure ROOT-CAUSE ANALYSIS 9: if Anomaly = 1 then 10: F c \u2190 F (v) \u22b2 F c is the current free energy with input vector v = v \u222a v.", "startOffset": 123, "endOffset": 126}, {"referenceID": 7, "context": "Algorithm 1 Root-cause analysis with sequential state switching (S) method 1: procedure STPN+RBM MODELING \u22b2 Algorithm 1 in [9] 2: Online process of computing likelihoods/probabilities of APs & RPs 3: Training RBM to achieve low energy state, using binary vectors from nominal subsequences 4: end procedure 5: procedure ANOMALY DETECTION \u22b2 Algorithm 2 in [9] 6: Online anomaly detection via the probability of the current state via trained RBM 7: end procedure 8: procedure ROOT-CAUSE ANALYSIS 9: if Anomaly = 1 then 10: F c \u2190 F (v) \u22b2 F c is the current free energy with input vector v = v \u222a v.", "startOffset": 354, "endOffset": 357}, {"referenceID": 14, "context": "2 Artificial anomaly association (A) Using a deep neural network (DNN), we frame the root-cause analysis problem as a multi-class (binary-class in our case) classification problem [16].", "startOffset": 180, "endOffset": 184}, {"referenceID": 15, "context": "Performance Evaluation: This work is aimed at discovering failed patterns instead of recovering underlying graph (which is very difficult in graphs with cycles and loops [17, 18]).", "startOffset": 170, "endOffset": 178}, {"referenceID": 16, "context": "Performance Evaluation: This work is aimed at discovering failed patterns instead of recovering underlying graph (which is very difficult in graphs with cycles and loops [17, 18]).", "startOffset": 170, "endOffset": 178}, {"referenceID": 17, "context": "For comparison, we use VAR-based graph recovery method that is widely applied in economics and other sciences, and efficient in discovering Granger causality [19].", "startOffset": 158, "endOffset": 162}, {"referenceID": 17, "context": ", the coefficients Ai,j) can be learnt using standard algorithm [19].", "startOffset": 64, "endOffset": 68}], "year": 2016, "abstractText": "Modern distributed cyber-physical systems encounter a large variety of anomalies and in many cases, they are vulnerable to catastrophic fault propagation scenarios due to strong connectivity among the sub-systems. In this regard, root-cause analysis becomes highly intractable due to complex fault propagation mechanisms in combination with diverse operating modes. This paper presents a new data-driven framework for root-cause analysis for addressing such issues. The framework is based on a spatiotemporal feature extraction scheme for multivariate time series built on the concept of symbolic dynamics for discovering and representing causal interactions among subsystems of a complex system. We propose sequential state switching (S) and artificial anomaly association (A) methods to implement rootcause analysis in an unsupervised and semi-supervised manner respectively. Synthetic data from cases with failed pattern(s) and anomalous node are simulated to validate the proposed approaches, then compared with the performance of vector autoregressive (VAR) model-based root-cause analysis. The results show that: (1) S andA approaches can obtain high accuracy in root-cause analysis and successfully handle multiple nominal operation modes, and (2) the proposed tool-chain is shown to be scalable while maintaining high accuracy.", "creator": "LaTeX with hyperref package"}}}