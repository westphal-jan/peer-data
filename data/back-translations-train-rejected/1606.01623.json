{"id": "1606.01623", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "6-Jun-2016", "title": "Position-Indexed Formulations for Kidney Exchange", "abstract": "A kidney exchange is an organized barter market where patients in need of a kidney swap willing but incompatible donors. Determining an optimal set of exchanges is theoretically and empirically hard. Traditionally, exchanges took place in cycles, with each participating patient-donor pair both giving and receiving a kidney. The recent introduction of chains, where a donor without a paired patient triggers a sequence of donations without requiring a kidney in return, increased the efficacy of fielded kidney exchanges---while also dramatically raising the empirical computational hardness of clearing the market in practice. While chains can be quite long, unbounded-length chains are not desirable: planned donations can fail before transplant for a variety of reasons, and the failure of a single donation causes the rest of that chain to fail, so parallel shorter chains are better in practice.", "histories": [["v1", "Mon, 6 Jun 2016 06:16:36 GMT  (2675kb,D)", "https://arxiv.org/abs/1606.01623v1", "Full version of paper to appear at the ACM Conference on Economics and Computation (EC-16)"], ["v2", "Fri, 10 Jun 2016 22:39:37 GMT  (2683kb,D)", "http://arxiv.org/abs/1606.01623v2", "Appeared at the ACM Conference on Economics and Computation (EC-16)"]], "COMMENTS": "Full version of paper to appear at the ACM Conference on Economics and Computation (EC-16)", "reviews": [], "SUBJECTS": "cs.DS cs.AI", "authors": ["john p dickerson", "david f manlove", "benjamin plaut", "tuomas sandholm", "james trimble"], "accepted": false, "id": "1606.01623"}, "pdf": {"name": "1606.01623.pdf", "metadata": {"source": "CRF", "title": "Position-Indexed Formulations for Kidney Exchange", "authors": ["JOHN P. DICKERSON", "DAVID F. MANLOVE", "BENJAMIN PLAUT", "TUOMAS SANDHOLM"], "emails": [], "sections": [{"heading": "Position-Indexed Formulations for Kidney Exchange", "text": "JOHN P. DICKERSON, Carnegie Mellon University DAVID F. MANLOVE, University of Glasgow BENJAMIN PLAUT, Carnegie Mellon University TUOMAS SANDHOLM, Carnegie Mellon University JAMES TRIMBLE, University of Glasgow Kidney Exchange is an organized exchange market in which patients who need a kidney exchange are willing but not compatible donors. Identifying the optimal exchange is both theoretically and empirically difficult. Traditionally, exchanges have taken place in cycles, with each participating patient and donor receiving a pair that both gives and receives a kidney. The recent introduction of chains without a paired patient triggers a sequence of donations without requiring a kidney in return increased the effectiveness of the kidney exchange programs used - while the empirical hardness of the market is spreading in practice."}, {"heading": "1. INTRODUCTION", "text": "Transplantation is the most effective treatment for kidney failure, but transplant waiting lists have grown rapidly in many countries. In the United States alone, the waiting list for kidney transplants grew from 58,000 people in 2004 to 99,000 people in 2014 [Hart et al. 2016]. To increase the supply of kidneys for transplants, kidney replacement programs are now in place in several countries, including the United States, the United Kingdom, the Netherlands, and South Korea. Kidney replacement [Rapaport 1986; Roth et al. 2004] is a centrally managed kidney exchange market. When a patient with terminal kidney disease gets a job supported by the NSF, IIS-1320620 and IIS-1546752, ARO grants W911NF-16-1-0061, Facebook and Siebel grants, and XSEDE through the Supercomputing Center (Dickerson / Plaut / Sandholm)."}, {"heading": "A:2 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "In fact, most systems are unable to perform four-way or longer exchanges because transplants have to be performed simultaneously, and there is a risk that one of the parties involved will have to withdraw, in the event that the cycle does not go to execution and the couples are not included in the kidney exchange programs. The scheme administrator performs periodic \"match runs,\" in which replacement processes are selected to maximize the number of planned transplants, or a similar goal - perhaps prioritizing pediatric patients, or those who have been waiting for longevity."}, {"heading": "1.1. Prior research", "text": "We give a brief overview of the literature in the fields of economics, informatics and business. Theoretical foundations for renal exchange. Roth et al. [2004; 2005; 2007] laid the foundations for a large-scale organized kidney exchange. In this work it was examined what efficient partnerships would look like in an in-patient kidney exchange; extensions by Ashlagi et al. [2012], Ashlagi and Roth [2014] and Ding et al. [2015] deal with deficiencies."}, {"heading": "Position-Indexed Formulations for Kidney Exchange A:3", "text": "In fact, most people are able to survive on their own without having to stray into another world."}, {"heading": "1.2. Our contribution", "text": "This paper presents three integer program formulations for the kidney replacement problem, two of which are compact; the size of the model (i.e. the storage space) often constrains today's kidney replacement solutions; crucially, our models are typically much smaller than"}, {"heading": "A:4 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "In Section 3, we introduce position indexed edge formulation (PIEF), a model of the kidney replacement problem with only cycles that are substantially smaller than, but have an LPR equivalent that the model with the narrowest LPR for the cycle-specific version of the problem has [Abraham et al. 2007]. Section 3 presents the position indexed chain formulation (PICEF), which brings chains compactly into the model via a polynomic number of decision variables; the number of cycle decision variables is exponential at only the maximum cycle length (which is typically only 3 or 4 in field exchange processes). To address this exponential dependence on cycle length, we also present an industry and price-based implementation of PICEF."}, {"heading": "2. PRELIMINARIES", "text": "# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #"}, {"heading": "3. PIEF: POSITION-INDEXED EDGE FORMULATION", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1. Description of the model", "text": "In this section, we present our first of three new IP formulations, the Position Indexed Edge Formulation (PIEF). PIEF is a natural extension of the Extended Edge Formulation (EEF) by Constantino et al. [2013]. For this formulation, we assume that the problem instance does not contain NDDs; HPIEF (the hybrid PIEF) in Appendix C is a compact generalization of this formulation that can be used for instances with NDDDs. PIEF uses, like EEF, copies of the underlying compatibility chart D. For each vertex l-V, Dl = (V l, Al) should be the subgraph of D induced by {i-V: i-l}. PIEF ensures that no more than one cycle is selected in each copy and that a cycle selected in the graph copy Dl = (V l, Al) is not used as a vertex in the diagram. The example in this section is the first one in the diagram."}, {"heading": "A:6 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "The main innovation of the PIEF formulation is the use of arc positions to index variables, if it is only selected; the position of an arc in a cycle is defined as follows: (1,.). (1,.). (1,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (2,.). (3,.). (3,.). (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,. (3,.). (3,.,.,. (3,.,.,.,.,. (3,.). (3,.,.,.,. (3,.,.,.,.). (3,.,.,. (3,.,.,.,.,.,.). (3,. (3,.,.,.,.,.,.). (3,.,. (3,.,.,.,.). (3,.,.,.,. (3,.,.,.).,. (3,. (3,.,.,.).,.,. (3,.). (3,.,.,. (3,.,.,.,.,. (3,.,.,.,.,.,.,.). (3,.). (3,.,. (3,."}, {"heading": "3.2. Further reducing the size of the basic PIEF model", "text": "We present methods for reducing the size of the PIEF model while maintaining demonstrable optimality, which are performed as a polynomial-time preprocess (prior to solving the NP-hard kidney replacement problem) and can therefore lead to a practical run-time improvement (1b) (1d). In typical problem cases, there are many (i, j, k, l) tuples that can be selected so that xlijk takes the value zero in any allocation that meets constraints (1b) (1d). For example, we assume that K = 4 and that Figure 3 is a copy of D1. Arc (6, 7) cannot be selected at position 3 of a cycle, as the Arc only appears at position 2 of that cycle and it is at position 2 of that cycle. Therefore, if we could eliminate variable x1673 from the integrator program, it would not change the optimal solution."}, {"heading": "A:8 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "iii2 (i, j, l) = Kred (i, j, l), (i, j, l), (i, j, l), (i, j, l), (i, j, l), (i, j, l), (i, j, l), (i, j, l), (i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i.) i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i. i."}, {"heading": "3.3. PIEF has a tight LPR", "text": "In this section, we compare the LPR of PIEF with the narrowest LPR formulation, the cycle formulation. While the number of decision variables in the cycle formulation model in the cycle cap K is exponential, PIEF maintains an LPR that is equally narrow but has far fewer variables when K > 3.3.1. cycle formulation. Let's start with a review of cycle formulation based on Abraham et al. [2007] and Roth et al. [2007], and note that the formulation matches that of Anderson et al. [2015] when chains are banned."}, {"heading": "Position-Indexed Formulations for Kidney Exchange A:9", "text": "The binary variable zc is used for any feasible cycle or any chain c to represent whether it is selected in the solution. For each vertex v there is a restriction to ensure that v is in at most one selected cycle or chain. Let C be the set of cycles in D with at most K and let C have the set of NDD-initiated chains in D with at most L. The model to solve is as follows: max."}, {"heading": "4. PICEF: POSITION-INDEXED CHAIN-EDGE FORMULATION", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "4.1. Description of the model", "text": "The idea of using arc variables in chains and one variable for each cycle has been incorporated into the PC-TSP-based algorithm by Anderson et al. [2015]. The innovation in our IP model is the use of position indices on arc variables, which result in a polynomial number of constraints and arc variables; this is in contrast to the exponential number of constraints in the PC-TSP-based model. Unlike PIEF, PICEF does not require copies of D. Intuitively, this is a simpler structure than a circuit without a requirement for a final arc back to the starting points."}, {"heading": "4.2. Practical implementation of the PICEF model", "text": "We will now discuss methods for implementing PICEF in practice, firstly by reducing the number of decision variables through a polynomic preliminary process, and secondly by tackling the large number of decision variables for cyclical exchange through an industry- and price-based transformation of the model. 4.2.1. Reduced PICEF. We can reduce the PICEF model using a similar approach to the PIEF reduction in Section 3.2.1. for i-P, d (i) should be the length of the shortest path in relation to arcs from some j-N to is. Since each outgoing arc of i cannot appear at position less than d (i) + 1 in a chain, we can replace K \u2032 in PICEF with Kred, defined as follows:"}, {"heading": "Position-Indexed Formulations for Kidney Exchange A:11", "text": "Kred (i, j) = {1} i-N {d (i) + 1,.., L} i-P.4.2.2. A branch and price implementation of PICEF. We will now discuss a method for scaling PICEF to diagrams with high cycle limits or large diagrams with many cycles; this method maintains the complete set of decision variables of the arc, but only takes into account incrementally those corresponding to cycles. Formally, V = P-N considers the number of cycles of length at most K as O (| P | K), with explicit representation and enumeration of all cycles impracticable for sufficiently large instances. With one decision variable per cycle, Abraham et al. [2007] could not even write the full integer program in memory for instances as small as 1000 pages. Branch and price is a method whereby only one substance of the decision variables is kept in memory."}, {"heading": "4.3. The LPR of PICEF is not as tight", "text": "Unlike in the case of PIEF, where Theorem 3.1 showed an equivalence between the relaxations of the two models, we show that the relaxation of PICEF can be looser than that of the cycle formulation. Theorem 4.1 shows a simple construction showing this, while Theorem 4.2 shows a family of diagrams on which PICEF's LPR is arbitrarily inferior to the cycle formulation. The evidence for both results is contained in Section B.2.THEOREM 4.1. ZCF \u2022 ZPICEF (with chains). In fact, Theorem 4.2 shows that the ratio between the optimal objective value for the relaxations of PICEF and the cycle formulation can be arbitrarily executed."}, {"heading": "A:12 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "5. EXPERIMENTAL COMPARISON OF STATE-OF-THE-ART KIDNEY EXCHANGE SOLVERS", "text": "In this section, we compare the implementations of our new models with the existing state-of-the-art kidney replacement solutions. To ensure fair comparison, we received code from the author of each solvent not presented in this paper. We compare runtimes of the following industry- and price-based solvents: - BNP-DFS, the original industry- and price-based cycle formulation solver dueto Abraham et al. [2007]; - BNP-POLY, an industry- and price-based cycle formulation solver dueto Glorie et al. [2014] and Plaut et al. [2016a]; 2 - CG-TSP, a newer IP formulation based on a price-based travelingsalesman problem, with the constraint generation [Anderson et al. 2015]; - PICEF, the model from section 4 of this paper; - PICEF, the Model 3F, of the IEF group."}, {"heading": "5.1. Real match runs from the UK- and US-wide exchanges", "text": "We are now presenting results on real matches that come from two nationwide kidney exchange programs: the United Network for Organ Sharing (UNOS), a US-wide kidney exchange in which decisions are made by algorithms and software from Prof. Sandholm's group, and the British Kidney Exchange (NLDKSS), in which decisions are made by algorithms and software from Dr. Manlove's group. [3] The UNOS instances used cover all matches that run from the start of the exchange in October 2010 to January 2016. During this time, the exchange has grown significantly and the chains have been included; the match cadence has increased from once a month to twice a week, keeping the number of altruists relatively low. On average, these instances have | N | = 2, | P | = 231, and | = 5021. The NLDKSS instances cover the 17 quarterly matches that run from January 2012 to January 2016."}, {"heading": "Position-Indexed Formulations for Kidney Exchange A:13", "text": "Interestingly, BNP-PICEF tends to perform worse than the base PICEF and HPIEF; we suspect that this is because industry and price-based methods are necessarily \"heavier\" than standard IP techniques, and the small size of the kidney exchange pools currently in use may not yet justify this more advanced technique. Perhaps most critically, both PICEF and HPIEF match within seconds in both exchange processes. In the NLDKSS results, the large fluctuation in mean runtime, as the chain conversion rate is varied, is explained by the small sample size of available NLDKSS instances, and the fact that the algorithms other than HPIEF and PICEF are executed within seconds in both cases."}, {"heading": "5.2. Scaling experiments on realistic generated UNOS kidney exchange graphs", "text": "As envisaged earlier in the paper, kidney exchange pools are expected to grow as (a) the idea of kidney exchange becomes commonplace and barriers to entry continue to fall, and (b) large-scale international exchange manifests itself. To this end, in this section we test solvers using compatibility charts generated from a realistic simulator equipped with all historical UNOS data; the generator tries patient-donor pairs and NDD replacements and draws arcs in the compatibility chart in accordance with the internal rules of UNOS. Figure 6 provides results for an increasing number of patient-donor pairs (each column) and an increasing number of non-directed donors as a percentage of the number of donors."}, {"heading": "A:14 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "As expected, as the number of patient-donor pairs increases, so does the runtime for all approaches. | In each of the experiments, however, both PICEF and HPIEF are at eye level or (typically) much faster - sometimes by orders of magnitude compared to other approaches. | Appendix E gives these results in tabular form, including other statistics - minimum and maximum runtimes and their standard deviations - which cannot be shown in Figure 6.2 3 4 4 5 6 7 8 9 10 11 11 11 11 12 Chain lengths compared to other approaches. (Appendix E gives these results in tabular form, including the other statistics - minimum and maximum runtimes and their standard deviations - which are shown in Figure 6.2 3 4 6 7 8 9 10 11 11 11 11 12 Chain lengths compared to other approaches."}, {"heading": "Position-Indexed Formulations for Kidney Exchange A:15", "text": "The time of both the PICEF and HPIEF formulations is much less variable than the industry-based and price-based and constraint-based IP solvers. Although the underlying problem that is being solved is NP-hard and will therefore always present the worst possible cases, taking much longer than it would normally be solved, the increased predictability of the runtime of these models is attractive compared to other state-of-the-art solutions - including those currently being implemented. Second, we note that creating custom industry and price-based and constraint-based codes requires considerable technical effort, while both PICEF and HPIEF are relatively easy to implement and rely on a single call of a black box IP solver."}, {"heading": "6. FAILURE-AWARE KIDNEY EXCHANGE", "text": "Real-world exchanges suffer to varying degrees from \"last-minute\" errors, where an algorithmic match or set of matches does not lead to a transplant, for a variety of reasons, including more comprehensive medical tests performed before surgery, a patient or donor who becomes too ill to participate, or a patient who receives an organ from another replacement or from the deceased donor's waiting list. To solve this problem once the match is complete, Dickerson et al. [2013] extend the standard model of kidney exchanges by adding a probability of success p for each bow in the chart. They show how this model can be solved by industry and price, with the price problem solved exponentially in the chain and cycle cap. Prior compact formulations - and indeed previous \"marginal formulations\" such as those based on Abraham et al. [2007], Constantino et al. [2013] and Anderson et al. [2015] are not sufficiently generalized to allow for this."}, {"heading": "6.1. PICEF for failure-aware matching", "text": "With only minor modifications, PICEF enables failure-conscious kidney replacement to be implemented, with the proviso that each arc is equally likely to be successful. While this assumption is unlikely to be true in practice, Dickerson et al. [2013] explain why practical implementation of this model would potentially offset all likelihood of failure: namely, so that already ill patients - who are likely to have higher failure rates - are not further marginalized by this model. Therefore, given a single probability of success p, we can adjust the PICEF objective function to reflect the maximum expected weight match as follows: the benefit obtained from arcs into chains and the benefit obtained from cycles. For the latter, a cycle of size | c | wczc (5a) has the objective (5a) divided into two parts: the benefit obtained from arcs into chains, and the benefit obtained from cycles."}, {"heading": "6.2. Failure-aware polynomial pricing for cycles", "text": "The initially error-conscious industry and pricing work of Dickerson et al. [2013] generalized the pricing strategy of Abraham et al. [2007] and therefore suffered from a price problem that ran exponentially in cycle and chain cover. Glorie et al. [2014] and Plaut et al. [2016a] discussed polynomic price algorithms for cycles - but not chains [Plaut et al.]."}, {"heading": "A:16 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "The algorithm 1 Polynomial-Time Failure-aware pricing for cycles. 1: function GETDISCOUNTEDPOSITIVEPRICYCLES (D = (V, A), K, p, w, \u03b4) 2: C \u2190 \u2205 3: for each k = 2... K do. Consider all possible cycle lengths 4: wk (i, j) \u2190 pkwij (i, j).A: Reduction of Glorie et al. [2014] 5: C \u2190 GETNEGATIVECYCLES (D, k, wk) 6: return C2016b] - in the deterministic case. Using the algorithm of Plaut et al. [2016a] as a subroutine, we present an algorithm that solves the fail-aware, or discounts, pricing problem for cycles in polynomial time, with the restriction that all arcs have the same probability of success."}, {"heading": "7. CONCLUSIONS & FUTURE RESEARCH", "text": "In this paper, we discussed tractable clearing of kidney exchange solutions with short cycles and long but limited chains, motivated by the practice of kidney exchange, where chains are often long but limited due to post-match failures. We introduced three intellectual property formulations, two of which are compact, and compared their LPRs favorably with a state-of-the-art formulation with tight relaxation. We then used real data from the nationwide exchange of UNOS US and the NLDKSS United Kingdom, as well as generated data, to investigate that our new models often dramatically outperform all other approaches to solving realistically parameterized kidney exchange problems. We also examined practical extensions of our models, such as the use of branches and prices for additional scalability, and an extension to the disruptive kidney exchange case, which more closely mixes the more immediate importance of more scalable static kidney exchanges for use in field exchange."}, {"heading": "Position-Indexed Formulations for Kidney Exchange A:17", "text": "Approaches to clearing dynamic kidney exchange are often based on solving the static problem many times [Awasthi and Sandholm 2009; Dickerson et al. 2012; Anderson 2014; Dickerson and Sandholm 2015; Glorie et al. 2015]; therefore, faster static solutions lead to better dynamic exchange solutions. The use of the techniques in this paper - or their adaptations - as subsolvers is of interest. From a theoretical point of view, extending the comparison of LPRs to a complete sequence of all LPRs among the models of kidney exchange - especially for different parameterizations of the underlying model, such as the inclusion of chains or arc failures - would shed light on which solver is best suited to an exchange that occurs under certain business constraints."}, {"heading": "ACKNOWLEDGMENTS", "text": "The authors thank Ross Anderson, Kristiaan Glorie, Xenia Klimentova, Nicolau Santos and Ana Viana for valuable discussions about this work and for providing their kidney exchange software for the purpose of conducting our experimental evaluation."}, {"heading": "A:18 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "In 2014 and 2015. In the Proceedings of the ACM Conference on Artificial Intelligence (AAAI). 323-340. John P. Dickerson and Tudney Sandholm, Ariel D. Procaccia, and Tuomas Sandholm. 2015. FutureMatch: Combining Human Value Judgments and Machine Learning to Match in Dynamic Environments. In the Proceedings of the ACM Conference on Electronic Commerce (AAAI). 622-628. Yichuan Ding, Dongdong Ge, Simai He, and Christopher Ryan. 2015. A non-asymptotic approach to analyzing kidney exchange graphs."}, {"heading": "Online Appendix to: Position-Indexed Formulations for Kidney Exchange", "text": "JOHN P. DICKERSON, Carnegie Mellon University DAVID F. MANLOVE, University of Glasgow BENJAMIN PLAUT, Carnegie Mellon University TUOMAS SANDHOLM, Carnegie Mellon University JAMES TRIMBLE, University of Glasgow"}, {"heading": "A. ADDITIONAL PROOFS FOR THE PIEF MODEL", "text": "We now provide additional theoretical results with respect to the Position Indexed Edge Formulation (PIEF) model, and evidence for the theoretical results stated in the main paper. A.1. Validity of the PIEF model LEMMA A.1. Any assignment of values to the xlijk that respects the PIEF constraints results in a series of vertical disjunction cycles no larger than K.PROOF. We demonstrate this by showing that in each graphic copy the set of selected edges is either empty, or a single length cycle no larger than K.Let l, l, P so that at least one edge in the graphic copy Dl is selected, and let kmax be the highest position k, so that xlijk = 1 for some i, j. Each selected edge (i, j) at position kmax in the graphic copy Dl must point to l, as otherwise the flow constraint (the 1edge) to the 1edge consolidation."}, {"heading": "A.2. Proofs for the LPR of PIEF", "text": "The proof for Theorem 3.1 is based on the following term A.4. Allow a sequence of arcs W = (a1,.., a | W |) in a directed diagram D so that W is a closed passage - that is, the vertex of each arc is the starting point of the following arc, and the sequence begins and ends at the same vertex. (It is permissible that an arc appears more than once in W.) Let X be the multi-clause {a1,..., a | W |}. Then we can divide X into C = {c1,..., c | C |}, with each ci-C being a sequence of arcs forming a cycle in the D.ACM Journal Name, Vol. V, No. N, Article A, publication date: January YYY."}, {"heading": "App\u20132 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "The following algorithms can be used to construct the C set. (1) Let's let C = 1 (2). (2) Let's let each of us have a new goal. (2) Let's let it. (2) Let's let it. (3) Let's let it. (3) Let's let it. (3) Let's let it. (3) Let's let it. (3) Let's let it. (3) Let's let it. (3) Let's let it. (4) Let's let it. (4) Let's let it. (4) Let's let it. (4) Let's let it. (4) The Arcs. (4) The Arcs. (5) i. (5) Let's make a cycle. (4) Let's make these Arcs. (4). (5)."}, {"heading": "Position-Indexed Formulations for Kidney Exchange App\u20133", "text": "If we repeat this step, we reach a point where all xlijk variables take the value zero and where the zc variables respect the constraints of cycle formulation and give objective value to ZPIEF."}, {"heading": "B. ADDITIONAL PROOFS FOR THE PICEF MODEL", "text": "We now provide additional theoretical results relating to the position-indexed edge formula. (PICEF) It is most (4c) selected (4c) and (4d) selected (4c) selected (4c) and (4c) selected (4c) and (4c) selected (4c) and (4c) selected (4c). (J, i) \"A\" K \"K\" K \"K\" K \"K\" K \"K\" K \"K\" K \"K\" K \"K\" K \"K\" K \"S\" P \"P\" P \"P\" P \"P\" E. \"\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"E.\" \"\" P \"D\" E \"P\" P \"P\" P \"P\" P \"P\" P \"E.\" P \"E\" P \"P\" P \"P\" P \"P\" P \"E\" P \"P\" P \"P\" P \"P\" E \"P\" P \"P\" P \"P\" P \"P\" P \"P E\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"E\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"\" P \"P\" P \"\" P \"P\" P \"\" P \"P\" P \"\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"E\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" P \"P\" (\"P\" P \"P\" P \"P\" P \"P\""}, {"heading": "App\u20134 J.P. Dickerson, D.F. Manlove, B. Plaut, T. Sandholm and J. Trimble", "text": "By constraint (4d), I must be the target of another selected arch, a \u2032. Therefore, I appear in c and is the target of a \u2032 that violates constraint (4b).LEMMA B.3. For each valid set of vertex cycles and chains, there is an assignment of values to the yijk and zc that respect the PICEF constraints. PROOF. This assignment can be constructed trivially. THEOREM B.4. The PICEF model provides an optimal solution to the kidney exchange problem."}, {"heading": "B.2. Proofs for the LPR of PICEF", "text": "In fact, most of them are able to go in search of a solution worthy of their name. (...) Most of them are able to go in search of a solution. (...) Most of them are able to go in search of a solution. (...) Most of them are able to go in search of a solution. (...) Most of them are able to go in search of a solution. (...) Most of them are able to go in search of a solution. (...) Most of them are able to go in search of a solution. (...) Most of them are able to go in search of a solution. (...) Most of them are able to find a solution for themselves. (...) Most of them are able to find a solution for themselves. (...)"}, {"heading": "C. HYBRID FORMULATION C.1. Description of the HPIEF model", "text": "In this section we present a compact generalization of the PIEF model on kidney exchange curves with non-directional donors (7K). (This is in contrast to the PICEF formulation, which has a polynomial number of limitations and boundary variables, but an exponential number of cycle variables in PICEF with the PIEF variables and modification of the limitations accordingly, we can create a compact formulation, the hybrid PIEF (HPIEF) variable xlijl and the index set K (i, j, l) variable set in PIEF variables (i, l) set in PIEF variable set and the index set K (i, j) set in PICEF (HPIEF) value."}, {"heading": "C.3. LPR comparison of HPIEF and PICEF", "text": "THEOREM C.4. ZHPIEF = ZPICEF The proof is similar to the proof for Theorem 3.1 and is therefore omitted."}, {"heading": "D. ADDITIONAL BACKGROUND AND PROOFS FOR FAILURE-AWARE THE PICEF MODEL", "text": "In this section we provide proof of the accuracy of Algorithm 1 - which implements the polynomial time pricing of industry and price cycles in the advanced failure-conscious PICEF model - and discuss as a counter-example why the basic deterministic price algorithms for polynomial time cycles of Glorie et al. [2014] and Plaut et al. [2016a] cannot be applied directly in this case."}, {"heading": "D.1. Proof of Theorem 6.1", "text": "THEOREM 6.1. If there is a discounted positive price cycle in the graph, algorithm 1 returns at least one discounted positive price cycle."}, {"heading": "Position-Indexed Formulations for Kidney Exchange App\u20137", "text": "PROOF. Let c's be a negative cycle on D'n,.., vn > be a discounted positive price cycle. (i, j) D's negative cycle in D's negative cycle in D's negative cycle in D's negative cycle. (i, j) D's negative cycle in D's negative cycle. (i, D's negative cycle in D's negative cycle will return at least one negative cycle of length. (i, j) D's negative cycle in D's negative cycle in D's negative cycle. (D's negative cycle in D's negative cycle of length will return at least one negative cycle of length. Let c's negative cycle in D's negative cycle, GETNEGATIVECYCLES (D, n, wn)."}, {"heading": "E. TABULATED EXPERIMENTAL RESULTS", "text": "In this section we will repeat the experimental results shown in Figures 5 and 6 of Section 5 in the main part of the paper, but now we include statistics that could not be shown in this figure. A pp-9A pp-10A pp-11A pp-12A pp-13A pp-14A pp-15A pp-16A pp-17A pp-18A pp-19A pp-20A pp-21A pp-22"}], "references": [{"title": "Clearing Algorithms for Barter Exchange Markets: Enabling Nationwide Kidney Exchanges", "author": ["David Abraham", "Avrim Blum", "Tuomas Sandholm."], "venue": "Proceedings of the ACM Conference on Electronic Commerce (EC). 295\u2013304.", "citeRegEx": "Abraham et al\\.,? 2007", "shortCiteRegEx": "Abraham et al\\.", "year": 2007}, {"title": "Dynamic Matching Market Design", "author": ["Mohammad Akbarpour", "Shengwu Li", "Shayan Oveis Gharan."], "venue": "Proceedings of the ACM Conference on Economics and Computation (EC). 355.", "citeRegEx": "Akbarpour et al\\.,? 2014", "shortCiteRegEx": "Akbarpour et al\\.", "year": 2014}, {"title": "A compact formulation for maximizing the expected number of transplants in kidney exchange programs", "author": ["Filipe Alvelos", "Xenia Klimentova", "Abdur Rais", "Ana Viana."], "venue": "Journal of Physics: Conference Series, Vol. 616. IOP Publishing.", "citeRegEx": "Alvelos et al\\.,? 2015", "shortCiteRegEx": "Alvelos et al\\.", "year": 2015}, {"title": "Stochastic models and data driven simulations for healthcare operations", "author": ["Ross Anderson."], "venue": "Ph.D. Dissertation. Massachusetts Institute of Technology.", "citeRegEx": "Anderson.,? 2014", "shortCiteRegEx": "Anderson.", "year": 2014}, {"title": "Finding long chains in kidney exchange using the traveling salesman problem", "author": ["Ross Anderson", "Itai Ashlagi", "David Gamarnik", "Alvin E Roth."], "venue": "Proceedings of the National Academy of Sciences 112, 3 (2015), 663\u2013668.", "citeRegEx": "Anderson et al\\.,? 2015", "shortCiteRegEx": "Anderson et al\\.", "year": 2015}, {"title": "Mix and Match: A strategyproof mechanism for multi-hospital kidney exchange", "author": ["Itai Ashlagi", "Felix Fischer", "Ian A Kash", "Ariel D Procaccia."], "venue": "Games and Economic Behavior 91 (2015), 284\u2013296.", "citeRegEx": "Ashlagi et al\\.,? 2015", "shortCiteRegEx": "Ashlagi et al\\.", "year": 2015}, {"title": "The Need for (long) Chains in Kidney Exchange", "author": ["Itai Ashlagi", "David Gamarnik", "Michael Rees", "Alvin E. Roth."], "venue": "NBER Working Paper No. 18202. (July 2012).", "citeRegEx": "Ashlagi et al\\.,? 2012", "shortCiteRegEx": "Ashlagi et al\\.", "year": 2012}, {"title": "Kidney Exchange in Dynamic Sparse Heterogenous Pools", "author": ["Itai Ashlagi", "Patrick Jaillet", "Vahideh H. Manshadi."], "venue": "Proceedings of the ACM Conference on Electronic Commerce (EC). 25\u201326.", "citeRegEx": "Ashlagi et al\\.,? 2013", "shortCiteRegEx": "Ashlagi et al\\.", "year": 2013}, {"title": "Free riding and participation in large scale, multi-hospital kidney exchange", "author": ["Itai Ashlagi", "Alvin E Roth."], "venue": "Theoretical Economics 9, 3 (2014), 817\u2013863.", "citeRegEx": "Ashlagi and Roth.,? 2014", "shortCiteRegEx": "Ashlagi and Roth.", "year": 2014}, {"title": "Online Stochastic Optimization in the Large: Application to Kidney Exchange", "author": ["Pranjal Awasthi", "Tuomas Sandholm."], "venue": "Proceedings of the 21st International Joint Conference on Artificial Intelligence (IJCAI). 405\u2013411.", "citeRegEx": "Awasthi and Sandholm.,? 2009", "shortCiteRegEx": "Awasthi and Sandholm.", "year": 2009}, {"title": "Branch-and-price: column generation for solving huge integer programs", "author": ["Cynthia Barnhart", "Ellis Johnson", "George Nemhauser", "Martin Savelsbergh", "Pamela Vance."], "venue": "Operations Research 46 (1998), 316\u2013329.", "citeRegEx": "Barnhart et al\\.,? 1998", "shortCiteRegEx": "Barnhart et al\\.", "year": 1998}, {"title": "Maximum weight cycle packing in directed graphs, with application to kidney exchange programs", "author": ["P\u00e9ter Bir\u00f3", "David F Manlove", "Romeo Rizzi."], "venue": "Discrete Mathematics, Algorithms and Applications 1, 04 (2009), 499\u2013517.", "citeRegEx": "Bir\u00f3 et al\\.,? 2009", "shortCiteRegEx": "Bir\u00f3 et al\\.", "year": 2009}, {"title": "Ignorance is Almost Bliss: Near-Optimal Stochastic Matching with Few Queries", "author": ["Avrim Blum", "John P. Dickerson", "Nika Haghtalab", "Ariel D. Procaccia", "Tuomas Sandholm", "Ankit Sharma."], "venue": "Proceedings of the ACM Conference on Economics and Computation (EC). 325\u2013342.", "citeRegEx": "Blum et al\\.,? 2015", "shortCiteRegEx": "Blum et al\\.", "year": 2015}, {"title": "Harnessing the Power of Two Crossmatches", "author": ["Avrim Blum", "Anupam Gupta", "Ariel D. Procaccia", "Ankit Sharma."], "venue": "Proceedings of the ACM Conference on Electronic Commerce (EC). 123\u2013140.", "citeRegEx": "Blum et al\\.,? 2013", "shortCiteRegEx": "Blum et al\\.", "year": 2013}, {"title": "New insights on integerprogramming models for the kidney exchange problem", "author": ["Miguel Constantino", "Xenia Klimentova", "Ana Viana", "Abdur Rais."], "venue": "European Journal of Operational Research 231, 1 (2013), 57\u201368.", "citeRegEx": "Constantino et al\\.,? 2013", "shortCiteRegEx": "Constantino et al\\.", "year": 2013}, {"title": "Dynamic Matching via Weighted Myopia with Application to Kidney Exchange", "author": ["John P. Dickerson", "Ariel D. Procaccia", "Tuomas Sandholm."], "venue": "AAAI Conference on Artificial Intelligence (AAAI). 1340\u2013 1346.", "citeRegEx": "Dickerson et al\\.,? 2012", "shortCiteRegEx": "Dickerson et al\\.", "year": 2012}, {"title": "Failure-Aware Kidney Exchange", "author": ["John P. Dickerson", "Ariel D. Procaccia", "Tuomas Sandholm."], "venue": "Proceedings of the ACM Conference on Electronic Commerce (EC). 323\u2013340.", "citeRegEx": "Dickerson et al\\.,? 2013", "shortCiteRegEx": "Dickerson et al\\.", "year": 2013}, {"title": "FutureMatch: Combining Human Value Judgments and Machine Learning to Match in Dynamic Environments", "author": ["John P. Dickerson", "Tuomas Sandholm."], "venue": "AAAI Conference on Artificial Intelligence (AAAI). 622\u2013628.", "citeRegEx": "Dickerson and Sandholm.,? 2015", "shortCiteRegEx": "Dickerson and Sandholm.", "year": 2015}, {"title": "A non-asymptotic approach to analyzing kidney exchange graphs", "author": ["Yichuan Ding", "Dongdong Ge", "Simai He", "Christopher Ryan."], "venue": "Proceedings of the ACM Conference on Economics and Computation (EC). 257\u2013258.", "citeRegEx": "Ding et al\\.,? 2015", "shortCiteRegEx": "Ding et al\\.", "year": 2015}, {"title": "Robust Models for the Kidney Exchange Problem", "author": ["Kristiaan Glorie", "Margarida Carvalho", "Miguel Constantino", "Paul Bouman", "Ana Viana."], "venue": "(2015). Working paper.", "citeRegEx": "Glorie et al\\.,? 2015", "shortCiteRegEx": "Glorie et al\\.", "year": 2015}, {"title": "Kidney Exchange with Long Chains: An Efficient Pricing Algorithm for Clearing Barter Exchanges with Branch-and-Price", "author": ["Kristiaan M. Glorie", "J. Joris van de Klundert", "Albert P.M. Wagelmans."], "venue": "Manufacturing & Service Operations Management (MSOM) 16, 4 (2014), 498\u2013512.", "citeRegEx": "Glorie et al\\.,? 2014", "shortCiteRegEx": "Glorie et al\\.", "year": 2014}, {"title": "Kidney", "author": ["A. Hart", "J.M. Smith", "M.A. Skeans", "S.K. Gustafson", "D.E. Stewart", "W.S. Cherikh", "J.L. Wainright", "G. Boyle", "J.J. Snyder", "B.L. Kasiske", "A.K. Israni."], "venue": "American Journal of Transplantation (Special Issue: OPTN/SRTR Annual Data Report 2014) 16, Issue Supplement S2 (2016), 11\u201346.", "citeRegEx": "Hart et al\\.,? 2016", "shortCiteRegEx": "Hart et al\\.", "year": 2016}, {"title": "A New Branch-and-Price Approach for the Kidney Exchange Problem", "author": ["Xenia Klimentova", "Filipe Alvelos", "Ana Viana."], "venue": "Computational Science and Its Applications (ICCSA-2014). Springer, 237\u2013252.", "citeRegEx": "Klimentova et al\\.,? 2014", "shortCiteRegEx": "Klimentova et al\\.", "year": 2014}, {"title": "On the kidney exchange problem: cardinality constrained cycle and chain problems on directed graphs: a survey of integer programming approaches", "author": ["Vicky Mak-Hau."], "venue": "Journal of Combinatorial Optimization (2015), 1\u201325.", "citeRegEx": "Mak.Hau.,? 2015", "shortCiteRegEx": "Mak.Hau.", "year": 2015}, {"title": "Paired and Altruistic Kidney Donation in the UK: Algorithms and Experimentation", "author": ["David Manlove", "Gregg O\u2019Malley"], "venue": "ACM Journal of Experimental Algorithmics 19,", "citeRegEx": "Manlove and O.Malley.,? \\Q2015\\E", "shortCiteRegEx": "Manlove and O.Malley.", "year": 2015}, {"title": "Preflib: A library for preferences", "author": ["Nicholas Mattei", "Toby Walsh."], "venue": "Algorithmic Decision Theory. Lecture Notes in Computer Science, Vol. 8176. Springer, 259\u2013270.", "citeRegEx": "Mattei and Walsh.,? 2013", "shortCiteRegEx": "Mattei and Walsh.", "year": 2013}, {"title": "Domino paired kidney donation: a strategy to make best use of live non-directed donation", "author": ["Robert Montgomery", "Sommer Gentry", "William H Marks", "Daniel S Warren", "Janet Hiller", "Julie Houp", "Andrea A Zachary", "J Keith Melancon", "Warren R Maley", "Hamid Rabb", "Christopher Simpkins", "Dorry L Segev."], "venue": "The Lancet 368, 9533 (2006), 419\u2013421.", "citeRegEx": "Montgomery et al\\.,? 2006", "shortCiteRegEx": "Montgomery et al\\.", "year": 2006}, {"title": "Maximizing Expectation on Vertex-Disjoint Cycle Packing", "author": ["Jo\u00e3o Pedro Pedroso."], "venue": "Computational Science and Its Applications (ICCSA-2014). Springer, 32\u201346.", "citeRegEx": "Pedroso.,? 2014", "shortCiteRegEx": "Pedroso.", "year": 2014}, {"title": "Fast Optimal Clearing of Capped-Chain Barter Exchanges", "author": ["Benjamin Plaut", "John P. Dickerson", "Tuomas Sandholm."], "venue": "AAAI Conference on Artificial Intelligence (AAAI). 601\u2013607.", "citeRegEx": "Plaut et al\\.,? 2016a", "shortCiteRegEx": "Plaut et al\\.", "year": 2016}, {"title": "Hardness of the Pricing Problem for Chains in Barter Exchanges", "author": ["Benjamin Plaut", "John P. Dickerson", "Tuomas Sandholm."], "venue": "CoRR abs/1606.00117 (2016).", "citeRegEx": "Plaut et al\\.,? 2016b", "shortCiteRegEx": "Plaut et al\\.", "year": 2016}, {"title": "The case for a living emotionally related international kidney donor exchange registry", "author": ["F.T. Rapaport."], "venue": "Transplantation Proceedings 18 (1986), 5\u20139.", "citeRegEx": "Rapaport.,? 1986", "shortCiteRegEx": "Rapaport.", "year": 1986}, {"title": "A Nonsimultaneous, Extended, Altruistic-Donor Chain", "author": ["Michael Rees", "Jonathan Kopke", "Ronald Pelletier", "Dorry Segev", "Matthew Rutter", "Alfredo Fabrega", "Jeffrey Rogers", "Oleh Pankewycz", "Janet Hiller", "Alvin Roth", "Tuomas Sandholm", "Utku \u00dcnver", "Robert Montgomery."], "venue": "New England Journal of Medicine 360, 11 (2009), 1096\u20131101.", "citeRegEx": "Rees et al\\.,? 2009", "shortCiteRegEx": "Rees et al\\.", "year": 2009}, {"title": "Kidney exchange", "author": ["Alvin Roth", "Tayfun S\u00f6nmez", "Utku \u00dcnver."], "venue": "Quarterly Journal of Economics 119, 2 (2004), 457\u2013488.", "citeRegEx": "Roth et al\\.,? 2004", "shortCiteRegEx": "Roth et al\\.", "year": 2004}, {"title": "Pairwise Kidney Exchange", "author": ["Alvin Roth", "Tayfun S\u00f6nmez", "Utku \u00dcnver."], "venue": "Journal of Economic Theory 125, 2 (2005), 151\u2013188.", "citeRegEx": "Roth et al\\.,? 2005", "shortCiteRegEx": "Roth et al\\.", "year": 2005}, {"title": "Efficient kidney exchange: Coincidence of wants in a market with compatibility-based preferences", "author": ["Alvin Roth", "Tayfun S\u00f6nmez", "Utku \u00dcnver."], "venue": "American Economic Review 97 (2007), 828\u2013851.", "citeRegEx": "Roth et al\\.,? 2007", "shortCiteRegEx": "Roth et al\\.", "year": 2007}, {"title": "Utilizing list exchange and nondirected donation through \u2018chain\u2019 paired kidney donations", "author": ["Alvin Roth", "Tayfun S\u00f6nmez", "Utku \u00dcnver", "Frank Delmonico", "Susan L. Saidman."], "venue": "American Journal of Transplantation 6 (2006), 2694\u20132705.", "citeRegEx": "Roth et al\\.,? 2006", "shortCiteRegEx": "Roth et al\\.", "year": 2006}, {"title": "Design and analysis of multi-hospital kidney exchange mechanisms using random graphs", "author": ["Panos Toulis", "David C. Parkes."], "venue": "Games and Economic Behavior 91, 0 (2015), 360\u2013382.", "citeRegEx": "Toulis and Parkes.,? 2015", "shortCiteRegEx": "Toulis and Parkes.", "year": 2015}, {"title": "Dynamic kidney exchange", "author": ["Utku \u00dcnver."], "venue": "Review of Economic Studies 77, 1 (2010), 372\u2013414.", "citeRegEx": "\u00dcnver.,? 2010", "shortCiteRegEx": "\u00dcnver.", "year": 2010}, {"title": "Mathematical Programming", "author": ["Steven Vajda."], "venue": "Addison-Wesley.", "citeRegEx": "Vajda.,? 1961", "shortCiteRegEx": "Vajda.", "year": 1961}, {"title": "FAILURE-AWARE THE PICEF MODEL In this section, we provide a proof of correctness of Algorithm 1\u2014which implements polynomial-time pricing of cycles for branch and price in the augmented failure-aware PICEF model\u2014and discuss by way of counterexample why the basic deterministic polynomial-time cycle pricing algorithms of Glorie et al", "author": ["Plaut"], "venue": null, "citeRegEx": "Plaut,? \\Q2016\\E", "shortCiteRegEx": "Plaut", "year": 2016}, {"title": "2016a] but not chains [Plaut et al. 2016b", "author": ["Plaut"], "venue": null, "citeRegEx": "Plaut,? \\Q2016\\E", "shortCiteRegEx": "Plaut", "year": 2016}], "referenceMentions": [{"referenceID": 21, "context": "In the United States alone, the kidney transplant waiting list grew from 58,000 people in 2004 to 99,000 people in 2014 [Hart et al. 2016].", "startOffset": 120, "endOffset": 138}, {"referenceID": 32, "context": "A kidney exchange [Rapaport 1986; Roth et al. 2004] is a centrally-administered barter exchange market for kidneys.", "startOffset": 18, "endOffset": 51}, {"referenceID": 26, "context": "A more recent development has been the introduction of non-directed donors (NDDs) to kidney exchange schemes [Montgomery et al. 2006; Roth et al. 2006].", "startOffset": 109, "endOffset": 151}, {"referenceID": 35, "context": "A more recent development has been the introduction of non-directed donors (NDDs) to kidney exchange schemes [Montgomery et al. 2006; Roth et al. 2006].", "startOffset": 109, "endOffset": 151}, {"referenceID": 4, "context": "This approach has been tractable so far; Manlove and O\u2019Malley [2015] report that each instance up to October 2014 in the United Kingdom\u2019s National Living Donor Kidney Sharing Schemes (NLDKSS)\u2014one of the largest kidney exchange schemes\u2014could be solved in under a second, with similar results using stateof-the-art solvers at other large exchanges in the US [Anderson et al. 2015; Plaut et al. 2016a] and the Netherlands [Glorie et al.", "startOffset": 356, "endOffset": 398}, {"referenceID": 28, "context": "This approach has been tractable so far; Manlove and O\u2019Malley [2015] report that each instance up to October 2014 in the United Kingdom\u2019s National Living Donor Kidney Sharing Schemes (NLDKSS)\u2014one of the largest kidney exchange schemes\u2014could be solved in under a second, with similar results using stateof-the-art solvers at other large exchanges in the US [Anderson et al. 2015; Plaut et al. 2016a] and the Netherlands [Glorie et al.", "startOffset": 356, "endOffset": 398}, {"referenceID": 20, "context": "2016a] and the Netherlands [Glorie et al. 2014].", "startOffset": 27, "endOffset": 47}, {"referenceID": 31, "context": "However, there is an urgent need for faster kidney exchange algorithms, for three reasons: \u2014 Schemes have recently increased chain-length caps, and we expect further increases as more schemes evolve towards using nonsimultaneous extended altruistic donor (NEAD) chains [Rees et al. 2009], which can extend across dozens of transplants.", "startOffset": 269, "endOffset": 287}, {"referenceID": 20, "context": "This approach has been tractable so far; Manlove and O\u2019Malley [2015] report that each instance up to October 2014 in the United Kingdom\u2019s National Living Donor Kidney Sharing Schemes (NLDKSS)\u2014one of the largest kidney exchange schemes\u2014could be solved in under a second, with similar results using stateof-the-art solvers at other large exchanges in the US [Anderson et al.", "startOffset": 41, "endOffset": 69}, {"referenceID": 5, "context": "These papers explored what efficient matchings in a steady-state kidney exchange would look like; extensions by Ashlagi et al. [2012], Ashlagi and Roth [2014], and Ding et al.", "startOffset": 112, "endOffset": 134}, {"referenceID": 5, "context": "These papers explored what efficient matchings in a steady-state kidney exchange would look like; extensions by Ashlagi et al. [2012], Ashlagi and Roth [2014], and Ding et al.", "startOffset": 112, "endOffset": 159}, {"referenceID": 5, "context": "These papers explored what efficient matchings in a steady-state kidney exchange would look like; extensions by Ashlagi et al. [2012], Ashlagi and Roth [2014], and Ding et al. [2015] address shortcomings", "startOffset": 112, "endOffset": 183}, {"referenceID": 7, "context": "Various forms of dynamism, like uncertainty over the possible future vertices in the pool [\u00dcnver 2010; Ashlagi et al. 2013; Akbarpour et al. 2014] or uncertainty over the existence of particular edges [Blum et al.", "startOffset": 90, "endOffset": 146}, {"referenceID": 1, "context": "Various forms of dynamism, like uncertainty over the possible future vertices in the pool [\u00dcnver 2010; Ashlagi et al. 2013; Akbarpour et al. 2014] or uncertainty over the existence of particular edges [Blum et al.", "startOffset": 90, "endOffset": 146}, {"referenceID": 13, "context": "2014] or uncertainty over the existence of particular edges [Blum et al. 2013; Dickerson et al. 2013; Blum et al. 2015] have been explored from both an economic and algorithmic efficiency point of view.", "startOffset": 60, "endOffset": 119}, {"referenceID": 16, "context": "2014] or uncertainty over the existence of particular edges [Blum et al. 2013; Dickerson et al. 2013; Blum et al. 2015] have been explored from both an economic and algorithmic efficiency point of view.", "startOffset": 60, "endOffset": 119}, {"referenceID": 12, "context": "2014] or uncertainty over the existence of particular edges [Blum et al. 2013; Dickerson et al. 2013; Blum et al. 2015] have been explored from both an economic and algorithmic efficiency point of view.", "startOffset": 60, "endOffset": 119}, {"referenceID": 4, "context": "Gametheoretic models of kidney exchange, where transplant centers are viewed as agents with a private type consisting of their internal pools, were presented and explored by Ashlagi and Roth [2014], Toulis and Parkes [2015], and Ashlagi et al.", "startOffset": 174, "endOffset": 198}, {"referenceID": 4, "context": "Gametheoretic models of kidney exchange, where transplant centers are viewed as agents with a private type consisting of their internal pools, were presented and explored by Ashlagi and Roth [2014], Toulis and Parkes [2015], and Ashlagi et al.", "startOffset": 174, "endOffset": 224}, {"referenceID": 4, "context": "Gametheoretic models of kidney exchange, where transplant centers are viewed as agents with a private type consisting of their internal pools, were presented and explored by Ashlagi and Roth [2014], Toulis and Parkes [2015], and Ashlagi et al. [2015]. Various forms of dynamism, like uncertainty over the possible future vertices in the pool [\u00dcnver 2010; Ashlagi et al.", "startOffset": 229, "endOffset": 251}, {"referenceID": 0, "context": "The two fundamental IP models for kidney exchange are the cycle formulation, which includes one binary decision variable for each feasible cycle or chain, and the edge formulation, which includes one decision variable for each compatible pair of agents [Abraham et al. 2007; Roth et al. 2007].", "startOffset": 253, "endOffset": 292}, {"referenceID": 34, "context": "The two fundamental IP models for kidney exchange are the cycle formulation, which includes one binary decision variable for each feasible cycle or chain, and the edge formulation, which includes one decision variable for each compatible pair of agents [Abraham et al. 2007; Roth et al. 2007].", "startOffset": 253, "endOffset": 292}, {"referenceID": 10, "context": "A number of kidney exchange algorithms use the cycle formulation with branch and price [Barnhart et al. 1998] to avoid the need to hold an exponential number of variables in memory [Abraham et al.", "startOffset": 87, "endOffset": 109}, {"referenceID": 0, "context": "1998] to avoid the need to hold an exponential number of variables in memory [Abraham et al. 2007; Dickerson et al. 2013; Glorie et al. 2014; Klimentova et al. 2014; Plaut et al. 2016a].", "startOffset": 77, "endOffset": 185}, {"referenceID": 16, "context": "1998] to avoid the need to hold an exponential number of variables in memory [Abraham et al. 2007; Dickerson et al. 2013; Glorie et al. 2014; Klimentova et al. 2014; Plaut et al. 2016a].", "startOffset": 77, "endOffset": 185}, {"referenceID": 20, "context": "1998] to avoid the need to hold an exponential number of variables in memory [Abraham et al. 2007; Dickerson et al. 2013; Glorie et al. 2014; Klimentova et al. 2014; Plaut et al. 2016a].", "startOffset": 77, "endOffset": 185}, {"referenceID": 22, "context": "1998] to avoid the need to hold an exponential number of variables in memory [Abraham et al. 2007; Dickerson et al. 2013; Glorie et al. 2014; Klimentova et al. 2014; Plaut et al. 2016a].", "startOffset": 77, "endOffset": 185}, {"referenceID": 28, "context": "1998] to avoid the need to hold an exponential number of variables in memory [Abraham et al. 2007; Dickerson et al. 2013; Glorie et al. 2014; Klimentova et al. 2014; Plaut et al. 2016a].", "startOffset": 77, "endOffset": 185}, {"referenceID": 0, "context": "An alternative approach to avoiding the cost of keeping the entire model in memory has been constraint generation, using variants of the edge formulation [Abraham et al. 2007].", "startOffset": 154, "endOffset": 175}, {"referenceID": 28, "context": "This algorithm is particularly effective for solving instances where the cycle-length cap is 3 and there is no cap on the length of chains, but it is outperformed by branch-and-price-based approaches if a finite chain-length cap is used [Plaut et al. 2016a].", "startOffset": 237, "endOffset": 257}, {"referenceID": 16, "context": "Alternative objectives for the kidney exchange problem include maximizing the expected number of transplants subject to post-match arc and vertex failures [Dickerson et al. 2013; Pedroso 2014; Alvelos et al. 2015].", "startOffset": 155, "endOffset": 213}, {"referenceID": 2, "context": "Alternative objectives for the kidney exchange problem include maximizing the expected number of transplants subject to post-match arc and vertex failures [Dickerson et al. 2013; Pedroso 2014; Alvelos et al. 2015].", "startOffset": 155, "endOffset": 213}, {"referenceID": 20, "context": "Some fielded exchanges use lexicographic optimisation of a hierarchy of objectives [Glorie et al. 2014; Manlove and O\u2019Malley 2015]; we note that our models can be augmented to support this class of objective function.", "startOffset": 83, "endOffset": 130}, {"referenceID": 0, "context": "The two fundamental IP models for kidney exchange are the cycle formulation, which includes one binary decision variable for each feasible cycle or chain, and the edge formulation, which includes one decision variable for each compatible pair of agents [Abraham et al. 2007; Roth et al. 2007]. In the cycle formulation, the number of constraints is sublinear in the input size, but the number of variables is exponential. In the edge formulation, the number of variables is linear but the number of constraints is exponential. Optimally solving these models has been an ongoing challenge for the past decade. Constantino et al. [2013] introduced the first two compact IP formulations for kidney exchange, where compact means that the counts of variables and constraints are polynomial in the size of the input.", "startOffset": 254, "endOffset": 635}, {"referenceID": 0, "context": "The two fundamental IP models for kidney exchange are the cycle formulation, which includes one binary decision variable for each feasible cycle or chain, and the edge formulation, which includes one decision variable for each compatible pair of agents [Abraham et al. 2007; Roth et al. 2007]. In the cycle formulation, the number of constraints is sublinear in the input size, but the number of variables is exponential. In the edge formulation, the number of variables is linear but the number of constraints is exponential. Optimally solving these models has been an ongoing challenge for the past decade. Constantino et al. [2013] introduced the first two compact IP formulations for kidney exchange, where compact means that the counts of variables and constraints are polynomial in the size of the input. Their extended edge formulation was shown empirically to be effective in finding the optimal solution where the cycle-length cap is greater than 3, particularly on dense graphs. However, each of the compact formulations introduced by Constantino et al. has a weaker linear program (LP) relaxation than the cycle formulation, even in the absence of NDDs. The EE-MTZ model [Mak-Hau 2015], another compact formulation, uses the variables and constraints of the extended edge formulation to model cycles and a variant of the Miller-Tucker-Zemlin model for the traveling salesman problem to model chains. The same paper introduces the exponentially-sized SPLIT-MTZ model, which adds redundant constraints to the edge formulation in order to tighten the LP relaxation. A number of kidney exchange algorithms use the cycle formulation with branch and price [Barnhart et al. 1998] to avoid the need to hold an exponential number of variables in memory [Abraham et al. 2007; Dickerson et al. 2013; Glorie et al. 2014; Klimentova et al. 2014; Plaut et al. 2016a]. These have been the fastest algorithms to date for the kidney exchange problem. An alternative approach to avoiding the cost of keeping the entire model in memory has been constraint generation, using variants of the edge formulation [Abraham et al. 2007]. Anderson et al. [2015] describe an approach based on an algorithm for the prize-collecting traveling salesman problem.", "startOffset": 254, "endOffset": 2145}, {"referenceID": 0, "context": "In Section 3, we introduce the position-indexed edge formulation (PIEF), a model for the kidney exchange problem with only cycles that is substantially smaller than, yet has an LPR equivalent to, the model with the tightest LPR for the cycles-only version of the problem [Abraham et al. 2007; Roth et al. 2007].", "startOffset": 271, "endOffset": 310}, {"referenceID": 34, "context": "In Section 3, we introduce the position-indexed edge formulation (PIEF), a model for the kidney exchange problem with only cycles that is substantially smaller than, yet has an LPR equivalent to, the model with the tightest LPR for the cycles-only version of the problem [Abraham et al. 2007; Roth et al. 2007].", "startOffset": 271, "endOffset": 310}, {"referenceID": 0, "context": "In Section 6, we use real and generated data from two nationwide kidney exchange programs\u2014one in the UK, and one in the US\u2014to compare our formulations against other competitive solvers [Abraham et al. 2007; Klimentova et al. 2014; Anderson et al. 2015; Plaut et al. 2016a].", "startOffset": 185, "endOffset": 272}, {"referenceID": 22, "context": "In Section 6, we use real and generated data from two nationwide kidney exchange programs\u2014one in the UK, and one in the US\u2014to compare our formulations against other competitive solvers [Abraham et al. 2007; Klimentova et al. 2014; Anderson et al. 2015; Plaut et al. 2016a].", "startOffset": 185, "endOffset": 272}, {"referenceID": 4, "context": "In Section 6, we use real and generated data from two nationwide kidney exchange programs\u2014one in the UK, and one in the US\u2014to compare our formulations against other competitive solvers [Abraham et al. 2007; Klimentova et al. 2014; Anderson et al. 2015; Plaut et al. 2016a].", "startOffset": 185, "endOffset": 272}, {"referenceID": 28, "context": "In Section 6, we use real and generated data from two nationwide kidney exchange programs\u2014one in the UK, and one in the US\u2014to compare our formulations against other competitive solvers [Abraham et al. 2007; Klimentova et al. 2014; Anderson et al. 2015; Plaut et al. 2016a].", "startOffset": 185, "endOffset": 272}, {"referenceID": 0, "context": "In Section 3, we introduce the position-indexed edge formulation (PIEF), a model for the kidney exchange problem with only cycles that is substantially smaller than, yet has an LPR equivalent to, the model with the tightest LPR for the cycles-only version of the problem [Abraham et al. 2007; Roth et al. 2007]. Section 3 presents the positionindexed chain-edge formulation (PICEF) which compactly brings chains into the model via a polynomial number of decision variables; the number of cycle decision variables is exponential in just the maximum cycle length (which is typically only 3 or 4 in fielded exchanges). To address that latter exponential reliance on the cycle length, we also present a branch-and-price-based implementation of PICEF. Finally, in Appendix C we present the hybrid position-indexed edge formulation (HPIEF), which combines PIEF and PICEF to yield a compact formulation. Throughout, we prove new results regarding the tightness of the LPRs of our models relative to the current state of the art. The tightness of these relaxations hints that our formulations will be competitive in practice; toward that end, we provide extensive experimental evidence that they are. In particular, we show that at least one of PICEF and HPIEF is faster than the best solver from all those provably-optimal solvers contributed in earlier papers that we evaluated in 96.41% of instances considered, with the speed-ups being most evident for larger instance sizes and larger chain caps. In Section 6, we use real and generated data from two nationwide kidney exchange programs\u2014one in the UK, and one in the US\u2014to compare our formulations against other competitive solvers [Abraham et al. 2007; Klimentova et al. 2014; Anderson et al. 2015; Plaut et al. 2016a]. Our new formulations are on par or faster than all other solvers, outperforming all other solvers by orders of magnitude on many problem instances. Finally, we demonstrate that our PICEF formulation can be adapted straightforwardly to the so-called failure-aware model where arcs probabilistically fail after algorithmic match but before transplantation, and we show how to adapt a recent (noncompact) branch-and-price-based formulation due to Dickerson et al. [2013] to perform pricing in polynomial time (Section 6).", "startOffset": 272, "endOffset": 2236}, {"referenceID": 0, "context": "The problem is NP-hard for realistic parameterizations of K and L [Abraham et al. 2007; Bir\u00f3 et al. 2009].", "startOffset": 66, "endOffset": 105}, {"referenceID": 11, "context": "The problem is NP-hard for realistic parameterizations of K and L [Abraham et al. 2007; Bir\u00f3 et al. 2009].", "startOffset": 66, "endOffset": 105}, {"referenceID": 14, "context": "PIEF is a natural extension of the extended edge formulation (EEF) of Constantino et al. [2013]. For this formulation, we assume that the problem instance contains no NDDs; HPIEF (the hybrid PIEF) in Appendix C is a compact generalisation of this formulation which can be used for instances with NDDs.", "startOffset": 70, "endOffset": 96}, {"referenceID": 38, "context": "We note that PIEF is not the first IP model for a directed-graph program to use position-indexed variables; Vajda [1961] uses position-indexed variables for subtour elimination in a model for the travelling salesman problem (TSP).", "startOffset": 108, "endOffset": 121}, {"referenceID": 14, "context": "Following the approach used by Constantino et al. [2013] for the extended edge formulation, we eliminate variables as follows.", "startOffset": 31, "endOffset": 57}, {"referenceID": 0, "context": "We begin by reviewing the cycle formulation due to Abraham et al. [2007] and Roth et al.", "startOffset": 51, "endOffset": 73}, {"referenceID": 0, "context": "We begin by reviewing the cycle formulation due to Abraham et al. [2007] and Roth et al. [2007], and note that the formulation is equivalent to that due to Anderson et al.", "startOffset": 51, "endOffset": 96}, {"referenceID": 0, "context": "We begin by reviewing the cycle formulation due to Abraham et al. [2007] and Roth et al. [2007], and note that the formulation is equivalent to that due to Anderson et al. [2015] if chains are disallowed.", "startOffset": 51, "endOffset": 179}, {"referenceID": 3, "context": "The idea of using variables for arcs in chains and a variable for each cycle was introduced in the PC-TSPbased algorithm of Anderson et al. [2015]. The innovation in our IP model is the use of position indices on arc variables, which results in polynomial counts of constraints and arc-variables; this is in contrast to the exponential number of constraints in the PC-TSP-based model.", "startOffset": 124, "endOffset": 147}, {"referenceID": 0, "context": "Multiple methods exist for solving the pricing problem in kidney exchange [Abraham et al. 2007; Glorie et al. 2014; Mak-Hau 2015; Plaut et al. 2016a]; in our experimental section, we use the cycle pricer of Glorie et al.", "startOffset": 74, "endOffset": 149}, {"referenceID": 20, "context": "Multiple methods exist for solving the pricing problem in kidney exchange [Abraham et al. 2007; Glorie et al. 2014; Mak-Hau 2015; Plaut et al. 2016a]; in our experimental section, we use the cycle pricer of Glorie et al.", "startOffset": 74, "endOffset": 149}, {"referenceID": 28, "context": "Multiple methods exist for solving the pricing problem in kidney exchange [Abraham et al. 2007; Glorie et al. 2014; Mak-Hau 2015; Plaut et al. 2016a]; in our experimental section, we use the cycle pricer of Glorie et al.", "startOffset": 74, "endOffset": 149}, {"referenceID": 0, "context": "With one decision variable per cycle, Abraham et al. [2007] could not even write the full integer program in memory for instances as small as 1000 pairs.", "startOffset": 38, "endOffset": 60}, {"referenceID": 0, "context": "With one decision variable per cycle, Abraham et al. [2007] could not even write the full integer program in memory for instances as small as 1000 pairs. Branch and price is a method where only a subset of the decision variables are kept in memory, and columns (in the case of PICEF, only those corresponding to cycle variables) are slowly added until correctness is proven at each node in a branch-and-bound search tree. If necessary, superfluous columns can also be removed from the model, in order to prevent its size from exceeding memory. The following process occurs at each node in the search tree: first, the LP relaxation of the current model (which may contain only a small number of cycles) is solved. The next step is to generate positive price cycles: cycles that have the potential to improve the objective value if included in the model. The price of a cycle c is given by \u2211 (i,j)\u2208c(wij\u2212\u03b4i), where \u03b4i is the dual value of vertex i. While there exist any positive price cycles at a node in the search tree, optimality of the reduced LP has not yet been proved at that node. The pricing problem is to bring at least one new positive price cycle into the model, or prove that none exist. Multiple methods exist for solving the pricing problem in kidney exchange [Abraham et al. 2007; Glorie et al. 2014; Mak-Hau 2015; Plaut et al. 2016a]; in our experimental section, we use the cycle pricer of Glorie et al. [2014] with the bugfix of Plaut et al.", "startOffset": 38, "endOffset": 1428}, {"referenceID": 0, "context": "With one decision variable per cycle, Abraham et al. [2007] could not even write the full integer program in memory for instances as small as 1000 pairs. Branch and price is a method where only a subset of the decision variables are kept in memory, and columns (in the case of PICEF, only those corresponding to cycle variables) are slowly added until correctness is proven at each node in a branch-and-bound search tree. If necessary, superfluous columns can also be removed from the model, in order to prevent its size from exceeding memory. The following process occurs at each node in the search tree: first, the LP relaxation of the current model (which may contain only a small number of cycles) is solved. The next step is to generate positive price cycles: cycles that have the potential to improve the objective value if included in the model. The price of a cycle c is given by \u2211 (i,j)\u2208c(wij\u2212\u03b4i), where \u03b4i is the dual value of vertex i. While there exist any positive price cycles at a node in the search tree, optimality of the reduced LP has not yet been proved at that node. The pricing problem is to bring at least one new positive price cycle into the model, or prove that none exist. Multiple methods exist for solving the pricing problem in kidney exchange [Abraham et al. 2007; Glorie et al. 2014; Mak-Hau 2015; Plaut et al. 2016a]; in our experimental section, we use the cycle pricer of Glorie et al. [2014] with the bugfix of Plaut et al. [2016a]. Once no more positive price cycles exist, the reduced LP at a specific node is guaranteed to be optimal.", "startOffset": 38, "endOffset": 1468}, {"referenceID": 4, "context": "[2016a];2 \u2014 CG-TSP, a recent IP formulation based on a model for the prize-collecting traveling salesman problem, with constraint generation [Anderson et al. 2015]; \u2014 PICEF, the model from Section 4 of this paper; \u2014 BNP-PICEF, a branch and price version of the PICEF model, as presented in Section 4.", "startOffset": 141, "endOffset": 163}, {"referenceID": 22, "context": "2 of this paper; \u2014 HPIEF, the Hybrid PIEF model from Appendix C of this paper (which reduces to PIEF for L = 0); and \u2014 BNP-DCD, a branch-and-price algorithm using the Disaggregated Cycle Decomposition model, which is related to both the cycle formulation and the extended edge formulation [Klimentova et al. 2014].", "startOffset": 289, "endOffset": 313}, {"referenceID": 0, "context": "We compare run times of the following state-of-the-art solvers: \u2014 BNP-DFS, the original branch-and-price-based cycle formulation solver due to Abraham et al. [2007]; \u2014 BNP-POLY, a branch-and-price-based cycle formulation solver with pricing due to Glorie et al.", "startOffset": 143, "endOffset": 165}, {"referenceID": 0, "context": "We compare run times of the following state-of-the-art solvers: \u2014 BNP-DFS, the original branch-and-price-based cycle formulation solver due to Abraham et al. [2007]; \u2014 BNP-POLY, a branch-and-price-based cycle formulation solver with pricing due to Glorie et al. [2014] and Plaut et al.", "startOffset": 143, "endOffset": 269}, {"referenceID": 0, "context": "We compare run times of the following state-of-the-art solvers: \u2014 BNP-DFS, the original branch-and-price-based cycle formulation solver due to Abraham et al. [2007]; \u2014 BNP-POLY, a branch-and-price-based cycle formulation solver with pricing due to Glorie et al. [2014] and Plaut et al. [2016a];2 \u2014 CG-TSP, a recent IP formulation based on a model for the prize-collecting traveling salesman problem, with constraint generation [Anderson et al.", "startOffset": 143, "endOffset": 294}, {"referenceID": 26, "context": "2Recently, Plaut et al. [2016b] showed a correctness bug in both implementations of the BNP-POLY-style solvers due to Glorie et al.", "startOffset": 11, "endOffset": 32}, {"referenceID": 19, "context": "[2016b] showed a correctness bug in both implementations of the BNP-POLY-style solvers due to Glorie et al. [2014] and Plaut et al.", "startOffset": 94, "endOffset": 115}, {"referenceID": 19, "context": "[2016b] showed a correctness bug in both implementations of the BNP-POLY-style solvers due to Glorie et al. [2014] and Plaut et al. [2016a]; for posterity, we still include these run times.", "startOffset": 94, "endOffset": 140}, {"referenceID": 20, "context": "We remark that the BNP-DCD model due to Klimentova et al. [2014] was run on all NLDKSS instances where the chain cap L was equal to 0.", "startOffset": 40, "endOffset": 65}, {"referenceID": 19, "context": "Finally we note that the solver of Glorie et al. [2014] was executed on the NLDKSS instances with a chain cap of L, for 0 \u2264 L \u2264 4.", "startOffset": 35, "endOffset": 56}, {"referenceID": 11, "context": "To address these post-match arc failures, Dickerson et al. [2013] augments the standard model of kidney exchange to include a success probability p for each arc in the graph.", "startOffset": 42, "endOffset": 66}, {"referenceID": 0, "context": "Prior compact formulations\u2014and, indeed, prior \u201cedge formulations\u201d like those due to Abraham et al. [2007], Constantino et al.", "startOffset": 84, "endOffset": 106}, {"referenceID": 0, "context": "Prior compact formulations\u2014and, indeed, prior \u201cedge formulations\u201d like those due to Abraham et al. [2007], Constantino et al. [2013], and Anderson et al.", "startOffset": 84, "endOffset": 133}, {"referenceID": 0, "context": "Prior compact formulations\u2014and, indeed, prior \u201cedge formulations\u201d like those due to Abraham et al. [2007], Constantino et al. [2013], and Anderson et al. [2015]\u2014are not expressive enough to allow for generalization to this model.", "startOffset": 84, "endOffset": 161}, {"referenceID": 15, "context": "While this assumption of equal probabilities is likely not true in practice, Dickerson et al. [2013] motivate why a fielded implementation of this model would potentially choose to equalize all failure probabilities: namely, so that already-sick patients\u2014who will likely have higher failure rates\u2014are not further marginalized by this model.", "startOffset": 77, "endOffset": 101}, {"referenceID": 14, "context": "Failure-aware polynomial pricing for cycles The initial failure-aware branch-and-price work by Dickerson et al. [2013] generalized the pricing strategy of Abraham et al.", "startOffset": 95, "endOffset": 119}, {"referenceID": 0, "context": "[2013] generalized the pricing strategy of Abraham et al. [2007], and thus suffered from a pricing problem that ran in time exponential in cycle and chain cap.", "startOffset": 43, "endOffset": 65}, {"referenceID": 0, "context": "[2013] generalized the pricing strategy of Abraham et al. [2007], and thus suffered from a pricing problem that ran in time exponential in cycle and chain cap. Glorie et al. [2014] and Plaut et al.", "startOffset": 43, "endOffset": 181}, {"referenceID": 0, "context": "[2013] generalized the pricing strategy of Abraham et al. [2007], and thus suffered from a pricing problem that ran in time exponential in cycle and chain cap. Glorie et al. [2014] and Plaut et al. [2016a] discussed polynomial pricing algorithms for cycles\u2014but not chains [Plaut et al.", "startOffset": 43, "endOffset": 206}, {"referenceID": 19, "context": "Reduction of Glorie et al. [2014] 5: C \u2190 C \u222a GETNEGATIVECYCLES(D, k,wk) 6: return C", "startOffset": 13, "endOffset": 34}, {"referenceID": 26, "context": "Using the algorithm of Plaut et al. [2016a] as a subroutine, we present an algorithm which solves the failure-aware, or discounted, pricing problem for cycles in polynomial time, under the restriction that all arcs have equal success probability p.", "startOffset": 23, "endOffset": 44}, {"referenceID": 19, "context": "Glorie et al. [2014] show how the arc weights and dual values can be collapsed into just arc weights, and reduce the deterministic pricing problem to finding negative-weight cycles of length at most K in a directed graph.", "startOffset": 0, "endOffset": 21}, {"referenceID": 19, "context": "Glorie et al. [2014] show how the arc weights and dual values can be collapsed into just arc weights, and reduce the deterministic pricing problem to finding negative-weight cycles of length at most K in a directed graph. In this section, we use \u201clength\u201d to denote the number of vertices in a cycle, not its weight. The discounted price of a cycle is p|c| \u2211 (i,j)\u2208c wij \u2212 \u2211 j\u2208c \u03b4j . Since the utility of an arc now depends on what cycle it ends up in, we cannot collapse arc weights and dual values without knowing the length of the cycle containing it. With this motivation, we augment the algorithm to run O(K) iterations for each source vertex: one for each possible final cycle length. On each iteration, we know exactly how much arc weights will be worth in the final cycle, so we can reduce the discounted pricing problem to the deterministic pricing problem. Pseudocode for the failure-aware cycle pricing algorithm is given by GETDISCOUNTEDPOSITIVEPRICECYCLES. Let w and \u03b4 be the arc weights and dual values respectively in the original graph. The function GETNEGATIVECYCLES is the deterministic pricing algorithm due to Plaut et al. [2016a] which returns at least one negative cycle of length at most K, or shows that none exist.", "startOffset": 0, "endOffset": 1150}, {"referenceID": 19, "context": "Glorie et al. [2014] show how the arc weights and dual values can be collapsed into just arc weights, and reduce the deterministic pricing problem to finding negative-weight cycles of length at most K in a directed graph. In this section, we use \u201clength\u201d to denote the number of vertices in a cycle, not its weight. The discounted price of a cycle is p|c| \u2211 (i,j)\u2208c wij \u2212 \u2211 j\u2208c \u03b4j . Since the utility of an arc now depends on what cycle it ends up in, we cannot collapse arc weights and dual values without knowing the length of the cycle containing it. With this motivation, we augment the algorithm to run O(K) iterations for each source vertex: one for each possible final cycle length. On each iteration, we know exactly how much arc weights will be worth in the final cycle, so we can reduce the discounted pricing problem to the deterministic pricing problem. Pseudocode for the failure-aware cycle pricing algorithm is given by GETDISCOUNTEDPOSITIVEPRICECYCLES. Let w and \u03b4 be the arc weights and dual values respectively in the original graph. The function GETNEGATIVECYCLES is the deterministic pricing algorithm due to Plaut et al. [2016a] which returns at least one negative cycle of length at most K, or shows that none exist. The algorithm of Plaut et al. [2016a] has complexity O(|V ||A|K2).", "startOffset": 0, "endOffset": 1277}, {"referenceID": 15, "context": "Approaches to clearing dynamic kidney exchange often rely on solving the static problem many times [Awasthi and Sandholm 2009; Dickerson et al. 2012; Anderson 2014; Dickerson and Sandholm 2015; Glorie et al. 2015]; thus, faster static solvers result in better dynamic exchange solutions.", "startOffset": 99, "endOffset": 213}, {"referenceID": 19, "context": "Approaches to clearing dynamic kidney exchange often rely on solving the static problem many times [Awasthi and Sandholm 2009; Dickerson et al. 2012; Anderson 2014; Dickerson and Sandholm 2015; Glorie et al. 2015]; thus, faster static solvers result in better dynamic exchange solutions.", "startOffset": 99, "endOffset": 213}], "year": 2016, "abstractText": "A kidney exchange is an organized barter market where patients in need of a kidney swap willing but incompatible donors. Determining an optimal set of exchanges is theoretically and empirically hard. Traditionally, exchanges took place in cycles, with each participating patient-donor pair both giving and receiving a kidney. The recent introduction of chains, where a donor without a paired patient triggers a sequence of donations without requiring a kidney in return, increased the efficacy of fielded kidney exchanges\u2014while also dramatically raising the empirical computational hardness of clearing the market in practice. While chains can be quite long, unbounded-length chains are not desirable: planned donations can fail before transplant for a variety of reasons, and the failure of a single donation causes the rest of that chain to fail, so parallel shorter chains are better in practice. In this paper, we address the tractable clearing of kidney exchanges with short cycles and chains that are long but bounded. This corresponds to the practice at most modern fielded kidney exchanges. We introduce three new integer programming formulations, two of which are compact. Furthermore, one of these models has a linear programming relaxation that is exactly as tight as the previous tightest formulation (which was not compact) for instances in which each donor has a paired patient. On real data from the UNOS nationwide exchange in the United States and the NLDKSS nationwide exchange in the United Kingdom, as well as on generated realistic large-scale data, we show that our new models are competitive with all existing solvers\u2014in many cases outperforming all other solvers by orders of magnitude. Finally, we note that our position-indexed chain-edge formulation can be modified in a straightforward way to take post-match edge failure into account, under the restriction that edges have equal probabilities of failure. Post-match edge failure is a primary source of inefficiency in presently-fielded kidney exchanges. We show how to implement such failure-aware matching in our model, and also extend the state-of-the-art general branch-and-price-based non-compact formulation for the failure-aware problem to run its pricing problem in polynomial time.", "creator": "TeX"}}}