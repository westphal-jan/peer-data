{"id": "1608.08028", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "29-Aug-2016", "title": "From Deterministic ODEs to Dynamic Structural Causal Models", "abstract": "We show how, under certain conditions, the asymptotic behaviour of an Ordinary Differential Equation under non-constant interventions can be modelled using Dynamic Structural Causal Models. In contrast to earlier work, we study not only the effect of interventions on equilibrium states; rather, we model asymptotic behaviour that is dynamic under interventions that vary in time, and include as a special case the study of static equilibria.", "histories": [["v1", "Mon, 29 Aug 2016 12:43:42 GMT  (175kb,D)", "http://arxiv.org/abs/1608.08028v1", null]], "reviews": [], "SUBJECTS": "cs.AI", "authors": ["paul k rubenstein", "stephan bongers", "joris m mooij", "bernhard schoelkopf"], "accepted": false, "id": "1608.08028"}, "pdf": {"name": "1608.08028.pdf", "metadata": {"source": "CRF", "title": "From Deterministic ODEs to Dynamic Structural Causal Models", "authors": ["Paul K. Rubenstein", "Stephan Bongers"], "emails": ["pkr23@cam.ac.uk", "S.R.Bongers@uva.nl", "j.m.mooij@uva.nl", "bs@tue.mpg.de"], "sections": [{"heading": "1 Introduction", "text": "In fact, most of them are able to determine for themselves how they have behaved."}, {"heading": "2 Ordinary Differential Equations", "text": "Consider the time-dependent variables Xi (t) for i (a) i (a) i (a) i (b) i (b) i (b) i (b) i (b) i (b) i (b) i (b) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i \u2212 b) i (c) i (c) i \u2212 b) i (c) i (c) i (c) i (c) i i (c) i i i (c) i \u2212 b (c) i \u2212 b i \u2212 b) i (c) i (c) i (c) i (c) i) i (c) i (c) i (c) i (c) i (c) i (c) i) i (c) \u2212 b (c) \u2212 b (c) \u2212 b (c) \u2212 b) i (c) i) i (c) i) i (c) i (c) i) i (c) \u2212 b) i (c) i \u2212 b (c) i \u2212 b) i (c) i \u2212 b) i (c) i \u2212 b (c) i \u2212 b) i (c) i \u2212 b) i (c) i \u2212 b) i (c) i \u2212 b) i (c) i \u2212 b (c) i \u2212 b) i (c) i \u2212 b) i (c) i (c) i \u2212 b) i (c) i (c) i \u2212 b (c) i (c) \u2212 b) \u2212 b (c (c) i (c) i (c) \u2212 b) \u2212 b (c) \u2212 b (c) \u2212 b (c (c) \u2212 b) \u2212 b (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) i (c) \u2212 b) i (c) i (c) i (c) i (c \u2212 b) i (c) i i i (c) i (c) i (c \u2212 b) i (c) i (c"}, {"heading": "3 Interventions", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1 Time-dependent perfect interventions", "text": "Normally, in the causality literature, a perfect intervention means that a variable is bound to a given value. A natural analogy to this in the time-dependent case is a perfect intervention that forces a variable to take a certain trajectory. In other words, with a subset I I I and a function such as I: R \u2265 0 \u2212 \u2192 i-I Ri, we can intervene in the subset of variable XI by forcing XI (t) = \u0445 I (t) \u0441\u0442\u043e\u043b\u0435\u043d\u0438\u0441t \u0441R \u2265 0. Using Pearl's Do-Calculus notation [1] and omitting t, we write this for this intervention (XI = \u0432 I). Such interventions are more general objects than those of equilibrium or time-independent cases, but in the specific case that we limit ourselves to constant trajectories, the two concepts coincide."}, {"heading": "3.2 Sets of interventions", "text": "If we want to model \"all kinds of interventions,\" then the resulting asymptotic dynamics that can occur are arbitrarily complicated; the idea is to fix a simpler set of interventions and derive from it an SCM that models only those interventions, leading to a model that is simpler than the original ODE, but that nonetheless allows us to think about interventions we are interested in. In the examples in this paper, we limit ourselves to periodic or quasi-periodic interventions, but the results hold for more general sets of interventions that satisfy the stability definitions that will be presented later. We need to define a notation to express the sets of interventions that we will model. Since interventions correspond to the forced variables to take some trajectories, we describe notations for defining trajectories."}, {"heading": "3.3 Describing interventions in ODEs", "text": "We can realize a perfect intervention by replacing the equations of the intervened variables with new equations that fix them to follow the given paths: Ddo (XI = \u0432I): {fi (Xi, Xpa (i))) (t) = 0, X (k) i (0) = (X (k) 0) i 0 \u2264 k \u2264 ni \u2212 1, i \u0432 I\\ IXi (t) \u2212 \u0441i (t) = 0 i \u0192IThis procedure corresponds to the concept of intervention in an SCM. Physically, this corresponds to the decoupling of the intervened variables from their usual causal mechanism by forcing them to take a certain value, while the non-intervened variables have no causative mechanisms. Perfect interventions will generally not be feasible in the real world. In practice, an intervention on a variable of the variables would correspond to the change by adding the differential equation as causative terms."}, {"heading": "4 Dynamic Stability", "text": "A key assumption of [11] was that the systems under consideration would be stable in the sense that they would merge into unique stable equilibria (constant) interventions (constant interventions), which has enabled them to study non-constant asymptotic dynamics, in which this is not an idea of stability that is appropriate for our purposes. Instead, we define our stability by referring to a number of trajectories. We will use DynI for this purpose, so that elements of DynI are trajectories for all variables in the system. To be completely explicit, we can think of an element that DynI considers functional."}, {"heading": "5 Dynamic Structural Causal Models", "text": "A deterministic SCMM is a collection of structural equations that define the value of the variable Xi in relation to its parents. We extend this to the case that our variables do not take fixed values but represent whole trajectories. Definition 5: A deterministic structural model (DSCM) for the time of indexed variables XI in a modular set of trajectories Dyn is a collection of structural equations."}, {"heading": "5.1 Interventions in a DSCM", "text": "Interventions in (D) SCM are realized by replacing the structural equations of the intervened variables. Given that for some I'I I, the intervened DSCMMdo (XI = I) can be written: Mdo (XI = I): {Xi = Fi (Xpa (i))) i-I\\ I Xi = i i i-I. The causal mechanisms determining the non-intervened variables remain unaffected, so that their structural equations remain the same. The intervened variables are decoupled from their usual causal mechanisms and are forced to follow the specified path."}, {"heading": "5.2 Deriving DSCMs from ODEs", "text": "We need the following consistency property between the asymptotic dynamics of the ODE and the series of interventions. Definition 6 (Structural dynamic stability) Let dyne be modular. The pair (D, dyne) is structurally dynamically stable if (D, dyni\\ {i}) is dynamically stable, with reference to dyni for all i. This means that for each trajectory (D, dyne) is structurally stable if the asymptotic dynamics of the intervened ODE Ddo (XI\\ {i} = Structural stability (dynne) Dyn (dyni) is structurally stable, as one element of dyni dynamics is unique. Since dyne is modular, the asymptotic dynamics of the non-intervened variables can be realized, like the trajectory dynamics of dyni dynamics."}, {"heading": "5.3 Solutions of a DSCM", "text": "Theorem 1 states that we can construct a DSCM according to the procedure described above. We constructed each equation by simultaneously intervening on D \u2212 1 variables. The result of this section states that the DSCM can be used to correctly model interventions on any subset of variables. We say that \"I\" DynI is a solution of M if \"i = Fi\" (\u03b7pa (i) and \"I.\" Theorem 2. Let us assume that (D, Dyn) is structurally dynamically stable. Let's leave \"I\" and let's leave \"I\" DynI. \"Then\" Ddo \"(XI =\" I) is dynamically stable if and only if the intervened SCMM (Ddo (XI = \"I) has a unique solution. If there is a unique solution, it coincides with the element that describes the asymptotic dynamics of DynI (XI =\" I). Note 2. We could also \"take\" in this case I applies exactly to the above D."}, {"heading": "5.4 Causal reasoning is preserved", "text": "The following theorem proves that these notions of intervention agree and that DSCM provide a calculation to think about the asymptotic behavior of ODEs under interventions in Dyn. One consequence of this is that the diagram in Figure 4 oscillates. Theorem 3. Let's assume that (D, Dyn) is structurally dynamically stable. Let me and let me (I, DynI). ThenM (Ddo (XI, I) = (MD) do (XI, I). In summary, theorems 1-3 collectively state that if (D, Dyn) is dynamically structurally stable, it is possible to derive a DSCM that allows us to think about the asymptotic dynamics of the ODE under any possible intervention in Dyn. A functioning example showing how to derive a DSCM for the mass spring system from Example 1 is included in the Supplementary."}, {"heading": "6 Discussion", "text": "The most important contribution of this paper is to show that the SCM framework can be applied to reason about time-dependent interventions in an ODE in a dynamic environment. In particular, we have shown that if an ODE behaves well enough among a series of interventions, a DSCM can be derived that captures how the asymptotic dynamics of these interventions change, in contrast to previous approaches to linking the language of ODEs to the SCM framework in which SCM was used to describe the stable equilibrium of the ODE and how it changes among interventions.There are two possible directions in which this work can be expanded, the first being to loosen the assumption that asymptotic dynamics are independent of initial conditions, for example, simple models of neural dynamics such as the FitzHugh-Namugo model, which has a boundary cycle in the observation system."}, {"heading": "Acknowledgments", "text": "Stephan Bongers was supported by NWO, the Dutch Organisation for Scientific Research (VIDI grant 639.072.410) and funded by the European Research Council (ERC) within the framework of the research and innovation programme Horizon 2020 of the European Union (grant agreement no 639466)."}, {"heading": "A Proofs", "text": "In both cases we must show that the equations for Ddo (XIi) = XI (t) j (i) j (t) j (t) j (t) j (t) j (t) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (p) p) p (p) p (p) p) p (p) p (p) p (p) p) p (p) p (i) p (p) p (p) p) p (p) p (i) p (p) p (i) p (p) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (p (i) p (i) p (i) p (p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i) p (i p (i) p (i) p (i) p (i) p (i) p (i p (i) p ("}, {"heading": "B Deriving the DSCM for the mass-spring system", "text": "Consider the mass spring system of example 1, but with D \u2265 3 an arbitrary integer system (1). We repeat the construction (1). We have D masses attached together to springs (1). The position of the ith mass in time t is Xi \u2212 Xi (t), and its mass is in fact mi. For the notation constant we call X0 = 0 and XD + 1 = L the places where the ends of the masses attached to the edge meet the walls to which they are attached. X0 and XD + 1 are constant. The natural length and spring constant of the spring connecting masses i and i + 1 are li and ki respectively. The ith mass is subjected to linear attenuation with coefficients bi where bi is small to ensure that the system is subdamped.The equation of motion for the ith mass (1) is given by: miX-i (t) i (t), (t) \u2212 t (li) \u2212 t."}], "references": [{"title": "Causality: Models, Reasoning, and Inference", "author": ["J. Pearl"], "venue": null, "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2009}, {"title": "Structural equations with latent variables", "author": ["Kenneth A Bollen"], "venue": null, "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2014}, {"title": "Causality in bayesian belief networks", "author": ["Marek J Druzdzel", "Herbert A Simon"], "venue": "In Proceedings of the Ninth international conference on Uncertainty in artificial intelligence,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 1993}, {"title": "Learning linear cyclic causal models with latent variables", "author": ["Antti Hyttinen", "Frederick Eberhardt", "Patrik O Hoyer"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2012}, {"title": "On causal discovery with cyclic additive noise models", "author": ["Joris M Mooij", "Dominik Janzing", "Tom Heskes", "Bernhard Sch\u00f6lkopf"], "venue": "In Advances in neural information processing systems,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2011}, {"title": "Learning why things change: the difference-based causality learner", "author": ["Mark Voortman", "Denver Dash", "Marek J Druzdzel"], "venue": "Proceedings of the 26th Conference on Uncertainty in Artificial Intelligence", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2010}, {"title": "Discovering cyclic causal models by independent components analysis", "author": ["Gustavo Lacerda", "Peter L Spirtes", "Joseph Ramsey", "Patrik O Hoyer"], "venue": "In Proceedings of the Twenty-Fourth Conference on Uncertainty in Artificial Intelligence (UAI2008),", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2008}, {"title": "Directed cyclic graphical representations of feedback models", "author": ["Peter Spirtes"], "venue": "In Proceedings of the Eleventh conference on Uncertainty in artificial intelligence,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1995}, {"title": "Causality and model abstraction", "author": ["Yumi Iwasaki", "Herbert A Simon"], "venue": "Artificial intelligence,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 1994}, {"title": "Restructuring dynamic causal systems in equilibrium", "author": ["Denver Dash"], "venue": "In AISTATS. Citeseer,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2005}, {"title": "From ordinary differential equations to structural causal models: the deterministic case", "author": ["J. Mooij", "D. Janzing", "B. Sch\u00f6lkopf"], "venue": "Proceedings of the Twenty-Ninth Conference Annual Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2013}], "referenceMentions": [{"referenceID": 5, "context": "With the exception of [6], each of these methods assume that the dynamical system comes to a static equilibrium, with the derived SCM describing how this equilibrium changes under intervention.", "startOffset": 22, "endOffset": 25}, {"referenceID": 10, "context": "In doing so, we draw inspiration from the approach of [11].", "startOffset": 54, "endOffset": 58}, {"referenceID": 10, "context": "One possible way to write down an ODE is to canonically decompose it into a collection of first order differential equations, such as is done in [11].", "startOffset": 145, "endOffset": 149}, {"referenceID": 10, "context": "3) Example 1 ([11]).", "startOffset": 14, "endOffset": 18}, {"referenceID": 0, "context": "Using Pearl\u2019s do-calculus notation [1] and for brevity omitting the t, we write do(XI = \u03b6 I) for this intervention.", "startOffset": 35, "endOffset": 38}, {"referenceID": 0, "context": "This should be interpreted as saying that interventions on each variable can be made independently and combined in any way, and it is thus related to notions that have been discussed in the literature under various headings [1] (e.", "startOffset": 224, "endOffset": 227}, {"referenceID": 10, "context": "A crucial assumption of [11] was that the systems considered were stable in the sense that they would converge to unique stable equilibria after arbitrary (constant) interventions.", "startOffset": 24, "endOffset": 28}, {"referenceID": 10, "context": "In the particular case that DynI consists of constant trajectories, the following definitions of stability can be seen to be closely related to those of [11].", "startOffset": 153, "endOffset": 157}, {"referenceID": 10, "context": "In the language of [11], this would imply that the ODE is structurally stable.", "startOffset": 19, "endOffset": 23}], "year": 2016, "abstractText": "We show how, under certain conditions, the asymptotic behaviour of an Ordinary Differential Equation under non-constant interventions can be modelled using Dynamic Structural Causal Models. In contrast to earlier work, we study not only the effect of interventions on equilibrium states; rather, we model asymptotic behaviour that is dynamic under interventions that vary in time, and include as a special case the study of static equilibria.", "creator": "LaTeX with hyperref package"}}}