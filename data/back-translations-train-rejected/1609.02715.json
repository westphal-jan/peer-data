{"id": "1609.02715", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "9-Sep-2016", "title": "Automatic Selection of Stochastic Watershed Hierarchies", "abstract": "The segmentation, seen as the association of a partition with an image, is a difficult task. It can be decomposed in two steps: at first, a family of contours associated with a series of nested partitions (or hierarchy) is created and organized, then pertinent contours are extracted. A coarser partition is obtained by merging adjacent regions of a finer partition. The strength of a contour is then measured by the level of the hierarchy for which its two adjacent regions merge. We present an automatic segmentation strategy using a wide range of stochastic watershed hierarchies. For a given set of homogeneous images, our approach selects automatically the best hierarchy and cut level to perform image simplification given an evaluation score. Experimental results illustrate the advantages of our approach on several real-life images datasets.", "histories": [["v1", "Fri, 9 Sep 2016 09:26:22 GMT  (2375kb,D)", "http://arxiv.org/abs/1609.02715v1", "in European Conference of Signal Processing (EUSIPCO), 2016, Budapest, Hungary"]], "COMMENTS": "in European Conference of Signal Processing (EUSIPCO), 2016, Budapest, Hungary", "reviews": [], "SUBJECTS": "cs.CV cs.LG", "authors": ["amin fehri", "santiago velasco-forero", "fernand meyer"], "accepted": false, "id": "1609.02715"}, "pdf": {"name": "1609.02715.pdf", "metadata": {"source": "CRF", "title": "AUTOMATIC SELECTION OF STOCHASTIC WATERSHED HIERARCHIES", "authors": ["Amin Fehri", "Santiago Velasco-Forero"], "emails": ["amin.fehri@mines-paristech.fr}", "santiago.velasco@mines-paristech.fr}", "fernand.meyer@mines-paristech.fr}"], "sections": [{"heading": null, "text": "Index terms - mathematical morphology, hierarchies, segmentation, stochastic water flows. 1. INTRODUCTION Image segmentation is the transformation that is often described as dividing the image domain into a series of meaningful regions. It is generally difficult to find the relevant contours in an image directly, and therefore it is useful to follow a two-step strategy: First, we produce a hierarchy and then extract the meaningful contours from it. To formalize the concept of segmentation, one can view the image as a graph in which the graphs are pixels or regions of the image, and the graph edges link neighboring regions according to a dissimilarity. Then, all edges of the graph are provided with a threshold that leads to a forest, i.e. a division of the image, so that our goal is to create a partial graph."}, {"heading": "2.1. Hierarchies and partitions", "text": "To be efficient, we are working on two resolutions. The lowest level is the pixel plane: the initial image is segmented and a fine partition is created, for example, a series of superpixels [6], [7] or the basins created by classical watershed. We assume that the fine partition created by an initial segmentation contains all the contours that make sense in the image. We define a dissimilarity between adjacency nodes adjacency graph (RAG): Each node represents a tile of the partition; an edge connects two nodes when the corresponding regions are neighbors; the weight of the edge is equal to the dissimilarity between the two regions. Working on the graph is much more efficient than working on the image because there are far fewer nodes in the graph than there are in the graph."}, {"heading": "2.2. Marker-based segmentation", "text": "To do this, in each region or object of interest, you can select a node that serves as the root in each desired tree. Then, we construct an MSF in which each tree takes root in one of the selected nodes. The roots are also called markers and this process is called marker-based segmentation. The end result is achieved by suppressing for each pair of markers the highest edge on the unique path on the MST that connects them to each other. This is illustrated in Figure 2A, B. Consider an edge that is the lowest of the MST of the weight \u03bb, and let's examine which markers lead to a selection of that edge. If we put at least one marker within the domains spanned by each of these trees, then the highest edge on the unique path on the MST that connects them is actually strongest, which is thus cut in the associated segmentation. This mechanism can be observed in Figure 2C, where we can see the selection that lies in the region that has the highest one of the EST and the highest one of the two paths in each of the two."}, {"heading": "2.3. Stochastic Watershed Hierarchies", "text": "Instead of using deterministic markers, one can use random markers that follow a certain distribution and thus generate random MSF values. Then, one can assign to each edge of the MST the probability that it will be cut accordingly, which corresponds to the probability of the appearance of the underlying contour. Depending on the distribution of the markers used, the resulting segmentation can be very variable. This idea finds its origin the stochastic watershed presented by Angulo in [9]. If we see the image as a topographic relief, the flooding of this image leads to watershed lines, i.e. to a segmentation. By spreading random flood sources several times and characterizing the flooding of the image accordingly, one can predefine each contour of the image by its frequency of appearance in the associated segmentations. We obtain similar results with compilations that come directly from the graphs according to the nomenclature, but they can also be used archically, depending on the archical possibilities, however, as in 1.Beyond that, they can be used archically as well."}, {"heading": "2.4. Finding a well-suited hierarchy and cut level from a training set", "text": "A segmentation of the image is given by selecting a layer of a hierarchy that is applied to that image. Although it is difficult to know, for a particular set of images, which hierarchy and which layer of that hierarchy would provide good results in terms of the segmentation task (it is common for images to share similar properties, due to their nature or due to the tools that allow us to visualize them, such as cell images in microscopy or bone and tissue images in radiography), in order to facilitate the capture of a satisfactory segmentation, it is in our interest to find a hierarchy that takes these common properties into account in each image collection. In a tailor-made approach, we propose a methodology to automatically select a relevant hierarchy and a good section level for a particular group of homogeneous images, so that a suitable segmentation for a new image of the same kind can be achieved without effort."}, {"heading": "3.1. Type of Scores", "text": "The model proposed in the previous section is suitable for any score we want to minimize (or maximize) in order to obtain good segmentation. To test this model, we use two different scores. The first score is a Mumford-Shah score [11], so the problem we want to solve is an energy minimization problem. This score contains two terms, a data fidelity term and a regularization term: by climbing to higher levels in the hierarchy, the value of the first term decreases and the value of the second decreases. Both terms are linked by a scale parameter. It has this form: MS (\u03c0 = (I, H, \u03bb) = \u2211 Ri-\u03c0 var (Ri) + sC (humanity), (3) where var (Ri) represents the total variance of the image in the region Ri of the partition created maxi = (I, H) the length of the image in the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image of the image"}, {"heading": "3.2. Results", "text": "In an initial approach, we tested our strategy with a set of cell hierarchies for the Mumford Shah score, and with homogeneous subsets of images from the IIW database, of bedrooms, bathrooms and people. Some visual results can be found on Figs.4 and 5.For each set of images, we train our system on a subset to learn the best hierarchy under each hierarchy or combination of two hierarchies, which provides us with a model hierarchy. Then, for each image of the test subset, we calculate the optimal hierarchy for that precise image, which is the oracle hierarchy that is associated with it, as long as the score given by the model hierarchy on that test image is. A summary of the results for the WHDR score is in Table 1.In addition, we can have insights about why a given set of images was selected. For the cell images, the model hierarchy that was found by the algorithm is a composition of a hierarchy followed by a hierarchy."}], "references": [{"title": "Differential area profiles: decomposition properties and efficient computation", "author": ["G.K. Ouzounis", "M. Pesaresi", "P. Soille"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 34, no. 8, pp. 1533\u20131548, 2012.", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2012}, {"title": "Local mutual information for dissimilarity-based image segmentation", "author": ["L. Gueguen", "S. Velasco-Forero", "P. Soille"], "venue": "Journal of Mathematical Imaging and Vision, pp. 1\u201320, 2013.", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2013}, {"title": "Connected filtering on tree-based shape-spaces", "author": ["Y. Xu", "T. Geraud", "L. Najman"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. PP, no. 99, pp. 1\u20131, 2015.", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2015}, {"title": "Global-local optimizations by  (a) Some examples in the training set (b) I  (c) model (d) oracle (e) I  (f) model  (g) oracle (h) I  (i) model  (j) oracle Fig. 5. Results on some examples of Intrinsic Images in the Wild, for a WHDR score.(b),(e),(h) are images from the testing set, (c),(f),(i) the model segmentations and (d),(g),(j) the oracle segmentations. hierarchical cuts and climbing energies", "author": ["B.R. Kiran", "Jean Serra"], "venue": "Pattern Recognition, vol. 47, no. 1, pp. 12\u201324, 2014.", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2014}, {"title": "Playing with kruskal: algorithms for morphological trees in edge-weighted graphs", "author": ["L. Najman", "J. Cousty", "B. Perret"], "venue": "Mathematical Morphology and Its Applications to Signal and Image Processing, pp. 135\u2013146. Springer, 2013.", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2013}, {"title": "SLIC super pixels compared to state-of-the-art super pixel methods", "author": ["R. Achanta", "A. Shanji", "K. Smith", "A. Lucchi", "P. Fua", "S. S\u00fcsstrunk"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence, 2012.", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2012}, {"title": "Waterpixels", "author": ["V. Machairas", "M. Faessel", "D. C\u00e1rdenas-Pe\u00f1a", "T. Chabardes", "T. Walter", "E. Decenci\u00e8re"], "venue": "Image Processing, IEEE Transactions on, vol. 24, no. 11, pp. 3707\u20133716, 2015.", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2015}, {"title": "Morphological segmentation", "author": ["F. Meyer", "S. Beucher"], "venue": "Journal of visual communication and image representation, vol. 1, no. 1, pp. 21\u201346, 1990.", "citeRegEx": "8", "shortCiteRegEx": null, "year": 1990}, {"title": "Stochastic watershed segmentation", "author": ["J. Angulo", "D. Jeulin"], "venue": "Proceedings,(ISMM), Rio de Janeiro, vol. 1, pp. 265\u2013276, 2007.", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2007}, {"title": "Stochastic watershed hierarchies", "author": ["F. Meyer"], "venue": "Advances in Pattern Recognition (ICAPR), 2015 Eighth International Conference on, Jan 2015, pp. 1\u20138.", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2015}, {"title": "An algorithm for minimizing the mumford-shah functional", "author": ["T. Pock", "D. Cremers", "H. Bischof", "A. Chambolle"], "venue": "Computer Vision, 2009 IEEE 12th International Conference on. IEEE, 2009, pp. 1133\u20131140.", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2009}, {"title": "Intrinsic images in the wild", "author": ["S. Bell", "K. Bala", "N. Snavely"], "venue": "ACM Trans. on Graphics (SIGGRAPH), vol. 33, no. 4, 2014.", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2014}], "referenceMentions": [{"referenceID": 0, "context": "Recently, morphological hierarchical segmentations have been studied as a robust way to extract important features of the image [1], to produce robust segmentations of high-dimensional data [2], to detect important objects in a shape-space [3], to find optimal partitions from a given functional[4] as well as regarding computational issues to produce low complexity implementations [5].", "startOffset": 128, "endOffset": 131}, {"referenceID": 1, "context": "Recently, morphological hierarchical segmentations have been studied as a robust way to extract important features of the image [1], to produce robust segmentations of high-dimensional data [2], to detect important objects in a shape-space [3], to find optimal partitions from a given functional[4] as well as regarding computational issues to produce low complexity implementations [5].", "startOffset": 190, "endOffset": 193}, {"referenceID": 2, "context": "Recently, morphological hierarchical segmentations have been studied as a robust way to extract important features of the image [1], to produce robust segmentations of high-dimensional data [2], to detect important objects in a shape-space [3], to find optimal partitions from a given functional[4] as well as regarding computational issues to produce low complexity implementations [5].", "startOffset": 240, "endOffset": 243}, {"referenceID": 3, "context": "Recently, morphological hierarchical segmentations have been studied as a robust way to extract important features of the image [1], to produce robust segmentations of high-dimensional data [2], to detect important objects in a shape-space [3], to find optimal partitions from a given functional[4] as well as regarding computational issues to produce low complexity implementations [5].", "startOffset": 295, "endOffset": 298}, {"referenceID": 4, "context": "Recently, morphological hierarchical segmentations have been studied as a robust way to extract important features of the image [1], to produce robust segmentations of high-dimensional data [2], to detect important objects in a shape-space [3], to find optimal partitions from a given functional[4] as well as regarding computational issues to produce low complexity implementations [5].", "startOffset": 383, "endOffset": 386}, {"referenceID": 5, "context": "The lowest level is the pixel level: the initial image is segmented and a fine partition produced, for instance a set of superpixels [6], [7] or the basins produced by classical watershed algorithm [8].", "startOffset": 133, "endOffset": 136}, {"referenceID": 6, "context": "The lowest level is the pixel level: the initial image is segmented and a fine partition produced, for instance a set of superpixels [6], [7] or the basins produced by classical watershed algorithm [8].", "startOffset": 138, "endOffset": 141}, {"referenceID": 7, "context": "The lowest level is the pixel level: the initial image is segmented and a fine partition produced, for instance a set of superpixels [6], [7] or the basins produced by classical watershed algorithm [8].", "startOffset": 198, "endOffset": 201}, {"referenceID": 8, "context": "This idea finds its source in the stochastic watershed presented by Angulo in [9].", "startOffset": 78, "endOffset": 81}, {"referenceID": 9, "context": "Keen readers are invited to refer to [10] for more details.", "startOffset": 37, "endOffset": 41}, {"referenceID": 3, "context": "A markerbased segmentation can be applied to the result as well and other approaches have been proposed, such as interactive segmentation or energy minimization techniques [4].", "startOffset": 172, "endOffset": 175}, {"referenceID": 10, "context": "The first score used is a Mumford-Shah score [11], so that the problem we want to solve is an energy minimization problem.", "startOffset": 45, "endOffset": 49}, {"referenceID": 11, "context": "The second score that we used is a new metric called \u201cweighted human disagreement rate\u201d(WHDR), introduced in [12] to evaluate intrinsic decomposition results.", "startOffset": 109, "endOffset": 113}, {"referenceID": 11, "context": "associated with the large-scale public database, Intrinsic Images in the Wild (IIW), built in [12], and composed of 5230 manually annotated images of complex real indoor scenes.", "startOffset": 94, "endOffset": 98}], "year": 2016, "abstractText": "The segmentation, seen as the association of a partition with an image, is a difficult task. It can be decomposed in two steps: at first, a family of contours associated with a series of nested partitions (or hierarchy) is created and organized, then pertinent contours are extracted. A coarser partition is obtained by merging adjacent regions of a finer partition. The strength of a contour is then measured by the level of the hierarchy for which its two adjacent regions merge. We present an automatic segmentation strategy using a wide range of stochastic watershed hierarchies. For a given set of homogeneous images, our approach selects automatically the best hierarchy and cut level to perform image simplification given an evaluation score. Experimental results illustrate the advantages of our approach on several real-life images datasets.", "creator": "TeX"}}}