{"id": "1609.05152", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "16-Sep-2016", "title": "Style Imitation and Chord Invention in Polyphonic Music with Exponential Families", "abstract": "Modeling polyphonic music is a particularly challenging task because of the intricate interplay between melody and harmony. A good model should satisfy three requirements: statistical accuracy (capturing faithfully the statistics of correlations at various ranges, horizontally and vertically), flexibility (coping with arbitrary user constraints), and generalization capacity (inventing new material, while staying in the style of the training corpus). Models proposed so far fail on at least one of these requirements. We propose a statistical model of polyphonic music, based on the maximum entropy principle. This model is able to learn and reproduce pairwise statistics between neighboring note events in a given corpus. The model is also able to invent new chords and to harmonize unknown melodies. We evaluate the invention capacity of the model by assessing the amount of cited, re-discovered, and invented chords on a corpus of Bach chorales. We discuss how the model enables the user to specify and enforce user-defined constraints, which makes it useful for style-based, interactive music generation.", "histories": [["v1", "Fri, 16 Sep 2016 17:45:39 GMT  (901kb,D)", "http://arxiv.org/abs/1609.05152v1", "18 pages, 11 figures"]], "COMMENTS": "18 pages, 11 figures", "reviews": [], "SUBJECTS": "cs.AI cs.SD", "authors": ["ga\\\"etan hadjeres", "jason sakellariou", "fran\\c{c}ois pachet"], "accepted": false, "id": "1609.05152"}, "pdf": {"name": "1609.05152.pdf", "metadata": {"source": "CRF", "title": "Style Imitation and Chord Invention in Polyphonic Music with Exponential Families", "authors": ["Ga\u00ebtan Hadjeres", "Jason Sakellariou", "Fran\u00e7ois Pachet"], "emails": ["gaetan.hadjeres@etu-upmc.fr,", "js.sakel@gmail.com,", "pachetcsl@gmail.com"], "sections": [{"heading": "1 Introduction", "text": "This year, there will be a realignment in which there will be a realignment."}, {"heading": "2 The model", "text": "The model we propose is based on a maximum entropy model, as described in [25]. This model is expanded to handle multiple voices instead of one and to create vertical and diagonal interactions between notes. We formulate the model as an exponential family obtained by a product of experts (one for each voice)."}, {"heading": "2.1 Description of the model", "text": "We want to learn how the chord sequences differ from each other, as if they were all independent of time. (...) We want to learn how the chord sequences depend on each other. (...) We want to learn how the chord sequences are independent of each other. \"(...) We want to know how the chord sequences depend on each other. (...) We want to know that the chord progressions can be generated by replicating the processes in adjacent notes. (...) It is inevitable by translation in time, it aims to capture the local\" texture \"of the chord sequences. Similar ideas have proved successful in modelling highly combinatorial and arbitrary structures such as the English four-letter words. (...) We denote the scope of the model by K, which means that we regard the chord sequences as far apart, as independent."}, {"heading": "2.2 Training", "text": "Since we are dealing with discrete data, gradient techniques such as score matching [16] cannot be used. Instead, we choose to minimize the negative pseudo-log probability [24,9] of the data to find an approximation of the actual maximum probability. It consists in approximating the negative log likelihood functionL (44) = \u2212 logP (7) = \u2212 logP (7) based on the mean of the conditional log likelihoods of a note that the others, the isL (Prognos) = 1 nl, ij logP (sij s\\ sij), (8), where s\\ sij denotes all annotations in s except sij. The conditional probabilities are calculated."}, {"heading": "2.3 Generation", "text": "The generation is carried out using the Metropolis-Hastings algorithm, which is a widely used sampling algorithm (see [7] for an introduction). Its main feature is the ability to try out an unnormalized distribution, since it only has to calculate probability ratios: = P (s, \"\u03b8) P (s) (14) between two sequences s\" and s. With the concrete proposals described below, we simply have to start from a random sequence s as our current sequence and repeat the following: Choose a suggestion s, \"calculate \u03b1 and then accept as our current sequence s\" with the probability min (\u03b1, 1) or reject and retain this suggestion with the probability 1 \u2212 min (\u03b1, 1). After a sufficient number of iterations of this procedure, we are assured that the obtained sequences will be in accordance with the objective distribution P (1)."}, {"heading": "3 Experimental Results", "text": "We report on experiments performed with a set of 343 four-part (n = 4) choral harmonies by Johann Sebastian Bach [4]. In order to evaluate the ability to produce chords, we only kept notes we heard on beats in our chord sequences. Section 3.6 shows how our model can easily generate rhythm. We transposed each chorale in key C and looked at 2 corpora: a body with chorales in a major key and a body with chorales in a minor key. The square number of parameters (thanks to the exclusive use of binary combinations) makes the learning phase computerically tractable. We used the L-BFGS method from Stanford CoreNLP optimization package [19] to perform the gradient drop. In the next sections, we report on accuracy (the stylistic capacity of the model), its invention capacity, and flexibility."}, {"heading": "3.1 Style imitation", "text": "We investigated the system's ability to reproduce pairs of correlations of the training set. Fig.3.1 shows a scatter diagram comparing the (normalized) values of each binary connection fab, ijk in the generated sequences against those of the original training corpus.The model was actually trained on a corpus of 51 large chords, which is equivalent to a 3244-beat long chord sequence.We decided to distinguish horizontal connections from vertical and diagonal ones by introducing a parameter L as in Sekt. 2.1. We took K = 4, L = 2, \u03bb = 3e \u2212 5 as parameters and created a 100000-stroke long sequence.For a discussion on the choice of the regulation parameter, see sect. 3.5. We see that despite the small amount of data, the alignment between the generated pair events and the original sequences is correct."}, {"heading": "3.2 Chord Invention", "text": "We claim that the competition between the horizontal, vertical and diagonal correlations of our probability model can generate new chords in the learned \"style.\" Three categories of chords produced can be distinguished: the quoted chords that occur in the training set of the model, the discovered chords that do not occur in the training set but can be found in other Bach chorales, and the invented chords that do not belong to any of the above categories. We used the same model as above to represent in Fig. 4 the mean division of chords during the Metropolis Hastings generation as a function of the number of Metropolis steps (divided by | A | nl). These curves strongly depend on the parameters chosen for the model and on the size and structure of the corpus. Nevertheless, we can determine the characteristic time for the sample model from the equilibrium distribution."}, {"heading": "3.3 Higher order interactions", "text": "For a sequence of s, we define the four-sided tuple (see Fig.3) between the voices i and i \u2032 at position j as tuples (si (j), si (j + 1), si \u2032 (j), si \u2032 (j + 1)). These tuples are of particular interest because many harmonic rules, such as the prohibition of consecutive fifths and octaves, which are often considered contrapuntally forbidden, apply to them. Table 1 compares the percentage of quoted / discovered / invented four-sided tuples with the model of Sec. 3.1, using a model that contains only vertical fifths and consecutive octaves, and an independent model (which only reproduces pitch frequencies). It shows that an important part of these structures of higher order is reproduced by the model of Sec. 3.1, containing certain statistics that reflect only vertical interactions and an independent model (which only reproduces pitch frequencies)."}, {"heading": "3.4 Flexibility", "text": "In fact, the simplicity and adaptability of the model allows it to be \"twisted\" to impose uncommon constraints while simultaneously producing sequences in the learned style. As our model is in a fixed key (all the choruses were transposed in the same key), we can provide compelling Bach-like harmonizations of plaintiff melodies, provided they fit \"into the training key.\" Fig. 5 shows two repetitions of Beethoven's Ode to Joy with different irregular constraints. It is worth noting that even if we place constraints on isolated notes rather than full chords, the constraints can be heard both vertically (intonations are correct) and in terms of the music examples (flowmachines.jimdo.com / websiteand horizontally)."}, {"heading": "3.5 Impact of the regularization parameter", "text": "In this section, we will discuss the choice of regularization parameter \u03bb from Equation. 13. However, the advantages of introducing L1 regularization are complex: It makes the loss function (13) strictly convex (in our case, we do not need to determine whether the family (1) is a sufficient family), tends to reduce the number of non-zero parameter coordinates and prevent overadjustment, since our model has an important number of parameters relative to the number of samples, by adding a regularization term during the training phase in order to achieve good results in the sects we mentioned. 2.3 and 3.4.We therefore evaluate the effects of the choice of sequences on the quoted / discovered / invented sequencing curves (Fig. 3). We compare the mean division of chords in the case of unrestricted generation and in the case of reharmonization, where the first voice is restricted, with the two."}, {"heading": "3.6 Rhythm", "text": "In this work, we focus on reproduction and invention. It is an interesting question, since the model is in pairs and chords in our examples are four-handed. However, real music is not necessarily homorhythmic, i.e. the notes come in different periods that occur in relation to some periodic pulses. We propose a simple way to expand our models to calculate rhythmic patterns."}, {"heading": "4 Discussion and future work", "text": "We proposed a probabilistic model for chord sequences, which detects pairs of dependencies between adjacent notes. It is able to reproduce harmonic progressions without prior information and invent new \"stylistically correct\" chords, and the ability to rehearse with arbitrarily simple, user-defined constraints makes this model applicable in a variety of situations. We focused mainly on the ability to create and restore chords, which in our view is their most interesting feature, an analysis of monophonic plagiarism. Graphical models created in [25] showed that these probabilistic methods behave impressively well even when high-order hard constraints, such as parallel fifths of octaves, cannot be detected. This method is general and applies to all discrete n-tuple sequences."}, {"heading": "Acknowledgment", "text": "This research is carried out under the Flow Machines project funded by the European Research Council under the Seventh Framework Programme of the European Union (FP / 2007-2013) / ERC Grant Agreement n. 291156."}], "references": [{"title": "Harmonising chorales by probabilistic inference", "author": ["M. Allan", "C.K. Williams"], "venue": "Advances in neural information processing systems 17, 25\u201332", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2005}, {"title": "Pseudolikelihood estimation: some examples", "author": ["B.C. Arnold", "D. Strauss"], "venue": "Sankhy\u0101: The Indian Journal of Statistics, Series B pp. 233\u2013243", "citeRegEx": "2", "shortCiteRegEx": null, "year": 1991}, {"title": "Structured sparsity-inducing norms through submodular functions", "author": ["F.R. Bach"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2010}, {"title": "Chorales (Choral-Gesange): SATB (German Language Edition)", "author": ["J. Bach"], "venue": "Kalmus Classic Edition, Alfred Publishing Company", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 1985}, {"title": "Modeling temporal dependencies in high-dimensional sequences: Application to polyphonic music generation and transcription", "author": ["N. Boulanger-lewandowski", "Y. Bengio", "P. Vincent"], "venue": "Proceedings of the 29th International Conference on Machine Learning (ICML-12). pp. 1159\u20131166", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2012}, {"title": "An idiomindependent representation of chords for computational music analysis and generation", "author": ["E. Cambouropoulos", "M. Kaliakatsos-Papakostas", "C. Tsougras"], "venue": "Ann Arbor, MI: Michigan Publishing, University of Michigan Library", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2014}, {"title": "Understanding the metropolis-hastings algorithm", "author": ["S. Chib", "E. Greenberg"], "venue": "The American Statistician 49(4), 327\u2013335", "citeRegEx": "7", "shortCiteRegEx": null, "year": 1995}, {"title": "Empirical evaluation of gated recurrent neural networks on sequence modeling", "author": ["J. Chung", "C. Gulcehre", "K. Cho", "Y. Bengio"], "venue": "arXiv preprint arXiv:1412.3555", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2014}, {"title": "Improved contact prediction in proteins: using pseudolikelihoods to infer potts models", "author": ["M. Ekeberg", "C. L\u00f6vkvist", "Y. Lan", "M. Weigt", "E. Aurell"], "venue": "Physical Review E 87(1), 012707", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2013}, {"title": "Computational invention of cadences and chord progressions by conceptual chord-blending", "author": ["M. Eppe", "R. Confalonieri", "E. Maclean", "M. Kaliakatsos", "E. Cambouropoulos", "M. Schorlemmer", "M. Codescu", "K.U. K\u00fchnberger"], "venue": "International Joint Conference on Artificial Intelligence (IJCAI)", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2015}, {"title": "Ai methods in algorithmic composition: A comprehensive survey", "author": ["J.D. Fern\u00e1ndez", "F. Vico"], "venue": "Journal of Artificial Intelligence Research pp. 513\u2013582", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2013}, {"title": "The elements of statistical learning, vol", "author": ["J. Friedman", "T. Hastie", "R. Tibshirani"], "venue": "1. Springer series in statistics Springer, Berlin", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2001}, {"title": "A note on the group lasso and a sparse group lasso", "author": ["J. Friedman", "T. Hastie", "R. Tibshirani"], "venue": "arXiv preprint arXiv:1001.0736", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2010}, {"title": "Harmonet: A neural net for harmonizing chorales in the style of js bach", "author": ["H. Hild", "J. Feulner", "W. Menzel"], "venue": "Advances in neural information processing systems. pp. 267\u2013274", "citeRegEx": "14", "shortCiteRegEx": null, "year": 1992}, {"title": "Experimental music : composition with an electronic computer", "author": ["L. Hiller", "L. Issacson"], "venue": "McGraw-Hill", "citeRegEx": "15", "shortCiteRegEx": null, "year": 1959}, {"title": "Estimation of non-normalized statistical models by score matching", "author": ["A. Hyv\u00e4rinen"], "venue": "Journal of Machine Learning Research. pp. 695\u2013709", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2005}, {"title": "Probabilistic harmonization with fixed intermediate chord constraints", "author": ["M. Kaliakatsos-Papakostas", "E. Cambouropoulos"], "venue": null, "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2014}, {"title": "Modelling high-dimensional sequences with lstm-rtrbm: application to polyphonic music generation", "author": ["Q. Lyu", "Z. Wu", "J. Zhu", "H. Meng"], "venue": "Proceedings of the 24th International Conference on Artificial Intelligence. pp. 4138\u20134139. AAAI Press", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2015}, {"title": "The stanford corenlp natural language processing toolkit", "author": ["C.D. Manning", "M. Surdeanu", "J. Bauer", "J. Finkel", "S.J. Bethard", "D. McClosky"], "venue": "ACL 2014 p. 55", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2014}, {"title": "A joyful ode to automatic orchestration", "author": ["F. Pachet"], "venue": "ACM Transactions on Intelligent Systems and Technology, Special Issue on Intelligent Music Systems and Applications (2016),", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2016}, {"title": "Non-conformant harmonization: the real book in the style of take 6", "author": ["F. Pachet", "P. Roy"], "venue": "5th International Conference on Computational Creativity (ICCC 2014). pp. 100\u2013107. Ljubljiana (Slovenia)", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2014}, {"title": "Markov random fields and maximum entropy modeling for music information retrieval", "author": ["J. Pickens", "C.S. Iliopoulos"], "venue": "ISMIR. pp. 207\u2013214. Citeseer", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2005}, {"title": "Trait\u00e9 de l\u2019harmonie r\u00e9duite \u00e0 ses principes naturels", "author": ["J.P. Rameau"], "venue": "Imp. de J.-B.C. Ballard", "citeRegEx": "23", "shortCiteRegEx": null, "year": 1722}, {"title": "High-dimensional ising model selection using l1-regularized logistic regression", "author": ["P. Ravikumar", "M.J. Wainwright", "Lafferty", "J.D"], "venue": "The Annals of Statistics 38(3), 1287\u20131319", "citeRegEx": "24", "shortCiteRegEx": null, "year": 2010}, {"title": "Maximum entropy model for melodic patterns", "author": ["J. Sakellariou", "F. Tria", "V. Loreto", "F. Pachet"], "venue": "ICML Workshop on Constructive Machine Learning. Paris (France)", "citeRegEx": "25", "shortCiteRegEx": null, "year": 2015}, {"title": "Toward a statistical mechanics of four letter words", "author": ["G.J. Stephens", "W. Bialek"], "venue": "arXiv preprint arXiv:0801.0253", "citeRegEx": "26", "shortCiteRegEx": null, "year": 2007}], "referenceMentions": [{"referenceID": 22, "context": "by Jean Philippe Rameau [23] in the XVII century.", "startOffset": 24, "endOffset": 28}, {"referenceID": 10, "context": "Many models of polyphonic music have been proposed since the 50s (see [11] for a comprehensive survey), starting with the famous Illiac Suite, which used Markov chains to produce 4-voice music, controlled by hand-made rules [15].", "startOffset": 70, "endOffset": 74}, {"referenceID": 14, "context": "Many models of polyphonic music have been proposed since the 50s (see [11] for a comprehensive survey), starting with the famous Illiac Suite, which used Markov chains to produce 4-voice music, controlled by hand-made rules [15].", "startOffset": 224, "endOffset": 228}, {"referenceID": 9, "context": "[10] propose a chord invention framework but is not based on agnostic learning, and requires a hand-made ontology.", "startOffset": 0, "endOffset": 4}, {"referenceID": 20, "context": "The approach described in [21] consists in a dynamic programming template enriched by constrained Markov chains.", "startOffset": 26, "endOffset": 30}, {"referenceID": 19, "context": "This approach generates musically convincing results [20] but is ad hoc and specialized for jazz.", "startOffset": 53, "endOffset": 57}, {"referenceID": 13, "context": "[14] and [1] describe a HMM approach trained on an annotated corpus.", "startOffset": 0, "endOffset": 4}, {"referenceID": 0, "context": "[14] and [1] describe a HMM approach trained on an annotated corpus.", "startOffset": 9, "endOffset": 12}, {"referenceID": 16, "context": "Another related approach is [17] which uses HMMs on chord representations (based on an expert knowledge of the common-practice harmony) called General Chord Type (GCT) [6] to generate homorhythmic sequences.", "startOffset": 28, "endOffset": 32}, {"referenceID": 5, "context": "Another related approach is [17] which uses HMMs on chord representations (based on an expert knowledge of the common-practice harmony) called General Chord Type (GCT) [6] to generate homorhythmic sequences.", "startOffset": 168, "endOffset": 171}, {"referenceID": 4, "context": "In [5], chords are modeled with Restricted Boltzmann Machines (RBMs).", "startOffset": 3, "endOffset": 6}, {"referenceID": 17, "context": "Variations of these architectures have been developed, based on Long Short-Term Memory (LSTM) units [18] or GRU (Gated Recurrent Units) [8].", "startOffset": 100, "endOffset": 104}, {"referenceID": 7, "context": "Variations of these architectures have been developed, based on Long Short-Term Memory (LSTM) units [18] or GRU (Gated Recurrent Units) [8].", "startOffset": 136, "endOffset": 139}, {"referenceID": 21, "context": "Such models have been used for music retrieval applications [22], but never, to our knowledge, for polyphonic music generation.", "startOffset": 60, "endOffset": 64}, {"referenceID": 24, "context": "The model we propose is based on a maximum entropy model described in [25].", "startOffset": 70, "endOffset": 74}, {"referenceID": 25, "context": "Similar ideas have been shown to be successful in modeling highly combinatorial and arbitrary structures such as English four-letter words [26].", "startOffset": 139, "endOffset": 143}, {"referenceID": 15, "context": "Since we are dealing with discrete data, gradient techniques such as score matching [16] cannot be used.", "startOffset": 84, "endOffset": 88}, {"referenceID": 23, "context": "Instead, we choose to minimize the negative pseudo-log-likelihood [24,9] of the data to find an approximation of the true maximum likelihood estimator.", "startOffset": 66, "endOffset": 72}, {"referenceID": 8, "context": "Instead, we choose to minimize the negative pseudo-log-likelihood [24,9] of the data to find an approximation of the true maximum likelihood estimator.", "startOffset": 66, "endOffset": 72}, {"referenceID": 1, "context": "9 and can lead to good estimates [2].", "startOffset": 33, "endOffset": 36}, {"referenceID": 24, "context": "This can be seen as the likelihood of a product of experts using n modified (addition of vertical and diagonal connections) copies of the model presented in [25].", "startOffset": 157, "endOffset": 161}, {"referenceID": 11, "context": "This is known as the Lasso regularization whose effects are widely discussed throughout statistical learning literature [12].", "startOffset": 120, "endOffset": 124}, {"referenceID": 6, "context": "Generation is performed with the Metropolis-Hastings algorithm, which is an extensively used sampling algorithm (see [7] for an introduction).", "startOffset": 117, "endOffset": 120}, {"referenceID": 3, "context": "We report experiments made using a set of 343 four-voice (n = 4) chorale harmonizations by Johann Sebastian Bach [4].", "startOffset": 113, "endOffset": 116}, {"referenceID": 18, "context": "We used the L-BFGS method from Stanford CoreNLP optimization package [19] to perform the gradient descent.", "startOffset": 69, "endOffset": 73}, {"referenceID": 0, "context": "[0] [1] [2] [3]", "startOffset": 4, "endOffset": 7}, {"referenceID": 1, "context": "[0] [1] [2] [3]", "startOffset": 8, "endOffset": 11}, {"referenceID": 2, "context": "[0] [1] [2] [3]", "startOffset": 12, "endOffset": 15}, {"referenceID": 24, "context": "The model initially presented in [25] and extended in 2 is translation invariant.", "startOffset": 33, "endOffset": 37}, {"referenceID": 24, "context": "graphical models being made in [25].", "startOffset": 31, "endOffset": 35}, {"referenceID": 12, "context": "The utmost importance of the regularization parameter suggests to investigate finer and more problem-dependent regularizations such as group lasso [13] or other hierarchical sparsity-inducing norms [3].", "startOffset": 147, "endOffset": 151}, {"referenceID": 2, "context": "The utmost importance of the regularization parameter suggests to investigate finer and more problem-dependent regularizations such as group lasso [13] or other hierarchical sparsity-inducing norms [3].", "startOffset": 198, "endOffset": 201}], "year": 2016, "abstractText": "Modeling polyphonic music is a particularly challenging task because of the intricate interplay between melody and harmony. A good model should satisfy three requirements: statistical accuracy (capturing faithfully the statistics of correlations at various ranges, horizontally and vertically), flexibility (coping with arbitrary user constraints), and generalization capacity (inventing new material, while staying in the style of the training corpus). Models proposed so far fail on at least one of these requirements. We propose a statistical model of polyphonic music, based on the maximum entropy principle. This model is able to learn and reproduce pairwise statistics between neighboring note events in a given corpus. The model is also able to invent new chords and to harmonize unknown melodies. We evaluate the invention capacity of the model by assessing the amount of cited, re-discovered, and invented chords on a corpus of Bach chorales. We discuss how the model enables the user to specify and enforce user-defined constraints, which makes it useful for style-based, interactive music generation.", "creator": "LaTeX with hyperref package"}}}