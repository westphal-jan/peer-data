{"id": "1610.00378", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "3-Oct-2016", "title": "Improving Accuracy and Scalability of the PC Algorithm by Maximizing P-value", "abstract": "A number of attempts have been made to improve accuracy and/or scalability of the PC (Peter and Clark) algorithm, some well known (Buhlmann, et al., 2010; Kalisch and Buhlmann, 2007; 2008; Zhang, 2012, to give some examples). We add here one more tool to the toolbox: the simple observation that if one is forced to choose between a variety of possible conditioning sets for a pair of variables, one should choose the one with the highest p-value. One can use the CPC (Conservative PC, Ramsey et al., 2012) algorithm as a guide to possible sepsets for a pair of variables. However, whereas CPC uses a voting rule to classify colliders versus noncolliders, our proposed algorithm, PC-Max, picks the conditioning set with the highest p-value, so that there are no ambiguities. We combine this with two other optimizations: (a) avoiding bidirected edges in the orientation of colliders, and (b) parallelization. For (b) we borrow ideas from the PC-Stable algorithm (Colombo and Maathuis, 2014). The result is an algorithm that scales quite well both in terms of accuracy and time, with no risk of bidirected edges.", "histories": [["v1", "Mon, 3 Oct 2016 00:47:51 GMT  (240kb)", "http://arxiv.org/abs/1610.00378v1", "11 pages, 4 figures, 2 tables, technical report"], ["v2", "Wed, 5 Oct 2016 17:24:45 GMT  (242kb)", "http://arxiv.org/abs/1610.00378v2", "11 pages, 4 figures, 2 tables, technical report"]], "COMMENTS": "11 pages, 4 figures, 2 tables, technical report", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["joseph ramsey"], "accepted": false, "id": "1610.00378"}, "pdf": {"name": "1610.00378.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": [], "sections": [{"heading": "Improving Accuracy and Scalability of the PC Algorithm by Maximizing P-value1", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "Joseph Ramsey Technical Report Center for Causal Discovery", "text": "October 2, 2016"}, {"heading": "Abstract", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A number of attempts have been made to improve accuracy and/or scalability of the PC (Peter and Clark) algorithm, some well known (Buhlmann, et al., 2010; Kalisch and Buhlmann, 2007;", "text": "2008; Zhang, 2012, to give a few examples). Here we add another tool to the toolbox: the simple observation that if you are forced to choose between a variety of possible conditioning sets for a pair of variables, you should choose the algorithm with the highest p-value. You can use the CPC algorithm (Conservative PC, Ramsey et al., 2012) as a guide to possible sepsets for a pair of variables. However, while CPC applies a tuning rule to classify colliders against non-colliders, our proposed algorithm, PC-Max, chooses the conditioning set with the highest pvalue, so there are no ambiguities. We combine this with two other optimizations: (a) avoidance of bidirect edges in the orientation of colliders and (b) parallelization. Because (b) we borrow ideas from the PC Stable algorithm (Colombo and Maathuis, 2014) The result is both a well-directed and a well-timed algorithm."}, {"heading": "1. Maximum P-value.", "text": "Consider the following problem (0, 1). This distribution represents how values are distributed under H0. All of these values depend on some variables S, but you do not know which ones. You have a candidate list; it could be any one of S1, S2,..., Sm. You do an independence test for X and Y depending on each of these subsets and get p-values p1, p2,..., pm. Based on this information alone, which you would select if you want to make sure that X and Y are most likely not dependent on S? The answer that suggests is that you should pick the one with the highest p-value; this is the one that is least likely to depend, in a reasonable sense. First of all, under the null hypothesis H0 of independence, having partially transformed correlations to Z-values that we always use for linear, Gaussian models, Z ~ N."}, {"heading": "2. PC.", "text": "Pseudo code for the PC algorithm is given in Figure 2. I (X, Y | Z1,..., Zn) returns true if X _ | _ Y | Z1,..., Zn is judged to be true, otherwise false. V is the set of variables to be searched for over. It is assumed that all common causes of variables in V are also in V (causal sufficiency) and that the graph is directed to the true causal model and acyclic (a DAG). Figure 2. Pseudo code for the PC algorithm. See text.Procedure PC (I, V) 1. G < - complete graph about V < - 0 3. S: edges- > sets of variables. 4. Repeat until no further changes are made madea."}, {"heading": "3. Conservative PC.", "text": "In fact, it is the case that you are able to live in a country where people are able to move and where people are able to move, to move, to move, to move, to move and to move."}, {"heading": "4. Replacing Conservative Orientation with Max P-value Orientation", "text": "That is, when orienting on an unprotected triangle X - Y - Z, one can list the various subsets S1,.., Sn of adj (X) or adj (Z) and calculate the partial correlation for each individual judgement. The goal is to select such a subset that produces independence, and as in Section 1, we should select the subset with the highest pvalue. We make this change by conditioning to one of the subsets p1,..., Sn yields independence. This is justified because the adjacency search has removed the edge X. X and Z must be independent, and a theorem in Spirtes et al. (2000)"}, {"heading": "5. Avoiding Bidirected Edges.", "text": "One problem with the PC algorithm and the CPC algorithm modified as in Section 5 is to some extent that it is possible to orient bidirectional edges that cannot exist in the correct output of the algorithm (a pattern or CP-DAG); the mechanism for this is completely obvious and inevitable, unless a correction is made. Let's say you have two unshielded triples connected to each other, X - Y - Z - W. If you randomly orient both X - Y - Z and Y - Z - W as colliders, due to small sample errors or false positive adapgences in the graph, or because latent common causes exist in your dataset, then you will end up with X- > Y < - > Z < -W, and you will have a bidirectional edge Y < - > Z-W, and you will have a bidirectional edge Y-W, and you will avoid a bidirectional edge < - Z, both of which can orient at the same time."}, {"heading": "6. The PC-Max Algorithm.", "text": "In fact, it is the case that most of them are able to abide by the rules that they have given themselves. (...) In fact, it is the case that they are able to understand the rules of the market. (...) It is not that they are able to abide by the rules of the market. (...) It is not that they are able to abide by the rules of the market. (...) It is as if they are able to abide by the rules of the market. (...) It is as if they are able to abide by the rules of the market. (...) It is as if they are able to abide by the rules of the market. \"(...)"}, {"heading": "7. Simulations.", "text": "We must abide by the rules we have imposed on ourselves. (...) We must abide by the rules we have imposed on ourselves. (...) We must abide by the rules. (...) We must abide by the rules. (...) We must abide by the rules. (...) We must abide by the rules. (...) We must abide by the rules. (...) We must abide by the rules. (...) We must abide by the rules. (...) We must abide by the rules. (...) We must abide by the rules. (...) We must abide by the rules. \"(...) We must abide by the rules. (...) We must abide by the rules.\" (...) We must abide by the rules. \""}, {"heading": "Algorithm Avg Deg AP AR AHP AHR BID E", "text": "What is not shown in the table for lack of space is that CPC makes a fair number of unshielded triples ambiguous in the chart; for degree 2, it makes 4% of all unshielded triples ambiguous; for degree 4, it makes 7% of all unshielded triples ambiguous; none of the other algorithms marks ambiguities; in this sense, algorithms such as PC-Max or FGS, which do not display ambiguities but otherwise have similar profiles, are to be preferred; the two best overall algorithms are PC-Max and FGS, the first a limitation-based search, the second a scoring search; it is noteworthy that they are tied in terms of precision, with PC-Max slightly lagging behind on retrieval; in timing, PC-Max is faster, but this may simply be because it does not find so many orientations; to increase the number of variables, we limit ourselves to algorithms that run fast in Table 1, and the PC-Max value is set to 0.4 GS-FPC, with a penalty of S-001 and 0.4-PC type."}, {"heading": "Alg Ave Degree AP AR AHP AHR E", "text": "In Table 2, the precision for both algorithms is excellent. Callbacks are pretty good across the board, with recalls for FGS higher than those for PC-Max. PC-Max is noticeably slower on the same data than FGS. FGS has been scaled to 1,000,000 nodes in previous work on Grade 2 average graphics (Ramsey, 2015); Tables 1 and 2 suggest that PC-Max might also be scaled to this extent, with good accuracy, although this would require considerable patience and perhaps a machine with more processors than the FGS example. We could still try, in the spirit of Mount Everest's best. The implementations used for the above procedures were those of the tetrad freeware, https: / / github.com / cmu-phil / tetrad, Branch \"development,\" commit 655fddc."}, {"heading": "8. Conclusion.", "text": "We merely pointed out that when selecting conditioning sets, one of which must be independent, it makes sense to select the conditioning set that provides the highest p value under independence. We applied this reasoning to the collider orientation step in two respects, firstly in the identification of colliders and secondly in selecting which colliders orient themselves in the graph to avoid bidirectional edges.The result is a limitation-based algorithm that works almost as well as the score-based algorithm FGS. Previous limitations on the number of variables that can be handled accurately by a PC-like algorithm for small samples are easily surpassed in the simulation. It has not escaped us that the maximum p-value reasoning can be applied to other algorithms. Two other algorithms to which we have applied with good success are FCI (Spirtes al, 2000 and 1999 Carjtes for these cases) and the frequency of the CD and the cardons for the configuration."}], "references": [{"title": "Variable selection in high-dimensional linear models: partially faithful distributions and the PC-simple algorithm.", "author": ["P. B\u00fchlmann", "M. Kalisch", "M. Maathuis"], "venue": null, "citeRegEx": "B\u00fchlmann et al\\.,? \\Q2010\\E", "shortCiteRegEx": "B\u00fchlmann et al\\.", "year": 2010}, {"title": "Optimal structure identification with greedy search.", "author": ["D. Chickering"], "venue": "Journal of machine learning research", "citeRegEx": "Chickering,? \\Q2002\\E", "shortCiteRegEx": "Chickering", "year": 2002}, {"title": "Order-independent constraint-based causal structure learning.", "author": ["D. Colombo", "M Maathuis"], "venue": "Journal of Machine Learning Research", "citeRegEx": "Colombo and Maathuis,? \\Q2014\\E", "shortCiteRegEx": "Colombo and Maathuis", "year": 2014}, {"title": "Order-independent constraint-based causal structure learning.", "author": ["C. Diego", "M. Maathuis"], "venue": "Journal of Machine Learning Research", "citeRegEx": "Diego and Maathuis,? \\Q2014\\E", "shortCiteRegEx": "Diego and Maathuis", "year": 2014}, {"title": "The Behavior of the P-Value When the Alternative Hypothesis", "author": ["Hung J", "R. O\u2019Neill", "P. Bauer"], "venue": "Kohne", "citeRegEx": "J. et al\\.,? \\Q1997\\E", "shortCiteRegEx": "J. et al\\.", "year": 1997}, {"title": "Estimating high-dimensional directed acyclic graphs with the PC-algorithm.", "author": ["M. Kalisch", "B\u00fchlmann"], "venue": "Journal of Machine Learning", "citeRegEx": "Kalisch et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Kalisch et al\\.", "year": 2007}, {"title": "Robustification of the PC-algorithm for Directed Acyclic Graphs.", "author": ["M Kalisch", "P. B\u00fchlmann"], "venue": "Journal of Computational and Graphical Statistics", "citeRegEx": "Kalisch and B\u00fchlmann,? \\Q2008\\E", "shortCiteRegEx": "Kalisch and B\u00fchlmann", "year": 2008}, {"title": "Predicting causal effects in large-scale systems from observational data.\" Nature Methods", "author": ["Maathuis", "Marloes H"], "venue": null, "citeRegEx": "Maathuis and H,? \\Q2010\\E", "shortCiteRegEx": "Maathuis and H", "year": 2010}, {"title": "Causal inference and causal explanation with background knowledge.\" Proceedings of the Eleventh conference on Uncertainty in artificial intelligence", "author": ["C. Meek"], "venue": null, "citeRegEx": "Meek,? \\Q1995\\E", "shortCiteRegEx": "Meek", "year": 1995}, {"title": "Graphical Models: Selecting causal and statistical models", "author": ["C. Meek"], "venue": "PhD thesis,", "citeRegEx": "Meek,? \\Q1997\\E", "shortCiteRegEx": "Meek", "year": 1997}, {"title": "Scaling up greedy equivalence search for continuous variables", "author": ["J. Ramsey"], "venue": "CoRR, abs/1507.07749,", "citeRegEx": "Ramsey,? \\Q2015\\E", "shortCiteRegEx": "Ramsey", "year": 2015}, {"title": "Adjacency-faithfulness and conservative causal inference.\" arXiv preprint arXiv:1206.6843", "author": ["J. Ramsey", "J. Zhang", "P. Spirtes"], "venue": null, "citeRegEx": "Ramsey et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Ramsey et al\\.", "year": 2012}, {"title": "Automated discovery of linear feedback models", "author": ["T. Richardson", "P. Spirtes"], "venue": null, "citeRegEx": "Richardson and Spirtes,? \\Q1999\\E", "shortCiteRegEx": "Richardson and Spirtes", "year": 1999}, {"title": "Causation, Prediction, and Search", "author": ["P. Spirtes", "C. Glymour", "R. Scheines"], "venue": null, "citeRegEx": "Spirtes et al\\.,? \\Q2000\\E", "shortCiteRegEx": "Spirtes et al\\.", "year": 2000}, {"title": "Causal stability ranking.\" Bioinformatics", "author": ["D Stekhoven"], "venue": null, "citeRegEx": "Stekhoven,? \\Q2012\\E", "shortCiteRegEx": "Stekhoven", "year": 2012}, {"title": "Kernel-based conditional independence test and application in causal discovery.\" arXiv preprint arXiv:1202.3775", "author": ["Zhang", "Kun"], "venue": null, "citeRegEx": "Zhang and Kun,? \\Q2012\\E", "shortCiteRegEx": "Zhang and Kun", "year": 2012}], "referenceMentions": [{"referenceID": 2, "context": "For (b) we borrow ideas from the PC-Stable algorithm (Colombo and Maathuis, 2014).", "startOffset": 53, "endOffset": 81}, {"referenceID": 1, "context": "Chickering (2002) points out that one may estimate conditional independence in the linear, Gaussian case as a difference of two BIC scores.", "startOffset": 0, "endOffset": 18}, {"referenceID": 11, "context": ", 1993), the Conservative PC algorithm (Ramsey et al., 2012) and the PC-Stable algorithm (Colombo and Maathuis, 2014), together with the maximum p-value notion, and we will parallelize the algorithm to speed it up where possible.", "startOffset": 39, "endOffset": 60}, {"referenceID": 2, "context": ", 2012) and the PC-Stable algorithm (Colombo and Maathuis, 2014), together with the maximum p-value notion, and we will parallelize the algorithm to speed it up where possible.", "startOffset": 36, "endOffset": 64}, {"referenceID": 8, "context": "Use the rules in Meek (1995) to orient any further edges in G that can be oriented without create new unshielded colliders 7.", "startOffset": 17, "endOffset": 29}, {"referenceID": 8, "context": "The rules that are used to accomplish this are given in (Meek, 1995).", "startOffset": 56, "endOffset": 68}, {"referenceID": 8, "context": "Use the rules in Meek (1995) to orient any further edges that can be oriented in G without create new unshielded colliders, respecting the underlinings in the graph.", "startOffset": 17, "endOffset": 29}, {"referenceID": 11, "context": "This finesses in a sense the problem of orientation unfaithfulness addressed by CPC (Ramsey et al., 2012); it sets that problem aside and provides and answer in the orientation phase to every conditional independence question posed.", "startOffset": 84, "endOffset": 105}, {"referenceID": 11, "context": "So X and Z must be independent conditional on some set, and a theorem in Spirtes et al. (2000) states that if they are independent conditional on some set, then they must be independent conditional on some subset of adj(X) or adj(Y).", "startOffset": 73, "endOffset": 95}, {"referenceID": 8, "context": "Use the rules in Meek (1995) to orient any further edges that can be oriented in G without create new unshielded colliders.", "startOffset": 17, "endOffset": 29}, {"referenceID": 2, "context": "A sensible method of parallelizing (3b) has been proposed; we will just use it; this is the method proposed for the PC-Stable algorithm (Colombo and Maathuis, 2014).", "startOffset": 136, "endOffset": 164}, {"referenceID": 2, "context": "This was the main motivating idea behind the PC-Stable method (Colombo and Maathuis, 2014).", "startOffset": 62, "endOffset": 90}, {"referenceID": 10, "context": "We include FGS (Ramsey, 2015), a recent implementation of GES (Chickering, 2002; Meek, 1997), a score-based algorithm, using differences of linear, Gaussian BIC scores for independence checks, as explained in section 1, since it has shown superior performance on the same problem.", "startOffset": 15, "endOffset": 29}, {"referenceID": 1, "context": "We include FGS (Ramsey, 2015), a recent implementation of GES (Chickering, 2002; Meek, 1997), a score-based algorithm, using differences of linear, Gaussian BIC scores for independence checks, as explained in section 1, since it has shown superior performance on the same problem.", "startOffset": 62, "endOffset": 92}, {"referenceID": 9, "context": "We include FGS (Ramsey, 2015), a recent implementation of GES (Chickering, 2002; Meek, 1997), a score-based algorithm, using differences of linear, Gaussian BIC scores for independence checks, as explained in section 1, since it has shown superior performance on the same problem.", "startOffset": 62, "endOffset": 92}, {"referenceID": 10, "context": "FGS has been scaled for average degree 2 graphs to 1,000,000 nodes in previous work (Ramsey, 2015); Tables 1 and 2 suggest that PC-Max could be scaled possibly that far as well, with good accuracy, though it would take considerable patience to do so and perhaps a machine with more processors than were used for the FGS example.", "startOffset": 84, "endOffset": 98}, {"referenceID": 13, "context": "Two other algorithms that we have applied it to, with good success, are FCI (Spirtes et al., 2000) and CCD (Richardson and Spirtes, 1999).", "startOffset": 76, "endOffset": 98}, {"referenceID": 12, "context": ", 2000) and CCD (Richardson and Spirtes, 1999).", "startOffset": 16, "endOffset": 46}], "year": 2016, "abstractText": "A number of attempts have been made to improve accuracy and/or scalability of the PC (Peter and Clark) algorithm, some well known (Buhlmann, et al., 2010; Kalisch and Buhlmann, 2007; 2008; Zhang, 2012, to give some examples). We add here one more tool to the toolbox: the simple observation that if one is forced to choose between a variety of possible conditioning sets for a pair of variables, one should choose the one with the highest p-value. One can use the CPC (Conservative PC, Ramsey et al., 2012) algorithm as a guide to possible sepsets for a pair of variables. However, whereas CPC uses a voting rule to classify colliders versus noncolliders, our proposed algorithm, PC-Max, picks the conditioning set with the highest pvalue, so that there are no ambiguities. We combine this with two other optimizations: (a) avoiding bidirected edges in the orientation of colliders, and (b) parallelization. For (b) we borrow ideas from the PC-Stable algorithm (Colombo and Maathuis, 2014). The result is an algorithm that scales quite well both in terms of accuracy and time, with no risk of bidirected edges.", "creator": "Word"}}}