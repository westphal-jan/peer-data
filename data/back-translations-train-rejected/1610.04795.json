{"id": "1610.04795", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "15-Oct-2016", "title": "Sample Efficient Optimization for Learning Controllers for Bipedal Locomotion", "abstract": "Learning policies for bipedal locomotion can be difficult, as experiments are expensive and simulation does not usually transfer well to hardware. To counter this, we need al- gorithms that are sample efficient and inherently safe. Bayesian Optimization is a powerful sample-efficient tool for optimizing non-convex black-box functions. However, its performance can degrade in higher dimensions. We develop a distance metric for bipedal locomotion that enhances the sample-efficiency of Bayesian Optimization and use it to train a 16 dimensional neuromuscular model for planar walking. This distance metric reflects some basic gait features of healthy walking and helps us quickly eliminate a majority of unstable controllers. With our approach we can learn policies for walking in less than 100 trials for a range of challenging settings. In simulation, we show results on two different costs and on various terrains including rough ground and ramps, sloping upwards and downwards. We also perturb our models with unknown inertial disturbances analogous with differences between simulation and hardware. These results are promising, as they indicate that this method can potentially be used to learn control policies on hardware.", "histories": [["v1", "Sat, 15 Oct 2016 22:53:04 GMT  (3097kb,D)", "http://arxiv.org/abs/1610.04795v1", "To appear in International Conference on Humanoid Robots (Humanoids '2016), IEEE-RAS. (Rika Antonova and Akshara Rai contributed equally)"]], "COMMENTS": "To appear in International Conference on Humanoid Robots (Humanoids '2016), IEEE-RAS. (Rika Antonova and Akshara Rai contributed equally)", "reviews": [], "SUBJECTS": "cs.RO cs.LG", "authors": ["rika antonova", "akshara rai", "christopher g atkeson"], "accepted": false, "id": "1610.04795"}, "pdf": {"name": "1610.04795.pdf", "metadata": {"source": "CRF", "title": "Sample Efficient Optimization for Learning Controllers for Bipedal Locomotion", "authors": ["Rika Antonova", "Akshara Rai", "Christopher G. Atkeson"], "emails": ["arai}@andrew.cmu.edu,", "cga@cs.cmu.edu"], "sections": [{"heading": null, "text": "This year, the time has come for us to move to another world, in which we are searching for a new world."}, {"heading": "II. BACKGROUND", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A. Overview of Bayesian Optimization", "text": "The Bavarian Optimization is a framework for the sequential global search for a vector x * that minimizes a Costar Xiv: 161 0.04 795v 1 [cs.R O] 15 October 201 6function f (x), while f is evaluated as little as possible ([3] gives an overview).x * = arg min x f (x) The optimization begins with the initialization of a previous parameter vector to capture the uncertainty about the value of f (x) for each x in the domain. In the iteration, an auxiliary function u, called the capture function, is used to sequentially select the next parameter vector to be tested xt. f (xt), is then evaluated by conducting an experiment and used to update our estimate of f. The goal of the capture function is to achieve an effective compromise between exploration and exploitation. The use of a capture function is determined in Figure 1 (1point), and the precursor method is available for each of the GMP, a precursor and a precursor method is illustrated by the GMP."}, {"heading": "B. Optimization for Bipedal Locomotion", "text": "Krause et al. [12] developed an approach that used Gaussian processes and the principle of optimizing mutual information to solve sensor placement problems. Martinez-Cantin et al. [14] used BO for online route planning for optimal scanning with a mobile robot. Lizotte et al. [13] used a closely related approach to Gaussian process regression to optimize the view of a four-legged robot and showed that this approach requires significantly fewer evaluations than modern local gradient approaches. Specifically for the area of bipedal locomotion, Calandra et al. BO used to efficiently find gait parameters that optimize a desired value [4]. They optimized eight parameters - four thresholds of a finite state machine and four control signals applied to the knees during expansion and flexibility."}, {"heading": "III. REVIEW OF NEUROMUSCULAR MODELS", "text": "1) Neuromuscular motion control: In posture, each leg is retarded or decelerated by 7 hill-type muscles. (15), consisting of the soleus (SOL), gastrocnemius (GAS), vastus (VAS), knee joint (TA), hip flexor (HFL) and gluteus (GLU) shown in Figure 3: These muscles produce torques over the hip, knee and ankle. Muscle force F is a non-linear function of the muscle state sm and stimulus Sm, which, when multiplied by torque arm r (KLU), results in torque on the joint. (S m), where torque is applied on the joint. (S), where torque is applied on the joint i and the joint."}, {"heading": "IV. DETERMINANTS OF GAIT KERNEL", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A. Kernels for Sequential Decision Making", "text": "As described in Section II-A, the kernel k (xi, xj) detects how similar the cost function f should be to the parameter vectors xi and xj, and in the case of the use of the square exponential nucleus, the similarity is a function of the Euclidean distance between xi, xj and R. A more sound alternative is to use a kernel that specifically uses the structure of the problem at hand, for example the resulting trajectories or behavior. Intuitively, a kernel that can better encode similarities between policies is more sample efficient, as it will be able to generalize policies with similar performance. The behavior-based kernel (BBK) of [21] is a kernel that uses structure in the trajectories generated by the evaluated policies. To determine the similarity between policies given by vectors xi, xj, BBK uses the similarity of the cost distributors induced by the respective policies."}, {"heading": "B. Determinants of Gait Kernel", "text": "The six determinants of gait are energy conservation and maintaining dynamics in human walking. To develop our core, therefore, we focus on knee reflection in swing, ankle movement and the center of mass orbit. Next, we calculate the score of parameters using the following metrics: M1 \u2212 5: 1 Is the knee bent in swing? M1 = (\u03b8) does it swing high > does the knee swing into the knee. (1) Here, the swing angle of the knee joint is in oscillation high and low. (2) Is there heel strike and toes outside the ankle? < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < < <"}, {"heading": "V. EXPERIMENTS", "text": "In this section, we describe our experiments with the DoG kernel for two cost functions: First, we present our experimental settings, and then we arrive at the results."}, {"heading": "A. Details of Experimental Setup: Cost Function and Algorithms Compared", "text": "To ensure that our approach extends well beyond the various cost functions, we conduct experiments at two different costs, designed to ensure that the parameter sets also achieve stable and robust gaits. The first cost function varies smoothly across the parameter space: Cost = 11 + 0.31 + d + 0.01 (s \u2212 stgt), (8) where the second cost item is reached is the average speed and Stands the desired walking speed (from human data). These costs encourage further and longer runtimes and punish the deviation from the target speed with the last cost unit. The second cost function is a slightly modified version of the cost used in the experiments with CMA-ES."}, {"heading": "B. Model Disturbances", "text": "Most real robots have poor dynamic models as well as unmodelled disturbances, such as friction, non-rigid dynamics, etc., which make simulations a poor representation of the real robot. Much work has been done to reliably identify dynamic models of robots, for example in [1]. However, while such methods can definitely help bring simulators closer to the real robot, there are other discrepancies, such as non-rigid dynamics and friction, which are still very difficult to model. As a result, controllers who work well in the simulation often lead to poor performance of the real robot. In such cases, ideally, we would like to have optimization techniques that quickly adapt to this slightly different environment and find a new solution in some cost function assessments. To test whether our approach is capable of generalizing, modelling and causing environmental disturbances, we conduct our experiments on models with masses and inertia profiles and on different ground treads."}, {"heading": "C. Experiments with DoG Kernel", "text": "This year, it has reached the stage where it will be able to take the lead, in the same way as it has done in recent years."}, {"heading": "VI. CONCLUSIONS", "text": "This high-dimensional optimization problem proved to be a challenge to standard Bayesian optimization, so we introduced the gait determinants (DoG) metrics and constructed the corresponding DoG kernel to effectively integrate domain knowledge into the kernel. For our experiments, we calculated the kernel on flat ground with an undisturbed model and then tested it in more challenging environments. We demonstrated that our approach provides improved performance in learning walking patterns on different ground profiles such as rough ground, up and down, all with various unknown inertia disorders of the original model. Our results motivated us to consider several directions for future work. One of the next steps would be to experiment with learning more parameters of the neuromuscular model. Adjusting other parameters would allow us to adjust walking behavior to more demanding settings such as stairs and steeper ramps."}], "references": [{"title": "Model-based Control of a Robot Manipulator", "author": ["An", "Chae H", "Atkeson", "Christopher G", "Hollerbach", "John M"], "venue": null, "citeRegEx": "1", "shortCiteRegEx": "1", "year": 1988}, {"title": "Algorithm 659: Implementing Sobol\u2019s Quasirandom Sequence Generator", "author": ["Paul Bratley", "Bennett L Fox"], "venue": "ACM Transactions on Mathematical Software (TOMS),", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 1988}, {"title": "A Tutorial on Bayesian Optimization of Expensive Cost Functions, with Application to Active User Modeling and Hierarchical Reinforcement Learning", "author": ["Eric Brochu", "Vlad M Cora", "Nando De Freitas"], "venue": "arXiv preprint arXiv:1012.2599,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2010}, {"title": "Bayesian Gait Optimization for Bipedal Locomotion", "author": ["Roberto Calandra", "Nakul Gopalan", "Andr\u00e9 Seyfarth", "Jan Peters", "Marc Peter Deisenroth"], "venue": "In Learning and Intelligent Optimization,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2014}, {"title": "Bayesian Optimization for Learning Gaits Under Uncertainty", "author": ["Roberto Calandra", "Andr\u00e9 Seyfarth", "Jan Peters", "Marc Peter Deisenroth"], "venue": "Annals of Mathematics and Artificial Intelligence,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2016}, {"title": "Generalized Biped Walking Control", "author": ["Stelian Coros", "Philippe Beaudoin", "Michiel van de Panne"], "venue": "In ACM Transactions on Graphics (TOG),", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2010}, {"title": "Robust Swing Leg Placement Under Large Disturbances", "author": ["Ruta Desai", "Hartmut Geyer"], "venue": "ROBIO", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2012}, {"title": "Bayesian Optimization with Inequality Constraints", "author": ["Jacob R Gardner", "Matt J Kusner", "Zhixiang Eddie Xu", "Kilian Q Weinberger", "John Cunningham"], "venue": "In ICML,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2014}, {"title": "A Muscle-reflex Model that Encodes Principles of Legged Mechanics Produces Human Walking Dynamics and Muscle Activities", "author": ["Hartmut Geyer", "Hugh Herr"], "venue": "IEEE Transactions on Neural Systems and Rehabilitation Engineering,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2010}, {"title": "The CMA Evolution Strategy: A Comparing Review", "author": ["Nikolaus Hansen"], "venue": null, "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2006}, {"title": "Yelp Inc)", "author": ["Scott Clark"], "venue": "Introducing MOE: Metric Optimization Engine", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2014}, {"title": "Near-optimal Sensor Placements in Gaussian Processes: Theory, Efficient Algorithms and Empirical Studies", "author": ["Andreas Krause", "Ajit Singh", "Carlos Guestrin"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2008}, {"title": "Automatic Gait Optimization with Gaussian Process Regression", "author": ["Daniel J Lizotte", "Tao Wang", "Michael H Bowling", "Dale Schuurmans"], "venue": "In IJCAI,", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2007}, {"title": "A Bayesian Exploration-Exploitation Approach for Optimal Online Sensing and Planning with a Visually Guided Mobile Robot", "author": ["Ruben Martinez-Cantin", "Nando de Freitas", "Eric Brochu", "Jos\u00e9 Castellanos", "Arnaud Doucet"], "venue": "Autonomous Robots,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2009}, {"title": "The Mechanics of Muscle Function in Locomotion", "author": ["JB Morrison"], "venue": "Journal of Biomechanics,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 1970}, {"title": "Gaussian Processes for Machine Learning (Adaptive Computation and Machine Learning)", "author": ["Carl Edward Rasmussen", "Christopher K.I. Williams"], "venue": null, "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2005}, {"title": "The Major Determinants in Normal and Pathological Gait", "author": ["J.B. dec. M. Saunders", "Verne T. Inman", "Howard D. Eberhart"], "venue": "The Journal of Bone & Joint Surgery,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 1953}, {"title": "A Neural Circuitry that Emphasizes Spinal Feedback Generates Diverse Behaviours of Human Locomotion", "author": ["Seungmoon Song", "Hartmut Geyer"], "venue": "The Journal of Physiology,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2015}, {"title": "Toward Balance Recovery with Leg Prostheses Using Neuromuscular Model Control", "author": ["Nitish Thatte", "Hartmut Geyer"], "venue": "IEEE Transactions on Biomedical Engineering,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2016}, {"title": "Biped Gait Controller for Large Speed Variations, Combining Reflexes and a Central Pattern Generator in a Neuromuscular Model", "author": ["Nicolas Van der Noot", "Auke J Ijspeert", "Renaud Ronsse"], "venue": "ICRA", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2015}, {"title": "Using Trajectory Data to Improve Bayesian Optimization for Reinforcement Learning", "author": ["Aaron Wilson", "Alan Fern", "Prasad Tadepalli"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2014}, {"title": "EMG Profiles During Normal Human Walking: Stride-to-Stride and Inter-subject Variability", "author": ["DA Winter", "HJ Yack"], "venue": "Electroencephalography and Clinical Neurophysiology,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 1987}, {"title": "Simbicon: Simple Biped Locomotion Control", "author": ["KangKang Yin", "Kevin Loken", "Michiel van de Panne"], "venue": "In ACM Transactions on Graphics (TOG),", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2007}], "referenceMentions": [{"referenceID": 3, "context": "One common way of learning controllers is to come up with a control policy parameterizations and a cost function [4], [23], [6].", "startOffset": 113, "endOffset": 116}, {"referenceID": 22, "context": "One common way of learning controllers is to come up with a control policy parameterizations and a cost function [4], [23], [6].", "startOffset": 118, "endOffset": 122}, {"referenceID": 5, "context": "One common way of learning controllers is to come up with a control policy parameterizations and a cost function [4], [23], [6].", "startOffset": 124, "endOffset": 127}, {"referenceID": 8, "context": "In this work, we learn optimal reflex parameters for neuromuscular models described in [9].", "startOffset": 87, "endOffset": 90}, {"referenceID": 17, "context": "These models are human-inspired control pathways that are capable of producing locomotion behaviour in a variety of scenarios as demonstrated in [18].", "startOffset": 145, "endOffset": 149}, {"referenceID": 3, "context": "Promising results were reported in prior work for optimizing an 8-dimensional control policy for a small bipedal robot using Bayesian Optimization [4].", "startOffset": 147, "endOffset": 150}, {"referenceID": 16, "context": "Our kernel uses gait characteristics described in [17] to create an appropriate similarity metric between different parameter sets of the neuromuscular model.", "startOffset": 50, "endOffset": 54}, {"referenceID": 2, "context": "function f(x), while evaluating f as few times as possible ([3] give an overview).", "startOffset": 60, "endOffset": 63}, {"referenceID": 15, "context": "Update equations for the posterior mean and covariance conditioned on evaluations can be found in [16] for both noisy and noiseless settings.", "startOffset": 98, "endOffset": 102}, {"referenceID": 11, "context": "[12] developed an approach utilizing Gaussian Processes and the principle of optimizing", "startOffset": 0, "endOffset": 4}, {"referenceID": 13, "context": "[14] used BO for online path planning Fig.", "startOffset": 0, "endOffset": 4}, {"referenceID": 12, "context": "[13] used a closely related approach of Gaussian Process Regression to optimize the gait on a quadruped robot and showed that this approach required substantially fewer evaluations than state-of-the-art local gradient approaches.", "startOffset": 0, "endOffset": 4}, {"referenceID": 3, "context": "used BO to efficiently find gait parameters that optimize a desired cost [4].", "startOffset": 73, "endOffset": 76}, {"referenceID": 17, "context": "Hence two questions arise : would BO be effective if the dimensionality is increased from 8 to 16? And if it does, how does it compare to previously used approaches, like CMA-ES [18]?", "startOffset": 178, "endOffset": 182}, {"referenceID": 8, "context": "We use neuromuscular model policies, as introduced in [9], as our controller for a 7-link planar human-like model.", "startOffset": 54, "endOffset": 57}, {"referenceID": 6, "context": "[7] designed reflex laws for swing that enabled target foot-placement and leg clearance, by analyzing the double pendulum dynamics of the human leg.", "startOffset": 0, "endOffset": 3}, {"referenceID": 17, "context": "the model to overcome disturbances in the range of up to \u00b110 cm [18].", "startOffset": 64, "endOffset": 68}, {"referenceID": 14, "context": "is actuated by 7 Hill-type muscles [15], consisting of the soleus (SOL), gastrocnemius (GAS), vastus (VAS), hamstring (HAM), tibialis anterior (TA), hip flexors (HFL)", "startOffset": 35, "endOffset": 39}, {"referenceID": 17, "context": "The details of these feedback pathways can be found in [18].", "startOffset": 55, "endOffset": 59}, {"referenceID": 22, "context": "between the stance leg the CoM, and presented in [23]:", "startOffset": 49, "endOffset": 53}, {"referenceID": 6, "context": "Details of this control can be found in [7].", "startOffset": 40, "endOffset": 43}, {"referenceID": 17, "context": "As was noted in [18], and observed in our experiments, the control is relatively insensitive to the individual gains of the", "startOffset": 16, "endOffset": 20}, {"referenceID": 18, "context": "More concisely, the swing parameters that we focus on in our optimization are the following: 1) K p : Position gain on feedback on leg angle 2) K d : Velocity gain on feedback on leg velocity 3) \u03b10 : Nominal leg angle 4) Cd : Gain on the horizontal distance between the stance foot and CoM 5) Cv : Gain on the horizontal velocity of the CoM 6) lclr : Desired leg clearance Though originally developed for explaining human neural control pathways, these controllers have recently been applied to robots and prosthetics, for example in [19] and [20].", "startOffset": 534, "endOffset": 538}, {"referenceID": 19, "context": "More concisely, the swing parameters that we focus on in our optimization are the following: 1) K p : Position gain on feedback on leg angle 2) K d : Velocity gain on feedback on leg velocity 3) \u03b10 : Nominal leg angle 4) Cd : Gain on the horizontal distance between the stance foot and CoM 5) Cv : Gain on the horizontal velocity of the CoM 6) lclr : Desired leg clearance Though originally developed for explaining human neural control pathways, these controllers have recently been applied to robots and prosthetics, for example in [19] and [20].", "startOffset": 543, "endOffset": 547}, {"referenceID": 17, "context": "As demonstrated in [18], these models are indeed capable of generating a variety of locomotion behaviours for a humanoid model - for example, walking on flat, rough ground, turning, running, walking upstairs and on ramps.", "startOffset": 19, "endOffset": 23}, {"referenceID": 9, "context": "Typically, this is done using Covariance Matrix Adaptation Evolutionary Strategy (CMA-ES) [10], an evolutionary algorithm for difficult non-linear non-convex blackbox optimization problems.", "startOffset": 90, "endOffset": 94}, {"referenceID": 17, "context": "An optimization for 16 neuromuscular parameters takes 400 generations, around a day on a standard i7 processor and about 5,000 trials, as reported in [18].", "startOffset": 150, "endOffset": 154}, {"referenceID": 20, "context": "The Behavior-Based Kernel (BBK) of [21] is one kernel that leverages structure in the trajectories generated by the evaluated policies.", "startOffset": 35, "endOffset": 39}, {"referenceID": 16, "context": "Bipedal walking can be characterized with some basic metrics, called gait determinants, as described in [17].", "startOffset": 104, "endOffset": 108}, {"referenceID": 21, "context": "Here, \u03b8 knee is the knee joint angle in swing, \u03b8 thr high and \u03b8 low are the high and low thresholds on knee angle, similar to human data as described in [22].", "startOffset": 153, "endOffset": 157}, {"referenceID": 21, "context": "3m/s [22].", "startOffset": 5, "endOffset": 9}, {"referenceID": 17, "context": "The second cost function is a slightly modified version of the cost used in [18] for experiments with CMA-ES.", "startOffset": 76, "endOffset": 80}, {"referenceID": 17, "context": "Since we have the same set of gains for left and right legs, the steadiness cost of the original cost [18] was unimportant.", "startOffset": 102, "endOffset": 106}, {"referenceID": 4, "context": "Motivated by the discussion in [5], we include the baseline of uniform random search.", "startOffset": 31, "endOffset": 34}, {"referenceID": 9, "context": "We also provide comparisons with CMA-ES [10] and Bayesian Optimization with a Euclidean kernel (basic BO).", "startOffset": 40, "endOffset": 44}, {"referenceID": 10, "context": "For experiments with Bayesian Optimization we explored using two libraries: MOE developed by Yelp [11] and Matlab implementation from [8].", "startOffset": 98, "endOffset": 102}, {"referenceID": 7, "context": "For experiments with Bayesian Optimization we explored using two libraries: MOE developed by Yelp [11] and Matlab implementation from [8].", "startOffset": 134, "endOffset": 137}, {"referenceID": 0, "context": "There has been a lot of work done in identifying dynamic models of robots reliably, for example in [1].", "startOffset": 99, "endOffset": 102}, {"referenceID": 1, "context": "These samples are generated using a Sobol sequence [2] on an undisturbed model on flat ground.", "startOffset": 51, "endOffset": 54}, {"referenceID": 7, "context": "We used a Matlab implementation of Bayesian Optimization from [8] and used a pre-sampled grid when considering next candidates for optimization.", "startOffset": 62, "endOffset": 65}, {"referenceID": 17, "context": "We believe the reason we could not find walking policies on ramps in all runs, was that we are not optimizing the hip lean, which was noted to be crucial for this profile in [18].", "startOffset": 174, "endOffset": 178}, {"referenceID": 17, "context": "Perhaps this could be achieved when optimizing over a much larger set of parameters, as in [18].", "startOffset": 91, "endOffset": 95}], "year": 2016, "abstractText": "Learning policies for bipedal locomotion can be difficult, as experiments are expensive and simulation does not usually transfer well to hardware. To counter this, we need algorithms that are sample efficient and inherently safe. Bayesian Optimization is a powerful sample-efficient tool for optimizing non-convex black-box functions. However, its performance can degrade in higher dimensions. We develop a distance metric for bipedal locomotion that enhances the sample-efficiency of Bayesian Optimization and use it to train a 16 dimensional neuromuscular model for planar walking. This distance metric reflects some basic gait features of healthy walking and helps us quickly eliminate a majority of unstable controllers. With our approach we can learn policies for walking in less than 100 trials for a range of challenging settings. In simulation, we show results on two different costs and on various terrains including rough ground and ramps, sloping upwards and downwards. We also perturb our models with unknown inertial disturbances analogous with differences between simulation and hardware. These results are promising, as they indicate that this method can potentially be used to learn control policies on hardware.", "creator": "LaTeX with hyperref package"}}}