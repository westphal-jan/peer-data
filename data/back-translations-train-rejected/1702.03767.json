{"id": "1702.03767", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "13-Feb-2017", "title": "Is Big Data Sufficient for a Reliable Detection of Non-Technical Losses?", "abstract": "Non-technical losses (NTL) occur during the distribution of electricity in power grids and include, but are not limited to, electricity theft and faulty meters. In emerging countries, they may range up to 40% of the total electricity distributed. In order to detect NTLs, machine learning methods are used that learn irregular consumption patterns from customer data and inspection results. The Big Data paradigm followed in modern machine learning reflects the desire of deriving better conclusions from simply analyzing more data, without the necessity of looking at theory and models. However, the sample of inspected customers may be biased, i.e. it does not represent the population of all customers. As a consequence, machine learning models trained on these inspection results are biased as well and therefore lead to unreliable predictions of whether customers cause NTL or not. In machine learning, this issue is called covariate shift and has not been addressed in the literature on NTL detection yet. In this work, we present a novel framework for quantifying and visualizing covariate shift. We apply it to a commercial data set from Brazil that consists of 3.6M customers and 820K inspection results. We show that some features have a stronger covariate shift than others, making predictions less reliable. In particular, previous inspections were focused on certain neighborhoods or customer classes and that they were not sufficiently spread among the population of customers. This framework is about to be deployed in a commercial product for NTL detection.", "histories": [["v1", "Mon, 13 Feb 2017 13:33:47 GMT  (1503kb,D)", "https://arxiv.org/abs/1702.03767v1", null], ["v2", "Tue, 25 Jul 2017 04:35:45 GMT  (1503kb,D)", "http://arxiv.org/abs/1702.03767v2", "Proceedings of the 19th International Conference on Intelligent System Applications to Power Systems (ISAP 2017)"]], "reviews": [], "SUBJECTS": "cs.LG cs.AI", "authors": ["patrick glauner", "angelo migliosi", "jorge meira", "petko valtchev", "radu state", "franck bettinger"], "accepted": false, "id": "1702.03767"}, "pdf": {"name": "1702.03767.pdf", "metadata": {"source": "CRF", "title": "Is Big Data Sufficient for a Reliable Detection of Non-Technical Losses?", "authors": ["Patrick Glauner", "Angelo Migliosi", "Jorge Augusto Meira", "Petko Valtchev", "Radu State", "Franck Bettinger"], "emails": ["jorge.meira}@uni.lu", "valtchev.petko@uqam.ca", "franck.bettinger@choiceholding.com"], "sections": [{"heading": null, "text": "This year, it is closer than ever before in the history of the country."}, {"heading": "II. RELATED WORK", "text": "From an electrotechnical point of view, methods of energy balance [6] can be applied to the detection of NTL. However, this requires topological information about the distribution network and does not reflect changes in the network. In practice, network topology is subject to rapid changes in emerging countries, i.e. countries where NTL is a particular problem. the methodology prevailing in the literature applies artificial intelligence (AI) to this anomaly detection problem. Historically, AI is based on rules-based expert systems that incorporate expert knowledge. However, in many cases the description of a problem area is challenging due to its complexity and time dynamics. Therefore, the fields of machine learning and data mining have become more popular over the years. These methods learn models from data without being explicitly programmed. A dataset of approximately 22K customers is used in [7] for training a neural network."}, {"heading": "III. COVARIATE SHIFT", "text": "This fact leads to unreliable NTL predictors as they learn from these training data. In this section, we describe how they can be quantified. Historically, covariate shift has been a long-standing statistical problem. For example, The Literary Digest mailed out 10M questionnaires to predict the outcome of the 1936 US presidential election and received 2.4M returns, but the predicted result turned out to be incorrect, because they used car registrations and phone directories to compile a list of recipients. During that time, households that owned a phone or car represented a distorted sample of the total population. By contrast, George Gallup interviewed only 3K hand-picked individuals who were an unbiased sample of the population. Consequently, the Gallup election result [12] could be very well predicted."}, {"heading": "A. Definition", "text": "The previously examined customers are a sample of the total population of the customers. However, this sample may be distorted, i.e. it does not represent the population of all customers, as shown in Fig. 1. One reason for this is that previous inspections were largely focused on certain criteria and were not sufficiently distributed among the population. The problem of training data and production data having different distributions was initially addressed in the field of computer learning theory [13], where it is also called covariate shift, sampling bias or sampling selection bias. It can be mathematically defined as follows [5]: \u2022 Suppose that all examples originate from a distribution D with the domain X \u00b7 Y \u00b7 S, \u2022 where X is the attribute space, \u2022 Y is the label space, \u2022 and S is {0, 1}. Examples (x, y, s) are drawn independently of D. s = 1, while s = 0 denotes the opposite."}, {"heading": "B. Big Data", "text": "Over the past fifteen years, the big data paradigm can be summarized as follows: \"It is not who has the best algorithm that wins, but who has the most data.\" [14] Specifically, this approach reflects a desire to draw better conclusions from the simple analysis of more data without having to look at theory and models. However, taking into account the covariant shift, having only more data is not enough. In this case, less data, which is more representative, seems to be the answer."}, {"heading": "C. Affected Classifiers", "text": "It has been shown that some machine learning algorithms are not affected by covariate shifts, while others are affected by covariate shifts. Examples include logistic regression and hardmargin support vector machine (SVM).2) Global learner: The learner's prediction depends asymptotically on both P (y | x) and P (x), so he is affected by covariate shifts. Example: Decision tree learners such as ID3 or C4.5 [15] divide the input space recursively by selecting the remaining most discriminatory feature of a data set. To predict, the learned tree is traversed from top to bottom. Other examples include naive bayes and soft SVM."}, {"heading": "D. Quantification", "text": "Kullback-Leibler divergence is a measure of the difference between two probability distributions (CC). However, it is difficult (1) to match this measurement to multidimensional data, which is a combination of discrete and continuous characteristics common in machine learning, and (2) to define criteria when a distance is an indicator of covariate displacement. Therefore, a preferred methodology for quantifying covariate displacements is summarized in a data set: First, we add a feature s and assign the values 1 or 0 to the training data (s = 1) or production data (s = 0), respectively, these data sets are further summarized into a data set, the latter being divided into a training set X1 (without reference to the original training set X2) and a test set X2. The goal is to develop a supervised learning method capable of predicting the characteristics of using X1."}, {"heading": "A. Data", "text": "The data used in this paper comes from a Brazilian electricity provider. Firstly, it consists of 3.6 million customers. A complete list of customer master data used in the following experiments is presented in Table I. The categorical features class, voltage, number of wires, contract status and meter type are converted into a uniform encoding. Secondly, the data includes 820K inspection results, such as inspection date, presence of fraud or irregularities, type of NTL and inspection notes. 620K customers have been checked at least once and the remaining ~ 3M customers have never been inspected. Thirdly, there are 195M meter results from 2011 to 2016, such as consumption in kWh, the date of meter reading and the number of days between meter readings. Implementation notes All calculations were executed on a server with 24 cores and 128GB of RAM. All the code was implemented in Python with scikit-learn [18] for machine learning."}, {"heading": "C. Model Parameters", "text": "In the following experiments, we use k = 10-fold cross-validation. In each experiment, we train 1K trees, which are 100 different tree models trained on each of the 10 folds. We optimize the five parameters of the tree model by randomly selecting from predefined, uniform probability distributions shown in Table II. We have selected these areas based on best practice recommendations and our own experience. In addition, the two classes (s = 1 and s = 0) are unbalanced, i.e. there are more examples of the non-inspected customers than the inspected ones. To take this into account during the training, we associate the weights with the classes so that the examples of the minority class have stronger effects."}, {"heading": "D. Global Covariate Shifts", "text": "In the following experiments, we calculate different global types of covariant displacement by using all customers in each experiment. Therefore, we do not divide customers into different geographical areas. We have previously presented the master data of customers available in Table I. We calculate the global displacement of covariates of each of these characteristics. We report our results in Table III. MCCmax denotes the maximum average of MCCs of k = 10 test sets among all 100 tree models trained on the basis of one characteristic, which means that previous inspections are largely skewed toward the customer's location. Location is also the only characteristic above the threshold of 0.2 specified in Section III-D. The characteristic class, number of wires and meter types are below the threshold, but greater than 0.1."}, {"heading": "E. Local Covariate Shifts", "text": "We are now fully focusing on spatial covariate displacement, as it is the strongest among the different types of covariate displacement. In the following experiments, we calculate local covariate displacements by dividing the customers at different locations. The data set provides the following subdivisions in the following hierarchical order: 1) 9 regions 2) 261 municipalities 3) 1,380 municipalities 4) 19,026 neighborhoods We plot the local spatial covariate displacements of these four granularity levels in Fig. 3. All customers are located in a Brazilian state. We observe that spatial covariate displacement at the regional level is smoothed out in Fig. 3a. It is becoming increasingly granular at the municipal, local and neighboring levels in Fig. 3a to 3d. We also notice that spatial covariate displacements at lower levels tend to increase, which is represented by increasing upper limits of the color bars."}, {"heading": "F. Discussion", "text": "We have shown that the spatial covariate shift exists at different levels of granularity, and that communities and localities with very strong covariate shifts exist. Consequently, these local covariate shifts have significant effects on the covariate shifts at higher levels or even globally on the entire dataset. Therefore, using all the data set inspection results leads to the formation of an NTL predictor from a big data perspective, resulting in distorted models that may not reliably detect NTL shifts. As a result, reducing the spatial covariant shift in the dataset may be a priority to obtain reliable NTL predictions."}, {"heading": "V. CONCLUSION AND FUTURE WORK", "text": "In the context of Non-Technical Losses (NTL) detection, we have shown that there is a covariate shift between the customers studied and the total population of customers. We used a real dataset from Brazil, which consists of 3.6 million customers and 820K inspection results. We have shown that some features exhibit a greater covariate shift than others. In particular, the spatial covariate shift is the strongest and occurs at different hierarchical levels. Subsequently, machine learning models trained on this data will lead to unreliable NTL predictions. Our contribution will allow domain experts to model more reliable rules for NTL predictors. Next, we will use spatial point processes [20] to reduce spatial covariate displacement in our dataset and adapt them to train more reliable NTL predictors."}, {"heading": "ACKNOWLEDGMENT", "text": "We would like to thank Lautaro Dolberg, Diogo Duarte and Yves Rangoni from CHOICE Technologies Holding SA for the many good ideas they contributed to our discussions, which were partly financed by the Luxembourg National Research Fund."}], "references": [{"title": "Non-technical losses in power system: A review", "author": ["A. Chauhan", "S. Rajvanshi"], "venue": "Power, Energy and Control (ICPEC), 2013 International Conference on. IEEE, 2013, pp. 558\u2013561.", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2013}, {"title": "The challenge of nontechnical loss detection using artificial intelligence: A survey", "author": ["P. Glauner", "A. Boechat", "L. Dolberg"], "venue": "arXiv preprint arXiv:1606.00626, 2016.", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2016}, {"title": "High performance computing for detection of electricity theft", "author": ["S.S.S.R. Depuru", "L. Wang", "V. Devabhaktuni", "R.C. Green"], "venue": "International Journal of Electrical Power & Energy Systems, vol. 47, pp. 21\u201330, 2013.", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2013}, {"title": "Improving svm-based nontechnical loss detection in power utility using the fuzzy inference system", "author": ["J. Nagi", "K.S. Yap", "S.K. Tiong"], "venue": "IEEE Transactions on power delivery, vol. 26, no. 2, pp. 1284\u20131285, 2011.", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2011}, {"title": "Learning and evaluating classifiers under sample selection bias", "author": ["B. Zadrozny"], "venue": "Proceedings of the twenty-first international conference on Machine learning. ACM, 2004, p. 114.", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2004}, {"title": "A new method for the computation of technical losses in electrical power distribution systems", "author": ["C. d. Oliveira", "N. Kagan", "A. Meffe"], "venue": "Electricity Distribution, 2001. Part 1: Contributions. CIRED. 16th International Conference and Exhibition on (IEE Conf. Publ No. 482), vol. 5. IET, 2001.", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2001}, {"title": "Fraud detection in electric power distribution networks using an ann-based knowledgediscovery process", "author": ["B.C. Costa", "B.L. Alberto", "A.M. Portela"], "venue": "International Journal of Artificial Intelligence & Applications, vol. 4, no. 6, p. 17, 2013.", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2013}, {"title": "Identification and feature selection of non-technical losses for industrial consumers using the software weka", "author": ["C.C.O. Ramos", "A.N. De Souza", "D.S. Gastaldello"], "venue": "Industry Applications (INDUSCON), 2012 10th IEEE/IAS International Conference on. IEEE, 2012, pp. 1\u20136.", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2012}, {"title": "Large-scale detection of non-technical losses in imbalanced data sets", "author": ["P. Glauner", "A. Boechat", "L. Dolberg"], "venue": "Innovative Smart Grid Technologies Conference (ISGT), 2016 IEEE Power & Energy Society. IEEE, 2016.", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2016}, {"title": "Neighborhood features help detecting non-technical losses in big data sets", "author": ["P. Glauner", "J. Meira", "L. Dolberg"], "venue": "3rd IEEE/ACM International Conference on Big Data Computing Applications and Technologies (BDCAT 2016), 2016.", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2016}, {"title": "Distilling provider-independent data for general detection of non-technical losses", "author": ["J. Meira", "P. Glauner", "R. State"], "venue": "Power and Energy Conference at Illinois (PECI), 2017. IEEE, 2017.", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2017}, {"title": "Big data: are we making a big mistake? ft magazine", "author": ["T. Harford"], "venue": "http://www.ft.com/intl/cms/s/2/21a6e7d8-b479-11e3a09a-00144feabdc0.html, 2014, [Online; accessed January 15, 2016].", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2014}, {"title": "Domain adaptation and sample bias correction theory and algorithm for regression", "author": ["C. Cortes", "M. Mohri"], "venue": "Theoretical Computer Science, vol. 519, pp. 103\u2013126, 2014.", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2014}, {"title": "Scaling to very very large corpora for natural language disambiguation", "author": ["M. Banko", "E. Brill"], "venue": "Proceedings of the 39th annual meeting on association for computational linguistics. Association for Computational Linguistics, 2001, pp. 26\u201333.", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2001}, {"title": "C4. 5: Programming for machine learning", "author": ["J.R. Quinlan"], "venue": "Morgan Kauffmann, p. 38, 1993.", "citeRegEx": "15", "shortCiteRegEx": null, "year": 1993}, {"title": "Comparison of the predicted and observed secondary structure of t4 phage lysozyme", "author": ["B.W. Matthews"], "venue": "Biochimica et Biophysica Acta (BBA)- Protein Structure, vol. 405, no. 2, pp. 442\u2013451, 1975.", "citeRegEx": "16", "shortCiteRegEx": null, "year": 1975}, {"title": "A simple machine learning method to detect covariate shift", "author": ["F.J. Martin"], "venue": "https://blog.bigml.com/2014/01/03/simple-machine-learningto-detect-covariate-shift/, 2014, [Online; accessed January 15, 2016].", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2014}, {"title": "Scikit-learn: Machine learning in Python", "author": ["F. Pedregosa", "G. Varoquaux", "A. Gramfort"], "venue": "Journal of Machine Learning Research, vol. 12, pp. 2825\u20132830, 2011.", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2011}, {"title": "Spatial point processes and their applications", "author": ["A. Baddeley", "I. B\u00e1r\u00e1ny", "R. Schneider"], "venue": "Stochastic Geometry: Lectures given at the CIME Summer School held in Martina Franca, Italy, September 13\u201318, 2004, pp. 1\u201375, 2007.", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2004}], "referenceMentions": [{"referenceID": 0, "context": "Non-technical losses (NTL) appear during power distribution and include, but are not limited to, the following causes [1], [2]:", "startOffset": 118, "endOffset": 121}, {"referenceID": 1, "context": "Non-technical losses (NTL) appear during power distribution and include, but are not limited to, the following causes [1], [2]:", "startOffset": 123, "endOffset": 126}, {"referenceID": 2, "context": "They can range up to 40% of the total electricity distributed in countries such as Brazil, India, Malaysia or Lebanon [3], [4].", "startOffset": 118, "endOffset": 121}, {"referenceID": 3, "context": "They can range up to 40% of the total electricity distributed in countries such as Brazil, India, Malaysia or Lebanon [3], [4].", "startOffset": 123, "endOffset": 126}, {"referenceID": 4, "context": "In technical terms, this bias is called covariate shift or sampling bias [5].", "startOffset": 73, "endOffset": 76}, {"referenceID": 5, "context": "From an electrical engineering perspective, energy balance methods [6] can be applied to the detection of NTL.", "startOffset": 67, "endOffset": 70}, {"referenceID": 6, "context": "A data set of ~22K customers is used in [7] for training a neural network.", "startOffset": 40, "endOffset": 43}, {"referenceID": 7, "context": "Consumption profiles of 5K Brazilian industrial customer profiles are analyzed in [8].", "startOffset": 82, "endOffset": 85}, {"referenceID": 1, "context": "We have extensively reviewed the state of the art in our previous work and identified the open challenges in NTL detection [2].", "startOffset": 123, "endOffset": 126}, {"referenceID": 8, "context": "We have previously addressed the class imbalance and evaluation metric selection, when we showed that a large-scale machine learning approach outperformed rule-based Boolean and fuzzy logic expert systems [9].", "startOffset": 205, "endOffset": 208}, {"referenceID": 9, "context": "Furthermore, we have shown that the neighborhood of customers yields significant information in order to decide whether a customer causes a NTL or not [10], [11].", "startOffset": 151, "endOffset": 155}, {"referenceID": 10, "context": "Furthermore, we have shown that the neighborhood of customers yields significant information in order to decide whether a customer causes a NTL or not [10], [11].", "startOffset": 157, "endOffset": 161}, {"referenceID": 11, "context": "As a consequence, Gallup could predict the outcome of the election very well [12].", "startOffset": 77, "endOffset": 81}, {"referenceID": 12, "context": "The problem of training data and production data having different distributions has initially been addressed in the field of computational learning theory [13], which also calls it covariate shift, sampling bias or sample selection bias.", "startOffset": 155, "endOffset": 159}, {"referenceID": 4, "context": "It can be defined in mathematical terms as follows [5]:", "startOffset": 51, "endOffset": 54}, {"referenceID": 4, "context": "This problem is called covariate shift [5].", "startOffset": 39, "endOffset": 42}, {"referenceID": 13, "context": "\u201d [14] Concretely, this approach reflects the desire of deriving better conclusions from simply analyzing more data, without the necessity of looking at theory and models.", "startOffset": 2, "endOffset": 6}, {"referenceID": 4, "context": "It has been shown that some machine learning algorithms are not affected by covariate shift, whereas others are [5].", "startOffset": 112, "endOffset": 115}, {"referenceID": 14, "context": "5 [15] recursively split the input space by choosing the remaining most discriminative feature of a data set.", "startOffset": 2, "endOffset": 6}, {"referenceID": 15, "context": "which measures the accuracy of binary classifiers taking into account the imbalance of both classes, ranging from \u22121 to +1 [16].", "startOffset": 123, "endOffset": 127}, {"referenceID": 16, "context": "2 has been proposed [17].", "startOffset": 20, "endOffset": 24}, {"referenceID": 17, "context": "The entire code was implemented in Python using scikit-learn [18] for machine learning.", "startOffset": 61, "endOffset": 65}, {"referenceID": 18, "context": "Next, we will use and amend spatial point processes [20] for reducing the spatial covariate shift in our data set in order to train more reliable NTL predictors.", "startOffset": 52, "endOffset": 56}], "year": 2017, "abstractText": "Non-technical losses (NTL) occur during the distribution of electricity in power grids and include, but are not limited to, electricity theft and faulty meters. In emerging countries, they may range up to 40% of the total electricity distributed. In order to detect NTLs, machine learning methods are used that learn irregular consumption patterns from customer data and inspection results. The Big Data paradigm followed in modern machine learning reflects the desire of deriving better conclusions from simply analyzing more data, without the necessity of looking at theory and models. However, the sample of inspected customers may be biased, i.e. it does not represent the population of all customers. As a consequence, machine learning models trained on these inspection results are biased as well and therefore lead to unreliable predictions of whether customers cause NTL or not. In machine learning, this issue is called covariate shift and has not been addressed in the literature on NTL detection yet. In this work, we present a novel framework for quantifying and visualizing covariate shift. We apply it to a commercial data set from Brazil that consists of 3.6M customers and 820K inspection results. We show that some features have a stronger covariate shift than others, making predictions less reliable. In particular, previous inspections were focused on certain neighborhoods or customer classes and that they were not sufficiently spread among the population of customers. This framework is about to be deployed in a commercial product for NTL detection.", "creator": "LaTeX with hyperref package"}}}