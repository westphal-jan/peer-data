{"id": "1702.05931", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "20-Feb-2017", "title": "The importance of stain normalization in colorectal tissue classification with convolutional networks", "abstract": "The development of reliable imaging biomarkers for the analysis of colorectal cancer (CRC) in hematoxylin and eosin (H&amp;E) stained histopathology images requires an accurate and reproducible classification of the main tissue components in the image. In this paper, we propose a system for CRC tissue classification based on convolutional networks (ConvNets). We investigate the importance of stain normalization in tissue classification of CRC tissue samples in H&amp;E-stained images. Furthermore, we report the performance of ConvNets on a cohort of rectal cancer samples and on an independent publicly available dataset of colorectal H&amp;E images.", "histories": [["v1", "Mon, 20 Feb 2017 11:11:50 GMT  (2855kb,D)", "https://arxiv.org/abs/1702.05931v1", "Accepted for oral presentation at the IEEE Internatioal Symposium on Biomedical Imaging (ISBI) 2017"], ["v2", "Tue, 23 May 2017 12:34:17 GMT  (2855kb,D)", "http://arxiv.org/abs/1702.05931v2", "Published in Proceedings of IEEE International Symposium on Biomedical Imaging (ISBI) 2017"]], "COMMENTS": "Accepted for oral presentation at the IEEE Internatioal Symposium on Biomedical Imaging (ISBI) 2017", "reviews": [], "SUBJECTS": "cs.CV cs.LG", "authors": ["francesco ciompi", "oscar geessink", "babak ehteshami bejnordi", "gabriel silva de souza", "alexi baidoshvili", "geert litjens", "bram van ginneken", "iris nagtegaal", "jeroen van der laak"], "accepted": false, "id": "1702.05931"}, "pdf": {"name": "1702.05931.pdf", "metadata": {"source": "CRF", "title": "THE IMPORTANCE OF STAIN NORMALIZATION IN COLORECTAL TISSUE CLASSIFICATION WITH CONVOLUTIONAL NETWORKS", "authors": ["Francesco Ciompi", "Oscar Geessink", "Babak Ehteshami Bejnordi", "Gabriel Silva de Souza", "Alexi Baidoshvili", "Geert Litjens", "Bram van Ginneken", "Iris Nagtegaal", "Jeroen van der Laak"], "emails": [], "sections": [{"heading": null, "text": "However, the decision whether a patient should be treated with adjuvant chemotherapy largely depends on the tumour stage. This indicates the need for additional biomarkers in addition to tumour stages that allow further stratification of CRC patients and identify those who may or may not benefit from adjuvant treatment. In recent years, researchers have explored the role of histological parameters as new biomarkers to guide adjuvant treatments, such as the ratio of necrosis and the relative amounts of tumours and stroma."}, {"heading": "2.1. Material", "text": "In this paper, we used data from two different sources, a cohort of whole-body images from rectal cancer samples and a data set of colorectal cancer images and patches recently made publicly available [4]. We used the cohort of rectal cancers to investigate the role of staining in CRC tissue classification and validate performance in cross-validation. A set of 74 histological slides from 74 patients was used to further validate the performance of ConvNets on an independent data set and to investigate the role of staining in CRC tissue classification."}, {"heading": "2.2. Convolutional Network", "text": "The design of ConvNets (see Table 1) is based on the approach proposed in [8] and consists of a fully twisted network [9] with 11 layers. Input of the network is a 150 x 150 pixel RGB patch, which corresponds to the patch size in CRCp. As in [8], we alternated revolutionary (with ReLU nonlinearity) and max pooling layers, starting with 32 filters in the first layer, and doubled the amount of filters after each max pooling, but we used slightly larger filters (5 x 5) in the first two layers. The output of the network is a 9-element vector, which contains the probability that the patch belongs to one of the 9 RC fabric types."}, {"heading": "2.3. Stain normalization", "text": "Coloring Normalization (SN) involves converting an image I to another image I, and f is the mapping function that corresponds to the visual appearance of a given image with the original image. Parameters are generally defined to capture color information of the main coloring components in the image (e.g. H and E.) As a result, coloring normalized images have a color distribution similar to that of the original. Figure 1 presents images from CRCt and their color normalized version based on the WSI template of Figure 2. In this work, we considered two prior art SN algorithms, the first based on the method recently published by Bejnordi et al. [5]."}, {"heading": "3.1. Rectal cancer tissue classification", "text": "We evaluated the performance of the ConvNet on the RC dataset using a 5x cross-validation approach. We selected 40 WSI for training, 19 for validation, and 15 for testing, with no patient overlapping across datasets. For each fold, the ConvNet was trained with 4000 iterations of stochastic gradient descent at a constant learning rate of 0.0003, the ADAM algorithm for updating parameters and categorical cross-entropy as a loss function. For each iteration, a mini-batch of 256 patches was built on-the-fly, randomly sampling a balanced number of patches from each manually annotated class in the training set. Data was expanded by rotating each patch by 90, 180, and 270 degrees, increasing the number of patches in training to about 4 million per fold. During training, performance of the system was monitored by classifying one fixed set of 45,000 validation samples per class."}, {"heading": "3.2. The importance of stain normalization", "text": "The definition of classes in our RC data is only slightly different from what comes with the CRC dataset."}], "references": [{"title": "Tumor necrosis is a new promising prognostic factor in colorectal cancer", "author": ["Marion Pollheimer"], "venue": "Human Pathology, vol. 41, pp. 1749\u20131757, 2010.", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2010}, {"title": "The proportion of tumor-stroma as a strong prognosticator for stage II and III colon cancer patients: validation in the Victor trial", "author": ["A. Huijbers"], "venue": "Ann Oncol, vol. 24, no. 1, pp. 179\u2013185, Jan 2013.", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2013}, {"title": "Deep Learning", "author": ["Yann LeCun", "Yoshua Bengio", "Geoffrey Hinton"], "venue": "Nature, vol. 521, no. 7553, pp. 436\u2013 444, 2015.", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2015}, {"title": "Multi-class texture analysis in colorectal cancer histology", "author": ["Jakob Nikolas Kather"], "venue": "Scientific Reports, vol. 6, 2016.", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2016}, {"title": "Stain specific standardization of whole-slide histopathological images", "author": ["Babak Ehteshami Bejnordi"], "venue": "IEEE Transactions on Medical Imaging, vol. 35, no. 2, pp. 404\u2013415, Sep 2016.", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2016}, {"title": "A method for normalizing histology slides for quantitative analysis", "author": ["Marc Macenko"], "venue": "2009 IEEE International Symposium on Biomedical Imaging: From Nano to Macro. 2009, pp. 1107\u20131110, IEEE.", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2009}, {"title": "A nonlinear mapping approach to stain normalization in digital histopathology images using image-specific color deconvolution", "author": ["A.M. Khan", "N. Rajpoot", "D. Treanor", "D. Magee"], "venue": "IEEE Transactions on Biomedical Engineering, vol. 61, no. 6, pp. 1729\u20131738, June 2014.", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2014}, {"title": "Very deep convolutional networks for large-scale image recognition", "author": ["Karen Simonyan", "Andrew Zisserman"], "venue": "arXiv:14091556, 2014.", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2014}, {"title": "Fully convolutional networks for semantic segmentation", "author": ["Jonathan Long", "Evan Shelhamer", "Trevor Darrell"], "venue": "arXiv:14114038, 2015. The authors would like to thank NVIDIA Corporation for the donation of a GeForce GTX Titan X graphics card used in the experiments. This project was supported by the Alpe dHuZes / Dutch Cancer Society Fund (grant number KUN 2014-7032).", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2015}], "referenceMentions": [{"referenceID": 0, "context": "Examples are the proportion of necrosis [1] and the relative amounts of tumor and stroma [2], which proved to be strong independent prognostic factors in CRC.", "startOffset": 40, "endOffset": 43}, {"referenceID": 1, "context": "Examples are the proportion of necrosis [1] and the relative amounts of tumor and stroma [2], which proved to be strong independent prognostic factors in CRC.", "startOffset": 89, "endOffset": 92}, {"referenceID": 3, "context": "Samples of CRC tissue from [4] (top) and their stainnormalized version (bottom) using the algorithm in [5].", "startOffset": 27, "endOffset": 30}, {"referenceID": 4, "context": "Samples of CRC tissue from [4] (top) and their stainnormalized version (bottom) using the algorithm in [5].", "startOffset": 103, "endOffset": 106}, {"referenceID": 2, "context": "In recent years, convolutional networks (ConvNets) [3] have become the reference algorithm to solve image- and patch-based classification tasks in medical imaging.", "startOffset": 51, "endOffset": 54}, {"referenceID": 4, "context": "To cope with this problem, stain normalization (SN) algorithms for histological images have been recently developed [5, 6, 7], with the aim of matching stain colors of WSI with a given template.", "startOffset": 116, "endOffset": 125}, {"referenceID": 5, "context": "To cope with this problem, stain normalization (SN) algorithms for histological images have been recently developed [5, 6, 7], with the aim of matching stain colors of WSI with a given template.", "startOffset": 116, "endOffset": 125}, {"referenceID": 6, "context": "To cope with this problem, stain normalization (SN) algorithms for histological images have been recently developed [5, 6, 7], with the aim of matching stain colors of WSI with a given template.", "startOffset": 116, "endOffset": 125}, {"referenceID": 7, "context": "The nomenclature follows the one used in [8].", "startOffset": 41, "endOffset": 44}, {"referenceID": 3, "context": "was recently made publicly available [4].", "startOffset": 37, "endOffset": 40}, {"referenceID": 3, "context": "A dataset of colorectal cancer images and patches from 10 patients was recently made publicly available [4].", "startOffset": 104, "endOffset": 107}, {"referenceID": 7, "context": "The design of ConvNets (see Table 1) was based on the approach proposed in [8] and consists of a fully convolutional network [9] with 11 layers.", "startOffset": 75, "endOffset": 78}, {"referenceID": 8, "context": "The design of ConvNets (see Table 1) was based on the approach proposed in [8] and consists of a fully convolutional network [9] with 11 layers.", "startOffset": 125, "endOffset": 128}, {"referenceID": 7, "context": "As in [8], we alternated convolutional (with ReLU non linearity) and max-pooling layers, starting with 32 filters in the first layer, and doubling the amount of filters after every max-pooling, but we used slightly larger filters (5\u00d75) in", "startOffset": 6, "endOffset": 9}, {"referenceID": 4, "context": "[5], which we refer to as SN1.", "startOffset": 0, "endOffset": 3}, {"referenceID": 5, "context": "[6], which was mentioned as the reference method for stain normalization in the TUPAC6 and AMIDA7 challenges and has a publicly available MATLAB implementation8.", "startOffset": 0, "endOffset": 3}], "year": 2017, "abstractText": "The development of reliable imaging biomarkers for the analysis of colorectal cancer (CRC) in hematoxylin and eosin (H&E) stained histopathology images requires an accurate and reproducible classification of the main tissue components in the image. In this paper, we propose a system for CRC tissue classification based on convolutional networks (ConvNets). We investigate the importance of stain normalization in tissue classification of CRC tissue samples in H&E-stained images. Furthermore, we report the performance of ConvNets on a cohort of rectal cancer samples and on an independent publicly available dataset of colorectal H&E images.", "creator": "LaTeX with hyperref package"}}}