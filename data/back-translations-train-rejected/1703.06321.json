{"id": "1703.06321", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "18-Mar-2017", "title": "Solving the Goddard problem by an influence diagram", "abstract": "Influence diagrams are a decision-theoretic extension of probabilistic graphical models. In this paper we show how they can be used to solve the Goddard problem. We present results of numerical experiments with this problem and compare the solutions provided by influence diagrams with the optimal solution.", "histories": [["v1", "Sat, 18 Mar 2017 17:25:55 GMT  (49kb,D)", "https://arxiv.org/abs/1703.06321v1", "10 pages, 2 figures"], ["v2", "Tue, 21 Mar 2017 08:11:19 GMT  (41kb,D)", "http://arxiv.org/abs/1703.06321v2", "10 pages, 2 figures"]], "COMMENTS": "10 pages, 2 figures", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["ji\\v{r}\\'i vomlel", "v\\'aclav kratochv\\'il"], "accepted": false, "id": "1703.06321"}, "pdf": {"name": "1703.06321.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": ["vomlel@utia.cas.cz,"], "sections": [{"heading": "1 Introduction", "text": "The problem formulated by Robert H. Goddard (Goddard, 1919) is to determine the optimum thrust profile for a rocket ascending vertically from the surface of the Earth to achieve a given height with a given speed and payload at minimum fuel consumption, taking into account the aerodynamic resistance and gravity varying with altitude. We are investigating a problem version that assumes limited thrust. Due to a characteristic singular arc behavior combined with a relatively simple model structure, the problem has developed into an ideal study object, cf. Graichen and Petit, 2008."}, {"heading": "2 The ODE model", "text": "The equation of motion of the rocket subject to the forces of gravity, resistance and thrust is: c \u00b7 dm (t) dt + m \u00b7 dv (t) dt + d (v, h) + m \u00b7 g (h) = 0, (1) \u043d This work was supported by the Czech Science Foundation (Project 16-12010S).ar Xiv: 170 3.06 321v 2 [cs.A I] 2 1whered (v, h) = 12 \u00b7 s \u00b7 cD \u00b7 \u03c1 (h) \u00b7 v2 (h) = 0 \u00b7 exp (\u03b2 \u00b7 (1 \u2212 h R)) (3) g (h) = \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 R2h2 (4) in the following notation: \u2022 c is the exhaust air velocity (the jet velocity), \u2022 m is the mass of the rocket velocity v (dt), which is a constant dimension of the earth, and the fuel mf burned during the rocket ascent is \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 v (the velocity v), which is the velocity of air velocity v (dt), which is the velocity of air velocity v (d), which is the velocity of air velocity of the rocket velocity v (m)."}, {"heading": "3 Normalized Goddard Problem", "text": "In literature, the problem is often presented in its non-dimensional form."}, {"heading": "4 Optimal control problem formulation", "text": "The state variables are the rocket mass m (payload and fuel) and the rocket velocity v = \u03b2 = fuel consumption in height h. The control variable u controls the thrust, which is the derivative of mass m in relation to the time t multiplied by the jet velocity c, i.e.u = c \u00b7 dm dt = c \u00b7 dm dm dh \u00b7 dh dt = dm dh \u00b7 c \u2212 v (12), which means that the mass m in height h ism (h) = m0 + x h h \u2032 h \u2032 h = 0 c \u00b7 v (h \u2032) \u00b7 u (h \u2032) dh \u2032, (13) where m0 is the initial mass at launch. Please note that u \u2264 0 can only decrease due to the fact that the mass of the rocket can only decrease (by burning the fuel). The control will be limited to u [\u2212 3.5, 0]. The task is to find a control function u (h), so that we get from the starting state 0 to the starting state (v.0)."}, {"heading": "4.1 Model parameters", "text": "The model parameters we are looking at are identical to those presented in Ziotras and Kelley, 1991) and (Seywald and Cliff, 1992).The aerodynamic data and vehicle parameters come from (Slatskiy and Kiforenko, 1983) and roughly correspond to the Soviet SA-2 surface-to-air missile. The undimensioned values of these constants are: \u03b2 = 500s \u00b7 \u03c10 = 12400 cD = 0.05c = 0.5."}, {"heading": "5 ODE approximate solution methods", "text": "Let us now consider a trajectory segment of length \u2206 h with constant control and equal to u. \"Let h be\" the height, m \"the mass value, and v\" the velocity - all at the beginning of the segment."}, {"heading": "The Euler method", "text": "The Euler method uses the following approximation: (m (h '+ \u2206 h) v (h' + \u2206 h)) \u2248 (m '+ \u2206 h \u00b7 g (u', v ') v' + \u2206 h \u00b7 f (h ', m', u ', u', u ', v'). (17) This method is not very accurate. Note that the mass estimate assumes a constant rocket velocity for the entire segment, which means that at accelerations the mass is underestimated and at slowdowns the mass is overestimated. Also, note that the velocity estimate assumes a constant rocket mass and a constant air resistance for the entire segment, which means that the velocity is underestimated. On the other hand, the method is extremely fast."}, {"heading": "The general approximation method", "text": "The general approximation of the order s takes the following form: (m (h '+ \u2206 h) v (h '+ \u0445 h)) \u2248 (m (h ') + \u0445 h \u00b7 fic s i = 1 wi \u00b7'i v (h ') + \u0445 h \u00b7 \u2211 si = 1 wi \u00b7 ki), (18) where for i = 1,..., s'i = g (u, \"v\" h \u00b7 fic s = 1 ai, j \u00b7 kj) (19) ki = f h \"+ zi\" h, \"m\" h, \"m\" h, \"j \u00b7 u\" c \"(v\" h \"), (20), which refers to an equation for each i = 1,.., s: ki = f\" h \"+ zi \u00b7 h,\" m \"h,\" h \"h,\" h, \"h,\" h, \"h,\" h, h."}, {"heading": "The classical Runge\u2013Kutta method", "text": "s tableau: z1 a1,1 a1,2 a1,3 a1,4z2 a2,1 a2,2 a2,4z3 a2,4z3 a3,1 a3,2 a3,4z4 a4,1 a4,2 a4,3 a4,4w1 w2 w3 = 0 0 0 01 2 0 0 01 0 1 01 6 2 6 2 6 6 1 6The computational advantage of RK4 is that (due to the zeros in its butcher tableau) the values of \"i and ki for i = 1,... s are explicitly specified. Unfortunately, the RK4 method can be numerically unstable for some problems, provided the step size is not extremely small. This can lead to wild oscillations of the control."}, {"heading": "Gauss\u2013Legendre method", "text": "The meat tableau of this method for s = 2 isz1 a1.1 a1.2z2 a2.1 a2.2w1 w2 = 1 2 \u2212 1 6 \u221a 3 141 4 \u2212 1 6 \u221a 31 2 + 1 6 \u221a 3 14 + 1 6 \u221a 3 141 21 2Note that the values of ki for i = 1,..., s are only specified implicitly and the nonlinear system specified by (21) must be solved. If their values are found, they can be replaced by formula (19) and (18). Unlike RK4, the Gauss-Legendre method is A stable (Dahlquist, 1963)."}, {"heading": "Control constraints", "text": "(22) In order to avoid situations in which the rocket does not move or crash, we need its velocity v > 0. Moreover, the rocket cannot have its mass lower than its payload, i.e. m \u2265 mp. We recognize these limitations by control constraints. We only allow control values u for which, when replaced by formula (18), it holds the mass of m (h \u2032 + \u0445 h) \u2265 mp and v (h \u2032 + \u0445 h) > 0, except for the final altitude hT, in v (hT) \u2265 0. Note that the lower limit of | u | is thus a function of height h, current velocity v and current rocket mass m.1Note that u \u2264 0."}, {"heading": "6 The influence diagram", "text": "In each segment i (i = 0, 1,., N) of the influence diagram for the Goddard problem there are two state variables: \u2022 a velocity variable Vi and \u2022 a mass variable Mi.In each segment i there is also a decision variable: \u2022 the control of the thrust force of the rocket engine Ui. Finally, in each segment i = 1,.., N there is a supply node: \u2022 the fuel consumption in segment fi.The structure of a segment of the influence diagram for the discrete version of the Goddard problem is shown in Figure 1. In each segment a solution is found for a system of two ordinary differential equations using an approximate method as discussed in Section 5. Typically, the calculated mass and velocity values at the end of the segment are not in the discrete values of the mass and velocity variables. Therefore, we will describe the state transformations by non-ministerial CPTVi (Mi + Vi), Mi (Mi + Vi) and (Mi)."}, {"heading": "7 Experimental results", "text": "In Figure 2, we compare the control, velocity and mass profiles of the optimal solution found by Bocop (Team Commands, 2016) with solutions found by influence diagrams with different discretizations and different approach methods. It is known (Miele, 1963) that the optimal solution consists of three sub-ranges: (a) a sub-range with maximum thrust, (b) a sub-range with variable thrust and (c) a sub-range with rotating thrust, i.e. a sub-range with zero thrust. We named the solutions found by influence diagrams, using a naming scheme v.u.m.M.h, which consists of the parameters used in the experiments: \u2022 v... the number of states of the velocity variables, \u2022 u... the number of states of the control variables, \u2022 m... the states of the mass variables, \u2022 M... the discretion method for solving the ODEs (the uler method, the RK method, the Rutta method, the RK method and the smaller method)."}, {"heading": "8 Conclusions", "text": "We have shown how influence diagrams can be used to solve a control theory benchmark problem - the Goddard problem. Numerical experiments show that the solution found by influence diagrams approaches the optimal solution well and the quality of the approach increases with finer discretizations. Of the ODE approach methods tested, the best results were obtained by the simplest one - the Euler method."}], "references": [{"title": "A special stability problem for linear multistep methods", "author": ["G.G. Dahlquist"], "venue": "BIT Numerical Mathematics,", "citeRegEx": "Dahlquist,? \\Q1963\\E", "shortCiteRegEx": "Dahlquist", "year": 1963}, {"title": "A method for reaching extreme altitudes", "author": ["R.H. Goddard"], "venue": "Smithsonian Miscellaneous Collections,", "citeRegEx": "Goddard,? \\Q1919\\E", "shortCiteRegEx": "Goddard", "year": 1919}, {"title": "Solving the Goddard problem with thrust and dynamic pressure constraints using saturation functions", "author": ["K. Graichen", "N. Petit"], "venue": "In Proceedings of the 17th World Congress of the International Federation of Automatic Control Seoul,", "citeRegEx": "Graichen and Petit,? \\Q2008\\E", "shortCiteRegEx": "Graichen and Petit", "year": 2008}, {"title": "Influence diagrams for speed profile optimization", "author": ["V. Kratochv\u0301\u0131l", "J. Vomlel"], "venue": "International Journal of Approximate Reasoning. (in press),", "citeRegEx": "Kratochv\u0301\u0131l and Vomlel,? \\Q2016\\E", "shortCiteRegEx": "Kratochv\u0301\u0131l and Vomlel", "year": 2016}, {"title": "A survey of the problem of optimizing flight paths of aircraft and missiles", "author": ["A. Miele"], "venue": "Mathematical Optimization Techniques,", "citeRegEx": "Miele,? \\Q1963\\E", "shortCiteRegEx": "Miele", "year": 1963}, {"title": "Goddard problem in presence of a dynamic pressure limit", "author": ["H. Seywald", "E.M. Cliff"], "venue": "Journal of Guidance, Control, and Dynamics,", "citeRegEx": "Seywald and Cliff,? \\Q1992\\E", "shortCiteRegEx": "Seywald and Cliff", "year": 1992}, {"title": "BOCOP: an open source toolbox for optimal control. http://bocop.org", "author": ["I.S. Team Commands"], "venue": null, "citeRegEx": "Commands,? \\Q2016\\E", "shortCiteRegEx": "Commands", "year": 2016}, {"title": "Drag-law effects in the Goddard problem", "author": ["P. Tsiotras", "H.J. Kelley"], "venue": null, "citeRegEx": "Tsiotras and Kelley,? \\Q1991\\E", "shortCiteRegEx": "Tsiotras and Kelley", "year": 1991}, {"title": "Computation of optimal trajectories with singular-control sections", "author": ["V.T. Zlatskiy", "B.N. Kiforenko"], "venue": "Vychislitel\u2019naia i Prikladnaia Matematika,", "citeRegEx": "Zlatskiy and Kiforenko,? \\Q1983\\E", "shortCiteRegEx": "Zlatskiy and Kiforenko", "year": 1983}], "referenceMentions": [{"referenceID": 1, "context": "Goddard, see (Goddard, 1919), the problem is to establish the optimal thrust profile for a rocket ascending vertically from the Earth\u2019s surface to achieve a given altitude with a given speed and pay load and with the minimum fuel expenditure.", "startOffset": 13, "endOffset": 28}, {"referenceID": 2, "context": "(Graichen and Petit, 2008).", "startOffset": 0, "endOffset": 26}, {"referenceID": 7, "context": "1 Model parameters The model parameters we consider correspond to those presented in (Tsiotras and Kelley, 1991) and (Seywald and Cliff, 1992).", "startOffset": 85, "endOffset": 112}, {"referenceID": 5, "context": "1 Model parameters The model parameters we consider correspond to those presented in (Tsiotras and Kelley, 1991) and (Seywald and Cliff, 1992).", "startOffset": 117, "endOffset": 142}, {"referenceID": 8, "context": "The aerodynamic data and the vehicle\u2019s parameters originate from (Zlatskiy and Kiforenko, 1983) and correspond roughly to the Soviet SA-2 surface-to-air missile, NATO code-named Guideline.", "startOffset": 65, "endOffset": 95}, {"referenceID": 0, "context": "Contrary to RK4 the Gauss\u2013Legendre method is A-stable (Dahlquist, 1963).", "startOffset": 54, "endOffset": 71}, {"referenceID": 4, "context": "It is known (Miele, 1963) that the optimal solution consists of three subarcs: (a) a maximum-thrust subarc, (b) a variable-thurst subarc, and (c) a coasting subarc, i.", "startOffset": 12, "endOffset": 25}], "year": 2017, "abstractText": "Influence diagrams are a decision-theoretic extension of probabilistic graphical models. In this paper we show how they can be used to solve the Goddard problem. We present results of numerical experiments with this problem and compare the solutions provided by influence diagrams with the optimal solution.", "creator": "LaTeX with hyperref package"}}}