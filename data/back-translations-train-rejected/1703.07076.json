{"id": "1703.07076", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "21-Mar-2017", "title": "SMILES Enumeration as Data Augmentation for Neural Network Modeling of Molecules", "abstract": "Simplified Molecular Input Line Entry System (SMILES) is a single line text representation of a unique molecule. One molecule can however have multiple SMILES strings, which is a reason that canonical SMILES have been defined, which ensures a one to one correspondence between SMILES string and molecule. Here the fact that multiple SMILES represent the same molecule is explored as a technique for data augmentation of a molecular QSAR dataset modeled by a long short term memory (LSTM) cell based neural network. The augmented dataset was 130 times bigger than the original. The network trained with the augmented dataset shows better performance on a test set when compared to a model built with only one canonical SMILES string per molecule. The correlation coefficient R2 on the test set was improved from 0.56 to 0.66 when using SMILES enumeration, and the root mean square error (RMS) likewise fell from 0.62 to 0.55. The technique also works in the prediction phase. By taking the average per molecule of the predictions for the enumerated SMILES a further improvement to a correlation coefficient of 0.68 and a RMS of 0.52 was found.", "histories": [["v1", "Tue, 21 Mar 2017 07:13:13 GMT  (365kb)", "http://arxiv.org/abs/1703.07076v1", null], ["v2", "Wed, 17 May 2017 11:24:43 GMT  (382kb,D)", "http://arxiv.org/abs/1703.07076v2", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["esben jannik bjerrum"], "accepted": false, "id": "1703.07076"}, "pdf": {"name": "1703.07076.pdf", "metadata": {"source": "CRF", "title": "SMILES Enumeration as Data Augmentation for Neural Network Modeling of Molecules", "authors": ["E. J. Bjerrum"], "emails": ["esben@wildcardconsulting.dk"], "sections": [{"heading": null, "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "Introduction", "text": "Neural networks and deep learning have shown interesting application successes, such as image classification1 and speech recognition 2. One of the problems limiting their general applicability in the QSAR domain may be the limited size of the marked data sets that are available even though successes do not materialize 3. Limited data sets require strict regularization or flat and narrow architectures. Within image analysis and classification, data augmentation techniques have been applied with excellent results 4-7. As an example, a dataset of marked images can be enlarged by operations such as mirroring, rotation, morphing and zooming. The subsequently trained network becomes more robust to such variations, and the neural network can detect the same object in different versions. Neural networks have also been used on molecular structures where the input of descriptions 3, rotation, morphing and zooming can be calculated."}, {"heading": "Methods", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "SMILES enumeration", "text": "The SMILES enumeration is done using a Python script using the RDKit.13 Chemical formats library. 13 The atom arrangement of the molecule is encrypted by conversion to molfile format14 and changing the atom order before it is converted back to RDKit mol format. Subsequently, RDKit generates a SMILES, defaulting canonical SMILES to false, with different atom arrangements leading to different SMILES. Subsequently, the SMILES strings are compared and added to a growing number of unique SMILES strings. The process repeats a predefined number of times. Python functions are available on github: https: / / github.com / Ebjerrum / SMILES enumeration."}, {"heading": "Molecular dataset", "text": "The data set was extracted from Sutherland et al 2003.15. It consists of 756 dihydrofolate inhibitors with P. carinii DHFR inhibition data. The data set was divided in a test and a training set in a ratio of 1: 9. It was supplemented with the SMILES enumeration and the SMILES strings were padded with spaces to a fixed length of 74, which is one character longer than the longest SMILES in the data set. Subsequently, it was vectorized into a bit matrix by uniform encoding of the characters, with one bit set for the corresponding character in each line using a generated dictionary from char to int. Molecules where the associated affinity was not a number were removed. The associated IC50 data were converted to IC50 and set to standard variance and mean zero using tools from Scikit-Learn.16"}, {"heading": "LSTM neural network", "text": "Two different neural networks were built and trained using Kera version 1.1.217 with Theano v. 0.8.0 18 as the backend, one or more LSTM layers were used in batch mode, and the final state was fed into an advanced neural network with a single linear output neuron. Network layout was optimized by implementing Bayesian optimization using Gaussian processes as in the Python package GpyOpt19 version 1.0.3, varying the hyperparameters listed in Table 1. 10 initial training sessions were conducted prior to using the GP _ MCMC and the EI _ MCMC capture function to capture new hyperparameter sets. 20 One network was optimized and trained using only a dataset of canonical SMILES, while the others were optimized and trained using the dataset that was expanded with SMILES enumeration and the EI _ MCMC capture function to capture new hyper sets."}, {"heading": "Results", "text": "Filtering, splitting and enumerating SMILES 84 resulted in a canonical SMILES dataset with 602 tensile molecules and 71 test molecules, while the enumerated dataset had 79143 and 9412 lines for tensile and test, corresponding to an augmentation factor of about 130. Each molecule had an average of 130 alternative SMILES representations. Architecture optimization yielded two different best configurations of hyperparameters, depending on the dataset used. The best hyperparameters found for each dataset are shown in Table 2.The train history is shown in Figure 2.The best neural networks trained on the canonical datasets had a loss of 0.44 including regulatory penalty and a mean square error of 0.22 and 0.41 for tensile and test set. The curves for training with the canonical dataset are very noisy."}, {"heading": "Discussion", "text": "This year, it is at an all-time high in the history of the European Union."}, {"heading": "Conclusion", "text": "This brief investigation has shown that the use of the SMILES enumeration as a data extension technology for QSAR models of neural networks based on SMILES data is promising; the SMILES enumeration allows the use of more limited sizes of marked data sets for modeling by more complex neural network models; the SMILES enumeration provides more robust QSAR models both in predicting individual SMILES, but even more when using the average prediction for the same molecule using enumerated SMILES. The SMILES enumeration code and some of the scripts used to generate the LSTM QSAR models are available on GitHub: https: / / github.com / Ebjerrum / SMILES enumeration"}, {"heading": "Conflicts of Interest", "text": "E. J. Bjerrum is the owner of Wildcard Pharmaceutical Consulting. The company is normally contracted by biotechnology / pharmaceutical companies to provide services to third parties."}], "references": [{"title": "Best Practices for Convolutional Neural Networks Applied to Visual Document Analysis.", "author": ["P.Y. Simard", "D. Steinkraus", "J.C. Platt"], "venue": null, "citeRegEx": "Simard et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Simard et al\\.", "year": 2003}, {"title": "Deep neural networks for acoustic modeling in speech recognition: The shared views of four research groups", "author": ["G. Hinton", "L. Deng", "D. Yu", "G.E. Dahl", "A.-r. Mohamed", "N. Jaitly", "A. Senior", "V. Vanhoucke", "P. Nguyen", "T.N. Sainath"], "venue": "IEEE Signal Processing Magazine 2012,", "citeRegEx": "Hinton et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Hinton et al\\.", "year": 2012}, {"title": "DeepTox: toxicity prediction using deep learning", "author": ["A. Mayr", "G. Klambauer", "T. Unterthiner", "S. Hochreiter"], "venue": "Frontiers in Environmental Science 2016,", "citeRegEx": "Mayr et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Mayr et al\\.", "year": 2016}, {"title": "Return of the devil in the details: Delving deep into convolutional nets arXiv preprint arXiv:1405.3531", "author": ["K. Chatfield", "K. Simonyan", "A. Vedaldi", "A. Zisserman"], "venue": null, "citeRegEx": "Chatfield et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Chatfield et al\\.", "year": 2014}, {"title": "Data Augmentation for Deep Neural Network", "author": ["X. Cui", "V. Goel", "B. Kingsbury"], "venue": "Acoustic Modeling IEEE/ACM Trans. Audio, Speech and Lang. Proc. 2015,", "citeRegEx": "Cui et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Cui et al\\.", "year": 2015}, {"title": "Deep learning in neural networks: An overview", "author": ["J. Schmidhuber"], "venue": "Neural networks 2015,", "citeRegEx": "Schmidhuber,? \\Q2015\\E", "shortCiteRegEx": "Schmidhuber", "year": 2015}, {"title": "Review of advances in neural networks: Neural design technology stack", "author": ["A.-D. Alm\u00e1si", "S. Wo\u017aniak", "V. Cristea", "Y. Leblebici", "T. Engbersen"], "venue": "Neurocomputing 2016,", "citeRegEx": "Alm\u00e1si et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Alm\u00e1si et al\\.", "year": 2016}, {"title": "Molecular graph convolutions: moving beyond fingerprints", "author": ["S. Kearnes", "K. McCloskey", "M. Berndl", "V. Pande", "P. Riley"], "venue": "Journal of computer-aided molecular design 2016,", "citeRegEx": "Kearnes et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Kearnes et al\\.", "year": 2016}, {"title": "Automatic chemical design using a data-driven continuous representation of molecules arXiv preprint arXiv:1610.02415", "author": ["R. G\u00f3mez-Bombarelli", "D. Duvenaud", "J.M. Hern\u00e1ndez-Lobato", "J. Aguilera-Iparraguirre", "T.D. Hirzel", "R.P. Adams", "A. Aspuru-Guzik"], "venue": null, "citeRegEx": "G\u00f3mez.Bombarelli et al\\.,? \\Q2016\\E", "shortCiteRegEx": "G\u00f3mez.Bombarelli et al\\.", "year": 2016}, {"title": "Towards a Universal SMILES representation - A standard method to generate canonical SMILES based on the InChI", "author": ["N.M. O'Boyle"], "venue": "Journal of cheminformatics 2012,", "citeRegEx": "O.Boyle,? \\Q2012\\E", "shortCiteRegEx": "O.Boyle", "year": 2012}, {"title": "Target-dependent sentiment classification with long short term memory CoRR, abs/1512.01100", "author": ["D. Tang", "B. Qin", "X. Feng", "T. Liu"], "venue": null, "citeRegEx": "Tang et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Tang et al\\.", "year": 2015}, {"title": "RDKit: Open-Source Cheminformatics Software", "author": ["G.A. Landrum"], "venue": "http://www.rdkit.org/, https://github.com/rdkit/rdkit (accessed Dec 22,", "citeRegEx": "Landrum,? \\Q2016\\E", "shortCiteRegEx": "Landrum", "year": 2016}, {"title": "Spline-fitting with a genetic algorithm: a method for developing classification structure-activity relationships", "author": ["J.J. Sutherland", "L.A. O'Brien", "D.F. Weaver"], "venue": "Journal of chemical information and computer sciences 2003,", "citeRegEx": "Sutherland et al\\.,? \\Q1915\\E", "shortCiteRegEx": "Sutherland et al\\.", "year": 1915}, {"title": "A Python framework for fast computation of mathematical expressions arXiv e-prints 2016", "author": ["S.R. Subramanyam", "J. Sygnowski", "J. Tanguay", "G. van Tulder", "J. Turian", "S. Urban", "P. Vincent", "F. Visin", "H. de Vries", "D. Warde-Farley", "D.J. Webb", "M. Willson", "K. Xu", "L. Xue", "L. Yao", "S. Zhang", "Y. Theano Zhang"], "venue": null, "citeRegEx": "Subramanyam et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Subramanyam et al\\.", "year": 2016}, {"title": "GPyOpt: A Bayesian Optimization framework in Python 2016", "author": ["G. T"], "venue": null, "citeRegEx": "T.,? \\Q2016\\E", "shortCiteRegEx": "T.", "year": 2016}, {"title": "MCMC methods for Gaussian process models using fast approximations for the likelihood arXiv preprint arXiv:1305.2235", "author": ["C. Wang", "R.M. Neal"], "venue": null, "citeRegEx": "Wang and Neal,? \\Q2013\\E", "shortCiteRegEx": "Wang and Neal", "year": 2013}, {"title": "Large-scale QSAR study of aromatase inhibitors using SMILES-based descriptors Chemometrics and Intelligent Laboratory Systems", "author": ["A. Worachartcheewan", "P. Mandi", "V. Prachayasittikul", "A.P. Toropova", "A.A. Toropov", "C. Nantasenamat"], "venue": null, "citeRegEx": "Worachartcheewan et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Worachartcheewan et al\\.", "year": 2014}, {"title": "CORAL software: prediction of carcinogenicity of drugs by means of the Monte Carlo method", "author": ["A.P. Toropova", "A.A. Toropov"], "venue": "European Journal of Pharmaceutical Sciences 2014,", "citeRegEx": "Toropova and Toropov,? \\Q2014\\E", "shortCiteRegEx": "Toropova and Toropov", "year": 2014}, {"title": "Topological torsion: a new molecular descriptor for SAR applications. Comparison with other descriptors", "author": ["R. Nilakantan", "N. Bauman", "J.S. Dixon", "R. Venkataraghavan"], "venue": "Journal of Chemical Information and Computer Sciences", "citeRegEx": "Nilakantan et al\\.,? \\Q1987\\E", "shortCiteRegEx": "Nilakantan et al\\.", "year": 1987}, {"title": "Atom pairs as molecular features in structureactivity studies: definition and applications", "author": ["R.E. Carhart", "D.H. Smith", "R. Venkataraghavan"], "venue": "Journal of Chemical Information and Computer Sciences 1985,", "citeRegEx": "Carhart et al\\.,? \\Q1985\\E", "shortCiteRegEx": "Carhart et al\\.", "year": 1985}, {"title": "Low Data Drug Discovery with Oneshot Learning arXiv preprint arXiv:1611.03199", "author": ["H. Altae-Tran", "B. Ramsundar", "A.S. Pappu", "V. Pande"], "venue": null, "citeRegEx": "Altae.Tran et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Altae.Tran et al\\.", "year": 2016}, {"title": "Convolutional networks on graphs for learning molecular fingerprints", "author": ["D.K. Duvenaud", "D. Maclaurin", "J. Iparraguirre", "R. Bombarell", "T. Hirzel", "A. Aspuru-Guzik", "R.P. Adams"], "venue": null, "citeRegEx": "Duvenaud et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Duvenaud et al\\.", "year": 2015}], "referenceMentions": [], "year": 2017, "abstractText": "Simplified Molecular Input Line Entry System (SMILES) is a single line text representation of a unique molecule. One molecule can however have multiple SMILES strings, which is a reason that canonical SMILES have been defined, which ensures a one to one correspondence between SMILES string and molecule. Here the fact that multiple SMILES represent the same molecule is explored as a technique for data augmentation of a molecular QSAR dataset modeled by a long short term memory (LSTM) cell based neural network. The augmented dataset was 130 times bigger than the original. The network trained with the augmented dataset shows better performance on a test set when compared to a model built with only one canonical SMILES string per molecule. The correlation coefficient R on the test set was improved from 0.56 to 0.66 when using SMILES enumeration, and the root mean square error (RMS) likewise fell from 0.62 to 0.55. The technique also works in the prediction phase. By taking the average per molecule of the predictions for the enumerated SMILES a further improvement to a correlation coefficient of 0.68 and a RMS of 0.52 was found.", "creator": "Writer"}}}