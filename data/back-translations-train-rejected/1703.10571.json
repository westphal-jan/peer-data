{"id": "1703.10571", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "30-Mar-2017", "title": "Bootstrapping Labelled Dataset Construction for Cow Tracking and Behavior Analysis", "abstract": "This paper introduces a new approach to the long-term tracking of an object in a challenging environment. The object is a cow and the environment is an enclosure in a cowshed. Some of the key challenges in this domain are a cluttered background, low contrast and high similarity between moving objects which greatly reduces the efficiency of most existing approaches, including those based on background subtraction. Our approach is split into object localization, instance segmentation, learning and tracking stages. Our solution is compared to a range of semi-supervised object tracking algorithms and we show that the performance is strong and well suited to subsequent analysis. We present our solution as a first step towards broader tracking and behavior monitoring for cows in precision agriculture with the ultimate objective of early detection of lameness.", "histories": [["v1", "Thu, 30 Mar 2017 17:09:39 GMT  (3121kb,D)", "http://arxiv.org/abs/1703.10571v1", null]], "reviews": [], "SUBJECTS": "cs.CV cs.AI cs.LG", "authors": ["aram ter-sarkisov", "robert ross", "john kelleher"], "accepted": false, "id": "1703.10571"}, "pdf": {"name": "1703.10571.pdf", "metadata": {"source": "CRF", "title": "Bootstrapping Labelled Dataset Construction for Cow Tracking and Behavior Analysis", "authors": ["Aram Ter-Sarkisov", "Robert Ross", "John Kelleher"], "emails": ["453615@dit.ie"], "sections": [{"heading": null, "text": "In fact, most of them are able to determine for themselves what they want to do and what they want to do."}, {"heading": "II. PREVIOUS WORK", "text": "The use of computer vision in the monitoring of animals has a diverse history. Instead of conducting a comprehensive review of all this work, we instead focus on the challenge at hand, i.e., the specific case of behavior trackingar Xiv: 170 3.10 571v 1 [cs.C] 30 Mar 201 7for bovines. Until now, there was no direct overlap in the literature between object tracking and behavior-based lameness from the video. However, there have been attempts to use machine learning algorithms such as support machines (SVM) to predict the lameness and lameness from the video."}, {"heading": "III. APPROACH OVERVIEW", "text": "In our work, we have been interested in automated strapping of marked data sets to reduce the cost and technical challenges associated with building a large labeled data set that can be used, for example, with deep learning methods. Our approach to building this data set is to build a predictive model that can track a particular cow through the video. We use a random forest classifier to track this tracking model. The first step is to select the cow in the video to be tracked by drawing a bounding box around that cow to understand how the various components in our approach interact. Our approach to building a tracking model for a given cow involves a number of steps. The first step is to select the cow in the video to be tracked."}, {"heading": "IV. DATASETS", "text": "This year, it has come to the point where it only takes one year to get there, it has come to the point where in the first half of the year, in the second half of the year, in the second half of the year, in the second half of the year, in the second half of the year, in the first half of the year, in the second half of the year, in the second half of the year, in the second half of the year, in the third half of the year, in the second half of the year, in the second half of the year."}, {"heading": "V. METHOD", "text": "An essential feature of many tracking algorithms is the dependence on the contrast between the tracked object and the background, confusing as it may be. This poses a particular challenge for our project, since the pixel intensity (hence the color) of large areas of the background such as the floor, watering holes, metal grills, and paths between enclosures of many dark-skinned cows are very similar. Similarly, light-skinned cows are easily confused with light spots that penetrate through cracks in the wall and ceiling. Another problem is that cows are essentially similar in color, so it is extremely difficult for a tracking algorithm to distinguish between two brown cows, especially when one of them blocks the other from the camera perspective. Therefore, the basic idea of our approach is to extract contours of the tracked object rather than the background. As explained in Section III, the algorithm consists of two steps: the first one consists of segmentation, the second phase of extraction, and the second phase of extraction and the validation is presented in Extraction 4."}, {"heading": "A. Framewise cow instance segmentation", "text": "The fact is that we see ourselves in a position to be in, and that we are in a position to be able to put ourselves in another world, in a world in which we are in, in which we are in, in which we are in, in which we are in a position, in which we are in, in which we are in which we are in, in which we are in which we are in."}, {"heading": "B. Feature Extraction", "text": "We combine this process with a simple 1-Nearest Neighbor (1NN) tracking method to automate feature extraction from instances identified in the first stage of processing. In the very first frame of the sequence, we select the cow we want to track and assign its label to 1; all other objects are labeled with 0. For all other frames, once we have all instances in that frame, we get a simple distance matrix where the number of rows is equal to the number of instances in the current frame, and the number of columns is equal to the number of labeled instances in the previous frame, so each entry in the matrix is a distance from each instance in that frame to each labeled instance in the previous frame. Once we have this instance in that frame, we assign each instance in that frame to the labeling of the next instance in the previous frame."}, {"heading": "C. Training", "text": "We chose the Random Forest (RF) classifier, to which Breiman is attributed [26], to learn the features. Originally, the percentage of positive (cow) observations tracked was about 16% in each training. To provide the classifier with more data, we sampled about 50% of negative (distracting cow) observations, increasing the positive data to about one-third of the training database. Since the data is essentially a time series, we train the algorithm on the first K observations and validate on the remaining K observations. The second contribution of this paper, after the segmentation algorithm, is the optimization of a classifier based on training, validation and test results. We found that the RF with 300 trees, the cross-entropy error function, the use of all features during training, with bootstrap-out-of-job-sampling to make the best generalization of our data."}, {"heading": "VI. RESULTS", "text": "The results of the test of the RF classifier, precision and recall, are summarized in Tables II and III. The test sets taken from the same video differ from the above mentioned training sets in several respects: There are many problems an algorithm has to deal with, such as full and partial exclusion, poor lighting, low contrast, cluttered background and others. To compare, we use the five trackers mentioned above: TLD, MIL, KCF, MedianFlow and Boosting for each test set. In three data sets, our approach achieves the highest precision and in two - the highest recall rate. Its strength is particularly evident in ch0106092015115543 and ch0915062015120155, where the tracked cow moves. Others either lose it immediately (like TLD in ch0106092015115543) or confuse it with the background as soon as the cow leaves the tracking area."}, {"heading": "VII. DISCUSSION AND FUTURE WORK", "text": "In this article, we have introduced a new tracking algorithm designed for tracking malleable objects (cows) in a challenging environment (cages in a cowshed).The ultimate goal of this project is to detect lameness in cows at an early stage; successful cow tracking is the first step in this project.This article includes three main directions: 1) Framework instance segmentation, 2) Optimal Random Forest algorithm, 3) Building a large dataset to further analyze the behavior of cows From here, there are three main directions in which we would like to advance the development of this algorithm:"}], "references": [{"title": "Effect of lameness on the calving-to-conception interval in dairy cows", "author": ["J. Hernandez", "J.K. Shearer", "D.W. Webb"], "venue": "Journal of the American veterinary medical association, vol. 218, no. 10, pp. 1611\u20131614, 2001. 1", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2001}, {"title": "Applying additive logistic regression to data derived from sensors monitoring behavioral and physiological characteristics of dairy cows to detect lameness", "author": ["C. Kamphuis", "E. Frank", "J. Burke", "G. Verkerk", "J. Jago"], "venue": "Journal of dairy science, vol. 96, no. 11, pp. 7043\u20137053, 2013. 1", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2013}, {"title": "Lameness in tied danish dairy cattle: the possible influence of housing systems, management, milk yield, and prior incidents of lameness", "author": ["L. Alban", "J. Agger", "L. Lawson"], "venue": "Preventive veterinary medicine, vol. 29, no. 2, pp. 135\u2013149, 1996. 1", "citeRegEx": "4", "shortCiteRegEx": null, "year": 1996}, {"title": "A probabilistic neural network model for lameness detection", "author": ["M. Pastell", "M. Kujala"], "venue": "Journal of dairy science, vol. 90, no. 5, pp. 2283\u2013 2292, 2007. 1", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2007}, {"title": "Cow behaviour pattern recognition using a threedimensional accelerometer and support vector machines", "author": ["P. Martiskainen", "M. J\u00e4rvinen", "J.-P. Sk\u00f6n", "J. Tiirikainen", "M. Kolehmainen", "J. Mononen"], "venue": "Applied Animal Behaviour Science, vol. 119, no. 1, pp. 32\u201338, 2009. 1", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2009}, {"title": "Real-time automatic lameness detection based on back posture extraction in dairy cattle: Shape analysis of cow with image processing techniques", "author": ["A. Poursaberi", "C. Bahr", "A. Pluk", "A. Van Nuffel", "D. Berckmans"], "venue": "Computers and Electronics in Agriculture, vol. 74, no. 1, pp. 110\u2013119, 2010. 1, 2", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2010}, {"title": "Automatic detection of lameness in dairy cattlevision-based  trackway analysis in cow\u2019s locomotion", "author": ["X. Song", "T. Leroy", "E. Vranken", "W. Maertens", "B. Sonck", "D. Berckmans"], "venue": "Computers and electronics in agriculture, vol. 64, no. 1, pp. 39\u201344, 2008. 1, 2", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2008}, {"title": "Behaviour of lame cows: a review", "author": ["J. Olechnowicz", "J. Jaskowski"], "venue": "Veterinarni Medicina, vol. 56, no. 12, pp. 581\u2013588, 2011. 1", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2011}, {"title": "Electronic detection of lameness in dairy cows through measuring pedometric activity and lying behavior", "author": ["M. Alsaaod", "C. R\u00f6mer", "J. Kleinmanns", "K. Hendriksen", "S. Rose- Meierh\u00f6fer", "L. Pl\u00fcmer", "W. B\u00fcscher"], "venue": "Applied Animal Behaviour Science, vol. 142, no. 3, pp. 134\u2013 141, 2012. 1", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2012}, {"title": "Automatic real-time monitoring of locomotion and posture behaviour of pregnant cows prior to calving using online image analysis", "author": ["\u00d6. Cangar", "T. Leroy", "M. Guarino", "E. Vranken", "R. Fallon", "J. Lenehan", "J. Mee", "D. Berckmans"], "venue": "Computers and electronics in agriculture, vol. 64, no. 1, pp. 53\u201360, 2008. 1", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2008}, {"title": "Tracking-learning-detection", "author": ["Z. Kalal", "K. Mikolajczyk", "J. Matas"], "venue": "IEEE transactions on pattern analysis and machine intelligence, vol. 34, no. 7, pp. 1409\u20131422, 2012. 2", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2012}, {"title": "Forward-backward error: Automatic detection of tracking failures", "author": ["\u2014\u2014"], "venue": "Pattern recognition (ICPR), 2010 20th international conference on. IEEE, 2010, pp. 2756\u20132759. 2", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2010}, {"title": "Visual tracking with online multiple instance learning", "author": ["B. Babenko", "M.-H. Yang", "S. Belongie"], "venue": "Computer Vision and Pattern Recognition, 2009. CVPR 2009. IEEE Conference on. IEEE, 2009, pp. 983\u2013990. 2", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2009}, {"title": "Robust object tracking with online multiple instance learning", "author": ["\u2014\u2014"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 33, no. 8, pp. 1619\u20131632, 2011. 2", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2011}, {"title": "Miforests: Multiple-instance  learning with randomized trees", "author": ["C. Leistner", "A. Saffari", "H. Bischof"], "venue": "European Conference on Computer Vision. Springer, 2010, pp. 29\u201342. 2", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2010}, {"title": "Kernel-based object tracking", "author": ["D. Comaniciu", "V. Ramesh", "P. Meer"], "venue": "IEEE Transactions on pattern analysis and machine intelligence, vol. 25, no. 5, pp. 564\u2013577, 2003. 2", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2003}, {"title": "Exploiting the circulant structure of tracking-by-detection with kernels", "author": ["J.F. Henriques", "R. Caseiro", "P. Martins", "J. Batista"], "venue": "European conference on computer vision. Springer, 2012, pp. 702\u2013715. 2", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2012}, {"title": "High-speed tracking with kernelized correlation filters", "author": ["\u2014\u2014"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 37, no. 3, pp. 583\u2013596, 2015. 2", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2015}, {"title": "Hierarchical convolutional features for visual tracking", "author": ["C. Ma", "J.-B. Huang", "X. Yang", "M.-H. Yang"], "venue": "Proceedings of the IEEE International Conference on Computer Vision, 2015, pp. 3074\u20133082. 2", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2015}, {"title": "Very deep convolutional networks for large-scale image recognition", "author": ["K. Simonyan", "A. Zisserman"], "venue": "arXiv preprint arXiv:1409.1556, 2014. 2, 4", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2014}, {"title": "Conditional random fields as recurrent neural networks", "author": ["S. Zheng", "S. Jayasumana", "B. Romera-Paredes", "V. Vineet", "Z. Su", "D. Du", "C. Huang", "P.H. Torr"], "venue": "Proceedings of the IEEE International Conference on Computer Vision, 2015, pp. 1529\u20131537. 2, 4", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2015}, {"title": "Holistically-nested edge detection", "author": ["S. Xie", "Z. Tu"], "venue": "Proceedings of the IEEE International Conference on Computer Vision, 2015, pp. 1395\u20131403. 2, 4", "citeRegEx": "23", "shortCiteRegEx": null, "year": 2015}, {"title": "Picture thresholding using an iterative selection method", "author": ["T. Ridler", "S. Calvard"], "venue": "IEEE Trans Syst Man Cybern, vol. 8, no. 8, pp. 630\u2013632, 1978. 2, 4", "citeRegEx": "24", "shortCiteRegEx": null, "year": 1978}, {"title": "Fully convolutional networks for semantic segmentation", "author": ["J. Long", "E. Shelhamer", "T. Darrell"], "venue": "Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, 2015, pp. 3431\u20133440. 4", "citeRegEx": "25", "shortCiteRegEx": null, "year": 2015}, {"title": "Random forests", "author": ["L. Breiman"], "venue": "Machine learning, vol. 45, no. 1, pp. 5\u201332, 2001. 5", "citeRegEx": "26", "shortCiteRegEx": null, "year": 2001}, {"title": "Long short-term memory", "author": ["S. Hochreiter", "J. Schmidhuber"], "venue": "Neural computation, vol. 9, no. 8, pp. 1735\u20131780, 1997. 6", "citeRegEx": "27", "shortCiteRegEx": null, "year": 1997}], "referenceMentions": [{"referenceID": 0, "context": "Lack of adequate treatment can lead to substantial losses for farms and reduced well-being for animals [1], [2].", "startOffset": 108, "endOffset": 111}, {"referenceID": 1, "context": "These methods range from regressions and longitudinal studies ([3], [4]) through to neural networks and support vector machines [5], [6], [7].", "startOffset": 63, "endOffset": 66}, {"referenceID": 2, "context": "These methods range from regressions and longitudinal studies ([3], [4]) through to neural networks and support vector machines [5], [6], [7].", "startOffset": 68, "endOffset": 71}, {"referenceID": 3, "context": "These methods range from regressions and longitudinal studies ([3], [4]) through to neural networks and support vector machines [5], [6], [7].", "startOffset": 128, "endOffset": 131}, {"referenceID": 4, "context": "These methods range from regressions and longitudinal studies ([3], [4]) through to neural networks and support vector machines [5], [6], [7].", "startOffset": 133, "endOffset": 136}, {"referenceID": 5, "context": "These methods range from regressions and longitudinal studies ([3], [4]) through to neural networks and support vector machines [5], [6], [7].", "startOffset": 138, "endOffset": 141}, {"referenceID": 5, "context": "knowledge, previous video recordings for lameness detection were performed in open space with good contrast between the background and the object, as in [7], [8] over a short period of time.", "startOffset": 153, "endOffset": 156}, {"referenceID": 6, "context": "knowledge, previous video recordings for lameness detection were performed in open space with good contrast between the background and the object, as in [7], [8] over a short period of time.", "startOffset": 158, "endOffset": 161}, {"referenceID": 7, "context": "While each of these can in principle be analyzed through video, we suggest that analysis of behavior is particularly interesting, because difference in behavior between lame and so-called sound cows has been observed extensively ([9], [10], [3], [11]).", "startOffset": 230, "endOffset": 233}, {"referenceID": 8, "context": "While each of these can in principle be analyzed through video, we suggest that analysis of behavior is particularly interesting, because difference in behavior between lame and so-called sound cows has been observed extensively ([9], [10], [3], [11]).", "startOffset": 235, "endOffset": 239}, {"referenceID": 1, "context": "While each of these can in principle be analyzed through video, we suggest that analysis of behavior is particularly interesting, because difference in behavior between lame and so-called sound cows has been observed extensively ([9], [10], [3], [11]).", "startOffset": 241, "endOffset": 244}, {"referenceID": 9, "context": "While each of these can in principle be analyzed through video, we suggest that analysis of behavior is particularly interesting, because difference in behavior between lame and so-called sound cows has been observed extensively ([9], [10], [3], [11]).", "startOffset": 246, "endOffset": 250}, {"referenceID": 5, "context": "In [7] cow\u2019s backposture was", "startOffset": 3, "endOffset": 6}, {"referenceID": 6, "context": "Earlier work [8] showed that cow\u2019s movement (locomotion) was examined in a manner similar to [7].", "startOffset": 13, "endOffset": 16}, {"referenceID": 5, "context": "Earlier work [8] showed that cow\u2019s movement (locomotion) was examined in a manner similar to [7].", "startOffset": 93, "endOffset": 96}, {"referenceID": 10, "context": "Semi-supervised algorithms include Tracking-Learning-Detection (TLD), developed by Kalal et al, [12], a related Median Flow algorithm, also by Kalal et al, [13], Multiple Instance Learning (MIL) ([14], [15]) with an extension built upon random forests, [16].", "startOffset": 96, "endOffset": 100}, {"referenceID": 11, "context": "Semi-supervised algorithms include Tracking-Learning-Detection (TLD), developed by Kalal et al, [12], a related Median Flow algorithm, also by Kalal et al, [13], Multiple Instance Learning (MIL) ([14], [15]) with an extension built upon random forests, [16].", "startOffset": 156, "endOffset": 160}, {"referenceID": 12, "context": "Semi-supervised algorithms include Tracking-Learning-Detection (TLD), developed by Kalal et al, [12], a related Median Flow algorithm, also by Kalal et al, [13], Multiple Instance Learning (MIL) ([14], [15]) with an extension built upon random forests, [16].", "startOffset": 196, "endOffset": 200}, {"referenceID": 13, "context": "Semi-supervised algorithms include Tracking-Learning-Detection (TLD), developed by Kalal et al, [12], a related Median Flow algorithm, also by Kalal et al, [13], Multiple Instance Learning (MIL) ([14], [15]) with an extension built upon random forests, [16].", "startOffset": 202, "endOffset": 206}, {"referenceID": 14, "context": "Semi-supervised algorithms include Tracking-Learning-Detection (TLD), developed by Kalal et al, [12], a related Median Flow algorithm, also by Kalal et al, [13], Multiple Instance Learning (MIL) ([14], [15]) with an extension built upon random forests, [16].", "startOffset": 253, "endOffset": 257}, {"referenceID": 15, "context": "Kernel-based algorithms use a Kernel filter for similarity measure: [17].", "startOffset": 68, "endOffset": 72}, {"referenceID": 16, "context": "One of the most recent approaches is Kernelized Correlation filter (KCF) by Henriques et al, [18], [19], that employs circulant matrices, several types of kernels (Gaussian, Linear, Ridge) and Fast Fourier Transform to learn a set of dense samples (all subwindows) from the tracked object.", "startOffset": 93, "endOffset": 97}, {"referenceID": 17, "context": "One of the most recent approaches is Kernelized Correlation filter (KCF) by Henriques et al, [18], [19], that employs circulant matrices, several types of kernels (Gaussian, Linear, Ridge) and Fast Fourier Transform to learn a set of dense samples (all subwindows) from the tracked object.", "startOffset": 99, "endOffset": 103}, {"referenceID": 18, "context": "deep learning algorithms, such as Convolutional Neural Nets (ConvNN) were adapted for tracking tasks by Ma et al in [20].", "startOffset": 116, "endOffset": 120}, {"referenceID": 19, "context": "These ConvNNs use a popular VGG-Net-19 architecture ([21]).", "startOffset": 53, "endOffset": 57}, {"referenceID": 20, "context": "When processing each frame we first apply a model called CRFasRNN [22] to localize blobs of pixels that", "startOffset": 66, "endOffset": 70}, {"referenceID": 21, "context": "Because of this ambiguity, we then apply an edge detector called HED [23] followed by a thresholding method (ISODATA [24]) and this process isolates instances of cows within each blob.", "startOffset": 69, "endOffset": 73}, {"referenceID": 22, "context": "Because of this ambiguity, we then apply an edge detector called HED [23] followed by a thresholding method (ISODATA [24]) and this process isolates instances of cows within each blob.", "startOffset": 117, "endOffset": 121}, {"referenceID": 20, "context": "by Zheng et al in [22].", "startOffset": 18, "endOffset": 22}, {"referenceID": 23, "context": "This is a combination of a fully convolutional network (FCN, see [25]) and a conditional random field (CRF) with a layout of a recurrent neural", "startOffset": 65, "endOffset": 69}, {"referenceID": 19, "context": "ConvNN\u2019s architecture used for our approach is FCN-8, which is based on VGG-16 ([21]).", "startOffset": 80, "endOffset": 84}, {"referenceID": 21, "context": "Nested Edge Detector (HED), recently introduced by Xie and Tu in [23] performs strongly by filtering out most of the noise in the image.", "startOffset": 65, "endOffset": 69}, {"referenceID": 22, "context": "We do this by using the threshold detection algorithm ISODATA, introduced by Ridler and Calvard in [24].", "startOffset": 99, "endOffset": 103}, {"referenceID": 24, "context": "We selected the Random Forest (RF) classifier, attributed to Breiman [26] to learn the features.", "startOffset": 69, "endOffset": 73}, {"referenceID": 25, "context": "this purpose we will be training a large deep learning algorithm like LSTM ([27]) or a similar recurrent neural network.", "startOffset": 76, "endOffset": 80}], "year": 2017, "abstractText": "This paper introduces a new approach to the longterm tracking of an object in a challenging environment. The object is a cow and the environment is an enclosure in a cowshed. Some of the key challenges in this domain are a cluttered background, low contrast and high similarity between moving objects \u2013 which greatly reduces the efficiency of most existing approaches, including those based on background subtraction. Our approach is split into object localization, instance segmentation, learning and tracking stages. Our solution is benchmarked against a range of semi-supervised object tracking algorithms and we show that the performance is strong and well suited to subsequent analysis. We present our solution as a first step towards broader tracking and behavior monitoring for cows in precision agriculture with the ultimate objective of early detection of lameness.", "creator": "LaTeX with hyperref package"}}}