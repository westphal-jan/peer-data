{"id": "1704.05708", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "19-Apr-2017", "title": "A Deep Learning Framework using Passive WiFi Sensing for Respiration Monitoring", "abstract": "This paper presents an end-to-end deep learning framework using passive WiFi sensing to classify and estimate human respiration activity. A passive radar test-bed is used with two channels where the first channel provides the reference WiFi signal, whereas the other channel provides a surveillance signal that contains reflections from the human target. Adaptive filtering is performed to make the surveillance signal source-data invariant by eliminating the echoes of the direct transmitted signal. We propose a novel convolutional neural network to classify the complex time series data and determine if it corresponds to a breathing activity, followed by a random forest estimator to determine breathing rate. We collect an extensive dataset to train the learning models and develop reference benchmarks for the future studies in the field. Based on the results, we conclude that deep learning techniques coupled with passive radars offer great potential for end-to-end human activity recognition.", "histories": [["v1", "Wed, 19 Apr 2017 12:35:17 GMT  (1433kb,D)", "http://arxiv.org/abs/1704.05708v1", "7 pages, 11 figures"]], "COMMENTS": "7 pages, 11 figures", "reviews": [], "SUBJECTS": "cs.CV cs.LG", "authors": ["u m khan", "z kabir", "s a hassan", "s h ahmed"], "accepted": false, "id": "1704.05708"}, "pdf": {"name": "1704.05708.pdf", "metadata": {"source": "CRF", "title": "A Deep Learning Framework using Passive WiFi Sensing for Respiration Monitoring", "authors": ["Usman Mahmood Khan", "Zain Kabir", "Syed Ali Hassan", "Syed Hassan Ahmed"], "emails": ["ali.hassan}@seecs.nust.edu.pk", "s.h.ahmed@ieee.org"], "sections": [{"heading": null, "text": "This year, it is only a matter of time before the Presidency of the Council of the European Union enters into force, until the Presidency of the Council of the European Union enters into force."}, {"heading": "A. Related Work", "text": "Kotaru et.al presented an internal localization system using channel state information (CSI) and received signal strength information (RSSI) [13]. Similar approaches have been used for other applications such as keystroke detection [14], home activity analysis [15] and virtual drawing [16]. Some work has been done on the use of active radars to measure respiratory rate [17]. Other similar work includes an ultrawide band radar with short transmission pulses to avoid reflections from surrounding objects [18], a continuous wave (CW), a multifunctional radar system for clinical measurements [19] and a CW radar for the spatial environment [3]. Deep learning techniques using passive WiFi sensors [18], a deep system for human body research [20]."}, {"heading": "II. SYSTEM OVERVIEW", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A. Passive Radar System", "text": "The reference antenna collects the direct signal from the AP, which is later used in the adaptive extinguishing step. The monitoring antenna tracks both the transmitted signal and the deviations caused by human respiratory motion and can be represented as ass [n] = [fd] fD Ax [n + \u03c4] ei2\u03c0fdn, (1) where x [n] is the output signal, \u03c4 is the path delay from AP to the monitoring receiver, A is the signal amplitude, and fD contains a series of Doppler shifts in the monitoring plane. In the simplest case, if there is a single reflection at the monitoring antenna where the monitoring signal deviates from the desired breathing movement, the equation of the monitoring signal to [n] = Ax [n + follow-up] ei2is coupled."}, {"heading": "B. Adaptive Cancellation", "text": "The objective of the adaptive canceller is to eliminate the direct echo of the transmitted signal from the monitoring signal generally known in literature as direct signal attenuation (DSA).The adaptive filter uses an update algorithm with the lowest middle square (LMS) that updates the filter output y [n] based on the following rule: [n] = w \u2032 \u00b7 r [n], (3) where (.) \u2032 denotes the conjugate operator, w defines the weight of the filter and r [n] the reference signal. The error signal of the adaptive filter is calculated by subtracting the filter output from the monitoring signal and specifying the true echo signal of interest. In each iteration, the filter weight coefficient is updated as a follow-up value = w = w + \u00b5 \u00b7 s [n] \u00d7 e [n] \u2032, (4) where \u00b5 is the step width parameter that controls how fast the LMS algorithm converts [23] to the pre-feed signal."}, {"heading": "C. Deep Activity Classification", "text": "Before applying the deep learning model, the raw time series error signal obtained from the previous adaptive filter stage is segmented into a collection of short pieces of signal with a shift window strategy. After segmentation, the dimension of the time series signal is given by 2 \u00d7 R, where R is the number of samples in a single window. Fig. 3, the CNN design for the respiration rate recongition task shows that the sampled I / Q signal is transferred first to convolution layers and then to fully connected layers. In the convolution layers, function cards from the previous layers are connected to several convolution cores with a depth D. Then, a bias value is added and an activation function is applied to the output function cards for the next layer. Specifically, the mapping function card in the ninth layer of CNN is written as vrcmn, where r the data series and c the imaginary channels are represented incorrectly as form classes."}, {"heading": "D. Breathing Rate Estimation", "text": "Once the respiratory activity is identified, the characteristics are extracted from the signal, and the estimate of the respiratory rate is made by the Random Forest algorithm. In general, the nth characteristic corresponding to the m-th operator is given by fnm = Sn (Om (e [n]), (10) where Sn is the statistical moment of the n-th order, and Om is a mathematical operator like the real estimated operator on a complex number. Random Forest differs from a traditional decision tree in that it trains several trees on different parts of the attribute space, ensuring that no tree is exposed to all the training data. Data is recursively divided and each division is made using Gini impurity criteria [25], which in the case of the node N byg (N) = Nl K-k = 1 pkl (1 \u2212 pkl) + Nr K-k = 1 pkl (1 \u2212 pr) + Nr (1 \u2212 pr) is right."}, {"heading": "E. System Range and Limitations", "text": "Fig. 4 shows the radiation patterns of the monitoring antenna in X-Y (horizontal) and X-Z (vertical) planes. As a single antenna with a half-beam width (HPBW) of 72 \u00b0 is proposed in the horizontal plane, the system is unable to detect respiratory patterns when the observer is outside this range. HPBW is comparatively higher in the vertical plane, indicating that the system is able to detect respiratory fluctuations even when the chest of the target is raised above or below the level of the monitoring antenna. III. IMPLEMENTATION"}, {"heading": "A. Dataset", "text": "An important consideration is the size of the sample window, which represents a compromise between model accuracy and model complexity. A typical human adult exhales and inhales 12-18 times per minute. However, this range extends into elderberry and typically lies between 10-30 breaths per minute. To capture sufficient signal variations and separate breathing movement from random movements, a large window size is required, which poses two challenges of increased model complexity and training inconvenience.A compromise can be reached by selecting a window size of 10 seconds, large enough to capture 2-5 breaths per minute, but small enough to comfortably train the model and keep complexity at a manageable level.The data objective 1 consists of three activities that correspond to breathing movement, static environment and random movement (such as movement of the human extremities)."}, {"heading": "B. Network Architecture", "text": "CNN is implemented on Keras, which runs on TensorFlow and offers a modular approach to creating deep networks. CNN consists of a four-layer model with two revolutionary layers and two fully connected layers. For the first three layers, a rectified linear activation function (ReFPU) is used, which is defined asf (x) = max (0, x), with x the input to the ReLU and max operators selecting the argument with the maximum value. The last layer uses a Softmax activation function to predict output activity. After each layer, a standard penalty is added to the conversion layer weights as a regulatory procedure to prevent data overmatching. To create sparse solutions, a standard penalty is added on the activation layer."}, {"heading": "C. Hardware", "text": "The training dataset is generated with GNU Radio and software-defined radios at a sampling rate of 64 KS / s, which is later re-sampled to 400 S / s. Subsequently, the time series signals are split into a test and training dataset in a ten-second sliding window."}, {"heading": "D. Software", "text": "We implement Python blocks in GNU Radio for the use of machine learning modules. CNN training takes place on Keras, which is based on Tensorflow and provides a modular framework for implementing deep networks. Random Forest Classifiers are trained using the Python Scikit Learning Library. The code runs in real time and the display is updated on the Ubuntu console every 2 seconds."}, {"heading": "E. Participants and Ground Truth", "text": "In our experiments, we used a pulse oximeter to determine the basic truth for breathing rate measurements. To increase the diversity of data, we employed 3 people with different fitness conditions, all wearing different outfits (sweaters, T-shirts, etc.)."}, {"heading": "IV. RESULTS", "text": "This section describes the performance of the system in terms of various parameters."}, {"heading": "A. Limitations and Future Work", "text": "Notwithstanding the benefits of deep learning techniques, they require extensive data collection, which may prove difficult for some applications. To meet this challenge, the computer vision community has amassed a number of standard data sets for applications such as autonomous driving, remote sensing, facial recognition, and surveillance, and the radio community could benefit from similar efforts, and this work is a step in that direction. Future work could focus on collecting breathing data in different environments and postures. A more ambitious attempt would be to build a deep CNN model to monitor human breathing while walking or walking. Extensive data collection and a comprehensive CNN model keep this problem within reach. Although current research has focused on only three activities, others can be added in the future without slightly modifying the current model, such as examining conditions such as tremor (a condition in which human hands tremble) and human fall."}, {"heading": "V. CONCLUSION", "text": "In the future, we envision smart homes that are able to monitor human activities and take action when needed. Respiration is one of the key human activities and can be used to monitor a person's stress level and mental state. So far, approaches addressing this area have worked well in a controlled environment, but do not detect when other movements are involved. Furthermore, these techniques work poorly when the environment is changed or new activities are added. This paper examines deep learning as an alternative approach to developing an end-to-end solution for monitoring human respiratory activity. We believe that deep learning marks a transition in passive wireless sensing and could be explored further in future research for a wide range of activities."}], "references": [{"title": "Wireless wrist band pulse oximeter CMS-50FW with software for sleep study", "author": ["C. Guard"], "venue": "http://www.pulseoximeter.org/cms50f.html", "citeRegEx": "3", "shortCiteRegEx": null, "year": 0}, {"title": "Respiration: single or dual-band", "author": ["Vivonoetics"], "venue": "http://vivonoetics.com/products/vivosense/ analyzing/respirationsingle-or-dual-band/", "citeRegEx": "6", "shortCiteRegEx": null, "year": 0}, {"title": "Detection of breathing and heartbeat by using a simple UWB radar system", "author": ["J. Qiuchi", "Y. Jian", "Y. Yinan", "P. Bjorkholm", "T. McKelvey"], "venue": "Antennas and Propagation (EuCAP), 2014", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2014}, {"title": "Wi-Fi based passive human motion sensing for in-home healthcare applications", "author": ["T. Bo", "et. al"], "venue": "Internet of Things (WF-IoT), 2015", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2015}, {"title": "ultimodal learning for classification of solar radio spectrum", "author": ["Z. Chen", "et. al"], "venue": "IEEE International Conference on Systems, Man, and Cybernetics, 2015", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2015}, {"title": "Deep convolutional neural networks on multichannel time series for human activity recognition", "author": ["J.B. Yang", "et. al"], "venue": "IJCAI\u201915 Proceedings of the 24th International Conference on Artificial Intelligence, 2015", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2015}, {"title": "CSI-Based fingerprinting for indoor localization: a deep learning approach", "author": ["X. Wang", "L. Gao", "S. Mao", "S. Pandey"], "venue": "IEEE Transactions on Vehicular Technology, 2016", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2016}, {"title": "Convolutional neural networks for human activity recognition using mobile sensors", "author": ["M. Zeng", "et. al"], "venue": "Mobile Computing, Applications and Services (MobiCASE), 2014", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2014}, {"title": "decimeter level localization using WiFi", "author": ["M. Kotaru", "et. al", "SpotFi"], "venue": "SIGCOMM, 2015.", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2015}, {"title": "Keystroke recognition using WiFi signals", "author": ["K. Ali", "A.X. Liu", "W. Wang", "M. Shahzad"], "venue": "MobiCom, 2015.", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2015}, {"title": "E-eyes: device-free location-oriented activity identification using fine-grained WiFi signatures", "author": ["Y. Wang", "et. al"], "venue": "MobiCom, 2014.", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2014}, {"title": "RF-IDraw: virtual touch screen in the air using RF signals", "author": ["Y. Wang", "et. al"], "venue": "SIGCOMM, 2014.", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2014}, {"title": "3D tracking via body radio reflections", "author": ["F. Adib", "Z. Kabelac", "D. Katabi", "R.C. Miller"], "venue": "Usenix NSDI, 2014.", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2014}, {"title": "Non-contact detection of breathing using a microwave sensor", "author": ["D. Dei", "et. al"], "venue": "Sensors, 2009.", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2009}, {"title": "Detection of breathing and heartbeat by using a simple UWB radar system", "author": ["J. Qiuchi", "Y. Jian", "Y. Yinan", "P. Bjorkholm", "T. McKelvey"], "venue": "Antennas and Propagation (EuCAP), 2014.", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2014}, {"title": "Reading text in the wild with convolutional neural networks", "author": ["M. Jaderberg", "et. al"], "venue": "emphInternational Journal of Computer Vision (IJCV), 2015", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2015}, {"title": "Deep inside convolutional networks: visualising image classification models and saliency maps", "author": ["K. Simonyan", "A. Vedaldi", "A. Zisserman"], "venue": "Proceedings of the International Conference on Learning Representations (ICLR), 2014", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2014}, {"title": "Convolutional radio modulation recognition networks", "author": ["T. O\u2019Shea", "J. Corgan", "T.C. Clancy"], "venue": "International Conference on Engineering Applications of Neural Networks,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2016}, {"title": "LMS algorithm step size adjustment for fast convergence", "author": ["D. Bismor"], "venue": "LMS Algorithm Step Size Adjustment for Fast Convergence, 2012", "citeRegEx": "23", "shortCiteRegEx": null, "year": 2012}, {"title": "Large-margin softmax loss for convolutional neural networks", "author": ["W. Liu", "Y. Wen", "Z. Yu", "M. Yang"], "venue": "Proceedings of the 33 rd International Conference on Machine Learning, 2016", "citeRegEx": "24", "shortCiteRegEx": null, "year": 2016}, {"title": "Learning optimization for decision tree classification of non-categorical data with information gain impurity criterion", "author": ["K.I. Sofeikov", "et. al"], "venue": "International Joint Conference on Neural Networks, 2014", "citeRegEx": "25", "shortCiteRegEx": null, "year": 2014}], "referenceMentions": [{"referenceID": 0, "context": "Human breathing involves continuous inhale and exhale movements and may be used to study the subject\u2019s physiological state, her stress levels, or even emotions like fear and relief [3].", "startOffset": 181, "endOffset": 184}, {"referenceID": 1, "context": "With the advances in wireless sensing, it has become possible to use non-contact devices to determine signs of life [5] [6].", "startOffset": 120, "endOffset": 123}, {"referenceID": 2, "context": "Active radars employ dedicated transmitters, use high bandwidth and often require complex antenna arrays to go along with them [7].", "startOffset": 127, "endOffset": 130}, {"referenceID": 3, "context": "In contrast, passive radars are covert, require low bandwidth and utilize the illuminations of opportunity in the environment such as WiFi and cellular signals for target monitoring [8].", "startOffset": 182, "endOffset": 185}, {"referenceID": 4, "context": "A deep learning network uses a cascade of multiple layers of non-linear processing units, where each successive layer takes the output from the previous layer as an input [9].", "startOffset": 171, "endOffset": 174}, {"referenceID": 5, "context": "At each abstraction level, higher order features are constructed from the lower level features from the previous layers [10].", "startOffset": 120, "endOffset": 124}, {"referenceID": 6, "context": "The convolutional neural network (CNN) is a deep learning model that uses spatial information between the data samples to form learned representations of data [11].", "startOffset": 159, "endOffset": 163}, {"referenceID": 7, "context": "Since convolutional networks have shared weights [12], translation invariance is achieved which means that only the salient features in the data are considered and not their positions or scales.", "startOffset": 49, "endOffset": 53}, {"referenceID": 8, "context": "al presented an indoor localization system using the channel state information (CSI) and received signal strength information (RSSI) [13].", "startOffset": 133, "endOffset": 137}, {"referenceID": 9, "context": "Similar approaches have been used for other applications such as keystroke identification [14], inhome activity analysis [15], and virtual drawing [16].", "startOffset": 90, "endOffset": 94}, {"referenceID": 10, "context": "Similar approaches have been used for other applications such as keystroke identification [14], inhome activity analysis [15], and virtual drawing [16].", "startOffset": 121, "endOffset": 125}, {"referenceID": 11, "context": "Similar approaches have been used for other applications such as keystroke identification [14], inhome activity analysis [15], and virtual drawing [16].", "startOffset": 147, "endOffset": 151}, {"referenceID": 12, "context": "WiZ uses frequency modulated continuous wave (FMCW) signal chirps to detect breathing rate in both line-of-sight (LOS) and non line-of-sight (NLOS) scenarios [17].", "startOffset": 158, "endOffset": 162}, {"referenceID": 13, "context": "Other similar works include an ultra wide-band radar with short transmit pulses to avoid reflections from surrounding objects [18], a continuous wave (CW) radar for clinical measurements [19], and a CW radar for indoor environment [3].", "startOffset": 126, "endOffset": 130}, {"referenceID": 14, "context": "Other similar works include an ultra wide-band radar with short transmit pulses to avoid reflections from surrounding objects [18], a continuous wave (CW) radar for clinical measurements [19], and a CW radar for indoor environment [3].", "startOffset": 187, "endOffset": 191}, {"referenceID": 0, "context": "Other similar works include an ultra wide-band radar with short transmit pulses to avoid reflections from surrounding objects [18], a continuous wave (CW) radar for clinical measurements [19], and a CW radar for indoor environment [3].", "startOffset": 231, "endOffset": 234}, {"referenceID": 5, "context": "al proposed a deep CNN on multichannel time series for human activity recongition using the on-body sensors [10].", "startOffset": 108, "endOffset": 112}, {"referenceID": 15, "context": "With the rise of deep learning techniques in the computer vision domain [20] [21], various radio applications have also begun to capture interest of deep learning researchers.", "startOffset": 72, "endOffset": 76}, {"referenceID": 16, "context": "With the rise of deep learning techniques in the computer vision domain [20] [21], various radio applications have also begun to capture interest of deep learning researchers.", "startOffset": 77, "endOffset": 81}, {"referenceID": 17, "context": "al proposed CNNs for signal modulation recongition [22].", "startOffset": 51, "endOffset": 55}, {"referenceID": 4, "context": "Other researchers have targeted applications like solar radio burst classification [9], and CSIbased fingerprinting for indoor localization [11].", "startOffset": 83, "endOffset": 86}, {"referenceID": 6, "context": "Other researchers have targeted applications like solar radio burst classification [9], and CSIbased fingerprinting for indoor localization [11].", "startOffset": 140, "endOffset": 144}, {"referenceID": 3, "context": "Passive radars use signal of opportunity to track motion changes in the environment [8].", "startOffset": 84, "endOffset": 87}, {"referenceID": 18, "context": "where \u03bc is the step-size parameter that controls how quickly the LMS algorithm converges [23].", "startOffset": 89, "endOffset": 93}, {"referenceID": 19, "context": "The overall model can be trained by using an entropy cost function which is based on the true data labels and the probabilistic outcomes generated through the above softmax function [24].", "startOffset": 182, "endOffset": 186}, {"referenceID": 20, "context": "The data is recursively partitioned and each split is made using Gini impurity criteria [25] which is given at node N by", "startOffset": 88, "endOffset": 92}, {"referenceID": 20, "context": "where pkl is the proportion of class k in the child node left to N , pkr is the proportion of class k in the right node, and Nl and Nr are the left and right children of N , respectively [25].", "startOffset": 187, "endOffset": 191}, {"referenceID": 7, "context": "A ||W ||2 norm penalty is added on the convolution layer weights as a regularization procedure to prevent data over-fitting [12].", "startOffset": 124, "endOffset": 128}, {"referenceID": 7, "context": "To create sparse solutions, an ||h||1 norm penalty is added on the activation layer [12].", "startOffset": 84, "endOffset": 88}, {"referenceID": 15, "context": "These results are validated from the studies in computer vision domain, where the CNN model becomes increasingly robust with an increase in data samples and is able to detect diverse variations of the same image [20][21].", "startOffset": 212, "endOffset": 216}, {"referenceID": 16, "context": "These results are validated from the studies in computer vision domain, where the CNN model becomes increasingly robust with an increase in data samples and is able to detect diverse variations of the same image [20][21].", "startOffset": 216, "endOffset": 220}], "year": 2017, "abstractText": "This paper presents an end-to-end deep learning framework using passive WiFi sensing to classify and estimate human respiration activity. A passive radar test-bed is used with two channels where the first channel provides the reference WiFi signal, whereas the other channel provides a surveillance signal that contains reflections from the human target. Adaptive filtering is performed to make the surveillance signal source-data invariant by eliminating the echoes of the direct transmitted signal. We propose a novel convolutional neural network to classify the complex time series data and determine if it corresponds to a breathing activity, followed by a random forest estimator to determine breathing rate. We collect an extensive dataset to train the learning models and develop reference benchmarks for the future studies in the field. Based on the results, we conclude that deep learning techniques coupled with passive radars offer great potential for end-to-end human activity recognition. Keywords\u2014Deep learning; convolutional neural networks; passive WiFi sensing; human activity classification; breathing rate measurement; adaptive filtering; random forests; SDRs", "creator": "LaTeX with hyperref package"}}}