{"id": "1704.07049", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "24-Apr-2017", "title": "Probabilistic Vehicle Trajectory Prediction over Occupancy Grid Map via Recurrent Neural Network", "abstract": "In this paper, we propose an efficient vehicle trajectory prediction framework based on recurrent neural network. Basically, the characteristic of the vehicle's trajectory is different from that of regular moving objects since it is affected by various latent factors including road structure, traffic rules, and driver's intention. Previous state of the art approaches use sophisticated vehicle behavior model describing these factors and derive the complex trajectory prediction algorithm, which requires a system designer to conduct intensive model optimization for practical use. Our approach is data-driven and simple to use in that it learns complex behavior of the vehicles from the massive amount of trajectory data through deep neural network model. The proposed trajectory prediction method employs the recurrent neural network called long short-term memory (LSTM) to analyze the temporal behavior and predict the future coordinate of the surrounding vehicles. The proposed scheme feeds the sequence of vehicles' coordinates obtained from sensor measurements to the LSTM and produces the probabilistic information on the future location of the vehicles over occupancy grid map. The experiments conducted using the data collected from highway driving show that the proposed method can produce reasonably good estimate of future trajectory.", "histories": [["v1", "Mon, 24 Apr 2017 05:58:33 GMT  (3956kb,D)", "http://arxiv.org/abs/1704.07049v1", null], ["v2", "Fri, 1 Sep 2017 03:04:26 GMT  (5348kb)", "http://arxiv.org/abs/1704.07049v2", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["byeoungdo kim", "chang mook kang", "seung hi lee", "hyunmin chae", "jaekyum kim", "chung choo chung", "jun won choi"], "accepted": false, "id": "1704.07049"}, "pdf": {"name": "1704.07049.pdf", "metadata": {"source": "CRF", "title": "Probabilistic Vehicle Trajectory Prediction over Occupancy Grid Map via Recurrent Neural Network", "authors": ["ByeoungDo Kim", "Chang Mook Kang", "Seung Hi Lee", "Hyunmin Chae", "Jaekyum Kim", "Chung Choo Chung", "Jun Won Choi"], "emails": ["bdkim@spo.hanyang.ac.kr,", "kcm0728@hanyang.ac.kr,", "shlee@ieee.org,", "hmchae@spo.hanyang.ac.kr,", "jkkim@spo.hanyang.ac.kr,", "cchung@hanyang.ac.kr", "junwchoi@hanyang.ac.kr"], "sections": [{"heading": null, "text": "In fact, it is such that most of us are able to survive ourselves without there being a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is a process in which there is"}, {"heading": "II. SYSTEM DESCRIPTION", "text": "In this section we provide the basic system description for the proposed method for predicting the trajectory. Vehicle trajectory Fig. 1 represents the system model for the proposed scheme. The coordinate (x, y) of the vehicle at the time of step t represents the location of the vehicle center relative to the location of the ego vehicle, as shown in Fig. 2. We assume that the coordinate of the ego vehicle is (0, 0) and the coordinate of the vehicle surrounding it at the time of step t is called (x (i) t, y (t) t. We assume that the coordinate information of the vehicle is obtained by processing the measurements from camera, radar and lidar sensors. The trajectory of the vehicle is determined by the sequence of coordinates..., (i) t \u2212 1, y (i) t \u2212 1) t \u2212 1), (x (i) t \u2212 1), y (i) t \u2212 1)."}, {"heading": "B. Occupancy Grid Map", "text": "Essentially, the objective of the current trajectory forecast is to estimate the future coordinate (x (i) t + \u2206, y (t) t + \u2206) based on the previous trajectory data..., (x (i) t \u2212 1, y (i) t \u2212 1), (x (i) t, y (i) t).The proposed system delivers the prediction results in the form of probabilities using the allocation grid map. The allocation grid map is widely used for probabilistic localization and imaging in robotics [13].The allocation grid map is constructed by dividing the area under consideration into Mx \u00d7 My grid elements (see Fig. 3).We determine the grid size so that the grid element covers approximately half the track in the lateral direction and longer distance in the longitudinal direction. Note that the allocation grid map is aligned with the head angle of the ego vehicle, as the coordinates of the vehicles are determined by the sensors of the vehicle."}, {"heading": "III. STRUCTURE OF LSTM", "text": "x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x"}, {"heading": "IV. PROPOSED VEHICLE TRAJECTORY PREDICTION", "text": "In this section, we describe the proposed framework for rail forecasting in detail."}, {"heading": "A. Proposed Trajectory Prediction Technique", "text": "Figure 1 shows the structure of the proposed system. The ego vehicle estimates the current coordinates of the N surrounding vehicles and feeds the estimates into the N LSTMs. Each of these N LSTMs returns the predicted result for each of the N nearest vehicles. Note that the same network parameters are used for all N LSTMs. Since the trajectory information is obtained from the sensors of the ego vehicle, the coordinates of the surrounding vehicle would be affected by the change in the steering angle of the ego vehicle. To compensate for such a coordinate change due to the movement of the ego vehicle, we enter the ego vehicle's yaw rate into the LSTM along with the vehicle coordinates. Note that the ego vehicle's yaw rate is determined using the inertia measuring unit (IMU). It may be necessary to make predictions using different terms, e.g. Lix = 0.5 s, 1.0s and 2.0 s. In this case, we build the LM by performing different STM tasks for each of the STM."}, {"heading": "B. Training of LSTM", "text": "With the help of the vehicle equipped with sensors, the trajectory data for the surrounding vehicles can be collected by long-term driving on real roads. The coordinates of the vehicles can be generated by using the localization algorithm on the basis of sensor fusion. We extract the data for each individual vehicle from the trajectory history of all N nearest vehicles and combine it to generate the training data.The training data containing the trajectory data of each individual vehicle are used to train the single LSTM. We formulate the trajectory prediction problem as a multi-class classification problem in which a grid element occupied by the target vehicle should be selected from among all M grid elements.Considering the order of coordinates... (x (i) t \u2212 1, y (i) t \u2212 1), (i) t \u2212 1), (i) t) for the target vehicle mounted on the grid element of the target element of the grid element of all M \u2212 1, the vehicle is automatically selected (i)."}, {"heading": "V. EXPERIMENTS", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "A. Experiment Description", "text": "In our experiment, we collected training data from hours of highway driving in the suburbs of Seoul, Korea. As a test vehicle, we used a Hyundai Genesis equipped with Delphi long-range radar and a single front camera from Mobileye. Fig. 5 (a) and (b) show the image of the test vehicle or system configuration for data logging. During the ride, the test vehicle captures the sensor measurements that are processed to obtain the relative coordinates of the surrounding vehicles. First-person vehicle yields are also logged in the system. Sample rate for logging coordinate data is 10 ms. However, we found that the data logged every 10 ms is exposed to high noise and is often truncated due to asynchronous sampling. To solve these problems, we synchronized the data by averaging coordinate taps for 100 ms of duration. As a result, all new trajectory data were updated."}, {"heading": "B. System Configurations", "text": "In our system, we consider the allocation grid card with the size (Mx, My) = (18, 11). Each grid element occupies an area of width 1.75 meters and height 10 meters. If a target vehicle exceeds the limit of the allocation grid card, we refer to it as \"outside the limit class.\" In our experiments, we consider three scenarios with \u2206 = 0.5 s, 1.0s and 2.0. We search empirically for the most powerful architecture of the LSTM for each scenario. The LSTM used in the proposed system consists of two layers of cell memory followed by the Softmax layer. The number of nodes on the Softmax layer is MxMy + 1 = 199 (including outside the limit class). The number of nodes in the cell memory was set to 1536, 1280 and 1280 for the scenarios with \u0445 = 0.5 s, 1.0s and 2.0. We set the initial learning rate to 1.0 and gradually decreased it when the validation was set to the minimum size of 0.0005."}, {"heading": "C. Experimental Results", "text": "Since our objective is to predict the coordinate of the vehicle, we need an appropriate power measurement. Since the proposed system establishes the probability of vehicle occupancy, it should also be taken into account in the power measurement. In our experiments, we use the weighted mean of absolute error (MAE) as a performance measurement of the performance of the vehicle (MAE). The proposed mode of operation of the vehicle shows that the weighted mean error rate of the vehicle (MAE) is a performance measurement of the performance of the vehicle (MAE) as a performance measurement of the performance of the performance of the vehicle (MAE). The proposed mode of operation of the vehicle is able to recognize the manner of operation of the vehicle in the direction of operation. (I) The proposed mode of operation of the vehicle is able to recognize the manner of operation of the vehicle in the direction of operation of operation, in the direction of operation of operation of the vehicle, in the direction of operation of operation of the vehicle, in the direction of operation of operation of the vehicle, in the direction of operation of operation of the vehicle. (I) The proposed mode of operation of the vehicle is in the direction of operation of operation of the vehicle, in the direction of operation of operation of the vehicle, in the direction of operation of operation of the vehicle in the direction of operation of operation of operation of the vehicle, in the direction of operation of the direction of operation of operation of the vehicle, in the vehicle in the direction of operation of the direction of operation of operation of the vehicle, in the vehicle in the direction of operation of the direction of operation of operation of the vehicle."}, {"heading": "VI. CONCLUSIONS", "text": "In this thesis, we proposed the method of probabilistic vehicle path prediction based on the LSTM. Using the large amount of trajectory data obtained by processing sensor measurements during long-term travel, we trained the LSTM to learn complex dynamics of movement of the surrounding vehicle and predict its position in the future. We used the occupancy grid map to enable the LSTM to determine the occupancy probability for each lattice element, so that the confidence level for the prediction can be displayed. Our experiments, carried out on the basis of data collected on real motorways, show that the proposed method provides reasonably accurate prediction of the trajectory of the surrounding vehicles."}], "references": [{"title": "A survey on motion prediction and risk assessment for intellgient vehicles", "author": ["S. Lefevre", "D. Vasquez", "C. Laugier"], "venue": "ROBOMECH Journal, vol. 1, no. 1, pp. 1-14, 2014.", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2014}, {"title": "Real time trajectory prediction for collision risk estimation between vehicles", "author": ["S. Ammoun", "F. Nashashibi"], "venue": "Proc. IEEE Intelligent Computer Communication and Processing (ICCP), Aug. 2009, pp. 417-422.", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2009}, {"title": "IMM object tracking for high dynamic driving maneuvers", "author": ["N. Kaempchen", "K. Weiss", "M. Schaefer", "K.C.J. Dietmayer"], "venue": "Proc. IEEE Intelligent Vehicles Symp., June 2004, pp. 825-830.", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2004}, {"title": "Statistical threat assessment for general raod scenes using Monte Carlo sampling", "author": ["A. Eidehall", "L. Petersson"], "venue": "IEEE Trans. Intellgient Transport. Syst., vol. 9, no. 1, pp. 137-147, March 2008.", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2008}, {"title": "Online maneuver recognition and multimodal trajectory rediction for intersection assistance using non-parametric regression", "author": ["Q. Tran", "J. Firl"], "venue": "Proc. IEEE Intelligent Vehicles Symposium, June 2014, pp. 918-923.", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2014}, {"title": "Probabilistic analysis of dynamic scenes and collision risks assessment to improve driving safty", "author": ["C. Laugier", "I.E. Paromtchik", "M. Perrollaz", "M. Yong", "J. Yoder", "C. Tay", "K. Mekhnacha", "A. Negre"], "venue": "IEEE Intelligent Transport. Syst. Mag., vo. 3, no. 4, pp. 4-19, Oct. 2011.", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2011}, {"title": "Probabilistic trajectory prediction with Gaussian mixture models", "author": ["J. Wiest", "M. Hoffken", "U. Krebel", "K. Dietmayer"], "venue": "IEEE Intelligent Vehicles Symp., June 2012, pp. 141-146.", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2012}, {"title": "Learning driver behavior models from traffic observations for decision making and planning", "author": ["T. Gindele", "S. Brechtel", "R. Dillmann"], "venue": "IEEE Intelligent Transport. Mag., vol. 7, no. 1, pp. 69-79, Spring 2015.", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2015}, {"title": "Coupled hidden Markov models for complex action recognition", "author": ["M. Brand", "N. Oliver", "A. Pentland"], "venue": "IEEE Proc. Computer Vision and Pattern Recog. (CVPR), June 1997, pp. 994-999.", "citeRegEx": "9", "shortCiteRegEx": null, "year": 1997}, {"title": "Long short-term memory", "author": ["S. Hochreiter", "J. Schmidhuber"], "venue": "Neural Computation, vol. 9, no. 8, pp. 1735-1780, 1997.", "citeRegEx": "11", "shortCiteRegEx": null, "year": 1997}, {"title": "Surround vehicles trajectory analysis with recurrent neural networks", "author": ["A. Khosroshahi", "E. Ohn-Bar", "M.M. Trivedi"], "venue": "IEEE Proc. Intelligent Transportation Systems (ITSC), Nov. 2016, pp. 2267-2272.", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2016}], "referenceMentions": [{"referenceID": 0, "context": "So far, various approaches have been proposed to analyze the vehicles\u2019 motion [1].", "startOffset": 78, "endOffset": 81}, {"referenceID": 1, "context": "Vehicle motion model such as kinematic or dynamic models has been used for trajectory prediction [2], [3].", "startOffset": 97, "endOffset": 100}, {"referenceID": 2, "context": "Vehicle motion model such as kinematic or dynamic models has been used for trajectory prediction [2], [3].", "startOffset": 102, "endOffset": 105}, {"referenceID": 1, "context": "Kalman filter has been widely used to perform prediction accounting for the uncertainty in vehicle model [2].", "startOffset": 105, "endOffset": 108}, {"referenceID": 2, "context": "In order to improve the prediction accuracy further, Bayesian filtering techniques such as the context-dependent interactive multiple model filter [3] and Monte-Carlo method [4] have been proposed.", "startOffset": 147, "endOffset": 150}, {"referenceID": 3, "context": "In order to improve the prediction accuracy further, Bayesian filtering techniques such as the context-dependent interactive multiple model filter [3] and Monte-Carlo method [4] have been proposed.", "startOffset": 174, "endOffset": 177}, {"referenceID": 4, "context": "The vehicle trajectory generating model has been learned through Gaussian process [5], [6] and Gaussian mixture model [7].", "startOffset": 82, "endOffset": 85}, {"referenceID": 5, "context": "The vehicle trajectory generating model has been learned through Gaussian process [5], [6] and Gaussian mixture model [7].", "startOffset": 87, "endOffset": 90}, {"referenceID": 6, "context": "The vehicle trajectory generating model has been learned through Gaussian process [5], [6] and Gaussian mixture model [7].", "startOffset": 118, "endOffset": 121}, {"referenceID": 7, "context": "More sophisticated models considering the vehicle interactions were introduced, including dynamic Bayesian network [8] and coupled hidden Markov model [9].", "startOffset": 115, "endOffset": 118}, {"referenceID": 8, "context": "More sophisticated models considering the vehicle interactions were introduced, including dynamic Bayesian network [8] and coupled hidden Markov model [9].", "startOffset": 151, "endOffset": 154}, {"referenceID": 9, "context": "in text, speech, and financial data [11].", "startOffset": 36, "endOffset": 40}, {"referenceID": 10, "context": "Recently, we found that similar LSTM-based trajectory analysis has been proposed independently in [12].", "startOffset": 98, "endOffset": 102}, {"referenceID": 9, "context": "or explodes over time [11].", "startOffset": 22, "endOffset": 26}, {"referenceID": 9, "context": "In order to optimize the network parameters of the LSTM, we employ \u201cback propagation through time\u201d (BPTT) algorithm with minibatch size B [11].", "startOffset": 138, "endOffset": 142}], "year": 2017, "abstractText": "In this paper, we propose an efficient vehicle trajectory prediction framework based on recurrent neural network. Basically, the characteristic of the vehicle\u2019s trajectory is different from that of regular moving objects since it is affected by various latent factors including road structure, traffic rules, and driver\u2019s intention. Previous state of the art approaches use sophisticated vehicle behavior model describing these factors and derive the complex trajectory prediction algorithm, which requires a system designer to conduct intensive model optimization for practical use. Our approach is data-driven and simple to use in that it learns complex behavior of the vehicles from the massive amount of trajectory data through deep neural network model. The proposed trajectory prediction method employs the recurrent neural network called long short-term memory (LSTM) to analyze the temporal behavior and predict the future coordinate of the surrounding vehicles. The proposed scheme feeds the sequence of vehicles\u2019 coordinates obtained from sensor measurements to the LSTM and produces the probabilistic information on the future location of the vehicles over occupancy grid map. The experiments conducted using the data collected from highway driving show that the proposed method can produce reasonably good estimate of future trajectory.", "creator": "LaTeX with hyperref package"}}}