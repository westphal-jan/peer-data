{"id": "1704.08797", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "28-Apr-2017", "title": "Risk Stratification of Lung Nodules Using 3D CNN-Based Multi-task Learning", "abstract": "Risk stratification of lung nodules is a task of primary importance in lung cancer diagnosis. Any improvement in robust and accurate nodule characterization can assist in identifying cancer stage, prognosis, and improving treatment planning. In this study, we propose a 3D Convolutional Neural Network (CNN) based nodule characterization strategy. With a completely 3D approach, we utilize the volumetric information from a CT scan which would be otherwise lost in the conventional 2D CNN based approaches. In order to address the need for a large amount for training data for CNN, we resort to transfer learning to obtain highly discriminative features. Moreover, we also acquire the task dependent feature representation for six high-level nodule attributes and fuse this complementary information via a Multi-task learning (MTL) framework. Finally, we propose to incorporate potential disagreement among radiologists while scoring different nodule attributes in a graph regularized sparse multi-task learning. We evaluated our proposed approach on one of the largest publicly available lung nodule datasets comprising 1018 scans and obtained state-of-the-art results in regressing the malignancy scores.", "histories": [["v1", "Fri, 28 Apr 2017 03:32:54 GMT  (467kb,D)", "http://arxiv.org/abs/1704.08797v1", "Accepted for publication at Information Processing in Medical Imaging (IPMI) 2017"]], "COMMENTS": "Accepted for publication at Information Processing in Medical Imaging (IPMI) 2017", "reviews": [], "SUBJECTS": "cs.CV cs.LG", "authors": ["sarfaraz hussein", "kunlin cao", "qi song", "ulas bagci"], "accepted": false, "id": "1704.08797"}, "pdf": {"name": "1704.08797.pdf", "metadata": {"source": "CRF", "title": "Risk Stratification of Lung Nodules Using 3D CNN-Based Multi-task Learning", "authors": ["Sarfaraz Hussein", "Kunlin Cao", "Qi Song", "Ulas Bagci"], "emails": ["shussein@knights.ucf.edu", "bagci@crcv.ucf.edu"], "sections": [{"heading": null, "text": "Keywords: Computer-Aided Diagnosis (CAD), Lung Node Characterization, 3D Convolutional Neural Network, Multi-Task Learning, Transfer Learning, Computed Tomography (CT), Deep Learning"}, {"heading": "1 Introduction", "text": "The reason it has come to this is because most people are able to survive on their own."}, {"heading": "2 Related Work", "text": "The method used by Uchiyama et al. [6] was also based on the extraction of various physical metrics, including intensity statistics and then on classification using artificial neural networks. El-Baz et al. [7] First, lung nodes were segmented using appearance-based models and spherical harmonic analyses were used to perform shape analyses, the last step being classification using k-nearest neighbours. A study based on texture analysis, Han et al. [8] extracted 2D texture features such as haralick, gabor and local binary patterns (LBP) and extended them to 3D. Support for Vector Machine (SVM) was used to perform the classification."}, {"heading": "3 Method", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1 Problem Formulation", "text": "Let X = [x1, x2... xn] \u0433Rn \u00b7 d be the data matrix containing features from n data points in Rd. Each sample corresponds to a regression value given by Y = [y1, y2... yn], where Y-Rn \u00b7 1 is the objective to learn the coefficient vector or regression estimator W from the training data. In this case, the \"1 regulated smallest square regressor is defined as: min W-XW \u2212 Y-22 + \u03bb W-1, (1), where \u03bb controls the savings level for the coefficient vector W = [w1, w2.... wd]. The problem in Equation 1 is an unlimited convex optimization problem, and it remains undifferentiable if wi = 0. This results in the closed form solution corresponding to the global minimum for equation."}, {"heading": "3.2 Network Architecture and Transfer Learning", "text": "We use the data set of the lung nodes to fine tune a 3D CNN trained on the Sports-1M dataset [15]. The sports dataset includes 1 million videos with 487 classes. In the absence of a large number of training examples from lung nodes, we use transfer learning strategies to obtain a rich feature representation from a larger dataset (Sports-1M) to characterize the lung nodes. The Sport-1M dataset is used to train a 3D CNN [5]. The network includes 5 folds, 5 max pools, 2 fully connected and 1 soft max classification layers. The input to the network is 3 x 16 x 128 x 171, with 16 non-overlapping discs in the input volume. The first two folding layers have 64 and 128 filters respectively, whereas there are 256 filters in the last 3 layers. The outputs of the fully connected layers are 4096 dimensions."}, {"heading": "3.3 Multi-task learning", "text": "In this case, the sum of the individual values is a substitute for the \"1 standard.\" Trace norm, also known as the nuclear standard, is the precedence order of a matrix (which is not compliant)."}, {"heading": "3.4 Optimization", "text": "Since the optimization function in Eq.7 has both smooth and smooth convex parts, the estimation of the non-smooth part can contribute to the solution of the optimization function. Therefore, the accelerated proximal gradient method [18,19] is used to solve the equilibrium. Accelerated proximal method is the first-order gradient method with a complexity of O (1 / k2), where k is the iteration counter. Note that in Eq.7 the \"1 standard includes the non-smooth part and the proximal operator is used for estimation. The steps of the proposed approach are summarized in algorithm 1."}, {"heading": "4 Experiments", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "4.1 Data", "text": "To evaluate our proposed approach, we used the LIDC-IDRI dataset from the Lung Image Database Consortium [3], which is one of the largest publicly available datasets for early detection of lung cancer. There were 1018 CT scans in the dataset, where the disc thickness varied from 0.45 mm to 5.0 mm. Nodes with diameters greater than or equal to 3 mm were commented on by a maximum of four radiologists. Nodes that were commented on by at least three radiologists were used for the evaluations.There were 1340 nodes that met this criteria.We used the mean malignancy and attribute values of various radiologists for experiments.The nodes have evaluations that correspond to malignancy and the other six attributes that correspond to (i) calcification, (ii) lubulation, (iii) spiculation, (iv) sphericity, (v) marginal range and (vi) texture.The malignancy scores were set to 5 points, with an upward of 5 to 1."}, {"heading": "4.2 Results", "text": "In fact, it is that we are able to assert ourselves, that we are able to adapt to the needs of the people, and that we are able to adapt to the needs of the people we are able to satisfy."}, {"heading": "5 Discussion and Conclusion", "text": "In this work, we proposed a framework for stratifying the malignancy of lung nodes using 3D CNN and diagrams that regulates the sparse learning with multiple tasks. To our knowledge, this is the first time that transfer learning via 3D CNN is used to improve the characterization of lung nodes. Data acquisition tasks, especially in medical imaging fields, are highly regulated and the availability of experts to comment on these images is limited. In this scenario, it is crucial to use the availability of crowdsourced and annotated data such as user-taken videos to train discriminatory models. In view of the diversity of data from these two areas (i.e. medical and non-medical user-collected videos), it is crucial to transfer learning from the source domain (user-collected videos) to the target domain (medical imaging data). To establish this observation and to visualize these features, we used SNE to transfer high-dimensional space (a high-dimensional space) between the malignancies in this low-dimensional space."}], "references": [{"title": "World Cancer Report 2014", "author": ["B. Stewart", "Wild", "C.P"], "venue": "World", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2016}, {"title": "Lung cancer screening: Computed tomography or chest radiographs", "author": ["E.J. van Beek", "S. Mirsadraee", "J.T. Murchison"], "venue": "World Journal of Radiology 7(8),", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2015}, {"title": "The lung image database consortium (LIDC) and image database resource initiative (IDRI): a completed reference database of lung nodules on CT scans", "author": ["S. Armato III", "G. McLennan", "L. Bidaut", "M.F. McNitt-Gray", "C.R. Meyer", "A.P. Reeves", "B. Zhao", "D.R. Aberle", "C.I. Henschke", "Hoffman", "E.A"], "venue": "Medical Physics 38(2), 915\u2013931", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2011}, {"title": "Deep convolutional neural networks for computer-aided detection: CNN architectures, dataset characteristics and transfer learning", "author": ["H. Shin", "H.R. Roth", "M. Gao", "L. Lu", "Z. Xu", "I. Nogues", "J. Yao", "D. Mollura", "R.M. Summers"], "venue": "IEEE Transactions on Medical Imaging 35(5), 1285\u20131298", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2016}, {"title": "Learning spatiotemporal features with 3D convolutional networks", "author": ["D. Tran", "L. Bourdev", "R. Fergus", "L. Torresani", "M. Paluri"], "venue": "2015 IEEE International Conference on Computer Vision (ICCV). pp. 4489\u20134497. IEEE", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2015}, {"title": "Quantitative computerized analysis of diffuse lung disease in high-resolution computed tomography", "author": ["Y. Uchiyama", "S. Katsuragawa", "H. Abe", "J. Shiraishi", "F. Li", "Q. Li", "C.T. Zhang", "K. Suzuki", "K. Doi"], "venue": "Medical Physics 30(9), 2440\u20132454", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2003}, {"title": "3D shape analysis for early diagnosis of malignant lung nodules", "author": ["A. El-Baz", "M. Nitzken", "F. Khalifa", "A. Elnakib", "G. Gimelfarb", "R. Falk", "M.A. ElGhar"], "venue": "Biennial International Conference on Information Processing in Medical Imaging. pp. 772\u2013783. Springer", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2011}, {"title": "Texture feature analysis for computer-aided diagnosis on pulmonary nodules", "author": ["F. Han", "H. Wang", "G. Zhang", "H. Han", "B. Song", "L. Li", "W. Moore", "H. Lu", "H. Zhao", "Z. Liang"], "venue": "Journal of Digital Imaging 28(1), 99\u2013115", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2015}, {"title": "Computer-aided diagnosis of pulmonary nodules on CT scans: segmentation and classification using 3D active contours", "author": ["T.W. Way", "L.M. Hadjiiski", "B. Sahiner", "H.P. Chan", "P.N. Cascade", "E.A. Kazerooni", "N. Bogot", "C. Zhou"], "venue": "Medical Physics 33(7), 2323\u20132337", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2006}, {"title": "Computer-aided diagnosis of pulmonary nodules using a two-step approach for feature selection and classifier ensemble construction", "author": ["M. Lee", "L. Boroczky", "K. Sungur-Stasik", "A. Cann", "A. Borczuk", "S. Kawut", "C. Powell"], "venue": "Artificial Intelligence in Medicine 50(1), 43\u201353", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2010}, {"title": "Lung nodule classification using deep features in CT images", "author": ["D. Kumar", "A. Wong", "D.A. Clausi"], "venue": "Computer and Robot Vision (CRV), 2015 12th Conference on. pp. 133\u2013138. IEEE", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2015}, {"title": "Characterization of lung nodule malignancy using hybrid shape and appearance features", "author": ["M. Buty", "Z. Xu", "M. Gao", "U. Bagci", "A. Wu", "D.J. Mollura"], "venue": "International Conference on Medical Image Computing and Computer-Assisted Intervention (MICCAI). pp. 662\u2013670. Springer", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2016}, {"title": "Bridging Computational Features Toward Multiple Semantic Features with Multi-task Regression: A Study of CT Pulmonary Nodules", "author": ["S. Chen", "D. Ni", "J. Qin", "B. Lei", "T. Wang", "J.Z. Cheng"], "venue": "MICCAI. pp. 53\u201360. Springer", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2016}, {"title": "New classification of small pulmonary nodules by margin characteristics on highresolution CT", "author": ["K. Furuya", "S. Murayama", "H. Soeda", "J. Murakami", "Y. Ichinose", "H. Yauuchi", "Y. Katsuda", "M. Koga", "K. Masuda"], "venue": "Acta Radiologica 40(5), 496\u2013504", "citeRegEx": "14", "shortCiteRegEx": null, "year": 1999}, {"title": "Largescale video classification with convolutional neural networks", "author": ["A. Karpathy", "G. Toderici", "S. Shetty", "T. Leung", "R. Sukthankar", "L. Fei-Fei"], "venue": "Proceedings of the IEEE conference on Computer Vision and Pattern Recognition. pp. 1725\u20131732", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2014}, {"title": "Regularized multi\u2013task learning", "author": ["T. Evgeniou", "M. Pontil"], "venue": "Proceedings of the tenth ACM SIGKDD International Conference on Knowledge discovery and Data mining. pp. 109\u2013117. ACM", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2004}, {"title": "MALSAR: Multi-task learning via structural regularization", "author": ["J. Zhou", "J. Chen", "J. Ye"], "venue": null, "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2012}, {"title": "Introductory lectures on convex optimization: A basic course, vol", "author": ["Y. Nesterov"], "venue": "87. Springer Science & Business Media", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2013}, {"title": "Modeling the shape of the scene: A holistic representation of the spatial envelope", "author": ["A. Oliva", "A. Torralba"], "venue": "International Journal of Computer Vision 42(3), 145\u2013175", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2001}, {"title": "Visualizing data using t-SNE", "author": ["Maaten", "L.v.d.", "G. Hinton"], "venue": "Journal of Machine Learning Research 9(Nov), 2579\u20132605", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2008}, {"title": "Evidence based imaging strategies for solitary pulmonary nodule", "author": ["Y.X.J. Wang", "J.S. Gong", "K. Suzuki", "S.K. Morcos"], "venue": "Journal of thoracic disease 6(7), 872\u2013887", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2014}], "referenceMentions": [{"referenceID": 0, "context": "59 million [1].", "startOffset": 11, "endOffset": 14}, {"referenceID": 1, "context": "Early diagnosis is one of the ways to reduce deaths related to lung cancer [2].", "startOffset": 75, "endOffset": 78}, {"referenceID": 2, "context": "Specially the availability of large publicly available datasets such as LIDC-IDRI from Lung Image Database Consortium [3] has helped accelerate the research in this regard.", "startOffset": 118, "endOffset": 121}, {"referenceID": 3, "context": "Capitalizing on the significant progress of deep learning technologies for image classification and their potential applications in radiology [4], we propose a 3D Convolutional Neural Network (CNN) based approach for rich feature representation of lung nodules.", "startOffset": 142, "endOffset": 145}, {"referenceID": 4, "context": "The superior performance of 3D CNN over 2D networks is well studied in [5].", "startOffset": 71, "endOffset": 74}, {"referenceID": 5, "context": "[6] was based on the extraction of various physical measures, including intensity statistics and then classification using Artificial Neural Networks.", "startOffset": 0, "endOffset": 3}, {"referenceID": 6, "context": "[7] first segmented the lung nodules using appearance-based models and used spherical harmonic analysis to perform shape analysis.", "startOffset": 0, "endOffset": 3}, {"referenceID": 7, "context": "[8] extracted 2D texture features such as Haralick, Gabor and Local Binary Patterns (LBP) and extended them to 3D.", "startOffset": 0, "endOffset": 3}, {"referenceID": 8, "context": "[9], segmentation is performed using 3D active contours followed by the extraction of texture features from the rubber band straightening transform of the surrounding voxels.", "startOffset": 0, "endOffset": 3}, {"referenceID": 9, "context": "[10] proposed a feature", "startOffset": 0, "endOffset": 4}, {"referenceID": 10, "context": "In those frameworks, CNN had been used for feature extraction and an off-the-shelf classifier such as Random Forest (RF) was employed for classification [11,12].", "startOffset": 153, "endOffset": 160}, {"referenceID": 11, "context": "In those frameworks, CNN had been used for feature extraction and an off-the-shelf classifier such as Random Forest (RF) was employed for classification [11,12].", "startOffset": 153, "endOffset": 160}, {"referenceID": 11, "context": "[12] combined spherical harmonics along with deep CNN features and then classified them using RF.", "startOffset": 0, "endOffset": 4}, {"referenceID": 12, "context": "However, the use of CNN for lung nodule classification has been confined to 2D image analysis [13], thus falling short of utilizing the important volumetric and contextual information.", "startOffset": 94, "endOffset": 98}, {"referenceID": 13, "context": "[14] found that in a particular dataset, 82% of the lobulated, 97% of the densely spiculated, 93% of the ragged and 100% of the halo nodules were malignant.", "startOffset": 0, "endOffset": 4}, {"referenceID": 14, "context": "We use the lung nodules dataset to fine-tune a 3D CNN trained on Sports-1M dataset [15].", "startOffset": 83, "endOffset": 87}, {"referenceID": 4, "context": "The Sports-1M dataset is used to train a 3D CNN [5].", "startOffset": 48, "endOffset": 51}, {"referenceID": 15, "context": "Another regularizer, pertinent to MTL, is the regularization on the graph representing the relationship between the tasks [16,17].", "startOffset": 122, "endOffset": 129}, {"referenceID": 16, "context": "Another regularizer, pertinent to MTL, is the regularization on the graph representing the relationship between the tasks [16,17].", "startOffset": 122, "endOffset": 129}, {"referenceID": 17, "context": "Therefore, accelerated proximal gradient method [18,19] is employed to solve the Eq.", "startOffset": 48, "endOffset": 55}, {"referenceID": 2, "context": "For evaluating our proposed approach, we used LIDC-IDRI dataset from Lung Image Database Consortium [3], which is one of the largest publicly available lung cancer screening datasets.", "startOffset": 100, "endOffset": 103}, {"referenceID": 14, "context": "We used the 3D CNN trained on Sports-1M dataset [15] which had 487 classes.", "startOffset": 48, "endOffset": 52}, {"referenceID": 16, "context": "To find the structure matrix S, we computed the correlation between tasks by finding an initial normalized coefficient matrix W using lasso with least square loss function and followed by computing the correlation coefficient matrix [17].", "startOffset": 233, "endOffset": 237}, {"referenceID": 18, "context": "Table 1 shows the comparison of our proposed Multi-task learning method with GIST features [20] +LASSO and 3D CNN Multi-task learning with trace norm.", "startOffset": 91, "endOffset": 95}, {"referenceID": 19, "context": "hood embedding (t-SNE) [21].", "startOffset": 23, "endOffset": 27}, {"referenceID": 20, "context": "It has been found that the combination of PET and CT can improve the diagnostic accuracy of solitary lung nodules [22].", "startOffset": 114, "endOffset": 118}], "year": 2017, "abstractText": "Risk stratification of lung nodules is a task of primary importance in lung cancer diagnosis. Any improvement in robust and accurate nodule characterization can assist in identifying cancer stage, prognosis, and improving treatment planning. In this study, we propose a 3D Convolutional Neural Network (CNN) based nodule characterization strategy. With a completely 3D approach, we utilize the volumetric information from a CT scan which would be otherwise lost in the conventional 2D CNN based approaches. In order to address the need for a large amount for training data for CNN, we resort to transfer learning to obtain highly discriminative features. Moreover, we also acquire the task dependent feature representation for six high-level nodule attributes and fuse this complementary information via a Multi-task learning (MTL) framework. Finally, we propose to incorporate potential disagreement among radiologists while scoring different nodule attributes in a graph regularized sparse multi-task learning. We evaluated our proposed approach on one of the largest publicly available lung nodule datasets comprising 1018 scans and obtained state-of-the-art results in regressing the malignancy scores.", "creator": "LaTeX with hyperref package"}}}