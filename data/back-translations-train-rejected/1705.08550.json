{"id": "1705.08550", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "23-May-2017", "title": "Deep Multi-instance Networks with Sparse Label Assignment for Whole Mammogram Classification", "abstract": "Mammogram classification is directly related to computer-aided diagnosis of breast cancer. Traditional methods rely on regions of interest (ROIs) which require great efforts to annotate. Inspired by the success of using deep convolutional features for natural image analysis and multi-instance learning (MIL) for labeling a set of instances/patches, we propose end-to-end trained deep multi-instance networks for mass classification based on whole mammogram without the aforementioned ROIs. We explore three different schemes to construct deep multi-instance networks for whole mammogram classification. Experimental results on the INbreast dataset demonstrate the robustness of proposed networks compared to previous work using segmentation and detection annotations.", "histories": [["v1", "Tue, 23 May 2017 22:16:20 GMT  (952kb,D)", "http://arxiv.org/abs/1705.08550v1", "MICCAI 2017 Camera Ready"]], "COMMENTS": "MICCAI 2017 Camera Ready", "reviews": [], "SUBJECTS": "cs.CV cs.LG cs.NE", "authors": ["wentao zhu", "qi lou", "yeeleng scott vang", "xiaohui xie"], "accepted": false, "id": "1705.08550"}, "pdf": {"name": "1705.08550.pdf", "metadata": {"source": "CRF", "title": "Deep Multi-instance Networks with Sparse Label Assignment for Whole Mammogram Classification", "authors": ["Wentao Zhu", "Qi Lou", "Yeeleng Scott Vang", "Xiaohui Xie"], "emails": ["xhx}@ics.uci.edu,", "ysvang}@uci.edu"], "sections": [{"heading": null, "text": "Keywords: deep multi-instance learning, whole mammogram classification, max pooling-based MIL, label assignment-based MIL, sparse MIL"}, {"heading": "1 Introduction", "text": "According to the American Cancer Society, breast cancer is the most commonly diagnosed solid cancer and the second leading cause of death for women in the U.S. [1]. Mammogram screening has been proven to be an effective way to detect and diagnose breast cancer that can significantly reduce breast cancer mortality [15]. Classifying mammograms requires additional notes such as detecting or gathering the truth for segmentation [17]. Other work has different deep networks for detecting ROIs and achieving mass margins at different stages. However, these methods require craftsmanship to complement the system [12], and training data supplemented with boxing and segmentation."}, {"heading": "2 Deep MIL for Whole Mammogram Mass Classification", "text": "Unlike other deep multi-instance networks [18,10], we use a CNN to efficiently obtain characteristics of all patches (instances) at the same time. In view of an image I, we get a much smaller characteristic map F of multichannel Nc after several revolutionary layers and maximum pooling layers. The (F) i, j,: represents deep CNN characteristics for a patch Qi, j in I, where i, j represents the pixel row and the column index.The goal of our work is to predict whether an entire mammogram contains a malignant mass (BI-RADS) (4, 5, 6} as positive) or not, which is a standard problem of binary classification. We add a logistic regression with weights divided by all pixel positions according to F. and an elementary sigmoid activation function is applied to the output. To clarify, the malignant probability of the characteristic dimensions of a \u00b7 g \u00b7 g \u00b7 g is (j), where a (j) is (j) x, where a (x) is the malignant probability of the characteristic dimension of a \u00b7 g (x)."}, {"heading": "2.1 Max Pooling-based Multi-instance Learning", "text": "The general multi-instance assumption is that if there is an instance that is positive, the bag is positive [7]. The bag is negative if and only if all instances are negative. For the entire mammogram classification, the equivalent scenario is that if there is a malignant mass, the mammogram I should be classified as positive. Likewise, negative mammograms I should not have a malignant mass. If we treat each patch Qi of I as an instance, the entire mammogram classification is a standard multi-instance task. For negative mammograms, we expect all ri to be close to 0. For positive mammograms, at least one ri should be close to 1. Therefore, it is natural to consider the maximum component of r as malignant probability of the mammogram Ip (y = 1 | I, \u03b8), mammoth model P (max {r1, r2,..., rm}, where the weights lie in deep networks."}, {"heading": "2.2 Label Assignment-based Multi-instance Learning", "text": "In traditional classification tasks, we assign a label to each data point. In the MIL scheme Q = Q layer Q layer = Q layer | If we consider each instance (patch) Qi as the data point for classification, we can turn the multi-level learning problem into a label assignment problem. After we have classified the malicious probabilities r = (r1, r2,..., rm) for all instances (patches) in an entire mammogram I using the first equation in Eq. 3, the first few r-i should be consistent with the designation of the entire mammogram as already mentioned, while the remaining patches (instances) should be negative. Instead of adopting the general MIL assumption, which only takes into account Q-1 (patch of malicious probability r-1), we assume that 1) patches of the first k-largest malicious probabilities in the first k-greatest malicious layer (layer), {r-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1-1"}, {"heading": "2.3 Sparse Multi-instance Learning", "text": "Based on mass distribution, mass typically covers about 2% of the total mammogram on average (Fig. 2), which means that the mass region in the entire mammogram classification problem is quite sparse. It is easy to convert mass spareness into malignant mass spareness, which implies that {r \u2032 1, r \u2032 2,..., r \u2032 m} is sparse throughout the entire mammogram classification problem. Limitation of mass means that we consider the malignant probability of partial loss r \u2032 i to be 0 or close to 0, which corresponds to the second assumption in the labeling order-based MIL. Similarly, we expect r \u2032 1 to be indicative for true labeling of mammogram I. According to the discussion above, the loss function of the sparse MIL problem within this part can be defined as different: sparse = 1N = N = 1 EZ = 1 EZ = 1 EZ (1 log = 1 (2001 \u2212 \u00b2 (p) where n is n)."}, {"heading": "3 Experiments", "text": "We validate the proposed models on the basis of the most commonly used mammographic mass classification data sets, INbreast Dataset [14], like the mammograms in other datasets, such as DDSM Dataset [4], are of low quality. INbreast Dataset contains 410 mammograms, of which 100 malignant masses are included. These 100 malignant mass mammograms are defined as positive. For a fair comparison, we also use 5-fold cross-validation to evaluate model performance, such as [6]. For each test fold, we use three folds for training, and one fold for the validation of hyperparameters. Performance is reported as an average of five test results obtained from cross-validation. We employ techniques to expand our data."}, {"heading": "4 Conclusion", "text": "Unlike previous work that used segmentation or detection comments, we perform mass classification directly on the basis of the entire mammogram. We transform the general MIL assumption into labeling problems after ranking. Due to the low masses, sparse MIL is used for the entire mammogram classification. Experimental results show more robust performance, even without detection or segmentation comments in training. In future work, we plan to add: 1) the inclusion of multi-scale modeling such as spatial pyramids to further improve the classification of whole mammograms, 2) the use of deep MIL to provide annotation or potentially malicious patches to support diagnosis, and 3) the application to large datasets when the large dataset is available."}], "references": [{"title": "Adam: A method for stochastic optimization", "author": ["J. Ba", "D. Kingma"], "venue": "ICLR", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2015}, {"title": "Digital mammographic computer aided diagnosis (cad) using adaptive level set segmentation", "author": ["J.E. Ball", "L.M. Bruce"], "venue": "EMBS", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2007}, {"title": "The digital database for screening mammography", "author": ["K. Bowyer", "D. Kopans", "W Kegelmeyer"], "venue": "IWDM", "citeRegEx": "4", "shortCiteRegEx": null, "year": 1996}, {"title": "Unregistered multiview mammogram analysis with pre-trained deep learning models", "author": ["G. Carneiro", "J. Nascimento", "A.P. Bradley"], "venue": "MICCAI. pp. 652\u2013660. Springer", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2015}, {"title": "The automated learning of deep features for breast mass classification from mammograms", "author": ["N. Dhungel", "G. Carneiro", "A.P. Bradley"], "venue": "MICCAI. pp. 106\u2013114. Springer", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2016}, {"title": "Solving the multiple instance problem with axis-parallel rectangles", "author": ["T.G. Dietterich", "R.H. Lathrop", "T. Lozano-P\u00e9rez"], "venue": "Artificial intelligence 89(1), 31\u201371", "citeRegEx": "7", "shortCiteRegEx": null, "year": 1997}, {"title": "Inbreast-database masses characterization", "author": ["I. Domingues", "E. Sales", "J. Cardoso", "W. Pereira"], "venue": "XXIII CBEB", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2012}, {"title": "Guest editorial deep learning in medical imaging: Overview and future promise of an exciting new technique", "author": ["H. Greenspan", "B. van Ginneken", "R.M. Summers"], "venue": "IEEE Transactions on Medical Imaging 35(5), 1153\u20131159", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2016}, {"title": "Patch-based convolutional neural network for whole slide tissue image classification", "author": ["L. Hou", "D. Samaras", "Kurc", "T.M"], "venue": "arXiv:1504.07947", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2015}, {"title": "A deep feature based framework for breast masses classification", "author": ["Z. Jiao", "X. Gao", "Y. Wang", "J. Li"], "venue": "Neurocomputing", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2016}, {"title": "Large scale deep learning for computer aided detection of mammographic lesions", "author": ["T. Kooi", "G. Litjens", "B van Ginneken"], "venue": "Medical image analysis 35, 303\u2013312", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2017}, {"title": "Imagenet classification with deep convolutional neural networks", "author": ["A. Krizhevsky", "I. Sutskever", "G.E. Hinton"], "venue": "NIPS. pp. 1097\u20131105", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2012}, {"title": "Inbreast: toward a full-field digital mammographic database", "author": ["I.C. Moreira", "I. Amaral", "I Domingues"], "venue": "Academic radiology", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2012}, {"title": "Breast cancer screening for women at average risk: 2015 guideline update from the american cancer society", "author": ["K.C. Oeffinger", "E.T. Fontham", "R Etzioni"], "venue": "Jama", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2015}, {"title": "Learning from experts: Developing transferable deep features for patient-level lung cancer prediction", "author": ["W. Shen", "M. Zhou", "F Yang"], "venue": "MICCAI", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2016}, {"title": "Use of border information in the classification of mammographic masses", "author": ["C. Varela", "S. Timp", "N. Karssemeijer"], "venue": "Physics in Medicine and Biology 51(2), 425", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2006}, {"title": "Co-occurrence feature learning for skeleton based action recognition using regularized deep lstm networks", "author": ["W. Zhu", "C. Lan", "J Xing"], "venue": "AAAI", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2016}, {"title": "Hierarchical extreme learning machine for unsupervised representation learning", "author": ["W. Zhu", "J. Miao", "L. Qing", "G.B. Huang"], "venue": "IJCNN. pp. 1\u20138. IEEE", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2015}, {"title": "Adversarial deep structural networks for mammographic mass segmentation", "author": ["W. Zhu", "X. Xie"], "venue": "arXiv:1612.05970", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2016}], "referenceMentions": [{"referenceID": 13, "context": "Mammogram screening has been demonstrated to be an effective way for early detection and diagnosis, which can significantly decrease breast cancer mortality [15].", "startOffset": 157, "endOffset": 161}, {"referenceID": 15, "context": "Traditional mammogram classification requires extra annotations such as bounding box for detection or mask ground truth for segmentation [17,5,11].", "startOffset": 137, "endOffset": 146}, {"referenceID": 3, "context": "Traditional mammogram classification requires extra annotations such as bounding box for detection or mask ground truth for segmentation [17,5,11].", "startOffset": 137, "endOffset": 146}, {"referenceID": 9, "context": "Traditional mammogram classification requires extra annotations such as bounding box for detection or mask ground truth for segmentation [17,5,11].", "startOffset": 137, "endOffset": 146}, {"referenceID": 4, "context": "Other work have employed different deep networks to detect ROIs and obtain mass boundaries in different stages [6].", "startOffset": 111, "endOffset": 114}, {"referenceID": 10, "context": "However, these methods require hand-crafted features to complement the system [12], and training data to be annotated with bounding boxes and segmentation ground truths which require expert domain knowledge and costly effort to obtain.", "startOffset": 78, "endOffset": 82}, {"referenceID": 7, "context": "Due to the great representation power of deep features [9,21,19,20], combining MIL with deep neural networks is an emerging topic.", "startOffset": 55, "endOffset": 67}, {"referenceID": 18, "context": "Due to the great representation power of deep features [9,21,19,20], combining MIL with deep neural networks is an emerging topic.", "startOffset": 55, "endOffset": 67}, {"referenceID": 16, "context": "Due to the great representation power of deep features [9,21,19,20], combining MIL with deep neural networks is an emerging topic.", "startOffset": 55, "endOffset": 67}, {"referenceID": 17, "context": "Due to the great representation power of deep features [9,21,19,20], combining MIL with deep neural networks is an emerging topic.", "startOffset": 55, "endOffset": 67}, {"referenceID": 11, "context": "Here we use the convolutional layers in AlexNet [13].", "startOffset": 48, "endOffset": 52}, {"referenceID": 8, "context": "Patch based CNN added a new layer after the last layer of deep MIL to learn the fusion model for multi-instance predictions [10].", "startOffset": 124, "endOffset": 128}, {"referenceID": 14, "context": "employed two stage training to learn the deep multi-instance networks for pre-detected lung nodule classification [16].", "startOffset": 114, "endOffset": 118}, {"referenceID": 12, "context": "The proposed deep multi-instance networks are shown to provide robust performance for whole mammogram classification on the INbreast dataset [14].", "startOffset": 141, "endOffset": 145}, {"referenceID": 8, "context": "Unlike other deep multi-instance networks [18,10], we use a CNN to efficiently obtain features of all patches (instances) at the same time.", "startOffset": 42, "endOffset": 49}, {"referenceID": 5, "context": "The general multi-instance assumption is that if there exists an instance that is positive, the bag is positive [7].", "startOffset": 112, "endOffset": 115}, {"referenceID": 12, "context": "We validate the proposed models on the most frequently used mammographic mass classification dataset, INbreast dataset [14], as the mammograms in other datasets, such as DDSM dataset [4], are of low quality.", "startOffset": 119, "endOffset": 123}, {"referenceID": 2, "context": "We validate the proposed models on the most frequently used mammographic mass classification dataset, INbreast dataset [14], as the mammograms in other datasets, such as DDSM dataset [4], are of low quality.", "startOffset": 183, "endOffset": 186}, {"referenceID": 4, "context": "For fair comparison, we also use 5-fold cross validation to evaluate model performance as [6].", "startOffset": 90, "endOffset": 93}, {"referenceID": 11, "context": "For the CNN network structure, we use AlexNet and remove the fully connected layers [13].", "startOffset": 84, "endOffset": 88}, {"referenceID": 0, "context": "We use Adam optimization with learning rate 5 \u00d7 10\u22125 for training models [2].", "startOffset": 73, "endOffset": 76}, {"referenceID": 1, "context": "[3] DDSM Manual+feat.", "startOffset": 0, "endOffset": 3}, {"referenceID": 15, "context": "[17] DDSM Manual+feat.", "startOffset": 0, "endOffset": 4}, {"referenceID": 6, "context": "[8] INbr.", "startOffset": 0, "endOffset": 3}, {"referenceID": 4, "context": "89 N/A Pretrained CNN [6] INbr.", "startOffset": 22, "endOffset": 25}, {"referenceID": 4, "context": "10 Pretrained CNN+Random Forest [6] INbr.", "startOffset": 32, "endOffset": 35}, {"referenceID": 1, "context": "Previous hand-crafted feature-based methods require manually annotated detection bounding box or segmentation ground truth even in test denoting as manual [3,17,8].", "startOffset": 155, "endOffset": 163}, {"referenceID": 15, "context": "Previous hand-crafted feature-based methods require manually annotated detection bounding box or segmentation ground truth even in test denoting as manual [3,17,8].", "startOffset": 155, "endOffset": 163}, {"referenceID": 6, "context": "Previous hand-crafted feature-based methods require manually annotated detection bounding box or segmentation ground truth even in test denoting as manual [3,17,8].", "startOffset": 155, "endOffset": 163}, {"referenceID": 4, "context": "Pretrained CNN uses two CNNs to detect the mass region and segment the mass, followed by a third CNN to do mass classification on the detected ROI region, which requires handcrafted features to pretrain the network and needs multi-stages training[6].", "startOffset": 246, "endOffset": 249}], "year": 2017, "abstractText": "Mammogram classification is directly related to computer-aided diagnosis of breast cancer. Traditional methods rely on regions of interest (ROIs) which require great efforts to annotate. Inspired by the success of using deep convolutional features for natural image analysis and multi-instance learning (MIL) for labeling a set of instances/patches, we propose end-to-end trained deep multiinstance networks for mass classification based on whole mammogram without the aforementioned ROIs. We explore three different schemes to construct deep multi-instance networks for whole mammogram classification. Experimental results on the INbreast dataset demonstrate the robustness of proposed networks compared to previous work using segmentation and detection annotations. 1", "creator": "LaTeX with hyperref package"}}}