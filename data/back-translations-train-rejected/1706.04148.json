{"id": "1706.04148", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "13-Jun-2017", "title": "Personalizing Session-based Recommendations with Hierarchical Recurrent Neural Networks", "abstract": "Session-based recommendations are highly relevant in many modern on-line services (e.g. e-commerce, video streaming) and recommendation settings. Recurrent Neural Networks have recently been shown to perform very well in session-based settings. While in many session-based recommendation domains user identifiers are hard to come by, there are also domains in which user profiles are readily available. We propose a seamless way to personalize RNN models with cross-session information transfer and devise a hierarchical RNN model that relies end evolves latent hidden states of the RNN's across user sessions. Results on two industry datasets show large improvements over the session-only RNN's.", "histories": [["v1", "Tue, 13 Jun 2017 16:33:52 GMT  (422kb,D)", "http://arxiv.org/abs/1706.04148v1", null], ["v2", "Wed, 14 Jun 2017 08:02:51 GMT  (422kb,D)", "http://arxiv.org/abs/1706.04148v2", null], ["v3", "Sat, 8 Jul 2017 16:52:18 GMT  (358kb,D)", "http://arxiv.org/abs/1706.04148v3", null], ["v4", "Fri, 14 Jul 2017 16:42:43 GMT  (941kb,D)", "http://arxiv.org/abs/1706.04148v4", null], ["v5", "Wed, 23 Aug 2017 18:42:56 GMT  (942kb,D)", "http://arxiv.org/abs/1706.04148v5", null]], "reviews": [], "SUBJECTS": "cs.LG cs.HC cs.IR", "authors": ["massimo quadrana", "alexandros karatzoglou", "bal\\'azs hidasi", "paolo cremonesi"], "accepted": false, "id": "1706.04148"}, "pdf": {"name": "1706.04148.pdf", "metadata": {"source": "META", "title": "Personalizing Session-based Recommendations with Hierarchical Recurrent Neural Networks", "authors": ["Massimo Quadrana", "Alexandros Karatzoglou", "Bal\u00e1zs Hidasi", "Paolo Cremonesi"], "emails": ["massimo.quadrana@polimi.it", "alexk@tid.es", "balazs.hidasi@gravityrd.com", "paolo.cremonesi@polimi.it"], "sections": [{"heading": null, "text": "CCS CONCEPTS \u2022 Information Systems \u2192 Data Mining; Recommendation Systems; KEYWORDS deep learning, recurrent neural networks, gated recurrent units, Recommendation Systems, session-based recommendation ACM Reference format: Massimo Quadrana, Alexandros Karatzoglou, Bal\u00e1zs Hidasi, and Paolo Cremonesi. 2017. Personalizing Session-based Recommendations with Hierarchical Recurrent Neural Networks. In Proceedings of ACM Recsys conference, Como, Italy, 26-29 August 2017 (RecSys' 17), 9 pages. DOI: 10.1145 / nnnnnnnnn"}, {"heading": "1 INTRODUCTION", "text": "s sessions can take place on the same day, or over several days, weeks or months. Permission to make digital or hard copies of this work must be granted without charge, since copies are not made for profit or commercial gain and copies carry this message on the first page. Copyrights for the components of this work must be honored. For all other applications, the owner / author must be contacted."}, {"heading": "2 RELATED WORK", "text": "In this context, it should be noted that the number of users who are able to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move, to move and to move."}, {"heading": "3 MODEL", "text": "In this section, we describe the proposed hierarchical RNN model (HRNN) for personalized session-based recommendations."}, {"heading": "3.1 Session-based Recurrent Neural Network", "text": "This year, it is so far that it is only a matter of time before it is ready, until it is ready."}, {"heading": "3.2 Personalized Session-based Hierarchical Recurrent Neural Network", "text": "This year, it is closer than ever before in the history of the country."}, {"heading": "4 EXPERIMENTS", "text": "In this section we describe our experimental setup and offer an in-depth discussion of the results obtained."}, {"heading": "4.1 Datasets", "text": "We used two datasets for our experiments. The first is the XING 2 Recsys Challenge 2016 dataset [1], which includes interactions on job postings for 770k users over a period of 80 days.2https: / / www.xing.com / enperiod. User interactions come with timestamps and interaction type (click, bookmark, reply and delete).We called this dataset XING. The second dataset is a proprietary dataset from a Youtube-like video-on-demand website. The dataset tracks the videos watched by 13k users over a period of 2 months.Views that take less than a fixed threshold are not tracked. We called this dataset VIDEO. We manually partitioned the interaction data into sessions using a 30-minute idle threshold. For the XING dataset, we discarded interactions with the \"delete\" type."}, {"heading": "4.2 Baselines and parameter tuning", "text": "We compared our HRNN model with several baseline approaches: Personal Pop (PPOP), Item-KNN, RNN and RNN Concat: \u2219 Personal Pop (PPOP) recommends the element with the largest number of interactions by the user. \u2219 Item-KNN calculates an item-to-item cosmic similarity based on the simultaneous occurrence of items within sessions. \u2219 RNN adopts the same model described in [7]. This model uses the basic GRU with a TOP1 loss function and session parallel minibatching: sessions from the same users are fed independently to the RNN. \u2219 RNN Concat is the same as RNN, but sessions from the same users are linked in a single session. We optimize the neural models for TOP1 loss using AdaGrad [5] with dynamics for 10 axis 3."}, {"heading": "4.3 Results", "text": "This year is the highest in the history of the country."}, {"heading": "5 CONCLUSIONS AND FUTURE WORK", "text": "In this paper, we addressed the problem of personalizing session-based recommendations by proposing a model of hierarchical RNN that extends previous RNN-based session modeling with an additional GRU level that models user activity between sessions and the evolution of their interests over time. HRNN s provide a seamless way to transfer knowledge acquired from the long-term dynamics of user interest to the session level, thereby providing personalized session-based recommendations to recurring users. The proposed HRNN model outperforms both the most modern session-based RNNs and the other basic personalization strategies for session-based recommendations on two sets of data of different nature. In particular, we found that the simpler approach, which only initializes session representation at the session level, delivers the best results with the evolving user representation (HRNN Init)."}], "references": [{"title": "Random search for hyperparameter optimization", "author": ["James Bergstra", "Yoshua Bengio"], "venue": "J. Mach. Learn. Res.,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2012}, {"title": "On the properties of neural machine translation: Encoder\u2013decoder approaches", "author": ["Kyunghyun Cho", "Bart van Merri\u00ebnboer", "Dzmitry Bahdanau", "Yoshua Bengio"], "venue": "In SSST-8: 8th Workshop on Syntax, Semantics and Structure in Statistical Translation,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2014}, {"title": "Collaborative filtering with recurrent neural networks", "author": ["Robin Devooght", "Hugues Bersini"], "venue": "arXiv preprint arXiv:1608.07400,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2016}, {"title": "Adaptive subgradient methods for online learning and stochastic optimization", "author": ["John Duchi", "Elad Hazan", "Yoram Singer"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2011}, {"title": "Fast ALS-based tensor factorization for context-aware recommendation from implicit feedback. In ECML- PKDD\u201912", "author": ["B. Hidasi", "D. Tikk"], "venue": "Part II,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2012}, {"title": "Session-based recommendations with recurrent neural networks", "author": ["Bal\u00e1zs Hidasi", "Alexandros Karatzoglou", "Linas Baltrunas", "Domonkos Tikk"], "venue": "CoRR, abs/1511.06939,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2015}, {"title": "Parallel recurrent neural network architectures for feature-rich session-based recommendations", "author": ["Bal\u00e1zs Hidasi", "Massimo Quadrana", "Alexandros Karatzoglou", "Domonkos Tikk"], "venue": "In Proceedings of the 10th ACM Conference on Recommender Systems, RecSys", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2016}, {"title": "Long short-term memory", "author": ["Sepp Hochreiter", "J\u00fcrgen Schmidhuber"], "venue": "Neural computation,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 1997}, {"title": "Towards scalable and accurate item-oriented recommendations", "author": ["Noam Koenigstein", "Yehuda Koren"], "venue": "In Proceedings of the 7th ACM Conference on Recommender Systems,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2013}, {"title": "Amazon.com recommendations: Item-to-item collaborative filtering", "author": ["G. Linden", "B. Smith", "J. York"], "venue": "Internet Computing,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2003}, {"title": "A critical review of recurrent neural networks for sequence learning", "author": ["Zachary C Lipton", "John Berkowitz", "Charles Elkan"], "venue": null, "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2015}, {"title": "Improving pairwise learning for item recommendation from implicit feedback", "author": ["Steffen Rendle", "Christoph Freudenthaler"], "venue": "In Proceedings of the 7th ACM International Conference on Web Search and Data Mining,", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2014}, {"title": "Bpr: Bayesian personalized ranking from implicit feedback", "author": ["Steffen Rendle", "Christoph Freudenthaler", "Zeno Gantner", "Lars Schmidt-Thieme"], "venue": "In Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2009}, {"title": "Neurocomputing: Foundations of research. chapter Learning Internal Representations by Error Propagation, pages 673\u2013695", "author": ["D.E. Rumelhart", "G.E. Hinton", "R.J. Williams"], "venue": null, "citeRegEx": "15", "shortCiteRegEx": "15", "year": 1988}, {"title": "Item-based collaborative filtering recommendation algorithms", "author": ["Badrul Sarwar", "George Karypis", "Joseph Konstan", "John Riedl"], "venue": "Int. Conf. on World Wide Web,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2001}, {"title": "A hierarchical recurrent encoder-decoder for generative context-aware query suggestion", "author": ["Alessandro Sordoni", "Yoshua Bengio", "Hossein Vahabi", "Christina Lioma", "Jakob Grue Simonsen", "Jian-Yun Nie"], "venue": "In Proceedings of the 24th ACM International on Conference on Information and Knowledge Management,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2015}, {"title": "Dropout: A simple way to prevent neural networks from overfitting", "author": ["Nitish Srivastava", "Geoffrey Hinton", "Alex Krizhevsky", "Ilya Sutskever", "Ruslan Salakhutdinov"], "venue": "J. Mach. Learn. Res.,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2014}, {"title": "Improved recurrent neural networks for session-based recommendations", "author": ["Yong Kiam Tan", "Xinxing Xu", "Yong Liu"], "venue": "In Proceedings of the 1st Workshop on Deep Learning for Recommender Systems,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2016}, {"title": "Recurrent recommender networks", "author": ["Chao-Yuan Wu", "Amr Ahmed", "Alex Beutel", "Alexander J. Smola", "How Jing"], "venue": "In Proceedings of the Tenth ACM International Conference on Web Search and  Data Mining,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2017}], "referenceMentions": [{"referenceID": 8, "context": "Providing recommendations in these domains poses unique challenges that until recently have been mainly tackled by applying conventional recommender algorithms [10] on either the last interaction or the last session (session-based recommenders).", "startOffset": 160, "endOffset": 164}, {"referenceID": 5, "context": "Recurrent Neural Networks (RNN\u2019s) have been recently used for the purpose of session-based recommendations [7] outperforming item-based methods by 15% to 30% in terms of ranking metrics.", "startOffset": 107, "endOffset": 110}, {"referenceID": 9, "context": "recommendation approach [11, 16].", "startOffset": 24, "endOffset": 32}, {"referenceID": 14, "context": "recommendation approach [11, 16].", "startOffset": 24, "endOffset": 32}, {"referenceID": 10, "context": "RNNs are the deep models of choice when dealing with sequential data [12].", "startOffset": 69, "endOffset": 73}, {"referenceID": 7, "context": "Long Short-Term Memory (LSTM) [9] networks are a type of RNNs that have been shown to work particularly well, it includes additional gates that regulate when and how much to take the input into account and when to reset the hidden state.", "startOffset": 30, "endOffset": 33}, {"referenceID": 1, "context": "Slightly simplified version of LSTM \u2013 that still maintains all their properties \u2013 are Gated Recurrent Units (GRUs) [3] which we use in this work.", "startOffset": 115, "endOffset": 118}, {"referenceID": 5, "context": "RNNs were first used to model session data in [7].", "startOffset": 46, "endOffset": 49}, {"referenceID": 6, "context": "RNNs were also used to jointly model the content or features of items together with click-sequence interactions [8].", "startOffset": 112, "endOffset": 115}, {"referenceID": 17, "context": "In [19] proposed data augmentation techniques to improve the performance of the RNN for session-based recommendations, these techniques have though the side effect of increasing training times as a single session is split into several sub-sessions for training.", "startOffset": 3, "endOffset": 7}, {"referenceID": 18, "context": "RNN\u2019s have also been used in more standard user-item collaborative filtering settings where the aim is to model the evolution of the user and items factors [20] [4] where the results are though less impressive, with the proposed methods barely outperforming standard matrix factorization methods.", "startOffset": 156, "endOffset": 160}, {"referenceID": 2, "context": "RNN\u2019s have also been used in more standard user-item collaborative filtering settings where the aim is to model the evolution of the user and items factors [20] [4] where the results are though less impressive, with the proposed methods barely outperforming standard matrix factorization methods.", "startOffset": 161, "endOffset": 164}, {"referenceID": 15, "context": "Finally a sequence to sequence model with a version of Hierarchical Recurrent Neural Networks was used for generative context-aware query suggestion in [17].", "startOffset": 152, "endOffset": 156}, {"referenceID": 5, "context": "Our model is based on the session-based Recurrent Neural Network (RNN henceforth) model presented in [7].", "startOffset": 101, "endOffset": 104}, {"referenceID": 12, "context": "The network can be trained with several ranking loss functions such as cross-entropy, BPR [14] and TOP1 [7].", "startOffset": 90, "endOffset": 94}, {"referenceID": 5, "context": "The network can be trained with several ranking loss functions such as cross-entropy, BPR [14] and TOP1 [7].", "startOffset": 104, "endOffset": 107}, {"referenceID": 15, "context": "1To simplify the explanation we use a notation similar to [17].", "startOffset": 58, "endOffset": 62}, {"referenceID": 13, "context": ", Nm \u2212 1 (5) The model is trained end-to-end using back-propagation [15].", "startOffset": 68, "endOffset": 72}, {"referenceID": 6, "context": "For the sake of efficiency in training, we have edited the session-parallel mini-batch mechanism described in [8] to account for user identifiers during training (see Figure 2).", "startOffset": 110, "endOffset": 113}, {"referenceID": 11, "context": "Both properties are known to be beneficial for pairwise learning with implicit user feedback [13].", "startOffset": 93, "endOffset": 97}, {"referenceID": 5, "context": "\u2219 RNN adopts the same model described in [7].", "startOffset": 41, "endOffset": 44}, {"referenceID": 3, "context": "We optimize the neural models for TOP1 loss using AdaGrad [5] with momentum for 10 epochs3.", "startOffset": 58, "endOffset": 61}, {"referenceID": 16, "context": "We used dropout regularization [18] on the hidden states of RNN and HRNN .", "startOffset": 31, "endOffset": 35}, {"referenceID": 0, "context": "We tuned the hyper-parameters of each model (baselines included) on the validation set using random search [2].", "startOffset": 107, "endOffset": 110}, {"referenceID": 4, "context": "This is an accurate model for certain practical scenarios where no recommendation is highlighted and their absolute order does not matter, and strongly correlates with important KPIs such as CTR [6].", "startOffset": 195, "endOffset": 198}, {"referenceID": 5, "context": "This is in line with past results over similar datasets [7, 8].", "startOffset": 56, "endOffset": 62}, {"referenceID": 6, "context": "This is in line with past results over similar datasets [7, 8].", "startOffset": 56, "endOffset": 62}, {"referenceID": 6, "context": "To speed up evaluation, we computed the rank of the relevant item compared to the 50,000 most supported items, as done in [8].", "startOffset": 122, "endOffset": 125}], "year": 2017, "abstractText": "Session-based recommendations are highly relevant in many modern on-line services (e.g. e-commerce, video streaming) and recommendation settings. Recurrent Neural Networks have recently been shown to perform very well in sessionbased settings. While in many session-based recommendation domains user identifiers are hard to come by, there are also domains in which user profiles are readily available. We propose a seamless way to personalize RNN models with cross-session information transfer and devise a hierarchical RNN model that relies end evolves latent hidden states of the RNN\u2019s across user sessions. Results on two industry datasets show large improvements over the session-only RNN\u2019s.", "creator": "LaTeX with hyperref package"}}}