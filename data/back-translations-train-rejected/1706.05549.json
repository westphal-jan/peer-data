{"id": "1706.05549", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "17-Jun-2017", "title": "A Large-Scale CNN Ensemble for Medication Safety Analysis", "abstract": "Revealing Adverse Drug Reactions (ADR) is an essential part of post-marketing drug surveillance, and data from health-related forums and medical communities can be of a great significance for estimating such effects. In this paper, we propose an end-to-end CNN-based method for predicting drug safety on user comments from healthcare discussion forums. We present an architecture that is based on a vast ensemble of CNNs with varied structural parameters, where the prediction is determined by the majority vote. To evaluate the performance of the proposed solution, we present a large-scale dataset collected from a medical website that consists of over 50 thousand reviews for more than 4000 drugs. The results demonstrate that our model significantly outperforms conventional approaches and predicts medicine safety with an accuracy of 87.17% for binary and 62.88% for multi-classification tasks.", "histories": [["v1", "Sat, 17 Jun 2017 15:06:58 GMT  (143kb,D)", "http://arxiv.org/abs/1706.05549v1", null]], "reviews": [], "SUBJECTS": "cs.IR cs.CL", "authors": ["liliya akhtyamova", "rey ignatov", "john cardiff"], "accepted": false, "id": "1706.05549"}, "pdf": {"name": "1706.05549.pdf", "metadata": {"source": "CRF", "title": "A Large-Scale CNN Ensemble for Medication Safety Analysis", "authors": ["Liliya Akhtyamova", "Andrey Ignatov", "John Cardiff"], "emails": ["liliya.akhtyamova@postgrad.ittdublin.ie,", "andrey.ignatoff@gmail.com,", "john.cardiff@it-tallaght.ie"], "sections": [{"heading": null, "text": "Keywords: ensembles, revolutionary neural networks, drug side effects, deep learning, mood analysis"}, {"heading": "1 Introduction", "text": "Monitoring adverse drug reactions (ADR) - unintended reactions to a drug when used at the recommended dosage level have a direct relationship to the cost to public health and healthcare around the world. Drug adverse reactions result in 300,000 deaths per year in the US and Europe [1], making adverse drug reactions of paramount importance for government agencies, drug manufacturers and patients. European Medicines Agency (EMA) data show that patients do not adequately report adverse drug reactions through official channels, making it necessary to explore several different avenues of ADR monitoring. In this case, social media provides a significant source of information that offers unique opportunities and challenges for detecting adverse effects using NLP techniques. It has been shown that a large number of patients are actively involved in sharing and publishing health-related information on various health social networks [2], and thus the latter promise to be an effective tool for monitoring adverse drug reactions."}, {"heading": "2 Related Research", "text": "The earliest work on ADR extraction was [3], where the authors explored the potential of user comments for early detection of unknown ADR. This and subsequent work focused mainly on a limited number of drugs and was based on hand-crafted functionality [4]. To address the problem of lack of research in this area, a number of challenges were organized: One competition was Diegolab-2015, where the goal was to develop an algorithm to solve the problems of ADR classification and extraction; the teams showed competitive results on a difficult Twitter dataset, and the best performance was achieved by [5] with 59% F1 score for the ADR class; another work that contributed to the topic of ADR detection is [6], where the authors used a publicly available ADE corpus for binary medical case reports and achieved an F score of 77% for documents with ADR class. In [4], the authors attempted to combine ADE data from Twitter with social media (Strength) data (Daily)."}, {"heading": "3 Method", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "3.1 Input Processing", "text": "In our task, the input into the classification model takes the form of a user text entry T, which is treated as an ordered word sequence T = {w1, w2,..., wN}. First, simple words are assigned to their vector representations using a pre-trained word embedding model, which in our case is word2vec. The resulting representations are stacked into a single sentence matrix MT. If the original text T consists of N words and the dimensionality of the word embedding is d, this results in a d \u00b7 N real matrix, the i-th column of which is a vector representation of the i-th word of the sentence. This matrix is then passed to a CNN and further steps are described below."}, {"heading": "3.2 CNN architecture", "text": "The architecture of our basic CNN network is illustrated in Figure 1. It consists of a domed layer, a pooling layer and two fully connected layers. The corrugated layer contains 300 filters of size 5 x d, d being the dimensionality of word embedding or the height of the sentence matrix. The number of neurons in the fully connected layers is 1024 and 256. We use a failure technique with a failure rate of 0.2 in these layers to avoid overfitting. CNN is trained to minimize the function of cross entropy, which is supplemented by an l2 standard regulation of CNN weights, and the parameters of the network are optimized using the Adam algorithm."}, {"heading": "3.3 Ensemble of CNNs", "text": "In this paper, we propose to set up a committee of up to 40 CNNs with different structural parameters trained on the same dataset. To ensure the diversity of models, we consider CNNs with different number of coil filters (200-400), size of coil filter (4-8) and dimension of word embedding (200-300). The committee's prediction is determined by a majority vote, and from a statistical point of view, this combination of models is more powerful than a single one if submodels are uncorrelated. If they are unbiased estimates of true distribution, the combination remains unbiased but with less variance."}, {"heading": "4 Dataset Construction and Preprocessing", "text": "Each data set on this forum is left by patients and consists of the following fields: drug name, drug rating, reason for taking this drug, side effects of the drug, comments, gender, age, duration and dosage, date added. User ratings range from 1 to 5. Overall, the AskaPatient database contains 59912 publicly available reviews of about 4K medicines left over during the last 5 years. We consider the following two issues: \u2022 Binary ADR Classification: ratings 1-2 are rated as negative (as they respond to negative side effects and include ADR mentions) and ratings 4-5 are rated as positive (can be accepted as a positive drug experience). Posts with rating 3 are rated as not really positive, negative or neutral [7]. \u2022 Multi-class ADR classification: We predict all five classes listed in user ratings, as various medical test forums generally do not contain any other data except for those in the 80% rating system."}, {"heading": "5 Experiments", "text": "It is not the first time that the EU Commission has taken such a step."}, {"heading": "5.1 Experimental Setup", "text": "A word2vec neural language model is used to learn word embedding on the AskaPatient corpus. We are considering a skipgram model with window size 5 and filter words with a frequency of less than 5. The3 please send an e-mail to the authors to get access to the data set 4 askapatient.com Dimensionality of word embedding is set to 300 for a CNN-based model, while we are considering an additional embedding of size 200 for an ensemble. Constitutional neural networks are implemented in both cases for 20K iterations with a learning rate of 5e-4 and l2 regulation to 1e-2. In order to derive some basic results from the presented data set, we have also implemented two algorithms commonly used in NLP. The first is based on the sack-of-word model, which only takes into account the variety of occurring words, neither in terms of word order nor grammar, the number of words will be represented by the single vector of each word in this model."}, {"heading": "5.2 Results and Discussion", "text": "The summary results of our experiments are presented in Tables 1 and 2 for binary and multi-classifying tasks, respectively. These tables specify the predictive accuracy associated with each class of ADR for both basic and proposed methods. As can be seen, the basic CNN-based model performs significantly better than the basic approaches, and correspondingly achieves an accuracy of 85.05% and 59.11% for binary and multi-classifying tasks. Using a proposed committee of 40 CNNs dramatically improves the results, outperforming a single CNN for both tasks by more than 2% and 3.5% of the accuracy. Figure 2 shows the dependence between the number of CNNs within the ensemble and its accuracy. First, the overall performance of the ensemble grows as the number of CNNs increases, but stabilizes at the threshold corresponding to approximately 20 CNNs for binary and 40 CNNs for multi-classifying tasks. Afterwards, we observe only slight variations in the results."}, {"heading": "6 Conclusion and Future Work", "text": "In this paper, we presented an extensive ADR corpus, which was searched by a medical health forum, which contains comments on medications, user reviews, and a number of other categories that cannot be used for predictive model construction. We proposed an end-to-end solution that is based on a large ensemble of revolutionary neural networks and, unlike many previous work, does not require handcrafted features and data pre-processing. Our experimental results show that the proposed model significantly exceeds the basic methods and introduces a major improvement in the standard CNN-based methodology. We see several ways to improve the existing solution. First, a larger number of models can be included in the overall set, in particular, it may be useful to include recurring neural networks in consideration. Second, a more sophisticated way to form a committee, for example by bagging or promoting CNNs. Finally, we plan to build the existing dataset to include data from other menu types and forums."}], "references": [{"title": "Why We Need an Efficient and Careful Pharmacovigilance? Journal of Pharmacovigilance", "author": ["R. Businaro"], "venue": null, "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2013}, {"title": "Social media use in the United States: implications for health communication", "author": ["Chou", "W.y.S.", "Y.M. Hunt", "E.B. Beckjord", "R.P. Moser", "B.W. Hesse"], "venue": "Journal of medical Internet research 11(4)", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2009}, {"title": "Towards Internet-Age Pharmacovigilance: Extracting Adverse Drug Reactions from User Posts to Health-Related Social Networks", "author": ["R. Leaman", "L. Wojtulewicz", "R. Sullivan", "A. Skariah", "J. Yang", "G. Gonzalez"], "venue": "Proceedings of the 2010 workshop on biomedical natural language processing. Association for Computational Linguistics", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2010}, {"title": "Utilizing Social Media Data for Pharmacovigilance: A Review HHS Public Access", "author": ["A. Sarker", "R. Ginn", "A. Nikfarjam", "K. O \u2019connor", "K. Smith", "S. Jayaraman", "G. Gonzalez"], "venue": "J Biomed Inform 54", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2015}, {"title": "Social Media Mining for Toxicovigilance: Automatic Monitoring of Prescription Medication Abuse from Twitter", "author": ["A. Sarker", "K. OConnor", "R. Ginn", "M. Scotch", "K. Smith", "D. Malone", "G. Gonzalez"], "venue": "Drug Safety 39(3)", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2016}, {"title": "Extraction of potential adverse drug events from medical case reports", "author": ["H. Gurulingappa", "A. Mateen-Rajput", "L. Toldo"], "venue": "Journal of biomedical semantics 3(1)", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2012}, {"title": "Detecting Adverse Drug Reactions Using a Sentiment Classification Framework", "author": ["H. Sharif", "F. Zaffar", "A. Abbasi", "D. Zimbra"], "venue": "Proceedings of the sixth ASE international conference on social computing (SocialCom)", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2014}, {"title": "Training linear SVMs in linear time", "author": ["T. Joachims", "Thorsten"], "venue": "Proceedings of the 12th ACM SIGKDD international conference on Knowledge discovery and data mining - KDD \u201906, New York, New York, USA, ACM Press", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2006}, {"title": "Swisscheese at semeval-2016 task 4: Sentiment classification using an ensemble of convolutional neural networks with distant supervision", "author": ["J. Deriu", "M. Gonzenbach", "F. Uzdilli", "A. Lucchi", "V.D. Luca", "M. Jaggi"], "venue": "Proceedings of the 10th International Workshop on Semantic Evaluation.", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2016}, {"title": "Sequence to sequence learning with neural networks", "author": ["I. Sutskever", "O. Vinyals", "Q.V. Le"], "venue": "In Ghahramani, Z., Welling, M., Cortes, C., Lawrence, N.D., Weinberger, K.Q., eds.: Advances in Neural Information Processing Systems 27. Curran Associates, Inc.", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2014}], "referenceMentions": [{"referenceID": 0, "context": "Side effects of medicines lead to 300 thousand deaths per year in the USA and Europe [1], therefore revealing adverse drug reactions is of paramount importance for the government authorities, drug manufacturers, and patients.", "startOffset": 85, "endOffset": 88}, {"referenceID": 1, "context": "It was shown that a large population of patients are actively involved in sharing and posting health-related information in various healthcare social networks [2], and thus the latter promise to be a powerful tool for monitoring ADR.", "startOffset": 159, "endOffset": 162}, {"referenceID": 2, "context": "The earliest work on ADR extraction was [3], where the authors investigated the potential of user comments for early detection of unknown ADR.", "startOffset": 40, "endOffset": 43}, {"referenceID": 3, "context": "This and the subsequent works were mainly focused on a limited number of drugs and were based on hand-designed features [4].", "startOffset": 120, "endOffset": 123}, {"referenceID": 4, "context": "The teams showed competitive results on a difficult Twitter dataset, and the best performance was achieved by [5] with 59% F1-score for ADR class.", "startOffset": 110, "endOffset": 113}, {"referenceID": 5, "context": "Another work contributing to the topic of ADR detection is [6], where the authors used a publicly available ADE corpus for binary medical case reports classification and achieved an F-score of 77% for documents with ADR.", "startOffset": 59, "endOffset": 62}, {"referenceID": 3, "context": "In [4] the authors tried to combine ADE corpus with data from social media (DailyStrength, Twitter).", "startOffset": 3, "endOffset": 6}, {"referenceID": 6, "context": "In [7] the authors extracted semantic, sentiment, and affect features from two datasets (AskaPatient and Pharma tweets) and classified them using SVM with linear kernel [8].", "startOffset": 3, "endOffset": 6}, {"referenceID": 7, "context": "In [7] the authors extracted semantic, sentiment, and affect features from two datasets (AskaPatient and Pharma tweets) and classified them using SVM with linear kernel [8].", "startOffset": 169, "endOffset": 172}, {"referenceID": 8, "context": "In [9] the authors combined two separate CNNs with different architectures for the task of Twitter Sentiment Analysis.", "startOffset": 3, "endOffset": 6}, {"referenceID": 9, "context": "In [10] an ensemble of five CNNs was used for English to French machine translation, where it demonstrated superior results compared to a single network.", "startOffset": 3, "endOffset": 7}, {"referenceID": 6, "context": "Posts with rating 3 are ignored as not truly positive, negative or neutral [7].", "startOffset": 75, "endOffset": 78}], "year": 2017, "abstractText": "Revealing Adverse Drug Reactions (ADR) is an essential part of post-marketing drug surveillance, and data from health-related forums and medical communities can be of a great significance for estimating such effects. In this paper, we propose an end-to-end CNNbased method for predicting drug safety on user comments from healthcare discussion forums. We present an architecture that is based on a vast ensemble of CNNs with varied structural parameters, where the prediction is determined by the majority vote. To evaluate the performance of the proposed solution, we present a large-scale dataset collected from a medical website that consists of over 50 thousand reviews for more than 4000 drugs. The results demonstrate that our model significantly outperforms conventional approaches and predicts medicine safety with an accuracy of 87.17% for binary and 62.88% for multi-classification tasks.", "creator": "LaTeX with hyperref package"}}}