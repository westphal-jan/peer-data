{"id": "1709.00322", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "29-Aug-2017", "title": "Disintegration and Bayesian Inversion, Both Abstractly and Concretely", "abstract": "The notions of disintegration and Bayesian inversion are fundamental in conditional probability theory. They produce channels, as conditional probabilities, from a joint state, or from an already given channel (in opposite direction). These notions exist in the literature, in concrete situations, but are presented here in abstract graphical formulations. The resulting abstract descriptions are used for proving basic results in conditional probability theory. The existence of disintegration and Bayesian inversion is discussed for discrete probability, and also for measure-theoretic probability --- via standard Borel spaces and via likelihoods. Finally, the usefulness of disintegration and Bayesian inversion is illustrated in several non-trivial examples.", "histories": [["v1", "Tue, 29 Aug 2017 13:01:07 GMT  (99kb,D)", "http://arxiv.org/abs/1709.00322v1", null]], "reviews": [], "SUBJECTS": "cs.AI", "authors": ["kenta cho", "bart jacobs"], "accepted": false, "id": "1709.00322"}, "pdf": {"name": "1709.00322.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": [], "sections": [{"heading": null, "text": "Disintegration and Bayesian inversion, both abstract and concrete \u2020 KENTA CHO and BART JACOBSInstitute for Computing and Information Sciences Radboud University P.O.Box 9010, 6500 GL Nijmegen, the Netherlands Received September 4, 2017The terms disintegration and Bayesian inversion are fundamental to conditional probability theory. They generate channels, as conditional probabilities, from a common state or from an already given channel (in the opposite direction). These terms exist in literature, in concrete situations, but are presented here in abstract graphical formulations. The resulting abstract descriptions serve to prove fundamental results in conditional probability theory. The existence of disintegration and Bayesian inversion is discussed for discrete probabilities and also for dimensional probabilities - via standard Borel spaces and about probabilities. Finally, the usefulness of disintegration and Bayesian inversion is not illustrated in several examples."}, {"heading": "1. Introduction", "text": "In fact, it is not that we are in a situation where we are in a situation where we are not in a position to change things, in a situation in which we are in a position and in which we are not in a position to resolve them."}, {"heading": "2. Graphical language", "text": "The basic idea behind this paper is to describe the probability theory in relation to channels."}, {"heading": "3. Marginalisation, integration and disintegration", "text": "Let C be an affine CD category. We think of states \u03c9: I \u2192 X in C as abstract (probability) distributions on type X. States of the form \u03c9: I \u00b7 X \u2212 \u2212 Y, often referred to as (bipartite) common states, are considered common distributions on X and Y. Later, we will also consider npartite common states, but for the time being we will limit ourselves to bipartite states. For a common distribution P (x, y) in ordinary discrete states, we can calculate the marginal distribution on X and Y by adding (or marginalizing) Y out, as P (x) y (x, y). Thematic distribution on Y is also calculated by P (y). In our abstract setting, we can expect a common state: I \u2192 X Y, we can get marginalizations by simply adding marginal states like in:."}, {"heading": "4. Example: naive Bayesian classifiers via inversion", "text": "The distribution describes the probability, for each data (classification) category, that the sample data is in this category. Here, we will consider an example of \"naive\" Bayesian classification, in which the properties are assumed to be independent. We will consider a standard classification example from literature that forms an ideal setting to illustrate the use of both disintegration and Bayesian inversion. Resolution is used to extract channels from a given table, and then the Bayesian inversion is applied to (the tuple) of those channels to obtain the actual classification. The use of channels and disintegration in this classification setting is new, so far as we use the calculations in this example, we will use the EfProb library (Cho and Jacobs, 2017) from which we explain the notation for marginalization and disintegration."}, {"heading": "5. Almost equality of channels", "text": "This section explains how the standard term from \"equality to negligible sets\" or \"equality almost everywhere\" (in terms of a measurement) can be expressed abstractly using string diagrams. About this Bayesian inversion, we can say that (Clerc et al., 2017) we are looking at an affine CD category, which is continued in the setting of Section 3.1. Let c, d: X \u2192 Y be two parallel channels, namely: I \u2192 X be a state in their domain. We say that c is almost identical to d, written as c: It is obvious that it is an equivalent relationship on channels of type X \u2192 Y. If S is a set of arrows of type X \u2192 Y, we write S / II for the quotient Y plane. To put it more intuitively, we have c: It is a c-shaped relationship on d iff c and d."}, {"heading": "6. Conditional independence", "text": "We are looking at an affine CD category that allows a resolution = 41. We have so far concentrated on two-part states - with the exception of the classification example in Section 4. To deal with a general n-partite state, an n-partite state must be treated as follows: I \u2192 X1. We will use several notations and conventions in definitions 6.1, 6.2 and 6.3 below; they are in accordance with standard practice in probability theory. In the conventions, an n-partite state, as below, is fixed and implicitly used. X1 X2 XnDefinition 6.1 and 6.3 below; they are in accordance with standard practice in probability theory."}, {"heading": "7. Beyond causal channels", "text": "All CD categories we have looked at so far are affin in the sense that all arrows f: X \u2192 Y are causal: either f =. We now drop affinity to expand our category to include \"non-causal\" arrows. Essentially, we lose nothing from this change: all previous arguments can still be applied to the subcategory Caus (C), which contains all objects and causal arrows. Caus (C) inherits the monoidal structure of C and the comonoid structures on each object, so Caus (C) is an affine CD category. Recall what channels in C are causal arrows, i.e. the states are channels of the form: I \u2192 X. We call endomaps I \u2192 I on the tensor unit scalars."}, {"heading": "D: 0.9 | ~D: 0.05", "text": "> > > s = w / (pos _ test @ truth (mood _ dom)) > > > s% [0,1] 0,126 | M > + 0,874 | ~ M > A positive test clearly leads to a decrease in mood: a decrease from 0,45 to 0,126. Next, we will show how this result can also be achieved by resolving the previous joint condition w. There are two ways to do this: by resolution in the first component and predicate transformation (backward inference) or by resolution in the second component and state transformation (forward inference) The first way corresponds to the expression on the left in (8): > > > c1 = w / / [1,0] > w1 / (c1 < < pos _ test) 0,126 | M > + 0,874 | ~ M > On resolution in the second component, we get the same result as in (8): > > > > > c2 = w / / / [0,1] > c2 > > w2 > 0.74 | 0.2 of these approaches > / m."}, {"heading": "8. Disintegration via likelihoods", "text": "The aim of this section is to introduce theorem 8.3, which generalizes a construction of Bayesian inversion using densities / probabilities. We first introduce \"probabilities\" in our setting. Definition 8.1. We say that a channel c: X \u2192 Y is represented by an effect \"on X-Y in relation to an arrow constellation. (12) We call\" a probability relationship for channel c in relation to channel sfKrn, which definition says: a kernel c: X-Y in relation to an arrow constellation. c (x, B) = \"a probability relationship for channel c in relation to channel c.\" In the category sfKrn, which definition says: a kernel c: X-Y in relation to the constellation. (x, Y) for a kernel relationship. (dy) for a kernel relationship: X-Y (dy) in relation to a kernel: X-Y (identifiable)."}], "references": [{"title": "Categorical quantum mechanics", "author": ["S. Abramsky", "B. Coecke"], "venue": "Handbook of Quantum", "citeRegEx": "Abramsky and Coecke,? 2009", "shortCiteRegEx": "Abramsky and Coecke", "year": 2009}, {"title": "Logic and Quantum Structures: Quantum Logic, pages 261\u2013323", "author": ["N.L. Ackerman", "C.E. Freer", "D.M. Roy"], "venue": null, "citeRegEx": "Ackerman et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Ackerman et al\\.", "year": 2011}, {"title": "Bayesian machine learning", "author": ["J. T", "D. Pollard"], "venue": "Logical Methods in Comp. Sci.,", "citeRegEx": "T. and Pollard,? \\Q1997\\E", "shortCiteRegEx": "T. and Pollard", "year": 1997}, {"title": "The EfProb library for probabilistic calculations", "author": ["K. Cho", "B. Jacobs"], "venue": null, "citeRegEx": "Cho and Jacobs,? \\Q2017\\E", "shortCiteRegEx": "Cho and Jacobs", "year": 2017}, {"title": "Algebra and Coalgebra in Computer Science, volume 72 of LIPIcs", "author": ["K. Dagstuhl. Cho", "B. Jacobs", "A. Westerbaan", "B. Westerbaan"], "venue": null, "citeRegEx": "Cho et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Cho et al\\.", "year": 2015}, {"title": "Terminality implies no-signalling ...and much more than that", "author": ["B. 355\u2013369. Springer. Coecke"], "venue": null, "citeRegEx": "Coecke,? \\Q2016\\E", "shortCiteRegEx": "Coecke", "year": 2016}, {"title": "Picturing Quantum Processes: A First Course", "author": ["B. Coecke", "A. Kissinger"], "venue": null, "citeRegEx": "Coecke and Kissinger,? \\Q2017\\E", "shortCiteRegEx": "Coecke and Kissinger", "year": 2017}, {"title": "Scalars, monads and categories", "author": ["Theory", "D. Diagrammatic Reasoning. Cambridge University Press. Coumans", "B. Jacobs"], "venue": "Heunen, C., Sadrzadeh,", "citeRegEx": "Theory et al\\.,? 2013", "shortCiteRegEx": "Theory et al\\.", "year": 2013}, {"title": "Quantum Theory from First Principles", "author": ["G.M. D\u2019Ariano", "G. Chiribella", "P. Perinotti"], "venue": "Categorical Structures,", "citeRegEx": "D.Ariano et al\\.,? \\Q2017\\E", "shortCiteRegEx": "D.Ariano et al\\.", "year": 2017}, {"title": "Identifying independence in Bayesian networks", "author": ["T. Verma", "J. Pearl"], "venue": null, "citeRegEx": "Geiger et al\\.,? \\Q2000\\E", "shortCiteRegEx": "Geiger et al\\.", "year": 2000}, {"title": "A categorical approach to probability theory", "author": ["M. Giry"], "venue": "In Categorical Aspects of Topology", "citeRegEx": "Giry,? \\Q1982\\E", "shortCiteRegEx": "Giry", "year": 1982}, {"title": "New directions in categorical logic, for classical, probabilistic and quantum", "author": ["B. ACM. Jacobs"], "venue": "Future of Software Engineering,", "citeRegEx": "Jacobs,? \\Q2015\\E", "shortCiteRegEx": "Jacobs", "year": 2015}, {"title": "A predicate/state transformer semantics for Bayesian learning", "author": ["B. Jacobs", "F. Zanasi"], "venue": null, "citeRegEx": "Jacobs and Zanasi,? \\Q2016\\E", "shortCiteRegEx": "Jacobs and Zanasi", "year": 2016}, {"title": "A formal semantics of influence in Bayesian reasoning", "author": ["B. Elsevier. Jacobs", "F. Zanasi"], "venue": null, "citeRegEx": "Jacobs and Zanasi,? \\Q2017\\E", "shortCiteRegEx": "Jacobs and Zanasi", "year": 2017}, {"title": "Random Measures, Theory and Applications", "author": ["Math. Found"], "venue": "LIPIcs. Schloss Dagstuhl. Kallenberg, O", "citeRegEx": "Found.,? \\Q2017\\E", "shortCiteRegEx": "Found.", "year": 2017}, {"title": "Abstract tensor systems as monoidal categories. In Categories and Types", "author": ["A. Springer. Kissinger"], "venue": null, "citeRegEx": "Kissinger,? \\Q2014\\E", "shortCiteRegEx": "Kissinger", "year": 2014}, {"title": "Categories for the Working Mathematician. Springer, second edition", "author": ["S. Springer. Mac Lane"], "venue": "Pachl, J. K", "citeRegEx": "Lane,? \\Q1998\\E", "shortCiteRegEx": "Lane", "year": 1998}, {"title": "Probabilistic Reasoning in Intelligent Systems", "author": ["J. Clarendon Press. Pearl"], "venue": "Morgan Kaufmann. Pollard, D. (2002). A User\u2019s Guide to Measure Theoretic Probability. Cambridge University", "citeRegEx": "Pearl,? 1988", "shortCiteRegEx": "Pearl", "year": 1988}, {"title": "A survey of graphical languages for monoidal categories", "author": ["P. Press. Selinger"], "venue": "New Structures", "citeRegEx": "Selinger,? 2010", "shortCiteRegEx": "Selinger", "year": 2010}, {"title": "Exact Bayesian inference by symbolic disintegration", "author": ["Springer. Shan", "C.-c", "N. Ramsey"], "venue": "Notes in Physics,", "citeRegEx": "Shan et al\\.,? \\Q2017\\E", "shortCiteRegEx": "Shan et al\\.", "year": 2017}, {"title": "Commutative semantics for probabilistic programming", "author": ["S. ACM. Staton"], "venue": "Princ. of Programming Languages,", "citeRegEx": "Staton,? \\Q2017\\E", "shortCiteRegEx": "Staton", "year": 2017}, {"title": "Counterexamples in Probability", "author": ["J.M. ACM. Stoyanov"], "venue": "Computer Science,", "citeRegEx": "Stoyanov,? \\Q2014\\E", "shortCiteRegEx": "Stoyanov", "year": 2014}, {"title": "Data Mining Practical Machine Learning Tools", "author": ["I. Intelligence. Witten", "E. Frank", "M. Hall"], "venue": null, "citeRegEx": "Witten et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Witten et al\\.", "year": 2011}], "referenceMentions": [{"referenceID": 17, "context": "They form the nodes of Bayesian networks (Pearl, 1988; Bernardo and Smith, 2000; Barber, 2012),", "startOffset": 41, "endOffset": 94}, {"referenceID": 18, "context": "This language can be seen as the internal language of symmetric monoidal categories (Selinger, 2010) \u2014 with comonoids in our case.", "startOffset": 84, "endOffset": 100}, {"referenceID": 12, "context": ", 2017) and in (Jacobs et al., 2015; Jacobs and Zanasi, 2016; Jacobs, 2017).", "startOffset": 15, "endOffset": 75}, {"referenceID": 11, "context": "The latter references use effectus theory (Jacobs, 2015; Cho et al., 2015), a new comprehensive approach aimed at covering the logic of both quantum theory and probability theory, supported by a Python-based tool \u2018EfProb\u2019, for \u2018effectus probability\u2019.", "startOffset": 42, "endOffset": 74}, {"referenceID": 4, "context": "The latter references use effectus theory (Jacobs, 2015; Cho et al., 2015), a new comprehensive approach aimed at covering the logic of both quantum theory and probability theory, supported by a Python-based tool \u2018EfProb\u2019, for \u2018effectus probability\u2019.", "startOffset": 42, "endOffset": 74}, {"referenceID": 21, "context": "(Pollard, 2002; Panangaden, 2009; Chang and Pollard, 1997): it may not exist (Stoyanov, 2014); even if it exists it may be determined only up to negligible sets; and it may not be continuous or computable (Ackerman et al.", "startOffset": 77, "endOffset": 93}, {"referenceID": 1, "context": "(Pollard, 2002; Panangaden, 2009; Chang and Pollard, 1997): it may not exist (Stoyanov, 2014); even if it exists it may be determined only up to negligible sets; and it may not be continuous or computable (Ackerman et al., 2011).", "startOffset": 205, "endOffset": 228}, {"referenceID": 22, "context": "A standard example from the literature (Witten et al., 2011) is redescribed in the current setting: first, channels are extracted via disintegration from a table with given data; next, Bayesian inversion is applied to the combined extracted channels, giving the required classification.", "startOffset": 39, "endOffset": 60}, {"referenceID": 12, "context": "The main result relates conditioning of joint states to forward and backward inference via the extracted channels, in the style of (Jacobs and Zanasi, 2016); it is illustrated in a concrete example, where a Bayesian network is seen as a graph in a Kleisli category \u2014 following (Fong, 2012).", "startOffset": 131, "endOffset": 156}, {"referenceID": 18, "context": "The use of string diagrams is justified by the following \u2018coherence\u2019 theorem, see (Selinger, 2010).", "startOffset": 82, "endOffset": 98}, {"referenceID": 6, "context": "Jacobs 6 The term \u2018causal\u2019 comes from (categorical) quantum foundation (Coecke and Kissinger, 2017; D\u2019Ariano et al., 2017), and is related to relativistic causality, see e.", "startOffset": 71, "endOffset": 122}, {"referenceID": 8, "context": "Jacobs 6 The term \u2018causal\u2019 comes from (categorical) quantum foundation (Coecke and Kissinger, 2017; D\u2019Ariano et al., 2017), and is related to relativistic causality, see e.", "startOffset": 71, "endOffset": 122}, {"referenceID": 5, "context": "(Coecke, 2016).", "startOffset": 0, "endOffset": 14}, {"referenceID": 10, "context": "This G is a monad on the category Meas of measurable spaces, with measurable functions between them; it is called the Giry monad, after (Giry, 1982; Jacobs, 2017).", "startOffset": 136, "endOffset": 162}, {"referenceID": 21, "context": "In fact, a disintegration may not exist (Stoyanov, 2014).", "startOffset": 40, "endOffset": 56}, {"referenceID": 3, "context": "For the calculations in this example we use the EfProb library (Cho and Jacobs, 2017), of which we explain the notation for marginalisation and disintegration.", "startOffset": 63, "endOffset": 85}, {"referenceID": 22, "context": "Weather and play data, copied from (Witten et al., 2011).", "startOffset": 35, "endOffset": 56}, {"referenceID": 22, "context": "It involves the classification of \u2018playing\u2019 (yes or no) for certain weather data, used in (Witten et al., 2011).", "startOffset": 90, "endOffset": 111}, {"referenceID": 22, "context": "5% that is computed in (Witten et al., 2011) \u2014 in a rather ad hoc manner, without much of a theoretical basis.", "startOffset": 23, "endOffset": 44}, {"referenceID": 22, "context": "We shall not repeat the table and refer to (Witten et al., 2011) for details.", "startOffset": 43, "endOffset": 64}, {"referenceID": 22, "context": "The mean and standard deviation values are copied from (Witten et al., 2011).", "startOffset": 55, "endOffset": 76}, {"referenceID": 22, "context": "The value computed in (Witten et al., 2011) is 20.", "startOffset": 22, "endOffset": 43}, {"referenceID": 15, "context": "(Kissinger, 2014)).", "startOffset": 0, "endOffset": 17}, {"referenceID": 20, "context": "2 For general, measure-theoretic probability, we use s-finite kernels between measurable spaces (Kallenberg, 2017; Staton, 2017).", "startOffset": 96, "endOffset": 128}, {"referenceID": 20, "context": "For more technical details we refer to (Kallenberg, 2017; Staton, 2017).", "startOffset": 39, "endOffset": 71}, {"referenceID": 13, "context": "This is called \u2018crossover influence\u2019 in (Jacobs and Zanasi, 2017).", "startOffset": 40, "endOffset": 65}, {"referenceID": 12, "context": "(8) Following (Jacobs and Zanasi, 2016) we can say that the expression on the left in (8) uses backward inference, and the one on the right uses forward inference.", "startOffset": 14, "endOffset": 39}, {"referenceID": 3, "context": "We formalise this example in the EfProb language (Cho and Jacobs, 2017), see also Section 4.", "startOffset": 49, "endOffset": 71}], "year": 2017, "abstractText": "The notions of disintegration and Bayesian inversion are fundamental in conditional probability theory. They produce channels, as conditional probabilities, from a joint state, or from an already given channel (in opposite direction). These notions exist in the literature, in concrete situations, but are presented here in abstract graphical formulations. The resulting abstract descriptions are used for proving basic results in conditional probability theory. The existence of disintegration and Bayesian inversion is discussed for discrete probability, and also for measure-theoretic probability \u2014 via standard Borel spaces and via likelihoods. Finally, the usefulness of disintegration and Bayesian inversion is illustrated in several non-trivial examples.", "creator": "LaTeX with hyperref package"}}}