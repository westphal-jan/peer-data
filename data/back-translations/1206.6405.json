{"id": "1206.6405", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "27-Jun-2012", "title": "Bounded Planning in Passive POMDPs", "abstract": "In the case of passive POMDPs, measures do not affect the global state, but still have a cost. If the agent is constrained by restrictions on information processing, he can only approximately believe in faith. We present a principle of variation on the problem of information maintenance that is most useful to minimize costs, and introduce an efficient and simple algorithm to find the optimum.", "histories": [["v1", "Wed, 27 Jun 2012 19:59:59 GMT  (899kb)", "http://arxiv.org/abs/1206.6405v1", "Appears in Proceedings of the 29th International Conference on Machine Learning (ICML 2012)"]], "COMMENTS": "Appears in Proceedings of the 29th International Conference on Machine Learning (ICML 2012)", "reviews": [], "SUBJECTS": "cs.LG cs.AI stat.ML", "authors": ["roy fox", "naftali tishby"], "accepted": true, "id": "1206.6405"}, "pdf": {"name": "1206.6405.pdf", "metadata": {"source": "META", "title": "Bounded Planning in Passive POMDPs", "authors": ["Roy Fox", "Naftali Tishby"], "emails": ["royf@cs.huji.ac.il", "tishby@cs.huji.ac.il"], "sections": [{"heading": "1. Introduction", "text": ""}, {"heading": "1.1. Passive POMDPs Planning", "text": "Planning in Partially Observable Markov Decision Processes (POMDPs) is an important task in reinforcement learning, which models an agent\u2019s interaction with its environment as a discrete-time stochastic process. The environment goes through a sequence of world states W1, . . . ,Wn in a finite domain W. These states are hidden from the agent except for an observation Ot in a finite domain O, distributed by \u03c3(Ot|Wt).\nIn the standard POMDP, the agent then chooses an action, which affects the next world state and incurs a cost. Here we consider Passive POMDPs, in which the action affects the cost, but not the world state. We assume that the world itself is a Markov Chain, with states governed by a time-independent transition probability function p(Wt|Wt\u22121) and an initial distribution P1(W1).\nThe agent maintains an internal memory state Mt in a finite domainM. In each step the memory state is updated from the previous memory state and the current observation, according to a memory-state transition function qt(Mt|Mt\u22121, Ot) which serves as an inference policy. Figure 1 summarizes the stochastic process.\nAppearing in Proceedings of the 29 th International Conference on Machine Learning, Edinburgh, Scotland, UK, 2012. Copyright 2012 by the author(s)/owner(s).\nThe agent\u2019s goal is to minimize the average expected cost of its actions. In this paper we take the agent\u2019s memory state to represent the action, and define a cost function d : W \u00d7M \u2192 R on the world and memory states. The planning task is then to minimize\n1\nn n\u2211 t=1 E Wt,Mt d(Wt,Mt)\ngiven the model parameters P1, p, \u03c3 and d.\nA Passive POMDP can be viewed as an HMM in which inference quality is measured by a cost function. Examples of Passive POMDPs include various gambling scenarios, such as the stock exchange or horse racing, where the betting does not affect the world state. In some settings, the reward depends directly on the amount of information that the agent has on the world state (Kelly gambling, see Cover & Thomas, 2006).\nWhen the agent is unbounded it has a simple deterministic optimal inference policy. It can maintain a belief Bt(Wt|O(t)), which is the posterior probability of the world state Wt given the observable history O(t) = O1, . . . , Ot. The belief is a minimal sufficient statistic of O(t) for Wt, and therefore keeps all the relevant information. It can be computed sequentially by a forward algorithm, starting with B1(W1|O1) \u221d P1(W1)\u03c3(O1|W1), and at each step updating\nBt(Wt|O(t)) \u221d \u2211 wt\u22121 Bt\u22121(wt\u22121|O(t\u22121))p(Wt|wt\u22121)\u03c3(Ot|Wt),\nnormalized to be a probability vector."}, {"heading": "1.2. Information Constraints", "text": "The sufficiency of the exact belief allows the agent to minimize the external cost, but it incurs significant internal costs. The amount of information which the agent needs to keep in memory can be large, and even each observation can be more than the agent can grasp. Anyway, not all of this information is equally useful in reducing external costs.\nIn general, the agent\u2019s information-processing capacity may be bounded in two ways:\n1. The capacity of the agent\u2019s memory may limit its information rate between Mt\u22121 and Mt, to RM .\n2. The capacity of the channel from the agent\u2019s sensors to its memory may limit the rate at which the agent is able to process the observation Ot while it is available, to RS .\nThe requirement that the agent keeps sufficient statistics and exact beliefs is unrealistic. Rather, the agent\u2019s memory Mt must be a statistic of O(t) which is not sufficient, but is still \u201dgood\u201d in the sense that it keeps the external cost low. We also want it to be \u201dminimal\u201d for that level of quality, in terms of information-processing rates, so that the agent keeps only information which is useful enough. For each step individually, this is exactly the notion captured by rate-distortion theory, and here we have a sequential extension of it.\nThe main results of this paper are the formulation of the setting described above, and the introduction of an efficient and simple algorithm to solve it. We prove that the algorithm converges to a local optimum, and demonstrate in simulations the tradeoff of memory and sensing intrinsic to this setting. The application of our results to previously studied problems, and a comparison to existing algorithms, are left for future work.\nThis paper is organized as follows. In section 2 we formulate out setting in information-theoretical terms. In section 3 we solve the problem for one step by finding a variational principle and an efficient optimization algorithm. In section 4 we analyze the complete sequential problem and introduce an algorithm to solve it. In section 5 we show two simulations of our solution."}, {"heading": "1.3. Related Work", "text": "Unconstrained planning in Passive POMDPs is easily done by maintaining the exact belief, and choosing each action to minimize the subjective expected cost. Planning in general POMDPs is harder, in one aspect due to the size of the belief space. Many algorithms plan efficiently but approximately by focusing on a subset of this space.\nSeveral works do so by optimizing a finite-state controller of a given size (Poupart & Boutilier, 2003; Amato et al., 2010). The belief represented by each state of the controller is then the posterior probability of the world state given that memory state. A different approach is to explicitly select a subset of beliefs, and use them to guide the iterations (Pineau et al., 2003). Another is to reduce the dimension of the belief space to its principle components (Roy & Gordon, 2002).\nIn this paper we present the novel setting of planning in Passive POMDPs which is constrained by information capacities. This setting allows treatment of reinforcement learning in an information-theoretic framework. It may also provide a principled method for belief approximation in general POMDPs. With a fixed action policy the POMDP becomes a Passive POMDP, and a bounded inference policy can be computed. This reduces the belief space, which in turn guides the action planning. This decoupling is similar to Chrisman (1992), and will be explored in future work.\nSome research treats POMDPs where the cost is the DKL between the distributions of the next world state when it is controlled and uncontrolled (Todorov, 2006; Kappen et al., 2009). This has interesting analogies to our setting. Our information-rate constraints define, in effect, components of the cost which are the DKL between the distribution of the next memory state and its marginals (see section 3.1). Tishby & Polani (2011) combine similar information-rate constraints of perception and action together. Future work will explore and exploit this symmetry in the special case where the memory information rate is unconstrained."}, {"heading": "2. Preliminaries", "text": "Assume that the model parameters P1, p, \u03c3 and d are given. The agent strives to find an inference policy q(n) such that the average expected cost satisfies\n1\nn n\u2211 t=1 E Wt,Mt d(Wt,Mt) \u2264 D.\nfor the minimal D possible. However, the agent operates under capacity constraints on the channels from Mt\u22121 and Ot to Mt. The external cost d parallels the distortion in rate-distortion theory, while the internal costs are information rates. The agent actually needs to minimize a combination of these costs.\nNote that the agent will generally have some information on the next observation even before seeing it, i.e. Mt\u22121 and Ot will not be independent. The agent therefore has some freedom in choosing what part of the information common to Mt\u22121 and Ot it remembers, and what part it forgets and observes anew.\nThe average information rate in both channels combined cannot exceed their total capacity, that is\n1\nn n\u2211 t=1 I(Mt\u22121, Ot;Mt) \u2264 RM +RS .\nIn addition, in each step the portion of the above information that is absent from Ot may only be passed on the memory channel, and so\n1\nn n\u2211 t=1 I(Mt\u22121;Mt|Ot) \u2264 RM .\nSimilarly, information absent from Mt\u22121 is subject to the sensory channel capacity\n1\nn n\u2211 t=1 I(Ot;Mt|Mt\u22121) \u2264 RS .\nThe distortion constraint and the three informationrate constraints together form the problem of inference-planning in Passive POMDPs (Problem 1 ).\nThe emergence of three information-rate constraints for two channels is similar in spirit to multiterminal source coding (Berger, 1977). In their terminology, the agent needs to implement in each Mt a lossy coding of the correlated sources Mt\u22121 and Ot, under capacity constraints, so as to minimize an average expected distortion. The main difference is that here we chose to allow the encoding not to be distributed, in keeping with the ability of memory to interact with perception in biological agents (Laeng & Endestad, 2012)."}, {"heading": "3. One-Step Optimization", "text": ""}, {"heading": "3.1. Variational Principle", "text": "Before we consider the long-term planning required of the agent in Problem 1, we focus on the choice of qn in the final step, given the other transitions, that is, given the joint distribution of Mn\u22121, Wn and On. We define the joint belief \u03b8n(Mn\u22121,Wn) to be the joint distribution of Mn\u22121 and Wn, and have\nPr \u03b8n\n(Mn\u22121,Wn, On) = \u03b8n(Mn\u22121,Wn)\u03c3(On|Wn).\nWe are interested in the rate-distortion region which includes all points (RM , RS , D) which are achievable, that is, for which there exists some qn(Mn|Mn\u22121, On) with\nD\u03b8n(qn) def = E\nWn,Mn d(Wn,Mn) \u2264 D\nIC,\u03b8n(qn) def = I(Mn\u22121, On;Mn) \u2264 RM +RS\nIM,\u03b8n(qn) def = I(Mn\u22121;Mn|On) \u2264 RM\nIS,\u03b8n(qn) def = I(On;Mn|Mn\u22121) \u2264 RS .\nFor any information-rate pair (RM , RS), the minimal achievable D lies on the boundary D\u2217\u03b8n(RM , RS) of the rate-distortion region. When \u03b8n and qn are clear from context, we refer to these quantities as D, IC , IM , IS and D\u2217. We find D\u2217(RM , RS) by minimizing the expected distortion under information-rate constraints. The minimum exists because all our formulas are continuous, and the solution space for qn is closed.\nLet q\u0304n(Mn|Mn\u22121), q\u0304n(Mn|On) and q\u0304n(Mn) be the marginals of qn(Mn|Mn\u22121, On). We expand the terms of the problem using these conditional probability distributions, to have\nmin qn,q\u0304n E Mn\u22121,Wn,On \u2211 mn qn(mn|Mn\u22121, On)d(Wn,mn)\nE Mn\u22121,On\nDKL(qn(Mn|Mn\u22121, On); q\u0304n(Mn)) \u2264 RM +RS\nE Mn\u22121,On\nDKL(qn(Mn|Mn\u22121, On); q\u0304n(Mn|On)) \u2264 RM\nE Mn\u22121,On DKL(qn(Mn|Mn\u22121, On); q\u0304n(Mn|Mn\u22121)) \u2264 RS under normalization constraints.1 We may waive the constraints of non-negative probabilities, which will essentially never be active as we shall see later. Also note that we optimize over qn and q\u0304n as distinct parameters. This is justified by theorem 1 which states that, at the optimum, q\u0304n are indeed the marginals of qn.\nLet the Lagrange multipliers for the constraints be \u03b3C , \u03b3M and \u03b3S , and their sum \u03b3 = \u03b3C + \u03b3M + \u03b3S . Leaving aside terms of log qn, the pointwise terms in the Lagrangian will be\nG(d, q\u0304n,Mn\u22121,Wn, On,Mn)\n= d(Wn,Mn)\u2212 \u03b3C log q\u0304n(Mn)\n\u2212\u03b3M log q\u0304n(Mn|On)\u2212 \u03b3S log q\u0304n(Mn|Mn\u22121). In the following analysis, several expectations of this function will be useful:\n\u2022 G\u03b8n(d, q\u0304n,Mn\u22121, On,Mn)\n= E Wn|Mn\u22121,On G(d, q\u0304n,Mn\u22121,Wn, On,Mn),\n\u2022 Gqn(d, q\u0304n,Mn\u22121,Wn) = E On,Mn|Mn\u22121,Wn G(d, q\u0304n,Mn\u22121,Wn, On,Mn),\n\u2022 G\u03b8n,qn(d, q\u0304n) = E Mn\u22121,Wn,On,Mn G(d, q\u0304n,Mn\u22121,Wn, On,Mn)\n= D\u03b8n(qn) + \u03b3CH(q\u0304n(Mn))\n+\u03b3MH(q\u0304n(Mn|On)) + \u03b3SH(q\u0304n(Mn|Mn\u22121)), 1The information-rate constraints result from the n-step Problem 1 by fixing the first n\u22121 steps, if we consider that only two of the constraints are actually used in any instance (see corollary 3).\nwhere H is the entropy function. The Lagrangian of the problem, up to normalization terms and additive constants, can now be written as\nL1(qn, q\u0304n; \u03b8n, \u03b3C , \u03b3M , \u03b3S) = G\u03b8n,qn(d, q\u0304n)\u2212 \u03b3H(qn)."}, {"heading": "3.2. Properties of the One-Step Lagrangian", "text": "Theorem 1. For any fixed \u03b8n, L1 is convex in qn and q\u0304n. L1 is strictly convex in parameters which are conditional on mn\u22121 and on with Pr\u03b8n(mn\u22121, on) > 0, and at the minimum these satisfy\nqn(Mn|Mn\u22121, On) (1)\n= exp(\u2212\u03b3\u22121G\u03b8n(d, q\u0304n,Mn\u22121, On,Mn))\nZn(Mn\u22121, On) ,\nwhere Zn is a normalizing partition function, and q\u0304n(Mn) = \u2211\nmn\u22121,on\nPr \u03b8n\n(mn\u22121, on)qn(Mn|mn\u22121, on)\nq\u0304n(Mn|On) = \u2211 mn\u22121 Pr \u03b8n (mn\u22121|On)qn(Mn|mn\u22121, On)\nq\u0304n(Mn|Mn\u22121) = \u2211 on Pr \u03b8n (on|Mn\u22121)qn(Mn|Mn\u22121, on).\n(2)\nProof. For any fixed \u03b8n, L1 is convex since all its terms are convex. Non-zero terms only involve mn\u22121 and on with Pr\u03b8n(mn\u22121, on) > 0. Focusing on these parameters, the distortion terms are linear, and the information terms strictly convex. The unique feasible extremum of L1 is then the global minimum. Differentiating by each parameter gives equations 1 and 2.\nIf follows from theorem 1 that complementary slackness conditions are sufficient for optimality. Table 1 shows these conditions, the information rates (RM , RS) where the solution meets the boundary, and a subgradient of the boundary at that point. For example, if the minimum of L1 with \u03b3M = \u03b3S = 0 satisfies IC \u2265 IM + IS , then for any information-rate pair in the interval [(IC \u2212IS , IS), (IM , IC \u2212IM )] the minimal achievable distortion is D and (\u2212\u03b3C ,\u2212\u03b3C) is a subgradient of the boundary.\nTheorem 2. For any joint belief \u03b8n, the boundary D\u2217\u03b8n(RM , RS) of the rate-distortion region is continuous and convex. Any point (RM , RS , D) on the boundary at which (\u2212\u03b1M ,\u2212\u03b1S) is a subgradient, is achieved by minimizing L1 for multipliers\n(\u03b3C , \u03b3M , \u03b3S) =  (0, \u03b1M , \u03b1S) if IC \u2264 IM+IS (\u03b1M , 0, \u03b1S \u2212 \u03b1M ) if IC \u2265 IM+IS and \u03b1M \u2264 \u03b1S (\u03b1S , \u03b1M \u2212 \u03b1S , 0) if IC \u2265 IM+IS\nand \u03b1M \u2265 \u03b1S\nProof. Let transitions qn and q \u2032 n achieve the rate-distortion boundary at (RM , RS , D) and (R\u2032M , R \u2032 S , D\n\u2032), respectively, and let 0 \u2264 \u03bb \u2264 1. Then by equations 2 and the convexity of the KullbackLeibler divergence, the transition \u03bbqn + (1 \u2212 \u03bb)q\u2032n (over-)achieves the rate-distortion constraints \u03bb(RM , RS , D) + (1 \u2212 \u03bb)(R\u2032M , R\u2032S , D\u2032). The ratedistortion region is therefore convex, and so is its boundary. The boundary is continuous by the continuity of the problem.\nFor a positive information-rate pair (RM , RS), having Mn independent of Mn\u22121 and On makes all information-rate constraints inactive. This satisfies the Slater condition, and the multipliers detailed in the theorem are then the Karush-Kuhn-Tucker multipliers necessary for qn to be optimal.\nCorollary 3. Let D\u2217C , D\u2217M and D\u2217S be the boundaries of the rate-distortion regions obtained by keeping each two of the three information-rate constraints. Then D\u2217 is their maximum."}, {"heading": "3.3. Optimization Algorithm", "text": "An algorithm which alternatingly minimizes L1 over each parameter with the others fixed, in the style of Blahut-Arimoto (Cover & Thomas, 2006), will allow us to find the minimum.\nTheorem 4. Algorithm 1 converges2 monotonically to the global minimum of L1.\nProof. L1 is non-increasing in each iteration and is bounded from below, which guarantees its monotonic convergence. That is\n2For the sake of clarity, here and in the rest of this paper strict convexity, uniqueness of minimum and convergence should all be taken with respect to events and transitions of positive probability, as justified by theorem 1.\nAlgorithm 1 Last-Step Optimization\nInput: P1, p, \u03c3, d, \u03b3C , \u03b3M , \u03b3S , \u03b8n Output: optimal qn r \u2190 0 Initialize some suggestion for qrn repeat\nCompute the marginals q\u0304rn of q r n (eq. 2) Compute a new value for qr+1n from q\u0304 r n (eq. 1)\nr \u2190 r + 1 until qrn converges\nL1(qrn, q\u0304rn)\u2212 L1(qr+1n , q\u0304rn) \u2212\u2212\u2212\u2212\u2192 r\u2212\u2192\u221e 0.\nBut qr+1n is the unique minimum of the continuous Lagrangian. This implies that qrn also converges to a solution q\u2217n with marginals q\u0304 \u2217 n. By the continuity of the Lagrangian\u2019s derivatives, they are all 0 at this solution."}, {"heading": "4. Sequential Rate-Distortion", "text": ""}, {"heading": "4.1. Variational Principle", "text": "Returning to the entire process of Problem 1, the sequence of joint beliefs \u03b8(2,n) = \u03b82, . . . , \u03b8n depends recursively on \u03b81 and the policy q(n). For each 1 \u2264 t < n\n\u03b8t+1(Mt,Wt+1) (3) = \u2211\nmt\u22121,wt\n\u03b8t(mt\u22121, wt) Pr qt\n(Mt,Wt+1|mt\u22121, wt),\nwith \u03b81 given as the independent distribution of M0 and W1.\nAdding the constraints of equation 3 with multipliers \u03bdt,mt,wt+1 , the Lagrangian of Problem 1 is\nLn(q(n), q\u0304(n), \u03b8(2,n)) = 1\nn n\u2211 t=1 L1(qt, q\u0304t; \u03b8t, \u03b3C , \u03b3M , \u03b3S)\n\u2212 1 n n\u22121\u2211 t=1 \u2211 mt,wt+1 \u03bdt,mt,wt+1 \u03b8t+1(mt, wt+1) \u2212\n\u2211 mt\u22121,wt \u03b8t(mt\u22121, wt) Pr qt (mt, wt+1|mt\u22121, wt)  up to normalization terms and additive constants.\nSolving Ln is much more difficult than L1. Ln is not convex, and each step may affect all future steps. Intuitively, remembering some feature of the sample in one step is less rewarding if this information is discarded in a future step, and vice versa. This leads to Ln having many local minima."}, {"heading": "4.2. Local Optimization Algorithm", "text": "Nevertheless, Problem 1 still has some structure which can be insightful to explore. In particular, it has some interesting similarities to the standard POMDP planning problem. Differentiating Ln by qt we now get\nqt(Mt|Mt\u22121, Ot) (4)\n= exp(\u2212\u03b3\u22121G\u03b8t(d ~\u03bdt t , q\u0304t,Mt\u22121, Ot,Mt))\nZt(Mt\u22121, Ot) ,\nwith\nd~\u03bdtt (Wt,Mt) = d(Wt,Mt) + E Wt+1|Wt \u03bdt,Mt,Wt+1 ,\nwhere ~\u03bdn = 0. qt now depends on the future through the multiplier vector ~\u03bdt. Note how the expectation of \u03bdt,Mt,Wt+1 given Wt plays a parallel role to that of d(Wt,Mt).\nLn is linear in each \u03b8t, and at the optimum must in fact be constant in every non-trivial component of \u03b8t. This gives us a recursive formula for computing ~\u03bdt\u22121 from ~\u03bdt, qt and q\u0304t. For 1 < t \u2264 n, and whenever 0 < \u03b8t(Mt\u22121,Wt) < 1, we have\n\u03bdt\u22121,Mt\u22121,Wt = Gqt(d ~\u03bdt t , q\u0304t,Mt\u22121,Wt) (5)\n\u2212\u03b3 E Ot|Wt H(qt(Mt|Mt\u22121, Ot)) + \u03bbt,Wt .\nNote that equation 5 is a linear backward recursion for ~\u03bdt. The multipliers ~\u03bbt come from the constraints that \u03b8t is a probability distribution function. It has no consequence, however, since it is independent of Mt\u22121, and is normalized out when ~\u03bdt\u22121 is used to compute qt\u22121 in equation 4.\nAt this point, we can introduce the following generalization of algorithm 1, which finds the optimal transition qt, given the joint belief \u03b8t and the policy suffix q(t+1,n) = qt+1, . . . , qn.\nAlgorithm 2 One-Step Optimization\nInput: P1, p, \u03c3, d, \u03b3C , \u03b3M , \u03b3S , \u03b8t, q(t+1,n) Output: optimal qt r \u2190 0 Initialize some suggestion for qrt repeat\nCompute \u03b8r(t+1,n) from \u03b8t and q r (t,n\u22121) (eq. 3) Compute the marginals q\u0304r(t,n) of q r (t,n) (eq. 2) Compute ~\u03bdr(t,n\u22121) recursively backward (eq. 5) Compute qr+1t from \u03b8 r t , q\u0304 r t and ~\u03bd r t (eq. 4)\nr \u2190 r + 1 until qrt converges\nThis is a forward-backward algorithm. In each iteration we compute \u03b8(t+1,n) = \u03b8t+1, . . . , \u03b8n recursively\nforward, and then ~\u03bd(t,n\u22121) = ~\u03bdt, . . . , ~\u03bdn\u22121 recursively backward. The algorithm is guaranteed to converge monotonically to an optimal solution, since Ln is still strictly convex in each qt separately. In fact, all our theorems and proofs regarding algorithm 1 carry over to this generalization."}, {"heading": "4.3. Joint-Belief MDP", "text": "Expanding the recursion of ~\u03bdt in equation 5 to a closed form, and disregarding ~\u03bbt, we find that for 1 < t \u2264 n and consistent parameters3\nLn\u2212t+1(q(t,n); \u03b8t) (6)\n= 1 n\u2212 t+ 1 \u2211\nmt\u22121,wt\n\u03b8t(mt\u22121, wt)\u03bdt\u22121,mt\u22121,wt .\nIf we extend the recursion by another step to define ~\u03bd0, we get that our minimization target is\nLn(q(n); \u03b81) = 1\nn E M0,W1 \u03bd0,M0,W1 .\nThe minimization\nVt(\u03b8t) = min q(t,n) E Mt\u22121,Wt \u03bdt\u22121,Mt\u22121,Wt\ncan be looked at as the cost-to-go given the joint belief \u03b8t before step t. Importantly, the recursive formula 5, when minimized over q(t,n), is a Bellman equation. It contains a recursive term\nE Mt,Wt+1|Mt\u22121,Wt \u03bdt,Mt,Wt+1 ,\nwhich is the expected future cost, and other terms which are the expected immediate costs, internal and external, of implementing qt in step t.\nThis suggests viewing our problem as a joint-belief MDP. Here the states are the joint beliefs \u03b8t, the actions are qt, and the next state always follows deterministically according to equation 3. This determinism allows us to use a time-dependent policy q(n), rather than a state-dependent one, and will prove useful in finding a solution.\nThe belief space of a standard POMDP can be looked at as the state space of a belief MDP, with the same actions and observations, and a linear transition function. If memory states are approximate beliefs, then our model is more like a further abstraction, where the MDP state space is the set of distributions over the belief space. Table 2 summarizes the main differences between this joint-belief MDP and the belief-MDP representation of discrete-action finite-horizon POMDPs.\n3When the Lagrangian is written in terms of the policy and the initial joint belief, the other parameters are taken to be consistent with them.\nOne important difference is in the structure of the value function. The expected cost Ln\u2212t+1 of a fixed policy suffix q(t,n) consists of some linear terms of expected distortion, but also some strictly convex terms. The latter all take the form of a Kullback-Leibler divergence between qt\u2032 , for some t\n\u2032 \u2265 t, and a marginal q\u0304t\u2032 , the latter depending on \u03b8t through equations 2 and the recursion 3.\nThat this cost is not linear makes the representation of the value function a challenge, but a greater difficulty is the size of the policy space, which is finite in discreteaction finite-horizon POMDPs, but continuous here. Minimizing over it does not yield a piecewise-linear function of the joint belief, although it is still continuous, and the convex mixing of policies shows that it is still concave4. It is unclear how to finitely represent the resulting value function in our case."}, {"heading": "4.4. Bounded Planning Algorithm", "text": "Perhaps surprisingly, the determinism of the jointbelief MDP allows us to define a local criterion for optimality. Together with iterations of algorithm 2 which make local improvements, this will guarantee convergence to a local optimum.\nOur algorithm is a simple forward-backward algorithm, with a building block (algorithm 2) which is itself forward-backward. In each iteration we compute recursively forward the joint beliefs \u03b8(n) for the current policy q(n). Then we compute recursively backward a new policy q\u2032(n), by finding in each step t a policy suffix which is locally optimal for \u03b8t. The criterion for optimality is that in each step we can use either q\u2032(t+1,n) from the previous step or q(t+1,n) from the previous iteration, and whichever leads to a lower cost is chosen.\nTheorem 5. Algorithm 3 converges monotonically to a limit cost L\u2217. For any \u2265 0, any qr(n) which costs within of L\u2217 is also within of a local minimum of\n4If rewards are used instead of costs, the value function is convex.\nAlgorithm 3 Passive POMDP Bounded Planning\nInput: \u03b81, p, \u03c3, d, \u03b3C , \u03b3M , \u03b3S , n Output: locally optimal q(n) r \u2190 0 Initialize some suggestion for qr(n) repeat \u03b8r1 \u2190 \u03b81 Compute \u03b8r(2,n) from \u03b8 r 1 and q r (n\u22121) (eq. 3)\nfor t\u2190 n to 1 do qr+1,t(t,n) \u2190 arg minq(t,n) Ln\u2212t+1(q(t,n); \u03b8 r t )\ns.t. q(t+1,n) \u2208 { qr+1,t+1(t+1,n) , q r (t+1,n) } (alg. 2)\nend for qr+1(n) \u2190 q r+1,1 (n)\nr \u2190 r + 1 until Ln(qr(n); \u03b81) converges\nthe bounded-inference-planning problem (section 2), in the sense that for any 1 \u2264 t \u2264 n, the global minimum given qr(t\u22121) and q r (t+1,n) is at most better than q r (n).\nProof. In iteration r, qr(n) from the previous iteration is feasible for qr+1(n) . Therefore the cost of q r (n) is nonincreasing in r and converges monotonically to a limit L\u2217.\nLet qr(n) be within some > 0 of L \u2217. Fix any 1 \u2264 t \u2264 n, and let q\u2217t achieve the global optimum given q r (t\u22121) and qr(t+1,n). Then\nLn(qr(n); \u03b81)\u2212 \u2264 Ln(q r+1 (n) ; \u03b81)\n(a) \u2264 Ln((qr(t\u22121), q r+1,t (t,n) ); \u03b81)\n(b) \u2264 Ln((qr(t\u22121), q \u2217 t , q r (t+1,n)); \u03b81),\nwhere\n(a) follows recursively from (qrt\u2032 , q r+1,t\u2032+1 (t\u2032+1,n) ) being fea-\nsible for \u03b8rt\u2032 in iteration r, for each 1 \u2264 t\u2032 < t, and\n(b) follows from (q\u2217t , q r (t+1,n)) being feasible for \u03b8 r t in\niteration r.\nWhere algorithm 3 runs algorithm 2, it can initialize qt to q r t from the previous iteration. This may speed up each iteration, particularly when the algorithm has nearly converged. In addition, when running algorithm 3 with different sets of multipliers, it converges much faster if each run is initialized with the previous result. Empirically, this also leads to much better local minima if the runs are sorted in order of decreasing multipliers."}, {"heading": "5. Simulations", "text": ""}, {"heading": "5.1. Symmetric Channel", "text": "Figure 2 shows the boundary of the rate-distortion region for the 30-step sequential symmetric channel problem. The domains W, O and M are all binary. The agent observes the state correctly with probability 0.8. The state remains the same for the next step independently with probability 0.8. The distortion is the delta function.\nThe boundary consists of three parts as in corollary 3. They have \u03b3M = 0 (left), \u03b3M = \u03b3S = 0 (middle) and \u03b3S = 0 (right). Empirically, taking \u03b3C = 0 is never feasible, as no optimal solution ever has IC \u2264 IM+IS .\nTo clarify this further, figure 3 shows a colored contour map of the boundary. The lower the distortion, the higher the required information rates. The tradeoff between memory and perception is illustrated by the negative slope of the contours."}, {"heading": "5.2. Kelly Gambling", "text": "Three horses are running in 10 races. Each horse has a fitness rating fi \u2208 {1, 2, 3}, and the winning horse is determined by softmax, i.e. horse i wins with probability proportional to exp(fi). Between the races, the fitness of each horse may independently grow by 1, with probability 0.1 if it is not maxed out, or drop by 1, with probability 0.1 if it is not depleted. Each horse keeps its fitness with the remaining probability.\nThe only observations are side races performed before each race: 2 random horses compete (with softmax) and the identities of the winner and the loser are announced. The memory state is a model of the world, consisting of the presumed fitness f\u0302i of each horse. The log-optimal proportional gambling strategy is used (Kelly gambling, see Cover & Thomas, 2006), betting on horse i a fraction of the wealth proportional to exp(f\u0302i). Each bet is double-or-nothing, and the distortion is the expected log return on the portfolio.\nFigure 4 shows the contour map, which is not convex in this instance."}, {"heading": "6. Conclusion", "text": "We have presented the problem of planning in Passive POMDPs with information-rate constraints. This problem takes the form of a sequential version of ratedistortion theory, and accordingly we were able to provide algorithms which globally optimize each step individually. Unfortunately, the full problem is not convex, and we expect that it has very hard instance sets.\nNevertheless, typical instances with some locality in their transitions and observations are expected to be easier. We have introduced an efficient and simple algorithm for finding a local minimum, and have used it to illustrate the problem with two simulations. In doing so, we have demonstrated the emergence of a\nmemory-perception tradeoff in the problem.\nOur work has been motivated by the problem of planning in general POMDPs, which may benefit from belief approximation which is principled by information theory. The application of our current results to this problem is left for future work."}, {"heading": "7. Acknowledgement", "text": "This project is supported in part by the MSEE DARPA Project and by the Gatsby Charitable Foundation."}], "references": [{"title": "Optimizing fixed-size stochastic controllers for POMDPs and decentralized POMDPs", "author": ["Amato", "Christopher", "Bernstein", "Daniel S", "Zilberstein", "Shlomo"], "venue": "Autonomous Agents and Multi-Agent Systems,", "citeRegEx": "Amato et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Amato et al\\.", "year": 2010}, {"title": "Multiterminal source coding", "author": ["Berger", "Toby"], "venue": "The Information Theory Approach to Communications,", "citeRegEx": "Berger and Toby.,? \\Q1977\\E", "shortCiteRegEx": "Berger and Toby.", "year": 1977}, {"title": "Reinforcement learning with perceptual aliasing: The perceptual distinctions approach", "author": ["Chrisman", "Lonnie"], "venue": "In Proceedings of the tenth national conference on Artificial intelligence,", "citeRegEx": "Chrisman and Lonnie.,? \\Q1992\\E", "shortCiteRegEx": "Chrisman and Lonnie.", "year": 1992}, {"title": "Optimal control as a graphical model inference problem", "author": ["Kappen", "Bert", "G\u00f3mez", "Vicen\u00e7", "Opper", "Manfred"], "venue": null, "citeRegEx": "Kappen et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Kappen et al\\.", "year": 2009}, {"title": "Bright illusions reduce the eye\u2019s pupil", "author": ["Laeng", "Bruno", "Endestad", "Tor"], "venue": "Proceedings of the National Academy of Sciences,", "citeRegEx": "Laeng et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Laeng et al\\.", "year": 2012}, {"title": "Point-based value iteration: An anytime algorithm for POMDPs", "author": ["Pineau", "Joelle", "Gordon", "Geoffrey J", "Thrun", "Sebastian"], "venue": "In IJCAI,", "citeRegEx": "Pineau et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Pineau et al\\.", "year": 2003}, {"title": "Bounded finite state controllers", "author": ["Poupart", "Pascal", "Boutilier", "Craig"], "venue": "In NIPS,", "citeRegEx": "Poupart et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Poupart et al\\.", "year": 2003}, {"title": "Exponential family PCA for belief compression in POMDPs", "author": ["Roy", "Nicholas", "Gordon", "Geoffrey J"], "venue": "In NIPS,", "citeRegEx": "Roy et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Roy et al\\.", "year": 2002}, {"title": "Information theory of decisions and actions", "author": ["Tishby", "Naftali", "Polani", "Daniel"], "venue": "PerceptionAction Cycle,", "citeRegEx": "Tishby et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Tishby et al\\.", "year": 2011}, {"title": "Linearly-solvable Markov decision problems", "author": ["Todorov", "Emanuel"], "venue": "In NIPS,", "citeRegEx": "Todorov and Emanuel.,? \\Q2006\\E", "shortCiteRegEx": "Todorov and Emanuel.", "year": 2006}], "referenceMentions": [{"referenceID": 0, "context": "Several works do so by optimizing a finite-state controller of a given size (Poupart & Boutilier, 2003; Amato et al., 2010).", "startOffset": 76, "endOffset": 123}, {"referenceID": 5, "context": "A different approach is to explicitly select a subset of beliefs, and use them to guide the iterations (Pineau et al., 2003).", "startOffset": 103, "endOffset": 124}, {"referenceID": 3, "context": "Some research treats POMDPs where the cost is the DKL between the distributions of the next world state when it is controlled and uncontrolled (Todorov, 2006; Kappen et al., 2009).", "startOffset": 143, "endOffset": 179}, {"referenceID": 3, "context": "Some research treats POMDPs where the cost is the DKL between the distributions of the next world state when it is controlled and uncontrolled (Todorov, 2006; Kappen et al., 2009). This has interesting analogies to our setting. Our information-rate constraints define, in effect, components of the cost which are the DKL between the distribution of the next memory state and its marginals (see section 3.1). Tishby & Polani (2011) combine similar information-rate constraints of perception and action together.", "startOffset": 159, "endOffset": 431}], "year": 2012, "abstractText": "In Passive POMDPs actions do not affect the world state, but still incur costs. When the agent is bounded by information-processing constraints, it can only keep an approximation of the belief. We present a variational principle for the problem of maintaining the information which is most useful for minimizing the cost, and introduce an efficient and simple algorithm for finding an optimum.", "creator": "LaTeX with hyperref package"}}}