{"id": "1206.6435", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "27-Jun-2012", "title": "Rethinking Collapsed Variational Bayes Inference for LDA", "abstract": "We propose a new interpretation of the collapsed Bayes variation with a zero-order Taylor expansion approximation for the latent Dirichlet allocation (LDA). We clarify the properties of the CVB0 inference using alpha divergence. We show that the CVB0 inference consists of two different divergence projections: alpha = 1 and -1. This interpretation will help shed light on the CVB0 work.", "histories": [["v1", "Wed, 27 Jun 2012 19:59:59 GMT  (175kb)", "http://arxiv.org/abs/1206.6435v1", "Appears in Proceedings of the 29th International Conference on Machine Learning (ICML 2012)"]], "COMMENTS": "Appears in Proceedings of the 29th International Conference on Machine Learning (ICML 2012)", "reviews": [], "SUBJECTS": "cs.LG stat.ML", "authors": ["issei sato", "hiroshi nakagawa"], "accepted": true, "id": "1206.6435"}, "pdf": {"name": "1206.6435.pdf", "metadata": {"source": "CRF", "title": "Rethinking Collapsed Variational Bayes Inference for LDA", "authors": ["Issei Sato", "Hiroshi Nakagawa"], "emails": ["sato@r.dl.itc.u-tokyo.ac.jp", "n3@dl.itc.u-tokyo.ac.jp"], "sections": [{"heading": "1. Introduction", "text": "Latent Dirichlet allocation (LDA) (Blei et al., 2003) is a well-known probabilistic latent variable model. It is used to model the co-occurrence of words by using latent variables called topics where a document is represented as a \u201cbag of words\u201d . It has a wide variety of applications in many fields. Originally, the variational Bayes (VB) inference was used for learning LDA. The collapsed variational Bayes (CVB) inference was developed as an alternative deterministic inference for LDA (Teh et al., 2007). The CVB inference is a variational inference improved by marginalizing out parameters as in a collapsed Gibbs sampler (Griffiths & Steyvers, 2004). (Sung et al., 2008) generalized the CVB inference for conjugate-exponential family models, called latent-space variational Bayes (LSVB) inference.\nSince the CVB inference requires intractable integrals, Teh et al. (Teh et al., 2007) used a second-order Taylor expansion to perform the integrals. Asuncion et al. (Asuncion et al., 2009; Asuncion, 2010) proposed another approximation that uses only the zeroorder information, called the CVB0 inference. The CVB0 inference does not have the drawbacks that\nAppearing in Proceedings of the 29 th International Conference on Machine Learning, Edinburgh, Scotland, UK, 2012. Copyright 2012 by the author(s)/owner(s).\nother inferences do: VB contains digamma functions which are computationally expensive, while CVB requires the maintenance of variance counts. In contrast, the stochastic nature of the collapsed Gibbs sampler causes it to converge more slowly than the deterministic algorithms. Asuncion et al.\u2019s empirical results suggest that the CVB0 inference learns models that are as good as or better than those learned by the VB and CVB inferences and the collapsed Gibbs sampler in terms of perplexity. Furthermore, as shown in (Asuncion, 2010), when the asymmetric Dirichlet parameters are estimated over document-topic distribution, the predictive performance of the CVB0 inference clearly outperforms that of the CVB inference.\nWe have the question of why CVB0 outperformed CVB, even though the approximation of CVB is more accurate than that of CVB0. In this paper, we propose an interpretation of the CVB0 inference for LDA by using the \u03b1-divergence. Using the \u03b1-divergence helps\nclarify the properties of the CVB0 inference. We also experimentally show the performance of the subspecies of the CVB0 inference, which is derived with the \u03b1divergence projection framework. Our analysis of the relationship between existing inference algorithms and \u03b1-divergence is summarized in Table 1, the meaning of which is revealed in later sections.\nThe remainder of this paper is organized as follows. Sections 3 and 4 review LDA and the CVB / CVB0 inference for LDA, respectively. Sections 5 and 6 explain \u03b1-divergence and its local projection, respectively. The key sections 7 and 8 describe local \u03b1divergence projection for LDA and its connection to the CVB0 inference. Section 9 introduces other local projections inspired by the CVB0 inference. Section 10 evaluates algorithms in terms of document modeling. Section 11 concludes this paper."}, {"heading": "2. Preliminaries", "text": "Suppose that we have N documents, V vocabularies, and T topics. w = {wd}Nd=1 denotes a set of documents and z = {zd}Nd=1 is a set of assigned topics. \u03b8d,t denotes the probability of topic t appearing in document d. \u03d5t,v denotes the probability of word v appearing in topic t.\nnd,t(z) denotes the number of observations of topic t in document d. nd denotes the total number of words in document d. nt,v(w, z) denotes the number of observations of word v assigned to topic t and nt,\u00b7(z) = \u2211 v nt,v(w, z). For simplicity, we denote them by nd,t, nt,v and nt,\u00b7. The superscription \u201c\\d, i\u201d denotes the corresponding variables or counts with wd,i and zd,i excluded, e.g., w\n\\d,i = w\\{wd,i}, z\\d,i = z\\{zd,i}, and n\\d,it,v is the number of observations of word v assigned to topic t leaving out zd,i.\nE[x] denotes the expectation of x and V[x] = E[x2] \u2212 E[x]2 the variance. Multi(\u00b7) denotes the multinomial distribution. Dir(\u00b7) denotes the Dirichlet distribution."}, {"heading": "3. Overview of LDA", "text": "The following generative process is assumed with LDA. First, document-topic distribution \u03b8d and topic-word distribution \u03d5k are generated by\n\u03b8d \u223c Dir(\u03b3), \u03d5t \u223c Dir(\u03b2), (1)\nwhere \u03b3 = (\u03b31, \u00b7 \u00b7 \u00b7 , \u03b3T ) is a T -dimensional vector and \u03b2 = (\u03b21, \u00b7 \u00b7 \u00b7 , \u03b2V ) is a V -dimensional vector.\nFor each document d, generate the i-th topic zd,i and\nword wd,i:\nzd,i \u223c Multi(\u03b8d), wd,i \u223c Multi(\u03d5zd,i). (2)\nWallach et al. (Wallach et al., 2009) explored the effects of choosing \u03b3 and \u03b2 in LDA. They found in Markov chain Monte Carlo (MCMC) simulations that using asymmetric \u03b3 and symmetric \u03b2 results in better predictive performance for held-out documents. Therefore, we use asymmetric \u03b3 = (\u03b31, \u00b7 \u00b7 \u00b7 , \u03b3T ) and symmetric \u03b2 = (\u03b2, \u00b7 \u00b7 \u00b7 , \u03b2).\nThe assignment probability of topic t to the i-th word in document d given w\\d,i, z\\d,i, \u03b3 and \u03b2 is\np(zd,i = t|wd,i = v,w\\d,i, z\\d,i,\u03b3, \u03b2) \u221d p(wd,i = v,w\\d,i, z\\d,i, zd,i = t|\u03b3, \u03b2), \u221d p(wd,i = v|zd,i = t,w\\d,i, z\\d,i|\u03b2)p(zd,i = t|z\\d,i\u03b3),\n\u221d n \\d,i t,v + \u03b2\nn \\d,i t,\u00b7 + V \u03b2\n(n \\d,i d,t + \u03b3t). (3)\nThis is used for the collapsed Gibbs sampler."}, {"heading": "4. CVB/CVB0 inference for LDA", "text": "(Teh et al., 2007) proposed the CVB inference to LDA inspired by the collapsed Gibbs sampler and showed that the CVB-LDA outperformed the VB-LDA in terms of perplexity. They only introduced a variational posterior q(z) by marginalizing out \u03b8 and \u03d5. The free energy of the CVB-LDA is given by\nFCV B [q(z)] = M\u2211 d=1 \u2211 zd q(zd) log p(wd,zd|\u03b3, \u03b2) q(zd) . (4)\nThus, the updates for q(z) are obtained by taking derivatives of FCV B [q(z)] with respect to {q(zd,i)} and equating to zero:\nq(zd,i = t)\n\u221d expE[log p(wd,i = v,w\\d,i, z\\d,i, zd,i = t|\u03b3, \u03b2)]q(z\\d,i),\n\u221d exp { E [ log n \\d,i t,v + \u03b2\nn \\d,i t,\u00b7 + V \u03b2\n(n \\d,i d,t + \u03b3t)\n]} ,\n\u221d expE[log(n\\d,it,v + \u03b2)]\nexpE[log(n\\d,it,\u00b7 + V \u03b2)] expE[log(n\\d,id,t + \u03b3t)]. (5)\nThis update equation for q(z) requires approximations to compute intractable expectation. By using the central limit theorem, the expectation should be closely approximated using Gaussian distributions\nwith means and variances, e.g.,\nE[nd,t] = nd\u2211 i=1 q(zd,i = t), (6)\nV[nd,t] = nd\u2211 i=1 q(zd,i = t)(1\u2212 q(zd,i = t)). (7)\nMoreover, using the second order Taylor expansion, we can approximately calculate\nq(zd,i = t) \u221d \u03b2 + E[n\\d,it,wd,i ]\nV \u03b2 + E[n\\d,it,\u00b7 ] (\u03b3t + E[n\\d,id,t ])\nexp ( \u2212\nV[n\\d,it,wd,i ]\n2(\u03b2 + E[n\\d,it,wd,i ])2 +\nV[n\\d,it,\u00b7 ]\n2(V \u03b2 + E[n\\d,it,\u00b7 ])2\n)\nexp ( \u2212\nV[n\\d,id,t ]\n2(\u03b3t + E[n\\d,id,t ])2\n) , (8)\nwhere the superscription\u201c\\d, i\u201d denotes subtracting q(zd,i = t) and q(zd,i = t)(1\u2212 q(zd,i = t)).\n(Asuncion et al., 2009) showed the usefulness of an approximation using only zero-order information, called the CVB0 inference. The update using only zero-order information is given by\nq(zd,i = t) \u221d \u03b2 + E[n\\d,it,wd,i ] V \u03b2 + \u2211\nv E[n \\d,i t,v ]\n(\u03b3t + E[n\\d,id,t ]). (9)\nWe derive this CVB0 inference by using \u03b1-divergence, which enables us to reveal the relationship among other inference algorithms.\n5. \u03b1-Divergence\nThis section reviews \u03b1-divergence. A readable introduction is provided in (Minka, 2005).\nLet our task be to approximate a complex probabilistic distribution p(x) where x = {x1, x2, \u00b7 \u00b7 \u00b7 , xn}. We approximate p(x) as q(x), which is a simple probabilistic distribution, such as fully factorized distribution, i.e., q(x) = \u220fn i=1 q(xi). A basic approach to obtaining q(x) is to minimize information divergence such as the Kullback-Leibler divergence:\nKL[p||q] = \u222b p(x) log p(x)\nq(x) +\n\u222b (q(x)\u2212 p(x))dx,\n(10)\nwhere p(x) and q(x) do not need to be normalized. By using the KL-divergence, the estimation of q(x) is defined by the KL-projection of p(x) onto a family of q(x) as follows:\nq\u2217(x) = argmin q(x) KL[p(x)||q(x)]. (11)\n\u03b1-divergence is a generalization of the KL divergence (Amari, 1985; Trottini & Spezzaferri, 2002; Zhu & Rohwer, 1995), indexed by \u03b1 \u2208 (\u2212\u221e,\u221e). The \u03b1 parameter can be used in different ways by different authors. In this paper, we define \u03b1-divergence by the convention used in (Minka, 2005):\nD\u03b1[p||q] = \u222b \u03b1p(x) + (1\u2212 \u03b1)q(x)\u2212 p(x)\u03b1q(x)1\u2212\u03b1dx\n\u03b1(1\u2212 \u03b1) ,\n(12)\nwhere p(x) and q(x) do not need to be normalized. If p = q, \u03b1-divergence is zero. Some special cases are\nD\u22121[p||q] = 1\n2\n\u222b (q(x)\u2212 p(x))2\np(x) dx (13)\nlim \u03b1\u21920\nD\u03b1[p|q] = KL[q(x)||p(x)] (14) D0.5[p||q] = 2 \u222b ( \u221a q(x)\u2212 \u221a p(x))2)dx (15)\nlim \u03b1\u21921\nD\u03b1[p|q] = KL[p(x)||q(x)] (16)\nD2[p||q] = 1\n2\n\u222b (p(x)\u2212 q(x))2\nq(x) dx. (17)\nThe case \u03b1 = 0.5 is known as the Hellinger distance, and \u03b1 = 2 is the \u03c72 distance. Since \u03b1 = \u22121 swaps the position of p and q of the \u03c72 distance, we call the case \u03b1 = \u22121 \u201cthe inverse \u03c72 distance\u201d, which is the key divergence in this paper."}, {"heading": "6. Local \u03b1-divergence projection", "text": "In this section, we introduce a local divergence projection-based inference.\nSuppose that the approximate distribution q(x) is fully factorized. We derive the update q(xi) minimizing \u03b1-divergence as follows. Taking derivatives of \u03b1-divergence (12) with respect to q(xi) and equating them to zero, we obtain the following fixed point iteration equations:\nq(xi) \u221dE [( p(x)\nq(x\\i) )\u03b1] 1\u03b1 q(x\\i)\n(18)\nIn many cases, this update is intractable and thus we introduce an approximation for Eq. (18).\nSince Eq. (18) is\nq(xi) \u221dE [( p(xi|x\\i) p(x\\i)\nq(x\\i) )\u03b1] 1\u03b1 q(x\\i) , (19)\nwe replace p(x\\i) with q(x\\i), obtaining\nq(xi) \u221dE [ p(xi|x\\i)\u03b1 ] 1 \u03b1\nq(x\\i) . (20)\nIn the case \u03b1 = 1, the update (20) is similar to belief propagation, and the factorized neighbors algorithm (Rosen-Zvi et al., 2005).\nThe update (20) means that it locally minimize \u03b1divergence, i.e., for each i,\nq\u2217(xi) = argmin q(xi) D\u03b1[p(xi|x\\i)q(x\\i)||q(x)]. (21)\nIn the case \u03b1 = 1, i.e., KL divergence, this local projection-based inference is equal to the EP algorithm. We describe the connection of this \u03b1-divergence projection with the CVB0 inference in the next section."}, {"heading": "7. CVB0 as \u03b1-divergence projection", "text": "In this section, we derive the CVB0 inference by using the local \u03b1-divergence projection. First, we describe how the case \u03b1 = 1, i.e. EP, cannot be applied for the collapsed LDA. Second, we derive a divergence projection applicable to the collapsed LDA and explain the relationship between this projection and the CVB0 inference.\nWe apply Eq. (21) with \u03b1 = 1(EP) to the collapsed LDA. For each zd,i, we perform\nq\u2217(zd,i) = argmin q(zd,i) KL[p(zd,i|w, z\\d,i)q(z\\d,i)||q(z)].\n(22)\nThe update for q(zd,i) is\nq(zd,i = t) \u221dE [ p(zd,i = t|wd,i = v,w\\d,i, z\\d,i) ] q(z\\d,i) ,\n\u221dE [ (n\n\\d,i d,t + \u03b3t)\nn \\d,i t,v + \u03b2\nn \\d,i t,\u00b7 + V \u03b2 ] q(z\\d,i) . (23)\nThe problem is that we cannot analytically execute this expectation. (Asuncion, 2010) derived Eq.(23) in a different way where he changed the CVB free energy by moving the logarithm out of the expectations, and pointed out the relationship between Eq.(23) and the CVB0 inference, which inspired this work. However, the intractable expectation in Eq.(23) was not executed. This intractability makes interpreting the CVB0 inference difficult.\nHere, we derive another approach by using the \u03b1divergence projection. The key idea is to construct q(zd,i) by using the novel three parameters .\nWe define q(zd,i) as follows:\nq(zd,i = t) \u221d a(zd,i)b(zd,i)c(zd,i) (24) a(zd,i = t) = n\u0303 \\d,i d,t + \u03b3t, (25) b(zd,i = t) = n\u0303 \\d,i t,v + \u03b2, (26) c(zd,i = t) = 1\nn\u0303 \\d,i t,\u00b7 + V \u03b2\n, (27)\nwhere we do not assume that n\u0303 \\d,i d,i , n\u0303 \\d,i t,v and n\u0303 \\d,i t,\u00b7 are expected counts, i.e., these are parameters of q(zd,i).\nWe also define\nq\\a(zd,i) = b(zd,i)c(zd,i), (28) q\\b(zd,i) = a(zd,i)c(zd,i) (29) q\\c(zd,i) = a(zd,i)b(zd,i). (30)\nSince our definition of \u03b1-divergence does not require normalization of the probabilistic distribution, we can introduce the following local projection:\na\u2217(zd,i = t) =\nargmin a(zd,i)\nD\u03b1[(n \\d,i d,t + \u03b3t)q \\ad,i(z)||a(zd,i)q\\ad,i(z)], (31)\nwhere q\\ad,i(z) = q\\a(zd,i)q(z \\d,i). Solving the above\noptimization (see Appendix A), we obtain\na\u2217(zd,i = t) =E [ (n \\d,i d,t + \u03b3t) \u03b1 ] 1 \u03b1\nq(z\\d,i) . (32)\nAs in a(zd,i), we obtain b \u2217(zd,i) and c \u2217(zd,i) by locally minimizing the \u03b1-divergence:\nb\u2217(zd,i = t) =\nargmin b(zd,i)\nD\u03b1[(n \\d,i t,v + \u03b2)q \\bd,i(z)||b(zd,i)q\\bd,i(z)], (33)\nc\u2217(zd,i = t) =\nargmin c(zd,i)\nD\u03b1[ 1\n(n \\d,i t,\u00b7 + V \u03b2)\nq\\cd,i(z)||c(zd,i)q\\cd,i(z)]. (34)\nThus, we have\nb\u2217(zd,i = t) = E [ (n \\d,i t,v + \u03b2) \u03b1 ] 1 \u03b1\nq(z\\d,i) , (35)\nc\u2217(zd,i = t) = E\n[( 1\nn \\d,i t,\u00b7 + V \u03b2 )\u03b1] 1\u03b1 q(z\\d,i) . (36)\nWhen we use \u03b1-divergence projection with \u03b1 = 1 for\nestimating a(zd,i) and b(zd,i), we have a(\u03b1=1)(zd,i = t) =E [ n \\d,i d,t + \u03b3t ] q(z\\d,i) = E[n\\d,id,t ] + \u03b3t,\n(37) b(\u03b1=1)(zd,i = t) =E [ n \\d,i t,v + \u03b2 ] q(z\\d,i) = E[n\\d,it,v ] + \u03b2.\n(38)\nWhen we use \u03b1-divergence projection with \u03b1 = \u22121 for estimating c(zd,i), we have\nc(\u03b1=\u22121)(zd,i = t) =E ( 1 n \\d,i t,\u00b7 + V \u03b2 )\u22121\u22121 q(z\\d,i) ,\n=E [ n \\d,i t,\u00b7 + V \u03b2 ]\u22121 q(z\\d,i) , = 1\nE[n\\d,it,\u00b7 ] + V \u03b2 . (39)\nTherefore, we have the following update for q(zd,i)\nq(zd,i = t) \u221d a(\u03b1=1)(zd,i)b(\u03b1=1)(zd,i)c(\u03b1=\u22121)(zd,i),\n= (E[n\\d,id,t ] + \u03b3) E[n\\d,it,v ] + \u03b2\nE[n\\d,it,\u00b7 ] + V \u03b2 . (40)\nAlthough the updates are performed in order, i.e., update a\u2217 given b and c, b\u2217 given a\u2217 and c, and c\u2217 given a\u2217 and b\u2217, this update is equal to the CVB0 update in Eq.(9)."}, {"heading": "8. Discussion", "text": "In this section, we explain why the CVB0 inference outperforms the CVB inference. To sum up this discussion, in the CVB0 inference, the \u201czero-forcing effect\u201d works only with the nt,\u00b7 estimation, while in the CVB inference it works with the q(z) estimation.\nThe previous section showed that the CVB0 inference is composed of the three projections with a mixture of \u03b1 = 1 and \u03b1 = \u22121:\nD1 = KL[(n \\d,i d,t (z) + \u03b3t)q \\ad,i(z)||q(z)], (41) D1 = KL[(n \\d,i t,v (z) + \u03b2)q \\bd,i(z)||q(z)], (42)\nD\u22121\n[ 1\n(n \\d,i t,\u00b7 (z) + V \u03b2)\nq\\cd,i(z)||q(z) ] . (43)\nThis projection-based update with a different divergence measure reveals the properties of the CVB0 inference. Ideally, we use the (\u03b1 = 1)-divergence projection, i.e., D1[p|q] = KL[p||q], but the integrals\nE[ 1 n \\d,i t,\u00b7 +V \u03b2 ] are not easy to evaluate. Instead, we use the inverse \u03c72 divergence D\u22121[p||q] for estimating c(zd,i).\nD\u22121[p||q] = 12 \u222b (q(x)\u2212p(x))2 p(x) dx is known as a zeroforcing divergence (Minka, 2005) which emphasizes q to be small when p being small, i.e., p(x) = 0 forces q(x) = 0, which means that it avoids \u201cfalse positive\u201d. In our case (43), the zero-forcing effect on the nt,\u00b7 estimation means that the emphasis in the estimation is on high-frequency topics or low-frequency topics tend to be estimated as zero in an entire corpus. We think that affecting n \\d,i t,\u00b7 matters much less than affecting n \\d,i d,t and n \\d,i t,v throughout a whole corpus in LDA. We explain the zero-forcing effect of CVB0 in more detail in the next section.\nReturning to Eq.(20), i.e., q(xi) \u221d E [ p(xi|x\\i)\u03b1 ] 1 \u03b1\nq(x\\i) ,\nwe describes the relationship between the CVB inference and \u03b1-divergence projection. First, we introduce the following theorem:\nTheorem 1 (Liapunov\u2019s inequality) If x is a nonnegative random variable, and we have two real numbers \u03b12 > \u03b11, then\nE[x\u03b12 ] 1 \u03b12 \u2265 E[x\u03b11 ] 1 \u03b11 . (44)\nand\nlim \u03b1\u21920\nE[x\u03b1] 1 \u03b1 = expE[log(x)]. (45)\nUsing Eq.(20) and Theorem 1, we obtain\nq(xi) \u221d lim \u03b1\u21920\nE [ p(xi|x\\i)\u03b1 ] 1 \u03b1\nq(x\\i) = exp(E[log p(xi|x\\i)])\n(46)\nThis is the variational inference minimizing KL[q||p].\nIn LDA, we have\nq(zd,i = t) \u221d lim \u03b1\u21920\nE [ p(zi,d|wd,i = v,w\\d,i, z\\d,i)\u03b1 ] 1 \u03b1\nq(z\\d,i)\n= exp(E[log p(zd,i|wd,i = v,w\\d,i, z\\d,i)])\n\u221d expE [ log n \\d,i d,t + \u03b3t\nn \\d,i d,\u00b7 + \u2211 t \u03b3t n \\d,i t,v + \u03b2 n \\d,i t,\u00b7 + V \u03b2 ] q(z\\d,i) ,\n\u221d exp(E[log(n\\d,id,t + \u03b3t)]) exp(E[log(n\\d,it,v + \u03b2)])\nexp(E[log(n\\d,it,\u00b7 + V \u03b2)]) (47)\nThe update Eq.(47) is the same update as the CVB inference in Eq.(5). (\u03b1 \u2192 0)-divergence is also known to induce the zero-forcing effect."}, {"heading": "9. Subspecies inspired by CVB0", "text": "In this section, we consider other projection-based algorithms that help clarify the property of the zeroforcing effect in CVB0.\n9.1. CVB with (\u03b1 = 1)-divergence\nFrom our view point, the CVB0 inference is composed of two different-type divergence projections: \u03b1 = 1,\u22121. We consider using only \u03b1 = 1 for the projections. To do this, we have to calculate the expectation given by\nc(\u03b1=1)(zd,i = t) = E\n[ 1\nn \\d,i t,\u00b7 + V \u03b2 ] q(z\\d,i) . (48)\nSince we cannot derive the analytical solution for this expectation, we propose two approximation methods. The first is a stochastic approximation called sample averaging given by\nc\u0303(\u03b1=1)(zd,i = t) = 1\nS S\u2211 s=1\n1\nn \\d,i t,\u00b7 (z (s)) + V \u03b2 , (49)\nwhere S denotes the number of samples and z(s) is the s-th samples generated from q(z). This method is accurate but not practical when S takes a large value. We use this approximation to investigate the accuracy of the next approximation.\nThe second is a deterministic approximation that uses the same approximation of CVB with the second-order Taylor expansion and Gaussian approximation given by\nc\u0302(\u03b1=1)(zd,i = t) = 1\nE[n\\d,it,\u00b7 ] + V \u03b2 +\nV[n\\d,it,\u00b7 ]\n(E[n\\d,it,\u00b7 ] + V \u03b2)3 .\n(50)\nAs shown in the experiments (Sec.10), we find that the second term of Eq.(50) is vanishingly small. c\u0302(\u03b1=1) in Eq.(50) is calculated\nas 1 E[n\\d,it,\u00b7 ]+V \u03b2\n( 1 +\nV[n\\d,it,\u00b7 ] (E[n\\d,it,\u00b7 ]+V \u03b2)2\n) . We find\nV[n\\d,it,\u00b7 ] (E[n\\d,it,\u00b7 ]+V \u03b2)2 = O(1/n) in many cases where n denotes the number of all words (tokens). For example, the variance takes the largest value when q(zd,i = t) = 1/2 for all d and i. In this case, E[nt] = n/2 and V[nt] = n(1 \u2212 1/2)/2 = n/4. Therefore, we consider c(\u03b1=\u22121) is similar to c(\u03b1=1), which means that CVB0 is rarely affected by the zero-forcing effect."}, {"heading": "9.2. Type-base CVB0 Inference", "text": "We derive a type-based inference as an application of our framework. In a type-based inference, we only estimate the probabilistic distribution for each type in a document not each token; this is beneficial for computation cost and memory usage.\nWe exclude all counts of word v from document d, denoted by superscription \u201c\\d, v\u201d. The appearance probability of word v given w\n\\d,v d and z \\d,v d is\np(wd,\u2217 = v|w\\d,v, z\\d,v) = T\u2211\nt=1\nn \\d,v d,t + \u03b3t\nn \\d,v d,\u00b7 + \u2211 t \u03b3t n \\d,v t,v + \u03b2 n \\d,v t,\u00b7 + V \u03b2\n(51)\nMoreover, we have\np(zd,v = t|w\\d,v) \u221d\nE\n[ n \\d,v d,t + \u03b3t\nn \\d,v d,\u00b7 + \u2211 t \u03b3t n \\d,v t,v + \u03b2 n \\d,v t,\u00b7 + V \u03b2 ] p(z\\d,v|w\\d,v)\n(52)\nHere, we consider obtaining an approximation distribution q(zd,v). Instead of zd,i, we define q(z) factorized by using q(zd,v), i.e., q(zd,i) =\u2211V\nv=1 q(zd,v)\u03b4(wd,i = v) and q(z) = \u220fV v=1 q(zd,v) nd,v .\nThe update of q(zd,v) is obtained by\nq(zd,v = t) \u221d E [ (n \\d,v d,t + \u03b3t) n \\d,v t,v + \u03b2\nn \\d,v t,\u00b7 + V \u03b2 ] q(z\\d,v) ,\n(53)\nwhich is derived by minimizing the \u03b1-divergence as in q(zd,i).\nUsing the local \u03b1-divergence projection with \u03b1 = 1 for n \\d,v d,t + \u03b3t and n\n\\d,v t,v + \u03b2, and \u03b1 = \u22121 for 1n\\d,vt,\u00b7 +V \u03b2 , we\nhave\nq(zd,v = t) \u221d (E[n\\d,vd,t ] + \u03b3) E[n\\d,vt,v ] + \u03b2\nE[n\\d,vt,\u00b7 ] + V \u03b2 . (54)\nWe call this update the type-based CVB0 (TCVB0) inference."}, {"heading": "10. Experiments", "text": "We compared CVB0 with its subspecies on document modeling in terms of perplexity to investigate the effect of \u03b1 = \u22121. All results are averaged values from five experimental runs with random initialization. We set the number of iterations to 100 for each inference.\nWe use a fixed point equation for updating \u03b3 introduced in (Minka, 2000). We set \u03b2 = 0.01 because\n(Asuncion et al., 2009) showed that CVB0-LDA with \u03b2 = 0.01 worked well when compared with other setings (\u03b2 = 0.01 was also used in (Griffiths & Steyvers, 2004)).\nIn this section\u2019s figures, \u201cCVB\u201d indicates the second order approximation of the CVB inference.\n\u201cCVB1s\u201d indicates the stochastic approximation in Eq.(49) with S = 50. \u201cCVB1d\u201d indicates the deterministic approximation in Eq.(50).\nWe used four sets of text data with different properties. The first was \u2018NIPS corpus (NIPS)\u201d from which the number of documents was N = 1, 500 and the vocabulary size was V = 12, 245. The second was \u201cThe Wall Street Journal (WSJ)\u201d from which we randomly chose N = 5, 000 (V = 38, 272) documents. The third was \u201cEnron email corpus (Enron)\u201d from which we randomly chose N = 5, 000 (V = 14, 758) documents. The fourth was \u201c20 news group corpus (20ng)\u201d from which we randomly chose N = 5, 000 (V = 13, 176). Stop words were eliminated.\nThe comparison metric we used for document modeling was the perplexity used by (Teh et al., 2007; 2008) that indicates the prediction performance for held-out words. We randomly split the words in a document into training words wtraind (80%) and test words w test d (20%).\nFigure 1 shows the experimental results. The bar graph indicates the results for test set perplexity interms of (T = 40, 80, 120) in each corpus. CVB0, CVB1s, CVB1d and TCVB0 outperformed CVB in terms of perplexity. Although we compared VB with others, we eliminated the VB results to clarify the differences of inference algorithms because CVB outperformed VB and the VB results change the scale of a bar-graph in some corpora.\nThe performances of CVB1s and CVB1d were similar to that of CVB0. Since the results of CVB1d were similar to those of CVB1s, the approximation used in CVB1d seemed to be accurate. When we analyzed\nV[nt,\u00b7] (E[nt,\u00b7]+V \u03b2)2 in Sec.9.1, the maximum value in all corpus when T = 120 was about 3.17e\u22124, which is negligible compared with 1. Therefore, as discussed in Sec.9.1, CVB0 was not affected by the zero-forcing effect. We believe this is the reason CVB0 worked better than CVB. Moreover, the performance of TCVB0 was similar to that of CVB0. Consequently, the TCVB0 inference was practical."}, {"heading": "11. Conclusion", "text": "In this paper, we reviewed existing inference algorithms of LDA in terms of the \u03b1-divergence projection. We showed that the CVB0 inference is composed of (\u03b1 = 1,\u22121)- divergence projections and that \u03b1 = \u22121 is similar to \u03b1 = 1 in LDA, which means that CVB0 is not affected by the zero-forcing effect in LDA. Combining the marginalization of parameters and the heterogeneous \u03b1-divergence projection is useful because it is easy to apply to other topic models learned by the collapsed Gibbs sampler. Future work is to develop an online-update extension, such as that by (Hoffman et al., 2010; Sato et al., 2010; Wang et al., 2011). From the relationship between EP and assumed density filtering, we can extend the local \u03b1-divergence projection into an online algorithm, which leads to the online CVB0 inference. A convergence analysis is also important remaining work.\nA. Derivation for Eq.(32)\nTaking derivatives of\nD\u03b1[(n \\d,i d,t + \u03b3t)q \\ad,i(z)||a(zd,i)q\\ad,i(z)],\nwith respect to a(zd,i) and equating them to zero, 0 = \u2211 z\\d,i q\\ad,i(z)\u2212 a(zd,i)\u2212\u03b1 \u2211 z\\d,i (n \\d,i d,t + \u03b3t) \u03b1q\\ad,i(z),\nand we obtain the following fixed point iteration equations:\na(zd,i) =\n[\u2211 z\\d,i(n \\d,i d,t + \u03b3t)\n\u03b1q\\ad,i(z)\u2211 z\\d,i q \\ad,i(z)\n] 1 \u03b1\n,\n=\n[\u2211 z\\d,i(n \\d,i d,t + \u03b3t)\n\u03b1b(zd,i)c(zd,i)q(z \\d,i)\u2211\nz\\d,i b(zd,i)c(zd,i)q(z \\d,i)\n] 1 \u03b1\n,\n=\n[ b(zd,i)c(zd,i) \u2211 z\\d,i(n \\d,i d,t + \u03b3t) \u03b1q(z\\d,i)\nb(zd,i)c(zd,i) \u2211 z\\d,i q(z \\d,i)\n] 1 \u03b1\n.\n(55) Since \u2211\nz\\d,i q(z \\d,i) = 1, we have\na(zd,i) = [\u2211 z\\d,i (n \\d,i d,t + \u03b3t) \u03b1q(z\\d,i) ] 1 \u03b1 . (56)"}], "references": [{"title": "Approximate mean field for dirichlet-based", "author": ["Springer", "New York", "A. 1985. Asuncion"], "venue": null, "citeRegEx": "Springer et al\\.,? \\Q1985\\E", "shortCiteRegEx": "Springer et al\\.", "year": 1985}, {"title": "On smoothing and inference for topic models", "author": ["A. Asuncion", "M. Welling", "P. Smyth", "Y.W. Teh"], "venue": "In Proceedings of the International Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "Asuncion et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Asuncion et al\\.", "year": 2009}, {"title": "Finding scientific topics", "author": ["T.L. Griffiths", "M. Steyvers"], "venue": "Proc Natl Acad Sci U S A,", "citeRegEx": "Griffiths and Steyvers,? \\Q2004\\E", "shortCiteRegEx": "Griffiths and Steyvers", "year": 2004}, {"title": "Online learning for latent dirichlet allocation", "author": ["Hoffman", "Matthew D", "Blei", "David M", "Bach", "Francis R"], "venue": "In Advances in Neural Information Processing Systems 23: 24th Annual Conference on Neural Information Processing Systems", "citeRegEx": "Hoffman et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Hoffman et al\\.", "year": 2010}, {"title": "Expectation-Propagation for the generative aspect model", "author": ["T. Minka", "J. Lafferty"], "venue": "In Proceedings of the 18th Conference on Uncertainty in Artificial Intelligence (UAI)", "citeRegEx": "Minka and Lafferty,? \\Q2002\\E", "shortCiteRegEx": "Minka and Lafferty", "year": 2002}, {"title": "Divergence measures and message passing", "author": ["Minka", "Thomas"], "venue": "Technical report, Microsoft Research,", "citeRegEx": "Minka and Thomas.,? \\Q2005\\E", "shortCiteRegEx": "Minka and Thomas.", "year": 2005}, {"title": "Estimating a dirichlet distribution", "author": ["Minka", "Thomas P"], "venue": "Technical report, Microsoft,", "citeRegEx": "Minka and P.,? \\Q2000\\E", "shortCiteRegEx": "Minka and P.", "year": 2000}, {"title": "The dlr hierarchy of approximate inference", "author": ["Rosen-Zvi", "Michal", "Jordan", "Michael I", "Yuille", "Alan L"], "venue": "In Proceedings of the 21st Conference in Uncertainty in Artificial Intelligence,", "citeRegEx": "Rosen.Zvi et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Rosen.Zvi et al\\.", "year": 2005}, {"title": "Deterministic single-pass algorithm for lda", "author": ["Sato", "Issei", "Kurihara", "Kenichi", "Nakagawa", "Hiroshi"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "Sato et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Sato et al\\.", "year": 2010}, {"title": "Latent-space variational bayes", "author": ["Sung", "Jaemo", "Ghahramani", "Zoubin", "Bang", "Sung-Yang"], "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence,", "citeRegEx": "Sung et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Sung et al\\.", "year": 2008}, {"title": "A collapsed variational Bayesian inference algorithm for latent Dirichlet allocation", "author": ["Teh", "Yee Whye", "Newman", "David", "Welling", "Max"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "Teh et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Teh et al\\.", "year": 2007}, {"title": "Collapsed variational inference for hdp", "author": ["Teh", "Yee Whye", "Kurihara", "Kenichi", "Welling", "Max"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "Teh et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Teh et al\\.", "year": 2008}, {"title": "A generalized predictive criterion for model selection", "author": ["M. Trottini", "F. Spezzaferri"], "venue": "In Canadian Journal of Statisticse,", "citeRegEx": "Trottini and Spezzaferri,? \\Q2002\\E", "shortCiteRegEx": "Trottini and Spezzaferri", "year": 2002}, {"title": "Rethinking lda: Why priors matter", "author": ["Wallach", "Hanna", "Mimno", "David", "McCallum", "Andrew"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "Wallach et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Wallach et al\\.", "year": 2009}, {"title": "Online variational inference for the hierarchical dirichlet process", "author": ["Wang", "Chong", "Paisley", "John William", "Blei", "David M"], "venue": "Journal of Machine Learning Research - Proceedings Track,", "citeRegEx": "Wang et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Wang et al\\.", "year": 2011}, {"title": "Information geometric measurements of generalisation", "author": ["Zhu", "Huaiyu", "Rohwer", "Richard"], "venue": "Technical report, Aston University,", "citeRegEx": "Zhu et al\\.,? \\Q1995\\E", "shortCiteRegEx": "Zhu et al\\.", "year": 1995}], "referenceMentions": [{"referenceID": 10, "context": "The collapsed variational Bayes (CVB) inference was developed as an alternative deterministic inference for LDA (Teh et al., 2007).", "startOffset": 112, "endOffset": 130}, {"referenceID": 9, "context": "(Sung et al., 2008) generalized the CVB inference for conjugate-exponential family models, called latent-space variational Bayes (LSVB) inference.", "startOffset": 0, "endOffset": 19}, {"referenceID": 10, "context": "(Teh et al., 2007) used a second-order Taylor expansion to perform the integrals.", "startOffset": 0, "endOffset": 18}, {"referenceID": 1, "context": "(Asuncion et al., 2009; Asuncion, 2010) proposed another approximation that uses only the zeroorder information, called the CVB0 inference.", "startOffset": 0, "endOffset": 39}, {"referenceID": 13, "context": "(Wallach et al., 2009) explored the effects of choosing \u03b3 and \u03b2 in LDA.", "startOffset": 0, "endOffset": 22}, {"referenceID": 10, "context": "(Teh et al., 2007) proposed the CVB inference to LDA inspired by the collapsed Gibbs sampler and showed that the CVB-LDA outperformed the VB-LDA in terms of perplexity.", "startOffset": 0, "endOffset": 18}, {"referenceID": 1, "context": "(Asuncion et al., 2009) showed the usefulness of an approximation using only zero-order information, called the CVB0 inference.", "startOffset": 0, "endOffset": 23}, {"referenceID": 7, "context": "In the case \u03b1 = 1, the update (20) is similar to belief propagation, and the factorized neighbors algorithm (Rosen-Zvi et al., 2005).", "startOffset": 108, "endOffset": 132}, {"referenceID": 1, "context": "(Asuncion et al., 2009) showed that CVB0-LDA with \u03b2 = 0.", "startOffset": 0, "endOffset": 23}, {"referenceID": 10, "context": "The comparison metric we used for document modeling was the perplexity used by (Teh et al., 2007; 2008) that indicates the prediction performance for held-out words.", "startOffset": 79, "endOffset": 103}, {"referenceID": 3, "context": "Future work is to develop an online-update extension, such as that by (Hoffman et al., 2010; Sato et al., 2010; Wang et al., 2011).", "startOffset": 70, "endOffset": 130}, {"referenceID": 8, "context": "Future work is to develop an online-update extension, such as that by (Hoffman et al., 2010; Sato et al., 2010; Wang et al., 2011).", "startOffset": 70, "endOffset": 130}, {"referenceID": 14, "context": "Future work is to develop an online-update extension, such as that by (Hoffman et al., 2010; Sato et al., 2010; Wang et al., 2011).", "startOffset": 70, "endOffset": 130}], "year": 2012, "abstractText": "We propose a novel interpretation of the collapsed variational Bayes inference with a zero-order Taylor expansion approximation, called CVB0 inference, for latent Dirichlet allocation (LDA). We clarify the properties of the CVB0 inference by using the \u03b1divergence. We show that the CVB0 inference is composed of two different divergence projections: \u03b1 = 1 and \u22121. This interpretation will help shed light on CVB0 works.", "creator": " TeX output 2012.05.21:0841"}}}