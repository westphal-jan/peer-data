{"id": "1406.6764", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "26-Jun-2014", "title": "A factorization criterion for acyclic directed mixed graphs", "abstract": "Acyclically controlled mixed graphs, also known as semi-Markov models, represent the conditional structure of independence induced by a DAG model with latent variables in an observed margin. In this thesis, we present a factorization criterion for these models that corresponds to the global Markov property given by (the natural extension) d separation.", "histories": [["v1", "Thu, 26 Jun 2014 04:21:47 GMT  (169kb)", "http://arxiv.org/abs/1406.6764v1", "Appears in Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence (UAI2009)"]], "COMMENTS": "Appears in Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence (UAI2009)", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["thomas s richardson"], "accepted": false, "id": "1406.6764"}, "pdf": {"name": "1406.6764.pdf", "metadata": {"source": "CRF", "title": "A factorization criterion for acyclic directed mixed graphs", "authors": ["Thomas S. Richardson"], "emails": ["tsr@stat.washington.edu"], "sections": [{"heading": null, "text": "Acyclic directed mixed graphs, also known as semi-Markov models represent the conditional independence structure induced on an observed margin by a DAG model with latent variables. In this paper we present a factorization criterion for these models that is equivalent to the global Markov property given by (the natural extension of) dseparation."}, {"heading": "1 Introduction", "text": "Acyclic directed mixed graphs, also known as semiMarkov models contain directed (\u2192) and bi-directed (\u2194) edges subject to the restriction that there are no directed cycles. The use of such graphs to represent a statistical model may be traced to path diagrams introduced by [14], where bi-directed edges are used to represent correlated errors. Such graphs are useful for representing the independence structure arising from a DAG model with hidden variables. More recently they have proved useful in characterizing the set of intervention distributions that are identifiable [4, 13]. Ancestral graphs [12] are a subclass of ADMGs.\nThe global Markov property for such models is given by the natural extension of d-separation to graphs with bi-directed edges. [11] provided a local Markov property for acyclic directed mixed graphs that was equivalent to the global property for all distributions. [5] introduced a weaker version of the local Markov property which is equivalent to the global property under additional assumptions.\nIn order to be able to score these models we require a parametrization of the set of distributions obeying the conditional independence relations given by an ADMG. Until now such parametrizations have only been available in the multivariate Gaussian case [2, 12].\nIn this paper we give a factorization result which leads directly to a parametrization in the multivariate binary case. It is not hard to extend the parameterization to the general discrete case, though we do not do it here for reasons of space.\nWe illustrate the main ideas with the graph shown in Figure 1. This graph implies the conditional independence relations X1\u22a5X2, X4 and X2\u22a5X1, X3, which cannot be represented by a DAG model (without latents). The theorem given in this paper associates this graph with the following factorizations:\np(x1, x2) = p(x1)p(x2),\np(x1, x3) = p(x1)p(x3 | x1),\np(x2, x4) = p(x2)p(x4 | x2),\np(x1, x2, x3) = p(x3 | x1)p(x1)p(x2),\np(x1, x2, x4) = p(x4 | x2)p(x1)p(x2),\np(x1, x2, x3, x4) = p(x3, x4 | x1, x2)p(x1)p(x2).\nNote that the only terms here are: p(x1), p(x2), p(x3|x1), p(x4|x2) and p(x3, x4|x1, x2). These factorizations lead to a (variation dependent) parametrization in the binary case: if the variables are binary then p(X1 = 0), p(X2 = 0), p(X3 = 0|x1), p(X4 = 0|x2) and p(X3 = X4 = 0|x1, x2), with x1, x2 \u2208 {0, 1}, are sufficient to specify any multivariate binary distribution obeying the global Markov property for G1; see [1]. Note that there are 1 + 1 + 2 + 2 + 4 = 10 quantities here, which corresponds to the known dimension of this Markov model in the binary case.\nIt is possible to use the local directed Markov property for ADMGs in [11] (see \u00a74.2), together with a given or-\ndering (consistent with the directed edges), to obtain factorizations in terms of univariate densities, as proposed in [9]. However, this strategy suffers from the following problem: if only one order is considered then the factorization corresponds to a DAG, and hence, in general, will not be sufficient capture all of the independencies given by the ADMG, e.g. ordering the vertices as they are numbered in G1 would give:\np(x1, x2, x3, x4) = p(x1)p(x2)p(x3|x1)p(x4|x1, x2, x3),\nwhich does not imply X1\u22a5X4. On the other hand if all consistent orderings are considered then the set of densities does not form a parametrization as the dimension is too large, e.g. for G1 we would specify: p(x1), p(x2), p(x3 | x1), p(x4 | x2), p(x3 | x1, x2) and p(x4 | x1, x2), which gives 14 parameters in the binary case. Consequently these are not all free: some are constrained to be deterministic functions of others. The factorization in this paper is more complicated as it involves multivariate joint densities, but it has the advantage that it does give a parametrization.\nIn an ADMG, a set A is said to be ancestrally closed if x \u2192 \u00b7 \u00b7 \u00b7 \u2192 a in G with a \u2208 A implies that x \u2208 A. Our main result is then as follows: a distribution P obeys the global Markov property with respect to an ADMG G if and only if for every ancestrally closed set A:\np(XA) = \u220f\nHi\u2208[A]G\np(XHi | XTi)\nwhere [A]G denotes a partition of A into sets {H1, . . . , Hk}, with corresponding conditioning sets T1, . . . , Tk; for details of the partition and conditioning sets see Theorem 4 below.\nThis generalizes and unifies three existing results for subclasses of ADMGs: First, the well-known factorization of an ancestrally closed set in a DAG D [10]:\np(XA) = \u220f\nv\u2208A\np(Xv | XpaD(v)).\nSecond, the factorization associated with any set A in a bi-directed graph B [3]:\np(XA) = \u220f\nC :C\u2286A; C is connected in B,\nand C is inclusion maximal in A\np(XC);\nwhere a set C is connected if every pair of vertices in C are joined by a path in C, and a connected set C is inclusion maximal in A if there is no set of C\u2217, with C \u2282 C\u2217 \u2286 A, that is connected. (Note that in a bi-directed graph every set is ancestrally closed trivially since there are no directed edges.) Third the factorization associated with a bi-directed chain graph such as G1; see [1].\nThe paper is organized as follows: \u00a72 contains basic definitions; \u00a73 contains the factorization result; \u00a74 outlines the proof."}, {"heading": "2 Definitions and Basic Concepts", "text": "A directed cycle is a sequence of edges x \u2192 \u00b7 \u00b7 \u00b7 \u2192 x. If a directed mixed graph G contains no directed cycles then G is acyclic. There may be two edges between a pair of vertices in an acyclic directed mixed graph (ADMG), but in this case at least one edge must be bi-directed (x \u2194 y): otherwise there would be a directed cycle (multiple edges of the same type are not permitted). The induced subgraph of G given by set A, denoted GA consists of the subgraph of G with vertex set A, and those edges in G with endpoints in A. The connected components of a graph G are\nFor a vertex x in a mixed graph G, paG(x) \u2261 {v | v \u2192 x in G} is the set of parents of x; if y \u2208 paG(x) then x \u2208 chG(y), the set of children of y; spG(x) \u2261 {v | v \u2194 x in G} is the set of spouses1 of x; anG(x) \u2261 {v | v \u2192 \u00b7 \u00b7 \u00b7 \u2192 x in G or v = x} is the set of ancestors of x; similarly deG(x) \u2261 {v | v \u2190 \u00b7 \u00b7 \u00b7 \u2190 x in G or v = x} is the set of descendants of x. These definitions are applied disjunctively to sets of vertices, so that, for example,\npaG(A) \u2261 \u22c3\nx\u2208A\npaG(x), spG(A) \u2261 \u22c3\nx\u2208A\nspG(x).\n(Note that spG(A)\u2229A may be non-empty, and likewise for the other definitions.) A path between x and y in G is a sequence of edges \u3008\u01eb1, . . . , \u01ebn\u3009, such that there exists a sequence of distinct vertices \u3008x \u2261 w1, . . . , wn+1 \u2261 y\u3009, (n\u22650), where edge \u01ebi has endpoints wi, wi+1 (paths consisting of a single vertex are permitted for the purpose of simplifying proofs). We denote a subpath of a path \u03c0, by \u03c0(wj , wk+1) \u2261 \u3008\u01ebj , . . . , \u01ebk\u3009. It is necessary to specify a path as a sequence of edges rather than vertices because the latter does not specify a unique path when there may be two edges between a given pair of vertices. A path of the form x \u2192 \u00b7 \u00b7 \u00b7 \u2192 y is a directed path from x to y.\nFor a mixed graph G with vertex set V we consider collections of random variables (Xv)v\u2208V taking values in probability spaces (Xv)v\u2208V , where the probability spaces are either real finite-dimensional vector spaces or finite discrete sets. For A \u2286 V we let XA \u2261 \u00d7v\u2208A(Xv), X \u2261 XV and XA \u2261 (Xv)v\u2208A. We use the usual shorthand notation: v denotes a vertex and a random variable Xv, likewise A denotes a vertex set and XA.\n1Note that our usage, though established, differs from that of some authors who use the term \u2018spouse\u2019 to denote the other parents of the children of a vertex in a DAG."}, {"heading": "2.1 The global Markov property for ADMGs", "text": "A non-endpoint vertex z on a path is a collider on the path if the edges preceding and succeeding z on the path have an arrowhead at z, i.e. \u2192 z \u2190, \u2194 z \u2194, \u2194 z \u2190, \u2192 z \u2194. A non-endpoint vertex z on a path which is not a collider is a non-collider on the path, i.e. \u2190 z \u2192, \u2190 z \u2190, \u2192 z \u2192, \u2194 z \u2192, \u2190 z \u2194. A path between vertices x and y in a mixed graph is said to be m-connecting given a set Z if\n(i) every non-collider on the path is not in Z, and\n(ii) every collider on the path is an ancestor of Z.\nIf there is no path m-connecting x and y given Z, then x and y are said to bem-separated given Z. SetsX and Y are said to be m-separated given Z, if for every pair x, y, with x \u2208 X and y \u2208 Y , x and y are m-separated given Z.\nA probability measure P on X is said to satisfy the global Markov property for G if for arbitrary disjoint sets X,Y, Z, (Z may be empty) X is m-separated from Y given Z in G implies X\u22a5 Y | Z [P ]. Note that if G is a DAG then the above definition is identical to Pearl\u2019s d-separation criterion; see [6, 10].\nIn a given set T with subset A, we will say that B forms the Markov blanket for A in T , if B \u2286 T \\A and A is m-separated from T \\ (B \u222aA) given B, and there is no subset of B for which this is true.\nFor an ADMG G we define:\nA(G) \u2261 {A | anG(A) = A}\nthe set of ancestrally closed sets. The set A(G) forms a lattice so that if A,B \u2208 A(G), then A \u2229B,A \u222aB \u2208 A(G)."}, {"heading": "2.2 Barren subsets", "text": "For a given vertex set A we define:\nbarren(A) \u2261 {x | x \u2208 A; deG(x) \u2229A = {x}}.\nNote that this definitions is intrinsic to the set A in the sense that a vertex v \u2208 barren(A) if v has no descendants in G that are in A; v may have descendants in G that are not in A.\nProposition 1. In an ADMG, (i) barren(an(A)) = barren(A) \u2286 A; (ii) if A \u2208 A(G) then an (barren (A)) = A; (iii) if B \u2286 A then barren(A) \u2229 B \u2286 barren(B)."}, {"heading": "2.3 Districts", "text": "For a given ADMG G, the induced bi-directed graph (G)\u2194 is the graph formed by removing all directed\nedges from G. Likewise (G)\u2192 is the DAG formed by removing all bi-directed edges. The district (aka ccomponent) for a vertex x in G is the connected component of x in (G)\u2194, or equivalently\ndisG(x) \u2261 {y | y \u2194 \u00b7 \u00b7 \u00b7 \u2194 x in G or x = y} .\nSimilarly we let disA(x) = disGA(x); if x /\u2208 A then we define disA(x) = \u2205. Note that disA(x) \u2286 dis(x) \u2229 A, with strict inclusion possible: a vertex v is in disA(x) only if v \u2208 A and there is a path from v to x in (G)\u2194 on which every vertex is in A; the condition for membership in dis(x)\u2229A is the same, except that the requirement that every vertex on the path is in A is removed. As usual we apply the definition disjunctively to sets:\ndisA(B) = \u22c3\nx\u2208B\ndisA(x).\nProposition 2. If W is a set in an ADMG G, then: (i) the set of districts {disW (v) | v \u2208 W} forms a partition of W ; (ii) for any v, disW (v) = disdisW (v)(v); (iii) vf w \u2208 W \u2217 \u2286 W then disW\u2217(w) \u2286 disW (w).\nA set C is path-connected in (G)\u2194 if every pair of vertices in C are connected via a path in (G)\u2194; equivalently, every vertex in C has the same district in G. Note that a set C may be path-connected in (G)\u2194 without forming a connected set in (G)\u2194. (Recall that if a set C is connected then between every pair of vertices in C there is a path on which every vertex is itself in C; equivalently, every vertex in C is in the same district in GC .)\nA district D = disW (v) of a vertex v in a set W in G is said to be ancestrally closed if for every vertex v,\nD = disanG(D)(v).\nThus the district of v within W would not get any larger if we were to add to W all vertices in G that are ancestors of vertices that are already in the district of v within W . (Note that if this property holds for one vertex v \u2208 D, then it holds for all vertices in D.) By extension, a set W will be said to have ancestrally closed districts if every district in W is ancestrally closed.\nProposition 3. If W \u2208 A(G) then W has ancestrally closed districts.\nNote however that the converse is false: a set may have ancestrally closed districts but not be ancestral. For example in the graph in Figure 2 all subsets of the vertices have ancestrally closed districts, including those which are not ancestral."}, {"heading": "3 Factorization", "text": "The main result of the paper is as follows:\nTheorem 4. A probability distribution P obeys the global Markov property for G if and only if for every A \u2208 A(G),\np(XA) = \u220f\nH\u2208[A]G\np(XH | Xtail(H)) (1)\nwhere [A]G denotes a partition of A into sets {H1, . . . , Hk} \u2286 H(G), defined with tail(H), below.\nThe factorization associated with an ADMG is of necessity more involved than in DAGs or chain graphs: in a DAG, one may always find a total ordering under which the parents of a vertex v precede v. In chain graphs this is generalized so that the parents of an \u2018undirected component\u2019 precede the component itself. In the case of an ADMG graph, \u2018blocks\u2019 are heads (defined below) which are subsets of connected components of G\u2194. However, it is easy to find ADMG graphs in which there is no ordering under which every vertex that is a parent of at least one vertex in a given head, occurs prior to any vertex in that head. For example,\nin Figure 2, {1, 4} and {2, 3} form heads. It is easy to see that if 1 is ordered before 2 and 3, then we cannot also have 2 ordered before 1 and 4.\nThe upshot of this is that the inclusion of a term in the factorization in which vertex i is on the left of the conditioning bar, and j is on the right, does not preclude the inclusion of a term, in the same factorization, in which the reverse holds. For example, we associate with the graph in Figure 2, the factorization:\np(x1, x2, x3, x4) = p(x1, x4 | x2)p(x2, x3 | x1). (2)\nIt is easy to see that this factorization implies that X3\u22a5X4 | X1, X2. However, after marginalizing x3 and x4 it can be seen that (2) implies\np(x1, x2) = p(x1 | x2)p(x2 | x1),\nso X1\u22a5X2, which also follows from the global Markov property associated with this graph. In this sense the factorization is \u2018cyclic\u2019 in nature."}, {"heading": "3.1 Factorization terms: heads and tails", "text": "Each term in the factorization takes the form p(XH | XT ), H,T \u2286 V ; H\u2229T = \u2205. Following [8], we will refer to H as the head of the term p(XH | XT ), and T as the tail. However, only certain pairs of sets (H,T ) will occur in factorizations associated with G. An ordered pair of sets (H,T ) form the head and tail of a term associated with G if and only if all of the following hold:\n(i) H = barren(anG(H)),\n(ii) H forms a path-connected set in (Gan(H))\u2194,\nand (iii) T = ( disan(H)(H) \\H ) \u222a pa(disan(H)(H)).\nCondition (i) may be re-expressed by saying that for every vertex x \u2208 H , anG(x) \u2229H = {x}. Condition (ii) is equivalent to the assertion that\ndisan(H)(H) = \u22c2\nv\u2208H\ndisan(H)(v).\nFor a graph G, the set of heads is denoted by H(G). By condition (iii), if H \u2208 H(G), then there is a unique tail which we denote tail(H). The tail associated with H consists of the variables in disan(H)(H) that are not in H , and any vertex which is a parent of a vertex in disan(H)(H), which includes all vertices in pa(H). In what follows it will be useful to distinguish between these two subsets of tail(H) hence we introduce the following definitions:\ndis-tail(H) \u2261 disan(H)(H) \\H,\npa-tail(H) \u2261 pa(disan(H)(H))\n(note that these two sets need not be disjoint). All vertices in the tail are connected to a vertex in H by a path on which every non-endpoint vertex is a collider, and every vertex is an ancestor of some vertex in H . Given a set W \u2287 an(H), with de(W ) \u2229H = H ; sp(disan(H)(H)) \u2229 W \u2286 an(H), the global Markov property for G implies that\nH \u22a5 W \\ (H \u222a tail(H)) | tail(H)\nor in other words, tail(H) is the Markov blanket for H in the set W .\nFor a bi-directed graph B, H(B) is simply the set of connected subsets of vertices; for a DAG D it is the set of all singleton sets: H(D) = {{v}|v \u2208 V }.\nLemma 5. If H \u2208 H(G), then tail(H) \u2229 de(H) = \u2205.\nProof: Suppose for a contradiction that there is some vertex v \u2208 tail(H) \u2229 de(H). Since, by definition,\ntail(H) = ( disan(H)(H) \\H ) \u222a pa(disan(H)(H)) \u2286 an(H), this implies that H 6= barren(anG(H)), which is a contradiction. 2\nCorollary 6. If H \u2208 H(G) then H \u2229 tail(H) = \u2205.\nProof: Follows from Lemma 5 since H \u2286 de(H). 2\nIn a complete ADMG G, for every set W \u2208 A(G), barren(W ) is path-connected in (GW )\u2194, so\nH(G) = {H | H = barren(W ) for some W \u2208 A(G)} .\nProposition 7. If A \u2208 A(G), then H(GA) = {H | H \u2208 H(G), H \u2286 A}.\nProposition 8. The mapping H(G) \u2192 A(G) given by A = anG(H) is injective (one-to-one). Further, if G is complete then it is surjective (onto)."}, {"heading": "3.2 Decomposition of a set: [W ]G", "text": "For any ADMG G and a subset of verticesW , we define the following functions:\n\u03a6G(\u2205) \u2261 \u2205,\n\u03a6G(W ) \u2261 {\nH \u2223 \u2223 \u2223 \u2223 \u2223 H = \u22c2\nx\u2208H\nbarren (anG (disW (x))) ; H 6= \u2205\n}\n,\n\u03c8G(W ) \u2261 W \\ \u22c3\nH\u2208\u03a6G(W )\nH,\n\u03c8 (k) G (W ) \u2261 \u03c8G(\u00b7 \u00b7 \u00b7\u03c8G(W ) \u00b7 \u00b7 \u00b7 )\n\ufe38 \ufe37\ufe37 \ufe38\nk-times\n, \u03c8 (0) G (W ) \u2261 W.\nFinally, we define the partition induced by G on W to be:\n[W ]G \u2261 \u22c3\nk\u22650\n\u03a6G\n(\n\u03c8 (k) G (W )\n)\n.\nAs described below, when applied to a setW , the function \u03a6G(W ) returns a set of heads, one for each district in W . For a given district D \u2286 W , the associated head consists of those vertices in D that are not ancestors (in G) of any other vertices in D. The purpose of the intersection over elements in H is to ensure that H is path-connected in (GW )\u2194; an equivalent definition is thus:\n\u03a6G(W ) = {H | \u2205 6= H = barren (anG (disW (H))) ;\nH is path-connected in (GW )\u2194} .\nThus every pair of distinct vertices in H are connected by a path in (GW )\u2194 on which every edge is bi-directed, and is in W . As before it will not be true in general that H itself will form a connected set in (GW )\u2194.\nThe function \u03c8G(W ) simply removes from W all those vertices which occur in some head in \u03a6G(W )."}, {"heading": "3.3 Parametrization", "text": "Multivariate binary distributions obeying the global Markov property with respect to an ADMG G may be parametrized by the following set of probabilities:\n{ p(XH=0 | Xtail(H)=xtail(H)) \u2223 \u2223 \u2223 H \u2208 H(G),\nxtail(H) \u2208 {0, 1} |tail(H)|\n}\n.\nLet \u03b1 : V 7\u2192 {0, 1}|V | be an assignment of values to the variables indexed by V . Define \u03b1(W ) to be the values assigned to variables indexed by a subset W \u2286 V . Let \u03b1\u22121(0) = {v | v \u2208 V, \u03b1(v) = 0}. Then:\np (XV =\u03b1(V )) = \u2211\nC : \u03b1\u22121(0)\u2286C\u2286V\n(\u22121)|C\\\u03b1 \u22121(0)|\u00d7\n\u220f\nH\u2208[C]G\nP ( XH = 0 \u2223 \u2223Xtail(H) = \u03b1(tail(H)) ) .\n3.4 Examples\nFirst consider the graph in Figure 2. We have the following decompositions:\n[{x1, x2}]G = {{x1}, {x2}}\n[{x1, x2, x3}]G = {{x2, x3}, {x1}}, [{x1, x2, x4}]G = {{x1, x4}, {x2}},\n[{x1, x2, x3, x4}]G = {{x1, x4}, {x2, x3}},\n[{x1, x3}]G = {{x1}, {x3}}, [{x2, x4}]G = {{x2}, {x4}}.\nTogether with the singleton sets {x1}, {x2} which have trivial decompositions, these represent all of the ancestral sets in this graph. These decompositions lead to the following factorizations:\np(x1, x2) = p(x1)p(x2),\np(x1, x2, x3) = p(x2, x3|x1)p(x1),\np(x1, x2, x4) = p(x1, x4|x2)p(x2), (3)\np(x1, x2, x3, x4) = p(x1, x4|x2)p(x2, x3|x1),\np(x1, x3) = p(x3|x1)p(x1),\np(x2, x4) = p(x4|x2)p(x2).\nExamples of the parametrization are as follows:\np(X1234=0) = p(X14=0|X2=0)p(X23=0|X1=0),\nwhere we use the obvious shorthand, e.g. {X14=0} \u2261 {X1=X4=0};\np(X12=0, X34=1)\n= p(X1=0)p(X2=0)\u2212 p(X23=0|X1=0)p(X1=0)\n\u2212 p(X14=0|X2=0)p(X2=0)\n+ p(X14=0|X2=0)p(X23=0|X1=0);\np(X12=1, X34=0)\n= p(X3=0|X1 = 1)p(X4=0|X2=1)\n\u2212 p(X3=0|X1=1)p(X14=0|X2=1)\n\u2212 p(X23=0|X1=1)p(X4=0|X2=1)\n+ p(X23=0|X1=1)p(X14=0|X2=1).\nFor a more complex example, we present five decompositions resulting from the graph in Figure 3:\n[{d, e}]G = {{d, e}} ,\n[{c, d, e}]G = {{c, d}, {e}} ,\n[{b, c, d, e}]G = {{b, c}, {d, e}} ,\n[{a, b, c, d, e}]G = {{a, c}, {b, e}, {d}} ,\n[{a, b, d, e}]G = {{a}, {b, e}, {d}} ,\nwith the corresponding factorizations:\np(d, e) = p(d, e),\np(c, d, e) = p(c, d|e)p(e),\np(b, c, d, e) = p(b, c|d, e)p(d, e),\np(a, b, c, d, e) = p(a, c|b, d, e)p(b, e|d)p(d),\np(a, b, d, e) = p(a|b)p(b, e|d)p(d).\nThe first four do not imply any constraint on the associated margin. This is a consequence of the fact that there is only one district in each of these ancestral sets. Note that even though {a, b, c, d, e} forms a single district, {a, b, d, e} contains two districts."}, {"heading": "3.5 Properties of \u03a6G(W )", "text": "Proposition 9. If H \u2208 \u03a6G(W ), then H \u2286 W .\nProof: If for some x \u2208 H , disW (x) = \u2205 then H \u2286 barren(anG(\u2205)) = \u2205, which is a contradiction. But if disW (x) 6= \u2205 then by definition x \u2208 W . 2\nLemma 10. If x1, x2 \u2208 H \u2208 \u03a6G(W ), then disW (x1) = disW (x2), hence for all x \u2208 H, H = barren(anG(disW (x))).\nProof: LetDi = disW (xi), i \u2208 {1, 2}. By Proposition 9 disW (xi) 6= \u2205, i \u2208 {1, 2}. By Proposition 2 (i), if D1 6=\nD2, then D1 \u2229 D2 = \u2205. Further, by Proposition 1(i) barren (anG(Di)) \u2286 Di (i \u2208 {1, 2}). HenceD1\u2229D2 = \u2205 implies that H = \u2205, which is a contradiction. 2\nCorollary 11. If H1, H2 \u2208 \u03a6G(W ) and H1 6= H2 then disW (H1) \u2229 disW (H2) = \u2205.\nProof: Suppose for a contradiction that x \u2208 disW (H1) \u2229 disW (H2). This implies that disW (hj) = disW (x), for any hj \u2208 Hj , j \u2208 {1, 2}. It then follows by Lemma 10 that\nH1 = barren(anG(disW (x))) = H2,\nwhich is a contradiction. 2\nCorollary 12. If H1, H2 \u2208 \u03a6G(W ) and H1 6= H2 then H1 \u2229H2 = \u2205.\nProof: Immediate from Corollary 11, since Hi \u2286 disW (Hi), i \u2208 {1, 2}. 2\nCorollary 13. For any set A, [A]G partitions A.\nProof: By Corollary 12, no two sets in \u03a6G\n(\n\u03c8 (k) G (A)\n)\n,\nfor fixed k, overlap. Further, by Proposition 9, and the definition of \u03c8 (k) G (A), the sets in \u03a6G ( \u03c8 (i) G (A) ) and\n\u03a6G\n(\n\u03c8 (j) G (A)\n)\ndo not overlap. Since W 6= \u2205 implies\n\u03a6G(W ) 6= \u2205, {\u03c8 (i) G (A)}i is a monotonically decreasing sequence of sets, so the sets in [A]G exhaust A. 2\nLemma 14. If H \u2208 \u03a6G(W ) then H \u2208 H(G).\nProof: We first show that barren(an(H)) = H . Since for any h \u2208 H , H = barren(anG(disW (h))), it follows by Proposition 1 (ii) that anG(H) = anG(disW (h)) hence barren(anG(H)) = barren(anG(disW (h))). Since this holds for any h \u2208 H , it then follows that\nbarren(anG(H)) = \u22c2\nh\u2208H\nbarren(anG(disW (h))) = H.\nWe now show that disan(H)(H) is path-connected in (Gan(H))\u2194, or equivalently that\ndisanG(H)(H) = \u22c2\nv\u2208H\ndisanG(H)(v),\nand thus H \u2208 H(G). For any h \u2208 H ,\ndisanG(H)(h) = disanG(disW (h))(h)\n\u2287 disdisW (h)(h) = disW (h),\nwhere: the first equality is by Proposition 1(ii); the inclusion follows from Proposition 2 (iii); the last equality uses Proposition 2 (ii). Hence\n\u22c2\nh\u2208H\ndisanG(H)(h) \u2287 \u22c2\nh\u2208H\ndisW (h) \u2287 H,\nwhere the last inclusion follows from the definition of \u03a6G(W ), and Proposition 1(i). By Proposition 2 (i) the LHS is either equal to the empty set or disanG(H)(H), which concludes the proof. 2\nFor x \u2208 A we define head(x;A) to be the head H containing x in [A]G . For H \u2208 [A]G we refer to the k \u2265 0, for which H \u2208 \u03a6G(\u03c8\n(k)(A)), as the depth of H in A, denoted depA(H). Similarly the depth of a vertex h \u2208 A, is the depth in A of the head containing it: depA(x) = depA(head(x;A))."}, {"heading": "3.6 Properties of \u03c8G(W ) when W has ancestrally closed districts", "text": "We will show that if W has ancestrally closed districts then so does \u03c8G(W ). We will also show that if W has ancestrally closed districts then the district-tail of any head H \u2208 \u03a6G(W ) is contained in \u03c8G(W ).\nIn subsequent proofs we will make use of the following:\nLemma 15. If W has ancestrally closed districts and H \u2208 \u03a6G(W ) then disW (v) = disan(H)(v), for all v \u2208 disW (H).\nProof: First observe that an(H) = an(barren(an(disW (H)))) = an(disW (H)) \u2287 disW (H). Hence disan(H)(v) is not empty, if v \u2208 disW (H). Further,\ndisan(H)(v) = disan(disW (H))(v)\n= disan(disW (v))(v) = disW (v),\nwhere the second equality follows since v \u2208 disW (H), the third equality follows since W has ancestrally closed districts. 2\nLemma 16. If W has ancestrally closed districts, then so does \u03c8(W ).\nCorollary 17. If A \u2208 A(G) then for k \u2265 0, \u03c8 (k) G (A) has ancestrally closed districts.\nProof: The result follows from Proposition 3 and kapplications of Lemma 16. 2\nLemma 18. If A \u2208 A(G), and H \u2208 [A]G , with depA(H) = k, then dis-tail(H) \u2286 \u03c8 (k+1)(A).\nProof: By hypothesis H \u2208 \u03a6G(\u03c8(k)(A)). By Corollary 17, \u03c8(k)(A) has ancestrally closed districts. Thus by Lemma 15, disan(H)(H) = disan(\u03c8(k)(A))(H). Further, since \u03c8(k)(A) has ancestrally closed districts, and H \u2286 \u03c8(k)(A), disan(\u03c8(k)(A))(H) = dis\u03c8(k)(A)(H). By Corollary 11, for H \u2032 \u2208 \u03a6G(\u03c8(k)(A)), with H \u2032 6= H , dis\u03c8(k)(A)(H)\u2229dis\u03c8(k)(A)(H \u2032) = dis\u03c8(k)(A)(H)\u2229H \u2032 = \u2205.\nHence\ndis-tail(H) = disan(H)(H) \\H\n= disan(H)(H) \\\n  \u22c3\nH\u2032\u2208\u03a6G(\u03c8(k)(A))\nH \u2032\n\n\n= dis\u03c8(k)(A)(H) \\\n  \u22c3\nH\u2032\u2208\u03a6G(\u03c8(k)(A))\nH \u2032\n\n\n\u2286 \u03c8(k+1)(A).\nHere the last inclusion follows by definition of \u03c8(\u00b7). 2"}, {"heading": "4 Equivalence of global Markov property and factorization", "text": "An inductive argument establishing Theorem 4 faces several challenges: If A is an ancestral set, there may be no head H \u2208 [A]G such that A \\ H is an ancestral set: see for example the set {x1, x2, x3, x4} in Figure 2, in which {x1, x4} and {x2, x3} are the heads. Since Theorem 4 only makes assertions about factorizations over margins p(XA) where A is an ancestral set, this means that we cannot apply an inductive argument where we add one term at a time. Further, as the examples in section 3.4 make clear, the heads occurring in the decomposition of an ancestral set A do not necessarily occur in the decomposition of an ancestral superset A \u222a {x}. Thus any inductive argument which hypothesizes that the factorization holds for p(XA) and then extends this to p(XA\u222a{x}) must also transform the terms in the factorization of p(XA).\nWe first sketch our proof strategy by considering the example in Figure 4. Suppose, as an inductive hypothesis that, as required by Theorem 4,\np(a1, a2, b1, b2, c1, c2, d)\n= p(b1, c1|a1, c2, d)p(a1|c2)p(b2, c2|a2, c1, d)\n\u00d7p(a2|c1)p(d). (4)\nWe wish to show that the global Markov property implies that\np(a1, a2, b1, b2, c1, c2, d, e)\n= p(e, b1, b2|a1, a2, c1, c2, d)\n\u00d7p(d)p(a1, c1|c2)p(a2, c2|c1). (5)\nTo this end we use the chain rule to further factorize the terms in equation (4), as follows:\np(b1, c1|a1, c2, d) = p(b1|a1, c1, c2, d)p(c1|a1, c2, d),\np(b2, c2|a2, c1, d) = p(b2|a2, c1, c2, d)p(c2|a2, c1, d).\nSince c1 is m-separated from d given a1 and c2, p(c1|a1, c2, d) = p(c1|a1, c2). Likewise p(c2|a2, c1, d) = p(c2|a2, c1). Also since b1 is m-separated from a2 given {a1, c1, c2, d} we have p(b1|a1, c1, c2, d) = p(b1|a1, a2, c1, c2, d). Finally, we note that b2 is mseparated from {a1, b1} given {a2, c1, c2, d}, hence p(b2|a2, c1, c2, d) = p(b2|a1, a2, b1, c1, c2, d). We now obtain:\np(e|a1, a2, b1, b2, c1, c2, d)p(a1, a2, b1, b2, c1, c2, d)\n= (\np(e|a1, a2, b1, b2, c1, c2, d)\n\u00d7 p(b1|a1, a2, c1, c2, d)p(b2|a1, a2, b1, c1, c2, d) )\n\u00d7p(d) ( p(c1|a1, c2)p(a1|c2) )\n\u00d7 ( p(c2|a2, c1)p(a2|c1) )\nwhich establishes the required factorization (5). A key step in this argument was the ordering used to decompose p(b1, c1|a1, c2, d) into univariate marginals. Had this been decomposed into p(c1|a1, b1, c2, d)p(b1|a1, c2, d), the argument would not have gone through, as the global Markov property could not have been applied, and the terms could not have been re-arranged in the required manner.\nWe first consider the relation between the depth of a vertex in A, and in A \u222a {x}, (in the case where both sets are ancestral). We show that there exists a (not necessarily unique) total order on the vertices in A \u222a {x}, which is compatible with both orderings on the heads, in the sense that a precedes b if the head containing a precedes the head containing b in [A]G , or in [A\u222a{x}]G . We use this total order to factor the head terms in the factorization of p(xA), given by the inductive hypothesis, into univariate terms. We will then apply the global Markov property to add or remove terms to the conditioning sets as required. Finally, regrouping terms will yield the required factorization of p(xA\u222a{x}).\nLemma 19. If A,A \u222a {x} \u2208 A(G), (x /\u2208 A) then for w \u2208 A, depA(w) \u2264 depA\u222a{x}(w).\nProof: By induction on k = depA\u222a{x}(w). 2\nLemma 20. If A,A \u222a {x} \u2208 A(G), (x /\u2208 A) then for w \u2208 A, depA\u222a{x}(w) \u2264 depA(w) + 1.\nA total ordering < on the vertices in a set A \u2208 A(G) will be said to be consistent with the depth ordering induced by A, if whenever depA(b) < depA(c), then b < c.\nCorollary 21. If A,A \u222a {x} \u2208 A(G), (x /\u2208 A) then there exists a total ordering on the vertices in A that is consistent with the depth ordering induced by A and the depth ordering induced by A \u222a {x}.\nWe note in passing that this Corollary cannot, in general, be extended to ancestral sets differing by more than one vertex. Consider the sets A = {c, d, e}, and A\u2217 = {a, b, c, d, e} in Figure 3. depA(e) = 1 > depA(d) = 0, but depA\u2217(d) = 2 > depA\u2217(e) = 1.\nIf < is a total ordering, define suc<(x) = {v | v \u2265 x}."}, {"heading": "4.1 Markov blankets derived from a depth ordering", "text": "Lemma 22. Let H \u2208 [A]G and H = {hi1 , . . . , hik} where the vertices are ordered according to a depth consistent total ordering <. Let Tj = {hij , . . . , hik} \u222a tail(H). Then\nBj = ( dissuc<(hij )(hij ) \\ {hij} ) \u222a pa(dissuc<(hij )(hij ))\nforms the Markov blanket of {hij} in Tj.\nNote that Bj is solely determined by hij , the ordering, and the graph G. Thus, if A and A\u222a{x} are ancestral sets (x /\u2208 A) and for some vertex v \u2208 A, head(v;A) = H , head(v;A\u222a{x}) = H\u2217, with associated tails T and T \u2217, then, under the ordering given in Corollary 21, the Markov blankets of {v} in the sets (H \u222a T ) \u2229 suc<(h) and (H\u2217 \u222a T \u2217) \u2229 suc<(h) are the same."}, {"heading": "4.2 The ordered local Markov property for", "text": "ADMGs\nA total ordering (\u227a) on the vertices of G, which satisfies x \u227a y \u21d2 y /\u2208 an(x) is said to be consistent with the ancestor relations in G. Let preG,\u227a(x) \u2261 {v | v \u227a x or v = x}. If A \u2208 A(G) and x \u2208 barren(A) then the Markov blanket of {x} with respect to the induced subgraph on A is\nmb(x,A) \u2261 paG\n( disA(x) ) \u222a ( disA(x) \\ {x} ) .\nA probability measure P satisfies the ordered local Markov property for G, with respect to the ancestor\nconsistent ordering \u227a, if for any x, and ancestral set A such that x \u2208 A \u2286 preG,\u227a(x),\n{x}\u22a5 A \\ (mb(x,A) \u222a {x}) | mb(x,A) [P ].\nNote that chG(x) \u2229 preG,\u227a(x) = \u2205, so chG(x) \u2229 A = \u2205. Since in a DAG, for an arbitrary ancestral set A containing no children of x, mb(x,A) = pa(x), the ordered local Markov property given above reduces to the local well-numbering Markov property introduced by [7]. In [11] it is shown that a probability measure obeys the global Markov property for an ADMG G if and only if it obeys the ordered local Markov property for G.\nLemma 23. If P factorizes according to G, then P obeys the ordered local Markov property for G.\nProof: Let x \u2208 A \u2208 A(G), with A \u2286 preG,\u227a(x). Let H = head(x;A). It is sufficient to note that mb(x;A) = tail(H) \u222a (H \\ {x}). 2"}, {"heading": "4.3 Proof of Theorem 4", "text": "Proof: It follows directly from Lemma 23, and the results in [11] that if a distribution factorizes according to (1) then it obeys the global Markov property for G.\nTo prove that if G obeys the global Markov property then it factorizes according to (1) we proceed by induction on the size of the ancestral set A \u2208 A(G).\nIf |A| = 1, then the claim is clearly trivial.\nIf |A| > 1, then barren(A) 6= \u2205. Let w be a vertex in barren(A), hence A \\ {w} \u2208 A(G). Let A\u2020 = A \\ {w}. By the induction hypothesis, (1) holds for p(xA\u2020). By Corollary 21 there exists a total ordering (<) on the vertices in A\u2020 that is consistent with the depth orderings induced by A\u2020 and A. Let v be an arbitrary vertex in A\u2020. Let H = head(v;A) and H\u2020 = head(v;A\u2020). Further let H = {h1, . . . hk}, and H\u2020 = {h \u2020 1, . . . h \u2020 k\u2020 }, where the vertices are sequenced according to <. (The vertices in H and H\u2020 will, in general, be subsequences of the sequence of vertices totally ordered by <. However, we refrain from using double subscripts in order to keep the notation simple.) Hence v = hj = h \u2020 j\u2020 , for some j, j\u2020. By Lemma 22, the Markov blankets of {v} in the sets Tj = {hj, . . . , hk} \u222a tail(H) and T \u2020j = {h \u2020 j , . . . , hk\u2020} \u222a tail(H \u2020) are the same. Hence\np (v | hj+1, . . . , hk, tail(H))\n= p ( v \u2223 \u2223 \u2223 h\n\u2020 j\u2020+1 , . . . , h\u2020 k\u2020 , tail(H\u2020)\n)\n(where the h\u2019s are omitted if v = hk and the h \u2020\u2019s are omitted if v = h\u2020k). Thus the density over the A \u2020 margin may be factorized into univariate terms of the\nappropriate form. Finally, we observe that since w \u2208 barren(A), w is m-separated from A \\ ( head(w;A) \u222a tail(w;A)) given (head(w;A) \u222a tail(w;A)) \\ {w}, so\np(w | A \\ {w})\n= p (w | (head(w;A) \u222a tail(w;A)) \\ {w}) .\nThis completes the proof. 2"}, {"heading": "Acknowledgements", "text": "This research was supported by U.S. NSF grant DMS0505865 and NIH grant R01 AI032475."}], "references": [{"title": "Discrete chain graph models", "author": ["M. Drton"], "venue": "Bernoulli, To appear,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2009}, {"title": "Computing maximum likelihood estimates in recursive linear models with correlated errors", "author": ["M. Drton", "M. Eichler", "T.S. Richardson"], "venue": "JMLR, To appear,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2009}, {"title": "Binary models for marginal independence", "author": ["M. Drton", "T.S. Richardson"], "venue": "J. Roy. Statist. Soc. Ser. B,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2008}, {"title": "Graphical Models", "author": ["S.L. Lauritzen"], "venue": null, "citeRegEx": "6", "shortCiteRegEx": "6", "year": 1996}, {"title": "Independence properties of directed Markov fields", "author": ["S.L. Lauritzen", "A.P. Dawid", "B. Larsen", "H.- G. Leimer"], "venue": "Networks, 20:491\u2013505,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 1990}, {"title": "Local computation with valuations from a commutative semigroup", "author": ["S.L. Lauritzen", "F.V. Jensen"], "venue": "Ann. Math. & Artif. Intell.,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1997}, {"title": "Causal graphical models with latent variables: learning and inference", "author": ["S. Meganck", "P. Leray", "B. Manderick"], "venue": null, "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2007}, {"title": "Probabilistic Reasoning in Intelligent Systems", "author": ["J. Pearl"], "venue": null, "citeRegEx": "10", "shortCiteRegEx": "10", "year": 1988}, {"title": "Markov properties for acyclic directed mixed graphs", "author": ["T.S. Richardson"], "venue": "Scand. J. Statist.,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2003}, {"title": "Ancestral graph Markov models", "author": ["T.S. Richardson", "P. Spirtes"], "venue": "Ann. Statist.,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2002}, {"title": "The method of path coefficients", "author": ["S. Wright"], "venue": "Ann. Math. Statist.,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 1934}], "referenceMentions": [{"referenceID": 10, "context": "The use of such graphs to represent a statistical model may be traced to path diagrams introduced by [14], where bi-directed edges are used to represent correlated errors.", "startOffset": 101, "endOffset": 105}, {"referenceID": 9, "context": "Ancestral graphs [12] are a subclass of ADMGs.", "startOffset": 17, "endOffset": 21}, {"referenceID": 8, "context": "[11] provided a local Markov property for acyclic directed mixed graphs that was equivalent to the global property for all distributions.", "startOffset": 0, "endOffset": 4}, {"referenceID": 1, "context": "Until now such parametrizations have only been available in the multivariate Gaussian case [2, 12].", "startOffset": 91, "endOffset": 98}, {"referenceID": 9, "context": "Until now such parametrizations have only been available in the multivariate Gaussian case [2, 12].", "startOffset": 91, "endOffset": 98}, {"referenceID": 0, "context": "These factorizations lead to a (variation dependent) parametrization in the binary case: if the variables are binary then p(X1 = 0), p(X2 = 0), p(X3 = 0|x1), p(X4 = 0|x2) and p(X3 = X4 = 0|x1, x2), with x1, x2 \u2208 {0, 1}, are sufficient to specify any multivariate binary distribution obeying the global Markov property for G1; see [1].", "startOffset": 330, "endOffset": 333}, {"referenceID": 8, "context": "It is possible to use the local directed Markov property for ADMGs in [11] (see \u00a74.", "startOffset": 70, "endOffset": 74}, {"referenceID": 6, "context": "dering (consistent with the directed edges), to obtain factorizations in terms of univariate densities, as proposed in [9].", "startOffset": 119, "endOffset": 122}, {"referenceID": 7, "context": "This generalizes and unifies three existing results for subclasses of ADMGs: First, the well-known factorization of an ancestrally closed set in a DAG D [10]:", "startOffset": 153, "endOffset": 157}, {"referenceID": 2, "context": "Second, the factorization associated with any set A in a bi-directed graph B [3]:", "startOffset": 77, "endOffset": 80}, {"referenceID": 0, "context": ") Third the factorization associated with a bi-directed chain graph such as G1; see [1].", "startOffset": 84, "endOffset": 87}, {"referenceID": 3, "context": "Note that if G is a DAG then the above definition is identical to Pearl\u2019s d-separation criterion; see [6, 10].", "startOffset": 102, "endOffset": 109}, {"referenceID": 7, "context": "Note that if G is a DAG then the above definition is identical to Pearl\u2019s d-separation criterion; see [6, 10].", "startOffset": 102, "endOffset": 109}, {"referenceID": 5, "context": "Following [8], we will refer to H as the head of the term p(XH | XT ), and T as the tail.", "startOffset": 10, "endOffset": 13}, {"referenceID": 4, "context": "Since in a DAG, for an arbitrary ancestral set A containing no children of x, mb(x,A) = pa(x), the ordered local Markov property given above reduces to the local well-numbering Markov property introduced by [7].", "startOffset": 207, "endOffset": 210}, {"referenceID": 8, "context": "In [11] it is shown that a probability measure obeys the global Markov property for an ADMG G if and only if it obeys the ordered local Markov property for G.", "startOffset": 3, "endOffset": 7}, {"referenceID": 8, "context": "Proof: It follows directly from Lemma 23, and the results in [11] that if a distribution factorizes according to (1) then it obeys the global Markov property for G.", "startOffset": 61, "endOffset": 65}], "year": 2009, "abstractText": "Acyclic directed mixed graphs, also known as semi-Markov models represent the conditional independence structure induced on an observed margin by a DAG model with latent variables. In this paper we present a factorization criterion for these models that is equivalent to the global Markov property given by (the natural extension of) dseparation.", "creator": "dvips(k) 5.96 Copyright 2005 Radical Eye Software"}}}