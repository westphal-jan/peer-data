{"id": "1409.4155", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "15-Sep-2014", "title": "Active Metric Learning from Relative Comparisons", "abstract": "This paper focuses on the active learning of distance metrics from relative comparison information. A relative comparison determines that $x _ i $for a data point triplet $(x _ i, x _ j, x _ k) $is more similar than $x _ j $for $x _ k $. Such constraints, if available, have proven useful in defining appropriate distance metrics. In the real world, acquiring restrictions often requires considerable human effort. This motivates us to examine how to select and question the most useful relative comparisons in order to achieve effective metric learning with minimal user effort. In view of an underlying class concept applied by the user to provide such constraints, we present an information theoretical criterion that selects the triplet, the response of which results in the highest expected gain in information about the classes of a set of examples. Direct application of the proposed criterion to provide such constraints requires a larger number of instances (O $) that can be used for the selection itself, with a larger number of instances (O ^ n).", "histories": [["v1", "Mon, 15 Sep 2014 04:37:46 GMT  (105kb,D)", "http://arxiv.org/abs/1409.4155v1", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["sicheng xiong", "r\\'omer rosales", "yuanli pei", "xiaoli z fern"], "accepted": false, "id": "1409.4155"}, "pdf": {"name": "1409.4155.pdf", "metadata": {"source": "CRF", "title": "Active Metric Learning from Relative Comparisons", "authors": ["Sicheng Xiong", "R\u00f3mer Rosales", "Yuanli Pei", "Xiaoli Z. Fern"], "emails": ["xfern}@eecs.oregonstate.edu", "rrosales@linkedin.com"], "sections": [{"heading": null, "text": "Categories and Subject Descriptors []; []\nGeneral Terms Keywords Active Learning, Relative Comparisons"}, {"heading": "1. INTRODUCTION", "text": "Distance metrics play an important role in many machine learning algorithms. As such, distance metric learning has been heavily studied as a central machine learning and data mining problem. One category of distance learning algorithms [12, 14, 18] uses userprovided side information to introduce constraints or hints that are approximately consistent with the underlying distance. In this regard, Xing et al. [18] used pairwise information specifying whether\nPermission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. To copy otherwise, to republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Copyright 20XX ACM X-XXXXX-XX-X/XX/XX ...$15.00.\ntwo data instances are similar or dissimilar. Alternatively, other studies such as [12, 14] consider constraints introduced by relative comparisons described by triplets (xi, xj , xk), specifying that instance or data point xi is more similar to instance xj than to instance xk.\nThis paper addresses active learning from relative comparisons for distance metric learning. We have chosen to focus on relative comparisons because we believe they are useful in a larger variety of contexts compared to pairwise constraints. Research in psychology has revealed that people are often inaccurate in making absolute judgments, but are much more reliable when judging comparatively [11]. Labeling a pair of instances as either similar or dissimilar is an absolute judgment that requires a global view of the instances, which can be difficult to achieve by inspecting only a few instances. In contrast, relative comparisons allow the user to judge comparatively, making it more reliable and at the same time less demanding on the user.\nWhile in some scenarios one can acquire relative comparisons automatically (e.g., using user click-through data in information retrieval tasks [14]), for many real applications, acquiring such comparisons requires manual inspection of the instances. This is very often time consuming and costly. For example, in one of our applications, we want to learn a distance metric that best categorizes different vocalizations of birds into their species. Providing a relative comparison constraint in this case will require the user to study the bird vocalizations either by visually inspecting their spectrograms or listening to the audio segments, which is very time consuming. This motivates us to study the active learning problem to optimize the selection of relative comparisons in order to achieve effective metric learning with minimum user effort. Existing studies have only considered randomly or sub-optimally selected triplets that are then provided to the metric learning algorithm. To the best of our knowledge, there has been no attempt to optimize the triplet selection for metric learning.\nIn this paper, we propose an information theoretic objective that selects a query whose answer will, in expectation, lead to the most information gain. While the proposed objective can be used with any metric learning algorithm that considers relative comparisons, a main obstacle is that we need to evaluate O(n3) triplets to select the optimizing query, where n is the number of instances. To reduce this complexity for selecting a triplet, we introduce a simple yet effective sampling procedure that is guaranteed to identify quasi-optimal triplets in O(n) with clear performance guarantees. Experimental results show that the triplets selected by the proposed active learning method allow for: 1) learning better metrics than those selected by two different baseline policies, and 2) increasing the classification accuracy of nearest neighbor classifiers.\nar X\niv :1\n40 9.\n41 55\nv1 [\ncs .L\nG ]\n1 5\nSe p\n20 14"}, {"heading": "2. RELATED WORK", "text": "Distance metric learning. Xing et al. proposed one of the first formal approaches for distance metric learning with side information [18]. In this study, they considered pairwise information indicating whether two instances are similar or dissimilar. A distance metric is learned by minimizing the distances between the instances in the similar pairs while keeping the distances between dissimilar pairs large.\nDistance metric learning with relative comparisons has also been studied in different contexts [12, 14]. Schultz et al. formulated a constrained optimization problem where the constraints are defined by relative comparisons and the objective is to learn a distance metric that remains as close to an un-weighted Euclidean metric as possible [14]. Rosales et al. [12] proposed to learn a projection matrix from relative comparisons. This approach also employed relative comparisons to create constraints on the solution space, but optimized a different objective to encourage sparsity of the learned projection matrix. Both studies assumed that the relative comparisons are given a priori and the constraints are a set of random or otherwise non-optimized set of pre-selected triplets. That is, the algorithm is not allowed to request comparisons outside of the given set.\nActive learning. There is a large body of literature on active learning for supervised classification [15]. One common strategy for selecting a data instance to label is uncertainty sampling [8] where the instance with the highest label uncertainty is selected to be labeled. In Query-bycommittee [16], multiple models (committee) are trained on different versions of the labeled data, and the unlabeled instance with the largest disagreement among the committee members is queried for labeling. The underlying motivation is to efficiently reduce the uncertainty of the model. A similar motivation is also used in this paper. Other representative techniques include selecting the instance that is closet to the decision boundary (min margin) [17], and selecting the instance that leads to the largest expected error reduction [13].\nActive learning has also been studied for semi-supervised clustering. In relation to our work, most previous approaches concentrate on active selection of pairwise constraints [1, 7, 10, 19]. While the goal in these approaches is semi-supervised learning (not distance metric learning), we partially share their motivation. In the context of distance metric learning, an active learning strategy was proposed in [20] whithin the larger context of a Bayesian metric learning formulation. This is the most closely related work as it addresses active learning. However, like all of the above formulations, it uses constraints of the form must-link and cannot-link, specifying that two instances must or must not fall into the same cluster respectively. As discussed previously, answering pairwise queries as either must-link or cannot-link constraints requires the user to make absolute judgements, making it less practical/more demanding for the user and also more prone to human error. In addition, none of the above formulations considers the effect of don\u2019t know answers (to a triplet relationship query) despite its importance in real, practical applications. These relevant factors motivated us to study active learning in the current setting. This is a problem that has not been studied previously."}, {"heading": "3. PROPOSED METHOD", "text": "The problem addressed in this paper is how to efficiently choose triplets to query in order to learn an appropriate metric, where\nefficiency is defined by query complexity. More specifically, the fewer queries/questions asked in order to achieve a specific performance the higher the efficiency. A query is defined as a request to a user/oracle to label a triplet. We view this as an iterative process, implying that the decision for query selection should depend on what has been learned from all previous queries."}, {"heading": "3.1 Problem Setup", "text": "Given data D = {x1, \u00b7 \u00b7 \u00b7 ,xn}, we assume that there is an underlying unknown class structure that assigns each instance to one of the C classes. We denote the unknown labels of the instances by y = {y1, \u00b7 \u00b7 \u00b7 , yn}, where each label yi \u2208 Y , {1, \u00b7 \u00b7 \u00b7 , C}. In the setting addressed, it is impossible to directly observe the class labels. Instead, the information about labels can only be obtained through relative comparison queries.\nA relative comparison query, denoted by triplet rijk = (xi,xj ,xk), can be interpreted as a question: \u201cIs xi more similar to xj than xk?\u201d. Given a query rijk, a oracle/user will return an answer, denoted by lijk \u2208 A , {yes, no, dk}, based on the classes to which the three instances belong. In particular, the oracle returns:\n\u2022 lijk = yes if yi = yj 6= yk, \u2022 lijk = no if yi 6= yj = yk, and \u2022 lijk = dk (do not know) for all other cases;\nwhere the answers are expected to be noisy (as usual class labels are not guaranteed correct). This oracle is consistent with that used in prior work [12, 14], except for one difference. Previous work only considered triplets that are provided a priori and have either yes or no labels (by construction). In the setting addressed in this paper, the queries are selected by an active learning algorithm and must consider the possibility that the user cannot provide a yes/no answer to some queries.\nWe consider a pool-based active learning setting where in each iteration we have access to a pool set of triplets to choose from is available. Let us denote the set of all labeled triplets by Rl = {(rijk, lijk) : lijk is observed}; likewise we denote the set of unlabeled triplets by Ru, which is also the pool set. In each active learning iteration, given inputs D and Rl, our active learning task is to optimally select one triplet rijk from Ru and query its label from the user/oracle."}, {"heading": "3.2 A Probabilistic Model for Query Answers", "text": "A key challenge faced in an active learning problem lies in measuring how much help (an answer to) a query provides. To answer this question, we model the relationship between data points, their class labels, and query answers in a probabilistic manner.\nWe denote the labels for all triplets that exist in D by l = {lijk} and let lijk be random variables. We explicitly include the instance\nclass labels y = {y1, \u00b7 \u00b7 \u00b7 , yn} in our probabilistic model and assume that the query answer is independent of the data points given their class labels. Formally, the conditional probability of the triplet labels and class labels is given by\np(l,y|D) = \u220f\n{ijk:lijk\u2208l}\np(lijk|yi, yj , yk) \u220f\nh\u2208{i,j,k}\np(yh|xh)\nThat is, query answer lijk indirectly depends on the data points through their unknown class labels yi, yj , and yk, and the class label of each data point only depends on the data point itself. This set of independence assumptions is depicted by the graphical model in Fig.1, where the circles represent continuous random variables and squares represent discrete random variables. In addition, shaded nodes denote observed variables and unshaded ones denote latent variables. For simplicity, the graphical model only shows the relationships for one set of three points (i, j, k). In total, there are O(n3) query-answer random variables and each label yi is the parent of O(n2) answer variables."}, {"heading": "3.3 Active Learning Criterion", "text": "In an active learning iteration, we seek to optimally select one triplet rijk from a pool of unlabeled triplets Ru and query its label from the oracle. Our goal is to efficiently reduce the model uncertainty. To this end, we consider a selection criterion that measures the information that a triplet\u2019s answer provides about the class labels of the three involved instances. More specifically, we employ the mutual information (MI) function [5]. In our scenario, we use it to measure the degree upon which an answer to a triplet query rijk reduces the uncertainty of the class labels yi, yj and yk. As a measure of statistical dependence, we use MI to determine the expected reduction in class uncertainty achievable when observing the label of a triplet. This choice is suited for applications whose goal is classification since it targets the reduction of class uncertainty.\nTo formally define the above criterion, let yijk = (yi, yj , yk) \u2208 Y3. The unlabeled triplet rijk \u2208 Ru is chosen so that it maximizes the mutual information between the label of triplet rijk (denoted by lijk) and the labels of three data points in rijk (denoted by yijk) given D and Rl (the labels of all previous queries).\nIn order to simplify the notation, we omit the termD in the probability expressions. It should be apparent from the context that the probabilities are conditioned on D. With this simplification, our objective is given by:\n(ijk)\u2217 = argmax rijk\u2208Ru I(yijk; lijk|Rl) (1)\n= argmax rijk\u2208Ru\nH(yijk|Rl)\u2212H(yijk|lijk, Rl)\n= argmax rijk\u2208Ru\nH(yijk|Rl)\n\u2212 \u2211 a\u2208A p(lijk = a|Rl)H(yijk|lijk = a,Rl)\n= argmax rijk\u2208Ru\n(1\u2212 p(lijk = dk|Rl))H(yijk|Rl)\n\u2212 \u2211\na\u2208{yes,no}\np(lijk = a|Rl)H(yijk|lijk = a,Rl)\nThe last step of the above derivation assumes that a dk (don\u2019t know) answer provides no information to the metric learning algorithm, i.e., H(yijk|lijk = dk, Rl) = H(yijk|Rl). This assumption is not required by the proposed approach, but it is employed to address the fact that dk answers are not considered by existing distance metric learning agolrithms. This modeling limitation in existing metric learning algorithms does not affect batch (non-active)\nlearning approaches. In information theoretic terms, this need not to be the case. Future metric learning algorithms may model this situation differently. However, the off-the-shelf metric learning algorithm we use in this paper does not explicitly model such situations1.\nEq. 1 selects the triplet with the highest return of information about the class membership of the involved instances. In particular, focusing on the first term of Eq. 1, we note that it will avoid selecting a triplet if it has a high probability of returning dk. Furthermore, it will also avoid selecting a triplet whose class uncertainty is low, which is consistent with a commonly used active learning heuristic that selects queries of high uncertainty. The second term in the equation helps with avoiding triplets whose yes or no answer provide little or no help in resolving the class uncertainty.\nTo compute Eq. 1, two terms need to be specified, H(yijk|Rl) and H(yijk|lijk = a,Rl) for a \u2208 {yes, no}. First, we apply our model independence assumption that labels are conditional independent from each other given the data points and the labeled triplets Rl and rewrite H(yijk|Rl) as:\nH(yijk|Rl) = \u2211\nh\u2208{i,j,k}\nH(yh|Rl)\n= \u2212 \u2211\nh\u2208{i,j,k} C\u2211 c=1 p(yh = c|Rl) log p(yh = c|Rl)\n(2) To compute H(yijk|lijk = a,Rl), a \u2208 {yes, no}, applying the\ndefinition of entropy and Bayes Theorem, it is easy to show that:\nH(yijk|lijk = a,Rl) = \u2212 \u2211\nyijk\u2208Y3 p(yijk|lijk = a,Rl) log p(yijk|lijk = a,Rl)\n= \u2212 \u2211\nyijk\u2208Y3\np(lijk = a|yijk)p(yijk|Rl) p(lijk = a|Rl)\n\u00d7 log p(lijk = a|yijk)p(yijk|Rl) p(lijk = a|Rl)\n(3)\nThere are three key terms in Eq 3. The first term p(lijk = a|yijk) is a deterministic distribution assigning probability one to whichever value lijk should take according to the oracle based on yijk. For example, if yi = yj 6= yk, we have p(lijk =yes|yijk) = 1. By the independence assumption, the second term p(yijk|Rl) can be factorized as\n\u220f h=i,j,k p(yh|Rl)\nThe last term is p(lijk = a|Rl). Note that p(yh|Rl) and p(lijk = a|Rl) are the only unspecified quantities for computing the objective in Eq. 1 and will need to be estimated from data. We will delay the discussion of how to estimate these probabilities until Section 3.5 so that we can complete the high level description of the algorithm. For now, we will assume there exists a method to estimate these probabilities and proceed to discuss how to use the proposed selection criterion."}, {"heading": "3.4 Scaling to Large Datasets", "text": "Based on the formulation thus far, at each iteration the active learning algorithm works by selecting a triplet from the set of all unlabeled triplets Ru that maximizes the above introduced objective Eq. 1. In the worst case, there are O(n3) triplets in Ru for a\n1This is largely an open research question beyond the scope of this paper.\nAlgorithm 1 Active Learning from Relative Comparisons Input: data D = {x1,x2, \u00b7 \u00b7 \u00b7 ,xn}, the limit of queries and the oracle; Output: a set of labeled triplets Rl;\n1: Initialize Rl = \u2205. Ru = the set of all triplets generated by D. 2: Generate the subset Rp \u2282 Ru by random sampling. 3: repeat 4: Use the steps in Section 3.5 to estimate p(yi|Rl) for i = 1, \u00b7 \u00b7 \u00b7 , n. 5: for every triplet rijk \u2208 Rp do 6: Compute p(lijk = a|Rl) for a =yes, no, dk using Eq. 5 7: Compute I(yijk; lijk|Rl) using Eq. 2, 3 8: end for 9: r\u2217ijk = argmaxrijk\u2208Rp I(yijk; lijk|Rl)\n10: Query the label of r\u2217ijk from the oracle. 11: Rl = Rl \u22c3 r\u2217ijk, Rp = Rp\\r\u2217ijk. 12: until the limit of queries has been reached\ndata set of n points. To reduce this complexity, we propose to construct a smaller pool set Rp by randomly sampling from Ru. We then select a triplet that maximizes the selection criterion from Rp. Therefore, our objective function becomes\n(ijk)\u2217 = argmax rijk\u2208Rp I(yijk; lijk|Rl) (4)\nAlthough the maximizing triplet in Rp might not be the optimal triplet in Ru, we argue that this will not necessarily degrade the active learning performance by much. Specifically, we expect significant redundancy among the unlabeled triplets. In most large datasets, a variety of triplets are near optimal and therefore, selecting a near-optimal triplet in Ru (by choosing the optimal triplet in Rp), instead of selecting the exact maximum, will not impact the performance significantly. The above comes with a caveat as this approach is effective only if we can guarantee with high probability to select a triplet that is near optimal. Specifically, we consider a query to be near-optimal if it is top-ranked in Ru according to the proposed selection criterion, where is a small number (e.g., = 0.01).\nIt is indeed possible for the above approximation approach to guarantee a good triplet selection with high probability. We characterized this by the following proposition.\nPROPOSITION 1. When selecting the best triplet r\u2217ijk from Rp according to Eq. 4, the probability that the selected r\u2217ijk is among the top ranked triplets ofRu is 1\u2212(1\u2212 )|Rp|, where |Rp| denotes the cardinality of Rp.\nThe proposition can be easily proved by observing that the probability of obtaining a triplet not in the top set is (1 \u2212 ), and we are repeating the selection/sampling procedure |Rp| times. Thus, 1\u2212 (1\u2212 )|Rp| gives us the probability of obtaining a near optimal query.\nIn this work, we set |Rp| to 100n, where n is the number of data points. This allows us to reduce the complexity fromO(n3) to O(n), and yet guarantee with high probability (greater than 99.99% even for a small n = 100) to select a triplet in the top 0.1% of all unlabeled triplets. We summarize the proposed active learning method in Algorithm 1."}, {"heading": "3.5 Probability Estimates and Implementation", "text": "Details\nThe above formulation requires estimating several probabilities. In particular, to evaluate the objective value achieved by a given triplet (i, j, k), we need to estimate p(yh = c|Rl) for h \u2208 {i, j, k} and c \u2208 {1, ..., C}, the probability of each of the three data points belongs to each of the possible classes, and p(lijk|Rl), the probability of different answers to the given triplet, as analyzed in section 3.3. We will describe how to estimate these probabilities in this section.\nFirst, we note that if we have p(yh = c|Rl) for h \u2208 {i, j, k} and c \u2208 {1, ..., C}, the probability of different query answers can be easily computed as follows:\np(lijk = yes|Rl) = C\u2211\nc=1\np(yi = c|Rl)p(yj = c|Rl) (5)\n\u00d7(1\u2212 p(yk = c|Rl))\np(lijk = no|Rl) = C\u2211\nc=1\np(yi = c|Rl)p(yk = c|Rl)\n\u00d7(1\u2212 p(yj = c|Rl))\np(lijk = dk|Rl) = 1\u2212 p(lijk = yes|Rl)\u2212 p(lijk = no|Rl)\nThe remaining question is how to estimate p(yh|Rl), h \u2208 {i, j, k} for triplet (xi,xj ,xk). Distance metric learning algorithms learn a distance metric that is expected to reflect the relationship among the data points in the triplets. While the learned metric does not directly provide us with a definition of the underlying classes, we could estimate the classes using the learned distances via a variety of methods. One such method is clustering. The principal motivation behind using clustering in this case is that the instances placed in the same cluster are very likely to come from the same class since the distance metric is learned based on relative comparisons generated from the class labels. We summarize this procedure as follows:\n\u2022 Learn a distance metric for D with labeled triplets Rl.\n\u2022 Use a clustering algorithm to partition the dataD intoC clusters based on the learned metric.\n\u2022 View the cluster assignments as a surrogate for the true class labels, and build a predictive model to estimate the class probability of each instance.\nWe remark that different methods can be used for this general procedure. In this paper, we use an existing metric learning algorithm by Schultz and Joachims [14] for the first step. For the clustering step, we choose to employ the k-means algorithm due to its simplicity. Finally, for the last step, we build a random forest of 50 decision trees to predict the cluster labels given the instances and estimate p(yh|Rl) for instance xh using all decision trees in the forest that are not directly trained on xh."}, {"heading": "3.6 Complexity Analysis", "text": "In this section we analyze the run-time of our proposed algorithm. Lines 1 and 2 of our algorithm performs the initialization and random sampling of the pool, which takes O(n) time if |Rp| is set to pn where p is a constant (in our experiment, we set p as 100). In line 3, we perform metric learning, apply k-means with the learned distance metric and build the random forest (RF) classifier to estimate the probabilities. The complexity of metric learning varies depending on which distance metric learning method is applied. In our experiments we use the method in [14], which casts\nmetric learning as a quadratic programming problem. This can be solved in polynomial time on the number of dimensions and linearly on n. Running the k-means method takes O(n) time assuming fixed number of iterations (we ignore other constant factors introduced by k and the feature dimension). Building the RF takes O(NTn logn), where NT is the number of decision trees in RF and n is the number of instances [2]. Lines 5 to 10 evaluate each unlabeled triplet in Rp and select the best one to query it, which takesO(n) time. Putting this together, the running time of our algorithm for selecting a single query is dominated by O(NTn logn), plus the running time of the metric learning method chosen. In our experiments, we use warm start in the metric learning process, which employs the learned metric from the previous iteration to initialize the metric learning in the current iteration. This significantly reduces the observed run-time for metric learning and makes it possible to select a query in real time."}, {"heading": "4. EXPERIMENTS", "text": "In this section we experimentally evaluate the proposed method, which we will refer to as Info. Below we first describe the experimental setup for our evaluation and then present and discuss the experimental results."}, {"heading": "4.1 Datasets", "text": "We evaluate our proposed method on seven benchmark datasets from the UCI Machine Learning repository [6] and one additional larger datatset. The benchmark datasets include Breast Tissue (referred to as Breast), Parksinons [9], Statlog image segmentation (referred to as Segment ), Soybean small, Waveform Database Generator (V.2) (referred to as Wave), Wine and Yeast. We also use an additional real-world dataset called HJA Birdsong. This dataset contains audio segments extracted from the spectrums of a collection of 10-second bird song recordings and uses the bird species as class labels[3]."}, {"heading": "4.2 Baselines and Experimental Setup", "text": "To the best of our knowledge, there is no existing active learning algorithm for relative comparisons. To investigate the effectiveness of our method, we compare it with several randomized baseline policies2:\n\u2022 Random: in each iteration, the learner randomly selects an unlabeled triplet to query.\n2We do not compare against active learning of pairwise constraints because the differences in query forms and the requirement of different metric learning algorithms prevents us from drawing direct comparisons.\n\u2022 Nonredundant: in each iteration, the learner selects the unlabeled triplet that has the least instance overlap with previously selected triplets. If multiple choices exist, randomly choose one.\nWe use the distance metric learning algorithm introduced by [14]. This algorithm formulates a constrained optimization problem where the constraints are defined by the triplets and aims at learning a distance metric that remains as close to an unweighted Euclidean metric as possible. We have also considered an alternative metric learning method introduced by [12] obtaining consistent results.\nGiven a triplet query (xi,xj ,xk), the oracle returns an answer based on the unknown class labels yi, yj , and yk. Since the datasets above provide class labels (but no triplet relationships), for these experiments we let the oracle return query answer yes if yi = yj 6= yk, and no if yi = yk 6= yj . In all other cases, the oracle returns dk. Both our method and the baseline policies may select triplets whose answer is dk. Such triplets cannot be utilized by the metric learning algorithm, but are counted as used queries since we are evaluating the active learning method (not the metric learning method as this is kept fixed across all the experiments).\nIn all the experiments, we randomly split the dataset D into two folds, one fold for training and the other for testing. We initialize the active learning process with two randomly chosen yes/no triplets (and the metric learning procedure with the identity matrix), and then iteratively select one query at a step, up to a total of 100 queries. All query selection methods are initialized with the same initial triplets. This process is repeated for 50 independent random runs and the reported results are averaged across the 50 runs."}, {"heading": "4.3 Evaluation Criteria", "text": "We evaluate the learned distance metric using two performance measures. The first is triplet accuracy, which evaluates how accurately the learned distance metric can predict the answer to an unlabeled yes/no triplet from the test data. This is a common criterion used in previous studies on metric learning with relative comparisons [12, 14]. To create the triplet testing set, we generate all triplets with yes/no labels from the test data for small datasets including Breast, Parkinson, Soybean, Wine. For larger datasets, we randomly sample 200K yes/no triplets from the test set to estimate the triplet accuracy.\nFor the second measure, we record the classification accuracy of a 1-nearest neighbor (1NN) classifier [4] on the test data based on the learned distance metric. The purpose of this measurement is to examine how much the learned distance metric can improve the classification accuracy."}, {"heading": "4.4 Results", "text": "Fig. 2 plots the triplet accuracy obtained by our method (denoted by Info) and the baseline methods as a function of the number of queries ranging from 0 to 100. The results are averaged over 50 random runs. Table 2 shows the 1NN classification accuracy, with 10, 20, 40, 60, 80, and 100 queries, respectively. We also list the 1NN accuracy without any queries as the initial performance. For each case, the best result(s) is/are highlighted in boldface based on paired t-tests at p = 0.05. The win/tie/loss result (from Table 2) for Info against each method separately is summarized in Table 3.\nFirst, we observe that Random and Nonredundant have a decent performance in most datasets and the two baselines do not differ significantly. These results are consistent with what has been reported in previous metric-learning studies where the learned metric tends to improve as we include more and more randomly selected yes/no triplets. For the two large datasets, Wave and HJA Birdsong, Random and Nonredundant do not perform well. A possible\nexplanation for this is the large number of data points, which may require more triplets to learn a good metric.\nWe can also see that Info consistently outperforms Random and Nonredundant. In particular, we see that for some datasets (e.g.,\nSegment, Wave, Yeast and HJA Birdsong), Info was able to achieve better triplet accuracy than the two random baselines. For some other datasets (e.g., Soybean and Wine), Info achieved the same level of performance but with significantly fewer queries than the\ntwo baseline methods. Also for these datasets, the variance of Info is generally smaller (as indicated by its smaller confidence intervals). For the Breast and Parkinson datasets, the performance of Info does not significantly outperform the two baseline methods, but generally tends to produce smoother curves where the baseline methods appear inconsistent as we increase the number of queries. Overall the results suggest that the triplets selected by Info are more informative than those selected randomly.\nSimilar behavior can also be observed from Table 2 where the distance metric is evaluated using 1NN classification accuracy. In particular, we observe that Info often improves the performance over Random, and only suffers one loss to Nonredundant when the query number is small in the Segment dataset."}, {"heading": "4.5 Further Investigation", "text": "Below we examine various important factors that contribute to the success of Info. Recall that all methods could produce queries of triplets labeled as dk (don\u2019t know), yet the distance metric learning algorithm can only learn from yes/no triplets. Info explicitly considers this effect by settingH(yijk|lijk = dk,Rl) = H(yijk|Rl). Thus we expect Info to avoid queries that are likely to return a dk answer, which could be an important factor contributing to its winning over the baselines. We test this hypothesis by recording the percentage of selected triplets with yes/no answers in 100 queries averaged by 50 runs, which are reported in the last column of Table 2. From the results we observe that the percentages vary significantly from one dataset to another. But Info typically achieves a much higher percentage compared to the two baselines, which confirms our hypothesis.\nBesides the first factor that Info can select more triplets of yes/no answers, we would like to ask if the yes/no triplets selected by Info are more informative than those selected by the random baselines. To answer this question, we examine the 1NN classification accuracies achieved by each method as a function of the number of yes/no triplets. This will allow us to examine the usefulness of the final constraints obtained by each method. We vary the number of yes/no triplets from 5 to 20 with an increment of 5 and then record the results of 50 independent random runs. The averaged 1NN classification accuracy results are reported in Table 4. We can observe that Info still leads to better performance than the baselines, suggesting that the triplets selected by Info are indeed more informative toward learning a good metric.\nFinally, we want to examine the impact of the sampling approach described in Sec. 3.4 on our algorithm. To this end, we run our pro-\nposed algorithm without random sampling on three small datasets Breast, Soybean and Wine. Fig. 3 presents the performance of our exact algorithm (Info Exact) and with sampling (Info). It can be observed that sampling has some minor impact on the Breast and Soybean datasets, and no impact on the Wine dataset. This suggests that the probabilistic guarantees of the random sampling method are indeed sufficient in practice to avoid significant performance loss compared to the exact active learning version.\nTo summarize, the empirical results demonstrate that Info can consistently outperform the random baselines. In particular, we demonstrate that it has two advantages. First, it allows us to effectively avoid querying dk triplets, resulting in more yes/no triplets to be used by the metric learning algorithm. Second, empirical results suggest that the yes/no triplets selected by our method are generally more informative than those selected by the random baselines. Finally, the results suggest that while sampling approximation may negatively impact the performance in some cases, the impact is very mild, both in theory and practice, and the resulting algorithm still consistently outperforms the random baselines."}, {"heading": "5. CONCLUSION", "text": "This paper studied active distance metric learning from relative comparisons. In particular, it considered queries of the form: is instance i more similar to instance j than to k?. The approach utilized the existence of an underlying (but unknown) class structure. This class structure is implicitly employed by the user/oracle to answer such queries. In formulating active learning in this setting, we found of interest that some query answers cannot be utilized by existing metric learning algorithms: the answer don\u2019t know does not provide any useful constraint for these. The presented approach addressed this in a natural, sound manner. We proposed an information theoretic objective that explicitly measures how much information about the class labels can be obtained from the answer to a query. In addition, to reduce the complexity of selecting a query, we showed that a simple sampling scheme can provide excellent performance guarantees. Experimental results demonstrated that the triplets selected by the proposed method not only contributed to learning better distance metrics than those selected by the baselines, but helped improve the resulting classification accuracy."}, {"heading": "6. REFERENCES", "text": "[1] S. Basu, A. Banerjee, and R. Mooney. Active\nsemi-supervision for pairwise constrained clustering. In\nProceedings of the SIAM International Conference on Data mining, pages 333\u2013344, 2004.\n[2] L. Breiman. Random forests. Machine learning, 45(1):5\u201332, 2001.\n[3] F. Briggs, X. Z. Fern, and R. Raich. Rank-loss support instance machines for miml instance annotation. In Proceedings of the 18th ACM SIGKDD international conference on Knowledge discovery and data mining, KDD \u201912, pages 534\u2013542, New York, NY, USA, 2012. ACM.\n[4] T. Cover and P. Hart. Nearest neighbor pattern classification. IEEE Transactions on Information theory, 13(1):21\u201327, 1967.\n[5] T. Cover and J. Thomas. Elements of Information Theory. Wiley, 1991.\n[6] A. Frank and A. Asuncion. UCI machine learning repository, 2010.\n[7] D. Greene and P. Cunningham. Constraint selection by committee: An ensemble approach to identifying informative constraints for semi-supervised clustering. pages 140\u2013151, 2007.\n[8] D. Lewis and W. Gale. A sequential algorithm for training text classifiers. In Proceedings of ACM SIGIR International Conference on Research and development in information retrieval, pages 3\u201312, 1994.\n[9] M. Little, P. McSharry, S. Roberts, D. Costello, and I. Moroz. Exploiting nonlinear recurrence and fractal scaling properties for voice disorder detection. BioMedical Engineering OnLine, 6(1):23, 2007.\n[10] P. Mallapragada, R. Jin, and A. Jain. Active query selection for semi-supervised clustering. In Proceedings of International Conference on Pattern Recognition, pages 1\u20134, 2008.\n[11] J. Nunnally and I. Bernstein. Psychometric Theory. McGraw Hill, Inc., 1994.\n[12] R. Rosales and G. Fung. Learning sparse metrics via linear programming. In Proceedings of ACM SIGKDD International Conference on Knowledge discovery and data mining, pages 367\u2013373, 2006.\n[13] N. Roy and A. Mccallum. Toward optimal active learning through sampling estimation of error reduction. In Proceedings of International Conference on Machine Learning, 2001.\n[14] M. Schultz and T. Joachims. Learning a distance metric from relative comparisons. In Advances in neural information processing systems, 2003.\n[15] B. Settles. Active learning literature survey. 2010. [16] H. Seung, M. Opper, and H. Sompolinsky. Query by\ncommittee. In Proceedings of the annual workshop on Computational learning theory, pages 287\u2013294, 1992.\n[17] S. Tong and D. Koller. Support vector machine active learning with applications to text classification. The Journal of Machine Learning Research, 2:45\u201366, 2002.\n[18] E. Xing, A. Ng, M. Jordan, and S. Russell. Distance metric learning with application to clustering with side-information. In Advances in neural information processing systems, pages 521\u2013528, 2003.\n[19] Q. Xu, M. Desjardins, and K. Wagstaff. Active constrained clustering by examining spectral eigenvectors. In Discovery Science, pages 294\u2013307, 2005.\n[20] L. Yang, R. Jin, and R. Sukthankar. Bayesian active distance metric learning. Uncertainty in Artificial Intelligence, 2007."}], "references": [{"title": "Active semi-supervision for pairwise constrained clustering", "author": ["S. Basu", "A. Banerjee", "R. Mooney"], "venue": " Proceedings of the SIAM International Conference on Data mining, pages 333\u2013344", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2004}, {"title": "Random forests", "author": ["L. Breiman"], "venue": "Machine learning, 45(1):5\u201332", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2001}, {"title": "Rank-loss support instance machines for miml instance annotation", "author": ["F. Briggs", "X.Z. Fern", "R. Raich"], "venue": "Proceedings of the 18th ACM SIGKDD international conference on Knowledge discovery and data mining, KDD \u201912, pages 534\u2013542, New York, NY, USA", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2012}, {"title": "Nearest neighbor pattern classification", "author": ["T. Cover", "P. Hart"], "venue": "IEEE Transactions on Information theory, 13(1):21\u201327", "citeRegEx": "4", "shortCiteRegEx": null, "year": 1967}, {"title": "Elements of Information Theory", "author": ["T. Cover", "J. Thomas"], "venue": "Wiley", "citeRegEx": "5", "shortCiteRegEx": null, "year": 1991}, {"title": "Constraint selection by committee: An ensemble approach to identifying informative constraints for semi-supervised clustering", "author": ["D. Greene", "P. Cunningham"], "venue": "pages 140\u2013151", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2007}, {"title": "A sequential algorithm for training text classifiers", "author": ["D. Lewis", "W. Gale"], "venue": "Proceedings of ACM SIGIR International Conference on Research and development in information retrieval, pages 3\u201312", "citeRegEx": "8", "shortCiteRegEx": null, "year": 1994}, {"title": "Exploiting nonlinear recurrence and fractal scaling properties for voice disorder detection", "author": ["M. Little", "P. McSharry", "S. Roberts", "D. Costello", "I. Moroz"], "venue": "BioMedical Engineering OnLine, 6(1):23", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2007}, {"title": "Active query selection for semi-supervised clustering", "author": ["P. Mallapragada", "R. Jin", "A. Jain"], "venue": "Proceedings of International Conference on Pattern Recognition, pages 1\u20134", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2008}, {"title": "Psychometric Theory", "author": ["J. Nunnally", "I. Bernstein"], "venue": "McGraw Hill, Inc.", "citeRegEx": "11", "shortCiteRegEx": null, "year": 1994}, {"title": "Learning sparse metrics via linear programming", "author": ["R. Rosales", "G. Fung"], "venue": "Proceedings of ACM SIGKDD International Conference on Knowledge discovery and data mining, pages 367\u2013373", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2006}, {"title": "Toward optimal active learning through sampling estimation of error reduction", "author": ["N. Roy", "A. Mccallum"], "venue": "Proceedings of International Conference on Machine Learning", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2001}, {"title": "Learning a distance metric from relative comparisons", "author": ["M. Schultz", "T. Joachims"], "venue": "Advances in neural information processing systems", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2003}, {"title": "Active learning literature survey", "author": ["B. Settles"], "venue": null, "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2010}, {"title": "Query by committee", "author": ["H. Seung", "M. Opper", "H. Sompolinsky"], "venue": "Proceedings of the annual workshop on Computational learning theory, pages 287\u2013294", "citeRegEx": "16", "shortCiteRegEx": null, "year": 1992}, {"title": "Support vector machine active learning with applications to text classification", "author": ["S. Tong", "D. Koller"], "venue": "The Journal of Machine Learning Research, 2:45\u201366", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2002}, {"title": "Distance metric learning with application to clustering with side-information", "author": ["E. Xing", "A. Ng", "M. Jordan", "S. Russell"], "venue": "Advances in neural information processing systems, pages 521\u2013528", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2003}, {"title": "Active constrained clustering by examining spectral eigenvectors", "author": ["Q. Xu", "M. Desjardins", "K. Wagstaff"], "venue": "Discovery Science, pages 294\u2013307", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2005}, {"title": "Bayesian active distance metric learning", "author": ["L. Yang", "R. Jin", "R. Sukthankar"], "venue": "Uncertainty in Artificial Intelligence", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2007}], "referenceMentions": [{"referenceID": 10, "context": "One category of distance learning algorithms [12, 14, 18] uses userprovided side information to introduce constraints or hints that are approximately consistent with the underlying distance.", "startOffset": 45, "endOffset": 57}, {"referenceID": 12, "context": "One category of distance learning algorithms [12, 14, 18] uses userprovided side information to introduce constraints or hints that are approximately consistent with the underlying distance.", "startOffset": 45, "endOffset": 57}, {"referenceID": 16, "context": "One category of distance learning algorithms [12, 14, 18] uses userprovided side information to introduce constraints or hints that are approximately consistent with the underlying distance.", "startOffset": 45, "endOffset": 57}, {"referenceID": 16, "context": "[18] used pairwise information specifying whether", "startOffset": 0, "endOffset": 4}, {"referenceID": 10, "context": "Alternatively, other studies such as [12, 14] consider constraints introduced by relative comparisons described by triplets (xi, xj , xk), specifying that instance or data point xi is more similar to instance xj than to instance xk.", "startOffset": 37, "endOffset": 45}, {"referenceID": 12, "context": "Alternatively, other studies such as [12, 14] consider constraints introduced by relative comparisons described by triplets (xi, xj , xk), specifying that instance or data point xi is more similar to instance xj than to instance xk.", "startOffset": 37, "endOffset": 45}, {"referenceID": 9, "context": "Research in psychology has revealed that people are often inaccurate in making absolute judgments, but are much more reliable when judging comparatively [11].", "startOffset": 153, "endOffset": 157}, {"referenceID": 12, "context": ", using user click-through data in information retrieval tasks [14]), for many real applications, acquiring such comparisons requires manual inspection of the instances.", "startOffset": 63, "endOffset": 67}, {"referenceID": 16, "context": "proposed one of the first formal approaches for distance metric learning with side information [18].", "startOffset": 95, "endOffset": 99}, {"referenceID": 10, "context": "Distance metric learning with relative comparisons has also been studied in different contexts [12, 14].", "startOffset": 95, "endOffset": 103}, {"referenceID": 12, "context": "Distance metric learning with relative comparisons has also been studied in different contexts [12, 14].", "startOffset": 95, "endOffset": 103}, {"referenceID": 12, "context": "formulated a constrained optimization problem where the constraints are defined by relative comparisons and the objective is to learn a distance metric that remains as close to an un-weighted Euclidean metric as possible [14].", "startOffset": 221, "endOffset": 225}, {"referenceID": 10, "context": "[12] proposed to learn a projection matrix from relative comparisons.", "startOffset": 0, "endOffset": 4}, {"referenceID": 13, "context": "There is a large body of literature on active learning for supervised classification [15].", "startOffset": 85, "endOffset": 89}, {"referenceID": 6, "context": "One common strategy for selecting a data instance to label is uncertainty sampling [8] where the instance with the highest label uncertainty is selected to be labeled.", "startOffset": 83, "endOffset": 86}, {"referenceID": 14, "context": "In Query-bycommittee [16], multiple models (committee) are trained on different versions of the labeled data, and the unlabeled instance with the largest disagreement among the committee members is queried for labeling.", "startOffset": 21, "endOffset": 25}, {"referenceID": 15, "context": "Other representative techniques include selecting the instance that is closet to the decision boundary (min margin) [17], and selecting the instance that leads to the largest expected error reduction [13].", "startOffset": 116, "endOffset": 120}, {"referenceID": 11, "context": "Other representative techniques include selecting the instance that is closet to the decision boundary (min margin) [17], and selecting the instance that leads to the largest expected error reduction [13].", "startOffset": 200, "endOffset": 204}, {"referenceID": 0, "context": "In relation to our work, most previous approaches concentrate on active selection of pairwise constraints [1, 7, 10, 19].", "startOffset": 106, "endOffset": 120}, {"referenceID": 5, "context": "In relation to our work, most previous approaches concentrate on active selection of pairwise constraints [1, 7, 10, 19].", "startOffset": 106, "endOffset": 120}, {"referenceID": 8, "context": "In relation to our work, most previous approaches concentrate on active selection of pairwise constraints [1, 7, 10, 19].", "startOffset": 106, "endOffset": 120}, {"referenceID": 17, "context": "In relation to our work, most previous approaches concentrate on active selection of pairwise constraints [1, 7, 10, 19].", "startOffset": 106, "endOffset": 120}, {"referenceID": 18, "context": "In the context of distance metric learning, an active learning strategy was proposed in [20] whithin the larger context of a Bayesian metric learning formulation.", "startOffset": 88, "endOffset": 92}, {"referenceID": 10, "context": "This oracle is consistent with that used in prior work [12, 14], except for one difference.", "startOffset": 55, "endOffset": 63}, {"referenceID": 12, "context": "This oracle is consistent with that used in prior work [12, 14], except for one difference.", "startOffset": 55, "endOffset": 63}, {"referenceID": 4, "context": "More specifically, we employ the mutual information (MI) function [5].", "startOffset": 66, "endOffset": 69}, {"referenceID": 12, "context": "In this paper, we use an existing metric learning algorithm by Schultz and Joachims [14] for the first step.", "startOffset": 84, "endOffset": 88}, {"referenceID": 12, "context": "In our experiments we use the method in [14], which casts", "startOffset": 40, "endOffset": 44}, {"referenceID": 1, "context": "Building the RF takes O(NTn logn), where NT is the number of decision trees in RF and n is the number of instances [2].", "startOffset": 115, "endOffset": 118}, {"referenceID": 7, "context": "The benchmark datasets include Breast Tissue (referred to as Breast), Parksinons [9], Statlog image segmentation (referred to as Segment ), Soybean small, Waveform Database Generator (V.", "startOffset": 81, "endOffset": 84}, {"referenceID": 2, "context": "This dataset contains audio segments extracted from the spectrums of a collection of 10-second bird song recordings and uses the bird species as class labels[3].", "startOffset": 157, "endOffset": 160}, {"referenceID": 12, "context": "We use the distance metric learning algorithm introduced by [14].", "startOffset": 60, "endOffset": 64}, {"referenceID": 10, "context": "We have also considered an alternative metric learning method introduced by [12] obtaining consistent results.", "startOffset": 76, "endOffset": 80}, {"referenceID": 10, "context": "This is a common criterion used in previous studies on metric learning with relative comparisons [12, 14].", "startOffset": 97, "endOffset": 105}, {"referenceID": 12, "context": "This is a common criterion used in previous studies on metric learning with relative comparisons [12, 14].", "startOffset": 97, "endOffset": 105}, {"referenceID": 3, "context": "For the second measure, we record the classification accuracy of a 1-nearest neighbor (1NN) classifier [4] on the test data based on the learned distance metric.", "startOffset": 103, "endOffset": 106}], "year": 2014, "abstractText": "This work focuses on active learning of distance metrics from relative comparison information. A relative comparison specifies, for a data point triplet (xi, xj , xk), that instance xi is more similar to xj than to xk. Such constraints, when available, have been shown to be useful toward defining appropriate distance metrics. In real-world applications, acquiring constraints often require considerable human effort. This motivates us to study how to select and query the most useful relative comparisons to achieve effective metric learning with minimum user effort. Given an underlying class concept that is employed by the user to provide such constraints, we present an information-theoretic criterion that selects the triplet whose answer leads to the highest expected gain in information about the classes of a set of examples. Directly applying the proposed criterion requires examining O(n) triplets with n instances, which is prohibitive even for datasets of moderate size. We show that a randomized selection strategy can be used to reduce the selection pool from O(n) to O(n), allowing us to scale up to larger-size problems. Experiments show that the proposed method consistently outperforms two baseline policies.", "creator": "LaTeX with hyperref package"}}}