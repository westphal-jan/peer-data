{"id": "1506.09039", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "30-Jun-2015", "title": "Scalable Discrete Sampling as a Multi-Armed Bandit Problem", "abstract": "Taking a sample from a discrete distribution is one of the components of Monte Carlo methods. Like other discrete sampling algorithms, discrete sampling suffers from high computational effort in large-scale sampling problems. We investigate the problem of sampling a discrete random variable with a high degree of dependence, as is typical of large-scale Bayesian inferences and graphical models, and propose an efficient approximate solution using a subsample approach. We establish a novel link between discrete sampling problems and multi-armed bandits problems with a finite reward population, and provide three algorithms with theoretical guarantees. Empirical evaluations show the robustness and efficiency of approximate algorithms for both synthetic and real-scale problems.", "histories": [["v1", "Tue, 30 Jun 2015 11:20:45 GMT  (300kb,D)", "https://arxiv.org/abs/1506.09039v1", null], ["v2", "Tue, 9 Feb 2016 14:21:05 GMT  (303kb,D)", "http://arxiv.org/abs/1506.09039v2", null], ["v3", "Wed, 27 Apr 2016 21:09:43 GMT  (320kb,D)", "http://arxiv.org/abs/1506.09039v3", null]], "reviews": [], "SUBJECTS": "stat.ML cs.LG", "authors": ["yutian chen", "zoubin ghahramani"], "accepted": true, "id": "1506.09039"}, "pdf": {"name": "1506.09039.pdf", "metadata": {"source": "META", "title": "Scalable Discrete Sampling as a Multi-Armed Bandit Problem", "authors": ["Yutian Chen", "Zoubin Ghahramani"], "emails": ["YUTIAN.CHEN@ENG.CAM.AC.UK", "ZOUBIN@ENG.CAM.AC.UK"], "sections": [{"heading": "1. Introduction", "text": "Sampling a random variable from a discrete (conditional) distribution is one of the core operations in Monte Carlo methods. It is an ubiquitous and often necessary component for inference algorithms such as Gibbs sampling and particle filtering. Applying discrete sampling for largescale problems has been a challenging task like other Monte Carlo algorithms due to the high computational burden. Various approaches have been proposed to address different dimensions of \u201clarge scales\u201d. For example, distributed algorithms have been used to sample a model with a large number of discrete variables (Newman et al., 2009; Bratires et al., 2010; Wu et al., 2011), smart transition kernels were described for Markov chain Monte Carlo (MCMC) algorithms to sample efficiently a single variable\nProceedings of the 33 rd International Conference on Machine Learning, New York, NY, USA, 2016. JMLR: W&CP volume 48. Copyright 2016 by the author(s).\nwith a large or even infinite state space (Li et al., 2014; Kalli et al., 2011). This paper is focused on another dimension of the \u201clarge-scales\u201d where the variable to sample has a large degree of statistical dependency.\nConsider a random variable with a finite domain X \u2208 X and a distribution in the following form p(X = x) \u221d p\u0303(X = x), with p\u0303(X = x) = f0(x) N\u220f n=1 fn(x),\n(1)\nwhere fn can be any function of x. Such distribution occurs frequently in machine learning problems. For example, in Bayesian inference for a model with parameter X and N i.i.d. observations D = {yn}Nn=1, the posterior distribution of X depends on all the observations when sufficient statistics is not available. The unnormalized posterior distribution can be written as p\u0303(X|D) = p(X) \u220fN i=1 p(yi|X). In undirected graphical model inference problems where a node Xi appears in N potential functions, the distribution of Xi depends on the value of all of the N functions. The unnormalized conditional distribution is p\u0303(Xi|x\u2212i) =\u220fN n=1 \u03c6n(Xi,x\u2212i), where x\u2212i denotes the value of all the other nodes in the graph and \u03c6n denotes a potential function that includes Xi in the scope. In this paper we study how to sample a discrete random variable X in a manner that is scalable in N .\nA common approach to address the big data problem is divide-and-conquer that uses parallel or distributed computing resources to process data in parallel and then synchronize the results periodically or merely once in the end (Scott et al., 2013; Medlar et al., 2013; Xu et al., 2014).\nAn orthogonal approach has been studied for the Metropolis-Hastings (MH) algorithm in a general state space by running a sampler with subsampled data. This approach can be combined easily with the distributed computing idea for even better scalability (e.g. Ahn et al., 2015).\nMaclaurin & Adams (2015) introduced an MH algorithm\nar X\niv :1\n50 6.\n09 03\n9v 3\n[ st\nat .M\nL ]\n2 7\nA pr\n2 01\nin an augmented state space that could achieve higher efficiency than the standard MH by processing only a subset of active data every iteration while still preserving the correct stationary distribution. But the introduction of auxiliary variables might also slow down the overall mixing rate in the augmented space.\nApproximate MH algorithms have been proposed in the subsampling approach with high scalability. The stochastic gradient Langevin dynamics (SGLD) (Welling & Teh, 2011) and its extensions (Ahn et al., 2012; Chen et al., 2014; Ding et al., 2014) introduced efficient proposal distributions based on subsampled data. Approximate algorithms induce bias in the stationary distribution of the Markov chain. But given a fixed amount of runtime they could reduce the expected error in the Monte Carlo estimate via a proper trade-off between variance and bias by mixing faster w.r.t. the runtime. This is particularly important for large-scale learning problems when the runtime is one of the limiting factors for generalization performance (Bottou & Bousquet, 2008). However, the stochastic gradient MCMC approach usually skips the rejection step in order to obtain sublinear time complexity and the induced bias is very hard to estimate or control.\nAnother line of research on approximate subsampled MH algorithms does not ignore the rejection step but controls the error with an approximate rejection step based on a subset of data (Korattikara et al., 2014; Bardenet et al., 2014). The bias can thus be better controlled (Mitrophanov, 2005; Pillai & Smith, 2014). That idea has also been extended to slice sampling (DuBois et al., 2014) and Gibbs for binary variables (Korattikara et al., 2014).\nIn this paper we follow the last line of research and propose a novel approximate sampling algorithm to improve the scalability of sampling discrete distributions. We first reformulate the problem in Eq. 1 as a Multi-Armed Bandit (MAB) problem with a finite reward population via the Gumbel-Max trick (Papandreou & Yuille, 2011), and then propose three algorithms with theoretical guarantees on the approximation error and an upper bound of N |X | on the sample size. This is to our knowledge the first attempt to address discrete sampling problem with a large number of dependencies and our work will likely contribute to a more complete library of scalable MCMC algorithms. Moreover, the racing algorithm in Sec. 3.3 provides a unified framework for subsampling-based discrete sampling, MH (Korattikara et al., 2014; Bardenet et al., 2014) and slice sampling (DuBois et al., 2014) algorithms as discussed in Sec. 4. We also show in the experiments that our algorithm can be combined straightforwardly with stochastic gradient MCMC to achieve both high efficiency and controlled bias. Lastly, the proposed algorithms also deserve their own interest for MAB problems under this particular setting.\nWe first review an alternative way of drawing discrete variables and build a connection with MABs in Sec. 2, then propose three algorithms in Sec. 3. We discuss related work in Sec. 4 and evaluate the proposed algorithms on both synthetic data and real-world problems of Bayesian inference and graphical model inference in Sec. 5. Particularly, we show how our proposed sampler can be combined conveniently as a building component with other subsampling sampler for a hierarchical Bayesian model. Sec. 6 concludes the paper with a discussion."}, {"heading": "2. Approximate Discrete Sampling", "text": ""}, {"heading": "2.1. Discrete Sampling as an Optimization Problem", "text": "The common procedure to sample X from a discrete domain X = {1, 2, . . . , D} is to first normalize p\u0303(X) and compute the CDF F (X = x) = \u2211x i=1 p(X = i). Then draw a uniform random variable u \u223c Uniform(0, 1], and find x that satisfies F (x \u2212 1) < u \u2264 F (x). This procedure requires computing the sum of all the unnormalized probabilities. For p\u0303 in the form of Eq. 1 this is O(ND).\nAn alternative procedure is to first draw D i.i.d. samples from the standard Gumbel distribution1 \u03b5i \u223c Gumbel(0, 1), and then solve the following optimization problem:\nx = argmax i\u2208X log p\u0303(i) + \u03b5i. (2)\nIt is shown in Kuzmin & Warmuth (2005) that x follows the distribution p(X). With this method after drawing random variables that do not depend on p\u0303, we turn a random sampling problem to an optimization problem. While the computational complexity is the same to draw an exact sample, an approximate algorithm may potentially save computations by avoiding computing accurate values of p\u0303(X = x) when x is considered unlikely to be the maximum as discussed next."}, {"heading": "2.2. Approximate Discrete Sampling as a Multi-Armed Bandits Problem", "text": "In a Multi-Armed Bandit (MAB) problem, the i\u2019th bandit is a slot machine with an arm, which when pulled generates an i.i.d. reward li from a distribution associated with that arm with an unknown mean \u00b5i. The optimal arm identification problem for MABs (Bechhofer, 1958; Paulson, 1964) in the fixed confidence setting is to find the arm with the highest mean reward with a confidence 1 \u2212 \u03b4 using as few pulls as possible.\nUnder the assumption of Eq. 1, the solution in Eq. 2 can be\n1The Gumbel distribution is used to model the maximum extreme value distribution. If a random variable Z \u223c Exp(1), then \u2212 log(Z) \u223c Gumbel(0, 1). \u03b5 can be easily drawn as \u2212 log(\u2212 log(u)) with u \u223c U[0, 1].\nexpressed as\nx = argmax i\u2208X N\u2211 n=1 log fn(i) + log f0(i) + \u03b5i\n= argmax i\u2208X N\u2211 n=1 ( log fn(i) + 1 N (log f0(i) + \u03b5i) ) \ufe38 \ufe37\ufe37 \ufe38\ndef =li,n\n= argmax i\u2208X\n1\nN N\u2211 n=1 li,n = argmax i\u2208X Eli\u223cUniform(Li)[li]\ndef = argmax\ni\u2208X \u00b5i (3)\nwhereLi def = {li,1, li,2, . . . , li,N}. After drawingD Gumbel variables \u03b5i, we turn the discrete sampling problem into the optimal arm identification problem in MABs where the reward li is uniformly sampled from a finite population Li. An approximate algorithm that solves the problem with a fixed confidence may avoid drawing all the rewards from an obviously sub-optimal arm and save computations. We show the induced bias in the sample distribution as follows with the proof in Appx. A.1.\nProposition 1. If an algorithm solves (2) exactly with a probability at least 1\u2212 \u03b4 for any value of \u03b5, the total variation between the sample distribution p\u0302 and the true distribution is bounded by\n\u2016p\u0302(X)\u2212 p(X)\u2016TV \u2264 \u03b4 (4)\nWhen applied in the MCMC framework as a transition kernel, we can apply immediately the theories in Mitrophanov (2005); Pillai & Smith (2014) to show that the approximate Markov chain satisfies uniform ergodicity under regular conditions and the analysis of convergence rate are readily available under various assumptions. So the discrete sampling problem of this paper reduces to finding a good MAB algorithm for Eq. 2 in our problem setting."}, {"heading": "3. Algorithms for MABs with a Finite Population and Fixed Confidence", "text": "The key difference of our problem from the regular MABs is that our rewards are generated from a finite population while regular MABs assume i.i.d. rewards. Because one can obtain the exact mean by sampling all the N values li,n for arm i without replacement, a good algorithm should pull no more than N times for each arm regardless of the mean gap between arms. We introduce three algorithms in this section whose sample complexity is upper bounded by O(ND) in the worst case and can be very efficient when the mean gap is large."}, {"heading": "3.1. Notations", "text": "The iteration of an algorithm is indexed by t. We denote the entire index set with [N ] = {1, 2, . . . , N}, the sampled set of reward indices up to t\u2019th iteration from arm i with N (t)i \u2286 [N ], and the corresponding number of sampled rewards with T (t)i . We define the estimated mean for i\u2019th arm with \u00b5\u0302(t)i def = 1 |N (t)i | \u2211 n\u2208N (t)i li,n, the natural variance (biased) estimate with (\u03c3\u0302(t)i ) 2 def= 1\n|N (t)i | \u2211 n\u2208N (t)i (li,n \u2212\n\u00b5\u0302 (t) i ) 2, the variance estimate of the mean gap between two arm with (\u03c3\u0302(t)i,j ) 2 def= 1\n|N (t)i | \u2211 n\u2208N (t)i ((li,n\u2212 lj,n)\u2212 (\u00b5\u0302(t)i \u2212\n\u00b5\u0302 (t) j )) 2 (defined only whenN (t)i = N (t) j ), the bound of the reward value Ci def = maxn,n\u2032{li,n \u2212 li,n\u2032}. The subscripts and superscripts may be dropped for notational simplicity when the meaning is clear from the context."}, {"heading": "3.2. Adapted lil\u2019UCB", "text": "We first study one of the state-of-the-art algorithms for fixed-confidence optimal arm identification problem and adjust it for the finite population setting. The lil\u2019UCB algorithm (Jamieson et al., 2014) maintains an upper confidence bound (UCB) of \u00b5i that is inspired by the law of the iterated logarithm (LIL) for every arm. At each iteration, it draws a single sample from the arm with the highest bound and updates it. The algorithm terminates when some arm is sampled much more often than all the other arms. We refer readers to Fig. 1 of Jamieson et al. (2014) for details. The time complexity for t iterations is O(log(D)t). It was shown in Jamieson et al. (2014) that lil\u2019UCB achieved the optimal sample complexity up to constants.\nHowever, lil\u2019UCB requires i.i.d. rewards for each arm i, that is, sampled with replacement from Li. Therefore, the total number of samples t is unbounded and could be ND when the means are close to each other. We adapt lil\u2019UCB for our problem with the following modifications:\n1. Samples li,n without replacement for each arm but keep different arms independent.\n2. When T (t)i = N for some arm i, the estimate \u00b5\u0302 (t) i\nbecomes exact. So set its UCB to \u00b5\u0302(t)i .\n3. The algorithm terminates either with the original stopping criterion or when the arm with the highest upper bound has an exact mean estimate, whichever comes first.\nThe adapted algorithm satisfies all the theoretical guarantees in Thm. 2 of Jamieson et al. (2014) with additional properties as shown in the following proposition with proof in Appx. A.2.\nProposition 2. Theorem 2 of Jamieson et al. (2014) holds for the adapted lil\u2019UCB algorithm. Moreover T (t)i \u2264 N, \u2200i, t. Therefore, when the algorithm terminates, t =\u2211 i\u2208X T (t) i \u2264 ND.\nNotice that Thm. 2 of Jamieson et al. (2014) shows that t scales roughly asO(1/\u22062) with \u2206 being the mean gap and therefore t ND when the gap is large."}, {"heading": "3.3. Racing Algorithm for a Finite Population", "text": "When rewards are sampled without replacement, the negative correlation between rewards would generally improve the convergence of \u00b5\u0302i. Unfortunately, the bound in lil\u2019UCB ignores the negative correlation when T (t)i < N even with the adaptations. We introduce a new family of racing algorithms (Maron & Moore, 1994) that takes advantage of the finite population setting as shown in Alg. 1. The choice of the uncertainty bound function G differentiates specific algorithms and two examples will be discussed in the following sections.\nAlg. 1 maintains a set of candidate setD initialized with all arms. At iteration t, a shared mini-batch ofm(t) indices are drawn w/o replacement for all survived arms in D. Then the uncertainty bound G is used to eliminate sub-optimal arms with a given confidence. The algorithm stops when only one arm remains. We require for m(t) that the total number of sampled indices T (t \u2217) = \u2211t\u2217 t=1m\n(t) equalsN at the last iteration t\u2217. Particularly, we take a doubling schedule T (t) = 2T (t\u22121) (so t\u2217 = dlog2 Nm(1) e + 1) and leave m(1) as a free parameter. We also require G(\u00b7, T, \u00b7, \u00b7) = 0 whenever T = N so that Alg. 1 always stops within t\u2217 iterations. The computational complexity for t iterations is O(DT (t)) with the marginal estimate \u03c3\u0302i and O(D2T (t)) with the pairwise estimate \u03c3\u0302i,j . The former version is more efficient than the latter when D is large at the price of a looser bound. Proposition 3. If G satisfies\nE def= P (\u2203t < t\u2217, \u00b5\u0302(t) \u2212 \u00b5 > G(\u03b4, T (t), \u03c3\u0302(t), C)) \u2264 \u03b4, (5)\nfor any \u03b4 \u2208 (0, 1) with a probability at least 1 \u2212 \u03b4, Alg. 1 returns the optimal arm with at most ND samples.\nThe proof is provided in Appx. A.3. Unlike adapted lil\u2019UCB, Racing draws a shared set of sample indices among all the arms and could provide a tighter bound with pairwise variance estimates \u03c3\u0302i,j when there is positive correlation, a typical case in Bayesian inference problems."}, {"heading": "3.3.1. RACING WITH SERFLING CONCENTRATION BOUNDS FOR G", "text": "Serfling (1974) studied the concentration inequalities of sampling without replacement and obtained an improved\nAlgorithm 1 Racing Algorithm with a Finite Reward Population input Number of arms D, population size N , mini-batch\nsizes {m(t)}t\u2217t=1, confidence level 1 \u2212 \u03b4, uncertainty bound function G(\u03b4, T, \u03c3\u0302, C), range of samples Ci (optional). t\u2190 0, T \u2190 0, D \u2190 {1, 2, . . . , D}, N \u2190 \u2205 while |D| > 1 do t\u2190 t+ 1 Sample w/o replacement m(t) indicesM \u2286 [N ]\\N , and set N \u2190 N \u222aM, T \u2190 T +m(t) Compute li,n,\u2200i \u2208 D, n \u2208 M, and update \u00b5\u0302i and \u03c3\u0302i (or \u03c3\u0302i,j), \u2200i \u2208 D. Find the best arm x\u2190 argmaxi\u2208D \u00b5\u0302i Eliminate sub-optimal arms when the estimated gap is large D \u2190 D\\{i : \u00b5\u0302x \u2212 \u00b5\u0302i > G( \u03b4D , T, \u03c3\u0302x, Cx) + G( \u03b4D , T, \u03c3\u0302i, Ci)} (or D \u2190 D\\{i : \u00b5\u0302x \u2212 \u00b5\u0302i > G( \u03b4D\u22121 , T, \u03c3\u0302x,i), Cx + Ci})\nend while output D\nHoeffding bound. Bardenet & Maillard (2013) extended the work and provided an empirical Bernstein-Serfling bound that was later used for the subsampling-based MH algorithm (Bardenet et al., 2014): for any \u03b4 \u2208 (0, 1] and any n \u2264 N , with probability 1\u2212 \u03b4, it holds that\n\u00b5\u0302n \u2212 \u00b5 \u2264 \u03c3\u0302n\n\u221a 2\u03c1n log(5/\u03b4)\nn + \u03baC log(5/\u03b4)\nn def = BEBS(\u03b4, n, \u03c3\u0302n, C) (6)\nwhere \u03ba = 73 + 3\u221a 2 , and \u03c1n ={ 1\u2212 \u03c0n\u22121 if n \u2264 N/2 (1\u2212 \u03c0n)(1 + 1n ) if n > N/2 , with \u03c0n def = n N . The extra term \u03c1n that is missing in regular empirical Bernstein bounds reduces the bound significantly when n is close to N . We set m(1) = 2 in Alg. 1 to provide a valid \u03c3\u0302(t) for any t and set the uncertain bound G with the empirical Bernstein-Serfling (EBS) bounds as\nGEBS(\u03b4, T, \u03c3\u0302, C) = BEBS\n( \u03b4\nt\u2217 \u2212 1 , T, \u03c3\u0302, C\n) (7)\nIt is trivial to prove thatGEBS satisfies the condition in Eq. 5 using a union bound over t < t\u2217."}, {"heading": "3.3.2. RACING WITH A NORMAL ASSUMPTION FOR G", "text": "The concentration bounds often give a conservative strategy as they assume an arbitrary bounded reward distribution. When the number of drawn samples is large, the central limit theorem suggests that \u00b5\u0302(t) follows approximately a Gaussian distribution. Korattikara et al. (2014) made such\nan assumption and obtained a tighter bound. We first provide an immediate corollary of Prop. 2 in Appx. A of Korattikara et al. (2014).\nCorollary 4. Let \u00b5\u0302(t)unit, t = 1, 2, . . . , t\u2217 be the estimated means using sampling without replacement from any finite population with mean \u00b5 and unit variance. The joint normal random variables \u00b5\u0303(t) that match the mean and covariance matrix with \u00b5\u0302(t)unit follow a Gaussian random walk process as\np\u00b5(\u00b5\u0303 (t)|\u00b5\u0303(1), . . . , \u00b5\u0303(t\u22121)) = N (mt(\u00b5\u0303(t\u22121)), St) (8)\nwhere mt = \u00b5+At(\u00b5\u0303t\u22121 \u2212 \u00b5), St = BtT (t) ( 1\u2212 T (t)\u22121 N\u22121 ) , At = \u03c0t\u22121(1\u2212\u03c0t) \u03c0t(1\u2212\u03c0t\u22121) , Bt = \u03c0t\u2212\u03c0t\u22121 \u03c0t(1\u2212\u03c0t\u22121) with \u03c0t short for \u03c0T (t) . Remark 5. The marginal distribution p(\u00b5\u0303(t)) = N ( \u00b5, 1\nT (t)\n( 1\u2212 T\n(t)\u22121 N\u22121\n)) where the variance approaches\n0 when T (t) \u2192 N . Assumption 6. When T (t) 1,\u2200t, we assume \u03c3\u0302(t) \u2248 \u03c3 and the central limit theorem suggests that the joint distribution of \u00b5\u0302(t)/\u03c3\u0302(t) can be approximated by the joint distribution of \u00b5\u0303(t).\nWith the normal assumption, we choose the uncertainty bound G in the following form\nGNormal(\u03b4, T, \u03c3\u0302) = \u03c3\u0302\u221a T\n( 1\u2212 T \u2212 1\nN \u2212 1\n)1/2 BNormal (9)\nIntuitively we use a constant confidence level, \u03a6(BNormal), for all marginal distributions of \u00b5\u0302(t) over t where \u03a6(\u00b7) is the CDF of the standard normal. To choose the constant BNormal, we plugGNormal into the condition for G in Eq. 5 and apply the normal distribution (8) to solve the univariate equation E(B) = \u03b4. This way of computing G gives a tighter bound than applying the union bound across t as in the previous section because it takes into account the correlation of mean estimates across iterations. Appx. B provides a lookup table and a plot of BNormal(\u03b4) = E\u22121(\u03b4). Notice that BNormal only needs to be computed once and we can obtain it for any \u03b4 by either interpolating the table or computing numerically with code to be shared (runtime < 1 second). For the parameter of the first mini-batch size m(1), a value of 50 performs robustly in all experiments.\nWe provide the sample complexity below with the proof in Appx. A.4. Particularly, T \u2217(\u2206) \u2192 DN as \u2206 \u2192 0, and T \u2217(\u2206) = Dm(1) when \u2206 \u2265 2BNormal(\u03b4/D\u2032)\u221a\n(N/m(1) \u2212 1)/(N \u2212 1). Proposition 7. Let x\u2217 be the best arm and \u2206 be the minimal normalized gap of means from other arms, defined as mini6=x\u2217\n\u00b5x\u2217\u2212\u00b5i \u03c3x\u2217+\u03c3i\nwhen using marginal variance estimate \u03c3\u0302i and mini6=x\u2217\n\u00b5x\u2217\u2212\u00b5i \u03c3x\u2217,i\nwhen using pairwise variance estimate \u03c3\u0302x,i. If Assump. 6 holds, with a probability at least"}, {"heading": "1\u2212 \u03b4 Racing-Normal draws no more rewards than", "text": "T \u2217(\u2206) = D  N(N \u2212 1) \u220624B2Normal(\u03b4/D\u2032) + 1  m(1) (10)\nwhere dnem def = m2dlog2 n/me \u2227N \u2265 n, \u2200n \u2264 N . D\u2032 def= D if using \u03c3\u0302i and is D \u2212 1 if using \u03c3\u0302x,i."}, {"heading": "3.4. Variance Reduction for Random Rewards with", "text": "Control Variates\nThe difficulty of MABs depends heavily on the ratio of the mean gap to the reward noise, \u2206. To improve the signal noise ratio, we exploit the control variates technique (Wilson, 1984) to reduce the reward variance. Consider a variable hi,n whose expectation En\u223c[N ][hi,n] can be computed efficiently. The residue reward li,n\u2212hi,n +En[hi,n] has the same mean as li,n and the variance is reduced if hi,n \u2248 li,n. In the Bayesian inference experiment where the factor fn(X = i) = p(yn|X = i), we adopt a similar approach as Wang et al. (2013) and take the Taylor expansion of li,n around a reference point y\u0302 as\nli,n \u2248 li(y\u0302)+gTi (yn\u2212y\u0302)+ 1\n2 (yn\u2212y\u0302)THi(yn\u2212y\u0302) def = hi,n\n(11) where gi and Hi are the gradient and Hessian matrix of log p(y|i) respectively evaluated at y\u0302. E[hi,n] can computed analytically with the first two moments of yn. A typical choice of y\u0302 is E[y].\nThe control variate method is mostly useful for RacingNormal. For algorithms depending on a reward bound C in order to get a tight bound for li,n \u2212 hi,n it requires a more restrictive condition for C as in Bardenet et al. (2015) and we might end up with an even more conservative strategy in general cases."}, {"heading": "4. Related Work", "text": "The Gumbel-Max trick has been exploited in Kuzmin & Warmuth (2005); Papandreou & Yuille (2011); Maddison et al. (2014) for different problems. The closest work is Maddison et al. (2014) where this trick is extended to draw continuous random variables with a Gumbel process, reminiscent to adaptive rejection sampling.\nOur work is closely related to the optimal arm identification problem for MABs with a fixed confidence. This is, to our knowledge, the first work to consider MABs with a finite population. The proposed algorithms tailored under this setting could be of interest beyond the discrete sampling problem. The normal assumption in Sec. 3.3.2 is similar to UCB-Normal in Auer et al. (2002) but the latter assumes a normal distribution for individual rewards and will perform poorly when it does not hold.\nThe bounds in Sec. 3.3 are based on subsampling-based MH algorithms in Bardenet et al. (2014); Korattikara et al. (2014). The proposed algorithm extends those ideas from MH to discrete sampling. In fact, let x and x\u2032 be the current and proposed value in an MH iteration, Racing-EBS and Racing-Normal reduce to the algorithms in Bardenet et al. (2014) and Korattikara et al. (2014) respectively if we set\nX = {x, x\u2032}, f0(1) = u p(x)q(x\u2032|x), f0(2) = p(x \u2032)q(x|x\u2032), fn(x) = p(yn|x) (12)\nwhere p(x) is the prior distribution, u \u223c Uniform[0, 1] and q(\u00b7|\u00b7) is the proposal distribution. The difference with Bardenet et al. (2014) is that we distribute the error \u03b4 evenly across t in Eq. 7 while Bardenet et al. (2014) set \u03b4t = (p \u2212 1)/(p(T (t))p)\u03b4 with p a free parameter. The differences with Korattikara et al. (2014) are that we take a doubling schedule for m(t) and replace the t-test with the normal assumption. We find that our algorithms are more efficient and robust than both original algorithms in practice. Moreover, the binary Gibbs sampling in Appx. F of Korattikara et al. (2014) is also a special case of RacingNormal with D = 2. Therefore, Alg. 1 provides a unifying approach to a family of subsampling-based samplers.\nThe variance reduction technique is similar to the proxies in Bardenet et al. (2015), but the control variate here is a function in the data space while the proxy in the latter is a function in the parameter space. We do not assume the posterior distribution is approximate Gaussian and our algorithm works with multi-modal distributions.\nIt is important not the confuse the focus of our algorithm for the big N problem in Eq. 1 with other algorithms that address sampling for a large state space (big D) or similarly a high-dimensional vector of discrete variables (exponentially large D). The combination of these two approaches for problems with both big N and big D is possible but beyond the scope of this paper."}, {"heading": "5. Experiments", "text": "Since this is the first work to discuss efficient discrete sampling for problem (1), we compare the adapted lil\u2019UCB, Racing-EBS, Racing-Normal with the exact sampler only. We report the result of Racing-Normal in real data experiments only as the speed gains of the other two are marginal."}, {"heading": "5.1. Synthetic Data", "text": "We construct a distribution with D = 10 by sampling N = 105 rewards of li,n for each state from one of the three distributions N (0, 1), Uniform[0, 1], LogNormal(0, 2). We normalized li,n to have a fixed distribution p(X) in Fig. 1(a) and a reward variance \u03c32 that controls the difficulty. The normal distribution is the ideal setting for\nRacing-Normal, and the uniform distribution is desirable for adapted lil\u2019UCB and Racing-EBS as the reward bound is close to \u03c3. The LogNormal distribution, whose ex. kurtosis \u2248 4000, is difficult for all due to the heavy tail. We use a tight bound C = max{li,n \u2212 li,n\u2032} for Racing-EBS. We set the scale parameter of adapted lil\u2019UCB with C/2 and other parameters with the heuristic setting in Jamieson et al. (2014). Racing uses the pairwise variance estimate.\nFig. 1(b)-(d) show the empirical error of best arm identification by drawing 104 samples of X for each setting and vary the target error bound \u03b4 \u2208 [10\u22123, 0.1]. The bound appears very loose for lil\u2019UCB and Racing-EBS but is sharp for Racing-Normal when the noise is large (1(b)) and \u03b4 1. This is consistent with the direct comparison of uncertainty bounds in Fig. 1(e). Consequently, given the same error tolerance \u03b4 Racing-Normal requires much fewer rewards than the other conservative strategies in all the settings except when \u03c3 = 10\u22125 and li,n \u223c Uniform[0, 1], as shown in Fig. 1(f)-(h). We verify the observations with more experiments in Appx. C.1 with D \u2208 {2, 100} and marginal estimate \u03c3\u0302i.\nSurprisingly, Racing-Normal performs robustly regardless of reward distributions with the first mini-batch size m(1) = 50 while it was shown in Bardenet et al. (2014) that the algorithm with the same normal assumption in Korattikara et al. (2014) failed with LogNormal even when m(1) = 500. The dramatic improvement in robustness is mainly due to our doubling scheme where central limit theorem applies quickly with m(t) increasing exponentially. We do not claim that the single trick will solve the problem completely because there still exist cases in theory with extremely heavy-tailed reward distributions where our normal assumption does not hold and the algorithm will fail to meet the confidence level. In practice, we do not observe that pathological case in any of the experiments."}, {"heading": "5.2. Bayesian ARCH Model Selection", "text": "We evaluate Racing-Normal in a Bayesian model selection problem for the auto-regressive conditional heteroskedasticity (ARCH) models. The discrete sampler is integrated in the Markov chain as a building component to sample the hierarchical model. Specifically, we consider a mixture of ARCHs for the return rt of stock price series with student-t innovations, each component with a different order q:\nrt = \u03c3tzt, zt iid\u223c t\u03bd(0, 1), \u03c32t = \u03b10 + q\u2211 i=1 \u03b1ir 2 t\u2212i,\nq \u223c Discrete(\u03c0), \u03b1i, \u03bd iid\u223c Gamma(1, 1)\nwhere \u03c0 = {\u03c0q : q \u2208 Q} is the prior distribution of a candidate model in the set Q. The random variables to infer include the discrete model choice q and continuous param-\neters {\u03b1i}qi=0, \u03bd. We adopt the augmented MCMC algorithm in Carlin & Chib (1995) to avoid transdimensional moves. We apply subsampling-based scalable algorithms to sample all variables with subsampled observations {rt}: Racing-Normal Gibbs for q, stochastic gradient Langevin dynamics (SGLD) (Welling & Teh, 2011) corrected with Racing-Normal MH (Sec. 4) for \u03b1i and \u03bd. We use adjusted priors \u03c0\u0303q as suggested by Carlin & Chib (1995) for sufficient mixing between all models and tune them with adaptive MCMC. The adjusted posterior p\u0303(q|r) \u221d \u03c0\u0303qp(r|q) is then close to uniform and the value \u03c0q/\u03c0\u0303q provides an estimate to the real unnormalized posterior p(q|r). Control variates are also applied to reduce variance. Details of the sampling algorithm are provided in Appx. C.2.\nWe apply the model on the 5-minute Shanghai stock exchange composite index of one year consisting of about 13,000 data points (Fig. 2(a)). Q = {5, 10, 15, 20, 25, 30}. We set m(1) = 50 and \u03b4 = 0.05. The control variate method reduces the reward variance by 2\u223c3 orders of magnitude. Fig. 2(b) shows the estimated log-posterior of q by normalizing \u03c0q/\u03c0\u0303q in the adaptive MCMC as a function of the number of likelihood evaluations (proportional to runtime). The subsampling-based sampler (Sub) converges about three times faster. We then fix \u03c0\u0303q for a fixed stationary distribution and run MCMC for 105 iterations to compare Sub with the exact sampler. The empirical error rates for Racing-Normal Gibbs and MH are about 4\u00d7 10\u22124 and 2 \u00d7 10\u22123 respectively. Fig. 2(c) shows estimated adjusted posterior with 5 runs, and (d) compares the auto-correlation of sample q. Sub obtains over twice the effective sample\nsize without noticeable bias after the burn-in period."}, {"heading": "5.3. Author Coreference", "text": "We then study the performance in a large-scale graphical model inference problem. The author coreference problem for a database of scientific paper citations is to cluster the mentions of authors into real persons. Singh et al. (2012) addressed this problem with a conditional random field model with pairwise factors. The joint and conditional distributions are respectively\np\u03b8(y|x) \u221d exp  \u2211 yi=yj ,i6=j,\u2200i,j f\u03b8(xi, xj)  , p\u03b8(Yi = yi|y\u2212i,x) \u221d exp\n \u2211 yj\u2208Cy={j:yj=y,j 6=i} f\u03b8(xi, xj)  where x = {xi}Ni=1 is the set of observed author mentions and yi \u2208 N+ is the cluster index for i\u2019th mention. The factor f\u03b8(xi, xj) measures the similarity between two mentions based on author names, coauthors, paper title, etc, parameterized by \u03b8. In the conditional distribution, yi can take a value of any non-empty cluster or another empty cluster index. When a cluster Cy contains a lot of mentions, a typical case for common author names, the number of factors to be evaluated Ny = |Cy| will be large. We consider the MAP inference problem with fixed \u03b8 using annealed Gibbs sampling (Finkel et al., 2005). We apply Racing-Normal to sample Yi by subsampling Cy for each\n0 2 4 6 8 10\nx 10 10\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\nNumber of factors evaluated\nB 3 F\n\u2212 1 S\nc o re\nExact Gibbs\nSub Gibbs\n(a) B3 F-1 vs #factor evaluations\n0 5 10 15 20\nx 10 5\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\nNumber of iterations\nB 3 F\n\u2212 1 S\nc o re\n0.2\n0.4\n0.6\n0.8\n1\nR e la\nti v e #\no f e v a lu\na te\nd f a c to\nrs\nExact Gibbs\nSub Gibbs\nExact overlaps with Sub\n(b) B3 F-1 vs iteration\nFigure 3. Author Coreference. Bigger B3 F-1 score is better.\ncandidate value y. An important difference of this problem from Eq. 1 is that Ny 6= Ny\u2032 ,\u2200y 6= y\u2032 and Ny has a heavy tail distribution. We let the mini-batch size depend on Ny with details provided in Appx. C.3.\nWe run the experiment on the union of an unlabeled DBLP dataset of BibTex entries with about 5M authors and a Rexa corpus of about 11K author mentions with 3160 entries labeled. We monitor the clustering performance on the labeled subset with the B3 F-1 score (Bagga & Baldwin, 1998). We use \u03b4 = 0.05 and the empirical error rate is about 0.046. The number of candidate values D varies in 2 \u223c 215 and Ny varies in 1 \u223c 1829 upon convergence. Fig. 3(a) shows the F-1 score as a function of the number of factor evaluations with 7 random runs for each algorithm. Sub Gibbs converges about three times faster than exact Gibbs. Fig. 3(b) shows F-1 as a function of iterations that renders almost identical behavior for both algorithms, which suggests negligible bias in Sub Gibbs. The relative number of the evaluated factors of sub to exact Gibbs indicates about a 5-time speed up near convergence. The initial speed up is small because every cluster is initialized with a single mention, i.e. Ny = 1."}, {"heading": "6. Discussion", "text": "We consider the discrete sampling problem with a high degree of dependency and proposed three approximate al-\ngorithms under the framework of MABs with theoretical guarantees. The Racing algorithm provides a unifying approaches to various subsampling-based Monte Carlo algorithms and also improves the robustness of the original MH algorithm in Korattikara et al. (2014). This is also the first work to discuss MABs under the setting of a finite reward population.\nEmpirical evaluations show that Racing-Normal achieves a robust and the highest speed-up among all competitors. Whilst adaptive lil\u2019UCB shows inferior empirical performance to Racing-Normal, it has a better sample complexity w.r.t. the number of arms D. It will be a future direction to combine the bound of Racing-Normal with other MAB algorithms including lil\u2019UCB for a better scalability in D. Another important problem is on how to relax the assumptions for Racing-Normal without sacrificing the performance.\nIt would also be an interesting direction to extend our work to draw continuous random variables efficiently with the Gumbel process (Maddison et al., 2014). In continuous state space, there are infinitely many \u201carms\u201d and a naive application of our algorithm will lead to infinitely large error bound. This problem can be alleviated with algorithms for contextual MAB problems."}, {"heading": "Acknowledgements", "text": "We thank Matt Hoffman for helpful discussions on the connection of our work to the MAB problems. We also thank all the reviewers for their constructive comments. We acknowledge funding from the Alan Turing Institute, Google, Microsoft Research and EPSRC Grant EP/I036575/1."}, {"heading": "A. Proofs", "text": "A.1. Proof of Prop. 1\nProof. For a discrete state space, the total variation is equivalent to half of L1 distance between two probability vectors. Denote by p\u0302(X = i|\u03b5) the distribution of the output of the approximate algorithm conditioned on the vector of Gumbel variables \u03b5, and x(\u03b5) the solution of Eq. 2 as a function of \u03b5. According to the premise of Prop. 1, p\u0302(X = x(\u03b5)|\u03b5) \u2265 1\u2212 \u03b4, \u2200\u03b5. We can bound the L1 error of the conditional probability as\u2211 i\u2208X\n\u2223\u2223p\u0302(X = i|\u03b5)\u2212 \u03b4i,x(\u03b5)\u2223\u2223 = |p\u0302(X = x(\u03b5)|\u03b5)\u2212 1|+\n\u2211 i 6=x(\u03b5) |p\u0302(X = i|\u03b5)| \u2264 2\u03b4, \u2200\u03b5\n(13)\nwhere \u03b4i,j is the Kronecker delta function. Then we can show\n\u2016p\u0302(X)\u2212 p(X)\u2016TV\n= 1\n2 \u2211 i\u2208X |p\u0303(X = i)\u2212 p(X = i)|\n= 1\n2 \u2211 i\u2208X \u2223\u2223\u2223\u2223\u222b \u03b5 ( p\u0302(X = i|\u03b5)\u2212 \u03b4i,x(\u03b5) ) dP (\u03b5) \u2223\u2223\u2223\u2223 \u2264 1\n2 \u2211 i\u2208X \u222b \u03b5 \u2223\u2223p\u0302(X = i|\u03b5)\u2212 \u03b4i,x(\u03b5)\u2223\u2223dP (\u03b5) = 1\n2 \u222b \u03b5 (\u2211 i\u2208X \u2223\u2223p\u0302(X = i|\u03b5)\u2212 \u03b4i,x(\u03b5)\u2223\u2223 ) dP (\u03b5)\n\u2264 \u03b4 (14)\nA.2. Sketch of the proof of Prop. 2\nProof. As the proof of this proposition is almost identical to the proof of Jamieson et al. (2014), we only outlines the difference due to the adaptation. In the proof of Thm. 2 in Jamieson et al. (2014), the i.i.d. assumption for rewards from each arm was used only in Lemma 3 to provide Chernoff\u2019s bound and Hoeffding\u2019s bound. As noted in Sec. 6 of Hoeffding (1963) those bounds would still hold when rewards are sampled from a finite population without replacement. Therefore, when T (t) < N all the bounds hold for adapted lil\u2019UCB.\nWhen T (t)i = N , the second modification sets the upper bound of the mean estimate to \u00b5\u0302(t). That is a valid upper bound of \u00b5i, in fact much tighter than the bound in the original algorithm because \u00b5\u0302(t)i = \u00b5i exactly when the entire population is observed.\nTherefore, as long as T (t)i \u2264 N, \u2200i, Theorem 2 in Jamieson et al. (2014) applies to adapted lil\u2019UCB with modification 1 and 2 only.\nWith the third modification, T (t) could never be bigger than N at the stopping time, which proves the second part of Prop 2. The proof can then be concluded if we can show modification 3 does not change the output of adapted lil\u2019UCB with the first two modifications only. This is true because if we do not stop when the selected arm i satisfies T\n(t) i = N , we do not need to update the upper bound of i because the estimated mean is already exact. Since no upper bound is changed, the arm i will always be chosen for now on and eventually the original stopping criterion of T\n(t) i \u2265 1 +\u03bb \u2211 j 6=i Tj(t) is met and the same arm i will be\nreturned.\nA.3. Proof of Prop. 3\nProof. Denote by x(t) the arm with the highest estimated mean at iteration t and x\u2217 the optimal arm with the highest true mean, \u00b5x\u2217 > \u00b5i,\u2200i 6= x\u2217. If Alg. 1 does not stop in the first t\u2217 \u2212 1 iterations, the estimated means of all the survived arms become exact at the last iteration t\u2217, \u00b5\u0302(t \u2217) i = \u00b5i because we require T (t \u2217) = N . Then x(t\n\u2217) = x\u2217. As we require G(\u03b4, T = N, \u03c3\u0302, C) = 0,\u2200\u03b4, \u03c3\u0302, C, all the suboptimal arms will be eliminated by the last iteration and the algorithm always returns the correct best arm. This proves the upper bound of the sample size of ND.\nNow to prove the confidence level, all we need to show is that with at least a probability 1\u2212 \u03b4 arm x\u2217 survived all the iterations t < t\u2217.\nLet us first consider the case when Alg. 1 uses the marginal variance estimate \u03c3\u0302(t)i . Let the events\nEi = { \u2203t < t\u2217, \u00b5\u0302(t)i \u2212 \u00b5i > G ( \u03b4\nD , T (t), \u03c3\u0302 (t) i , Ci\n)} ,\u2200i 6= x\u2217\nEx\u2217 = { \u2203t < t\u2217,\u2212\u00b5\u0302(t)x\u2217 \u2212 (\u2212\u00b5x\u2217) > G ( \u03b4\nD , T (t), \u03c3\u0302 (t) i , Ci )} (15)\nApplying condition Eq. 5 and the union bound, we get P (\u222ai\u2208XEi) \u2264 \u2211 i\u2208X Ei = \u03b4. So with a probability at least 1 \u2212 \u03b4, none of those events will happen. In that case for any iteration t < t\u2217,\n\u00b5\u0302x \u2212 \u00b5\u0302x\u2217 = (\u00b5\u0302x \u2212 \u00b5x)\u2212 (\u00b5\u0302x\u2217 \u2212 \u00b5x\u2217) + (\u00b5x \u2212 \u00b5x\u2217)\n< G\n( \u03b4\nD , T (t), \u03c3\u0302(t)x , Cx\n) +G ( \u03b4\nD , T (t), \u03c3\u0302 (t) x\u2217 , Cx\u2217 ) (16)\nSo arm x\u2217 won\u2019t be eliminated at iteration t.\nSimilarly, for the case when Alg. 1 uses the pairwise vari-\nance estimate \u03c3\u0302(t)x,i, let the events\nEi,x = { \u2203t < t\u2217, (\u00b5\u0302(t)i \u2212 \u00b5\u0302 (t) x\u2217 )\u2212 (\u00b5i \u2212 \u00b5x\u2217)\n> G\n( \u03b4\nD \u2212 1 , T (t), \u03c3\u0302 (t) i , Ci + Cx\u2217\n)} ,\u2200i 6= x\u2217\n(17)\nApplying condition Eq. 5 and the union bound, we get P (\u222ai\u2208X\\{x\u2217}Ei,x) \u2264 \u2211 i\u2208X\\{x\u2217}Ei,x = \u03b4. So with a probability at least 1\u2212 \u03b4 for any iteration t < t\u2217,\n\u00b5\u0302x \u2212 \u00b5\u0302x\u2217 = (\u00b5\u0302x \u2212 \u00b5\u0302x\u2217)\u2212 (\u00b5x \u2212 \u00b5x\u2217) + (\u00b5x \u2212 \u00b5x\u2217)\n< G\n( \u03b4\nD \u2212 1 , T (t), \u03c3\u0302 (t) x,x\u2217 , Cx + Cx\u2217\n) (18)\nTherefore arm x\u2217 won\u2019t be eliminated at iteration t.\nA.4. Proof of Prop. 7\nProof. Denote by x(t) the arm with the highest estimated mean at iteration t. First consider the case when Alg. 1 uses the marginal variance estimate \u03c3\u0302(t)i . With the condition in Eq. 5, it follows that P (\u222ai\u2208XEi) \u2264 \u2211 i\u2208X P (Ei) \u2264 \u03b4 where Ei is defined in Eq. 15. So with a probability at least 1\u2212 \u03b4,\n\u00b5\u0302 (t) x\u2217 \u2212 \u00b5\u0302 (t) i >\u00b5x\u2217 \u2212 \u00b5i \u2212G\n( \u03b4\nD , T (t), \u03c3\u0302 (t) x\u2217 , Cx\u2217 ) \u2212G ( \u03b4\nD , T (t), \u03c3\u0302 (t) i , Ci\n) ,\u2200i 6= x\u2217 (19)\nAlg. 1 will stop by iteration t if the RHS of the equation above satisfies the stopping criterion for all i 6= x\u2217, that is,\n\u00b5x\u2217 \u2212 \u00b5i > 2 ( G ( \u03b4\nD , T (t), \u03c3\u0302 (t) x\u2217 , Cx\u2217\n)\n+G\n( \u03b4\nD , T (t), \u03c3\u0302 (t) i , Ci\n)) ,\u2200i 6= x\u2217\n(20)\nPlugging in the definition ofGNormal in Eq. 9 and applying the assumption \u03c3\u0302(t)i = \u03c3i, we will get\n\u00b5x\u2217 \u2212 \u00b5i (\u03c3x\u2217 + \u03c3i) > 2\u221a T (t)\n( 1\u2212 T\n(t) \u2212 1 N \u2212 1\n)1/2 BNormal,\u2200i 6= x\u2217\n(21) Solve the above inequality for T (t) and use the definition of the gap \u2206 we get\nT (t) > N\n(N \u2212 1) \u22062 4B2Normal(\u03b4/D) + 1\ndef = T\u0303 (22)\nSince we use a doubling schedule T (t) = 2T (t\u22121) with T (1) = m(1) and T (t\n\u2217) = N , Alg. 1 stops at an iteration no later than t = dlog2(T\u0303 /m(0))e+ 1 (23) And the total number of samples drawn by t is upper bounded by D(m(0)2t\u22121 \u2227N) = T \u2217(\u2206).\nNow consider the case when Alg. 1 uses the pairwise variance estimate \u03c3\u0302(t)x,i. With the condition in Eq. 5, it follows with the union bound that P (\u222ai\u2208X\\{x\u2217}Ei) \u2264\u2211 i\u2208X\\{x\u2217} P (Ei) \u2264 \u03b4 where Ei is defined in Eq. 17. So with a probability at least 1\u2212 \u03b4,\n\u00b5\u0302 (t) x\u2217 \u2212 \u00b5\u0302 (t) i > \u00b5x\u2217 \u2212 \u00b5i \u2212G ( \u03b4\nD \u2212 1 , T (t), \u03c3\u0302 (t) x\u2217,i, Cx\u2217 + Ci\n) ,\u2200i 6= x\u2217\n(24)\nNow we can follow a similar argument as in the case with marginal variance estimate and prove the proposition.\nB. Table and Figure of BNormal(\u03b4, \u03c0T (1)) Table 1 shows BNormal(\u03b4, \u03c0T (1)) with \u03b4 varying in [10\u22126, 0.49], and the proportion of the first mini-batch \u03c0T (1) = m\n(1)/N \u2208 {5\u00d7 10\u22125, 10\u22124, 5\u00d7 10\u22124, 10\u22123, 5\u00d7 10\u22123, 10\u22122}. \u03a6(B) can be interpreted as the marginal confidence level for one iteration. The function is also shown in Fig. 4 for visualization. We will release the code to generate the table and to compute BNormal(\u03b4, \u03c0T (1)) numerically."}, {"heading": "C. Experiment Detailed Setting and Extra Results", "text": "C.1. More Results of the Synthetic Data Experiment\nThe results with the marginal variance estimate \u03c3\u0302i for Racing are shown in Fig. 5. The Racing algorithms (both EBS and Normal) performs more conservatively compared to the plots when using pairwise variance estimate \u03c3\u0302i,j in Fig. 1, but the relative performance of all the algorithms are very similar to Fig. 1.\nWe also provide the results with D = 2 and D = 100 when Racing algorithms use pairwise variance estimate in Fig. 6 and 7 respectively. Racing-Normal performs the best in all situations and the empirical error never exceeds the provided bound \u03b4 with a statistical significance of 0.05.\nNotice that the error of adaptive lil\u2019UCB exceeds the error tolerance in the experiment with D = 100 and li,n \u223c Uniform[0, 1]. This is because we use the recommended heuristic setting of parameters in Jamieson et al. (2014) that unfortunately does not satisfy the theoretical guarantee of Thm. 2 in Jamieson et al. (2014). lil\u2019UCB (heuristic)\nperformed significantly better than the setting with guarantees in Jamieson et al. (2014). So we expect that adaptive lil\u2019UCB with parameters satisfying Thm. 2 of Jamieson et al. (2014) will perform significantly worse than adaptive lil\u2019UCB (heuristic) and Racing-Normal in terms of the reward sample complexity.\nC.2. Details of the Bayesian ARCH Model Selection Experiment\nAn ARCH model is commonly used to model the stochastic volatility of financial times series. Let rt def = log(pt/pt\u22121) be the logarithm return of some asset price pt at time t. We assume a constant mean process for the return and remove the estimated mean in a pre-process step. An important problem in applying ARCH for financial data is to choose the complexity, the order q of the auto-regressive model. We treat the model selection problem as a Bayesian inference problem for the random variable q. We use a uniform prior distribution, \u03c0(q) = 1/|Q|.\nAn MCMC algorithm was introduced in Carlin & Chib (1995) to infer the posterior model distribution by augmenting the parameter space to a complete parameter set for all models ((\u03b1(j)i ) j i=0, \u03bd\n(j)), j \u2208 Q, then assigning the regular prior for the selected model j = q and pseudopriors for those models that are not selected j 6= q. Then regular MCMC algorithms can be applied to sample all the random variables q, ((\u03b1(j)i )i, \u03bd (j))j without the problem of transdi-\nmensional moves as in reversible jump MCMC.\nThe mixing rate of Carlin & Chib (1995) depends on a proper choice of the pseudoprior for (\u03b1(j)i , \u03bd\n(j)). Ideally it should be similar to the parameter posterior when the model is chosen p(\u03b1(j)i , \u03bd\n(j))|q = j, r). We first reparameterize (\u03b1(j)i , \u03bd\n(j)) with a softplus function x = log(1 + exp(x\u2032)) to allow a full support along the real axis and then take the Laplace approximation at the MAP of transformed parameters as the pseudoprior for each model separately.\nIn order to avoid accessing the entire dataset each iteration, we use subsampling-based algorithms to sample all the conditionals except the pseudoprior as follows\nq|(\u03b1(j), \u03bd(j))j \u223c \u03c0(q) \u220f t p(rt|\u03b1(q), rt\u2212q:t\u22121, \u03bd(q)),\n(\u03b1(q), \u03bd(q))|q \u223c p(\u03b1(q))p(\u03bd(q)) \u220f t p(rt|\u03b1(q), rt\u2212q:t\u22121, \u03bd(q)),\n(\u03b1(j), \u03bd(j))|q iid\u223c ppseudoprior(\u03b1(j), \u03bd(j)),\u2200j 6= q, (25)\nwhere we sample q with Racing-Normal Gibbs and sample \u03b1(q), \u03bd(q) using MH with a proposal from SGLD and a rejection step provided by Racing-Normal MH. The rejection step controls the error introduced in SGLD when the step size is large.\nAs the marginal likelihood for each model could be differed by a few orders of magnitudes, to make sure every model is sampled sufficiently often, we first adjust the prior distribu-\ntion \u03c0\u0303 with the Wang-Landau algorithm with an annealing adaptation on log \u03c0\u0303, 1/(1 + t/100), so that the posterior distribution p\u0303(q|r) is approximately uniform. We then fix \u03c0\u0303 and compare the exact and approximate MCMC algorithms. The real posterior distribution can be computed as p(q|r) \u221d p\u0303(q|r)/\u03c0\u0303(q).\nWe choose the step size separately for the exact and stochastic gradient Langevin dynamics (Welling & Teh, 2011) so that the acceptance rate is about 36%.\nWe apply the control variates by first segmenting the 2-D space of zj,t def = (rt, \u03b1 (j) 0 + (\u03b1 (j) 1:j) T rt\u2212j:t\u22121), where \u03b1(j) takes the MAP value, equally into 100 bins according to marginal quantiles and then taking the reference points at the mean of each bin. We also notice that some data points have large residual reward li,n \u2212 hi,n when zj,t is far from the reference point. We take 20% of the points with the largest distance in z as outliers, always compute them every iteration and apply the subsampling algorithm for the rest data.\nC.3. Details of the Author Coreference Experiment\nThe main differences of this sampling problem from Eq. 1 are that\n1. |Cy| 6= |Cy\u2032 | and the distribution of the cluster size follows approximately a power law with the value varying from as small as 1 to thousands. If we set m(1) = 50 as usual, we already draw about 33% of all the rewards in the first mini-batch. So we slightly abuse the Normal assumption and use a small size for m(1) = 3 and use doubling scheme for the rest with m (2) y = (|Cy| \u2212 3)/10 \u2227 1. The experiment shows an\nempirical error 0.045 of mis-identification of the best arm with the provided bound \u03b4 = 0.05.\n2. The distribution of {f\u03b8(xi, xj) : j \u2208 Cy} is independent from different clusters/arms. We exploit the independence of rewards and choose the bound\nGNormal(\u03b4, Ti, Tj , \u03c3\u0302i, \u03c3\u0302j)\n= ( \u03c3\u0302i Ti ( 1\u2212 Ti \u2212 1 Ni \u2212 1 ) + \u03c3\u0302j Tj ( 1\u2212 Tj \u2212 1 Nj \u2212 1 ))\u22121/2 BNormal.\n(26)\nThis modification has the same performance as with the pairwise variance estimate and has the same computational complexity as with the marginal variance estimate O(DN). We compute BNormal with a sub-\noptimal but simpler choice as BNormal(\u03b4) = \u03a6 \u22121 (\n1\u2212 \u03b4 t\u2217 \u2212 1\n) . (27)\nIt is easy to show that Eq. 5 still holds in this case using a union bound across t. The bound in Eq. 27 is strictly looser than BNormal = E\u22121(\u03b4) but the difference is small when \u03b4 1 and diminishes to 0 as \u03b4 \u2192 0.\nWe obtained the dataset from the authors of Singh et al. (2012) but it is different from what is used in Singh et al. (2012) with more difficult citations. The best B3 F-1 score reported in this paper is a reasonable value for this data set according to personal communications with the authors of Singh et al. (2012)."}], "references": [{"title": "Bayesian posterior sampling via stochastic gradient fisher scoring", "author": ["Ahn", "Sungjin", "Korattikara", "Anoop", "Welling", "Max"], "venue": "In Proceedings of the 29th International Conference on Machine Learning", "citeRegEx": "Ahn et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Ahn et al\\.", "year": 2012}, {"title": "Finite-time analysis of the multiarmed bandit problem", "author": ["Auer", "Peter", "Cesa-Bianchi", "Nicolo", "Fischer", "Paul"], "venue": "Machine learning,", "citeRegEx": "Auer et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Auer et al\\.", "year": 2002}, {"title": "Algorithms for scoring coreference chains", "author": ["Bagga", "Amit", "Baldwin", "Breck"], "venue": "In LREC workshop on linguistics coreference,", "citeRegEx": "Bagga et al\\.,? \\Q1998\\E", "shortCiteRegEx": "Bagga et al\\.", "year": 1998}, {"title": "Concentration inequalities for sampling without replacement", "author": ["Bardenet", "R\u00e9mi", "Maillard", "Odalric-Ambrym"], "venue": "arXiv preprint arXiv:1309.4029,", "citeRegEx": "Bardenet et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Bardenet et al\\.", "year": 2013}, {"title": "Towards scaling up Markov chain Monte Carlo: an adaptive subsampling approach", "author": ["Bardenet", "R\u00e9mi", "Doucet", "Arnaud", "Holmes", "Chris"], "venue": "In Proceedings of The 31st International Conference on Machine Learning,", "citeRegEx": "Bardenet et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Bardenet et al\\.", "year": 2014}, {"title": "On markov chain monte carlo methods for tall data", "author": ["Bardenet", "R\u00e9mi", "Doucet", "Arnaud", "Holmes", "Chris"], "venue": "arXiv preprint arXiv:1505.02827,", "citeRegEx": "Bardenet et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Bardenet et al\\.", "year": 2015}, {"title": "A sequential multiple-decision procedure for selecting the best one of several normal populations with a common unknown variance, and its use with various experimental designs", "author": ["Bechhofer", "Robert E"], "venue": null, "citeRegEx": "Bechhofer and E.,? \\Q1958\\E", "shortCiteRegEx": "Bechhofer and E.", "year": 1958}, {"title": "The tradeoffs of large scale learning", "author": ["L. Bottou", "O. Bousquet"], "venue": "In NIPS,", "citeRegEx": "Bottou and Bousquet,? \\Q2008\\E", "shortCiteRegEx": "Bottou and Bousquet", "year": 2008}, {"title": "Scaling the iHMM: Parallelization versus hadoop", "author": ["S. Bratires", "J. van Gael", "A. Vlachos", "Z. Ghahramani"], "venue": "In Computer and Information Technology (CIT),", "citeRegEx": "Bratires et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Bratires et al\\.", "year": 2010}, {"title": "Bayesian model choice via Markov chain Monte Carlo", "author": ["B.P. Carlin", "S. Chib"], "venue": "Journal of the Royal Statistical Society, Series B,", "citeRegEx": "Carlin and Chib,? \\Q1995\\E", "shortCiteRegEx": "Carlin and Chib", "year": 1995}, {"title": "Stochastic gradient hamiltonian monte carlo", "author": ["Chen", "Tianqi", "Fox", "Emily", "Guestrin", "Carlos"], "venue": "In Proceedings of the 31st International Conference on Machine Learning", "citeRegEx": "Chen et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Chen et al\\.", "year": 2014}, {"title": "Bayesian sampling using stochastic gradient thermostats", "author": ["Ding", "Nan", "Fang", "Youhan", "Babbush", "Ryan", "Chen", "Changyou", "Skeel", "Robert D", "Neven", "Hartmut"], "venue": "In Advances in neural information processing systems,", "citeRegEx": "Ding et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Ding et al\\.", "year": 2014}, {"title": "Approximate slice sampling for Bayesian posterior inference", "author": ["DuBois", "Christopher", "Korattikara", "Anoop", "Welling", "Max", "Smyth", "Padhraic"], "venue": "In Proceedings of AISTATS,", "citeRegEx": "DuBois et al\\.,? \\Q2014\\E", "shortCiteRegEx": "DuBois et al\\.", "year": 2014}, {"title": "Incorporating non-local information into information extraction systems by gibbs sampling", "author": ["Finkel", "Jenny Rose", "Grenager", "Trond", "Manning", "Christopher"], "venue": "In Proceedings of the 43rd ACL,", "citeRegEx": "Finkel et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Finkel et al\\.", "year": 2005}, {"title": "Probability inequalities for sums of bounded random variables", "author": ["Hoeffding", "Wassily"], "venue": "Journal of the American statistical association,", "citeRegEx": "Hoeffding and Wassily.,? \\Q1963\\E", "shortCiteRegEx": "Hoeffding and Wassily.", "year": 1963}, {"title": "lil\u2019UCB: An optimal exploration algorithm for multi-armed bandits", "author": ["Jamieson", "Kevin", "Malloy", "Matthew", "Nowak", "Robert", "Bubeck", "S\u00e9bastien"], "venue": "In Proceedings of The 27th COLT, pp", "citeRegEx": "Jamieson et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Jamieson et al\\.", "year": 2014}, {"title": "Slice sampling mixture models", "author": ["Kalli", "Maria", "Griffin", "Jim E", "Walker", "Stephen G"], "venue": "Statistics and computing,", "citeRegEx": "Kalli et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Kalli et al\\.", "year": 2011}, {"title": "Austerity in MCMC land: Cutting the Metropolis-Hastings budget", "author": ["Korattikara", "Anoop", "Chen", "Yutian", "Welling", "Max"], "venue": "In Proceedings of the 31th International Conference on Machine Learning,", "citeRegEx": "Korattikara et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Korattikara et al\\.", "year": 2014}, {"title": "Optimum follow the leader algorithm", "author": ["Kuzmin", "Dima", "Warmuth", "Manfred K"], "venue": "In Proceedings of the 18th annual conference on Learning Theory,", "citeRegEx": "Kuzmin et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Kuzmin et al\\.", "year": 2005}, {"title": "Reducing the sampling complexity of topic models", "author": ["Li", "Aaron", "Ahmed", "Amr", "Ravi", "Sujith", "Smola", "Alex"], "venue": "In Proceedings of the ACM Conference on Knowledge Discovery and Data Mining (KDD),", "citeRegEx": "Li et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Li et al\\.", "year": 2014}, {"title": "Firefly monte carlo: Exact mcmc with subsets of data", "author": ["Maclaurin", "Dougal", "Adams", "Ryan Prescott"], "venue": "In Twenty-Fourth International Joint Conference on Artificial Intelligence,", "citeRegEx": "Maclaurin et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Maclaurin et al\\.", "year": 2015}, {"title": "Hoeffding races: Accelerating model selection search for classification and function approximation", "author": ["Maron", "Oded", "Moore", "Andrew W"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "Maron et al\\.,? \\Q1994\\E", "shortCiteRegEx": "Maron et al\\.", "year": 1994}, {"title": "Swiftlink: parallel mcmc linkage analysis using multicore cpu and gpu", "author": ["Medlar", "Alan", "G\u0142owacka", "Dorota", "Stanescu", "Horia", "Bryson", "Kevin", "Kleta", "Robert"], "venue": null, "citeRegEx": "Medlar et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Medlar et al\\.", "year": 2013}, {"title": "Sensitivity and convergence of uniformly ergodic markov chains", "author": ["Mitrophanov", "A Yu"], "venue": "Journal of Applied Probability,", "citeRegEx": "Mitrophanov and Yu.,? \\Q2005\\E", "shortCiteRegEx": "Mitrophanov and Yu.", "year": 2005}, {"title": "Distributed algorithms for topic models", "author": ["Newman", "David", "Asuncion", "Arthur", "Smyth", "Padhraic", "Welling", "Max"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "Newman et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Newman et al\\.", "year": 2009}, {"title": "Perturb-and-MAP random fields: Using discrete optimization to learn and sample from energy models", "author": ["G. Papandreou", "A. Yuille"], "venue": "In Proceedings of ICCV,", "citeRegEx": "Papandreou and Yuille,? \\Q2011\\E", "shortCiteRegEx": "Papandreou and Yuille", "year": 2011}, {"title": "A sequential procedure for selecting the population with the largest mean from k normal populations", "author": ["Paulson", "Edward"], "venue": "The Annals of Mathematical Statistics,", "citeRegEx": "Paulson and Edward.,? \\Q1964\\E", "shortCiteRegEx": "Paulson and Edward.", "year": 1964}, {"title": "Ergodicity of approximate MCMC chains with applications to large data sets", "author": ["Pillai", "Natesh S", "Smith", "Aaron"], "venue": "arXiv preprint arXiv:1405.0182,", "citeRegEx": "Pillai et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Pillai et al\\.", "year": 2014}, {"title": "Bayes and big data: The consensus monte carlo algorithm", "author": ["Scott", "Steven L", "Blocker", "Alexander W", "Bonassi", "Fernando V", "H Chipman", "E George", "R. McCulloch"], "venue": "EFaBBayes 250 conference,", "citeRegEx": "Scott et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Scott et al\\.", "year": 2013}, {"title": "Probability inequalities for the sum in sampling without replacement", "author": ["R.J. Serfling"], "venue": "Ann. Statist., 2(1):39\u201348,", "citeRegEx": "Serfling,? \\Q1974\\E", "shortCiteRegEx": "Serfling", "year": 1974}, {"title": "Monte Carlo MCMC: efficient inference by approximate sampling", "author": ["Singh", "Sameer", "Wick", "Michael", "McCallum", "Andrew"], "venue": "In Proceedings of EMNLP-CoNLL", "citeRegEx": "Singh et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Singh et al\\.", "year": 2012}, {"title": "Variance reduction for stochastic gradient optimization", "author": ["Wang", "Chong", "Chen", "Xi", "Smola", "Alex J", "Xing", "Eric P"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "Wang et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Wang et al\\.", "year": 2013}, {"title": "Bayesian learning via stochastic gradient Langevin dynamics", "author": ["Welling", "Max", "Teh", "Yee W"], "venue": "In Proceedings of ICML", "citeRegEx": "Welling et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Welling et al\\.", "year": 2011}, {"title": "Variance reduction techniques for digital simulation", "author": ["Wilson", "James R"], "venue": "American Journal of Mathematical and Management Sciences,", "citeRegEx": "Wilson and R.,? \\Q1984\\E", "shortCiteRegEx": "Wilson and R.", "year": 1984}, {"title": "Efficient multicore collaborative filtering", "author": ["Wu", "Yao", "Yan", "Qiang", "Bickson", "Danny", "Low", "Yucheng", "Yang", "Qing"], "venue": "In ACM KDD CUP workshop,", "citeRegEx": "Wu et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Wu et al\\.", "year": 2011}, {"title": "Distributed context-aware bayesian posterior sampling via expectation propagation", "author": ["M. Xu", "Y.W. Teh", "J. Zhu", "B. Zhang"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "Xu et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Xu et al\\.", "year": 2014}, {"title": "i.i.d. assumption for rewards from each arm was used only in Lemma 3 to provide Chernoff\u2019s bound and Hoeffding\u2019s bound", "author": ["Jamieson"], "venue": "As noted in Sec. 6 of Hoeffding", "citeRegEx": "Jamieson,? \\Q1963\\E", "shortCiteRegEx": "Jamieson", "year": 1963}, {"title": "\u2200i, Theorem 2 in Jamieson et al. (2014) applies to adapted lil\u2019UCB with modification 1 and 2 only", "author": ["N i"], "venue": null, "citeRegEx": "\u2264,? \\Q2014\\E", "shortCiteRegEx": "\u2264", "year": 2014}], "referenceMentions": [{"referenceID": 24, "context": "For example, distributed algorithms have been used to sample a model with a large number of discrete variables (Newman et al., 2009; Bratires et al., 2010; Wu et al., 2011), smart transition kernels were described for Markov chain Monte Carlo (MCMC) algorithms to sample efficiently a single variable", "startOffset": 111, "endOffset": 172}, {"referenceID": 8, "context": "For example, distributed algorithms have been used to sample a model with a large number of discrete variables (Newman et al., 2009; Bratires et al., 2010; Wu et al., 2011), smart transition kernels were described for Markov chain Monte Carlo (MCMC) algorithms to sample efficiently a single variable", "startOffset": 111, "endOffset": 172}, {"referenceID": 34, "context": "For example, distributed algorithms have been used to sample a model with a large number of discrete variables (Newman et al., 2009; Bratires et al., 2010; Wu et al., 2011), smart transition kernels were described for Markov chain Monte Carlo (MCMC) algorithms to sample efficiently a single variable", "startOffset": 111, "endOffset": 172}, {"referenceID": 19, "context": "with a large or even infinite state space (Li et al., 2014; Kalli et al., 2011).", "startOffset": 42, "endOffset": 79}, {"referenceID": 16, "context": "with a large or even infinite state space (Li et al., 2014; Kalli et al., 2011).", "startOffset": 42, "endOffset": 79}, {"referenceID": 28, "context": "A common approach to address the big data problem is divide-and-conquer that uses parallel or distributed computing resources to process data in parallel and then synchronize the results periodically or merely once in the end (Scott et al., 2013; Medlar et al., 2013; Xu et al., 2014).", "startOffset": 226, "endOffset": 284}, {"referenceID": 22, "context": "A common approach to address the big data problem is divide-and-conquer that uses parallel or distributed computing resources to process data in parallel and then synchronize the results periodically or merely once in the end (Scott et al., 2013; Medlar et al., 2013; Xu et al., 2014).", "startOffset": 226, "endOffset": 284}, {"referenceID": 35, "context": "A common approach to address the big data problem is divide-and-conquer that uses parallel or distributed computing resources to process data in parallel and then synchronize the results periodically or merely once in the end (Scott et al., 2013; Medlar et al., 2013; Xu et al., 2014).", "startOffset": 226, "endOffset": 284}, {"referenceID": 0, "context": "The stochastic gradient Langevin dynamics (SGLD) (Welling & Teh, 2011) and its extensions (Ahn et al., 2012; Chen et al., 2014; Ding et al., 2014) introduced efficient proposal distributions based on subsampled data.", "startOffset": 90, "endOffset": 146}, {"referenceID": 10, "context": "The stochastic gradient Langevin dynamics (SGLD) (Welling & Teh, 2011) and its extensions (Ahn et al., 2012; Chen et al., 2014; Ding et al., 2014) introduced efficient proposal distributions based on subsampled data.", "startOffset": 90, "endOffset": 146}, {"referenceID": 11, "context": "The stochastic gradient Langevin dynamics (SGLD) (Welling & Teh, 2011) and its extensions (Ahn et al., 2012; Chen et al., 2014; Ding et al., 2014) introduced efficient proposal distributions based on subsampled data.", "startOffset": 90, "endOffset": 146}, {"referenceID": 17, "context": "Another line of research on approximate subsampled MH algorithms does not ignore the rejection step but controls the error with an approximate rejection step based on a subset of data (Korattikara et al., 2014; Bardenet et al., 2014).", "startOffset": 184, "endOffset": 233}, {"referenceID": 4, "context": "Another line of research on approximate subsampled MH algorithms does not ignore the rejection step but controls the error with an approximate rejection step based on a subset of data (Korattikara et al., 2014; Bardenet et al., 2014).", "startOffset": 184, "endOffset": 233}, {"referenceID": 12, "context": "That idea has also been extended to slice sampling (DuBois et al., 2014) and Gibbs for binary variables (Korattikara et al.", "startOffset": 51, "endOffset": 72}, {"referenceID": 17, "context": ", 2014) and Gibbs for binary variables (Korattikara et al., 2014).", "startOffset": 39, "endOffset": 65}, {"referenceID": 17, "context": "3 provides a unified framework for subsampling-based discrete sampling, MH (Korattikara et al., 2014; Bardenet et al., 2014) and slice sampling (DuBois et al.", "startOffset": 75, "endOffset": 124}, {"referenceID": 4, "context": "3 provides a unified framework for subsampling-based discrete sampling, MH (Korattikara et al., 2014; Bardenet et al., 2014) and slice sampling (DuBois et al.", "startOffset": 75, "endOffset": 124}, {"referenceID": 12, "context": ", 2014) and slice sampling (DuBois et al., 2014) algorithms as discussed in Sec.", "startOffset": 27, "endOffset": 48}, {"referenceID": 15, "context": "The lil\u2019UCB algorithm (Jamieson et al., 2014) maintains an upper confidence bound (UCB) of \u03bci that is inspired by the law of the iterated logarithm (LIL) for every arm.", "startOffset": 22, "endOffset": 45}, {"referenceID": 15, "context": "The lil\u2019UCB algorithm (Jamieson et al., 2014) maintains an upper confidence bound (UCB) of \u03bci that is inspired by the law of the iterated logarithm (LIL) for every arm. At each iteration, it draws a single sample from the arm with the highest bound and updates it. The algorithm terminates when some arm is sampled much more often than all the other arms. We refer readers to Fig. 1 of Jamieson et al. (2014) for details.", "startOffset": 23, "endOffset": 409}, {"referenceID": 15, "context": "The lil\u2019UCB algorithm (Jamieson et al., 2014) maintains an upper confidence bound (UCB) of \u03bci that is inspired by the law of the iterated logarithm (LIL) for every arm. At each iteration, it draws a single sample from the arm with the highest bound and updates it. The algorithm terminates when some arm is sampled much more often than all the other arms. We refer readers to Fig. 1 of Jamieson et al. (2014) for details. The time complexity for t iterations is O(log(D)t). It was shown in Jamieson et al. (2014) that lil\u2019UCB achieved the optimal sample complexity up to constants.", "startOffset": 23, "endOffset": 513}, {"referenceID": 15, "context": "2 of Jamieson et al. (2014) with additional properties as shown in the following proposition with proof in Appx.", "startOffset": 5, "endOffset": 28}, {"referenceID": 15, "context": "Theorem 2 of Jamieson et al. (2014) holds for the adapted lil\u2019UCB algorithm.", "startOffset": 13, "endOffset": 36}, {"referenceID": 15, "context": "Theorem 2 of Jamieson et al. (2014) holds for the adapted lil\u2019UCB algorithm. Moreover T (t) i \u2264 N, \u2200i, t. Therefore, when the algorithm terminates, t = \u2211 i\u2208X T (t) i \u2264 ND. Notice that Thm. 2 of Jamieson et al. (2014) shows that t scales roughly asO(1/\u2206) with \u2206 being the mean gap and therefore t ND when the gap is large.", "startOffset": 13, "endOffset": 217}, {"referenceID": 4, "context": "Bardenet & Maillard (2013) extended the work and provided an empirical Bernstein-Serfling bound that was later used for the subsampling-based MH algorithm (Bardenet et al., 2014): for any \u03b4 \u2208 (0, 1] and any n \u2264 N , with probability 1\u2212 \u03b4, it holds that", "startOffset": 155, "endOffset": 178}, {"referenceID": 17, "context": "Korattikara et al. (2014) made such", "startOffset": 0, "endOffset": 26}, {"referenceID": 17, "context": "A of Korattikara et al. (2014). Corollary 4.", "startOffset": 5, "endOffset": 31}, {"referenceID": 31, "context": "In the Bayesian inference experiment where the factor fn(X = i) = p(yn|X = i), we adopt a similar approach as Wang et al. (2013) and take the Taylor expansion of li,n around a reference point \u0177 as", "startOffset": 110, "endOffset": 129}, {"referenceID": 3, "context": "For algorithms depending on a reward bound C in order to get a tight bound for li,n \u2212 hi,n it requires a more restrictive condition for C as in Bardenet et al. (2015) and we might end up with an even more conservative strategy in general cases.", "startOffset": 144, "endOffset": 167}, {"referenceID": 1, "context": "2 is similar to UCB-Normal in Auer et al. (2002) but the latter assumes a normal distribution for individual rewards and will perform poorly when it does not hold.", "startOffset": 30, "endOffset": 49}, {"referenceID": 3, "context": "3 are based on subsampling-based MH algorithms in Bardenet et al. (2014); Korattikara et al.", "startOffset": 50, "endOffset": 73}, {"referenceID": 3, "context": "3 are based on subsampling-based MH algorithms in Bardenet et al. (2014); Korattikara et al. (2014). The proposed algorithm extends those ideas from MH to discrete sampling.", "startOffset": 50, "endOffset": 100}, {"referenceID": 3, "context": "3 are based on subsampling-based MH algorithms in Bardenet et al. (2014); Korattikara et al. (2014). The proposed algorithm extends those ideas from MH to discrete sampling. In fact, let x and x\u2032 be the current and proposed value in an MH iteration, Racing-EBS and Racing-Normal reduce to the algorithms in Bardenet et al. (2014) and Korattikara et al.", "startOffset": 50, "endOffset": 330}, {"referenceID": 3, "context": "3 are based on subsampling-based MH algorithms in Bardenet et al. (2014); Korattikara et al. (2014). The proposed algorithm extends those ideas from MH to discrete sampling. In fact, let x and x\u2032 be the current and proposed value in an MH iteration, Racing-EBS and Racing-Normal reduce to the algorithms in Bardenet et al. (2014) and Korattikara et al. (2014) respectively if we set", "startOffset": 50, "endOffset": 360}, {"referenceID": 3, "context": "The difference with Bardenet et al. (2014) is that we distribute the error \u03b4 evenly across t in Eq.", "startOffset": 20, "endOffset": 43}, {"referenceID": 3, "context": "The difference with Bardenet et al. (2014) is that we distribute the error \u03b4 evenly across t in Eq. 7 while Bardenet et al. (2014) set \u03b4t = (p \u2212 1)/(p(T ))\u03b4 with p a free parameter.", "startOffset": 20, "endOffset": 131}, {"referenceID": 3, "context": "The difference with Bardenet et al. (2014) is that we distribute the error \u03b4 evenly across t in Eq. 7 while Bardenet et al. (2014) set \u03b4t = (p \u2212 1)/(p(T ))\u03b4 with p a free parameter. The differences with Korattikara et al. (2014) are that we take a doubling schedule for m and replace the t-test with the normal assumption.", "startOffset": 20, "endOffset": 229}, {"referenceID": 3, "context": "The difference with Bardenet et al. (2014) is that we distribute the error \u03b4 evenly across t in Eq. 7 while Bardenet et al. (2014) set \u03b4t = (p \u2212 1)/(p(T ))\u03b4 with p a free parameter. The differences with Korattikara et al. (2014) are that we take a doubling schedule for m and replace the t-test with the normal assumption. We find that our algorithms are more efficient and robust than both original algorithms in practice. Moreover, the binary Gibbs sampling in Appx. F of Korattikara et al. (2014) is also a special case of RacingNormal with D = 2.", "startOffset": 20, "endOffset": 500}, {"referenceID": 3, "context": "The difference with Bardenet et al. (2014) is that we distribute the error \u03b4 evenly across t in Eq. 7 while Bardenet et al. (2014) set \u03b4t = (p \u2212 1)/(p(T ))\u03b4 with p a free parameter. The differences with Korattikara et al. (2014) are that we take a doubling schedule for m and replace the t-test with the normal assumption. We find that our algorithms are more efficient and robust than both original algorithms in practice. Moreover, the binary Gibbs sampling in Appx. F of Korattikara et al. (2014) is also a special case of RacingNormal with D = 2. Therefore, Alg. 1 provides a unifying approach to a family of subsampling-based samplers. The variance reduction technique is similar to the proxies in Bardenet et al. (2015), but the control variate here is a function in the data space while the proxy in the latter is a function in the parameter space.", "startOffset": 20, "endOffset": 726}, {"referenceID": 12, "context": "We set the scale parameter of adapted lil\u2019UCB with C/2 and other parameters with the heuristic setting in Jamieson et al. (2014). Racing uses the pairwise variance estimate.", "startOffset": 106, "endOffset": 129}, {"referenceID": 3, "context": "Surprisingly, Racing-Normal performs robustly regardless of reward distributions with the first mini-batch size m = 50 while it was shown in Bardenet et al. (2014) that the algorithm with the same normal assumption in Korattikara et al.", "startOffset": 141, "endOffset": 164}, {"referenceID": 3, "context": "Surprisingly, Racing-Normal performs robustly regardless of reward distributions with the first mini-batch size m = 50 while it was shown in Bardenet et al. (2014) that the algorithm with the same normal assumption in Korattikara et al. (2014) failed with LogNormal even when m = 500.", "startOffset": 141, "endOffset": 244}, {"referenceID": 30, "context": "Singh et al. (2012) addressed this problem with a conditional random field model with pairwise factors.", "startOffset": 0, "endOffset": 20}, {"referenceID": 13, "context": "We consider the MAP inference problem with fixed \u03b8 using annealed Gibbs sampling (Finkel et al., 2005).", "startOffset": 81, "endOffset": 102}, {"referenceID": 17, "context": "The Racing algorithm provides a unifying approaches to various subsampling-based Monte Carlo algorithms and also improves the robustness of the original MH algorithm in Korattikara et al. (2014). This is also the first work to discuss MABs under the setting of a finite reward population.", "startOffset": 169, "endOffset": 195}], "year": 2016, "abstractText": "Drawing a sample from a discrete distribution is one of the building components for Monte Carlo methods. Like other sampling algorithms, discrete sampling suffers from the high computational burden in large-scale inference problems. We study the problem of sampling a discrete random variable with a high degree of dependency that is typical in large-scale Bayesian inference and graphical models, and propose an efficient approximate solution with a subsampling approach. We make a novel connection between the discrete sampling and Multi-Armed Bandits problems with a finite reward population and provide three algorithms with theoretical guarantees. Empirical evaluations show the robustness and efficiency of the approximate algorithms in both synthetic and real-world large-scale problems.", "creator": "LaTeX with hyperref package"}}}