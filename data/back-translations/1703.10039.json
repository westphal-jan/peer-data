{"id": "1703.10039", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "25-Mar-2017", "title": "Cohesion-based Online Actor-Critic Reinforcement Learning for mHealth Intervention", "abstract": "In the wake of the world's large population of smart device users, mobile health technologies (mHealth) are hopeful of making a positive and comprehensive impact on people's health; they are able to provide flexible, affordable, and portable health guides to device users. Current online decision-making methods for mHealth assume that users are completely heterogeneous, do not share information among users, and learn a separate policy for each user. However, the data for each user is very limited to support separate online learning, leading to unstable strategies that contain many variations. We also find the truth that a user may be similar to some, but not all, users, and associated users tend to have similar behaviors. In this paper, we propose a network-based cohesion (actor-critic) Reinforcement Learning (RL) method for mHealth. The goal is to explore how to better share information between similar users in order to sharpen the limited information that can be shared among similar users.", "histories": [["v1", "Sat, 25 Mar 2017 23:01:20 GMT  (143kb,D)", "https://arxiv.org/abs/1703.10039v1", null], ["v2", "Wed, 23 Aug 2017 22:40:49 GMT  (148kb,D)", "http://arxiv.org/abs/1703.10039v2", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["feiyun zhu", "peng liao", "xinliang zhu", "yaowen yao", "junzhou huang"], "accepted": false, "id": "1703.10039"}, "pdf": {"name": "1703.10039.pdf", "metadata": {"source": "META", "title": "Cohesion-based Online Actor-Critic Reinforcement Learning for mHealth Intervention", "authors": ["Feiyun Zhu", "Peng Liao", "Xinliang Zhu", "Yaowen Yao", "Junzhou Huang"], "emails": [], "sections": [{"heading": null, "text": "Index Terms\u2014Actor-Critic, Reinforcement Learning, Mobile Health (mHealth) Intervention, Cohesion"}, {"heading": "1 INTRODUCTION", "text": "With billions of smart device1 users globally, it is increasingly popular among the scientist community to make use of the state-of-the-art articial intelligence and mobile health technologies to leverage supercomputers and big data to facilicate the prediction of healthcare tasks [1\u20137]. In this paper, the goal of mobile health (mHealth) is to make use of various smart devices as great platforms to collect and analyze raw data (weather, location, social activity, stress, etc.). Based on that, the aim is to provide effective intervention that helps users to change to or adapt to healthy behaviors, such as reducing the alcohol abuse\n? Feiyun Zhu, Xinliang Zhu, Yaowen Yao and Junzhou Huang are with the Department of CSE in the University of Texas at Arlington. \u2021 Feiyun Zhu and Peng Liao are with the Department of Statistics in the University of Michigan.\n1. i.e. smartphones and wearable devices, such as Fitbit Fuelband and Jawbone etc.\n[8, 9] and promoting physical activities [10]. The traditional adaptive treatment has restrictions on the time, location and frequency\u2014patients have to visit the doctor\u2019s office for treatments. Compared with them, mHealth is more affordable, portable and much more flexible in the sense that smart devices allow for the real-time collection and analysis of data as well as in-time delivery of interventions. Thus, mHealth technologies are widely used in lots of healthrelated tasks, such as physical activity [10], eating disorders [11], alcohol use [8, 9], mental illness[12, 13], obesity/weight management [14].\nFormally, the mHealth intervention is modeled as a sequential decision making (SDM) problem. It aims to learn the optimal policy to determine when, where and how to deliver the intervention [1, 3, 4] to best serve users. This is a new research topic that lacks of methodological guidance. In 2014, Lei [1] made a first attempt to formulate the mHealth intervention as an online actor-critic contextual bandit problem. Lei\u2019s method served a good starting point for the mHealth study. However, this method did not consider the important delayed effect in the SDM\u2014 the current action may influence not only the immediate reward but also the next states and, through that, all the subsequent rewards [15, 16]. Dr. Murphy [3] proposed an average reward based RL to consider the delayed effect in the mHealth. However, those two methods rely on some ideal assumptions. They either assume that all the users are completely homogenous or completely heterogeneous. We find the truth lying between those extremes: a user might be similar with some, but not all, users. Their methods are easy to bring in too much bias or too much variance. Besides, [3] is in the batch learning setting, which is different from this paper\u2019s focuses.\nRecently, Dr. Cesa-Bianchi [17] proposed a contextual bandit algorithm that considers the network information. It is for the recommendation system, which is very different from the mHealth task. Besides, there are three drawbacks making the method in [17] impractical for the mHealth: (1) Cesa-Bianchi\u2019s method focues on the bandit algorithm. It doesn\u2019t consider the important delayed effect in mHealth. (2) They assume the network information is given beforehand from the social information. The given network may not be targeted for the mHealth study. There is lots of misleading network information for the mHealth study [17\u2013 19]. (3) In their work, however, it is unable to control the amount of information shared among linked users, which is\nar X\niv :1\n70 3.\n10 03\n9v 2\n[ cs\n.L G\n] 2\n3 A\nug 2\n01 7\n2 not flexible for the mHealth study [20, 21]. In this paper, we propose a cohesion-based reinforcement learning for the mHealth and derive two algorithms. It is in an online, actor-critic setting. The aim is to explore how to share information across similar users in order to improve the performance. The main contributions of this paper are summarized as follows: (1) to the best of our knowledge, this is the first online (actor-critic) RL method for the mHealth. (2) Current evidence verifies the wide existence of networks among users [20\u201322]. We improve the online RL by considering the network cohesion among users. Such improvement makes it the first network constrained (actorcritic) RL method to the best of our knowledge. It is able to relieve the tough problem of current online decision-making methods for the mHealth by reducing variance at the cost of inducing bias. Current online RL learns a separate policy for each user. However, there are too few of samples to support the separate online learning, which leads to unsatisfactory interventions (policies) for the users. (3) Our method doesn\u2019t require the given network cohesion. We propose a method to learn the network intentionally for the mHealth study. It makes use of the warm start trajectories in the online learning, which are expected to represent the users\u2019 properties. (4) Compared with [17], the proposed method has a tuning parameter, which allows us to control how much information we should share with similar users. It is worth mentioning that our method may not be limited to mHealth. It can be applied to other health-related tasks. Extensive experiment results on the HeartSteps dataset verifies that our method can achieve clear improvement over the Separate-RL."}, {"heading": "2 PRELIMINARIES", "text": ""}, {"heading": "2.1 Markov Decision Process (MDP)", "text": "We assume the mHealth intervention is a Markov Decision Process (MDP) [23\u201326] that consists of a 5-tuple {S,A,P,R, \u03b3}, where S is the state space and A is the action space. P : S \u00d7A\u00d7S 7\u2192 [0, 1] is the state transition model in which P (s, a, s\u2032) indicates the probability of transiting from one state s to another s\u2032 after taking action a; R (s, a, s\u2032) is the corresponding immediate reward for such transition where R : S \u00d7 A \u00d7 S 7\u2192 R. For simplicity, the expected immediate rewardR (s, a) = Es\u2032\u223cP [R (s, a, s\u2032)] is assumed to be bounded over the state and action spaces. \u03b3 \u2208 [0, 1) is the discount factor that reduces the influence of future rewards. To allow for the matrix operators, the state space S and action space A are assumed to be finite, though very large in mHealth.\nThe policy of an MDP is to choose actions for any state s \u2208 S in the system [15, 24]. There are two types of policies: (1) the deterministic policy \u03c0 : S 7\u2192 A selects an action directly for the state, and (2) the stochastic policy \u03c0 : s \u2208 S 7\u2192 \u03c0 (\u00b7 | s) \u2208 P (A) chooses the action for any state s by providing s with a probability distribution over all the possible actions [23]. In mHealth, the stochastic policy is preferred due to two reasons: (a) current evidence shows that some randomness in the action is likely to draw users\u2019 interest, thus helpful to reduce the intervention burden/habituation [1, 3, 27]; (b) though some deterministic policy is theoretically optimal for the MDP, however, we do not know where it is for the large state space on the\none hand and the MDP is a simplification for the complex behavioral process on the other; some variation may be helpful to explore the system and search for a desirable policy [3]. We consider the parameterized stochastic policy, \u03c0\u03b8 (a | s), where \u03b8 \u2208 Rm is the unknown parameter. Such policy is interpretable in the sense that we could know the key features that contribute most to the policy by analyzing the estimated \u03b8\u0302, which is important to behavior scientists for the state (feature) design [1, 3].\nIn RL, value is a core concept that quantifies the quality of a policy \u03c0 [15]. There are two definitions of values: the state value and the state-action (Q-) value [28]. In mHealth, the Q-value is considered because the model (i.e. state transition and immediate reward) is assumed to be unknown, andQ-value allows for action selection without knowing the model while the state value requires the model for the action selection [26]. Formally, the Q-value Q\u03c0 (s, a) \u2208 R|S|\u00d7|A| measures the total amount of rewards an agent can obtain when starting from state s, first choosing action a and then following the policy \u03c0. Specially, the discounted reward is one of the most commonly used value measures\nQ\u03c0 (s, a) = Eai\u223c\u03c0,si\u223cP { \u221e\u2211 i=0 \u03b3iri | s0 = s, a0 = a } . (1)\nThe goal of RL is to learn an optimal policy \u03c0\u2217 that maximizes the Q-value for all the state-action pairs via interactions with the dynamic system [23]. The objective is \u03b8\u2217 = arg max\n\u03b8 J\u0302 (\u03b8), where\nJ\u0302 (\u03b8) = \u2211 s\u2208S dref (s) \u2211 a\u2208A \u03c0\u03b8 (a | s)Q\u03c0\u03b8 (s, a) (2)\nand dref (s) is the reference distribution of states (e.g. the distribution of initial states); Q\u03c0\u03b8 is the value for the policy \u03c0\u03b8 . According to (2), we have to learn the Q\u03c0\u03b8 for all the state-action pairs to determine the objective (2) and, after then, to improve the policy. Thus in this paper, we employ the actor-critic algorithm. It is an alternating updating algorithm between two steps untill convergence. At each iteration, the critic updating estimates the Q-value function (i.e. policy evaluation, cf. Section 2.2 and 2.3) for the lastest policy; the actor updating (i.e. policy improvement, cf. Section 2.4) learns a better policy based on the newly estimated Q-value. Moreover, the actor-critic algorithm has great properties of quick convergence with low variance and learning continuous policies [24]."}, {"heading": "2.2 Bellman Equation and Q-value Estimation", "text": "It is well known that due to the Markovian property, the Q-value satisfies the linear Bellman equation [29] for any policy \u03c0:\nQ\u03c0 (s, a) = R (s, a) + \u03b3 \u2211 s\u2032\u2208S P (s, a, s\u2032) \u2211 a\u2032\u2208A \u03c0 (a\u2032 | s\u2032)Q\u03c0 (s\u2032, a\u2032) .\nIt has the matrix form as\nq\u03c0 = r + \u03b3P\u03a0\u03c0q \u03c0, (3)\nwhere q\u03c0 and r are vectors both with |S| |A| elements; P \u2208 R|S||A|\u00d7|S| is the stochastic state transition matrix, in which P ((s, a) , s\u2032) = P (s, a, s\u2032); \u03a0\u03c0 \u2208 R|S|\u00d7|S||A| is\n3 the stochastic policy matrix, where \u03a0\u03c0 (s, (s, a)) = \u03c0 (a | s) [26]. Once both the reward and the state transition models are given [30], it is easy to obtain the analytical solution as q\u03c0 = (I\u2212 \u03b3P\u03a0\u03c0)\u22121 r.\nHowever, there are two factors making it impossible to have the analytical solution for the Q-value estimation: (a) in mHealth, both reward r and state transition P (i.e. P) models are unknown. (b) the state space in mHealth is usually very large or even infinite, which makes it impossible to directly learn the Q-value due to lack of observations for sharper learning and too high storage requirements, i.e. O (|S| |A|) to only store the Q-value table. We resolve these problems via the parameterized function approximation, which assumes that Q\u03c0 is in a low dimensional space: Q\u03c0 \u2248 Qw = w\u1d40x (s, a), where w \u2208 Ru is the unknown variable and x (s, a) is a feature processing step that combines information in the state and action. We then learn the value Qw from observations via a supervised learning paramdigm, which, however, is much more challenging than the general supervised learning since the Q-value is not directly observed [23]. As a direct solution, the Monte Carlo (MC) method draws very deep trajectories to obtain the observation of actualQ value. Although MC can provide an unbiased estimation of Qw, it is not suitable for mHealth since MC can\u2019t learn from the incomplete trajectory [15]. Such case requires massive sampling from users, which, however, is very labor-intensive and expensive in time. As a central idea of RL [15], the temporal-difference (TD) learning is able to make use of the Bellman equation (3) and to learn the value from the incomplete trajectories. The learned result of TD has the property of low variance.\n2.3 The critic updating: Least-Squares TD for Q-value (LSTDQ) Estimation\nIn mHealth, though the data for all users is abundant, the data for each user is limited in size. We employ the least-square TD for the Q-value (LSTDQ) estimation, due to its advantage of efficient use of samples over the pure temporal-difference algorithms [26, 31]. The goal of LSTDQ is to learn a Qw to approximately satisfy the Bellman equation (3), by minimizing the TD error [30] as\nw = h\u0302 = min h\u2208RK \u2225\u2225X\u0304\u1d40h\u2212 (r\u0304 + \u03b3P\u03a0\u03c0X\u0304\u1d40w)\u2225\u22252D , (4) where w = h\u0302 is a fixed point problem and h\u0302 is a function of w; X\u0304 is a designed matrix consisting of all the state and action pairs in the MDP; D describes the distributions over the state and action pairs.\nSince the state transition P is unknown and X\u0304 is too large to form in mHealth, we can not directly solve (4). Instead, we have to make use of the trajectories collected from N users, i.e. D = {Dn}Nn=1, where Dn = {Ui = (si, ai,ri, s\u2032i) | i = 0, \u00b7 \u00b7 \u00b7 , t} summarizes all the t + 1 tuples for the n-th user and Ui is the i-th tuple in Dn.\nCurrent online contextual bandit (i.e. a special RL with \u03b3 = 0) methods for mHealth assume that all users are completely heterogeneous. They share no information and run a separate algorithm for each user [1]. Following this\nidea, we extend [1] to the separate RL setting. The objective for the n-th user is defined as\nwn = h\u0302n = arg min hn \u2211 Ui\u2208Dn \u2016x\u1d40i hn \u2212 (ri + \u03b3y \u1d40 iwn)\u2016 2 2 (5)\nfor n \u2208 {1, \u00b7 \u00b7 \u00b7 , N}, where xi = x (si, ai) is the value feature at time i and yi = \u2211 a\u2032\u2208A x (s \u2032 i, a \u2032)\u03c0\u03b8 (a\n\u2032 | s\u2032i) is the value feature at the next time point. For the sake of easy derivation, we define the following matrices to store the actual observations\nXn = [x (s1, a1) ,x (s2, a2) \u00b7 \u00b7 \u00b7 ,x (st, at)] \u2208 Ru\u00d7t Yn = [y (s \u2032 1; \u03b8n) , \u00b7 \u00b7 \u00b7 ,y (s\u2032t; \u03b8n)] \u2208 Ru\u00d7t (6)\nrn = [r1, r2, \u00b7 \u00b7 \u00b7 , rt]\u1d40 \u2208 Rt,\nwhere u is the length of the sample feature for the Q-value approximation, t is the current time point in the online RL learning procedure (i.e. the current trajectory length), y (s\u2032i; \u03b8n) = \u2211 a\u2032\u2208A x (s \u2032 i, a \u2032)\u03c0\u03b8n (a\n\u2032 | s\u2032i), and \u03c0\u03b8n (a | s) is the policy for the n-th user. Let R = [r1, \u00b7 \u00b7 \u00b7 , rN ] \u2208 Rt\u00d7N store the reward of all N users at all the t time points. To prevent the overfitting when t is small at the beginning of online RL learning, the `2 norm based constraint is considered in the objective as follows\nwn = h\u0302n = arg min hn \u2016X\u1d40nhn \u2212 (rn + \u03b3Y\u1d40nwn)\u2016 2 2 + \u03b6c \u2016hn\u2016 2 2 (7) for n \u2208 {1, \u00b7 \u00b7 \u00b7 , N}. The LSTDQ provides a closed-form solution\nw\u0302\u03b8n = [Xn (Xn \u2212 \u03b3Yn) \u1d40 + \u03b6I] \u22121 Xnrn, (8)\nfor {n}Nn=1, where w\u0302\u03b8n is a function of the policy parameter \u03b8n."}, {"heading": "2.4 The actor updating for policy improvement", "text": "In mHealth, the reference distribution of states dref (s) is unknown and hard to estimate due to the lack of samples. We set dref (s) as the empirical distribution of states. Accordingly, the observations in the trajectory, i.e. Dn, are used to form the objective for the actor updating \u03b8\u0302n = arg max\n\u03b8n J\u0302 (\u03b8n), where\nJ\u0302 (\u03b8n) = 1 |Dn| \u2211 si\u2208Dn \u2211 a\u2208A Q (si, a; w\u0302\u03b8n)\u03c0\u03b8n(a|si)\u2212 \u03b6a 2 \u2016\u03b8n\u201622 (9) for n \u2208 {1, \u00b7 \u00b7 \u00b7 , N}. Here \u2016\u03b8n\u201622 is the constraint to make (9) a well-posed problem and \u03b6a is the tuning parameter that controls the strength of the smooth penalization [1]. We use J\u0302 (\u03b8n) rather than J (\u03b8n) in (9) to indicate that the objective function for the actor updating is defined based on the Qvalue estimation.\nSince the critic updating results in a closed-form solution (8), we could substitute the expression (8) into the objective for the actor updating (9). Such case, however, leads to a very complex optimization problem. In the case of large feature space, one can recursively update w\u0302\u03b8 and \u03b8\u0302n to reduce the computational cost.\n4"}, {"heading": "3 NETWORK COHESION BASED ONLINE ACTORCRITIC RL", "text": "It is a famous phenomenon observed in lots of social behavior studies [32, 33] that people are widely connected in a network and linked users tend to have similar behaviors. Advances in social media help a lot to record the relational information among users, which ensures the availability of network information for health-related studies. Besides, individuals are widely connected due to the similar features, such as age, gender, race, religion, education level, work, income, other socioeconomic status, medical records and genetics features etc [22]. However, for simple study, current online methods for the mHealth simply assume that users are completely different; they share no information among users and learn a separate RL for each user by only using his or her data. Such assumption works well in the ideal condition where the sample drawn from each user is large in size to support the separate online learning. However, though the data for all users is abundant, the data for each user is limited in size. For example at the beginning of online learning, there are t = 5 tuples, which is hardly enough to support a separate learning and likely to result in unstable policies. From the perspective of optimization, the problem of lack of samples badly affects the actor-critic updating not only at the beginning of online learning but also along the whole learning process. This is because the actor-critic objective functions are non-convex and nonlinear; the bad solution at the beginning of online learning would bias the optimization to sub-optimal directions. Besides, the policy achieved at the early stage of online learning is of bad user experience, which is likely for the users to be inactive with or even to abandon the mHealth.\nDifferent from current methods, we consider the phenomenon that a user is similar to some (but not all) users, and similar users behave similar but not completely identical to each other. To this end, we propose a cohesionbased online RL method for the mHealth study. We aim to understand how to share information across similar users in order to improve the performance."}, {"heading": "3.1 Construct the network cohesion by using the warm start trajectory (WST)", "text": "We assume there is an undirected network cohesion connecting similar users, i.e. G = (V, E), where V = {1, 2, \u00b7 \u00b7 \u00b7 , N} is the set of nodes (representing users) and E \u2282 V \u00d7 V is the edge set. Altough advanced social medias, like Facebook, Twitter and Linkedin, could provide us ith various network information, they are not designed for the mHealth. There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343]. Thus, we want to learn the network cohesion intentionally for the mHealth by measuring the similarities between the related behaviors of users.\nIn RL, the MDP provides a mathematical tool to describe the property of users in a specific mHealth study2. By measuring the similarities among the users\u2019 MDPs , we could\n2. The MDPs of one user on two diverse mHealth studies should be very different; for example, the MDP in the HeartSteps study [44] for one user should be different from that in the alcohol control [8, 9] study.\nlearn the network cohesion targeted to that mHealth study. However, the MDP models are unknown to the RL problem. Instead, the warm start trajectories (WSTs) of all the N users are available, which provide the observation of users. Thus, we use the WSTs for the graph learning, i.e. D(0) ={ D(0)n | n = 1, \u00b7 \u00b7 \u00b7 , N } , where D(0)n = {(si,n, ai,n,ri,n)}T0i=1 is the WST for the n-th user. Since an MDP consists of the state transistion and immediate reward model, the feature for the cohesion network learning is constructed by stacking the states and rewards in the WST as follows\nvn = [ s\u1d401,n, r1,n, \u00b7 \u00b7 \u00b7 , s \u1d40 T0,n , rT0,n ]\u1d40 \u2208 RpT0+T0 , (10)\nfor n \u2208 {1, \u00b7 \u00b7 \u00b7 , N}. Note that the action or policy is not part of an MDP. To reduce the influence of random actions in the WST, we get rid of the temporal order by sorting all the elements in vn (10). Then the benchmark method, i.e. Knearest neighbor (KNN), is used to learn the neighboring information among users\ncij = { 1, if vi \u2208 N (vj) or vj \u2208 N (vi) 0, otherwise , (11)\nwhere vi \u2208 N (vj) indicates that i-th node is the KNN of the j-th node [45]; (11) is an undirected Graph. The value of K controls how widely the users are connected. A large K indicates a wide connection among users and vice versa."}, {"heading": "3.2 Model of cohesion based Actor-Critic RL", "text": "The underlying assumption throughout this paper is that if two users are connected, their values and policies are constrained to be similar, e.g. \u2016wi \u2212wj\u2016 and \u2016\u03b8i \u2212 \u03b8j\u2016 are small if i \u2194 j [43, 46]. With the network cohesion C = (cij)N\u00d7N , the objective function for the critic updating is formed as follows\nW = H\u0302 = argmin H N\u2211 n=1 \u2211 Ui\u2208Dn \u2016x\u1d40i hn \u2212 (ri + \u03b3y \u1d40 i wn)\u2016 2 2 (12)\ns.t. N\u2211\ni,j=1\ncijd (hi,hj) \u2264 \u03b41 and N\u2211\ni,j=1\ncijd (wi,wj) \u2264 \u03b42,\nwhere H = [h1, \u00b7 \u00b7 \u00b7 ,hN ] \u2208 Ru\u00d7N and W = [w1, \u00b7 \u00b7 \u00b7 ,wN ] \u2208 Ru\u00d7N are designed matrices that consist of all the N users\u2019 variables (each column summarizes the unknown varibile of one user); d (hi,hj) is a distance measure between two vectors; usually we set d (\u00b7, \u00b7) as the Euler distance. With the matrix notations in Section 2.3, we turn (12) into the following two-level nested optimization problems\nH\u0302= arg min H ( N\u2211 n=1 \u2016X\u1d40nhn \u2212 (rn + \u03b3Y\u1d40nwn)\u2016 2 2 + (13)\n\u00b51 N\u2211 i,j=1 cij \u2016hi \u2212 hj\u201622 + \u03b61 N\u2211 n=1 \u2016hn\u201622\n) ,\nW\u0302= arg min W ( N\u2211 n=1 \u2225\u2225\u2225\u03a6nwn \u2212 \u03a6nh\u0302n\u2225\u2225\u22252 2 + (14)\n\u00b52 N\u2211 i,j=1 cij \u2016wi \u2212wj\u201622 + \u03b62 N\u2211 n=1 \u2016wn\u201622\n) ,\n5 where \u03a6n is a designed matrix to facilitate the optimization of (14). The 1st level (13) projects the Bellman image onto a linear space (we refer (13) as the projection step); the 2nd level (14) deals with the fixed point problem (i.e. the fixedpoint step) [47].\nThe objective for the actor updating is defined as follows{ \u03b8\u03021, \u00b7 \u00b7 \u00b7 , \u03b8\u0302n, \u00b7 \u00b7 \u00b7 , \u03b8\u0302N } = arg max\n{\u03b8n}Nn=1 J\u0302 (\u03b81, \u00b7 \u00b7 \u00b7 , \u03b8N ) , (15)\nwhere \u0398 = [\u03b81, \u00b7 \u00b7 \u00b7 , \u03b8N ], Q (si, a; w\u0302\u03b8n) = x (si, a) T w\u0302\u03b8n is the estimated value for the n-th policy \u03c0\u03b8n and\nJ\u0302 (\u0398)= N\u2211 n=1  1 |Dn| \u2211 Ui\u2208Dn \u2211 a\u2208A Q (si, a; w\u0302\u03b8n)\u03c0\u03b8n(a|si)  \u2212 \u00b53\n2 N\u2211 i,j=1 cij \u2016\u03b8i \u2212 \u03b8j\u201622 \u2212 \u03b63 2 N\u2211 n=1 \u2016\u03b8n\u201622 . (16)\nAlthough we are able to obtain a closed-form solution for the critic updating (12), to reduce the computational costs, we substitute the solution in value for {w\u0302n}Nn=1 rather than the closed-form expression of {w\u0302\u03b8n} N n=1 into the actor updating. The actor updating algorithm performs the maximization of (16) over \u0398, which is computed via the Sequential Quadratic Programming (SQP) algorithm. We use the implementation of SQP with finite-difference approximation to the gradient in the FMINCON function of Matlab.\nIn the objectives (13), (14) and (16), \u00b51, \u00b52 and \u00b53 are the tuning parmaters to control the strength of the network cohesion constraints. It is an advantage of our methods over the network based bandit [17]. When \u00b51, \u00b52, \u00b53 \u2192 \u221e, the connected users are enforced to have identical values and policies. When \u00b51, \u00b52, \u00b53 = 0, there is no network cohesion constraint. In such case, our method is equivalent to the separate online RL method. Compared with the Separate-RL, the model complexity of our methods is reduced since their parameter domain is constrained via the network cohesion regularization. Such case ensures our methods to work well when the sample size is small. However, the optimization of our method is much more complex than that of the separateRL. The updating rules of all the users are independent with each other in the separate-RL; while in our method, the optimization of all the users is all coupled together. In the following section, two actor-critic RL algorithms are proposed to deal the objectives (13) and (14)."}, {"heading": "4 ALGORITHM#1 FOR THE CRITIC UPDATE", "text": "4.1 Updating Rules for the Projection Step (13)\nWe first discuss how to minimize the objective for the projection step. The objective is J= N\u2211 n=1 \u2016X\u1d40nhn\u2212(rn+\u03b3Y\u1d40nwn)\u2016 2 2+\u00b51Tr (HLH \u1d40)+\u03b61 \u2016H\u20162F , (17) where \u2016\u00b7\u20162F is the Frobenius norm of a matrix,\nTr (HLH\u1d40) = N\u2211 i=1 N\u2211 j=1 cij \u2016hi \u2212 hj\u201622 (18)\nAlgorithm 1 Two online actor-critic algorithms for the Cohesion-RL Input: T, T0, \u00b5{1,2,3}, \u03b6{1,2,3}, nAlg (i.e. the algorithm index).\n1: Initialize the states (st,n)p\u00d7N , where t = 0, and the policy parameters \u0398 = [\u03b81, \u00b7 \u00b7 \u00b7 , \u03b8N ] \u2208 Rm\u00d7N for N users. 2: for n = 1, \u00b7 \u00b7 \u00b7 , N do 3: for t = 1, \u00b7 \u00b7 \u00b7 , T do 4: At time point t, observe context st,n for the n-th user. 5: Draw an action at,n according to the policy \u03c0\u03b8\u0302n(a|st,n). 6: Observe an immediate reward rt,n. 7: end for 8: if t = T0 then 9: Construct the network cohesion via (10), (11). 10: else if t \u2265 T0 then 11: Data preparation and feature construction (6) for the critic update and the actor update. 12: if nAlg = 1 then 13: Critic update to learn W\u0302t (value parameter) via (24). 14: else if nAlg = 2 then 15: Critic update to learn W\u0302t (value parameter) via (26). 16: end if 17: Actor update to learn \u0398\u0302t (policy paramter) via (15). 18: end if 19: end for Output: the policy for N users, i.e. \u03c0\u03b8\u0302n (a | s), for {n} N n=1.\nand L = D \u2212 C \u2208 RN\u00d7N is a graph laplacian; D is a diagonal matrix whose elements are column (or row, as C is a symmetric matrix) sums of C, i.e. dii = \u2211 i cij . The partial derivative of J1, i.e. the 1st term in (17), with respect to hn is\n\u2202J1 \u2202hn = 2XnX \u1d40 nhn \u2212 2Xnrn \u2212 2\u03b3XnY\u1d40nwn. (19)\nSummarizing the partial derivatives with respect to all the variables in H = (h1, \u00b7 \u00b7 \u00b7 ,hN ) \u2208 RK\u00d7N , we have\n\u2202J1 \u2202vec (H) = 2 ( N\u2211 n=1 En \u2297 (XnX\u1d40n) ) vec (H)\n\u2212 2 (\nN\u2211 n=1 En \u2297Xn\n) vec (R)\n\u2212 2\u03b3 (\nN\u2211 n=1 En \u2297 (XnY\u1d40n) ) vec (W) (20)\nwhere vec (H) = [h\u1d401, \u00b7 \u00b7 \u00b7 ,h \u1d40 N ] \u1d40 \u2208 RuN is the vectorization process for a matrix; En = diag (0, \u00b7 \u00b7 \u00b7 , 1, \u00b7 \u00b7 \u00b7 , 0) \u2208 RN\u00d7N is a diagonal matrix with the n-th diagonal element equal to 1, all the other equal to zero; \u2297 indicates the Kronecker product between two matrices resulting in a block matrix. Let F1 = \u2211 nEn \u2297 (XnX\u1d40n), F2 = \u2211 nEn \u2297Xn and F3 =\n6\u2211 nEn \u2297 (XnY\u1d40n). We have a simpler formulation for the \u2202J1/\u2202vec (H) as follows\n\u2202J1 \u2202vec (H)\n= 2F1vec (H)\u2212 2 [F2vec (R) + \u03b3F3vec (W)] . (21)\nThe partial derivatives of the 2nd term in (17), i.e. J2 = \u00b51Tr (HLH\u1d40) + \u03b61 \u2016H\u20162F , with respect to H is\n\u2202J2 \u2202H = 2\u00b51HL + 2\u03b61H.\nAccording to the Encapsulating Sum [48], we have\n\u2202J2 \u2202vec (H) = 2 [(\u00b51L \u1d40 + \u03b61IN )\u2297 Iu] vec (H) (22)\nwhere IN \u2208 RN\u00d7N and Iu \u2208 Ru\u00d7u are identical matrices. Setting the gradient of J in (17) with respect to vec (H) to zero gives the closed-form solution for the projection step as follows\nvec ( H\u0302 ) = [F1 + L\u2297 (\u00b51, \u03b61)] \u22121\n[F2vec (R) + \u03b3F3vec (W)] , (23)\nwhere L\u2297 (\u00b51, \u03b61) = (\u00b51L\u1d40 + \u03b61IN )\u2297 Iu \u2208 RuN\u00d7uN .\n4.2 Updating Rules for the Fixed Point step (14) Considering the 1st term in the fixed point step (14) gives O1 = \u2211 n \u2225\u2225\u2225\u03a6nwn \u2212 \u03a6nh\u0302n\u2225\u2225\u22252 2 = \u2225\u2225\u2225\u03a6\u2297vec (W)\u2212 \u03a6\u2297vec(H\u0302)\u2225\u2225\u22252 2\nwhere \u03a6\u2297 = (\u2211N n=1 En \u2297 \u03a6n ) . To facilitate the optimization, we design {\u03a6n}Nn=1 to let \u03a6\u2297 = F1+L\u2297 (\u00b51, \u03b61), which leads to\nO1 = \u2225\u2225\u2225\u03a6\u2297vec (W)\u2212 \u03a6\u2297vec(H\u0302)\u2225\u2225\u22252\n2\n= \u2016\u03a6\u2297vec (W)\u2212 [F2vec (R) + \u03b3F3vec (W)]\u2016 = \u2016(\u03a6\u2297 \u2212 \u03b3F3) vec (W)\u2212 F2vec (R)\u201622 ,\nand finally results in an easy solution for the critic updating (24) (cf. Theorem 1). Letting P = \u03a6\u2297 \u2212 \u03b3F3, we have\nO1 = \u2016Pvec (W)\u2212 F2vec (R)\u201622 .\nThe partial derivative of O1 with respect to vec (W) is\n\u2202O1 \u2202vec (W) = 2P\u1d40Pvec (W)\u2212 2P\u1d40F2vec (R) .\nConsidering the partial derivative of the cohesion constraint and the Frobenius norm based smooth constraint with respect to vec (H), and setting the overll partial derivative to zero, i.e. \u2202O/\u2202vec (W) = 0, we can obtain the following closed-form solution\nvec (W\u2217) = [P\u1d40P + L\u2297 (\u00b52, \u03b62)] \u22121 P\u1d40F2vec (R) , (24)\nwhere L\u2297 (\u00b52, \u03b62) = (\u00b52L\u1d40 + \u03b62IN )\u2297 Iu.\nTheorem 1. B = P\u1d40P + L\u2297 (\u00b52, \u03b62) is a symmetric and positive definite matrix, which leads to an easy critic updating rule in (24).\nLemma 2. Suppose that A \u2208 Rn\u00d7n and B \u2208 Rm\u00d7m are square matrices. Let \u03bb1, \u00b7 \u00b7 \u00b7 , \u03bbn be the eigenvalues of A and \u03bd1, \u00b7 \u00b7 \u00b7 , \u03bdm\nbe those of B. Then the eigenvalues of A \u2297 B [49], where \u2297 is the Kronecker Product, are\n\u03bbi\u03bdj , for i \u2208 {1, \u00b7 \u00b7 \u00b7 , n} , j \u2208 {1, \u00b7 \u00b7 \u00b7 ,m} ."}, {"heading": "5 ALGORITHM#2 FOR THE CRITIC UPDATE", "text": "In this section, we provide another updating rule for the critic update (i.e. policy improvement). Note that to prevent the overfitting when the sample size is very small, the conventional LSTDQ usually employs the `2 constraint on the variable H in the projection step. They do not put the `2 constraint on the fixed-point variable W [30, 47]. Following this idea, we have a simpler objective function for the critic update as\nwn = h\u0302n = arg min hn \u2211 Ui\u2208Dn \u2016x\u1d40i hn \u2212 (ri + \u03b3y \u1d40 iwn)\u2016 2 2 , (25)\nfor n \u2208 {1, \u00b7 \u00b7 \u00b7 , N} and s.t. N\u2211\ni,j=1\ncijd (hi,hj) \u2264 \u03b41.\nAccording to the derivation in Section 4.1 that considers the Frobenius norm based smooth constraint, the updating rule for the projection step is (23). In the fixed-point step, the objective is simply wn = h\u0302n (i.e. a fixed-point problem), which leads to\nvec (W) = vec ( H\u0302 ) .\nThus, we have the closed-form solution for vec (W) as follows\nvec ( W\u0302 ) = [F1 \u2212 \u03b3F3 + L\u2297 (\u00b51, \u03b61)]\u22121 F2vec (R) . (26)\nIt is simpler than the 1st updating rule for the critic update (24)."}, {"heading": "6 EXPERIMENT RESULTS", "text": "We verify the proposed methods on the HeartSteps dataset. It has two choices for an action, i.e. {0, 1} , where a = 1 means sending the positive intervention, while a = 0 indicates no intervention [3]. Specifically, the stochastic policy is assumed to be in the form \u03c0\u03b8 (a | s) = exp[\u2212\u03b8\n\u1d40\u03c6(s,a)]\u2211 a\u2032 exp[\u2212\u03b8\u1d40\u03c6(s,a\u2032)]\n, where \u03b8 \u2208 Rm is the unknown parameter and \u03c6 (\u00b7, \u00b7) is a feature process that combines the information in actions and states, i.e. \u03c6 (s, a) = [as\u1d40, a]\u1d40 \u2208 Rm."}, {"heading": "6.1 The HeartSteps Dataset", "text": "To verify the performance of our method, we use a dataset from a mobile health study, called HeartSteps [44], to approximate the generative model. This is a 42-day mHealth intervention that aims to increase the users\u2019 steps they take each day by providing positive treatments (i.e. interventions), which are adapted to users\u2019 ongoing status, such as suggesting users to take a walk after long sitting [44], or to do some exercises after work.\nA trajectory of T tuples D = {(si, ai,ri) | i = 1, \u00b7 \u00b7 \u00b7 , T} are generated for each user [1, 3]. The initial state is drawn from the Gaussian distribution S0 \u223c Np {0,\u03a3}, where \u03a3 is a p \u00d7 p covariance matrix with pre-defined elements. The action at for 0 \u2264 t \u2264 T0 is drawn from the random\n7\npolicy, with a probability of 0.5 to provide interventions, i.e. \u00b5 (1 | s) = 0.5 for all states s. Such process is called drawing warm start trajectory (WST) via the micro-randomized trials [4, 44], and T0 is the length of the WST. When t \u2265 T0, we start the actor-critic updating, and the action is drawn from the learned policy, i.e. at \u223c \u03c0\u03b8\u0302t (\u00b7 | st). When t \u2265 1, the state and immediate reward are generated as follows\nSt,1 = \u03b21St\u22121,1 + \u03bet,1,\nSt,2 = \u03b22St\u22121,2 + \u03b23At\u22121 + \u03bet,2, (27) St,3 = \u03b24St\u22121,3 + \u03b25St\u22121,3At\u22121 + \u03b26At\u22121 + \u03bet,3,\nSt,j = \u03b27St\u22121,j + \u03bet,j , for j = 4, . . . , p Rt = \u03b214 \u00d7 [\u03b28 +At \u00d7 (\u03b29 + \u03b210St,1 + \u03b211St,2) (28)\n+ \u03b212St,1 \u2212 \u03b213St,3 + %t],\nwhere \u03b2 = {\u03b2i}14i=1 is the main parameter for the MDP and \u2212\u03b213St,3 is the treatment fatigue; {\u03bet,i}pi=1 \u223c N ( 0, \u03c32s ) is\nthe noise in the state (27) and %t \u223c N ( 0, \u03c32r ) is the noise in the reward model (28). As it is known to us, the individuals are generally more or less different from each other, and each individual is similar to a part, but not all, of the individuals. In the mHealth and RL study, an individual is abstracted as an MDP, which is determined by the value of \u03b2, cf. (27) and (28). To achieve a more practical dataset compared with [1, 3, 4], we come up with a method to generate N users (i.e. \u03b2s) that satisfy the above requirements in two steps: (a) manually design V basic \u03b2s, i.e. { \u03b2basicv | v = 1, \u00b7 \u00b7 \u00b7 , V } , that are very different from each other; (b) a set of Nv different individuals (i.e. \u03b2s) are generated for each \u03b2basicv via the following process \u03b2i = \u03b2basicv + \u03b4i, for i \u2208 {1, 2, \u00b7 \u00b7 \u00b7 , Nv}, where \u03b4i \u223c N (0, \u03c3bI14) is the noise in the MDPs and I14 \u2208 R14\u00d714 is an identity matrix. After such processing, the individuals are all different from the others. The value of \u03c3b specifies how different the individuals are. In the experiments, the number of groups is set as V = 3 (each group has Nv = 15 people, leading to N = 45 users\ninvolved in the experiment). The \u03b2basic\u2019s for the V groups are set as follows\n\u03b2basic1 =[0.40, 0.25, 0.35, 0.65, 0.10, 0.50, 0.22,\n2.00, 0.15, 0.20, 0.32, 0.10, 0.45, 800]\n\u03b2basic2 =[0.35, 0.30, 0.30, 0.60, 0.05, 0.65, 0.28,\n2.60, 0.35, 0.45, 0.45, 0.15, 0.50, 650]\n\u03b2basic3 =[0.20, 0.50, 0.20, 0.62, 0.06, 0.52, 0.27,\n3.00, 0.15, 0.15, 0.50, 0.16, 0.70, 450]."}, {"heading": "6.2 Compared Methods and Parameter Settings", "text": "There are three online actor-critic RL methods for the comparison: (a) Separate-RL, which is an extension of the online actor-critic contextual bandit in [1] to the online actor-critic reinforcement learning. It learns a separate RL policy for each user by only using his or her data. (b) CohesionRL#1 is the first version of our method. (c) Cohesion-RL#2 is the second version of our method (cf. Algorithm 1 for detail). Specially, Cohesion-RL#1 and Cohesion-RL#2 share the same actor updating. The difference between them is the different critic updating rules that they employ.\nThe noises in the MDP are set as \u03c3s=0.5, \u03c3r=1 and \u03c3\u03b2= 0.05. The state has dimension p = 3 and the policy feature has m=4 elements. We set the `2 constraint in the SeparateRL as \u03b6a = \u03b6c = 0.1. When the cohesion constraint in our methods are too small (10\u22124, say), we need the `2 constraint for the actor-critic updating to avoid the overfitting, with the parameters as \u03b61 = \u03b62 = \u03b63 = 0.1. Otherwise, we set \u03b61 = \u03b62 = \u03b63 \u2192 0. The feature processing for the value estimation is x (s, a) = [1, s\u1d40, a, s\u1d40a]\u1d40 \u2208 Ru, where u = 2p+ 2, for all the compared methods. The feature for the policy is processed as \u03c6 (s, a) = [as\u1d40, a]\u1d40 \u2208 Rm where m = p+ 1. We set K = 8 for the K-NN based network cohesion learning. If there is no special setting, the following three paremeters are set as: (a) the trajectory length in mHealth is T = 80, which indicates that the online RL learning ends at t = 80;\n8 T = 50 T = 80 T = 110 T = 150120 0 12 50 13 00 13 50 14 00 14 50 15 00 1,238.4 1,239.3 1,238.6 1,239.5 1,332.3 1,341.1 1,343.3 1,342.1 1,394.4 1,395.6 1,396.8 1,397.4\n(a) Discount Factor when \u03b3= 0\nA ve\nra ge\nR ew\nar d\nSeparate-RL Cohesion-RL#1 Cohesion-RL#2\nT = 50 T = 80 T = 110 T = 150130 0\n13 50\n14 00\n14 50\n15 00\n15 50\n16 00\n1,346.3\n1,374.4 1,386 1,388.5\n1,488.4 1,497.7\n1,503.1 1,502.61,505.1 1,508.9 1,513.3\n1,515.3\n(b) Discount Factor when \u03b3= 0.6\nA ve\nra ge\nR ew\nar d\nSeparate-RL Cohesion-RL#1 Cohesion-RL#2\nT = 50 T = 80 T = 110 T = 150120 0\n13 00\n14 00\n15 00\n16 00\n1,265.2\n1,305.5 1,312.4 1,315.2\n1,542.7 1,556.3\n1,565.8 1,570 1,556.5\n1,564.7 1,574.6 1,577.8\n(c) Discount Factor when \u03b3= 0.95\nA ve\nra ge\nR ew\nar d\nSeparate-RL Cohesion-RL#1 Cohesion-RL#2\nFig. 1. Performance of three RL methods for experiment setting (S1). Each sub-figure shows results under one \u03b3 setting.\nT0 = 5 T0 = 10 T0 = 15 T0 = 20110 0\n12 00\n13 00\n14 00\n15 00\n1,194\n1,239.3 1,256\n1,380.8\n1,324.7\n1,343.2 1,354.8 1,358.9\n1,396.7 1,397.2 1,398.4 1,399.1\n(a) Discount Factor when \u03b3= 0\nA ve\nra ge\nR ew\nar d\nSeparate-RL Cohesion-RL#1 Cohesion-RL#2\nT0 = 5 T0 = 10 T0 = 15 T0 = 20120 0\n13 00\n14 00\n15 00\n16 00\n1,254.1\n1,374.4\n1,432.2\n1,463.6\n1,487.9 1,494.4 1,488.6 1,505.7\n1,515.2 1,508.8 1,510.7 1,516.8\n(b) Discount Factor when \u03b3= 0.6\nA ve\nra ge\nR ew\nar d\nSeparate-RL Cohesion-RL#1 Cohesion-RL#2\nT0 = 5 T0 = 10 T0 = 15 T0 = 20 12\n00 12\n50 13\n00 13\n50 14\n00 14\n50 15\n00 15\n50 16\n00 16\n50\n1,245.1\n1,305.5\n1,392.9\n1,434.4\n1,554.7 1,554.1 1,559.1 1,564.11,568.5\n1,577 1,569.8 1,574.6\n(c) Discount Factor when \u03b3= 0.95\nA ve\nra ge\nR ew\nar d\nSeparate-RL Cohesion-RL#1 Cohesion-RL#2\nFig. 2. Performance of three RL methods for experiment setting (S2). Each sub-figure shows results under one \u03b3 setting.\n(b) the length of warm start trajectory is set as T0 = 10; (c) to reduce the number of parameters in the algorithm, the parameters for the cohesion constraint in our methods are set as \u00b51 = 0.1, \u00b53 = \u00b51 and \u00b52 = 0.01\u00b51."}, {"heading": "6.3 Evaluation Metrics", "text": "We use the expectation of long run average reward (ElrAR) E [\u03b7\u03c0\u0398\u0302 ] to quantify the quality of the estimated policy \u03c0\u0398\u0302 on a set of N=45 individuals. Here \u03c0\u0398\u0302 summarizes the policies for all the 45 users, in which \u03c0\u03b8\u0302n is the n-th user\u2019s policy. Intuitively, ElrAR measures how much average reward in the long run we could totally get by using the learned policy \u03c0\u0398\u0302 on the testing users (i.e. MDPs), for example measuring how much alcohol users have in a fixed time period in the alcohol use study [8, 9]. Specifically in the HeartSteps, ElrAR measures the average steps that users take per day over a long time; a larger ElrAR corresponds to a better performance. The average reward for the n-th user, i.e. \u03b7\u03c0\u03b8\u0302n , is calculated by averaging the rewards over the last 4, 000 elements in a trajectory of 5, 000 tuples under the policy \u03c0\u03b8\u0302n ,\ni.e. \u03b7\u03c0\u03b8\u0302n = 1T\u2212i \u2211T j=iR ( sj,n, aj,n \u223c \u03c0\u03b8\u0302n ) , where T = 5000 and i = 1000. Then ElrAR E [\u03b7\u03c0\u0398\u0302 ] is approximated by averaging over the 45 \u03b7\u03c0\u03b8\u0302n \u2019s, i.e. E [\u03b7\u03c0\u0398\u0302 ] \u2248 1N \u2211N n=1 \u03b7 \u03c0\u03b8\u0302n ."}, {"heading": "6.4 Comparisons in three experiment settings", "text": "The following experiments are carried out to verify different aspects of the three online actor-critic RL algorithms:\n(S1) In this part, the trajectory length of all users ranges as T \u2208 {50, 80, 110, 150}. The experiment results are showed in Table 1 and Fig. 2. There are two sub-tables in Table 1; each sub-table displays the ElrAR of three RL methods (i.e. Separate-RL, Cohesion-RL#1 and Cohesion-RL#2 respectively) under six \u03b3 settings; the last row shows the\naverage ElrAR over the results of all the six \u03b3s. In Fig. 2, there are three sub-figures; each sub-figure illustrates the results of three methods under one \u03b3 setting. As we shall see that the performance of three methods generally increases as T rises. The performance of our RL methods, i.e. CohesionRL#1 and Cohesion-RL#2, have an obvious advantage over the Separate-RL under all the parameters settings in (S1). Besides, the advantage of our methods over Separate-RL slowly decreases as T rises. Compared with Separate-RL, our methods averagely improve 156.0 steps and 188.3 steps when T = 50, and averagely improve 136.3 steps and 163.7 steps when T = 150.\n(S2) In this part, the length of warm start trajectory ranges as T0 = {5, 10, 15, 20}, which indicates that the RL methods wait longer and longer before starting the online learning. The experiment results are summarized in Table 2 and Fig. 2. As we shall see that as T0 rises across this range, the performance of Separate-RL increases dramatically and Cohesion-RL#1 rises gradually, while CohesionRL#2 remains stable. Thus, the average advantage of our method over Separate-RL decreases dramatically as T0 rises, i.e., from 224.07 steps and 261.67 steps when T0 = 5 to 33.26 steps and 52.09 steps when T0 = 20. Such case suggests that our methods work perfectly when the WST is very short. In this case, the mining of network cohesion is necessary for the online RL learning. In general, however, our methods still outperform Separate-RL significantly.\n(S3) The parameter of the Network-Cohesion constraint \u00b51 for the projection step ranges from 0.001 to 10. To reduce the number of parameters in our algorithm, we simply set \u00b52 = 0.01\u00b51 (i.e. the cohesion constraint for the fixed-point step) and \u00b53 = \u00b51 (i.e. the cohesion constraint for the actor updating). The experiment results are illustrated in Fig. 3, where there are three sub-figures. Each sub-figure shows\n9 the results of three online RLs vs. five \u00b51 settings under one \u03b3. As we shall see that as \u00b51 rises across this range, our method always obtains superior performance compared with Separate-RL. Specially, Cohesion-RL#2 is very stable and always better than Cohesion-RL#1. Such case indicates that it is reliable to follow the idea on how to introduce the `2 constraint in LSTDQ. In Fig. 3, since Separate-RL does not have the Network-Cohesion constraint, its result keeps unchanged.\nConsider (S1) and (S2) for the Separate-RL, we find: (a) the lack of samples at the beginning of the online learning may bias the optimization direction, which badly influence the performance even when the trajectory is very long; (b) Compared with T , the increase of T0 has a more important influence on the performance. In (S1), where T0 = 10 is fixed and T ranges from T = 50 to T = 150, the performance of Separate-RL increases 32.74 steps. In (S2), where T = 80 is fixed and T0 rises from T0 = 5 to T0 = 20, SeparateRL achieve an improvement of 210.51 steps, which is much significant than the rise caused by the rising T ."}, {"heading": "7 CONCLUSIONS AND DISCUSS", "text": "This paper presents a first attempt to employ the online actor-critic reinforcement learning for the mHealth. Following the current methods that learn a separate policy for each user, the Separate-RL can not achieve satisfactory results. This is due to that data for each user is very limited in size to support the separate learning, leading to unstable policies that contain lots of variances. After considering the universal phenomenon that users are generally connected in a network and linked users tend to have similar behaviors, we propose a network cohesion constrained actorcritic reinforcement learning for mHealth. It is able to share the information among similar users to convert the limited user information into sharper learned policies. Extensive experiment results demonstrate that our methods outperform the Separate-RL significantly. We find it easy to apply the proposed methods to other health-related tasks."}, {"heading": "Appendix: the proof of Theorem 1", "text": "Proof: Considering L\u2297 (\u00b52, \u03b62) = (\u00b52L\u1d40 + \u03b62IN )\u2297 Iu gives the equation B = P\u1d40P+\u00b52L\u1d40\u2297 Iu + \u03b62IuN . The first term B1 = P\u1d40P is obviously positive semi-definite as \u2200x, we have x\u1d40P\u1d40Px = \u2016Px\u201622 \u2265 0. The graph laplacian L is positive semi-definite, which indicates that its eigenvalues are non-negative, i.e. \u03bb1, \u00b7 \u00b7 \u00b7 , \u03bbN \u2265 0. The eigenvalues of Iu are \u00b51 = \u00b7 \u00b7 \u00b7 = \u00b5u = 1. According to Lemma 2, we have the conclusion that the eigenvalues of L\u1d40\u2297 Iu are nonnegative, which indicates that it is a positive semi-definite matrix. The last term in B is an identical matrix, which is surely positive definite. The sum of two positive semidefinite matrices and a positive definite matrix results in a positive definite matrix.\nSince for any matrices A \u2208 Rl\u00d7k and D \u2208 Rm\u00d7n, the Kronecker product has the property (A\u2297D)\u1d40 = (A\u1d40 \u2297D\u1d40) [49]. Besides, the graph laplacian L is symmetric. We have\nB\u1d40 = (P\u1d40P + \u00b52L \u1d40 \u2297 Iu + \u03b62IuN )\u1d40 = B."}], "references": [{"title": "An actor-critic contextual bandit algorithm for personalized interventions using mobile devices", "author": ["H. Lei", "A. Tewari", "S. Murphy"], "venue": "NIPS 2014 Workshop: Personalization: Methods and Applications, pp. 1 \u2013 9, 2014.", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2014}, {"title": "An Online Actor Critic Algorithm and a Statistical Decision Procedure for Personalizing Intervention", "author": ["H. Lei"], "venue": "PhD thesis, University of Michigan,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2016}, {"title": "A batch, off-policy, actorcritic algorithm for optimizing the average reward", "author": ["S.A. Murphy", "Y. Deng", "E.B. Laber", "H.R. Maei", "R.S. Sutton", "K. Witkiewitz"], "venue": "CoRR, vol. abs/1607.05047, 2016.", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2016}, {"title": "Constructing justin-time adaptive interventions", "author": ["P. Liao", "A. Tewari", "S. Murphy"], "venue": "Phd Section Proposal, pp. 1\u201349, 2015.", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2015}, {"title": "Deep correlational learning for survival prediction from multimodality datay", "author": ["J. Yao", "X. Zhu", "F. Zhu", "J. Huang"], "venue": "International Conference on Medical Image Computing and Computer Assisted Intervention (MICCAI), 2017.", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2017}, {"title": "Wsisa: Making survival prediction from whole slide histopathological images", "author": ["X. Zhu", "J. Yao", "F. Zhu", "J. Huang"], "venue": "IEEE Conference on Computer Vision and Pattern Recognition, pp. 7234 \u2013 7242, 2017.", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2017}, {"title": "Seq2seq fingerprint: An unsupervised deep molecular embedding for drug discovery", "author": ["Z. Xu", "S. Wang", "F. Zhu", "J. Huang"], "venue": "ACM Conference on Bioinformatics, Computational Biology, and Health Informatics (ACM- BCB), 2017.", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2017}, {"title": "A smartphone application to support recovery from alcoholism: a randomized clinical trial", "author": ["D. Gustafson", "F. McTavish", "M. Chih", "A. Atwood", "R. Johnson", "M.B. ...", "D. Shah"], "venue": "JAMA Psychiatry, vol. 71, no. 5, 2014.", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2014}, {"title": "Development and evaluation of a mobile intervention for heavy drinking and smoking among college studen", "author": ["K. Witkiewitz", "S. Desai", "S. Bowen", "B. Leigh", "M. Kirouac", "M. Larimer"], "venue": "Psychology of Addictive Behaviors, vol. 28, no. 3, 2014.", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2014}, {"title": "Harnessing different motivational frames via mobile phones to promote daily physical activity and reduce sedentary behavior in aging adults", "author": ["K. Abby", "H. Eric", "G. Lauren", "W. Sandra", "S. Jylana", "B. Matthew", ".\u0307.", "C. Jesse"], "venue": "Plos ONE, vol. 8, 2013.", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2013}, {"title": "Technology-enhanced maintenance of treatment gains in eating disorders: Efficacy of an intervention delivered via text messaging", "author": ["S. Bauer", "E. Okon", "R. Meermann", "H. Kordy"], "venue": "Journal of Consulting and Clinical Psychology, vol. 80, no. 4, 2012.", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2012}, {"title": "Mobile interventions for severe mental illness: design and preliminary data from three approaches", "author": ["C. Depp", "B. Mausbach", "E. Granholm", "V. Cardenas", "D. Ben-Zeev", "...", "D. Jeste"], "venue": "The Journal of Nervous and Mental Disease, vol. 198, no. 10, 2010.", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2010}, {"title": "Mobile technologies among people with serious mental illness: opportunities for future services", "author": ["D. Ben-Zeev", "K.E. Davis", "S. Kaiser", "I. Krzsos", "R.E. Drake"], "venue": "Administration and Policy in Mental Health and Mental Health Services Research, vol. 40, no. 4, 2013.", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2013}, {"title": "A text message-based intervention for weight loss: randomized controlled trial", "author": ["K. Patrick", "F. Raab", "M. Adams", "L. Dillon", "M. Zabin- 10 \u03bc= 0.001 \u03bc= 0.01 \u03bc= 0.1 \u03bc= 1.0 \u03bc= 10  1", "2  00  1", "3  00  1", "4  00  1", "5  00 (a) Performance vs. \u03bc when \u03b3= 0  A  ve  ra  ge  R  ew  ar  d  Separate-RL Cohesion-RL#1 Cohesion-RL#2 \u03bc= 0.001 \u03bc= 0.01 \u03bc= 0.1 \u03bc= 1.0 \u03bc= 10  1", "3  00  1", "3  50  1", "4  00  1", "4  50  1", "5  00  1", "5  50  1", "6  00 (b) Performance vs. \u03bc when \u03b3= 0.6  A  ve  ra  ge  R  ew  ar  d Separate-RL Cohesion-RL#1 Cohesion-RL#2 \u03bc= 0.001 \u03bc= 0.01 \u03bc= 0.1 \u03bc= 1.0 \u03bc= 10  1", "2  30  1", "2  80  1", "3  30  1", "3  80  1", "4  30  1", "4  80  1", "5  30  1", "5  80  1", "6  30  1", "6  80 (c) Performance vs. \u03bc when \u03b3= 0.95  A  ve  ra  ge  R  ew  ar  d  Separate-RL Cohesion-RL#1 Cohesion-RL#2 Fig. 3. Performance of three RL methods for experiment setting (S3). Each sub-figure shows results under one \u03b3 setting. ski", "C. Rock", "W. Griswold", "G. Norman"], "venue": "Journal of Medical Internet Research, vol. 11, no. 1, 2009.", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2009}, {"title": "Reinforcement Learning: An Introduction", "author": ["R.S. Sutton", "A.G. Barto"], "venue": null, "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2012}, {"title": "A contextual-bandit approach to personalized news article recommendation", "author": ["L. Li", "W. Chu", "J. Langford", "R.E. Schapire"], "venue": "International Conference on World Wide Web (WWW), pp. 661\u2013670, 2010.", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2010}, {"title": "A gang of bandits", "author": ["N. Cesa-Bianchi", "C. Gentile", "G. Zappella"], "venue": "NIPS, pp. 737\u2013745, 2013.", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2013}, {"title": "Online clustering of bandits", "author": ["C. Gentile", "S. Li", "G. Zappella"], "venue": "ICML, pp. 757\u2013765, 2014.", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2014}, {"title": "Revealing graph bandits for maximizing local influence", "author": ["A. Carpentier", "M. Valko"], "venue": "AISTATS, pp. 10\u201318, 2016.", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2016}, {"title": "Structured sparse method for hyperspectral unmixing", "author": ["F. Zhu", "Y. Wang", "S. Xiang", "B. Fan", "C. Pan"], "venue": "ISPRS Journal of Photogrammetry and Remote Sensing, vol. 88, no. 0, pp. 101\u2013118, 2014.", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2014}, {"title": "A label propagation method using spatial-spectral consistency for hyperspectral image classification", "author": ["H. Li", "Y. Wang", "S. Xiang", "J. Duan", "F. Zhu", "C. Pan"], "venue": "International Journal of Remote Sensing, vol. 37, no. 1, pp. 191\u2013 211, 2016.", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2016}, {"title": "Prediction models for network-linked data", "author": ["T. Li", "E. Levina", "J. Zhu"], "venue": "CoRR, vol. abs/1602.01192, February 2016.", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2016}, {"title": "Algorithmic survey of parametric value function approximation", "author": ["M. Geist", "O. Pietquin"], "venue": "IEEE Transactions on Neural Networks and Learning Systems, vol. 24, no. 6, pp. 845\u2013867, 2013.", "citeRegEx": "23", "shortCiteRegEx": null, "year": 2013}, {"title": "A survey of actor-critic reinforcement learning: Standard and natural policy gradients", "author": ["I. Grondman", "L. Busoniu", "G.A.D. Lopes", "R. Babuska"], "venue": "IEEE Trans. Systems, Man, and Cybernetics, vol. 42, no. 6, pp. 1291\u20131307, 2012.", "citeRegEx": "24", "shortCiteRegEx": null, "year": 2012}, {"title": "Sequential cost-sensitive decision making with reinforcement learning", "author": ["E.P.D. Pednault", "N. Abe", "B. Zadrozny"], "venue": "ACM SIGKDD Int. Conf. on Knowledge Discovery and Data Min., pp. 259\u2013268, 2002.", "citeRegEx": "25", "shortCiteRegEx": null, "year": 2002}, {"title": "Least-squares policy iteration", "author": ["M.G. Lagoudakis", "R. Parr"], "venue": "J. of Machine Learning Research (JLMR), vol. 4, pp. 1107\u20131149, 2003.", "citeRegEx": "26", "shortCiteRegEx": null, "year": 2003}, {"title": "Variety influences habituation of motivated behavior for food and energy intake in children", "author": ["L. Epstein", "J. Robinson", "J. Temple", "J. Roemmich", "A. Marusewski", "R. Nadbrzuch"], "venue": "The American Journal of Clinical Nutrition, vol. 89, pp. 746 \u2013 754, Mar 2009.", "citeRegEx": "27", "shortCiteRegEx": null, "year": 2009}, {"title": "Cross channel optimized marketing by reinforcement learning", "author": ["N. Abe", "N.K. Verma", "C. Apt\u00e9", "R. Schroko"], "venue": "ACM SIGKDD Int. Conf. on Knowledge Discovery and Data Min., pp. 767\u2013772, 2004.", "citeRegEx": "28", "shortCiteRegEx": null, "year": 2004}, {"title": "Optimizing debt collections using constrained reinforcement learning", "author": ["N. Abe", "P. Melville", "C. Pendus", "C.K. Reddy", "D.L. Jensen", "V.P. Thomas", "J.J. Bennett", "G.F. Anderson", "B.R. Cooley", "M. Kowalczyk", "M. Domick", "T. Gardinier"], "venue": "ACM SIGKDD Int. Conf. on Knowledge Discovery and Data Min., pp. 75\u201384, 2010.", "citeRegEx": "29", "shortCiteRegEx": null, "year": 2010}, {"title": "Regularization and feature selection in least-squares temporal difference learning", "author": ["J.Z. Kolter", "A.Y. Ng"], "venue": "International Conference on Machine Learning (ICML), pp. 521\u2013528, 2009.", "citeRegEx": "30", "shortCiteRegEx": null, "year": 2009}, {"title": "Privacypreserving reinforcement learning", "author": ["J. Sakuma", "S. Kobayashi", "R.N. Wright"], "venue": "International Conference on Machine Learning, pp. 864\u2013871, 2008.", "citeRegEx": "31", "shortCiteRegEx": null, "year": 2008}, {"title": "Delinquent peers revisited: Does network structure matter", "author": ["D.L. Haynie"], "venue": "American journal of sociology, vol. 106, no. 4, pp. 1013 \u2013 1057, 2001.", "citeRegEx": "32", "shortCiteRegEx": null, "year": 2001}, {"title": "Social network influences on adolescent substance use: disentangling structural equivalence from cohesion", "author": ["K. Fujimoto", "T.W. Valente"], "venue": "Social Science & Medicine, vol. 74, no. 12, pp. 1952 \u2013 1960, 2012.", "citeRegEx": "33", "shortCiteRegEx": null, "year": 1952}, {"title": "Semisupervised hyperspectral image classification via discriminant analysis and robust regression", "author": ["G. Cheng", "F. Zhu", "S. Xiang", "Y. Wang", "C. Pan"], "venue": "IEEE J. of Selected Topics in Applied Earth Observations and Remote Sensing, vol. 9, no. 2, pp. 595\u2013608, 2016.", "citeRegEx": "34", "shortCiteRegEx": null, "year": 2016}, {"title": "Road centerline extraction via semisupervised segmentation and multidirection nonmaximum suppression", "author": ["G. Cheng", "F. Zhu", "S. Xiang", "C. Pan"], "venue": "IEEE Geoscience and Remote Sensing Letters, vol. 13, no. 4, pp. 545\u2013 549, 2016.", "citeRegEx": "35", "shortCiteRegEx": null, "year": 2016}, {"title": "Spectral unmixing via data-guided sparsity", "author": ["F. Zhu", "Y. Wang", "B. Fan", "S. Xiang", "G. Meng", "C. Pan"], "venue": "IEEE Transactions on Image Processing (TIP), vol. 23, pp. 5412\u2013 5427, Dec 2014.", "citeRegEx": "36", "shortCiteRegEx": null, "year": 2014}, {"title": "Urban road extraction via graph cuts based probability propagation", "author": ["G. Cheng", "Y. Wang", "Y. Gong", "F. Zhu", "C. Pan"], "venue": "Image Processing (ICIP), 2014 IEEE International Conference on, pp. 5072\u20135076, IEEE, 2014.", "citeRegEx": "37", "shortCiteRegEx": null, "year": 2014}, {"title": "10,000+ times accelerated robust subset selection (ARSS)", "author": ["F. Zhu", "B. Fan", "X. Zhu", "Y. Wang", "S. Xiang", "11 C. Pan"], "venue": "Proc. Assoc. Adv. Artif. Intell. (AAAI), pp. 3217\u20133224, 2015.", "citeRegEx": "38", "shortCiteRegEx": null, "year": 2015}, {"title": "Road extraction via adaptive graph cuts with multiple features", "author": ["G. Cheng", "Y. Wang", "F. Zhu", "C. Pan"], "venue": "Image Processing (ICIP), IEEE International Conference on, pp. 3962\u20133966, IEEE, 2015.", "citeRegEx": "39", "shortCiteRegEx": null, "year": 2015}, {"title": "Robust hyperspectral unmixing with correntropy-based metric", "author": ["Y. Wang", "C. Pan", "S. Xiang", "F. Zhu"], "venue": "IEEE Transactions on Image Processing, vol. 24, no. 11, pp. 4027\u20134040, 2015.", "citeRegEx": "40", "shortCiteRegEx": null, "year": 2015}, {"title": "Learning-based fully 3d face reconstruction from a single image", "author": ["X. Hu", "Y. Wang", "F. Zhu", "C. Pan"], "venue": "Acoustics, Speech and Signal Processing (ICASSP), 2016 IEEE International Conference on, pp. 1651\u20131655, IEEE, 2016.", "citeRegEx": "41", "shortCiteRegEx": null, "year": 2016}, {"title": "Accurate urban road centerline extraction from vhr imagery via multiscale segmentation and tensor voting", "author": ["G. Cheng", "F. Zhu", "S. Xiang", "Y. Wang", "C. Pan"], "venue": "Neurocomputing, vol. 205, pp. 407\u2013420, 2016.", "citeRegEx": "42", "shortCiteRegEx": null, "year": 2016}, {"title": "Effective spectral unmixing via robust representation and learning-based sparsity", "author": ["F. Zhu", "Y. Wang", "B. Fan", "G. Meng", "C. Pan"], "venue": "CoRR, vol. abs/1409.0685, 2014.", "citeRegEx": "43", "shortCiteRegEx": null, "year": 2014}, {"title": "Randomised trials for the fitbit generation", "author": ["W. Dempsey", "P. Liao", "P. Klasnja", "I. Nahum-Shani", "S.A. Murphy"], "venue": "Significance, vol. 12, pp. 20 \u2013 23, Dec 2016.", "citeRegEx": "44", "shortCiteRegEx": null, "year": 2016}, {"title": "A tutorial on spectral clustering", "author": ["U. von Luxburg"], "venue": "Statistics and Computing, vol. 17, no. 4, pp. 395 \u2013 416, 2007.", "citeRegEx": "45", "shortCiteRegEx": null, "year": 2007}, {"title": "Unsupervised Hyperspectral Unmixing Methods", "author": ["F. Zhu"], "venue": "PhD thesis,", "citeRegEx": "46", "shortCiteRegEx": "46", "year": 2015}, {"title": "Regularized least squares temporal difference learning with nested `2 and `1 penalization", "author": ["M.W. Hoffman", "A. Lazaric", "M. Ghavamzadeh", "R. Munos"], "venue": "Recent Advances in Reinforcement Learning, pp. 102\u2013114, 2011.", "citeRegEx": "47", "shortCiteRegEx": null, "year": 2011}, {"title": "The matrix cookbook", "author": ["K.B. Petersen", "M.S. Pedersen"], "venue": "2012.", "citeRegEx": "48", "shortCiteRegEx": null, "year": 2012}, {"title": "The kronecker product and stochastic automata networks", "author": ["A.N. Langville", "W.J. Stewart"], "venue": "Journal of Computational and Applied Mathematics, vol. 167, pp. 429\u2013 447, June 2004.", "citeRegEx": "49", "shortCiteRegEx": null, "year": 2004}], "referenceMentions": [{"referenceID": 0, "context": "1 INTRODUCTION With billions of smart device1 users globally, it is increasingly popular among the scientist community to make use of the state-of-the-art articial intelligence and mobile health technologies to leverage supercomputers and big data to facilicate the prediction of healthcare tasks [1\u20137].", "startOffset": 297, "endOffset": 302}, {"referenceID": 1, "context": "1 INTRODUCTION With billions of smart device1 users globally, it is increasingly popular among the scientist community to make use of the state-of-the-art articial intelligence and mobile health technologies to leverage supercomputers and big data to facilicate the prediction of healthcare tasks [1\u20137].", "startOffset": 297, "endOffset": 302}, {"referenceID": 2, "context": "1 INTRODUCTION With billions of smart device1 users globally, it is increasingly popular among the scientist community to make use of the state-of-the-art articial intelligence and mobile health technologies to leverage supercomputers and big data to facilicate the prediction of healthcare tasks [1\u20137].", "startOffset": 297, "endOffset": 302}, {"referenceID": 3, "context": "1 INTRODUCTION With billions of smart device1 users globally, it is increasingly popular among the scientist community to make use of the state-of-the-art articial intelligence and mobile health technologies to leverage supercomputers and big data to facilicate the prediction of healthcare tasks [1\u20137].", "startOffset": 297, "endOffset": 302}, {"referenceID": 4, "context": "1 INTRODUCTION With billions of smart device1 users globally, it is increasingly popular among the scientist community to make use of the state-of-the-art articial intelligence and mobile health technologies to leverage supercomputers and big data to facilicate the prediction of healthcare tasks [1\u20137].", "startOffset": 297, "endOffset": 302}, {"referenceID": 5, "context": "1 INTRODUCTION With billions of smart device1 users globally, it is increasingly popular among the scientist community to make use of the state-of-the-art articial intelligence and mobile health technologies to leverage supercomputers and big data to facilicate the prediction of healthcare tasks [1\u20137].", "startOffset": 297, "endOffset": 302}, {"referenceID": 6, "context": "1 INTRODUCTION With billions of smart device1 users globally, it is increasingly popular among the scientist community to make use of the state-of-the-art articial intelligence and mobile health technologies to leverage supercomputers and big data to facilicate the prediction of healthcare tasks [1\u20137].", "startOffset": 297, "endOffset": 302}, {"referenceID": 7, "context": "[8, 9] and promoting physical activities [10].", "startOffset": 0, "endOffset": 6}, {"referenceID": 8, "context": "[8, 9] and promoting physical activities [10].", "startOffset": 0, "endOffset": 6}, {"referenceID": 9, "context": "[8, 9] and promoting physical activities [10].", "startOffset": 41, "endOffset": 45}, {"referenceID": 9, "context": "Thus, mHealth technologies are widely used in lots of healthrelated tasks, such as physical activity [10], eating disorders [11], alcohol use [8, 9], mental illness[12, 13], obesity/weight management [14].", "startOffset": 101, "endOffset": 105}, {"referenceID": 10, "context": "Thus, mHealth technologies are widely used in lots of healthrelated tasks, such as physical activity [10], eating disorders [11], alcohol use [8, 9], mental illness[12, 13], obesity/weight management [14].", "startOffset": 124, "endOffset": 128}, {"referenceID": 7, "context": "Thus, mHealth technologies are widely used in lots of healthrelated tasks, such as physical activity [10], eating disorders [11], alcohol use [8, 9], mental illness[12, 13], obesity/weight management [14].", "startOffset": 142, "endOffset": 148}, {"referenceID": 8, "context": "Thus, mHealth technologies are widely used in lots of healthrelated tasks, such as physical activity [10], eating disorders [11], alcohol use [8, 9], mental illness[12, 13], obesity/weight management [14].", "startOffset": 142, "endOffset": 148}, {"referenceID": 11, "context": "Thus, mHealth technologies are widely used in lots of healthrelated tasks, such as physical activity [10], eating disorders [11], alcohol use [8, 9], mental illness[12, 13], obesity/weight management [14].", "startOffset": 164, "endOffset": 172}, {"referenceID": 12, "context": "Thus, mHealth technologies are widely used in lots of healthrelated tasks, such as physical activity [10], eating disorders [11], alcohol use [8, 9], mental illness[12, 13], obesity/weight management [14].", "startOffset": 164, "endOffset": 172}, {"referenceID": 13, "context": "Thus, mHealth technologies are widely used in lots of healthrelated tasks, such as physical activity [10], eating disorders [11], alcohol use [8, 9], mental illness[12, 13], obesity/weight management [14].", "startOffset": 200, "endOffset": 204}, {"referenceID": 0, "context": "It aims to learn the optimal policy to determine when, where and how to deliver the intervention [1, 3, 4] to best serve users.", "startOffset": 97, "endOffset": 106}, {"referenceID": 2, "context": "It aims to learn the optimal policy to determine when, where and how to deliver the intervention [1, 3, 4] to best serve users.", "startOffset": 97, "endOffset": 106}, {"referenceID": 3, "context": "It aims to learn the optimal policy to determine when, where and how to deliver the intervention [1, 3, 4] to best serve users.", "startOffset": 97, "endOffset": 106}, {"referenceID": 0, "context": "In 2014, Lei [1] made a first attempt to formulate the mHealth intervention as an online actor-critic contextual bandit problem.", "startOffset": 13, "endOffset": 16}, {"referenceID": 14, "context": "However, this method did not consider the important delayed effect in the SDM\u2014 the current action may influence not only the immediate reward but also the next states and, through that, all the subsequent rewards [15, 16].", "startOffset": 213, "endOffset": 221}, {"referenceID": 15, "context": "However, this method did not consider the important delayed effect in the SDM\u2014 the current action may influence not only the immediate reward but also the next states and, through that, all the subsequent rewards [15, 16].", "startOffset": 213, "endOffset": 221}, {"referenceID": 2, "context": "Murphy [3] proposed an average reward based RL to consider the delayed effect in the mHealth.", "startOffset": 7, "endOffset": 10}, {"referenceID": 2, "context": "Besides, [3] is in the batch learning setting, which is different from this paper\u2019s focuses.", "startOffset": 9, "endOffset": 12}, {"referenceID": 16, "context": "Cesa-Bianchi [17] proposed a contextual bandit algorithm that considers the network information.", "startOffset": 13, "endOffset": 17}, {"referenceID": 16, "context": "Besides, there are three drawbacks making the method in [17] impractical for the mHealth: (1) Cesa-Bianchi\u2019s method focues on the bandit algorithm.", "startOffset": 56, "endOffset": 60}, {"referenceID": 18, "context": "There is lots of misleading network information for the mHealth study [17\u2013 19].", "startOffset": 70, "endOffset": 78}, {"referenceID": 19, "context": "not flexible for the mHealth study [20, 21].", "startOffset": 35, "endOffset": 43}, {"referenceID": 20, "context": "not flexible for the mHealth study [20, 21].", "startOffset": 35, "endOffset": 43}, {"referenceID": 19, "context": "(2) Current evidence verifies the wide existence of networks among users [20\u201322].", "startOffset": 73, "endOffset": 80}, {"referenceID": 20, "context": "(2) Current evidence verifies the wide existence of networks among users [20\u201322].", "startOffset": 73, "endOffset": 80}, {"referenceID": 21, "context": "(2) Current evidence verifies the wide existence of networks among users [20\u201322].", "startOffset": 73, "endOffset": 80}, {"referenceID": 16, "context": "(4) Compared with [17], the proposed method has a tuning parameter, which allows us to control how much information we should share with similar users.", "startOffset": 18, "endOffset": 22}, {"referenceID": 22, "context": "We assume the mHealth intervention is a Markov Decision Process (MDP) [23\u201326] that consists of a 5-tuple {S,A,P,R, \u03b3}, where S is the state space and A is the action space.", "startOffset": 70, "endOffset": 77}, {"referenceID": 23, "context": "We assume the mHealth intervention is a Markov Decision Process (MDP) [23\u201326] that consists of a 5-tuple {S,A,P,R, \u03b3}, where S is the state space and A is the action space.", "startOffset": 70, "endOffset": 77}, {"referenceID": 24, "context": "We assume the mHealth intervention is a Markov Decision Process (MDP) [23\u201326] that consists of a 5-tuple {S,A,P,R, \u03b3}, where S is the state space and A is the action space.", "startOffset": 70, "endOffset": 77}, {"referenceID": 25, "context": "We assume the mHealth intervention is a Markov Decision Process (MDP) [23\u201326] that consists of a 5-tuple {S,A,P,R, \u03b3}, where S is the state space and A is the action space.", "startOffset": 70, "endOffset": 77}, {"referenceID": 0, "context": "P : S \u00d7A\u00d7S 7\u2192 [0, 1] is the state transition model in which P (s, a, s\u2032) indicates the probability of transiting from one state s to another s\u2032 after taking action a; R (s, a, s\u2032) is the corresponding immediate reward for such transition where R : S \u00d7 A \u00d7 S 7\u2192 R.", "startOffset": 14, "endOffset": 20}, {"referenceID": 14, "context": "The policy of an MDP is to choose actions for any state s \u2208 S in the system [15, 24].", "startOffset": 76, "endOffset": 84}, {"referenceID": 23, "context": "The policy of an MDP is to choose actions for any state s \u2208 S in the system [15, 24].", "startOffset": 76, "endOffset": 84}, {"referenceID": 22, "context": "There are two types of policies: (1) the deterministic policy \u03c0 : S 7\u2192 A selects an action directly for the state, and (2) the stochastic policy \u03c0 : s \u2208 S 7\u2192 \u03c0 (\u00b7 | s) \u2208 P (A) chooses the action for any state s by providing s with a probability distribution over all the possible actions [23].", "startOffset": 288, "endOffset": 292}, {"referenceID": 0, "context": "In mHealth, the stochastic policy is preferred due to two reasons: (a) current evidence shows that some randomness in the action is likely to draw users\u2019 interest, thus helpful to reduce the intervention burden/habituation [1, 3, 27]; (b) though some deterministic policy is theoretically optimal for the MDP, however, we do not know where it is for the large state space on the one hand and the MDP is a simplification for the complex behavioral process on the other; some variation may be helpful to explore the system and search for a desirable policy [3].", "startOffset": 223, "endOffset": 233}, {"referenceID": 2, "context": "In mHealth, the stochastic policy is preferred due to two reasons: (a) current evidence shows that some randomness in the action is likely to draw users\u2019 interest, thus helpful to reduce the intervention burden/habituation [1, 3, 27]; (b) though some deterministic policy is theoretically optimal for the MDP, however, we do not know where it is for the large state space on the one hand and the MDP is a simplification for the complex behavioral process on the other; some variation may be helpful to explore the system and search for a desirable policy [3].", "startOffset": 223, "endOffset": 233}, {"referenceID": 26, "context": "In mHealth, the stochastic policy is preferred due to two reasons: (a) current evidence shows that some randomness in the action is likely to draw users\u2019 interest, thus helpful to reduce the intervention burden/habituation [1, 3, 27]; (b) though some deterministic policy is theoretically optimal for the MDP, however, we do not know where it is for the large state space on the one hand and the MDP is a simplification for the complex behavioral process on the other; some variation may be helpful to explore the system and search for a desirable policy [3].", "startOffset": 223, "endOffset": 233}, {"referenceID": 2, "context": "In mHealth, the stochastic policy is preferred due to two reasons: (a) current evidence shows that some randomness in the action is likely to draw users\u2019 interest, thus helpful to reduce the intervention burden/habituation [1, 3, 27]; (b) though some deterministic policy is theoretically optimal for the MDP, however, we do not know where it is for the large state space on the one hand and the MDP is a simplification for the complex behavioral process on the other; some variation may be helpful to explore the system and search for a desirable policy [3].", "startOffset": 555, "endOffset": 558}, {"referenceID": 0, "context": "the estimated \u03b8\u0302, which is important to behavior scientists for the state (feature) design [1, 3].", "startOffset": 91, "endOffset": 97}, {"referenceID": 2, "context": "the estimated \u03b8\u0302, which is important to behavior scientists for the state (feature) design [1, 3].", "startOffset": 91, "endOffset": 97}, {"referenceID": 14, "context": "In RL, value is a core concept that quantifies the quality of a policy \u03c0 [15].", "startOffset": 73, "endOffset": 77}, {"referenceID": 27, "context": "There are two definitions of values: the state value and the state-action (Q-) value [28].", "startOffset": 85, "endOffset": 89}, {"referenceID": 25, "context": "state transition and immediate reward) is assumed to be unknown, andQ-value allows for action selection without knowing the model while the state value requires the model for the action selection [26].", "startOffset": 196, "endOffset": 200}, {"referenceID": 22, "context": "The goal of RL is to learn an optimal policy \u03c0\u2217 that maximizes the Q-value for all the state-action pairs via interactions with the dynamic system [23].", "startOffset": 147, "endOffset": 151}, {"referenceID": 23, "context": "Moreover, the actor-critic algorithm has great properties of quick convergence with low variance and learning continuous policies [24].", "startOffset": 130, "endOffset": 134}, {"referenceID": 28, "context": "It is well known that due to the Markovian property, the Q-value satisfies the linear Bellman equation [29] for any policy \u03c0:", "startOffset": 103, "endOffset": 107}, {"referenceID": 25, "context": "the stochastic policy matrix, where \u03a0\u03c0 (s, (s, a)) = \u03c0 (a | s) [26].", "startOffset": 63, "endOffset": 67}, {"referenceID": 29, "context": "Once both the reward and the state transition models are given [30], it is easy to obtain the analytical solution as q = (I\u2212 \u03b3P\u03a0\u03c0) r.", "startOffset": 63, "endOffset": 67}, {"referenceID": 22, "context": "We then learn the value Qw from observations via a supervised learning paramdigm, which, however, is much more challenging than the general supervised learning since the Q-value is not directly observed [23].", "startOffset": 203, "endOffset": 207}, {"referenceID": 14, "context": "Although MC can provide an unbiased estimation of Qw, it is not suitable for mHealth since MC can\u2019t learn from the incomplete trajectory [15].", "startOffset": 137, "endOffset": 141}, {"referenceID": 14, "context": "As a central idea of RL [15], the temporal-difference (TD) learning is able to make use of the Bellman equation (3) and to learn the value from the incomplete trajectories.", "startOffset": 24, "endOffset": 28}, {"referenceID": 25, "context": "We employ the least-square TD for the Q-value (LSTDQ) estimation, due to its advantage of efficient use of samples over the pure temporal-difference algorithms [26, 31].", "startOffset": 160, "endOffset": 168}, {"referenceID": 30, "context": "We employ the least-square TD for the Q-value (LSTDQ) estimation, due to its advantage of efficient use of samples over the pure temporal-difference algorithms [26, 31].", "startOffset": 160, "endOffset": 168}, {"referenceID": 29, "context": "The goal of LSTDQ is to learn a Qw to approximately satisfy the Bellman equation (3), by minimizing the TD error [30] as", "startOffset": 113, "endOffset": 117}, {"referenceID": 0, "context": "They share no information and run a separate algorithm for each user [1].", "startOffset": 69, "endOffset": 72}, {"referenceID": 0, "context": "Following this idea, we extend [1] to the separate RL setting.", "startOffset": 31, "endOffset": 34}, {"referenceID": 0, "context": "Here \u2016\u03b8n\u201622 is the constraint to make (9) a well-posed problem and \u03b6a is the tuning parameter that controls the strength of the smooth penalization [1].", "startOffset": 148, "endOffset": 151}, {"referenceID": 31, "context": "It is a famous phenomenon observed in lots of social behavior studies [32, 33] that people are widely connected in a network and linked users tend to have similar behaviors.", "startOffset": 70, "endOffset": 78}, {"referenceID": 32, "context": "It is a famous phenomenon observed in lots of social behavior studies [32, 33] that people are widely connected in a network and linked users tend to have similar behaviors.", "startOffset": 70, "endOffset": 78}, {"referenceID": 21, "context": "Besides, individuals are widely connected due to the similar features, such as age, gender, race, religion, education level, work, income, other socioeconomic status, medical records and genetics features etc [22].", "startOffset": 209, "endOffset": 213}, {"referenceID": 16, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 17, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 18, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 33, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 34, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 35, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 36, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 37, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 38, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 39, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 40, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 41, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 42, "context": "There is noisy and misleading relational information in the network for mHealth WS[17\u201319, 34\u201343].", "startOffset": 82, "endOffset": 96}, {"referenceID": 43, "context": "The MDPs of one user on two diverse mHealth studies should be very different; for example, the MDP in the HeartSteps study [44] for one user should be different from that in the alcohol control [8, 9] study.", "startOffset": 123, "endOffset": 127}, {"referenceID": 7, "context": "The MDPs of one user on two diverse mHealth studies should be very different; for example, the MDP in the HeartSteps study [44] for one user should be different from that in the alcohol control [8, 9] study.", "startOffset": 194, "endOffset": 200}, {"referenceID": 8, "context": "The MDPs of one user on two diverse mHealth studies should be very different; for example, the MDP in the HeartSteps study [44] for one user should be different from that in the alcohol control [8, 9] study.", "startOffset": 194, "endOffset": 200}, {"referenceID": 44, "context": "where vi \u2208 N (vj) indicates that i-th node is the KNN of the j-th node [45]; (11) is an undirected Graph.", "startOffset": 71, "endOffset": 75}, {"referenceID": 42, "context": "\u2016wi \u2212wj\u2016 and \u2016\u03b8i \u2212 \u03b8j\u2016 are small if i \u2194 j [43, 46].", "startOffset": 42, "endOffset": 50}, {"referenceID": 45, "context": "\u2016wi \u2212wj\u2016 and \u2016\u03b8i \u2212 \u03b8j\u2016 are small if i \u2194 j [43, 46].", "startOffset": 42, "endOffset": 50}, {"referenceID": 46, "context": "the fixedpoint step) [47].", "startOffset": 21, "endOffset": 25}, {"referenceID": 16, "context": "It is an advantage of our methods over the network based bandit [17].", "startOffset": 64, "endOffset": 68}, {"referenceID": 47, "context": "According to the Encapsulating Sum [48], we have", "startOffset": 35, "endOffset": 39}, {"referenceID": 48, "context": "Then the eigenvalues of A \u2297 B [49], where \u2297 is the Kronecker Product, are", "startOffset": 30, "endOffset": 34}, {"referenceID": 29, "context": "They do not put the `2 constraint on the fixed-point variable W [30, 47].", "startOffset": 64, "endOffset": 72}, {"referenceID": 46, "context": "They do not put the `2 constraint on the fixed-point variable W [30, 47].", "startOffset": 64, "endOffset": 72}, {"referenceID": 2, "context": "{0, 1} , where a = 1 means sending the positive intervention, while a = 0 indicates no intervention [3].", "startOffset": 100, "endOffset": 103}, {"referenceID": 43, "context": "To verify the performance of our method, we use a dataset from a mobile health study, called HeartSteps [44], to approximate the generative model.", "startOffset": 104, "endOffset": 108}, {"referenceID": 43, "context": "interventions), which are adapted to users\u2019 ongoing status, such as suggesting users to take a walk after long sitting [44], or to do some exercises after work.", "startOffset": 119, "endOffset": 123}, {"referenceID": 0, "context": "A trajectory of T tuples D = {(si, ai,ri) | i = 1, \u00b7 \u00b7 \u00b7 , T} are generated for each user [1, 3].", "startOffset": 90, "endOffset": 96}, {"referenceID": 2, "context": "A trajectory of T tuples D = {(si, ai,ri) | i = 1, \u00b7 \u00b7 \u00b7 , T} are generated for each user [1, 3].", "startOffset": 90, "endOffset": 96}, {"referenceID": 0, "context": "8 The value of \u03b3 specifies different RL methods: (a) \u03b3 = 0 means the contextual bandit [1]; (b) 0 < \u03b3 < 1 is the discounted reward RL, which is first compared in the online actor-critic setting for mHealth.", "startOffset": 87, "endOffset": 90}, {"referenceID": 3, "context": "Such process is called drawing warm start trajectory (WST) via the micro-randomized trials [4, 44], and T0 is the length of the WST.", "startOffset": 91, "endOffset": 98}, {"referenceID": 43, "context": "Such process is called drawing warm start trajectory (WST) via the micro-randomized trials [4, 44], and T0 is the length of the WST.", "startOffset": 91, "endOffset": 98}, {"referenceID": 0, "context": "To achieve a more practical dataset compared with [1, 3, 4], we come up with a method to generate N users (i.", "startOffset": 50, "endOffset": 59}, {"referenceID": 2, "context": "To achieve a more practical dataset compared with [1, 3, 4], we come up with a method to generate N users (i.", "startOffset": 50, "endOffset": 59}, {"referenceID": 3, "context": "To achieve a more practical dataset compared with [1, 3, 4], we come up with a method to generate N users (i.", "startOffset": 50, "endOffset": 59}, {"referenceID": 0, "context": "There are three online actor-critic RL methods for the comparison: (a) Separate-RL, which is an extension of the online actor-critic contextual bandit in [1] to the online actor-critic reinforcement learning.", "startOffset": 154, "endOffset": 157}, {"referenceID": 7, "context": "MDPs), for example measuring how much alcohol users have in a fixed time period in the alcohol use study [8, 9].", "startOffset": 105, "endOffset": 111}, {"referenceID": 8, "context": "MDPs), for example measuring how much alcohol users have in a fixed time period in the alcohol use study [8, 9].", "startOffset": 105, "endOffset": 111}, {"referenceID": 48, "context": "Since for any matrices A \u2208 Rl\u00d7k and D \u2208 Rm\u00d7n, the Kronecker product has the property (A\u2297D) = (AT \u2297DT) [49].", "startOffset": 102, "endOffset": 106}], "year": 2017, "abstractText": "In the wake of the vast population of smart device users worldwide, mobile health (mHealth) technologies are hopeful to generate positive and wide influence on people\u2019s health. They are able to provide flexible, affordable and portable health guides to device users. Current online decision-making methods for mHealth assume that the users are completely heterogeneous. They share no information among users and learn a separate policy for each user. However, data for each user is very limited in size to support the separate online learning, leading to unstable policies that contain lots of variances. Besides, we find the truth that a user may be similar with some, but not all, users, and connected users tend to have similar behaviors. In this paper, we propose a network cohesion constrained (actor-critic) Reinforcement Learning (RL) method for mHealth. The goal is to explore how to share information among similar users to better convert the limited user information into sharper learned policies. To the best of our knowledge, this is the first online actor-critic RL for mHealth and first network cohesion constrained (actor-critic) RL method in all applications. The network cohesion is important to derive effective policies. We come up with a novel method to learn the network by using the warm start trajectory, which directly reflects the users\u2019 property. The optimization of our model is difficult and very different from the general supervised learning due to the indirect observation of values. As a contribution, we propose two algorithms for the proposed online RLs. Apart from mHealth, the proposed methods can be easily applied or adapted to other health-related tasks. Extensive experiment results on the HeartSteps dataset demonstrates that in a variety of parameter settings, the proposed two methods obtain obvious improvements over the state-of-the-art methods.", "creator": "LaTeX with hyperref package"}}}