{"id": "1206.4664", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "18-Jun-2012", "title": "Tighter Variational Representations of f-Divergences via Restriction to Probability Measures", "abstract": "we fully show that easily the variational representations for f - derivative divergences currently here used naturally in the literature can be visibly tightened.. this has implications to require a number of general methods recently systematically proposed based systematically on expanding this representation. as an example for application we use our qu tighter representation syntax to derive forth a general f - divergence estimator derivative based partly on two i.? i. d. samples and derive the dual independent program vector for this estimator sum that already performs well empirically. consequently we essentially also point somewhat out a specific connection between our estimator analog and classical mmd.", "histories": [["v1", "Mon, 18 Jun 2012 15:31:13 GMT  (503kb)", "http://arxiv.org/abs/1206.4664v1", "ICML2012"]], "COMMENTS": "ICML2012", "reviews": [], "SUBJECTS": "cs.LG stat.ML", "authors": ["avraham ruderman", "mark d reid", "dario garc\u00eda-garc\u00eda", "james petterson"], "accepted": true, "id": "1206.4664"}, "pdf": {"name": "1206.4664.pdf", "metadata": {"source": "CRF", "title": "Tighter Variational Representations of f-Divergences via Restriction to Probability Measures", "authors": ["Avraham Ruderman", "Mark D. Reid", "Dar\u00edo Garc\u00eda-Garc\u00eda"], "emails": ["AVRAHAM.RUDERMAN@NICTA.COM.AU", "MARK.REID@ANU.EDU.AU", "DARIO.GARCIA@ANU.EDU.AU", "JAMES.PETTERSON@NICTA.COM.AU"], "sections": [{"heading": "1. Introduction", "text": "An important class of discrepancy measures between probability distributions is the family of f -divergences (also known as Ali-Silvey (Ali & Silvey, 1966) or Csisz\u00b7r divergences (Csisz\u00e1r, 1967)). These include the variational divergence, the Hellinger distance, and the well-known Kullback-Leibler (KL) divergence. Estimates of these measures from two i.i.d. samples can be used to test whether or not those samples come from similar distributions. Due to the convexity of the eponymous f function defining them, f -divergences can be expressed variationally as the maximum of an optimisation problem. This variational representation has been recently used for f -divergence estimation (Nguyen et al., 2010; 2007; Kanamori et al., 2011) homogeneity testing (Kanamori et al., 2011) and parameter estimation (Broniatowski & Keziou, 2009).\nThis paper stems from a simple observation: the vari-\nAppearing in Proceedings of the 29 th International Conference on Machine Learning, Edinburgh, Scotland, UK, 2012. Copyright 2012 by the author(s)/owner(s).\national representation currently being used in the literature fails to take into account the fact that divergences are defined between probability distributions. In an analysis similar to that of Altun and Smola\u2019s (Altun & Smola, 2006), we present a derivation of a quantifiably tighter variational representation of f -divergences. Our derivation restricts the convex dual used in the variational representation of an f - divergence to the space of probability distributions. This generalises similar observations for the specific case of the KL divergence, such as Banerjee\u2019s compression lemma (Banerjee, 2006). These results are given in the remainder of this section.\nClearly, use of this tighter variational representation in any algorithm relying on the previous bounds would be advantageous. Thus, we suspect this tighter bound will find broad applicability as the weaker variational form is already widely used. As an example of this, in section 2. we derive a general dual program for an RKHS estimator which has a simple closed form for any f -divergence. We show this dual program has a natural interpretation as a trade off between the minimisation of the f -divergence in question and the minimum mean discrepancy (MMD) (Gretton et al., 2008) between the empirical distributions. Experiments in section 3 confirm that the tighter variational form underlying our approach leads to better KL divergence estimates than the well known estimator of (Nguyen et al., 2010; 2007) which is based on the looser representation. We also provide an empirical comparison to other state of the art methods for f -divergence estimation."}, {"heading": "1.1. Convex Duality", "text": "We briefly introduce some key ideas from convex duality. The reader is referred to (Barbu & Precupanu,\n1986) for details. For functions f : X \u2192 R defined over a Banach space X the (Fenchel or convex) dual f? : X? \u2192 R of a function is defined over the dual space X? by f?(x?) := supx\u2208X\u3008x?, x\u3009 \u2212 f(x) where \u3008\u00b7, \u00b7\u3009 is the dual pairing of X and X?. In finite dimensional spaces such as Rd the dual space is also Rd and \u3008\u00b7, \u00b7\u3009 is the usual inner product. The bidual f?? : X \u2192 R of f is just the dual of f? (restricted to X), that is, f??(x) = supx?\u2208X?\u3008x, x?\u3009 \u2212 f?(x?). For convex, lower semi-continuous (l.s.c.) functions f the bidual is the identity transformation, that is, f?? = f . As seen below, this fact forms the basis of many variational representations of operators defined by convex functions.1\nWe make use of a few specific, one-dimensional instances of duals. Specifically, when f(t) = |t\u2212 1| we have f?(t?) = t? for t? \u2208 [\u22121, 1]; and when f(t) = \u2212 ln t for t > 0 we have f?(t?) = \u22121 \u2212 ln t? for t? < 0. Further details and properties of convex duals can be found in texts on convex analysis, e.g., (Hiriart-Urruty & Lemar\u00e9chal, 2001).\nOne obvious but important property we make use of is that the restriction of a supremum leads to smaller optima. Specifically, if X \u2032 \u2286 X then supx\u2208X\u2032 \u03c6(x) \u2264 supx\u2208X \u03c6(x). When applied to convex duals, this means if R \u2286 X? is a restriction of the dual space then\nf(x) \u2265 fR(x) := sup x?\u2208R \u3008x?, x\u3009 \u2212 f?(x?) for all x\u2208X.\n(1)\n1.2. Variational Approximations of f-divergences\nAn f -divergence is defined via a convex function f : [0,\u221e)\u2192 R satisfying f(1) = 0. Given such a function, the f -divergence from a finite measure P to a distribution Q defined on a common space X is defined2 as\nIf (P,Q) := EQ [ f ( dP\ndQ\n)] =\n\u02c6 X f\n( dP\ndQ (x)\n) dQ(x)\nif P Q and +\u221e otherwise. We will refer to the definition above as the general (or unrestricted) f - divergence in contrast to the restricted f -divergence that is only defined when P and Q are both probability distributions. When necessary, the restricted\n1For finite dimensional spaces, this is, in some sense, the only dual that can be used for the kind of variational representations we are interested in (see (Artstein-Avidan & Milman, 2009) for details).\n2The choice of order of the arguments P and Q is arbitrary and other authors, notably (Nguyen et al., 2010), define f -divergence in terms of dQ/dP .\nf -divergence will be distinguished by a superscript R: IRf (P,Q). We emphasise this distinction to later show how a tighter variational representation can be obtained from explicitly taking into account the restriction. Several common divergences are members of this class: the variational divergence is obtained by choosing f(t) = |t \u2212 1|, Hellinger divergence via f(t) = \u221a t2 \u2212 1, and the KL divergence via f(t) = t ln t (see, e.g., (Reid & Williamson, 2011)). For technical reasons we also require f to be lower semi-continuous. All f -divergences discussed above and used in practice satisfy this condition.\nAs in (Altun & Smola, 2006; Barbu & Precupanu, 1986; Broniatowski & Keziou, 2009), we now wish to consider f -divergences as acting over spaces of functions. Given a measure \u00b5 over X (with some \u03c3-algebra), the norms \u2016g\u20161 := \u00b4 X |g| d\u00b5 and \u2016g\u2016\u221e := inf {K \u2265 0 : |g(x)| \u2264 K for \u00b5-almost all x} can be used to define the space of absolutely integrable functions L1(\u00b5) := {g : X \u2192 R : \u2016g\u20161 <\u221e} and its dual space L\u221e(\u00b5) := {g : X \u2192 R : \u2016g\u2016\u221e <\u221e} of functions with bounded essential supremum. The space of probability densities w.r.t. \u00b5 will be denoted \u2206(\u00b5) := { g \u2208 L1(\u00b5) : g \u2265 0, \u2016g\u20161 = 1 } . On finite domains X = {x1, . . . , xn}, the space of densities will be denoted \u2206n. A general f -divergence can be seen as acting on L1(Q) by defining If,Q (r) := EQ [f (r)] for all r \u2208 L1(Q). The restricted f -divergence is then just IRf,Q(r) := If,Q(r) when r \u2208 \u2206(Q) and +\u221e otherwise.\nAs shown below, these functions are convex and lower semi-continuous and therefore admit dual representations. As explored in (Nguyen et al., 2010; Altun & Smola, 2006) and in section 2 below, variational representations such as these readily admit approximation\ntechniques via a restriction of the optimisation for If,Q to functions from F \u2286 L\u221e(Q) (e.g., an RKHS). Our main result is that the restricted variational form guarantees tighter lower bounds on f -divergences than the unrestricted form for any choice of function class.\nTheorem 1. For any distributions P and Q such that P Q we have\nIf (P,Q) = sup \u03c6\u2208L\u221e(Q)\nEP [\u03c6]\u2212 ( IRf,Q )? (\u03c6) (2)\nand for any choice of function class F \u2286 L\u221e(Q)\nIf (P,Q) \u2265 sup \u03c6\u2208F\nEP [\u03c6]\u2212 ( IRf,Q )? (\u03c6)\n\u2265 sup \u03c6\u2208F EP [\u03c6]\u2212 EQ [f?(\u03c6)] . (3)\nWe illustrate the result of Theorem 1 in Figure 1. While our new expression and that of (Nguyen et al., 2010) have the same supremum, our expression is closer to the supremum at every point \u03c6 \u2208 L\u221e(Q). In particular, if one restricts \u03c6 to vary over a subset F \u2282 L\u221e then the supremum of our expression over F will yield a better estimate of If (P,Q).\nProof. We first establish that If,Q is a convex function over L1(Q) via Proposition 2.7 in (Barbu & Precupanu, 1986) which states that for any finite measure Q over X and any proper convex l.s.c. function f : [0,\u221e) \u2192 R \u222a {+\u221e} the function F : Lq(Q) \u2192 (\u2212\u221e,+\u221e] is convex and l.s.c when defined by F (u) :=\u00b4 X f(u) dQ for f(u) \u2208 L1(Q) and +\u221e otherwise. Since\nIf,Q(r) = \u00b4 X f(r) dQ and f satisfies the conditions of the proposition, we have that If,Q is convex and l.s.c.\nThe variational representation for If,Q is then obtained by using Lemma 4.5.8 of (Dembo & Zeitouni, 2009). This states that for any Banach spaceX with dualX?, if F : X \u2192 R\u222a{+\u221e} is convex and l.s.c. then F (x) = supx?\u2208X? {\u3008x?, x\u3009 \u2212 F ?(x?)}. Since If,Q is convex and l.s.c. on L1(Q) we see that\nIf,Q (r) = sup \u03c6\u2208L\u221e(Q)\n{ EQ [\u03c6r]\u2212 (If,Q)? (\u03c6) } = (If,Q)?? (r)\nfor all r \u2208 L1(Q) since L\u221e(Q) is the dual space to L1(Q). In particular, we can conclude that for all r \u2208 L1(Q) and all \u03c6 \u2208 L\u221e(Q)\nIf,Q(r) \u2265 EQ [\u03c6r]\u2212 (If,Q)? (\u03c6). (4)\nNow, since IRf,Q is defined to be If,Q on \u2206(Q) and +\u221e on the rest of L1(Q) we see that for all \u03c6 \u2208 L\u221e(Q)\n( IRf,Q )? (\u03c6) = sup\nr\u2208L1(Q)\n{ EQ [\u03c6r]\u2212 IRf,Q (r) } = sup p\u2208\u2206(Q) {EQ [\u03c6p]\u2212 If,Q (p)} . (5)\nThis implies that for all \u03c6 \u2208 L\u221e(Q) and for all p \u2208 \u2206(Q) we have ( IRf,Q )? (\u03c6) + If,Q(p) \u2265 EQ [\u03c6p] which rearranged and optimised over \u03c6 \u2208 L\u221e(Q) yields (2). We now observe that (5) is just a constrained version of the optimisation defining (If,Q)?, and so by (1) we must have ( IRf,Q )? \u2264 (If,Q)?. Substituting this into (4) we see that for any p \u2208 \u2206 (Q) , \u03c6 \u2208 L\u221e (Q)\nIf,Q (p) \u2265 EQ [\u03c6p]\u2212 ( IRf,Q )? (\u03c6) \u2265 EQ [\u03c6p]\u2212(If,Q)? (\u03c6) .\nTaking supremums over these inequalities for \u03c6 \u2208 F \u2286 L\u221e(Q) yields (3), as required.\nFor the particular case of KL divergence estimation the above theorem specialises to show that for any choice of \u03c6 \u2208 L\u221e(Q)\nKL(P,Q) \u2265 EP [\u03c6]\u2212lnEQ [ e\u03c6 ] \u2265 EP [\u03c6]\u2212EQ [ e\u03c6 + 1 ] .\nThe first inequality is the well-known representation of the KL divergence in the large deviations literature (Donsker & Varadhan, 1983) which has been rediscovered in the PAC-Bayes community as the compression lemma (Banerjee, 2006). Although the second inequality can be obtained immediately from the fact that \u2212 log (y) \u2265 \u2212y + 1 for all y > 0, Theorem (1) shows that a similar result holds for general f -divergences."}, {"heading": "2. Estimation using RKHS methods", "text": "Given two samples3 Xn := {x1, . . . , xn} and Yn := {y1, . . . , yn} from P and Q respectively, we wish to use the empirical measures Pn := 1n \u2211n i=1 \u03b4xi and Qn := 1 n \u2211n i=1 \u03b4yi as proxies for P and Q. However, since we no longer have Pn Qn some form of smoothing is required. We make use of the restricted dual variational representation of the f -divergence and choose a sufficiently constrained function class over which the supremum is taken when computing the dual. Specifically, we let H \u2282 L\u221e(Q) be an RKHS with reproducing kernel K and corresponding feature map \u03a6 and choose some convex regularizer \u2126 : H \u2192 R \u222a {+\u221e}, for example, some function of the RKHS norm \u2016 \u00b7 \u2016H. As in (Nguyen et al., 2010), our estimator is then defined via the dual representation of IRf,Qn that takes\n3We assume that the samples are of equal size for simplicity. The analysis also goes through in the general case.\ninto account the regulariser \u2126, i.e.,\nE(Pn, Qn) := sup h\u2208H\n{ EPn [h]\u2212 ( IRf,Qn )? (h)\u2212 \u2126(h) } .\n(6) The following result gives an explicit dual optimisation program for computing E in the RKHS H.\nTheorem 2. Let H be an RKHS of functions over X with associated feature map \u03a6. Then the estimator E(Pn, Qn) satisfies, for all Pn and Qn\nE(Pn, Qn) = min \u03b1\u2208\u2206n\n{ 1\nn n\u2211 i=1 f (n\u03b1i)\n+ \u2126?\n( 1\nn n\u2211 i=1 \u03a6 (xi)\u2212 1 n n\u2211 i=1 n\u03b1i\u03a6 (yi) )} (7)\nwhere the minimisation is over the n-simplex \u2206n.\nProof. The proof techniques here are based on those in (Nguyen et al., 2007). Since H is a RKHS, we can represent each function h \u2208 H by h (x) = \u3008w,\u03a6 (x)\u3009 for x \u2208 X where \u03a6 is the feature map corresponding to K. In this case, the estimator in (6) is given by\nsup w\n{ 1\nn n\u2211 i=1 \u3008w,\u03a6 (xi)\u3009 \u2212 ( IRf,Qn )? (\u3008w,\u03a6 (\u00b7)\u3009)\u2212 \u2126 (w)\n} .\nLetting \u03c8 (w) := \u2212 1n \u2211n i=1 \u3008w,\u03a6 (xi)\u3009 and \u03d5 (w) :=(\nIRf,Qn )?\n(\u3008w,\u03a6 (\u00b7)\u3009) and substituting into the above expression gives\nsup w {\u3008w, 0\u3009 \u2212 (\u03c8 (w) + \u03d5 (w) + \u2126 (w))} = (\u03c8 + \u03d5+ \u2126)? (0)\nby the definition of a dual. By the infimal convolution theorem (Rockafellar, 1997) we therefore have\nE(Pn, Qn) = min s,r {\u03c8? (s) + \u03d5? (r) + \u2126? (\u2212s\u2212 r)} .\n(8) Now, since \u03c8 is linear in w its dual is simply\n\u03c8? (s) =\n{ 0 , if s = \u2212 1n \u2211n i=1 \u03a6 (xi)\n+\u221e , otherwise.\nTo compute the dual of \u03d5 we observe that ( IRf,Qn )? (h) only depends on the values of h at y1, . . . , yn so we can\nwrite\n\u03d5? (r) = sup w\n{ \u3008w, r\u3009 \u2212 ( IRf,Qn )? (\u3008w,\u03a6 (\u00b7)\u3009) } = sup w,\u03b1,h { \u3008w, r\u3009 \u2212 ( IRf,Qn )? (h)\n\u2212 n\u2211 i=1 \u03b1(yi) (\u3008w,\u03a6 (yi)\u3009 \u2212 h(yi)) } = sup w,\u03b1,h { \u3008w, r\u3009 \u2212 ( IRf,Qn )? (h)\n\u2212 \u2329 w,\nn\u2211 i=1 \u03b1(yi)\u03a6 (yi)\n\u232a + 1\nn n\u2211 i=1 n\u03b1(yi)h(yi)\n}\nby the introduction of Lagrange multipliers \u03b1(yi) for the constraints h(yi) = \u3008w,\u03a6(yi)\u3009. Noting that 1 n \u2211n i=1 n\u03b1(yi)h(yi) = EQn [n\u03b1h] we get\n\u03d5?(r) = sup w,\u03b1,h\n{ EQn [n\u03b1h]\u2212 ( IRf,Qn )? (h)\n\u2212 \u2329 w, r \u2212\nn\u2211 i=1 \u03b1i\u03a6 (yi)\n\u232a}\n= sup \u03b1 { sup h { EQn [n\u03b1h]\u2212 ( IRf,Qn )? (h) }\n+ sup w\n{\u2329 w,\nn\u2211 i=1 \u03b1i\u03a6 (yi)\u2212 r\n\u232a}}\n= sup \u03b1\n{ IRf,Qn (n\u03b1) : n\u2211 i=1 \u03b1i\u03a6(yi) = r }\nsince the first inner supremum is the bidual of IRf,Qn and the second supplies the constraint. Furthermore, since \u03a6(yi) are linearly independent, each r uniquely determines \u03b1 at y1, . . . , yn so \u03d5?(r) = IRf,Qn(n\u03b1). Substituting \u03c8?, \u03d5?, and the corresponding constraints on s and r back into the minimisation (8) and noting that IRf,Qn is +\u221e for n\u03b1 /\u2208 \u2206(Qn) w \u2206\nn gives the required result:\nE(Pn, Qn) = min \u03b1\u2208\u2206n\n{ 1\nn n\u2211 i=1 f (n\u03b1i)\n+ \u2126?\n( 1\nn n\u2211 i=1 \u03a6 (xi)\u2212 1 n n\u2211 i=1 (n\u03b1i) \u03a6 (yi)\n)} .\nWe note that E(Pn, Qn) is not a direct estimate of If (P,Q) due to the inclusion of the regularisation term \u2126(h). However, \u03d5?(r) = IRf,Qn(n\u03b1) = 1 n \u2211n i=1 f (n\u03b1i) can be used as an empirical estimate of If (P,Q) once the values of \u03b1i are obtained and r\u0302 = n\u03b1 can be seen\nas an estimate of dP/dQ. Thus, the theorem above gives an easily implementable algorithm for estimating f -divergences.\nComputing \u2126? for particular choices of \u2126 in equation (7) immediately gives the following corollary which defines two concrete estimators. Corollary 3. For \u2126(g) = \u03bbn2 \u2016g\u2016 2 H\nE(Pn, Qn) = min \u03b1\u2208\u2206n\n{ 1\nn n\u2211 i=1 f (n\u03b1i)\n+ 1\n2\u03bbn \u2225\u2225\u2225\u2225\u2225 1n n\u2211 i=1 \u03a6 (xi)\u2212 1 n n\u2211 i=1 n\u03b1i\u03a6 (yi) \u2225\u2225\u2225\u2225\u2225 2\nH  (9)\nand for \u2126(g) = \u221a \u03bbn\u2016g\u2016H\nE(Pn, Qn) = min \u03b1\u2208\u2206n\n{ 1\nn n\u2211 i=1\nf (n\u03b1i) :\u2225\u2225\u2225\u2225\u2225 1n n\u2211 i=1 \u03a6 (xi)\u2212 1 n n\u2211 i=1 n\u03b1i\u03a6 (yi) \u2225\u2225\u2225\u2225\u2225 H \u2264 \u221a \u03bbn } .\n(10)\nThe minimisation in (10) is similar to the one discussed in (Altun & Smola, 2006) which is concerned with density estimation from a single sample. Our estimator can be seen as an extension of that procedure to the two sample setting. The estimator M2 proposed in (Nguyen et al., 2010) uses square norm regularisation in a two sample setting and is therefore directly comparable to (9). The key difference is that we restrict the minimisation to \u2206n whereas the M2 minimisation is over \u03b1 \u2265 0."}, {"heading": "2.1. Connections with Maximum Mean Discrepancy", "text": "The relation of the optimisation program in (9) to the original f -divergence is compelling. The first term 1 n \u2211n i=1 f (n\u03b1i) is simply the empirical estimate of the f divergence of the likelihood ratio dPdQ since each n\u03b1i = \u03b1i 1/n is an estimate of dP dQ (yi) when Qn is taken to be uniform over y1, . . . , yn. Since f(1) = 0, minimising this term alone would force the \u03b1i = 1n for all i. In this sense, the first term can be seen as a kind of generalised MaxEnt regularisation.\nThe second term can be seen as a term that forces the \u03b1i terms to \u201cmatch\u201d empirical means of the feature vectors \u03a6(xi) and \u03a6(yi). Following (Gretton et al., 2008), we can formalise the observation regarding the second term by considering the mean map \u00b5 from\ndistributions R over X to functions in an RKHS H defined by R 7\u2192 \u00b5 [R] := Ex\u223cR [\u03a6(x)]. The maximum mean discrepancy (MMD) between distributions P and Q is then defined to be the distance between their respective images under \u00b5, that is, MMD(P,Q) = \u2016\u00b5 [P ]\u2212 \u00b5 [Q]\u2016H. The second term in our estimator is then just MMD2(Pn, \u03b1) which is a measure of the discrepancy between the distributions corresponding to the densities dPn and n\u03b1dQn. Thus, minimising that term alone corresponds to an unregularised estimation of the density ratio dP/dQ. Similarly, for other choices of regularisation \u2126 which are a function of \u2016 \u00b7 \u2016H, this \u201cdata matching\u201d term will be a dual function of MMD(Pn, \u03b1).\nThis analysis also leads to an intuitive explanation why we should use the regularisation schedule \u03bbn = \u0398 ( n\u22121 ) as per (Nguyen et al., 2009). It was shown in (Gretton et al., 2008) that the MMD estimator\n\u221a n \u2225\u2225\u2225\u2225\u2225 1n n\u2211 i=1 \u03a6 (yi)\u2212 1 n n\u2211 i=1 \u03a6 (xi) \u2225\u2225\u2225\u2225\u2225 H\nconverges to a normal distribution with constant variance. If \u03b1 is suitably bounded away from infinity, the same holds for the second term in (9) as long as \u03bbn = \u0398 ( n\u22121 ) . If \u03bbn is of smaller order, then the MMD term will eventually dominate the general MaxEnt term which converges to a positive constant if P 6= Q. On the other hand if \u03bbn diminishes more slowly, then the MMD term will go to zero even for an incorrect density ratio."}, {"heading": "3. Experiments", "text": "Theorem 1 shows the restricted variational bound derived here is strictly tighter than the one proposed by (Nguyen et al., 2010) (henceforth NWJ) for every function r \u2208 L1(Q) except when r = dP/dQ in which case they coincide and attain the optimum. This suggests that the optimisation problem derived using our tighter bound should result in an estimator with a smaller bias. This section presents some empirical results demonstrating this improvement. We also conducted experiments to compare our method and Nguyen et al\u2019s method to others methods in the literature which are not based on variational representations of f -divergence. While these non variational methods are not the focus of the experiments, we include them here as they may be of interest to others. In the context of the current work however, we emphasise the superior performance of our estimator compared to that of NWJ illustrating the utility of the tighter variational representation. We include the following recent estimators for comparison:\n\u2022 Wang et al (Wang et al., 2009): This estimator is based on nearest neighbour estimates of the two densities and does not make use of a variational representation.\n\u2022 Kanamori et al (Kanamori et al., 2009): This is a least-squares estimator for the density ratio, bypassing individual density estimations. Once the density ratio is estimated, it can be directly plugged in the f -divergence formulae. We also experimented with another density ratio estimation method (Sugiyama et al., 2008), with very similar results.\n\u2022 Garc\u00eda et al (Garc\u00eda-Garc\u00eda et al., 2011): This estimator uses nearest neighbour misclassification rates and a reformulation of f -divergences in terms of risks."}, {"heading": "3.1. Method", "text": "Both our estimator based on (9) and the M2 estimator of NWJ were implemented using the nonlinear convex optimisation routine from the python package Cvxopt to perform the optimization. The implementation of the Wang et al. (Wang et al., 2009) estimator (henceforth WKV) was based on the cKDTree nearest neighbour routine from the SciPy library. Kanamori et al 4. (uLSIF) and Garc\u00eda et al 5 ((f, l)) algorithms were implemented using code provided by the respective authors 6. The method for choosing the parameters \u03bbn and \u03c3 for the NWJ estimator are not specified in (Nguyen et al., 2010). For both NWJ and our estimator, we therefore set \u03bbn = 1n (as discussed above) and set \u03c3 to the sample variance overXn\u222aYn to ensure invariance with respect to rescaling of the data.\nIn every experiment, the distributions P and Q were set to beta distributions B(\u03b1, \u03b2) for some choice of parameters \u03b1, \u03b2 > 0. Beta distributions were chosen as they cover a wide variety of shapes and have a KL divergence with the following analytic form\nKL(B(\u03b11, \u03b21), B(\u03b12, \u03b22)) = ln B(\u03b12, \u03b22)\nB(\u03b11, \u03b21)\n\u2212d\u03b1\u03c8(\u03b11)\u2212 d\u03b2\u03c8(\u03b21) + (d\u03b1 + d\u03b2)\u03c8(\u03b11 + \u03b21)\nwhere d\u03b1 = \u03b12 \u2212 \u03b11 and \u03c8(v) = \u0393 \u2032(v)\n\u0393(v) is the digamma function. For each choice of P and Q, a 1-dimensional and a 10-dimensional experiment was performed. In the 1-d experiment, samples of n = 100 values, X100\n4http://sugiyama-www.cs.titech.ac.jp/~sugi/ software/uLSIF\n5http://www.tsc.uc3m.es/~dggarcia/code.html 6All code has been submitted as supplementary mate-\nrial.\nand Y100, were each drawn i.i.d. from P and Q respectively. In the 10-d experiment, each x \u2208 X100 \u2282 R10 and y \u2208 Y100 \u2282 R10 was drawn i.i.d. from the respective product distributions P\u00d7 \u220f9 i=1N(0, 0.01) and\nQ\u00d7 \u220f9 i=1N(0, 0.01). This gives samples from two distributions embedded in a 10-dimensional space where all but one of the dimensions is zero mean Gaussian noise. The KL divergences for the 10-d product distributions for each choice of P and Q are the same as for the 1-d case, that is, KL(P,Q). The specific P and Q in the experiments were chosen to give a range of different KL divergence values and explore a few different pairings of distributional shapes."}, {"heading": "3.2. Results", "text": "Table 1 summarises the application of all five estimators over 250 runs of the 1-d (odd rows) and 10- d experiments (even rows) for various choices of P and Q shown in the first column. The pairs of rows are ordered in increasing value of true KL divergence (shown in the second column) and is the same for both rows. The table lists the divergence estimates averaged over the different runs as well as the empirical Mean Squared Error (MSE). The bold values for the MSE correspond to the lowest amongst the different estimators. Where the MSE of our estimator or that of NWJ is strictly lower than the other, we have italicised the MSE. The last three columns are in grey as they are not the main point of the experiments."}, {"heading": "3.3. Discussion", "text": "For the most part our estimator performs better in terms of MSE than that of the NWJ. When the true divergence is large, the difference is especially pronounced. This is unsurprising as our estimator is based on a tighter bound for the divergence as Theorem 1 shows. For small divergences the difference is smaller since roughly speaking, 0 \u2264 NWJ \u2264 Ours \u2264 KL(P,Q). Thus, for small divergences the estimators must necessarily return similar values.\nIn contrast, the nearest neighbour-based methods (WKV and (f, l)) behave very differently to variational estimators. In general, their bias is significantly lower than both variational methods when the real divergence is large. This is a natural conclusion, since the variational methods presented here are intrinsically lower bounds of the real divergence. Finally, we note that uLSIF does not perform as well as the other methods. This is to be expected as uLSIF is primarily designed for density ratio estimation while the rest of the methods are derived specifically for divergence estimation.\nOn the 10-d experiments, the MSE performance of the WKV estimator is typically much worse than the rest of methods. It consistently over-estimates the true KL divergence and, for B(1, 4) vs B(3, 1), drastically overshoots it, resulting in an order of magnitude larger MSE than the other estimators. One likely explanation of this poor performance of WKV on the higher dimensional problems is that its estimated values scale with the dimension of the data. This scaling occurs even if the two distributions differ only on a low dimensional manifold, as they do in the 10-d experiments. The success of this estimator in the B(1, 1) vs B(10, 10) experiment is likely a coincidence. All the estimators underestimate this divergence in the 1- d case and we expect that the scaling of WKV with the dimension has pushed its estimate up to the true KL. The (f, l) estimator, although also based on nearest neighbour techniques, does not suffer from this problem since it does not present a explicit dependance of the estimated divergence with respect to the ambient dimension.\nIn light of these observations, we offer some guidelines as to which estimator to use if one has some prior knowledge or suspicion about the data. Use our method when suspecting a low divergence; use (f, l) for high divergence. We also recommend using variational methods over nearest neighbour estimators for hypothesis testing if false positives are a concern since the variational methods are much more likely to consistently underestimate the true divergence. It is important however to note that if running time is an issue then WKV becomes a very attractive option. There are many fast approximate nearest neighbour\nalgorithms resulting in fast estimation of the WKV statistic."}, {"heading": "4. Summary and Discussion", "text": "We have shown how tighter variational representations for f -divergences can be derived by restricting the effective domain of the divergence functional to the set of probability measures. Since many works in the literature are based on variational representations, this tighter version presents many potential applications. As an example of this, a dual program for f -divergence estimators based on this tighter representation was derived for density ratios within an RKHS H and arbitrary convex regularizers. This tightened and extended the M2 estimator proposed in (Nguyen et al., 2010) and we demonstrated empirically the benefits of our analysis. We also gave a novel interpretation of the dual program in terms of MMD which showed that our estimator can be seen to find an approximation r\u0302 \u2208 H of the density ratio that attempts to simultaneously minimises MMD between Pn and r\u0302Qn and the empirical f -divergence EQn [f (r\u0302)]. This second minimisation can be seen as a generalised maximum entropy regularisation. We have also provided a comparison to other state of the art estimators. We concluded that variational methods are good for settings in which a low divergence is suspected or in scenarios where overestimation is detrimental.\nAs future work we intend to investigate the impact of this tightened representation on other divergence estimators based on the looser representation such as (Kanamori et al., 2011), as well as to areas other than\nf -divergence estimation (hypothesis testing and statistical inference). We also plan to find general conditions under which consistency of our family of estimators holds. The work of (Nguyen et al., 2010) has already paved the way for this investigation. Failing that, the very general consistency results of (Altun & Smola, 2006) for single sample divergence estimation may also be amenable to the analysis of our estimator. The performance of our estimator on distributions on low dimensional manifolds suggests that it would be worth testing on domains involving audio or images. It would also be interesting to apply our method for estimating divergences other than KL. For instance we could study \u03b1-divergence estimation as in (Poczos & Schneider, 2011)."}], "references": [{"title": "A general class of coefficients of divergence of one distribution from another", "author": ["S.M. Ali", "S.D. Silvey"], "venue": "Journal of the Royal Statistical Society. Series B (Methodological),", "citeRegEx": "Ali and Silvey,? \\Q1966\\E", "shortCiteRegEx": "Ali and Silvey", "year": 1966}, {"title": "Unifying divergence minimization and statistical inference via convex duality", "author": ["Y. Altun", "A. Smola"], "venue": "Learning theory, pp", "citeRegEx": "Altun and Smola,? \\Q2006\\E", "shortCiteRegEx": "Altun and Smola", "year": 2006}, {"title": "The concept of duality in convex analysis, and the characterization of the legendre transform", "author": ["S. Artstein-Avidan", "V. Milman"], "venue": "Annals of mathematics,", "citeRegEx": "Artstein.Avidan and Milman,? \\Q2009\\E", "shortCiteRegEx": "Artstein.Avidan and Milman", "year": 2009}, {"title": "On Bayesian bounds", "author": ["A. Banerjee"], "venue": "Proceedings of the 23rd International Conference on Machine learning,", "citeRegEx": "Banerjee,? \\Q2006\\E", "shortCiteRegEx": "Banerjee", "year": 2006}, {"title": "Convexity and optimization in Banach spaces, volume", "author": ["V. Barbu", "T. Precupanu"], "venue": null, "citeRegEx": "Barbu and Precupanu,? \\Q1986\\E", "shortCiteRegEx": "Barbu and Precupanu", "year": 1986}, {"title": "Parametric estimation and tests through divergences and the duality technique", "author": ["Broniatowski", "Michel", "Keziou", "Amor"], "venue": "Journal of Multivariate Analysis,", "citeRegEx": "Broniatowski et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Broniatowski et al\\.", "year": 2009}, {"title": "Information-type measures of difference of probability distributions and indirect observations", "author": ["I. Csisz\u00e1r"], "venue": "Studia Scientiarum Mathematicarum Hungarica,", "citeRegEx": "Csisz\u00e1r,? \\Q1967\\E", "shortCiteRegEx": "Csisz\u00e1r", "year": 1967}, {"title": "Large deviations techniques and applications, volume 38", "author": ["A. Dembo", "O. Zeitouni"], "venue": null, "citeRegEx": "Dembo and Zeitouni,? \\Q2009\\E", "shortCiteRegEx": "Dembo and Zeitouni", "year": 2009}, {"title": "Asymptotic evaluation of certain markov process expectations for large time", "author": ["MD Donsker", "Varadhan", "SRS"], "venue": "iv. Communications on Pure and Applied Mathematics,", "citeRegEx": "Donsker et al\\.,? \\Q1983\\E", "shortCiteRegEx": "Donsker et al\\.", "year": 1983}, {"title": "Risk-based generalizations of fdivergences", "author": ["D. Garc\u00eda-Garc\u00eda", "U. von Luxburg", "R. SantosRodr\u00edguez"], "venue": "In Proceedings of the International Conference on Machine learning,", "citeRegEx": "Garc\u00eda.Garc\u00eda et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Garc\u00eda.Garc\u00eda et al\\.", "year": 2011}, {"title": "A Kernel Method for the Two-SampleProblem", "author": ["A. Gretton", "K.M. Borgwardt", "M. Rasch", "B. Sch\u00f6lkopf", "A.J. Smola"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "Gretton et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Gretton et al\\.", "year": 2008}, {"title": "Fundamentals of Convex Analysis", "author": ["Hiriart-Urruty", "Jean-Baptiste", "Lemar\u00e9chal", "Claude"], "venue": null, "citeRegEx": "Hiriart.Urruty et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Hiriart.Urruty et al\\.", "year": 2001}, {"title": "A least-squares approach to direct importance estimation", "author": ["T. Kanamori", "S. Hido", "M. Sugiyama"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "Kanamori et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Kanamori et al\\.", "year": 2009}, {"title": "f-divergence estimation and two-sample homogeneity test under semiparametric density-ratio models", "author": ["T. Kanamori", "T. Suzuki", "M. Sugiyama"], "venue": "Information Theory, IEEE Transactions on (To appear),", "citeRegEx": "Kanamori et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Kanamori et al\\.", "year": 2011}, {"title": "Estimating divergence functionals and the likelihood ratio by convex risk minimization", "author": ["X. Nguyen", "M.J. Wainwright", "M.I. Jordan"], "venue": "Technical report, Department of Statistics, UC Berkeley,", "citeRegEx": "Nguyen et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Nguyen et al\\.", "year": 2007}, {"title": "On surrogate loss functions and f -divergences", "author": ["X. Nguyen", "M.J. Wainwright", "M.I. Jordan"], "venue": "Annals of Statistics,", "citeRegEx": "Nguyen et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Nguyen et al\\.", "year": 2009}, {"title": "Estimating divergence functionals and the likelihood ratio by convex risk minimization", "author": ["X.L. Nguyen", "M.J. Wainwright", "M.I. Jordan"], "venue": "Information Theory, IEEE Transactions on,", "citeRegEx": "Nguyen et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Nguyen et al\\.", "year": 2010}, {"title": "On the estimation of alpha-divergences", "author": ["Poczos", "Barnabas", "Schneider", "Jeff"], "venue": "AISTATS", "citeRegEx": "Poczos et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Poczos et al\\.", "year": 2011}, {"title": "Information, divergence and risk for binary experiments", "author": ["Reid", "Mark D", "Williamson", "Robert C"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "Reid et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Reid et al\\.", "year": 2011}, {"title": "Convex analysis, volume 28", "author": ["R.T. Rockafellar"], "venue": "Princeton Univ Pr,", "citeRegEx": "Rockafellar,? \\Q1997\\E", "shortCiteRegEx": "Rockafellar", "year": 1997}, {"title": "Direct importance estimation for covariate shift adaptation", "author": ["M. Sugiyama", "T. Suzuki", "S. Nakajima", "H. Kashima", "P. von Bunau", "M. Kawanabe"], "venue": "Annals of the Institute of Statistical Mathematics,", "citeRegEx": "Sugiyama et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Sugiyama et al\\.", "year": 2008}, {"title": "Divergence estimation for multidimensional densities via k-nearestneighbor distances", "author": ["Q. Wang", "S.R. Kulkarni", "S. Verd\u00fa"], "venue": "Information Theory, IEEE Transactions on,", "citeRegEx": "Wang et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Wang et al\\.", "year": 2009}], "referenceMentions": [{"referenceID": 6, "context": "An important class of discrepancy measures between probability distributions is the family of f -divergences (also known as Ali-Silvey (Ali & Silvey, 1966) or Csisz\u00b7r divergences (Csisz\u00e1r, 1967)).", "startOffset": 179, "endOffset": 194}, {"referenceID": 16, "context": "This variational representation has been recently used for f -divergence estimation (Nguyen et al., 2010; 2007; Kanamori et al., 2011) homogeneity testing (Kanamori et al.", "startOffset": 84, "endOffset": 134}, {"referenceID": 13, "context": "This variational representation has been recently used for f -divergence estimation (Nguyen et al., 2010; 2007; Kanamori et al., 2011) homogeneity testing (Kanamori et al.", "startOffset": 84, "endOffset": 134}, {"referenceID": 13, "context": ", 2011) homogeneity testing (Kanamori et al., 2011) and parameter estimation (Broniatowski & Keziou, 2009).", "startOffset": 28, "endOffset": 51}, {"referenceID": 3, "context": "This generalises similar observations for the specific case of the KL divergence, such as Banerjee\u2019s compression lemma (Banerjee, 2006).", "startOffset": 119, "endOffset": 135}, {"referenceID": 10, "context": "We show this dual program has a natural interpretation as a trade off between the minimisation of the f -divergence in question and the minimum mean discrepancy (MMD) (Gretton et al., 2008) between the empirical distributions.", "startOffset": 167, "endOffset": 189}, {"referenceID": 16, "context": "Experiments in section 3 confirm that the tighter variational form underlying our approach leads to better KL divergence estimates than the well known estimator of (Nguyen et al., 2010; 2007) which is based on the looser representation.", "startOffset": 164, "endOffset": 191}, {"referenceID": 16, "context": "The choice of order of the arguments P and Q is arbitrary and other authors, notably (Nguyen et al., 2010), define f -divergence in terms of dQ/dP .", "startOffset": 85, "endOffset": 106}, {"referenceID": 16, "context": "The dashed line and solid line represent our new expression and the expression used by (Nguyen et al., 2010) respectively as they vary over L\u221e(Q).", "startOffset": 87, "endOffset": 108}, {"referenceID": 16, "context": "As explored in (Nguyen et al., 2010; Altun & Smola, 2006) and in section 2 below, variational representations such as these readily admit approximation", "startOffset": 15, "endOffset": 57}, {"referenceID": 16, "context": "While our new expression and that of (Nguyen et al., 2010) have the same supremum, our expression is closer to the supremum at every point \u03c6 \u2208 L\u221e(Q).", "startOffset": 37, "endOffset": 58}, {"referenceID": 3, "context": "The first inequality is the well-known representation of the KL divergence in the large deviations literature (Donsker & Varadhan, 1983) which has been rediscovered in the PAC-Bayes community as the compression lemma (Banerjee, 2006).", "startOffset": 217, "endOffset": 233}, {"referenceID": 16, "context": "As in (Nguyen et al., 2010), our estimator is then defined via the dual representation of IRf,Qn that takes We assume that the samples are of equal size for simplicity.", "startOffset": 6, "endOffset": 27}, {"referenceID": 14, "context": "The proof techniques here are based on those in (Nguyen et al., 2007).", "startOffset": 48, "endOffset": 69}, {"referenceID": 19, "context": "By the infimal convolution theorem (Rockafellar, 1997) we therefore have", "startOffset": 35, "endOffset": 54}, {"referenceID": 16, "context": "The estimator M2 proposed in (Nguyen et al., 2010) uses square norm regularisation in a two sample setting and is therefore directly comparable to (9).", "startOffset": 29, "endOffset": 50}, {"referenceID": 10, "context": "Following (Gretton et al., 2008), we can formalise the observation regarding the second term by considering the mean map \u03bc from distributions R over X to functions in an RKHS H defined by R 7\u2192 \u03bc [R] := Ex\u223cR [\u03a6(x)].", "startOffset": 10, "endOffset": 32}, {"referenceID": 15, "context": "This analysis also leads to an intuitive explanation why we should use the regularisation schedule \u03bbn = \u0398 ( n\u22121 ) as per (Nguyen et al., 2009).", "startOffset": 121, "endOffset": 142}, {"referenceID": 10, "context": "It was shown in (Gretton et al., 2008) that the MMD estimator", "startOffset": 16, "endOffset": 38}, {"referenceID": 16, "context": "Theorem 1 shows the restricted variational bound derived here is strictly tighter than the one proposed by (Nguyen et al., 2010) (henceforth NWJ) for every function r \u2208 L(Q) except when r = dP/dQ in which case they coincide and attain the optimum.", "startOffset": 107, "endOffset": 128}, {"referenceID": 21, "context": "\u2022 Wang et al (Wang et al., 2009): This estimator is based on nearest neighbour estimates of the two densities and does not make use of a variational representation.", "startOffset": 13, "endOffset": 32}, {"referenceID": 12, "context": "\u2022 Kanamori et al (Kanamori et al., 2009): This is a least-squares estimator for the density ratio, bypassing individual density estimations.", "startOffset": 17, "endOffset": 40}, {"referenceID": 20, "context": "We also experimented with another density ratio estimation method (Sugiyama et al., 2008), with very similar results.", "startOffset": 66, "endOffset": 89}, {"referenceID": 9, "context": "\u2022 Garc\u00eda et al (Garc\u00eda-Garc\u00eda et al., 2011): This estimator uses nearest neighbour misclassification rates and a reformulation of f -divergences in terms of risks.", "startOffset": 15, "endOffset": 43}, {"referenceID": 21, "context": "(Wang et al., 2009) estimator (henceforth WKV) was based on the cKDTree nearest neighbour routine from the SciPy library.", "startOffset": 0, "endOffset": 19}, {"referenceID": 16, "context": "The method for choosing the parameters \u03bbn and \u03c3 for the NWJ estimator are not specified in (Nguyen et al., 2010).", "startOffset": 91, "endOffset": 112}, {"referenceID": 16, "context": "This tightened and extended the M2 estimator proposed in (Nguyen et al., 2010) and we demonstrated empirically the benefits of our analysis.", "startOffset": 57, "endOffset": 78}, {"referenceID": 13, "context": "As future work we intend to investigate the impact of this tightened representation on other divergence estimators based on the looser representation such as (Kanamori et al., 2011), as well as to areas other than", "startOffset": 158, "endOffset": 181}, {"referenceID": 16, "context": "The work of (Nguyen et al., 2010) has already paved the way for this investigation.", "startOffset": 12, "endOffset": 33}], "year": 2012, "abstractText": "We show that the variational representations for f -divergences currently used in the literature can be tightened. This has implications to a number of methods recently proposed based on this representation. As an example application we use our tighter representation to derive a general f -divergence estimator based on two i.i.d. samples and derive the dual program for this estimator that performs well empirically. We also point out a connection between our estimator and MMD.", "creator": "TeX"}}}