{"id": "1508.03819", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "16-Aug-2015", "title": "From Observational Studies to Causal Rule Mining", "abstract": "chronic randomised constraint controlled trials ( rcts ) are far the most effective approach to causal discovery, but unusually in these many interesting circumstances ) it sometimes is impossible financially to conduct rcts. therefore observational studies based on passively studied observed data structure are widely accepted as introducing an alternative proposal to rcts. curiously however, sometimes in any observational studies, continuous prior analytic knowledge is required to rapidly generate the hypotheses immediately about the cause - effect relationships to be tested, very hence they invariably can only thus be applied to problems obtained with commonly available domain knowledge and with a wide handful of special variables. in continuous practice, many data sets then are of high degree dimensionality, which leaves observational studies drawing out of context the vast opportunities provided for causal loop discovery from such depths a wealth of sensitive data resources sources. hence in another direction, many efficient data mining preparation methods have furthermore been developed to identify associations detected among natural variables in large given data sets. the earliest problem cited is, causal relationships strictly imply associations, but the systematic reverse is presumably not completely always true. however we can see the underlying synergy between the three two causal paradigms here. just specifically, differential association rule order mining theory can be broadly used more to deal with ignoring the high - dimensionality problem theory while observational studies can typically be utilised commercially to eliminate non - causal associations. in recalling this paper we propose the alternative concept of causal correlation rules ( crs ) and develop include an algorithm which for mining linear crs in large data production sets. we use the aforementioned idea of extensive retrospective action cohort studies looking to detect constructive crs based on ignoring the results of association order rule mining. experiments with both synthetic database and real world data sets have demonstrated the effectiveness and efficiency of cr block mining. in comparison, with utilizing the numerous commonly readily used causal discovery methods, the proposed approach in general theory is faster development and has better fraud or false competitive analytical performance in finding correct or correctly sensible error causes. it is simply also capable of finding clearly a reverse cause order consisting of multiple positive variables, describing a feature that other causal controlled discovery methods normally do particularly not possess.", "histories": [["v1", "Sun, 16 Aug 2015 12:33:18 GMT  (142kb,D)", "http://arxiv.org/abs/1508.03819v1", "This paper has been accepted by ACM TIST journal and will be available soon"]], "COMMENTS": "This paper has been accepted by ACM TIST journal and will be available soon", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["jiuyong li", "thuc duy le", "lin liu", "jixue liu", "zhou jin", "bingyu sun", "saisai ma"], "accepted": false, "id": "1508.03819"}, "pdf": {"name": "1508.03819.pdf", "metadata": {"source": "CRF", "title": "From Observational Studies to Causal Rule Mining", "authors": ["JIUYONG LI", "THUC DUY LE", "LIN LIU", "JIXUE LIU", "ZHOU JIN", "BINGYU SUN"], "emails": [], "sections": [{"heading": null, "text": "00\nFrom Observational Studies to Causal Rule Mining\nJIUYONG LI, University of South Australia THUC DUY LE, University of South Australia LIN LIU, University of South Australia JIXUE LIU, University of South Australia ZHOU JIN, University of Science and Technology China BINGYU SUN, Chinese Academy of Sciences SAISAI MA, University of South Australia\nRandomised controlled trials (RCTs) are the most effective approach to causal discovery, but in many circumstances it is impossible to conduct RCTs. Therefore observational studies based on passively observed data are widely accepted as an alternative to RCTs. However, in observational studies, prior knowledge is required to generate the hypotheses about the cause-effect relationships to be tested, hence they can only be applied to problems with available domain knowledge and a handful of variables. In practice, many data sets are of high dimensionality, which leaves observational studies out of the opportunities for causal discovery from such a wealth of data sources. In another direction, many efficient data mining methods have been developed to identify associations among variables in large data sets. The problem is, causal relationships imply associations, but the reverse is not always true. However we can see the synergy between the two paradigms here. Specifically, association rule mining can be used to deal with the high-dimensionality problem while observational studies can be utilised to eliminate non-causal associations. In this paper we propose the concept of causal rules (CRs) and develop an algorithm for mining CRs in large data sets. We use the idea of retrospective cohort studies to detect CRs based on the results of association rule mining. Experiments with both synthetic and real world data sets have demonstrated the effectiveness and efficiency of CR mining. In comparison with the commonly used causal discovery methods, the proposed approach in general is faster and has better or competitive performance in finding correct or sensible causes. It is also capable of finding a cause consisting of multiple variables, a feature that other causal discovery methods do not possess.\nCategories and Subject Descriptors: H.2.8 [Database Applications]: Data Mining\nGeneral Terms: Algorithms\nAdditional Key Words and Phrases: causal discovery, association rule, cohort study, odds ratio\nACM Reference Format: Jiuyong Li, Thuc Duy Le, Lin Liu, Jixue Liu, Zhou Jin, Bingyu Sun, and Saisai Ma, 2015. From Observational Studies to Causal Rule Mining. ACM Trans. Intell. Syst. Technol. 00, 00, Article 00 ( 2015), 27 pages. DOI:http://dx.doi.org/10.1145/0000000.0000000"}, {"heading": "1. INTRODUCTION", "text": "Causal discovery aims to infer the cause-effect relationships between variables. Such relationships imply the mechanism of outcome variables taking their values and how\nA preliminary version of this work was published in the Proceedings of 2013 IEEE 13th International Conference on Data Mining Workshops, the First IEEE ICDM Workshop on Causal Discovery 2013 (CD2013), pp. 114-123, Dallas, Texas, USA, December 7-10, 2013. Authors\u2019 addresses: J. Li, T. D. Le, L. Liu J. Liu and S. Ma, School of Information Technology and Mathematical Sciences, University of South Australia, Mawson Lakes, SA, 5095, Australia; Z. Jin, Department of Automation, University of Science and Technology, Hefei 230026, China; B. Sun, Institute of Intelligent Machines, Chinese Academy of Sciences, Hefei 230031, China. Permission to make digital or hard copies of part or all of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for third-party components of this work must be honored. For all other uses, contact the Owner/Author. Copyright 2015 held by Owner/Author Publication title/2157-6904/2015/MonthOfPublication - ArticleNumber http://dx.doi.org/10.1145/2746410\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nar X\niv :1\n50 8.\n03 81\n9v 1\n[ cs\n.A I]\n1 6\nA ug\n2 01\n5\nthe change of cause variables would lead to the change of the outcome variables [Spirtes 2010]. In other words, causality provides the basis for explaining how things have happened and for predicting how the outcomes would be when their causes have changed. Therefore apart from being a fundamental philosophical topic, causality has been studied and utilised in almost all disciplines, e.g. medicine, epidemiology, biology, economics, physics, social science, as a basic and effective tool for explanation, prediction and decision making [Guyon et al. 2010; Kleinberg and Hripcsak 2011]. Some specific examples include the applications in medicine for developing new treatments or drugs for a disease; and in economics for forecasting the results of a particular financial policy and in turn to assist decision and/or policy making.\nRandomised controlled trials (RCTs) are recognised as the gold standard for testing the effects of interventions [Shadish et al. 2002; Stolberg et al. 2004]. However, it is also widely acknowledged that in many cases it is impossible to conduct RCTs due to cost and/or ethical concerns. For example, to find out the causal effect of alcohol consumption on heart diseases, it will be unethical to require an experiment participant to drink. Sometimes it is totally forbidden to manipulate a possible cause factor, for example, in a life-threatening situation.\nUnder these circumstances, observational studies [Rosenbaum 2010; Concato et al. 2000] are considered as the best alternatives to RCTs, and it has been shown that well-designed observational studies can achieve comparative results as RCTs [Concato et al. 2000]. As suggested by the name, observational studies are based on passively observed data, and they do not require manipulation of an exposure (i.e. a potential cause factor). There are two main types of observational studies for causal discovery, cohort studies and case-control studies [Song and Chung 2010; Blackmore and Cummings 2004; Euser et al. 2009]. In a cohort study, based on the status of being exposed to a potential cause factor (e.g. certain radiation), an exposure group of subjects and a non-exposure or control group of subjects are selected, and then followed to observe the occurrence of the outcome (e.g. cancer). In a case-control study, subjects are selected based on the status of the outcome, i.e. the case group consisting of subjects with the outcome and a control group of subjects without the outcome are identified, and then their status of exposure to the potential cause factor is examined. In both types of studies, the effect of an exposure on the outcome is determined by comparing the difference between the exposed/case group and control group. In order to achieve convincing result, an observational study must try to replicate a RCT as much as possible, i.e. the covariate distributions of the two contrasting groups should be as close as possible.\nAlthough observational studies provide an effective approach to causal discovery, they work in the fashion of hypothesis testing, that is, at the commencement of a study, a cause-effect relationship needs to be hypothesised. Then data are collected or retrieved from databases for testing the hypothesis. This requires the prior knowledge or anticipation of the exposures and outcomes, which may not always be available, especially when the number of variables under study is large and the purpose is to explore possible cause-effect relationships, instead of validating an assumed causal relationship. For example, in the study of gene regulation, we may have a clear idea of the possible genetic diseases (outcomes), but which genes could be the possible genetic causes of the diseases may not be known at all. Given the huge number of genes (tens of thousands), it is infeasible to test each gene to find the causes. Therefore to exploit the wealth information in observational data using the well-established methodology of observational studies, we firstly need some efficient ways to generate the hypotheses with high confidence.\nAnother challenge with observational studies (as well as RCTs) is that even with domain knowledge, it is difficult to foresee a combined cause. For example, multiple\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\ngenes may work together to cause a disease, which is normally hard to identify with domain knowledge only.\nThis is where we can take the advantage of the outcome of data mining research. In the last two decades, huge efforts have been made on association rule mining [Agrawal et al. 1993] and many efficient algorithms have been developed to discover association rules from large data sets [Han and Kamber 2005]. An association rule represents interesting associations among variables, for example, pizza \u2192 garlic bread; {strong wind, high temperature} \u2192 falling trees. Although statistical associations do not necessarily mean causality (for instance, buying garlic bread and pizza together does not indicate that buying one is the cause of buying the other. Mostly likely this is a consequence of a meal deal), it is commonly accepted that associations are necessary for causality.\nOur idea is thus to utilise the synergy of observational studies and association rule mining to develop an efficient method for automated discovery of causal relationships in large data sets. We firstly use association rule mining to find out the hypothesised cause-effect relationships (represented as association rules) regarding an outcome. Then for each of the hypotheses, we conduct an observational study (e.g. a cohort study) to test if the exposure is a real cause, i.e. to identify if the association rule is a causal rule.\nAs the LHS (left-hand-side or antecedent) of an association rule can comprise multiple attributes, a favourable consequence of using association rule mining here is that it can generate hypothesised causal relationships with compound exposure, such as the rule shown above {strong wind, high temperature} \u2192 falling trees. In this case, we consider the two attributes as one variable/exposure in our observational studies, hence the validity of the combined cause can be tested.\nIn the rest of the paper, we will present the definition of causal rules and our approach to identifying CRs (Section 3), the algorithm for mining CRs (Section 4), and the experiment results demonstrating the effectiveness and efficiency of the algorithm (Section 5). Before the presentation, in Section 2, we firstly outline the related work and show the contribution of this paper."}, {"heading": "2. RELATED WORK AND CONTRIBUTION", "text": "Observational studies [Rosenbaum 2010; Concato et al. 2000] have had a very long history, and there has been a great deal of research on observational studies, by both statisticians and practitioners in medicine and other application areas. The main focus of the research is on how to design good observational studies, including selection of subjects or records, methods for identifying exposed and non-exposed groups to replicate RCTs as closely as possible, and the ways for analysing the data. However, as far as we know, there is little work done on using observational studies for automated causal discovery in large, especially high-dimensional data.\nIn the field of computer science, causal discovery from observational data has attracted enormous research efforts in the past three decades. Currently Bayesian network techniques are at the core of the methodologies for causal discovery in computer science [Spirtes 2010]. Bayesian networks provide a graphical representation of conditional independence among a set of variables. Under certain causal assumptions, a directed edge between two nodes (variables) in a Bayesian network represents a causal relationship between the two variables [Spirtes 2010; Spirtes et al. 2001]. Over the years, many algorithms have been developed for learning Bayesian networks from data [Neapolitan 2003; Spirtes 2010]. However, up to now it is only feasible to learn a Bayesian network with dozens of variables, or hundreds if the network is sparse [Spirtes 2010]. Therefore, in practice it is infeasible to identify causal relationships using Bayesian network based approaches in most cases.\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nIndeed the difficulties faced by these causal discovery approaches originate from their goal, i.e. to discover a complete causal model of the domain under consideration. Such a model indicates all pairwise causal relationships among the variables. This, unfortunately, is essentially impossible to achieve when the domain contains a large number of variables. It has been shown that in general learning a Bayesian network is NP-hard [Chickering et al. 2004].\nSome constraint based approaches do not search for a complete Bayesian network, so they can be more efficient for causal relationship discovery. Several such algorithms have shown promising results [Cooper 1997; Silverstein et al. 2000; Mani et al. 2006; Pellet 2008; Aliferis et al. 2010]. Based on observational data, these methods determine conditional independence of variables and learn local causal structures. However some of the methods are only capable of discovering the causal relationships represented with some fixed structures, e.g. CCC [Cooper 1997], CCU [Silverstein et al. 2000] and the Y structures [Mani et al. 2006], and they do not identify causal relationships that cannot be represented with these structures. The complexity of other methods for learning a partial Bayesian network in general is still exponential to the number of variables, unless accuracy and/or completeness are traded with efficiency [Aliferis et al. 2010].\nOur method tackles the problem of causal discovery from a different perspective. It integrates two well-established methodologies in two different fields for relationship discoveries. The main contribution of this paper is to propose a statistically sound and computational efficient causal discovery method for causal relationship exploration. Cohort studies have been widely accepted for identifying causal links in health, medical and social studies, so the use of cohort studies to uncover causal relationships is methodologically sound. In this paper, the theoretical validity of the proposed method has also been justified by its connection with a well-known causal inference framework \u2013 the potential outcome model [Pearl 2000; Morgan and Winship 2007]. Our goal is to automate causal relationship discovery in data, making it possible to explore causal relationships in both large and high dimensional data sets.\nOur work also contributes to the area of association rule mining. Association rule mining is a main data mining technique and has many applications in various fields, but a major obstacle of association rule mining is that it produces too many rules and many of them are uninteresting since they represent random associations in a data set [Webb 2008; Webb 2009; Tan et al. 2004; Lenca et al. 2008]. Cohort studies enable us to filter out a large proportion of such uninteresting rules and keep the most interesting ones for a broad range of applications since discovering causal relationships is the goal of the majority of applications.\nThis paper is an extension of our preliminary work in [Li et al. 2013], with three major developments: (1) A more explicit presentation of the motivation, goal and contribution of the research in the newly written Sections 1 and 2; (2) A new section (Section 3.5) for justifying the validity of the CR framework; (3) A new set of experiments with a total of 13 synthetic data sets for evaluating the performance and scalability of the proposed method , and new experiments on investigating the effect of different matching methods (see Section 5)."}, {"heading": "3. CAUSAL RULES", "text": ""}, {"heading": "3.1. Notations", "text": "Let D be a data set for a set of binary variables (X1, X2, . . . , Xm, Z), where X1, X2, . . . , Xm are predictor variables and Z is a response variable. Values of Z are of user\u2019s interest, e.g. having a disease or being normal. Considering a binary data set makes the conceptual discussions in the paper easier, and it does not lose the gener-\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nality of a data set that contains attributes of multiple discrete values. For example, a multi-valued data set for the variables (Gender, Age, . . . ) is equivalent to a binary data set for the variables (Male, Female, 0-19, 20-39, 40-69, . . . ). In this paper, both the Male and Female variables are kept to allow us to have combined variables that involve them separately, for example, (Female, 40-59, Diabetes) and (Male, 40-59, Smoking). P is a combined variable if it consists of multiple variables X1, . . . , Xn where n \u2265 2, and P = 1 when (X1 = 1, . . . , Xn = 1) and P = 0 otherwise. A rule is in the form of (P = 1)\u2192 (Z = 1), or p\u2192 z where z stands for Z = 1 and p for P = 1. p is also called a k-pattern where k is the length of P (the number of component variables of P ). Our ultimate goal is to find out whether p\u2192 z is a causal rule."}, {"heading": "3.2. Association rules", "text": "With our approach, we first consider the association between P and Z since an association is normally necessary for a causal relationship.\nOdds ratio is a widely used measure for associations in retrospective studies [Fleiss et al. 2003], and we define the odds ratio of a rule as follows.\nDefinition 3.1 (Odds ratio of a rule). Given the following contingency table of a rule, p\u2192 z,\nz(Z = 1) \u00acz(Z = 0) p(P = 1) supp(pz) supp(p\u00acz) \u00acp(P = 0) supp(\u00acpz) supp(\u00acp\u00acz)\nwhere supp(x) indicates the support of patternX, the count of value x in the given data set, D, and we have supp(p) = supp(pz) + supp(p\u00acz), supp(z) = supp(pz) + supp(\u00acpz), and supp(pz) + supp(p\u00acz) + supp(\u00acpz) + supp(\u00acp\u00acz) = n, where n is the number of records in the data set, then the odds ratio of the rule p\u2192 z on D is defined as:\noddsratioD(p\u2192 z) = supp(pz) \u2217 supp(\u00acp\u00acz) supp(p\u00acz) \u2217 supp(\u00acpz)\n(1)\nFrom the definition, the odds ratio of a rule is the ratio of the odds of value z occurring in group P = 1 to the odds of value z occurring in group P = 0, so an odds ratio of 1 means that z has an equal chance to occur in both groups, and an odds ratio deviating from 1 indicates an association (positive or negative) between Z and P .\nDefinition 3.2 (Association rule). Using the notations in Definition 3.1, the support of a rule p \u2192 z is defined as supp(p \u2192 z) = supp(pz). Given a data set D, let min supp and min oratio be the minimum support and odds ratio respectively, p \u2192 z is an association rule if supp(p \u2192 z) > min supp and oddsratioD(p \u2192 z) > min oratio, and LHS(p\u2192 z) = p and RHS(p\u2192 z) = z.\nIn the definition, we consider z as the RHS of a rule. An association rule that has \u00acz (Z = 0) as its RHS can be defined in the same way. These association rules (p\u2192 z and p\u2192 \u00acz) are class association rules [Liu et al. 1998] where the confidence (prob(z|p)) is replaced by the odds ratio. Furthermore, only positive association between a predictor variable and the response variable is considered in the above definition as in most cased in practice, we are concerned about the occurrence of the predictor (i.e. P = 1) leading to the occurrence of the response (i.e. Z = 1).\nWe note that the distribution of the values of the response variable can be skewed and a uniform minimum support may lead to too many rules for the frequent values and few rules for the infrequent values. In the implementation, we use the local support that is relative to the frequency of a value in the response variable, i.e.\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nlsupp(p \u2192 z) = supp(pz)supp(z) . The local support is a ratio and can be set the same, say 5%, for rules that have z or \u00acz as the RHS.\nTraditional association rules are defined by support and confidence [Agrawal et al. 1993]. An association rule in the support and confidence scheme may not show a real association between the LHS and RHS of a rule [Brin et al. 1997]. Therefore in the above definition, we use odds ratio as the indicator of association. The minimum odds ratio in the definition may be replaced by a significance test on oddsratioD(p \u2192 z) > 1 to ensure that an association rule indicates a significant association between the LHS and RHS of the rule.\nThe test of significant association is determined as the following. Let \u03c9 be the odds ratio of the rule p \u2192 z on the given data set D, i.e. oddsratioD(p\u2192 z) = \u03c9. The confidence interval of \u03c9, [\u03c9\u2212, \u03c9+], is defined as [Fleiss et al. 2003]:\n\u03c9\u2212 = exp(ln\u03c9 \u2212 z\u2032 \u221a\n1\nsupp(pz) +\n1\nsupp(p\u00acz) +\n1\nsupp(\u00acpz) +\n1\nsupp(\u00acp\u00acz) )\nand\n\u03c9+ = exp(ln\u03c9 + z \u2032\n\u221a 1\nsupp(pz) +\n1\nsupp(p\u00acz) +\n1\nsupp(\u00acpz) +\n1\nsupp(\u00acp\u00acz) )\nwhere z\u2032 is the critical value corresponding to a desired level of confidence (z\u2032 = 1.96 for 95% confidence). \u03c9\u2212 and \u03c9+ are the lower and upper bounds respectively of an odds ratio at a confidence level. If \u03c9\u2212 > 1, the odds ratio is significantly higher than 1, hence P and Z are associated. Equivalently, p\u2192 z is an association rule.\nAn important advantage of the above process is that it is automatically adaptive to the size of a data set. For a large data set, the confidence interval of an odds ratio is small and hence a small odds ratio can be significantly higher than 1. For a small data set, the confidence interval of an odds ratio is large and hence a large odds ratio is needed to be significantly higher than 1.\nHowever, statistically reliable associations do not always indicate causal relationships although causality is mostly observed as associations in data, which can be illustrated by the following example.\nExample 3.3. Suppose that we have generated an association rule: \u201cGender = m\u201d \u2192 \u201cSalary = low\u201d from a data set with the following statistics:\nSalary = low Salary = high Gender = m 185 120 Gender = f 65 60\nThe ratio of low salary earners to high salary earners in the male group is 1.54:1 while the ratio in the female group is 1.08:1. In other words, the odds for a male worker receiving a low salary is 1.54 and the odds for a female worker receiving a low salary is 1.08. The odds ratio of male and female groups receiving low salaries is 1.43, which is greater than 1. Therefore as described previously, this odds ratio indicates a positive association between \u201cGender = m\u201d and \u201cSalary = low\u201d.\nIs this association valid? Let us do further analysis by stratifying the samples by the Education attribute. Assume that the statistics of the stratified data sets are:\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nSalary = low Salary = high Gender = m & College = y 5 20 Gender = f & College = y 15 40\nand\nSalary = low Salary = high Gender = m & College = n 180 100 Gender = f & College = n 50 20\nThe above two tables indicate a negative association between \u201cGender = m\u201d and \u201cSalary = low\u201d because the odds ratio in the College education group is 0.67 and odds ratio in the non-College education group is 0.72. Both contradict the association rule \u201cGender = m\u201d\u2192 \u201cSalary = low\u201d.\nWe obtain two conflicting results here. This means that an association may be volatile in a sub data set or a super data set. This is a phenomenon of the famous Simpson Paradox [Pearl 2000], indicating that associations may not imply causal relationships.\nTherefore our idea is to conduct a retrospective cohort study to detect true causal relationships from identified association rules."}, {"heading": "3.3. Cohort study", "text": "As discussed in Section 1, when randomised controlled trials are practically impossible, observational studies are often used as the alternative approach to finding out the possible cause-effect relationships. A major type of observational studies is cohort studies, which can be conducted in either of the two ways, prospective and retrospective [Euser et al. 2009; Fleiss et al. 2003]. In a perspective cohort study, researchers follow cohorts over time to observe their development of a certain outcome. In a retrospective study, researchers look back at events that already occurred. In a data mining setting, as the data we have are historical records, we adopt the idea of a retrospective cohort study in this paper.\nA retrospective cohort study selects individuals who have exposed and have not exposed to a suspected risk factor but are alike within many other aspects. For example, middle aged male who have been smoking and who have not been smoking for a certain time period are selected for studying the effect of smoking on lung cancer. Here smoking is the risk factor or exposure variable, and \u201cmiddle aged\u201d and \u201cmales\u201d indicate the common characteristics shared by the two cohorts. A significant difference in the value of the outcome or response variable (lung cancer) of the two cohorts indicates a possible causal relationship between the exposure variable and the response variable.\nIn the rest of the paper, with a binary exposure variable, we call the cohort where the exposure variable takes value 1 the exposure group, the cohort where the exposure variable takes value 0 the non-exposure group, and the set of variables determining the common characteristics of the two groups the control variable set.\nFrom the above description, the core requirement for a cohort study is to obtain the matched exposure and non-exposure groups such that the distribution of control variable set of the two groups are the same or very similar. For example, in a cohort study to test whether gender is a cause of salary difference, the exposure variable is gender and the control variable set consists of variables: education, profession, experience and location. From a given data set, we will need to select samples for the exposure and non-exposure groups so that the two groups have the same distribution regarding the control variables. Then if there is a significant difference in salary between the two groups, we can conclude that gender is a cause of salary difference.\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nIn the following, we will define causal rules using the idea of retrospective cohort studies."}, {"heading": "3.4. Causal rule definition", "text": "Given an association rule as a hypothesis that the LHS of the rule causes its RHS. The variable of the LHS is an exposure variable and the variable of the RHS is the response variable. Let all other variables be included in the control variable set initially. We will discuss how to refine this control variable set in Section 4.2.\n3.4.1. Fair data sets. Given a data set D, for an exposure variable, we use the following process to select samples for the exposure and non-exposure groups (while the RHS response is blinded). We firstly pick up a record ti containing the LHS factor (P = 1), and then pick up another record tj of which P = 0, and both ti and tj have the \u201cmatched\u201d values for all the control variables. Then ti is added to the exposure group, tj is added to the non-exposure group, and both are removed from the original data set. This process repeats until no more matched pairs can be found. As a result, the distributions of the control variables in the exposure and non-exposure groups are identical or similar to each other.\nWe formulate the above discussions as the following definition.\nDefinition 3.4 (Matched record pair). Given an association rule p \u2192 z and a set of control variables C, a pair of records match if one contains value p, the other does not, and both have the matched values for C according to certain similarity measure.\nThe simplest matching is the exact matching, in which we require a pair of records have exactly the same values for control variables. For example, assume that C = (A,B,E) is the control variable set for association rule p \u2192 z, then records (P = 1, A = 1, B = 0, E = 1) and (P = 0, A = 1, B = 0, E = 1) form a matched pair. Many other similarity measures can be used for finding matched pairs of records, e.g. Euclidean distance, Jaccard distance [Han and Kamber 2005], Mahalanobis distance and propensity score [Stuart 2010], each having its own merit and disadvantages. As this paper is focused on developing and evaluating the idea of integrating association rule mining and cohort studies for causal discovery, we do not conduct extensive investigation on the different matching methods, and in our experiments, we use the exact matching and compare it with Jaccard distance matching.\nDefinition 3.5. [Fair data set for a rule] Given an association rule p \u2192 z that has been identified from a data set D and a set of control variables C, the fair data set Df for the rule is the maximum sub data set of D that contains only matched record pairs from D.\nExample 3.6. Given an association rule a \u2192 z identified using the following data set, and the control variable set C = (M,F,H,U, P ), where M stands for Male, F for Female, H for High school graduate, U for Undergraduate, and P for Postgraduate.\nID A M F H U P Z 1 1 0 1 0 0 1 1 2 1 0 1 0 1 0 1 3 1 1 0 1 0 0 0 4 1 1 0 0 0 1 1 5 0 0 1 0 0 1 0 6 0 0 1 0 1 0 0 7 0 1 0 1 0 0 0 8 0 1 0 1 0 0 1\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nWith exact matching, records (#1, #5), (#2, #6) and (#3, #7) form three matched pairs. A fair data set for a\u2192 z includes records (#1, #2, #3 #5, #6, #7).\nIn the above definition, the requirement of the maximum sub data set of D is for the best utilisation of the data set.\nMatches in a data set are not unique. A record may match more than one record. For example, (#3, #7) and (#3, #8) both are matched pairs (in terms of record #3). When there are two or more possible matches, we select a matched record randomly without knowing the value of Z. In the experiments, we show that such a random selection will cause variance in the results (different causal rules validated in different runs), so we pick frequently supported rules in multiple runs to reduce the variance. However, the experiments also show that the variance is small in large data sets (one to two rule difference in three runs). Even in a small data set, more than 80% rules are consistent over different runs.\nSince with a fair data set for a rule the exposure and non-exposure groups are identical or similar except for the value of the exposure variable, if there is a significant difference in the values of the response value between the two groups, it is reasonable to assume that the difference of the outcome is caused by the difference of the values of the exposure variable.\nNext, we discuss how to detect the statistical difference of the values of the response variable between the exposure and non-exposure groups, which will provide us the method for testing whether an association rule is a causal rule or not.\n3.4.2. Causal rules. When the values of the response variable are taken into consideration, there are four possibilities for a matched pair: both records containing z, neither containing z, record (P = 1) containing z and record (P = 0) not; record (P = 0) containing z and record (P = 1) not. The counts of the four different types of matched pairs in the fair data set for rule p\u2192 z can be represented as the following:\nP = 0 P = 1 z \u00acz z n11 n12 \u00acz n21 n22\nIn this table n11 is the number of matched pairs containing z in both the exposure and non-exposure groups; n12 the number of matched pairs containing z in the exposure group and \u00acz in the non-exposure group; n21 the number of matched pairs containing \u00acz in the exposure group and z in the non-exposure group; and n22 the number of matched pairs containing \u00acz in both the exposure and non-exposure groups. In Example 3.6, n11 = 0, n12 = 2, n21 = 0, and n22 = 1.\nUsing the above notation, we can have the following definition [Fleiss et al. 2003]:\nDefinition 3.7 (Odds ratio of a rule on its fair data set). The odds ratio of an association rule p\u2192 z on its fair data set Df is:\noddsratioDf (p\u2192 z) = n12 n21\n(2)\nIn our experiments, we replace zero count by 1 to avoid infinite odds ratios. The above definition leads to the definition of a causal rule:\nDefinition 3.8 (Causal rule). An association rule (p \u2192 z) indicates a causal relationship between P and Z (the variables for its LHS and RHS) and thus is called a causal rule, if its odds ratio on its fair data set, oddsratioDf (p \u2192 z) > min oratio, where min oratio is the minimum odds ratio.\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nAlternatively, to check if an association rule is a causal rule, we can use the significance test on the odds ratio of the rule on its fair data set with matched pairs. Let oddsratioDf (p \u2192 z) = \u03c9\u2032 in the fair data set, the confidence interval of the odds ratio for matched pairs is defined as [Fleiss et al. 2003]:\n\u03c9\u2212 = exp(ln\u03c9 \u2212 z\u2032 \u221a 1\nn12 +\n1\nn21 )\nand\n\u03c9+ = exp(ln\u03c9 + z \u2032 \u221a 1\nn12 +\n1\nn21 )\nwhere z\u2032 is the critical value corresponding to a desired level of confidence (z\u2032 = 1.96 for 95% confidence) and \u03c9\u2032\u2212 is the lower bound of oddsratioDf (p \u2192 z) in the confidence level. If \u03c9\u2032\u2212 > 1, the odds ratio is significantly higher than 1, then we conclude that P is a cause of Z.\nBased on Definition 3.8, testing if an association rule is a causal rule becomes the problem of finding the fair data set for the rule. A fair data set simulates the controlled environment for testing the causal hypothesis represented by an association rule. When the odds ratio of an association rule on its fair data set is significantly greater than 1, it means that a change of the response variable is resulted from the change of the exposure variable. We provide further justifications in the following section."}, {"heading": "3.5. Justifications for the definition of causal rules", "text": "The potential outcome or counterfactual model [Pearl 2000; Morgan and Winship 2007] is a major framework for causal inference and it is widely used in social science, health and medical research. In this section, we will demonstrate that the causal rules defined over a fair data set is consistent with the causal relationships modelled under the potential outcome framework.\nIn the potential outcome model, each individual i in a population has two potential outcomes with respect to a treatment: when taking the treatment (Ti = 1), the potential outcome is Z1i ; and when not taking the treatment (Ti = 0), the potential outcome is Z0i , where Z1i and Z0i are random variables taking values in {0, 1}. Z j i = 1 (j \u2208 {0, 1}) stands for an outcome of interest, such as a recovery. In practice, we are only able to observe one potential outcome (Z1i or Z0i ) since an individual can only be placed in either the treatment group (Ti = 1) or the control group (Ti = 0), and the other potential outcome will need to be estimated. For example, if we know that Jack did not take Panadol (i.e. Ti = 0 considering Panadol is the treatment), and now he gets a high temperature (i.e. Z0i = 1 assuming high temperature is an outcome), the question that we are asking is, what the outcome would be if Jack had taken Panadol, i.e. we want to know the potential outcome Z1i . So the potential outcome model is also called counterfactual model.\nLet us assume that we have both Z1i and Z0i of an individual i. With the potential outcome model, the causal effect of the treatment on i is defined as:\n\u03b4i = Z 1 i \u2212 Z0i (3)\nWe often aggregate the causal effects on individuals in the population (or samples) and obtain the average causal effect as the following, where E[.] is the expectation of a random variable.\nE[\u03b4i] = E[Z 1 i ]\u2212 E[Z0i ] (4)\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nIn the above equation i is kept as in other work on the counterfactual framework, to indicate individual level heterogeneity of potential outcomes and causal effects [Morgan and Winship 2007].\nTo link the above discussion to our definition of causal rules, treatment T and Zji (j \u2208 {0, 1}) are the exposure variable P and the response variable Z respectively in the causal rule definition. In the following, we keep using the notation of the potential outcome framework.\nSince we are only able to observe one of the two potential outcomes for each individual i, the causal effect in equation (4) cannot be estimated from any data set directly. However, it can be estimated under a perfect stratification of the data [Morgan and Winship 2007], where for a stratum samples within treatment and control groups are collectively indistinguishable from each other on the values of the stratifying variables and the samples are only different on the observed treatment status. Furthermore the outcome status of a sample is purely random. In this case, we can assume that:\nE[Z1i | Ti = 0, Dps] = E[Z1i | Ti = 1, Dps] (5)\nE[Z0i | Ti = 1, Dps] = E[Z0i | Ti = 0, Dps] (6) where S represents that the data set is perfectly stratified using the stratifying variables.\nThe above equations indicate that the potential outcome of an individual taking a treatment (in fact she/he has not) can be estimated by the \u2018real\u2019 outcome of the matched individual who has taken the treatment. Similarly, the potential outcome of an individual not taking a treatment (in fact she/he has taken) can be estimated by the \u2018real\u2019 outcome of the matched individual who has not taken the treatment.\nSamples in a fair data set in fact are perfectly stratified, as samples in the exposure and non-exposure groups have the same distribution in terms of the values of control variables, and the value of the response variable of a sample in the exposure or in the non-exposure group is random. Therefore according to equations (5) and (6), for a fair data set Df , we have:\nE[Z1i | Ti = 0, Df ] = E[Z1i | Ti = 1, Df ] (7)\nE[Z0i | Ti = 1, Df ] = E[Z0i | Ti = 0, Df ] (8) Let us now show how to estimate the causal effect, E[\u03b4i] with a fair data set. In a fair data set, the number of individuals being treated is the same as the number of individuals not being treated. Therefore the average causal effect can be represented as the following:\nE[\u03b4i]Df = 1\n2 (E[Z1i | Ti =1,Df ]\u2212E[Z0i | Ti =1,Df ])+\n1 2 (E[Z1i | Ti =0,Df ]\u2212E[Z0i | Ti =0,Df ])\n(9) In the above formula, based on equations (7) and (8), we substitute E[Z0i | Ti = 0, Df ] and E[Z1i | Ti = 1, Df ] for E[Z0i | Ti = 1, Df ] and E[Z1i | Ti = 0, Df ] respectively. As a result, the average causal effect in the fair data set is estimated as the following:\nE[\u03b4i]Df = E[Z 1 i | Ti = 1, Df ]\u2212 E[Z0i | Ti = 0, Df ] (10)\nwhere both outcomes are observable. So when there is no sample bias, we can remove the superscripts and subscripts and obtain the average causal effect of the samples (or a population) as the following:\n\u2206 = E[Z | T = 1, Df ]\u2212 E[Z | T = 0, Df ] (11)\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nThis formula suggests that following the potential outcome model, the causal effect is the difference of the outcomes in the treatment (exposure) group and the control (non-exposure) group in a fair data set. In our definition of a causal rule, we also use the difference of outcomes in different groups to identify causal rules, except that we use the odds ratio to represent the difference as a cohort study does instead of the above arithmetic difference. Therefore, the definition of a causal rule over a fair data set is correct, in the sense that it is consistent with the approach under the potential outcome framework."}, {"heading": "4. ALGORITHM", "text": "In this section we present the algorithm (Algorithm 1) for causal rule mining (called CR-CS in the rest of this paper). The algorithm integrates association rule mining with causal relationship test based on cohort studies. In the following, we firstly discuss two anti-monotone properties for efficient generation of candidate causal rules, and we then discuss the selection of control variables for building a fair data set. Finally, we introduce the details of detecting causal rules from the candidate causal rules.\nALGORITHM 1: Causal Rule mining with Cohort Study (CR-CS) Input: Data set D with the response variable Z, the minimal local support \u03b4, the maximum length of rules k0, and the minimum odds ratio \u03b1. Output: A set of causal rules 1: let causal rule set RC = \u2205 2: add 1-patterns to a prefix tree T (see Section 4.3) as the 1st level nodes 3: count support of the 1st level nodes with and without response z 4: remove nodes whose local support is no more than \u03b4 // Support pruning 5: Let X be the set of attributes containing frequent 1-patterns 6: find the set of irrelevant attributes I 7: let k = 1 8: while k \u2264 k0 do 9: generate association rules at the k-th level of T 10: for each generated rule ri do 11: find exclusive variables E of LHS(ri) 12: let control variable set C = X\\(I, E, LHS(ri)) 13: create a fair data set for ri // Function 1 14: if oddsratioDf (ri) > \u03b1 then 15: move ri to RC 16: remove LHS(ri) from the k-th level of T // Observation 1 17: end if 18: end for 19: k = k + 1 20: generate k-th level nodes of T 21: count the support of the k-th level nodes with and without response z 22: remove nodes whose local support is no more than \u03b4 // Support pruning 23: remove nodes of patterns whose supports are the same as those of their sub-patterns\nrespectively // Observation 2 24: end while 25: output RC"}, {"heading": "4.1. Anti-monotone properties", "text": "Anti-monotone properties are at the core for efficient association rule mining. For example a well known anti-monotone property is that a super set of an infrequent pattern\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nis infrequent, and infrequent patterns are pruned before they are generated (called forward pruning). We firstly discuss the anti-monotone properties that we will apply to candidate causal rule pruning.\nIn the following discussions, we say that rule px\u2192 z is more specific than rule p\u2192 z, or p\u2192 z is more general than px\u2192 z. Furthermore, we use cov(p) to represent the set of records in D containing value p, and we call cov(p) the covering set of p. A rule is redundant if it is implied by one of its more general rules.\nOBSERVATION 1 (ANTI-MONOTONE PROPERTY 1). All more specific rules of a causal rule are redundant.\nPROOF. This observation is based on the persistence property of a real causal relationship. Persistence means that a causal relationship holds in any condition. This implies that when a rule is specified, although additional conditions are added to the LHS of the rule, the conditions do not change the causal relationship. Therefore for the purpose of discovering causal rules/relationships, more specific candidate causal rules are implied by the general rule, and hence are redundant.\nFor example, if rule \u201ccollege graduate\u2192 high salary\u201d holds, then we know that both male college graduates and female college graduates enjoy high salaries. It is therefore redundant to have the rules \u201cmale college graduate\u2192 high salary\u201d and \u201cfemale college graduate\u2192 high salary\u201d.\nOBSERVATION 2 (ANTI-MONOTONE PROPERTY 2). If supp(px) = supp(p), rule px\u2192 z and all more specific rules of px\u2192 z are redundant.\nPROOF. If supp(px) = supp(p), then cov(px) = cov(p). In other words, both p \u2192 z and px\u2192 z cover the same set of records. There will be the same fair data set for both rules. Therefore, if p\u2192 z is a causal rule, so is px\u2192 z. If p\u2192 z is not a causal rule, nor is px\u2192 z. Hence rule px\u2192 z is redundant.\nLet rule pxy \u2192 z be a more specific rule of rule px \u2192 z. If supp(px) = supp(p), then supp(pxy) = supp(py). Using the same reasoning above, we conclude that rule pxy \u2192 z is redundant with respect to rule px\u2192 z.\nSince there are two anti-monotone properties in addition to the anti-monotone property of support, it is efficient to use a level wise algorithm like Apriori [Agrawal et al. 1996]. Both anti-monotone properties 1 and 2 can be used in the same way as the anti-monotone property of support."}, {"heading": "4.2. Control variables", "text": "The set of control variables determines the size of a fair data set. If the control variable set is large, the chance of finding a non-empty fair data set is small. Therefore we need to find a proper control variable set, without compromising the quality of the causal discovery. In the following we discuss how to obtain such a control variable set.\nLet X represent the set of all predictor variables, and as before P is the exposure variable and C is a set of control variables. Initially, let C = X\\P .\nDefinition 4.1 (Relevant and irrelevant variables). If a variable is associated with the response variable, it is relevant. Otherwise, it is irrelevant.\nWe do not control irrelevant variables, hence C = X\\(P, I) where I stands for a set of irrelevant variables.\nThe major purpose for controlling is to eliminate the effects of other possible causal factors on the response variable. Other variables that are random with respect to the value of the response variable can be considered as noises and need not to be controlled. With Example 3.3, when we test the association rule \u201cGender = m\u201d \u2192 \u201cSalary = low\u201d\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nfor finding a causal relationship, we should control variables like education, location, profession and working experience. However, we do not control variables like blood type and eye colour, since they are irrelevant to salary.\nThe combination of multiple irrelevant variables can be relevant. However, we do not consider combined variables in the control variable set. There will be many combined relevant variables and the support of combined variables are normally small. Therefore when they are included in the control variable set, it is very likely to have empty exposure or non-exposure groups.\nDefinition 4.2 (Exclusive variables). Variables P and Q are mutually exclusive if supp(pq) \u2264 or supp(\u00acpq) \u2264 where is a small integer.\nWe do not control an exclusive variable of the exposure variable P , i.e. we let C = X\\(P, I,Q) where Q stands for a set of exclusive variables of P . Because if an exclusive variable is controlled, the exposure group or the non-exposure group may be empty, thus we are unable to do a cohort study. Let us take = 0 as an example. When supp(pq) = 0, we will have samples with (P = 1, Q = 0), (P = 0, Q = 1) and (P = 0, Q = 0), but not (P = 1, Q = 1). In this case, for a record in the non-exposure group with (P = 0, Q = 1), no match can be found in the exposure group with (P = 1, Q = 1). When supp(\u00acpq) = 0, we will have samples with (P = 1, Q = 1), (P = 1, Q = 0) and (P = 0, Q = 0), but not (P = 0, Q = 1), then for a record in the exposure group with (P = 1, Q = 1), it is impossible to find a match with (P = 0, Q = 1).\nA main type of exclusive variables are those caused by database constraints. For example, P represents the highest qualification being high school andQ represents the highest qualification being university degree. As they both belong to the same domain in a relational data set, and an individual has only one highest qualification, P and Q are mutually exclusive (supp(pq) = 0). In this case, it is not necessary to control Q as it does not affect the finding about whether P is a cause of the response variable.\nAnother type of exclusive variables are redundant attributes. Let us assume that two variables have the identical values but different names. e.g. P and Q. They are mutually exclusive since supp(\u00acpq) \u2264 . We do not need to test both separately to see if they are causes of the response variable since one test is enough. However, if we include Q in the control variable set, we will not be able to test P since the fair data set is empty.\nExclusive variables can be confounding variables, for example P = thunder and Q = storm may be mutually exclusive in a data set since supp(\u00acpq) \u2264 . Let us assume that they jointly cause the response. If we control Q, P will not be tested as a cause. When we remove Q from the control variable set, we will be able to find P as a cause. It is not difficult to find out that Q is a confounder of P in post processing since they are strongly associated."}, {"heading": "4.3. Candidate causal rule generation", "text": "This algorithm makes use of branch and bound search similar to Apriori [Agrawal et al. 1996] for association rule mining. The algorithm employs support pruning plus the two pruning criteria (Observations 1 and 2) presented in Section 4.1, and therefore searches much smaller search space than Apriori. The algorithm is based on a prefix tree structure for candidate generation, storage and counting. The prefix tree structure has been shown to support efficient implementation for branch and bound search [Borgelt 2003].\nA prefix tree is an ordered tree to store ordered sets (see Figure 1 for an example). In our algorithm, each node stores a set of nonzero variable values (or a potential LHS of a rule). We assume that nonzero variable values are coded and ordered, and this is to prevent generating duplicate candidate causal rules. A node stores the prefix set of the\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nsets stored in its child nodes, and a child node is labeled by the different value between its stored set and the set of its parent. The root of the prefix tree stores an empty set.\nThe set of labels along the path from the root to a node is the set of values stored in the node. This index makes the search, insert, and delete a node easy. This property also makes the counting of supports of value sets efficient too. If a set stored in a parent node is not in a record, all sets stored in its child nodes will not be in the record too. This property avoids many unnecessary search in the counting process. In the counting process, each node store two counts, for example, supp(pz) and supp(p\u00acz). As a result, the contingency table of p\u2192 z is determined.\nAll super sets with the same prefix stored under a parent node storing the prefix. When the parent node is removed, so are all super sets. This suits the forward pruning for candidate causal rule generation very well. For more efficient pruning, the backtrack links to other parent nodes in the prefix tree are also added. For example, in Figure 1 node abc links to node bc, and such link will facilitate the pruning by Antimonotone property 2.\nReferring to Algorithm 1, the code involved in the candidate generation includes Lines 2-4, 9, and 20-23. They are self-explanatory based on the discussions in this and the previous subsection."}, {"heading": "4.4. Causal rule detection", "text": "This process involves three steps, as discussed below.\n4.4.1. Determining control variables. We firstly determine the set of irrelevant variables, each of which is not associated with the response variable. For a variable Y , its association with the response variable Z can be determined by the odds ratio of y \u2192 z. The above identified irrelevant variables are excluded from the control variable set. These are implemented by Lines 6 and 12.\nSecondly we identify the exclusive variables of an exposure variable, say P , according to Definition 4.2 where is set to the same value as the minimum local support. We exclude the identified exclusive variables from the control variable set. These are implemented by Lines 11 and 12.\nThe remaining variables then form the control variable set. The control variable set can be viewed as a set of patterns in association rule mining. For example, if male, female, college and postgraduate form the control variable set, the set includes the\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nFunction 1 Create a fair data set for rule p\u2192 z Input: Data set D, rule p\u2192 z, and control variable set C Output: a fair data set for rule p\u2192 z, Df 1: find the covering set of c(C = 1), Dc 2: split Dc into Dcp and Dc\u00acp // Dcp contains value p and Dc\u00acp does not 3: let Df = \u2205 4: for each record ti in Dcp // assuming |Dcp| \u2264 |Dc\u00acp|. If not, swap Dcp and Dc\u00acp. do 5: for each record tj in Dc\u00acp do 6: if ti and tj are matched w.r.t the values of C then 7: move ti and tj to Df 8: end if 9: end for 10: end for 11: output Df\npatterns {(male, college), (male, postgraduate), (female, college), (female, postgraduate)}.\n4.4.2. Creating fair data set. We select the samples from the given data set D to get the fair data set for rule p\u2192 z, following the procedure listed in Function 1. We firstly find the covering set of c. Then the covering set of c is split into two subsets: one containing value p, denoted by Dcp, and the other containing value \u00acp (or P = 0), denoted by Dc\u00acp. Assume that |Dcp| \u2264 |Dc\u00acp| (if not, we swap the order in the following description). For each record in Dcp, find a matched record in Dc\u00acp with respect to the control variable set. We have implemented exact matching and the matching using Jaccard distance. If there are more than one matched records, choose one randomly. Add the pair of records to the fair data set. If there is no matched record in Dc\u00acp, move to the next record.\n4.4.3. Testing causal rules. To check if an association rule p \u2192 z is a causal rule, we firstly follow Definition 3.7 to calculate the odds ratio of the rule on its fair data set created in the previous step. Then according to Definition 3.8, if the odds ratio is greater than the given minimum odds ratio, we can say that p \u2192 z is a causal rule. This has been implemented by Line 14 in Algorithm 1. Alternatively, we can use the method introduced in Section 3.4.2 to test the significance of the odds ratio of the rule on its the fair data set. If the odds ratio is significantly higher than 1 for a given confidence level, then we conclude that P is a cause of Z."}, {"heading": "5. EXPERIMENTS", "text": ""}, {"heading": "5.1. Data sets and parameters", "text": "To evaluate CR-CS, the proposed causal rule mining algorithm, twenty four synthetic data sets and eight frequently used public data sets were employed in the experiments. A summary of the data sets is given in Table I. The number of variables in the table refers to the number of predictor variables in a data set. All predictor variables and the response variable are binary variables, with values of 1 or 0 indicating the presence or absence of an attribute correspondingly. The class variable in each of the eight public data sets is set as the response variable in our experiments. The distributions refer to the percentages of the two different values of response variables in the data sets. For the synthetic data sets, the ground truth column represents the number of true single causes and known combined causes each consisting of two predictor variables.\nThe first fifteen synthetic data sets in Table I were used to evaluate the performance of CR-CS in finding single causal rules in comparison with the Bayesian network based\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nmethods, PC-Select, CCC, and CCU. Those synthetic data sets of random Bayesian networks were generated using the TETRAD software (http://www.phil.cmu.edu/tetrad/). In TETRAD, we firstly generate randomly the structure of the BN using the \u201csimulate data from IM\u201d template. The conditional probability table was also randomly assigned, which will be used to simulate the data. The data sets were then generated using the built-in Bayes Instantiated Model (Bayes IM). In the Bayes IM, the data of each binary variable was randomly generated so that the distributions of all the variables satisfy the constraints in the conditional probability tables. We selected a node in each of the BNs as the fixed target for running the algorithms.\nThe next five synthetic data sets (V200-10K, ..., V1000-10K) were used to assess the efficiency of the algorithms. To generate those large data sets with a fixed propotion of nodes being the parents of the target node (which is not practical with TETRAD), we firstly draw simple BNs where some predictor variables are parents of the response\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nvariable, and some are not. We then use logistic regression to simulate the data sets for those BNs. The total number of causes in each BN is given in Table I.\nMeanwhile the four data sets, V8-2K, V12-2K, V16-2K, and V20-2K-cmb, are for assessing the ability of CR-CS to discover combined causes. These four synthetic data sets have been generated with the following procedure. We firstly generate a data set for a random BN using TETRAD and choose a node as the target. To create a known combined cause, we randomly select a parent variable, X, of the target in the generated BN to split it into two new variables, Xa, Xb. The new variables must satisfy two conditions: (1)X = Xa \u2227Xb (i.e. X = 1 if and only if Xa = 1 and Xb = 1), and (2) Xa and Xb are not associated with the response variable. The number of known combined causes are shown in Table I. Note that we do not have a complete ground truth of all combined causes, as there may be other combined causes in the data set due to the combinations of non-causal single variables. In the experiments, we investigate the performance of CR-CS in terms of the ability to recover known combined causes.\nAmong real world data sets, Hypothyroid and Sick are two medical data sets and they were originally retrieved from the Thyroid Disease folder of the UCI Machine Learning Repository [Bache and Lichman 2013] and then discretised by using the MLC++ discretisation utility [Kohavi et al. 1996]. The Adult data set is an extraction of the USA census database in 1994 and it was also retrieved from the same repository. In our experiments, all continuous attributes have been removed from the original Adult data set. These three data sets were used in the experiments for testing the effectiveness of CR-CS, in comparison with other methods (see Sections 5.2 and 5.3). They were also used for evaluating the stability (Section 5.4) of CR-CS and the impact of different matching methods (Section 5.5).\nThe Census Income (KDD) data set was also sourced from the UCI Machine Learning Repository. We combined the training and test data sets and then sampled 50K, 100K, 150K, 200K and 250K records for the experiments. Continuous attributes have been removed. The data set and the last five synthetic data sets (with 10K records) were used to assess the efficiency of CR-CS (Section 5.6). Other real world data sets are also from UCI Machine Learning Repository and are used to investigate the number of combined causes discovered by CR-CS.\nIn the experiments, while the default minimum local support (\u03b4 in Algorithm 1) was 0.05, we set it to 0.01 for the Adult data set in the comparison with the other three methods, CCC [Cooper 1997], CCU [Silverstein et al. 2000] and PC-select [Colombo et al. 2014]. The confidence level was set to 99% for calculating the confidence interval (lower bounds and upper bounds) of the odds ratio for synthetic data sets, and 95% for real world data sets considering the noises in the real world data sets."}, {"heading": "5.2. Causal rules vs. association rules", "text": "Causal rules have advantages over association rules. An association rule may represent a spurious relationship between two variables as a statistical association does not necessarily mean that the two variables are related or directly related (while a causal rule indicates that the two variables have a direct relationship given the observed variables). Those spurious association rules could not be removed by increasing thresholds. They can only be identified by analysing the relationship by shielding the effects of other variables.\nTo investigate the difference between association rule mining and causal rule mining, we compared the results obtained by CR-CS with the results of various types of association rule mining. From Table II, the number of causal rules is significantly smaller than the numbers of other types of (association) rules, including association rules [Agrawal et al. 1996], non-redundant rules [Zaki 2004], and optimal rules [Li 2006]. Associations are measured by the odds ratio defined in Definition 3.1, and their\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nsignificance is tested using the method discussed in Section 3.2, and all the methods used the same minimum local support. The maximum length of rules is 4.\nThe number of causal rules obtained from a data set is very small. They may not be enough for classification since not every record in the data is covered by a causal rule. However, they are more reliable relationships since each causal rule is tested by the cohort study in data.\nMost discovered causal rules (99%) are short and include one or two variables, which makes it easy for these rules to be easily interpreted and applied to solve real world problems where only short rules are preferred."}, {"heading": "5.3. Causal rules vs. findings of other causal discovery methods", "text": "To evaluate the performance of CR-CS, we conducted a set of experiments with the first 15 synthetic data sets and 3 real world data sets, Adults, Hypothyroid and Sick, and compared the performance of CR-CS with the constraint based methods, CCC [Cooper 1997], CCU [Silverstein et al. 2000], and PC-select [Colombo et al. 2014].\nAs mentioned in Section 2, CCC [Cooper 1997] and CCU [Silverstein et al. 2000] are two efficient constraint based causal discovery methods. Both of them learn the simple structures involving three variables with certain dependence/independence relationships among them, and infer causal relationships from the structures. Both methods assume no hidden and no confounding variables in data sets. PC-select [Colombo et al. 2014] is a local causal discovery method that finds all the parents and children of a given node. It is similar to the well-known PC algorithm [Spirtes et al. 2001] for learning a Bayesian network, except that it only finds the local causal relationships around a given response variable. The PC algorithm can return optimal result\nIn the experiments, CCC and CCU were restricted to identify the structures involving the response variables only. When a statistical significance test was involved, 95% confidence level is used. With our method (CR-CS), since there are small variations in the causal rules discovered in different runs due to random selection of matched pairs when a record has multiple matches, in the experiments, with one data set, we generated causal rules (i.e. ran the algorithm) three times and chose the rules occurring at least twice in the three runs.\n5.3.1. Experiment results of synthetic data. Table III shows the precision (P ), recall (R), and F1-measure (F1) of the four methods for the 15 synthetic data sets with different number of variables and samples. As we can see from the table, PC-select and CR-CS are significantly better than CCC and CCU in precision, recall, and F1 measure. CR-CS and PC-select achieve good results with more than 70% in precision and F1 measure for most of the synthetic data sets.\nTo investigate if a method performs better than the other, for each pair of methods, we conduct the Wilcoxon test [Dems\u030car 2006] of the F1-measures of the results obtained by the pair of methods with the fifteen data sets. Table IV shows the pairwise test results for the four methods. Overall, PC-select and CR-CS are significantly better than CCC and CCU, but there is no evidence to conclude that CR-CS or PC-select is\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nbetter than the other. However, note that PC-select is only suitable for data sets with small number of nodes or sparse data sets with small number of causes of the target. It took more than two hours for PC-select to complete when it was applied to the synthetic data set with 100 nodes and 20 causes of the target, and it failed to return results for the data set with 120 nodes with 26 causes of the target within 24 hours.\nTo evaluate the ability of CR-CS in recovering combined causal rules, we use synthetic data sets with known combined rules as described in section 5.1. We applied CR-CS to the four data sets, V8-2K, V12-2K, V16-2K, and V20-2K-cmb to discover level 2 rules with the 99% confidence level. The experiment results have shown that CR-CS can recover all known combined rules, including 2 rules in V8-2K, 3 rules in V12-2K, 3 rules in V16-2K, and 4 rules in V20-2K. There are also 5, 3, 16, and 15 extra combined rules discovered by CR-CS in the four data sets, respectively. We do not have a means to test if extras are real combined causes. However, the results show that the method is able to uncover known combined causes.\n5.3.2. Experiment results of real world data. With the Adult data set, as shown in Table V, CR-CS, CCC and CCU discovered similar number of rules, while PC-select found a relatively small number of rules.\nWhen we look into the rules discovered by these methods, they are quite different. We list in Table VI the most similar and dissimilar rule groups found in the Adult data set using CR-CS and the other methods. We can see that overall CR-CS and PCselect obtained similar results, while only for the variables related to the Education\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nattribute, rules discovered by CR-CS and PC-select are similar to those discovered by CCC and CCU.\nIntuitively, Education is the major factor affecting incomes. We see that people with higher education have a better chance for a high salary, such as, doctorate, masters, bachelors, and professional school (prof-School). In contrast, people with lower education more likely receive a low salary, for example some college but no degree and lower.\nRules discovered by CR-CS and PC-select are dissimilar to those found by CCC and CCU in relation to the Occupation, Workclass and Native-country attributes. There are 11 rules discovered by CR-CS with respect to the Occupation attributes, but only one rule is discovered by CCC and CCU in this group. CCC and CCU have missed some very reasonable causal factors for high/low salary. For example, \u201cexec-managerial\u201d and \u201cprof-specialty\u201d for high salary, and \u201chandlers-cleansers\u201d and \u201cadm-clerical\u201d for low salary are reasonable causal rules, but they have been missed by CCC and CCU. PCselect, although found fewer number of rules in this group (Occupation), the rules found by it are reasonable. On the other hand, 22 rules related to the Native Country attributes are discovered by CCC, 17 rules by CCU, but only 1 rule by CR-CS in this group. PC-select found two rules in this group, again performing more consistently with CR-CS. Intuitively, Native Country should not a factor for high/low salary. This shows that CR-CS is able to discover more reasonable causal rules.\nThe combined causal rule discovered by CR-CS is also reasonable. As shown in Table VI, people with some-college education but without any degree and working in a private sector would have low salaries. CR-CS did not discover that people with somecollege or with private work-class would have low income at the single rule level as found by CCC and CCU, but it provides more details with the combined causal rule.\nTo investigate the number of combined causal rules in real world cases, we run CRCS for eight real world data sets with up to level 4 rules. Table VII shows the number of single and combined causal rules discovered by CR-CS with the 95% confidence level. We can see that the combined causal rules at level 3 and 4 are rare, but CRCS found a number of combined causal rules at the second level. Although we do not have a ground truth to validate all of the combined rules, some rules are reasonable based on common knowledge. For example, with the Mushroom data set, we can see from Table VIII that poisonous mushrooms are pink and have either evanescent ring type or white spore print. Our common understanding is that poisonous mushrooms are normally in bright color, but not all brightly colored mushrooms are poisonous. These combined causal rules provide more detail on the poisonous mushrooms than just based on their colors, and therefore they are useful in practice. Similarly, CR-CS discovers that mushrooms without bright color and odor are edible, and these rules are also reasonable."}, {"heading": "5.4. Stability", "text": "The creation of a fair data set is subject to selection bias. Usually there are significantly more exposed cases than non-exposed cases so the data distribution is often skewed for\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nthe exposure and non-exposure conditions. When we choose pairs of matched records to form a fair data set, we pick up one record from the exposure group and find a matched record from the non-exposure group. In this process, the values of the response variable are blinded. When there are more than one matched record to choose from, we randomly choose one. It is possible that the value distribution of the response variable in a fair data set is affected by the random selection. This will cause misses or false\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\ndiscoveries of causal rules. This situation is the same as the real world sample process, which is subjected to sampling bias.\nTo reduce the impact of selection bias, we run the method on a data set multiple times and select consistent rules in multiple causal rule sets as the final causal rules. The variance is not big and the causal discovery is quite stable. The numbers of causal rules from different runs and the rules supported by two causal rule sets are listed in Table IX. On a large data set, such as the Adult data set, the change of rules between different runs is very small. Only one rule difference in the three runs. Even in a small data set, such as the Sick data set, nearly 90% rules are consistent over three runs."}, {"heading": "5.5. Results obtained using different matching methods", "text": "As described in Section 3.4 (Definition 3.4), when creating a fair data set, different similarity measures can be used for finding matched pairs of records. In the experiments described so far, exact matching has been used. In order to gain some insights into the impact of different similarity measures, we also experimented on our method when Jaccard distance is used in matching a pair of records. Jaccard distance [Han and Kamber 2005] is a commonly used measure of the similarity between records with binary attributes. From Table X, we see that the numbers of rules discovered are very similar across the three data sets with exact matching and the matching using Jaccard distance.\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015."}, {"heading": "5.6. Efficiency", "text": "To test the time efficiency of CR-CS, we applied it to the Census Income (KDD) data set and the last five synthetic data sets (with 10K records), to observe its scalability in terms of the number of records and the number of attributes respectively. The experiments were also done in comparison with the other three methods.\nAs the original CCC and CCU algorithms do not assume a fixed response variable, we ran them with the restriction of only looking for the triplets that contain the response variable. For our method, we ran it in two different versions: CR-CS1 and CR-CS2 respectively. With CR-CS1, we constrained the length of rules to 1, making it comparable with CCC, CCU and PC-select. With CR-CS2, the length of rules was restricted to 2 to allow the discovery of combined causes. CR-CS1 and CR-CS2 were implemented in Java, CCC and CCU were implemented in Matlab, and for PC-select, we used the pcSelect() function of the R package pcalg [Colombo et al. 2014; Kalisch et al. 2012]. The comparisons were carried out using the same desktop computer (Quad core CPU 3.4 GHz and 16 GB of memory).\nThe execution time (in seconds) of CR-CS1, CR-CS2, CCC and CCU with respect to the number of records in the Census Income (KDD) data is shown in Figure 2. The execution time of PC-select is not included as it did not return results on any data set after two hours of execution. From the figure, we can see that CR-CS1 was much faster than CCC and CCU consistently for different record sizes, and even CR-CS2 was also faster than the other methods. The main reason is that our method employs association rule mining to remove non-eligible rules and thus to reduce the search space significantly.\nThe execution time of CR-CS1, CR-CS2, CCC, CCU and PC-select with respect to the number of attributes is shown in Figure 3 (only the results returned within 6 hours are shown). Similarly, CR-CS1 is more scalable than CCC and CCU, while CR-CS2 is much slower when the number of attributes became big as the number of association rules increased significantly with the increase of the number of attributes, leading to additional time for testing causal rules. Although PC-select can achieve high quality of causal discovery (see Table III), from the Figure 3, we can see that PC-select is inefficient or even infeasible, especially when the number of variables is large."}, {"heading": "6. CONCLUSION AND FUTURE WORK", "text": "In this paper, we have proposed the concept of causal rules and have developed a method to find causal rules from observational data by integrating association rule mining with retrospective cohort studies. Through the integration, our method has been able to take the advantage of the high efficiency of association rule mining to produce candidate causal relationships from large data sets, and then to utilise the idea of cohort studies to obtain reliable causal rules based on the candidates. The validity of the definition of causal rules has been justified to be consistent with the potential outcome model. Experiments results have shown that the proposed method is able to find more reasonable causal relationships comparing to the existing causal discovery methods. Moreover, our method was able to find causes consisting of combined variables, which are not possible to be uncovered by the other existing methods. We have\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nshown that the method is faster than the efficient constraint based causal relationship discovery methods. Hence our method can be used as a promising alternative for causal discovery in large and high dimensional data sets. With the proposed method, the selection of control variable set is a key to discovering quality causal rules. The validation of the control variable set in real world applications will ensure the quality of causal rules discovered.\nACM Transactions on Intelligent Systems and Technology, Vol. 00, No. 00, Article 00, Publication date: 2015.\nThe proposed causal rule mining method and the constraint based causal discovery approaches tackle the problem of causal discovery from different directions. They each have their own strengths and limitations. Our future work will be studying how they complement each other and exploring integrated methods for efficient and quality causal relationship discovery."}, {"heading": "ACKNOWLEDGMENTS", "text": "This work has been partially supported by Australian Research Council Discovery Project DP130104090 and DP140103617."}], "references": [{"title": "Mining association rules between sets of items in large databases", "author": ["R. Agrawal", "T. Imieli\u0144ski", "A. Swami."], "venue": "Proceedings of SIGMOD\u201993. 207\u2013216.", "citeRegEx": "Agrawal et al\\.,? 1993", "shortCiteRegEx": "Agrawal et al\\.", "year": 1993}, {"title": "Fast discovery of association rules", "author": ["R. Agrawal", "H. Mannila", "R. Srikant", "H. Toivonen", "A.I. Verkamo."], "venue": "Advances in Knowledge Discovery and Data Mining. 307\u2013328.", "citeRegEx": "Agrawal et al\\.,? 1996", "shortCiteRegEx": "Agrawal et al\\.", "year": 1996}, {"title": "Local causal and Markov blanket induction for causal discovery and feature selection for classification Part I: Algorithms and empirical evaluation", "author": ["C.F. Aliferis", "A. Statnikov", "I. Tsamardinos", "S. Mani", "X.D. Koutsoukos."], "venue": "Journal of Machine Learning Research 11 (2010), 171\u2013234.", "citeRegEx": "Aliferis et al\\.,? 2010", "shortCiteRegEx": "Aliferis et al\\.", "year": 2010}, {"title": "UCI Machine Learning Repository", "author": ["K. Bache", "M. Lichman."], "venue": "(2013). http://archive.ics.uci.edu/ml", "citeRegEx": "Bache and Lichman.,? 2013", "shortCiteRegEx": "Bache and Lichman.", "year": 2013}, {"title": "Observational Studies in Radiology", "author": ["C.C. Blackmore", "P. Cummings."], "venue": "American Journal of Roentgenology 183, 5 (2004), 1203\u20131208.", "citeRegEx": "Blackmore and Cummings.,? 2004", "shortCiteRegEx": "Blackmore and Cummings.", "year": 2004}, {"title": "Efficient implementations of Apriori and Eclat", "author": ["C. Borgelt."], "venue": "Proceedings of IEEE ICDM Workshop on Frequent Item Set Mining Implementations. 24\u201332.", "citeRegEx": "Borgelt.,? 2003", "shortCiteRegEx": "Borgelt.", "year": 2003}, {"title": "Beyond market baskets: Generalizing association rules to correlations", "author": ["S. Brin", "R. Motwani", "C. Silverstein."], "venue": "Proceedings of SIGMOD\u201997. 265\u2013276.", "citeRegEx": "Brin et al\\.,? 1997", "shortCiteRegEx": "Brin et al\\.", "year": 1997}, {"title": "Large-Sample Learning of Bayesian Networks is NPHard", "author": ["D. Chickering", "D. Heckerman", "C. Meek."], "venue": "Journal of Machine Learning Research 5 (2004), 1287\u20131330.", "citeRegEx": "Chickering et al\\.,? 2004", "shortCiteRegEx": "Chickering et al\\.", "year": 2004}, {"title": "Package \u2018pcalg", "author": ["D. Colombo", "A. Hauser", "M. Kalisch", "M. Maechler."], "venue": "(2014). Retrieved March 13, 2014 from http://cran.r-project.org/web/packages/pcalg/pcalg.pdf", "citeRegEx": "Colombo et al\\.,? 2014", "shortCiteRegEx": "Colombo et al\\.", "year": 2014}, {"title": "Randomized, controlled, trials, observational studies, and the hierarchy of research design", "author": ["J. Concato", "Shah N", "R.I. Horwitz."], "venue": "The New England Journal of Medicine 342, 25 (June 2000), 1887\u20131892.", "citeRegEx": "Concato et al\\.,? 2000", "shortCiteRegEx": "Concato et al\\.", "year": 2000}, {"title": "A simple constraint-based algorithm for efficiently mining observational databases for causal relationships", "author": ["G.F. Cooper."], "venue": "Data Mining and Knowledge Discovery 1 (1997), 203\u2013224.", "citeRegEx": "Cooper.,? 1997", "shortCiteRegEx": "Cooper.", "year": 1997}, {"title": "Statistical comparisons of classifiers over multiple data sets", "author": ["J. Dem\u0161ar."], "venue": "The Journal of Machine Learning Research 7 (2006), 1\u201330.", "citeRegEx": "Dem\u0161ar.,? 2006", "shortCiteRegEx": "Dem\u0161ar.", "year": 2006}, {"title": "Cohort studies: prospective versus retrospective", "author": ["A.M. Euser", "C. Zoccali", "K. Jager", "F.W. Dekker."], "venue": "Nephron Clinical Practice 113 (2009), 214\u2013217.", "citeRegEx": "Euser et al\\.,? 2009", "shortCiteRegEx": "Euser et al\\.", "year": 2009}, {"title": "Statistical Methods for Rates and Proportions (3rd ed.)", "author": ["J.L. Fleiss", "B. Levin", "M.C. Paik"], "venue": null, "citeRegEx": "Fleiss et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Fleiss et al\\.", "year": 2003}, {"title": "Causality: Objectives and Assessment", "author": ["I. Guyon", "D. Janzing", "B. Sch\u00f6lkopf."], "venue": "Journal of Machine Learning Research Workshop and Conference Proceedings 6 (2010), 1\u201342.", "citeRegEx": "Guyon et al\\.,? 2010", "shortCiteRegEx": "Guyon et al\\.", "year": 2010}, {"title": "Data Mining: Concepts and Techniques (2nd ed.)", "author": ["J. Han", "M. Kamber"], "venue": null, "citeRegEx": "Han and Kamber.,? \\Q2005\\E", "shortCiteRegEx": "Han and Kamber.", "year": 2005}, {"title": "Causal Inference Using Graphical Models with the R Package pcalg", "author": ["M. Kalisch", "M. M\u00e4chler", "D. Colombo", "M.H. Maathuis", "P. B\u00fchlmann."], "venue": "Journal of Statistical Software 47, 11 (5 2012), 1\u201326.", "citeRegEx": "Kalisch et al\\.,? 2012", "shortCiteRegEx": "Kalisch et al\\.", "year": 2012}, {"title": "A review of causal inference for biomedical informatics", "author": ["S. Kleinberg", "G. Hripcsak."], "venue": "Journal of Biomedical Informatics 44, 6 (2011), 1102\u20131112.", "citeRegEx": "Kleinberg and Hripcsak.,? 2011", "shortCiteRegEx": "Kleinberg and Hripcsak.", "year": 2011}, {"title": "Data mining using MLC++: A machine learning library in C++", "author": ["R. Kohavi", "D. Sommerfield", "J. Dougherty."], "venue": "Tools with Artificial Intelligence. IEEE Computer Society Press, 234\u2013245.", "citeRegEx": "Kohavi et al\\.,? 1996", "shortCiteRegEx": "Kohavi et al\\.", "year": 1996}, {"title": "On selecting interestingness measures for association rules: User oriented description and multiple criteria decision aid", "author": ["P. Lenca", "P. Meyer", "B. Vaillant", "S. Lallich."], "venue": "European Journal of Operational Research 184, 2 (2008), 610\u2013626.", "citeRegEx": "Lenca et al\\.,? 2008", "shortCiteRegEx": "Lenca et al\\.", "year": 2008}, {"title": "On optimal rule discovery", "author": ["J. Li."], "venue": "IEEE Transactions on Knowledge and Data Engineering 18, 4 (2006), 460\u2013471.", "citeRegEx": "Li.,? 2006", "shortCiteRegEx": "Li.", "year": 2006}, {"title": "Mining causal association rules", "author": ["Jiuyong Li", "Thuc Duy Le", "Lin Liu", "Jixue Liu", "Zhou Jin", "Bingyu Sun."], "venue": "Data Mining Workshops (ICDMW), 2013 IEEE 13th International Conference on. IEEE, 114\u2013 123.", "citeRegEx": "Li et al\\.,? 2013", "shortCiteRegEx": "Li et al\\.", "year": 2013}, {"title": "Integrating classification and association rule mining", "author": ["B. Liu", "W. Hsu", "Y. Ma."], "venue": "Proceedings of KDD\u201998. 27\u201331.", "citeRegEx": "Liu et al\\.,? 1998", "shortCiteRegEx": "Liu et al\\.", "year": 1998}, {"title": "A theoretical study of y structures for causal discovery", "author": ["S. Mani", "G.F. Cooper", "P. Spirtes."], "venue": "Proceedings of the Conference on Uncertainty in Artificial Intelligence (UAI\u201906). AUAI Press, 314\u2013323.", "citeRegEx": "Mani et al\\.,? 2006", "shortCiteRegEx": "Mani et al\\.", "year": 2006}, {"title": "Counterfactuals and causal inference: Methods and principles for social research", "author": ["Stephen L Morgan", "Christopher Winship."], "venue": "Cambridge University Press.", "citeRegEx": "Morgan and Winship.,? 2007", "shortCiteRegEx": "Morgan and Winship.", "year": 2007}, {"title": "Learning Bayesian Networks", "author": ["R.E. Neapolitan."], "venue": "Prentice Hall.", "citeRegEx": "Neapolitan.,? 2003", "shortCiteRegEx": "Neapolitan.", "year": 2003}, {"title": "Causality: Models, Reasoning, and Inference", "author": ["J. Pearl."], "venue": "ambridge University Press.", "citeRegEx": "Pearl.,? 2000", "shortCiteRegEx": "Pearl.", "year": 2000}, {"title": "Using Markov blankets for causal structure learning", "author": ["J.P. Pellet."], "venue": "Journal of Machine Learning Research 9 (2008), 1295\u20131342.", "citeRegEx": "Pellet.,? 2008", "shortCiteRegEx": "Pellet.", "year": 2008}, {"title": "Design of Observational Studies", "author": ["P.R. Rosenbaum."], "venue": "Springer.", "citeRegEx": "Rosenbaum.,? 2010", "shortCiteRegEx": "Rosenbaum.", "year": 2010}, {"title": "Experimental and Quasi-Experimental Designs for Generalized Causal Inference (2nd", "author": ["W.R. Shadish", "T.D. Thomas", "D.T. Campbell."], "venue": "ed.). Houghton Mifflin, Boston.", "citeRegEx": "Shadish et al\\.,? 2002", "shortCiteRegEx": "Shadish et al\\.", "year": 2002}, {"title": "Scalable techniques for mining causal structures", "author": ["Silverstein", "S. Brin", "R. Motwani", "J. Ullman."], "venue": "Data Mining and Knowledge Discovery 4 (2000), 163\u2013192.", "citeRegEx": "Silverstein et al\\.,? 2000", "shortCiteRegEx": "Silverstein et al\\.", "year": 2000}, {"title": "Observational Studies: Cohort and Case-Control Studies", "author": ["J.W. Song", "K.C. Chung."], "venue": "Plastic & Reconstructive Surgery 126, 6 (December 2010), 2234\u20132242.", "citeRegEx": "Song and Chung.,? 2010", "shortCiteRegEx": "Song and Chung.", "year": 2010}, {"title": "Introduction to Causal Inference", "author": ["P. Spirtes."], "venue": "Journal of Machine Learning Research 11 (2010), 1643\u2013 1662.", "citeRegEx": "Spirtes.,? 2010", "shortCiteRegEx": "Spirtes.", "year": 2010}, {"title": "Causation, Predication, and Search (2nd", "author": ["P. Spirtes", "C.C. Glymour", "R. Scheines."], "venue": "ed.). The MIT Press.", "citeRegEx": "Spirtes et al\\.,? 2001", "shortCiteRegEx": "Spirtes et al\\.", "year": 2001}, {"title": "Randomized Controlled Trials", "author": ["H.O. Stolberg", "G. Norman", "I. Trop."], "venue": "American Journal of Roentgenology 183, 6 (2004), 1539\u20131544.", "citeRegEx": "Stolberg et al\\.,? 2004", "shortCiteRegEx": "Stolberg et al\\.", "year": 2004}, {"title": "Matching methods for causal inference: a review and a look forward", "author": ["E.A. Stuart."], "venue": "Statist. Sci. 25, 1 (2010), 1\u201321.", "citeRegEx": "Stuart.,? 2010", "shortCiteRegEx": "Stuart.", "year": 2010}, {"title": "Selecting the right objective measure for association analysis", "author": ["P. Tan", "V. Kumar", "J. Srivastava."], "venue": "Information Systems 29, 4 (2004), 293\u2013313.", "citeRegEx": "Tan et al\\.,? 2004", "shortCiteRegEx": "Tan et al\\.", "year": 2004}, {"title": "Layered critical values: a powerful direct-adjustment approach to discovering significant patterns", "author": ["G.I. Webb."], "venue": "Machine Learning 71 (2008), 307\u2013323.", "citeRegEx": "Webb.,? 2008", "shortCiteRegEx": "Webb.", "year": 2008}, {"title": "Discovering significant patterns", "author": ["G.I. Webb."], "venue": "Machine Learning 71 (2009), 1\u201331.", "citeRegEx": "Webb.,? 2009", "shortCiteRegEx": "Webb.", "year": 2009}, {"title": "Mining non-redundant association rules", "author": ["M.J. Zaki."], "venue": "Advances in Knowledge Discovery and Data Mining. Vol. 9. 223\u2013248.", "citeRegEx": "Zaki.,? 2004", "shortCiteRegEx": "Zaki.", "year": 2004}], "referenceMentions": [{"referenceID": 14, "context": "medicine, epidemiology, biology, economics, physics, social science, as a basic and effective tool for explanation, prediction and decision making [Guyon et al. 2010; Kleinberg and Hripcsak 2011].", "startOffset": 147, "endOffset": 195}, {"referenceID": 29, "context": "Randomised controlled trials (RCTs) are recognised as the gold standard for testing the effects of interventions [Shadish et al. 2002; Stolberg et al. 2004].", "startOffset": 113, "endOffset": 156}, {"referenceID": 34, "context": "Randomised controlled trials (RCTs) are recognised as the gold standard for testing the effects of interventions [Shadish et al. 2002; Stolberg et al. 2004].", "startOffset": 113, "endOffset": 156}, {"referenceID": 9, "context": "Under these circumstances, observational studies [Rosenbaum 2010; Concato et al. 2000] are considered as the best alternatives to RCTs, and it has been shown that well-designed observational studies can achieve comparative results as RCTs [Concato et al.", "startOffset": 49, "endOffset": 86}, {"referenceID": 9, "context": "2000] are considered as the best alternatives to RCTs, and it has been shown that well-designed observational studies can achieve comparative results as RCTs [Concato et al. 2000].", "startOffset": 158, "endOffset": 179}, {"referenceID": 12, "context": "There are two main types of observational studies for causal discovery, cohort studies and case-control studies [Song and Chung 2010; Blackmore and Cummings 2004; Euser et al. 2009].", "startOffset": 112, "endOffset": 181}, {"referenceID": 0, "context": "In the last two decades, huge efforts have been made on association rule mining [Agrawal et al. 1993] and many efficient algorithms have been developed to discover association rules from large data sets [Han and Kamber 2005].", "startOffset": 80, "endOffset": 101}, {"referenceID": 9, "context": "Observational studies [Rosenbaum 2010; Concato et al. 2000] have had a very long history, and there has been a great deal of research on observational studies, by both statisticians and practitioners in medicine and other application areas.", "startOffset": 22, "endOffset": 59}, {"referenceID": 33, "context": "Under certain causal assumptions, a directed edge between two nodes (variables) in a Bayesian network represents a causal relationship between the two variables [Spirtes 2010; Spirtes et al. 2001].", "startOffset": 161, "endOffset": 196}, {"referenceID": 7, "context": "It has been shown that in general learning a Bayesian network is NP-hard [Chickering et al. 2004].", "startOffset": 73, "endOffset": 97}, {"referenceID": 30, "context": "Several such algorithms have shown promising results [Cooper 1997; Silverstein et al. 2000; Mani et al. 2006; Pellet 2008; Aliferis et al. 2010].", "startOffset": 53, "endOffset": 144}, {"referenceID": 23, "context": "Several such algorithms have shown promising results [Cooper 1997; Silverstein et al. 2000; Mani et al. 2006; Pellet 2008; Aliferis et al. 2010].", "startOffset": 53, "endOffset": 144}, {"referenceID": 2, "context": "Several such algorithms have shown promising results [Cooper 1997; Silverstein et al. 2000; Mani et al. 2006; Pellet 2008; Aliferis et al. 2010].", "startOffset": 53, "endOffset": 144}, {"referenceID": 30, "context": "CCC [Cooper 1997], CCU [Silverstein et al. 2000] and the Y structures [Mani et al.", "startOffset": 23, "endOffset": 48}, {"referenceID": 23, "context": "2000] and the Y structures [Mani et al. 2006], and they do not identify causal relationships that cannot be represented with these structures.", "startOffset": 27, "endOffset": 45}, {"referenceID": 2, "context": "The complexity of other methods for learning a partial Bayesian network in general is still exponential to the number of variables, unless accuracy and/or completeness are traded with efficiency [Aliferis et al. 2010].", "startOffset": 195, "endOffset": 217}, {"referenceID": 36, "context": "Association rule mining is a main data mining technique and has many applications in various fields, but a major obstacle of association rule mining is that it produces too many rules and many of them are uninteresting since they represent random associations in a data set [Webb 2008; Webb 2009; Tan et al. 2004; Lenca et al. 2008].", "startOffset": 274, "endOffset": 332}, {"referenceID": 19, "context": "Association rule mining is a main data mining technique and has many applications in various fields, but a major obstacle of association rule mining is that it produces too many rules and many of them are uninteresting since they represent random associations in a data set [Webb 2008; Webb 2009; Tan et al. 2004; Lenca et al. 2008].", "startOffset": 274, "endOffset": 332}, {"referenceID": 21, "context": "This paper is an extension of our preliminary work in [Li et al. 2013], with three major developments: (1) A more explicit presentation of the motivation, goal and contribution of the research in the newly written Sections 1 and 2; (2) A new section (Section 3.", "startOffset": 54, "endOffset": 70}, {"referenceID": 13, "context": "Odds ratio is a widely used measure for associations in retrospective studies [Fleiss et al. 2003], and we define the odds ratio of a rule as follows.", "startOffset": 78, "endOffset": 98}, {"referenceID": 22, "context": "These association rules (p\u2192 z and p\u2192 \u00acz) are class association rules [Liu et al. 1998] where the confidence (prob(z|p)) is replaced by the odds ratio.", "startOffset": 69, "endOffset": 86}, {"referenceID": 0, "context": "Traditional association rules are defined by support and confidence [Agrawal et al. 1993].", "startOffset": 68, "endOffset": 89}, {"referenceID": 6, "context": "An association rule in the support and confidence scheme may not show a real association between the LHS and RHS of a rule [Brin et al. 1997].", "startOffset": 123, "endOffset": 141}, {"referenceID": 13, "context": "The confidence interval of \u03c9, [\u03c9\u2212, \u03c9+], is defined as [Fleiss et al. 2003]:", "startOffset": 54, "endOffset": 74}, {"referenceID": 12, "context": "A major type of observational studies is cohort studies, which can be conducted in either of the two ways, prospective and retrospective [Euser et al. 2009; Fleiss et al. 2003].", "startOffset": 137, "endOffset": 176}, {"referenceID": 13, "context": "A major type of observational studies is cohort studies, which can be conducted in either of the two ways, prospective and retrospective [Euser et al. 2009; Fleiss et al. 2003].", "startOffset": 137, "endOffset": 176}, {"referenceID": 13, "context": "Using the above notation, we can have the following definition [Fleiss et al. 2003]:", "startOffset": 63, "endOffset": 83}, {"referenceID": 13, "context": "Let oddsratioDf (p \u2192 z) = \u03c9\u2032 in the fair data set, the confidence interval of the odds ratio for matched pairs is defined as [Fleiss et al. 2003]:", "startOffset": 125, "endOffset": 145}, {"referenceID": 1, "context": "Since there are two anti-monotone properties in addition to the anti-monotone property of support, it is efficient to use a level wise algorithm like Apriori [Agrawal et al. 1996].", "startOffset": 158, "endOffset": 179}, {"referenceID": 1, "context": "This algorithm makes use of branch and bound search similar to Apriori [Agrawal et al. 1996] for association rule mining.", "startOffset": 71, "endOffset": 92}, {"referenceID": 18, "context": "Among real world data sets, Hypothyroid and Sick are two medical data sets and they were originally retrieved from the Thyroid Disease folder of the UCI Machine Learning Repository [Bache and Lichman 2013] and then discretised by using the MLC++ discretisation utility [Kohavi et al. 1996].", "startOffset": 269, "endOffset": 289}, {"referenceID": 30, "context": "01 for the Adult data set in the comparison with the other three methods, CCC [Cooper 1997], CCU [Silverstein et al. 2000] and PC-select [Colombo et al.", "startOffset": 97, "endOffset": 122}, {"referenceID": 8, "context": "2000] and PC-select [Colombo et al. 2014].", "startOffset": 20, "endOffset": 41}, {"referenceID": 1, "context": "From Table II, the number of causal rules is significantly smaller than the numbers of other types of (association) rules, including association rules [Agrawal et al. 1996], non-redundant rules [Zaki 2004], and optimal rules [Li 2006].", "startOffset": 151, "endOffset": 172}, {"referenceID": 30, "context": "To evaluate the performance of CR-CS, we conducted a set of experiments with the first 15 synthetic data sets and 3 real world data sets, Adults, Hypothyroid and Sick, and compared the performance of CR-CS with the constraint based methods, CCC [Cooper 1997], CCU [Silverstein et al. 2000], and PC-select [Colombo et al.", "startOffset": 264, "endOffset": 289}, {"referenceID": 8, "context": "2000], and PC-select [Colombo et al. 2014].", "startOffset": 21, "endOffset": 42}, {"referenceID": 30, "context": "As mentioned in Section 2, CCC [Cooper 1997] and CCU [Silverstein et al. 2000] are two efficient constraint based causal discovery methods.", "startOffset": 53, "endOffset": 78}, {"referenceID": 8, "context": "PC-select [Colombo et al. 2014] is a local causal discovery method that finds all the parents and children of a given node.", "startOffset": 10, "endOffset": 31}, {"referenceID": 33, "context": "It is similar to the well-known PC algorithm [Spirtes et al. 2001] for learning a Bayesian network, except that it only finds the local causal relationships around a given response variable.", "startOffset": 45, "endOffset": 66}, {"referenceID": 8, "context": "CR-CS1 and CR-CS2 were implemented in Java, CCC and CCU were implemented in Matlab, and for PC-select, we used the pcSelect() function of the R package pcalg [Colombo et al. 2014; Kalisch et al. 2012].", "startOffset": 158, "endOffset": 200}, {"referenceID": 16, "context": "CR-CS1 and CR-CS2 were implemented in Java, CCC and CCU were implemented in Matlab, and for PC-select, we used the pcSelect() function of the R package pcalg [Colombo et al. 2014; Kalisch et al. 2012].", "startOffset": 158, "endOffset": 200}], "year": 2015, "abstractText": "Randomised controlled trials (RCTs) are the most effective approach to causal discovery, but in many circumstances it is impossible to conduct RCTs. Therefore observational studies based on passively observed data are widely accepted as an alternative to RCTs. However, in observational studies, prior knowledge is required to generate the hypotheses about the cause-effect relationships to be tested, hence they can only be applied to problems with available domain knowledge and a handful of variables. In practice, many data sets are of high dimensionality, which leaves observational studies out of the opportunities for causal discovery from such a wealth of data sources. In another direction, many efficient data mining methods have been developed to identify associations among variables in large data sets. The problem is, causal relationships imply associations, but the reverse is not always true. However we can see the synergy between the two paradigms here. Specifically, association rule mining can be used to deal with the high-dimensionality problem while observational studies can be utilised to eliminate non-causal associations. In this paper we propose the concept of causal rules (CRs) and develop an algorithm for mining CRs in large data sets. We use the idea of retrospective cohort studies to detect CRs based on the results of association rule mining. Experiments with both synthetic and real world data sets have demonstrated the effectiveness and efficiency of CR mining. In comparison with the commonly used causal discovery methods, the proposed approach in general is faster and has better or competitive performance in finding correct or sensible causes. It is also capable of finding a cause consisting of multiple variables, a feature that other causal discovery methods do not possess.", "creator": "LaTeX with hyperref package"}}}