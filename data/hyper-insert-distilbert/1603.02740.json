{"id": "1603.02740", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "8-Mar-2016", "title": "Pairwise Choice Markov Chains", "abstract": "as datasets while capturing human choices grow efficiently in richness efficiently and small scale, particularly significantly in online modelling domains, there once is an increasing initial need environment for coherent choice preservation models exists that may explain and predict often complex empirical strategy choices that violate traditional standard choice - theoretic modeling assumptions such the as regularity, robust stochastic continuous transitivity, or luce'n s infinite choice uncertainty axiom. culminating in overcoming this work process we introduce implies a pairwise choice of markov chain ( pcmc ) model approximation of completely discrete choice that initially is surprisingly free of all exceeding those assumptions even while possible still nonetheless satisfying the attractive naive foundational axiom form of matrix uniform linear expansion. operation uniform expansion period is readily known to imply virtually luce's choice survival axiom in the familiar context of independent random utility models ( c rums ), but the finished pcmc model is not simply a rum ( let alone suggest an ideal independent rum ). inference for the pcmc model is straight - forward, and hence we thus introduce proving it as marking the first symmetric inferentially tractable model regardless of discrete nash choice known when to satisfy uniform expansion rule without the choice axiom, regularity, assumption or strict stochastic transitivity. it is clearly thus more flexible than even nikita tversky'rigorous s elimination methods by aspects model, it which roughly assumes regularity and is arguably also known for to mostly be partly inferentially theoretically intractable. essentially we show that our model learns often and patiently predicts synthetic non - symmetric transitive data well. our analysis recently also somewhat synthesizes several recent observations connecting all the multinomial spatial logit ( mnl ) model respectively and intrinsic markov chains ; the finalized pcmc model actually retains the original multinomial spatial logit model as a complete special test case.", "histories": [["v1", "Tue, 8 Mar 2016 23:47:03 GMT  (160kb,D)", "http://arxiv.org/abs/1603.02740v1", null], ["v2", "Mon, 13 Jun 2016 06:54:59 GMT  (145kb,D)", "http://arxiv.org/abs/1603.02740v2", null], ["v3", "Tue, 19 Sep 2017 18:38:48 GMT  (178kb,D)", "http://arxiv.org/abs/1603.02740v3", "Advances in Neural Information Processing Systems (NIPS) 29, 2016"]], "reviews": [], "SUBJECTS": "stat.ML cs.AI", "authors": ["stephen ragain", "johan ugander"], "accepted": true, "id": "1603.02740"}, "pdf": {"name": "1603.02740.pdf", "metadata": {"source": "CRF", "title": "Pairwise Choice Markov Chains", "authors": ["Stephen Ragain", "Johan Ugander"], "emails": ["sragain@stanford.edu", "jugander@stanford.edu"], "sections": [{"heading": "1 Introduction", "text": "Early work on probabilistic theories of pairwise choice yielded simple and widely adopted models such as Thurstone\u2019s Case V model [28] and the Bradley-Terry-Luce (BTL) model [8]. Both of these models make strong assumptions, the most obvious being that they both assume strict stochastic transitivity between alternatives: if pxy is the probability of choosing x over y among pairs {x, y} in a universe U , then pab \u2265 0.5 and pbc \u2265 0.5 imply pac \u2265 max(pab, pbc). Strict stochastic transitivity thus implies a total ordering on U , a strong statement about choice preferences.\nThe most storied assumption in choice theory, however, is arguably Luce\u2019s choice axiom [17], popularly known as the independence of irrelevant alternatives (IIA). The axiom consists of two statements: (i) if a, b \u2208 S and pab = 0, then it follows that Pr(a chosen from S) = 0 for all S containing b, and (ii) the probability that a is chosen from U conditioned on the chosen item lying in S \u2286 U is precisely the probability that a is chosen from S [18]. The Bradley-Terry-Luce model for pairwise choice, where pij = \u03b3i/(\u03b3i + \u03b3j) for latent quality parameters \u03b3i \u2265 0, became popular after the introduction of the choice axiom: it satisfies the axiom, while Thurstone\u2019s Case V model does not [1] even though it is transitive.\nar X\niv :1\n60 3.\n02 74\n0v 1\n[ st\nat .M\nL ]\n8 M\nar 2\nGeneralizing discrete choice from pairs to larger sets, the Bradley-Terry-Luce model was soon extended; the pairwise binomial logit in the model was generalized to a multinomial logit [4]. The resulting Multinomal Logit (MNL) model again has quality parameters \u03b3i \u2265 0 for each i \u2208 U , and defines piS , the probability of choosing i from S \u2286 U , as piS \u221d \u03b3i for all i \u2208 S. The MNL model, sometimes also called the Plackett-Luce model, continues to satisfy Luce\u2019s choice axiom.\nLuce and others have noted that the choice axiom and stochastic transitivity are strong assumptions that do not hold for empirical choice data [10, 13, 26, 14, 29]. Meanwhile, the success of the MNL model of discrete choice under the choice axiom can be understood as a shining example of Box\u2019s mantra \u201call models are wrong but some are useful\u201d [6]. A proliferation of discrete choice models striving to escape the confines of the choice axiom have emerged over the years. The most popular of these models have been the Elimination by Aspects [30], mixed MNL [7], and nested MNL models [22]. All of these models, however, exhibit some shortcoming in their rigidity or inferential tractability: Elimination by aspects and mixed MNL both exhibit the property of regularity, defined below, while inference is difficult in all three cases [23, 16].\nWith this proliferation of models came an important categorization, the random utility model (RUM) framework [4, 20]. A model is a RUM if there exist real-valued random variables Xa, for all a \u2208 U , such that Pr(a chosen from S) = Pr(Xa \u2265 Xb,\u2200b \u2208 S), for all S \u2286 U . A model is an independent RUM if there exist Xa that are all independent. RUMs in general assume regularity but do not necessarily assume the choice axiom or assume stochastic transitivity (consider distributions such as those for non-transitive dice [25, 27]). Thurstone\u2019s Case V model and the BTL model are both independent RUMs, the mixed MNL model and the Elimination by Aspects model are both RUMs, while the nested MNL model is not a RUM. A major result by McFadden and Train showed that for any RUM there exists a mixed MNL model that can approximate the choice probabilities of that RUM to within an arbitrary error [23], a strong result about the generality of mixed MNL models.\nWhen considering models circumventing the choice axiom, a weaker property called regularity often holds: for any choice setsA,C whereA \u2286 C, Pr(x chosen from A) \u2265 Pr(x chosen from C). For example, all RUMs exhibit regularity, even if they don\u2019t exhibit the choice axiom. Regularity, though intuitively pleasing, has its drawbacks empirically: it does not describe contexts that features framing effects [13] such as asymmetric dominance. Framing effects and other observations from modern behavior economics motivate us to contribute a new model of discrete choice that escapes historically common assumptions while still furnishing enough structure to be inferentially tractable.\nThe present work. In this work we introduce a simple, inferentially tractable model of discrete choice that we call the Pairwise Choice Markov Chain (PCMC) model. The PCMC model is based on an underlying continuous time Markov chain over a universe U that transitions between alternatives with rates that are determined by pairwise choice probabilities. The model views a selection probability piS as the probability mass on alternative i \u2208 S of the stationary distribution of a continuous time Markov\nchain on the set of alternatives S with transition rates parameterized by a matrix P. We show in this work that the parameter matrix P is interpretable as the matrix of pairwise selection probabilities, and as such the PCMC model can be thought of as defining set-wise selection probabilities strictly in terms of pairwise selection probabilities. One of the strengths of the PCMC model is that this matrix can be parameterized further by arbitrary models of pairwise choice. Indeed, we show that when the matrix P is parameterized as the pairwise selection probabilities of a BTL pairwise model, the PCMC model reduces to an MNL model. We also study a parameterization in terms of the recently introduced Blade-Chest models of intransitive pairwise choices [9]. The Blade-Chest models parameterize arbitrary non-transitive pairwise choice probabilities in terms of \u201cblades\u201d and \u201cchests,\u201d motivated by a sword dueling metaphor. By parameterizing P in terms of the Blade-Chest model parameters, we achieve a reduction from( n 2 ) parameters to 2dn parameters, where d is the dimension of the blade and chest embeddings. The PCMC model can be thought of as building upon the observation underlying the recently introduced Iterative Luce Spectral Ranking (I-LSR) procedure for efficiently finding the maximum likelihood estimate for parameters of MNL models [21]. The analysis of I-LSR is precisely analyzing a PCMC model in the special case where the matrix P has been parameterized by BTL. In that case the stationary distribution of the chain is found to match the stationary conditions of the MNL likelihood function, establishing a deep connection between MNL models and Markov chains. The PCMC model generalizes that connection.\nThe analysis of I-LSR is one of several recent works to realize connections between the MNL model and Markov chains. Other recent connections have been made by the work on RankCentrality [24], which employs a discrete time Markov chain for inference in the place of I-LSR\u2019s continuous time chain. Separate work by Blanchet et al., also based on discrete time Markov chains, contributes a Markov chain-based choice model that is capable of approximating any RUM [3].\nThe PCMC model is not a RUM, and in general does not exhibit stochastic transitivity, regularity, or obey the choice axiom. We find that the PCMC model does, however, obey the lesser known but fundamental axiom of uniform expansion. The axiom of uniform expansion was proposed by Yellott as a weakened version of Luce\u2019s choice axiom that implies the choice axiom within the context of independent RUMs [31]. In this work we define a convenient structural property termed contractibility, for which uniform expansion is a special case, and we show that the PCMC model exhibits contractibility. Of the above mentioned models, Elimination by Aspects is the only other model that is not an independent RUM but obeys uniform expansion. Meanwhile, recall that Elimination by Aspects obeys regularity, which the PCMC model does not: as such, the PCMC model we introduce is uniquely positioned in the literature of axiomatic models of discrete choice, minimally satisfying uniform expansion without the other aforementioned axioms.\nLastly, after presenting the model and its properties, in Section 4 we evaluate our inference performance on several synthetic datasets, under several parameterizations of the pairwise matrix P ."}, {"heading": "2 The PCMC model", "text": "A Pairwise Choice Markov Chain (PCMC) models the selection probability piS , the probability of choosing i from S \u2286 U , as the probability mass on alternative i \u2208 S of the stationary distribution of a continuous time Markov chain (CTMC) on the set of alternatives S. The transition rates of the chain are given as a simple function of a parameter matrix P that is interpretable as a matrix of pairwise selection probabilities.\nFormally, given S \u2286 U we construct rate matrix QS = {qij}i,j\u2208S as follows:\nqij = pji, i 6= j, qii = \u2212 \u2211 j 6=i qij .\nLet \u03c0S be the stationary distribution of the corresponding CTMC on S. We define piS := \u03c0S(i), and also occasionally abuse notation to write \u03c0S(A) = \u2211 x\u2208A \u03c0S(x) when the intention is clear. In a final additional abuse of notation, when |S| = 2 we write pij instead of piS or pi{i,j}. This abuse is motivated in the next section, where we show that the matrix of parameters P are indeed the selection probabilities for pair sets under the PCMC model as defined above.\nWe now show that the PCMC model is well defined.\nClaim 1. The choice probabilities piS are well defined for all i in any subset S \u2286 U of a finite U .\nProof. We will show that there exists a single closed communicating class which implies a unique stationary distribution. A closed communicating class C is a subset of S such that the chain will never leave C once entering it, and each state in C is reachable from every other state in C.\nBecause S is finite, there must be at least one closed communicating class. Suppose the chain had more than one closed communicating class and that i \u2208 S and j \u2208 S were in different closed communicating classes. But pij + pji = 1, so at least one of qji and qij is strictly positive. But then the chain can switch communicating classes through the positive edge, a contradiction.\nNote that the support of \u03c0S is the closed communicating class, but S may have transient states corresponding to alternatives with a selection probability of zero.\nIn the subsections that follow, we show that pairwise choice probabilities under the PCMC model are precisely the entries of the parameter matrix P . We also show and that a PCMC model does not exhibit regularity in general, nor is it a random utility model. We then show that a PCMC model with pairwise probabilities originating from a Bradley-Terry-Luce (BTL) pairwise model is equivalent to a Multinomial Logit (MNL) set-wise model, and that the PCMC model can be used as a wrapper around more flexible models of pairwise choice, such as non-transitive Blade-Chest models."}, {"heading": "2.1 Preservation of pairwise probabilities", "text": "The PCMC model can be generically thought of as being parameterized by a matrix P constrained such that pij + pji = 1 and pij \u2265 0,\u2200i, j, but the following brief analysis motivates our decision to call the parameter pij the pairwise probability of choosing i over j.\nConsider a pair set S = {i, j}. When pij \u2208 (0, 1), then the unique stationary distribution \u03c0S satisfying \u03c0SQS = 0 subject to ||\u03c0S ||1 = 1 will have\n\u03c0S(j)qji = \u03c0S(i)qij ,\n\u03c0S(i) + \u03c0S(j) = 1.\nThese equations yield \u03c0S(i) = pij , \u03c0S(j) = pji. The corner cases where pij = 0 or 1 have the dominating state as absorbing, also yielding agreement with \u03c0.\nWe conclude that the PCMC model is consistent with input pairwise probabilities when asked to output probabilities on sets of size two. For sets of size greater than two, we can think of the PCMC model as parameterizing choice probabilities on a set S entirely in terms of the pairwise probabilities between pairs of alternatives within S."}, {"heading": "2.2 Regularity and the RUM property", "text": "The regularity property, described by Luce as a precursor to the choice axiom, requires that the probability of choosing a \u2208 S does not decrease when removing elements from S. Formally, paS\u2032 \u2265 paS for S\u2032 \u2286 S. We will now show that the PCMC model is not constrained to exhibit regularity, nor is it a random utility model (RUM) in general.\nConsider U = {r, p, s} corresponding to a rock-paper-scissors-like game, in the sense that\nP =  0 1\u2212 \u03b1 \u03b1\u03b1 0 1\u2212 \u03b1 1\u2212 \u03b1 \u03b1 0  for some \u03b1 \u2208 [0, 1], where the rows of P are indexed by r, p, and s respectively. For any pair set we have pij = \u03b1 if i beats j in rock paper scissors. Meanwhile, the choices on the full triplet U gives \u03c0 = ( 13 , 1 3 , 1 3 ), regardless of \u03b1. Thus, regularity does not hold for \u03b1 \u2208 [0, 13 ) or \u03b1 \u2208 ( 2 3 , 1].\nThis example further illustrates why the PCMC model is not a RUM. By setting \u03b1 = 1, there can not exist real-valued random variablesX1,X2,X3 such that Pr(X1 > X2) = 1, Pr(X2 > X3) = 1, and Pr(X3 > X1) > 0.\nBy a theorem describing non-transitive dice [27], it is also clear that many more PCMC models can not be independent RUMs: the Steinhaus-Trybula theorem says that for any real-valued independent random variables X1, X2, X3, it must be the case that mini,j Pr(Xi > Xj) \u2264 23 . As a result, a necessary condition for a rock-paper-scissors instance to be an independent RUM is that \u03b1 \u2208 [ 13 , 2 3 ], agreeing with the condition above for regularity. Deriving necessary and sufficient conditions on P for a PCMC model to be a RUM, analogous to known characterization theorems for RUMs [11] and known sufficient\nconditions for nested MNL models to be RUMs [5], is an interesting open research challenge.\nThe PCMC model\u2019s lack of regularity is a positive trait in the sense that empirical choice phenomena such as framing effects and asymmetric dominance violate regularity [13], and the PCMC model is rare in its ability to model such choices."}, {"heading": "2.3 Multinomial Logit from Bradley-Terry-Luce", "text": "We now observe that the Multinomial Logit Model (MNL), also called the PlackettLuce model, is precisely a PCMC model with a matrix P consisting of pairwise BTL probabilities.\nRecall that the BTL model assumes the existence of \u03b3 : U \u2192 R\u22650 with pxy = \u03b3x/(\u03b3x + \u03b3y),\u2200x, y \u2208 U and that the MNL generalization assumes piS \u221d \u03b3i,\u2200i \u2208 S, \u2200S \u2286 U .\nClaim 2. If the pairwise probabilities P are generated from a BTL model with parameters \u03b3, then for each S \u2286 U , the PCMC probabilities piS are consistent with an MNL model on S with parameters \u03b3.\nProof. Let the PCMC rate matrix QS be constructed from a matrix of pairwise probabilities P generated from a BTL model with parameters \u03b3. We aim to show that \u03c0S =\n\u03b3 ||\u03b3||1 is a stationary distribution of the PCMC chain: \u03c0 T SQS = 0. We have:\n(\u03c0TSQS)i = 1\n||\u03b3||1 \u2211 j 6=i \u03b3jpij \u2212 \u03b3i( \u2211 j 6=i pij)  =\n\u03b3i ||\u03b3||1 \u2211 j 6=i \u03b3j \u03b3i + \u03b3j \u2212 \u2211 j 6=i \u03b3j \u03b3i + \u03b3j  = 0,\u2200i. Thus \u03c0S is always the stationary distribution of the chain, and we know by Claim 1 that it is unique. It follows that piS \u221d \u03b3i for all i \u2208 S, as desired.\nThe observation in this subsection also explains why the recently introduced Iterative Luce Spectral Ranking (I-LSR) procedure succeeds in inferring the parameters of an MNL model from the stationary distribution of an appropriately constructed continuous-time Markov chain. If the choice data being subjected to inference is pairwise, the chain that the I-LSR procedure constructs is precisely a PCMC chain with P parameterized by iteratively inferred BTL pairwise choice probabilities."}, {"heading": "2.4 Parametrization with Blade-Chest", "text": "We now show how a PCMC model can be used to extend the richness of a non-transitive pairwise model, specifically a Blade-Chest model, to choices over sets in a principled way (obeying uniform expansion).\nBlade-Chest models are based on geometric d-dimensional embeddings of alternatives, where each alternative i is parameterized with a blade vector bi \u2208 Rd and a\nchest vector ci \u2208 Rd, in addition to a BTL-like quality parameter \u03b3i \u2208 R\u22650. The Blade-Chest model comes in two variations: the Blade-Chest distance model, where\npij(b, c, \u03b3) = S(||bi \u2212 cj ||22 \u2212 ||bj \u2212 ci||22 + \u03b3i \u2212 \u03b3j),\nwhere S(x) = (1+exp(\u2212x))\u22121 is the sigmoid/logistic function, and the Blade-Chest inner product model, where\npij(b, c, \u03b3) = S(bi \u00b7 cj \u2212 bj \u00b7 ci + \u03b3i \u2212 \u03b3j).\nThe quality parameters \u03b3i serve to connect the models to the BTL model, but do not meaningfully increase their expressiveness, so we disregard them in our use of the Blade-Chest distance model in this work. Thus, these two Blade-Chest models provide useful parameterizations of non-transitive pairwise probability matrices, P (\u0398), with \u0398 = {b, c} consisting of the 2dn parameters of the blade and chest embeddings.\nAnother technique for parametrizing P involves representing pij as a function of features of i and j, i.e. pij = f(Xi, Xj ; \u0398) where Xi gives the salient features of i, and \u0398 represents parameters that, for instance, give weights to these features. We can also formulate such analysis as a factoring P = WTF whereW is a weight matrix and F a feature matrix. We do not explore such parameterizations in this work, but merely highlight the potential to employ latent features of objects, an approach closely related to conjoint analysis [12], in a straight-forward manner."}, {"heading": "3 Properties", "text": "While we have demonstrated already that the PCMC model avoids several restrictive properties that are often inconsistent with empirical choice data, we demonstrate in this section that the PCMC model exhibits deep structure in the form of uniform expansion. Inspired by thought experiments which were posed as early challenges to the choice axiom, we define the property of contractibility to handle notions of similarity between elements. We demonstrate that the PCMC model has contractibility, and gracefully handles these thought experiments."}, {"heading": "3.1 Uniform expansion", "text": "Yellott [31] introduced uniform expansion as a weaker condition than Luce\u2019s choice axiom, but one that implies the choice axiom in the context of any independent random utility model. Consider a choice between n elements in a set S, and another choice from a set containing k identical copies of each of the n elements. The axiom of invariance with uniform expansion states that the probability of choosing each object from the set S are the same as the probability of choosing some copy of each object type from the uniformly expanded set.\nYellott demonstrated that for any independent random utility model, the doubleexponential distribution family is the only family of independent distributions that exhibit uniform expansion, and that Thurstone\u2019s model in particular does not exhibit uniform expansion. We now also give a formal definition.\nDefinition 1. For x, y in S \u2286 U , we say that x and y are copies if for all z \u2208 S\u2212x\u2212y, pxz = pyz\nDefinition 2. Consider X \u2286 U and Sk = {k \u00b7 x}x\u2208X containing k copies of each element of X , where for each xi we denote x1i , . . . , x k i as the copies. We say that a model satisfies uniform expansion if for all X and all k \u2265 1:\npxiX = k\u2211 j=1 pxjiSk ,\nso that the probability of choosing a copy of x from S is the same as the probability of choosing x from X .\nTo build intuition: consider offering a person 100 identical coffees, 100 identical teas, and 100 identical glasses of milk. Uniform expansion contends that the proportional selection probabilities of each type of drink should be the same as if they were offered just one drink of each type.\nWhile the axiom feels natural as a model for discrete choice, it should be regarded with some skepticism in applications that model competitions. For example, in sports matches or races, the winner of the competition can be modeled as the competitor with highest skill on that day; competitions are often modeled using random utility models. If we have a competitor with a skill distribution whose wins come from occasional \u201cgood days\u201d \u2014 their skill distribution has a heavy upper tail \u2014 then uniform expansion should not hold, and is not a desirable axiom. This example relates to recent work on team performance and selection [15], where non-invariance under uniform expansion plays a key role.\nWe now show that the PCMC model exhibits uniform expansion.\nClaim 3. The PCMC model exhibits uniform expansion for all matrices P .\nProof. Let \u03c0X be the stationary distribution corresponding to the PCMC model on X . Then we can index the matrix QS so that it is a k \u00d7 k grid of copies of QX :\nQS =  QX QX . . . QX QX QX . . . QX ... ... ... ...\nQX QX . . . QX  . For \u03c0S similarly indexed with k copies of \u03c0X , i.e.:\n\u03c0TS = [\u03c0 T X \u03c0 T X . . . \u03c0 T X ],\nwe have that \u03c0S is the stationary distribution of QS . Because \u03c0X is the stationary distribution of QX :\n(\u03c0TSQS)i = k\u2211 j=1 \u03c0TXQX = 0.\nIt follows that \u03c0S||\u03c0S || = \u03c0S k gives pxjiS = 1 kpxiX for each xi, for all j. Summing over j gives the desired result for any xi \u2208 X .\nTversky\u2019s Elimination by Aspects model [30] is typically defined for choice sets consisting of distinct elements, but can easily be modified to handle copies of elements. it is clear to see that any reasonable way to handle copies in Tversky\u2019s model would satisfy uniform expansion. Thus the PCMC model is not unique in being a nonindependent RUM that satisfies uniform expansion, although Elimination by Aspects comes with the added structure of regularity."}, {"heading": "3.2 Contractibility", "text": "An important thought experiment due to Debreau [10] concerns a choice between three musical recordings: one of Beethoven\u2019s eighth symphony conducted by A, another of Beethoven\u2019s eighth symphony conducted by B, and one of Debussy quartet conducted by C. We will call these options B1, B2, and D respectively. When compared to D, Debreau argues that B1 and B2 are indistinguishable in the sense that pDB1 = pDB2 . However, an agent can reasonably prefer B1 over B2 in the sense that pB1B2 > 0.5.\nDebreu\u2019s thought experiment appeared in the context of a book review of Luce\u2019s first monograph on the choice axiom, and the thought experiment is intended to show a weakness of the BTL model: pDB1 = pDB2 implies that \u03b3B1 = \u03b3B2 , in turn implying that pB1B2 = 0.5, so the above choice can not be encoded by any model that employs Luce\u2019s axiom. Debreu\u2019s construction is also closely related to the \u201cParis and Rome\u201d thought experiment we dissect in Section 3.3.\nWe introduce a notion of contractable partitions that addresses a generalization of the above thought experiments involving choices between near-copies.\nDefinition 3. A partition A1, . . . , Ak of U is a contractible partition if |Ai| \u2265 1,\u2200i and paiaj = \u03bbij for all ai \u2208 Ai, aj \u2208 Aj for some \u039b = {\u03bbij} for i, j \u2208 {1, . . . , k}.\nWe will now show that when a PCMC model contains a contractible partition, the relative probabilities of selecting from those partitions, \u03c0(Ai), are indifferent to the pairwise probabilities within any partition, and depend only on the inter-partition probabilities \u039b. Thus, our contractable partition definition can be viewed as akin to (but distinct from) nests in nested MNL models [22].\nClaim 4. For a given \u039b, letA1, . . . , Ak on U be a contractible partition for two PCMC models represented by P, P \u2032 with stationary distributions \u03c0, \u03c0\u2032. Then for any Ai:\u2211\nj\u2208Ai pjU = \u2211 j\u2208Ai p\u2032jU , (1)\nor equivalently, \u03c0(Ai) = \u03c0\u2032(Ai).\nProof. SupposeP has contractible partitionA1, . . . , Ak with respect to \u039b. Then \u03c0TQU = 0 gives for x \u2208 A1 WLOG,\n\u03c0(x)  \u2211 y\u2208A1\\x qxy + k\u2211 i=2 \u2211 ai\u2208Ai qxai  = \u2211 y\u2208A1\\x \u03c0(y)qyx + k\u2211 i=2 \u2211 ai\u2208Ai \u03c0(ai)qaix. (2)\nNoting that for ai \u2208 Ai and aj \u2208 Aj , qaiaj = pajai = \u03bbji, and (2) can be rewritten:\n\u03c0(x)  \u2211 y\u2208A1\\x qxy + \u03c0(x) k\u2211 i=2 |Ai|\u03bbi1 = \u2211 y\u2208A1\\x \u03c0(y)qyx + k\u2211 i=2 \u03c0(Ai)\u03bb1i.\nSumming over x \u2208 A1 then gives\n\u2211 x\u2208A1 \u03c0(x)  \u2211 y\u2208A1\\x qxy + \u03c0(A1) k\u2211 i=2 |Ai|\u03bbi1 =\n\u2211 x\u2208A1 \u2211 y\u2208A1\\x \u03c0(y)qyx + |A1| k\u2211 i=2 \u03c0(Ai)\u03bb1i.\nThe leftmost term of each side is equal, so we have\n\u03c0(A1) = |A1| \u2211k i=2 \u03c0(Ai)\u03bb1i\u2211\ni=2 |Ai|\u03bbi1 ,\nwhich makes \u03c0(A1) the solution to global balance equations for a chain on k states (with states representing A1, . . . Ak) with transition rates \u03b3ij = |Aj |\u03bbji. Since the partition contains no empty sets, we can use \u03bbij + \u03bbji = 1 to show that the induced chain has a unique closed communicating class (as in the proof of Claim 1). We conclude that {\u03c0(Ai)} are all fixed if A1, ..., Ak is a contractible partition, regardless of any differences between P and P \u2032 on matrix elements within partitions.\nWe say that a choice model exhibits contractibility if, for any two sets of pairwise choice probabilities P and P \u2032 such that A1, . . . , Ak is a contractible partition with respect to the same \u039b for both P and P \u2032, then equation (1) holds.\nNote that every PCMC model on n elements contains a trivial contractible partition A1 = {x1}, ..., An = {xn}, but it is an interesting open question wether one could parameterize P directly in terms of contractible partitions. Note that the fact that any PCMC model exhibits uniform expansion is a simple corollary of contractibility."}, {"heading": "3.3 Paris and Rome", "text": "In an influential thought experiment posed in an early critique [30] of Luce\u2019s initial work axiomatizing choice theory [19], a subject is offered a choice between a trip to Paris and trip to Rome, or either trip with the addition of a dollar, denoted by Paris* and Rome* respectively. The idea is that the choice between Paris and Paris* should clearly be Paris*, but Paris and Paris* should individually compare to Rome the same. We can represent the thought experiment in the PCMC model via:\nP =  0 0 \u03b1 \u03b1 1 0 \u03b1 \u03b1\n1\u2212 \u03b1 1\u2212 \u03b1 0 0 1\u2212 \u03b1 1\u2212 \u03b1 1 0\n ,\nwhere the columns are indexed by Paris, Paris*, Rome, and Rome* respectively. We consider the contractible partitionA1 = {Paris, Paris*}, A2 = {Rome, Rome*} to obtain:\n\u03c0(A1) = |A1|\u03c0(A2)\u03b1 |A2|(1\u2212 \u03b1) .\nSolving this yields that \u03c0(A1), the probability of choosing some trip to Paris, must be \u03b1.\nThis thought experiment provides a great example of the utility of contractibility: even in the absence of uniform expansion, the notion that any variant on a trip to Paris should compare the same as any variant on a trip to Rome is enough to preserve the probability of choosing Paris over Rome when offered any of the variants of each. This analysis holds regardless of the probabilities with which Paris beats Paris*, Rome beats Rome*, or Paris beats Rome, and clearly generalizes to similar constructions with more variants and for more cities.\nFor \u03b1 = 0.5, the corresponding PCMC choice probabilities are \u03c0 = ( 18 , 3 8 , 1 8 , 3 8 ). These probabilities indeed capture the dominance of Paris* and Rome* over their counterparts, but do not preclude Paris or Rome from selection. However, as \u03b1 \u2198 0, \u03c0 \u2192 (0, 0, 0, 1) and as \u03b1 \u2197 1, \u03c0 \u2192 (0, 1, 0, 0), so complete dominance is captured in the extreme choices of \u03b1.\nThe flexibility here also illustrates the PCMC model\u2019s ability to exhibit an important empirical phenomena known as asymmetric dominance [13]. Employing the PCMC model in prediction problems can therefore faithfully learn and reproduce many difficult to capture empirical phenomena, motivating us to turn to inference."}, {"heading": "4 Inference", "text": "Our goal in formulating this model is ultimately to use past choices from diverse subsets S \u2286 U to predict future choices. In this section we first give the log-likelihood function logL(P ;C) of the PCMC matrix P given choice data C. We then allow for parameterizations of P , P (\u0398), such as the BTL or Blade-Chest parameterizations.\nTo demonstrate the PCMC model\u2019s ability to represent broader data than MNL models, and thus its ability to model choices that do not satisfy the choice axiom\u2019s independence of irrelevant alternatives, we evaluate the ability of our inference scheme to predict choices on synthetic data, where the choice data is generated from several different PCMC models."}, {"heading": "4.1 Maximum Likelihood", "text": "Let CiS denote the number of times in the data that i was chosen out of set S for each S \u2286 U . For each S \u2286 U , i \u2208 S, recall that piS(P ) is the probability that i is selected from set S under \u0398. After dropping all constants, the log-likelihood of P given the data C, derived from the probability mass function of the multinomial distribution, is:\nlogL(P ;C) = \u2211 S\u2286U \u2211 i\u2208S CiS log(piS(P )).\nRecall that for the PCMC model, piS(P ) = \u03c0S , where \u03c0S is the stationary distribution for a PCMC chain with rate matrixQS(P ). That stationary distribution is obtained by solving \u03c0SQS(P ) = 0 subject to the constraint \u2211 i\u2208S \u03c0S(i) = 1. Thus, piS(P ) is an implicit function of those elements pij of P where i, j \u2208 S, but the definition in terms of the stationary distribution means that there is no clean closed form expression for piS(P ), let alone piS(P (\u0398)) when P is parameterized further. The implicit definition also makes it difficult to derive gradients for logL with respect to e.g. pij . As a result, we employ scipy\u2019s implementation of BFGS to maximize logL(P ) or logL(P (\u0398)) for appropriate parameterizations, and leave gradient methods as future work.\nWhen the pairwise probability matrix P is parameterized by the Bradley-Terry model, P (\u03b3) with pij = \u03b3i\u03b3i+\u03b3j , we have shown earlier that our PCMC model is equivalent to MNL, and equivalently the likelihood function reduces to that of MNL. In these cases one can use Iterative Luce Spectral Ranking (I-LSR), a recent efficient algorithm for inferring MNL parameters \u03b3, which has been shown to be much faster than traditional MM or Newton methods for inferring MNL parameters [21]."}, {"heading": "4.2 Results", "text": "We now evaluate our inference procedure\u2019s performance in three synthetic data regimes: (i) choice data generated from a PCMC model with an \u201carbitrary\u201d P (pij \u223c UNIF[0, 1] i.i.d. for i > j, pji = 1\u2212pij), (ii) choice data generated for a simple MNL model with qualities \u03b3i \u223c UNIF[0, 1], and (iii) choice data generated from a PCMC model with a pairwise matrix P parameterized by a two-dimensional Blade-Chest distance model. In order to create a strongly non-transitive instance of the Blade-Chest distance model, we draw the blades bi and chests ci uniformly at i.i.d. points along the two-dimensional unit circle, naturally producing many triadic impasses.\nThe PCMC model\u2019s P matrix has ( n 2 ) parameters in general. When P is parameterized according to BTL we have just n parameters, and when it is parameterized according to a Blade-Chest distance model in d dimensions, we have 2dn parameters.\nWe evaluate each parameterization (arbitrary, MNL, Blade-Chest distance) for each synthetic regime. We employ the Iterative Luce Spectral Ranking (I-LSR) algorithm to learn the model under the BTL parameterization of P , where the PCMC model is equivalent to an MNL model. When the data is generated by MNL, we expect ILSR (learning the BTL parameterization) to outperform inference under the general parameterization. When the data is generated by a non-MNL PCMC model, we expect I-LSR to exhibit restricted performance compared to a general parameterization, since the data is not generated by a model that I-LSR can learn.\nTraining data Ctrain and evaluation data Ceval are generated according to each of the three PCMC models, and then learned for each of the three parameterizations. For each model we draw a stream of triplets S uniformly at random from U . We then infer each model, and examine the evaluation data using the error metric\nError(Ceval) = \u2211 S\u2208Ceval \u2211 i\u2208S (p\u0302iS \u2212 p\u0303iS)2,\nwhere p\u0303iS is the estimation according to the model, and p\u0302iS is the empirical probability in the evaluation data.\nFigure 1 shows our error performance as the data grows, averaged across 20 instances, for each data generating process and each inference parameterization. First each model is trained on an \u201cepisode\u201d of 100 samples, and error is measured on predictions for the next episode of 100 samples. These new samples are then added to the training data, and error is again measured on a new episode of 100 samples, for each inference scheme.\nThe inference is applied to a set U with n = 20 objects, meaning that MNL has 20 parameters, the PCMC model with arbitrary P has ( 20 2 ) = 190 parameters, and the PCMC model with the Blade-Chest distance parameterization uses 2dn = 80 parameters. Although these models seem modest in size, we examine 9 data\u2013model pairs, trained sequentially in 20 episodes, averaged across 20 instances. As a result, the figure represents 3600 trained models. Training a PCMC model with an arbitrary P matrix on n = 20 objects with 190 parameters takes us roughly 10 seconds using python in a single thread.\nWhile I-LSR does an excellent job with the MNL data, we see that the more general inference of an arbitrary PCMC model shows better predictive power in both regimes that do not assume the choice axiom. As a consequence, we expect PCMC to have better predictive power in empirical contexts exhibiting violations of the choice axiom, which are abundant [13]."}, {"heading": "5 Conclusions", "text": "In this work, we introduced a Pairwise Choice Markov Chain (PCMC) model of discrete choice, a novel model for extending pairwise probabilities to larger sets. PCMC uses the stationary distribution of a continuous time Markov chain on the candidate choices to define selection probabilities, where the transition rates come from the pairwise selection probabilities.\nThe PCMC model is well defined for any pairwise probabilities, is not a random utility model for general pairwise probabilities, and maintains maximum flexibility by eschewing the implications of Luce\u2019s choice axiom, transitivity, and regularity. Despite\nthis flexibility, we demonstrate that the PCMC model exhibits desirable structure by fulfilling uniform expansion, a property previously found only in the rigid Multinomial Logit (MNL) model and inferentially intractable Elimination by Aspects model.\nWe also introduced the notion of contractibility, a nuanced property underlying important thought experiments instrumental in moving choice theory beyond the choice axiom, and showed that the PCMC model exhibits contractibility.\nAfter examining how the PCMC model deftly handles these thought experiments, we showed that the PCMC model offers straightforward inference through maximum likelihood estimation that competes well with the I-LSR algorithm on MNL data, yet demonstrates that it can also learn models which lie outside the realm of the choice axiom, where I-LSR fails. Furthermore, we demonstrate that this inference extends intuitively to parameterizations of the pairwise probabilities, allowing us to wrap our inference around modern models designed to capture intransitivity such as the BladeChest distance model.\nGiven the flexibility and tractability of the PCMC model, it opens up many compelling research directions. First, we wonder what conditions on the matrix P guarantee that a PCMC model is a RUM. Next, the efficacy of the PCMC model suggests exploring other effective parameterizations for P , including developing algorithms for inferring contractible partitions. There are also computational questions, such as streamlining the likelihood maximization using gradients of the implicit definitions. Very recently, learning results for nested MNL models have shown favorable query complexity under an oracle model, while also demonstrating good performance from greedy inference heuristics [2], and a comparison of our PCMC model with these approaches to learning nested MNL models should be considered important future work. Lastly, a key next step will be evaluating the performance of the PCMC model when applying our inferences and predictions to empirical choice data.\nAcknowledgements. This work was supported in part by a David Morgenthaler II Faculty Fellowship and a Dantzig\u2013Lieberman Operations Research Fellowship."}], "references": [{"title": "An axiomatic formulation and generalization of successive intervals", "author": ["Ernest Adams", "Samuel Messick"], "venue": "scaling. Psychometrika,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 1958}, {"title": "On the relevance of irrelevant alternatives", "author": ["Austin R. Benson", "Ravi Kumar", "Andrew Tomkins"], "venue": "In Proceedings of WWW,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2016}, {"title": "A markov chain approximation to choice modeling", "author": ["Jose Blanchet", "Guillermo Gallego", "Vineet Goyal"], "venue": "In Proceedings of EC,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2013}, {"title": "Random orderings and stochastic theories of responses", "author": ["Henry David Block", "Jacob Marschak"], "venue": "Contributions to Probability and Statistics,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 1960}, {"title": "On the compatibility of nested logit models with utility maximization", "author": ["Axel B\u00f6rsch-Supan"], "venue": "Journal of Econometrics,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 1990}, {"title": "Science and statistics", "author": ["George EP Box"], "venue": "Journal of the American Statistical Association,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 1976}, {"title": "The effect of fuel economy standards on the us automotive market: an hedonic demand analysis", "author": ["J Hayden Boyd", "Robert E Mellman"], "venue": "Transportation Research Part A: General,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 1980}, {"title": "Rank analysis of incomplete block designs the method of paired comparisons", "author": ["Ralph Allan Bradley", "Milton E Terry"], "venue": null, "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1952}, {"title": "Modeling intransitivity in matchup and comparison data", "author": ["Shou Chen", "Thorsten Joachims"], "venue": "In Proceedings of WSDM,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2016}, {"title": "Review of individual choice behavior: A theoretical analysis", "author": ["Gerard Debreu"], "venue": "The American Economic Review,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 1960}, {"title": "A representation theorem for finite random scale systems", "author": ["Jean-Claude Falmagne"], "venue": "Journal of Mathematical Psychology,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 1978}, {"title": "Thirty years of conjoint analysis: Reflections and prospects", "author": ["Paul E Green", "Abba M Krieger", "Yoram Wind"], "venue": "Interfaces, 31(3", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2001}, {"title": "Adding asymmetrically dominated alternatives: Violations of regularity and the similarity hypothesis", "author": ["Joel Huber", "John W Payne", "Christopher Puto"], "venue": "Journal of Consumer Research,", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 1982}, {"title": "Predicting preference flips in commerce search", "author": ["Samuel Ieong", "Nina Mishra", "Or Sheffet"], "venue": "In ICML,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2012}, {"title": "Team performance with test scores", "author": ["Jon Kleinberg", "Maithra Raghu"], "venue": "In Proceedings of EC,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2015}, {"title": "Error theory for elimination by aspects", "author": ["Rajeev Kohli", "Kamel Jedidi"], "venue": "Operations Research,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2015}, {"title": "Individual Choice Behavior: A Theoretical Analysis", "author": ["R. Duncan Luce"], "venue": "Wiley", "citeRegEx": "17", "shortCiteRegEx": null, "year": 1959}, {"title": "The choice axiom after twenty years", "author": ["R Duncan Luce"], "venue": "Journal of Mathematical Psychology, 15(3):215\u2013233", "citeRegEx": "18", "shortCiteRegEx": null, "year": 1977}, {"title": "Games and Decisions: Introduction and Critical Survey", "author": ["R. Duncan Luce", "Howard Raiffa"], "venue": "Courier Corporation,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 1957}, {"title": "The structure of random utility models", "author": ["Charles F Manski"], "venue": "Theory and Decision,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 1977}, {"title": "Fast and accurate inference of plackett\u2013luce models", "author": ["Lucas Maystre", "Matthias Grossglauser"], "venue": "In Proceedings of NIPS,", "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2015}, {"title": "Econometric models for probabilistic choice among products", "author": ["Daniel McFadden"], "venue": "Journal of Business, pages S13\u2013S29,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 1980}, {"title": "Mixed mnl models for discrete response", "author": ["Daniel McFadden", "Kenneth Train"], "venue": "Journal of Applied Econometrics,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2000}, {"title": "Rank centrality: Ranking from pair-wise comparisons", "author": ["Sahand Negahban", "Sewoong Oh", "Devavrat Shah"], "venue": "arXiv preprint arXiv:1209.1688v4,", "citeRegEx": "24", "shortCiteRegEx": "24", "year": 2015}, {"title": "The paradox of nontransitive dice", "author": ["Richard P Savage"], "venue": "American Mathematical Monthly,", "citeRegEx": "25", "shortCiteRegEx": "25", "year": 1994}, {"title": "Choice in context: Tradeoff contrast and extremeness aversion", "author": ["Itamar Simonson", "Amos Tversky"], "venue": "Journal of Marketing Research,", "citeRegEx": "26", "shortCiteRegEx": "26", "year": 1992}, {"title": "On a paradox in applied probabilities", "author": ["Hugo Steinhaus", "S Trybula"], "venue": "Bull. Acad. Polon. Sci,", "citeRegEx": "27", "shortCiteRegEx": "27", "year": 1959}, {"title": "Thurstone. A law of comparative judgment", "author": ["L Louis"], "venue": "Psychological Review,", "citeRegEx": "28", "shortCiteRegEx": "28", "year": 1927}, {"title": "Not just for consumers context effects are fundamental to decision making", "author": ["Jennifer S Trueblood", "Scott D Brown", "Andrew Heathcote", "Jerome R Busemeyer"], "venue": "Psychological Science,", "citeRegEx": "29", "shortCiteRegEx": "29", "year": 2013}, {"title": "Elimination by aspects: A theory of choice", "author": ["Amos Tversky"], "venue": "Psychological Review,", "citeRegEx": "30", "shortCiteRegEx": "30", "year": 1972}, {"title": "The relationship between luce\u2019s choice axiom, thurstone\u2019s theory of comparative judgment, and the double exponential distribution", "author": ["John I Yellott"], "venue": "Journal of Mathematical Psychology,", "citeRegEx": "31", "shortCiteRegEx": "31", "year": 1977}], "referenceMentions": [{"referenceID": 27, "context": "Early work on probabilistic theories of pairwise choice yielded simple and widely adopted models such as Thurstone\u2019s Case V model [28] and the Bradley-Terry-Luce (BTL) model [8].", "startOffset": 130, "endOffset": 134}, {"referenceID": 7, "context": "Early work on probabilistic theories of pairwise choice yielded simple and widely adopted models such as Thurstone\u2019s Case V model [28] and the Bradley-Terry-Luce (BTL) model [8].", "startOffset": 174, "endOffset": 177}, {"referenceID": 16, "context": "The most storied assumption in choice theory, however, is arguably Luce\u2019s choice axiom [17], popularly known as the independence of irrelevant alternatives (IIA).", "startOffset": 87, "endOffset": 91}, {"referenceID": 17, "context": "The axiom consists of two statements: (i) if a, b \u2208 S and pab = 0, then it follows that Pr(a chosen from S) = 0 for all S containing b, and (ii) the probability that a is chosen from U conditioned on the chosen item lying in S \u2286 U is precisely the probability that a is chosen from S [18].", "startOffset": 284, "endOffset": 288}, {"referenceID": 0, "context": "The Bradley-Terry-Luce model for pairwise choice, where pij = \u03b3i/(\u03b3i + \u03b3j) for latent quality parameters \u03b3i \u2265 0, became popular after the introduction of the choice axiom: it satisfies the axiom, while Thurstone\u2019s Case V model does not [1] even though it is transitive.", "startOffset": 236, "endOffset": 239}, {"referenceID": 3, "context": "Generalizing discrete choice from pairs to larger sets, the Bradley-Terry-Luce model was soon extended; the pairwise binomial logit in the model was generalized to a multinomial logit [4].", "startOffset": 184, "endOffset": 187}, {"referenceID": 9, "context": "Luce and others have noted that the choice axiom and stochastic transitivity are strong assumptions that do not hold for empirical choice data [10, 13, 26, 14, 29].", "startOffset": 143, "endOffset": 163}, {"referenceID": 12, "context": "Luce and others have noted that the choice axiom and stochastic transitivity are strong assumptions that do not hold for empirical choice data [10, 13, 26, 14, 29].", "startOffset": 143, "endOffset": 163}, {"referenceID": 25, "context": "Luce and others have noted that the choice axiom and stochastic transitivity are strong assumptions that do not hold for empirical choice data [10, 13, 26, 14, 29].", "startOffset": 143, "endOffset": 163}, {"referenceID": 13, "context": "Luce and others have noted that the choice axiom and stochastic transitivity are strong assumptions that do not hold for empirical choice data [10, 13, 26, 14, 29].", "startOffset": 143, "endOffset": 163}, {"referenceID": 28, "context": "Luce and others have noted that the choice axiom and stochastic transitivity are strong assumptions that do not hold for empirical choice data [10, 13, 26, 14, 29].", "startOffset": 143, "endOffset": 163}, {"referenceID": 5, "context": "Meanwhile, the success of the MNL model of discrete choice under the choice axiom can be understood as a shining example of Box\u2019s mantra \u201call models are wrong but some are useful\u201d [6].", "startOffset": 180, "endOffset": 183}, {"referenceID": 29, "context": "The most popular of these models have been the Elimination by Aspects [30], mixed MNL [7], and nested MNL models [22].", "startOffset": 70, "endOffset": 74}, {"referenceID": 6, "context": "The most popular of these models have been the Elimination by Aspects [30], mixed MNL [7], and nested MNL models [22].", "startOffset": 86, "endOffset": 89}, {"referenceID": 21, "context": "The most popular of these models have been the Elimination by Aspects [30], mixed MNL [7], and nested MNL models [22].", "startOffset": 113, "endOffset": 117}, {"referenceID": 22, "context": "All of these models, however, exhibit some shortcoming in their rigidity or inferential tractability: Elimination by aspects and mixed MNL both exhibit the property of regularity, defined below, while inference is difficult in all three cases [23, 16].", "startOffset": 243, "endOffset": 251}, {"referenceID": 15, "context": "All of these models, however, exhibit some shortcoming in their rigidity or inferential tractability: Elimination by aspects and mixed MNL both exhibit the property of regularity, defined below, while inference is difficult in all three cases [23, 16].", "startOffset": 243, "endOffset": 251}, {"referenceID": 3, "context": "With this proliferation of models came an important categorization, the random utility model (RUM) framework [4, 20].", "startOffset": 109, "endOffset": 116}, {"referenceID": 19, "context": "With this proliferation of models came an important categorization, the random utility model (RUM) framework [4, 20].", "startOffset": 109, "endOffset": 116}, {"referenceID": 24, "context": "RUMs in general assume regularity but do not necessarily assume the choice axiom or assume stochastic transitivity (consider distributions such as those for non-transitive dice [25, 27]).", "startOffset": 177, "endOffset": 185}, {"referenceID": 26, "context": "RUMs in general assume regularity but do not necessarily assume the choice axiom or assume stochastic transitivity (consider distributions such as those for non-transitive dice [25, 27]).", "startOffset": 177, "endOffset": 185}, {"referenceID": 22, "context": "A major result by McFadden and Train showed that for any RUM there exists a mixed MNL model that can approximate the choice probabilities of that RUM to within an arbitrary error [23], a strong result about the generality of mixed MNL models.", "startOffset": 179, "endOffset": 183}, {"referenceID": 12, "context": "Regularity, though intuitively pleasing, has its drawbacks empirically: it does not describe contexts that features framing effects [13] such as asymmetric dominance.", "startOffset": 132, "endOffset": 136}, {"referenceID": 8, "context": "We also study a parameterization in terms of the recently introduced Blade-Chest models of intransitive pairwise choices [9].", "startOffset": 121, "endOffset": 124}, {"referenceID": 20, "context": "The PCMC model can be thought of as building upon the observation underlying the recently introduced Iterative Luce Spectral Ranking (I-LSR) procedure for efficiently finding the maximum likelihood estimate for parameters of MNL models [21].", "startOffset": 236, "endOffset": 240}, {"referenceID": 23, "context": "Other recent connections have been made by the work on RankCentrality [24], which employs a discrete time Markov chain for inference in the place of I-LSR\u2019s continuous time chain.", "startOffset": 70, "endOffset": 74}, {"referenceID": 2, "context": ", also based on discrete time Markov chains, contributes a Markov chain-based choice model that is capable of approximating any RUM [3].", "startOffset": 132, "endOffset": 135}, {"referenceID": 30, "context": "The axiom of uniform expansion was proposed by Yellott as a weakened version of Luce\u2019s choice axiom that implies the choice axiom within the context of independent RUMs [31].", "startOffset": 169, "endOffset": 173}, {"referenceID": 0, "context": "for some \u03b1 \u2208 [0, 1], where the rows of P are indexed by r, p, and s respectively.", "startOffset": 13, "endOffset": 19}, {"referenceID": 26, "context": "By a theorem describing non-transitive dice [27], it is also clear that many more PCMC models can not be independent RUMs: the Steinhaus-Trybula theorem says that for any real-valued independent random variables X1, X2, X3, it must be the case that mini,j Pr(Xi > Xj) \u2264 23 .", "startOffset": 44, "endOffset": 48}, {"referenceID": 12, "context": "As a result, a necessary condition for a rock-paper-scissors instance to be an independent RUM is that \u03b1 \u2208 [ 13 , 2 3 ], agreeing with the condition above for regularity.", "startOffset": 107, "endOffset": 119}, {"referenceID": 1, "context": "As a result, a necessary condition for a rock-paper-scissors instance to be an independent RUM is that \u03b1 \u2208 [ 13 , 2 3 ], agreeing with the condition above for regularity.", "startOffset": 107, "endOffset": 119}, {"referenceID": 2, "context": "As a result, a necessary condition for a rock-paper-scissors instance to be an independent RUM is that \u03b1 \u2208 [ 13 , 2 3 ], agreeing with the condition above for regularity.", "startOffset": 107, "endOffset": 119}, {"referenceID": 10, "context": "Deriving necessary and sufficient conditions on P for a PCMC model to be a RUM, analogous to known characterization theorems for RUMs [11] and known sufficient", "startOffset": 134, "endOffset": 138}, {"referenceID": 4, "context": "conditions for nested MNL models to be RUMs [5], is an interesting open research challenge.", "startOffset": 44, "endOffset": 47}, {"referenceID": 12, "context": "The PCMC model\u2019s lack of regularity is a positive trait in the sense that empirical choice phenomena such as framing effects and asymmetric dominance violate regularity [13], and the PCMC model is rare in its ability to model such choices.", "startOffset": 169, "endOffset": 173}, {"referenceID": 11, "context": "We do not explore such parameterizations in this work, but merely highlight the potential to employ latent features of objects, an approach closely related to conjoint analysis [12], in a straight-forward manner.", "startOffset": 177, "endOffset": 181}, {"referenceID": 30, "context": "Yellott [31] introduced uniform expansion as a weaker condition than Luce\u2019s choice axiom, but one that implies the choice axiom in the context of any independent random utility model.", "startOffset": 8, "endOffset": 12}, {"referenceID": 14, "context": "This example relates to recent work on team performance and selection [15], where non-invariance under uniform expansion plays a key role.", "startOffset": 70, "endOffset": 74}, {"referenceID": 29, "context": "Tversky\u2019s Elimination by Aspects model [30] is typically defined for choice sets consisting of distinct elements, but can easily be modified to handle copies of elements.", "startOffset": 39, "endOffset": 43}, {"referenceID": 9, "context": "An important thought experiment due to Debreau [10] concerns a choice between three musical recordings: one of Beethoven\u2019s eighth symphony conducted by A, another of Beethoven\u2019s eighth symphony conducted by B, and one of Debussy quartet conducted by C.", "startOffset": 47, "endOffset": 51}, {"referenceID": 21, "context": "Thus, our contractable partition definition can be viewed as akin to (but distinct from) nests in nested MNL models [22].", "startOffset": 116, "endOffset": 120}, {"referenceID": 29, "context": "In an influential thought experiment posed in an early critique [30] of Luce\u2019s initial work axiomatizing choice theory [19], a subject is offered a choice between a trip to Paris and trip to Rome, or either trip with the addition of a dollar, denoted by Paris* and Rome* respectively.", "startOffset": 64, "endOffset": 68}, {"referenceID": 18, "context": "In an influential thought experiment posed in an early critique [30] of Luce\u2019s initial work axiomatizing choice theory [19], a subject is offered a choice between a trip to Paris and trip to Rome, or either trip with the addition of a dollar, denoted by Paris* and Rome* respectively.", "startOffset": 119, "endOffset": 123}, {"referenceID": 12, "context": "The flexibility here also illustrates the PCMC model\u2019s ability to exhibit an important empirical phenomena known as asymmetric dominance [13].", "startOffset": 137, "endOffset": 141}, {"referenceID": 20, "context": "In these cases one can use Iterative Luce Spectral Ranking (I-LSR), a recent efficient algorithm for inferring MNL parameters \u03b3, which has been shown to be much faster than traditional MM or Newton methods for inferring MNL parameters [21].", "startOffset": 235, "endOffset": 239}, {"referenceID": 0, "context": "We now evaluate our inference procedure\u2019s performance in three synthetic data regimes: (i) choice data generated from a PCMC model with an \u201carbitrary\u201d P (pij \u223c UNIF[0, 1] i.", "startOffset": 164, "endOffset": 170}, {"referenceID": 0, "context": "for i > j, pji = 1\u2212pij), (ii) choice data generated for a simple MNL model with qualities \u03b3i \u223c UNIF[0, 1], and (iii) choice data generated from a PCMC model with a pairwise matrix P parameterized by a two-dimensional Blade-Chest distance model.", "startOffset": 99, "endOffset": 105}, {"referenceID": 12, "context": "As a consequence, we expect PCMC to have better predictive power in empirical contexts exhibiting violations of the choice axiom, which are abundant [13].", "startOffset": 149, "endOffset": 153}, {"referenceID": 1, "context": "Very recently, learning results for nested MNL models have shown favorable query complexity under an oracle model, while also demonstrating good performance from greedy inference heuristics [2], and a comparison of our PCMC model with these approaches to learning nested MNL models should be considered important future work.", "startOffset": 190, "endOffset": 193}], "year": 2017, "abstractText": "As datasets capturing human choices grow in richness and scale, particularly in online domains, there is an increasing need for choice models that explain and predict complex empirical choices that violate traditional choice-theoretic assumptions such as regularity, stochastic transitivity, or Luce\u2019s choice axiom. In this work we introduce a Pairwise Choice Markov Chain (PCMC) model of discrete choice that is free of all those assumptions while still satisfying the attractive foundational axiom of uniform expansion. Uniform expansion is known to imply Luce\u2019s choice axiom in the context of independent random utility models (RUMs), but the PCMC model is not a RUM (let alone an independent RUM). Inference for the PCMC model is straight-forward, and we thus introduce it as the first inferentially tractable model of discrete choice known to satisfy uniform expansion without the choice axiom, regularity, or strict stochastic transitivity. It is thus more flexible than even Tversky\u2019s Elimination By Aspects model, which assumes regularity and is also known to be inferentially intractable. We show that our model learns and predicts synthetic non-transitive data well. Our analysis also synthesizes several recent observations connecting the Multinomial Logit (MNL) model and Markov chains; the PCMC model retains the Multinomial Logit model as a special case.", "creator": "LaTeX with hyperref package"}}}