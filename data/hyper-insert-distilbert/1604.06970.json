{"id": "1604.06970", "review": {"conference": "AAAI", "VERSION": "v1", "DATE_OF_SUBMISSION": "24-Apr-2016", "title": "Bayesian Inference of Recursive Sequences of Group Activities from Tracks", "abstract": "we present a probabilistic automated generative selection model presented for workers inferring out a description network of coordinated, consciously recursively distinct structured cooperative group activities at multiple possible levels of robust temporal granularity based on simultaneous observations of successive individuals'trajectories. additionally the model accommodates : ( from 1 )'hierarchically segregated structured unit groups, ( 2 ) activities models that are individually temporally and compositionally recursive, ( > 3 ) grouping component roles assigning different subactivity dynamics to subgroups of participants, \u2033 and ( 4 ) a nonparametric gaussian objective process model of trajectories. we essentially present perhaps an earlier mcmc sampling methodology framework providing for performing local joint inference pathways over uniform recursive activity descriptions and optimal assignment mapping of their trajectories to groups, independently integrating leaving out any continuous objective parameters. then we demonstrate illustrates the model'\u2033 s expressive visual power in analyzing several distinct simulated and complex / real - times world scenarios from on the virat and ucla aerospace aerial foraging event video data comparison sets.", "histories": [["v1", "Sun, 24 Apr 2016 00:55:27 GMT  (668kb,D)", "http://arxiv.org/abs/1604.06970v1", "10 pages, 6 figures, in Proceedings of the 30th AAAI Conference on Artificial Intelligence (AAAI'16), Phoenix, AZ, 2016"]], "COMMENTS": "10 pages, 6 figures, in Proceedings of the 30th AAAI Conference on Artificial Intelligence (AAAI'16), Phoenix, AZ, 2016", "reviews": [], "SUBJECTS": "cs.AI cs.CV", "authors": ["ernesto brau", "colin reimer dawson", "alfredo carrillo", "david sidi", "clayton t morrison"], "accepted": true, "id": "1604.06970"}, "pdf": {"name": "1604.06970.pdf", "metadata": {"source": "CRF", "title": "Bayesian Inference of Recursive Sequences of Group Activities from Tracks", "authors": ["Ernesto Brau", "Colin Dawson", "Alfredo Carrillo", "David Sidi", "Clayton T. Morrison"], "emails": ["brauavil@bc.edu", "cdawson@oberlin.edu", "isaac85@email.arizona.edu", "dsidi@email.arizona.edu", "claytonm@email.arizona.edu"], "sections": [{"heading": "1 Introduction", "text": "Human activity recognition comprises a range of open challenges and is a very active research area (Aggarwal and Ryoo 2011; Vishwakarma and Agrawal 2013; Sukthankar et al. 2014), spanning topics from visual recognition of individual behavior (Poppe 2010), pairwise interactions among individuals participating in different roles in a joint activity (Barbu et al. 2012; Kwak, Han, and Han 2013), coordinated sequences of actions as expressions of planned activity (Geib and Goldman 2009), and multiple groups of individuals interacting across broad time scales. In this paper, we address the last of these, presenting a framework for automatically constructing an interpretation of high-level human activity structure as observed in surveillance video, across multiple, interleaved instances of activities. We assume that lower-level visual processing provides high quality tracks of individuals moving through the scene. Our goal is to construct accurate descriptions of the events in the video at different levels of granularity, based on the tracks alone. We develop a probabilistic generative model that combines multiple features that to our knowledge have not been previously incorporated into a single framework for joint inference. To wit: (1) Activities have composite structure with roles representing semantically distinct aspects of the overall activ-\nCopyright c\u00a9 2016, Association for the Advancement of Artificial Intelligence (www.aaai.org). All rights reserved.\nity structure. (2) Activities are described hierarchically and recursively, entailing multiple levels of granularity both in time and membership. (3) Arbitrarily sized groups of actors participate in activities and fulfill roles. (4) Hierarchical descriptions and temporally changing groupings consist of the best joint explanation of the full set of individual trajectories, as found via posterior probabilistic inference.\nThe rest of the paper is organized as follows. In the next section, we review prior research, with a focus on work modeling group membership, hierarchically structured activities, and the identification of roles. In Section 3 we present our probabilistic generative model. In Section 4 we present an MCMC sampling framework for performing joint inference using the model. In Section 5 we evaluate the model on synthetic and real-world data from the VIRAT (Oh et al. 2011) and UCLA Aerial Event (Shu et al. 2015) video data sets, demonstrating the model\u2019s expressive power and effectiveness. We conclude with a discussion of future work."}, {"heading": "2 Related Work", "text": "A number of researchers have proposed models that distinguish the different roles that individuals play in a coordinated activity (Ryoo and Aggarwal 2011; Barbu et al. 2012; Lan, Sigal, and Mori 2012; Kwak, Han, and Han 2013). These models capture the semantics of activities with component structure. It can be difficult to scale role identification in scenes with an arbitrary number of individuals, in particular while properly handling identification of non-participants (Kwak, Han, and Han 2013). A consequence of our joint inference over role assignments and groups is that our model naturally distinguishes and separates participants of different activities playing different roles.\nConsiderable work has been devoted to developing more expressive models in which activities are decomposed into hierarchical levels of description, across different spatial and temporal granularities. Some prior models account for a specific number of hierarchical levels of description, with up to 3 levels being a popular choice (Choi and Savarese 2012; Lan et al. 2010; Chang, Krahnstoever, and Ge 2011; Cheng et al. 2014). Other models permit a potentially greater number of levels of activity description, but the activity hierarchy is fixed prior to inference (Kwak, Han, and Han 2013; Garate et al. 2014; Zaidenberg, Boulay, and Bremond 2012). In only a few cases, including our model, are the levels of ac-\nar X\niv :1\n60 4.\n06 97\n0v 1\n[ cs\n.A I]\n2 4\nA pr\n2 01\n6\ntivity description assessed during inference (Lin et al. 2010; Ryoo and Aggarwal 2011).\nA third branch of work has been devoted to modeling activities not just among individuals, but involving groups of actors. In some models, activities include groups, but interactions are still considered between individuals within groups (Choi and Savarese 2012; Lan et al. 2010; Zhang et al. 2013; Odashima et al. 2012; Zhu et al. 2011). Other models allow for activities to be performed between groups themselves (Chang, Krahnstoever, and Ge 2011; Chang et al. 2010). Still others, including our model, take group activity modeling a step further, allowing for arbitrary numbers of participants in groups, provided they satisfy group membership criteria while performing the activity (Lin et al. 2010; Kwak, Han, and Han 2013; Shu et al. 2015; Zhang et al. 2012).\nTwo recent papers, one by Ryoo and Aggarwal (2011) and one by Shu et al. (2015), come closest to accommodating the combination of features in our model. Both have developed methods for simultaneous inference of group structure with roles in hierarchically structured activities. One key difference between the two is that the former, like our model, can flexibly accommodate multiple levels of activity description in the course of inference, while the latter is restricted to two fixed levels of description during inference (one for group\nactivities, and the other for their member roles). A crucial difference with our approach is that we consider the possibility of detecting multiple occurrences of the same type of activity description in a scene, and these descriptions are integrated into a single probabilistic joint model in order to influence inference of the overall activity structure. While activities described in Ryoo and Aggarwal (2011) have hierarchical component structure with roles, their model does not accommodate more than one top level activity (i.e. assault, meet, robbery, etc.) occurring during the course of the video, nor changes in group membership by individuals over such high-level activities."}, {"heading": "3 Model", "text": "We present a probabilistic generative model describing how coordinated activities by groups of individuals give rise to the observed physical trajectories of the actors involved. In Section 3.1 we introduce some terminology. Then, in Section 3.2 we give precise definitions of the representations employed by our model for activities, groups, activity sequences, and spatial trajectories. Next, in Section 3.3, we define the factors in the joint probability distribution that comprise the generative model. Finally, in Section 3.4 we define the specific activities that are used to model the scenes that we use for evaluation in Section 5."}, {"heading": "3.1 Terminology", "text": "Activities are optionally composed of other activities. For example, the canonical MEET activity in our model consists of multiple participating groups, each of which must MOVE-TO the location of the meeting, unless they are already there, and then possibly wait (STAND) until one or more other groups arrive. Engaging in a MOVE-TO activity requires the group to carry out a sequence of WALK and RUN activities. The semantics of a WALK or RUN is, in turn, characterized by the group\u2019s physical trajectory in space.\nA scene is described as an activity tree, which has a recursive structure, much as a syntactic tree describes the recursive phrase structure of a natural language sentence, but with an added temporal component. An example of such a tree is depicted in Figure 1(a). We refer to the more abstract, \u201cnonterminal\u201d activities that are defined in terms of other activities as intentional, and the \u201cleaf\u201d activities that are defined in terms of observable movement as physical.\nParticipants in an intentional activity are divided into subgroups, each of which plays a particular role with respect to the parent activity. Carrying out a particular role entails engaging in a sequence of subactivities, each of which may be physical or intentional. In intentional activities, the group may be decomposed further into smaller subgroups, each with their own role in the subactivity, and so on. The sequence of subactivities performed by participants in a role is constrained (either deterministically or stochastically) according to the dynamics associated with the role. In cases where a role in a parent activity may be realized as a sequence that includes the same activity type as the parent, the structure is recursive, and allows for arbitrary nesting of activities at different time scales. For example, in Figure 1, a group of individuals participating in a MEET activity performs a sub-MEET of their own.\nPhysical activities are associated with group trajectories, which are coupled either via shared membership or when an intentional activity requires their coordination. An individual, j, has an observed trajectory that is generated as a sequence of connected sub-trajectories, one for each physical activity in which j participates, and which is constrained to be near the respective group trajectory. An example of an observed set of individual trajectories is shown in Figure 1(c).\nAn important feature of our model is that group trajectories are not explicitly represented during inference. The assertion that there is some group trajectory induces correlations among the individual trajectories of the members, but we average over all possible group trajectories (marginalizing them out) when computing the posterior probability of a description. This allows activity descriptions with different numbers of groups to be compared based on the posterior probabilities of their activity trees alone, without needing to deal with probability densities with different numbers of dimensions."}, {"heading": "3.2 Representation", "text": "Activities Formally, an activity is a tuple C = (a, s, e), where a is an activity label (e.g., WALK), and s, e \u2208 R+\nare the start and end time of the activity, respectively. The simplest activities are physical activities, e.g., walking, running and standing, which directly constrain the motion of a group of individuals over an interval of time. For example, a RUN activity is expected to yield trajectories with speeds corresponding to typical human running. We denote the set of physical activity labels by Aphys. Similarly, intentional activities include MEET and MOVE-TO. We denote the set of intentional activity labels by Aint. The complete set of activities is denoted by A = Aphys \u222a Aint. Groups The set of participants in activity C is denoted by ZC \u2282 N. We let JC = |ZC |, the size of the group. This set is partitioned into subgroups, {Z1, . . . ,ZKC}, where the number KC of subgroups is bounded only by the number of individuals, JC , in the group. When specifying the probability model, it is convenient to work instead with the indicator variables, zC = (zC1, . . . , zCJC ), where zCj indicates which of the KC subgroups participant j is affiliated with. Note that zC contains exactly the same information as the partition. In the following description, we omit the subscript C for readability.\nActivity Sequences Each subgroup within activity C performs a sequence of subactivities. For example, a subgroup in a MEET might perform a sequence of two subactivities: first, MOVE-TO a designated meeting location, and then STAND in that location while meeting with other subgroups, who may have also approached that location. Alternatively, one of the subgroups could be involved in a side meeting, with further subgroups that approach and merge with each other before their union merges with another subgroup of the top-level MEET. Figure 1 provides such an example.\nThe sequences of subactivities performed by subgroups are governed by roles. Each subgroup k is assigned a role from a set Ra defined by the parent activity a. Roles govern the dynamics of the sequence of subactivities that each group carries out, via a set of parameters associated with that role. The parameters for role r specify what the allowable activities are in the activity sequence of a group carrying out that role, as well as hard or soft constraints involving what order the activities occur in. The subgroup of the example MEET activity above would be assigned the role of APPROACHER, which prescribes a MOVE-TO followed by a STAND. In this case the constraint on the order of subactivities is deterministic, with the only degrees of freedom being the times at which transitions take place. These constraints can be represented by a Markov chain with a degenerate initial distribution and a transition matrix with only one nonzero off-diagonal entry per column. More general initial and transition distributions will give rise to softer constraints on activity sequences.\nTrajectories Ultimately, each physical activity, realized over the interval [s, e], is associated with a group trajectory, denoted by x, which is a 2 by e \u2212 s + 1 array specifying a 2-dimensional position on the ground plane for each time index between s and e inclusive. The group trajectory represents the central tendency of the members\u2019 individual trajectory segments during the interval [s, e]. Since individ-\nual j\u2019s path depends on the sequence of activities it participates in, each individual trajectory yj consists of segments, y(0)j , . . . ,y (Ij) j , consecutive pairs of which must be connected at transition points, y(1)\u2217j , . . . , y (Ij) \u2217j , where y (i) \u2217j denotes the start of segment i and the end of segment i\u2212 1."}, {"heading": "3.3 Generative Model", "text": "We now describe the generative process for activities. The high-level process has three steps: (1) recursive expansion of intentional activities, (2) generation of group trajectories for the set of physical activities, and (3) generation of individual trajectories conditioned on the group assignments and group trajectories.\nOverview In the first step of activity generation, each intentional activity gives rise to one or more child activity sequences: one for each subgroup of participants involved in the parent activity. Each child sequence is assigned a role, based on the parent activity type. Subgroups and role assignments occur jointly. The choice of role governs the sequence of activities that the subgroup engages in, by specifying a Markov transition function. Each segment of an activity sequence may be a physical activity or another intentional activity. Each intentional activity in the sequence is recursively expanded until only physical activities are generated.\nAs a working example for this stage of the process, we consider the MEET activity at node 1, at the root of the tree in Figure 1(a). Node 1 has two child sequences corresponding to the two subgroups involved in the meeting, both carrying out the APPROACHER role. One of those child sequences consists of just a single MOVE-TO activity, while the other consists of two activities: a MEET, followed by a MOVE-TO. In general, a special top-level root activity, a \u201cfree-for-all\u201d (FFA), comprises all actors and has a duration over the entire video. All other activities are children of the root FFA. (To simplify the example tree in Figure 1(a), we removed the parent FFA.) The details of this tree expansion are given in \u201cGenerating the Activity Tree\u201d, below.\nWe make a conditional independence assumption by supposing that the contents of a parent activity fully specify the distribution of possible child sequences, and that child sequences are conditionally independent of each other given their parent. Since child sequences can contain other intentional activities, activity generation is a recursive process, which bottoms out when no intentional activities are generated.\nIn the second step of the generative process, group trajectories are generated for each physical activity. This process must satisfy two constraints: (a) physical activity trajectories that share members and that border in time must be spatially connected; and (b) groups that need to physically interact as co-participants in an intentional activity, such as a MEET, must have trajectories that intersect at the appropriate points in time. Due to these constraints it is not feasible to generate group trajectories conditionally independently given the activity tree. Instead they are generated jointly according to a global Gaussian Process with a covariance kernel that depends on the activity tree in such a way as to enforce the key\nmk ), k = 1, . . . ,Km.\nconstraints. The details of this process are given in \u201cGenerating Group Trajectories\u201d, below.\nFor the example tree in Figure 1(a), four group trajectory segments are needed, one for each physical activity leaf node. Since WALK activity 9 is part of a meeting in which its participants must meet with the participants in WALK activity 7, the group trajectories for 7 and 9 must end in the same location. Similarly, WALK 4 must end where STAND 5 is located.\nIn the final step of the generative process, the individual trajectories are realized, conditioned on the set of group trajectories. Here, conditional independence is possible, with each individual\u2019s trajectory depending only on the sequence of group trajectories for physical activities in which that individual is a participant. This process is detailed in Section \u201cGenerating Individual Trajectories\u201d.\nGenerating the Activity Tree Let Cm = (am, sm, em) be a parent intentional activity, where m indexes the set of activities. Its participant set Zm (by relabeling, we assume that Zm = {1, . . . , Jm}) is divided into subgroups, where the jth participant of Cm is assigned to group zmj , and the distinct realized groups are numbered 1 through Km. We let zm = (zm1, . . . , zmJm), which defines a partition of Zm into Km subgroups, {Zm1, . . . ,ZmKm}, with Zmk = {j \u2208 Zm | zmj = k}. Subgroup k is assigned role rmk \u2208 R, and we define rm = (rm1, . . . , rmKm).\nThe kth subgroup, which has participants Zmk and role rmk, produces an activity sequence according to the stochastic process associated with rmk, which has parameters \u03c0rmk , a Markov transition function, and Trmk , an initial activity distribution. Denote the resulting sequence by Cmk = (C\n(0) mk, . . . , C (Imk) mk ), where Imk is the number of jumps generated by the process, and the C(i)mk are activity tuples, C\n(i) mk = (a (i) mk, s (i) mk, e (i) mk), where s (i) mk = e (i\u22121) mk . Figure 2 illustrates the graphical model of this production. To summarize, the grouping, role assignment, and child activity sequences within activity Cm are generated according to p(zm, rm,Cm |Cm,Zm), which factors as\np(zm | am,Zm)p(rm | am) Km\u220f k=1 p(Cmk | sm, em), (1)\nwhere we define Cm = (Cm1, . . . ,CmKm). We assume\nthat roles are assigned independently, so that p(rm | am) =\u220fKm k=1 p(rmk | am). Additionally, we model the partition of Zm into subgroups using a Chinese Restaurant Process (CRP), whose concentration parameter \u03b1am depends on the activity label. That is, we let p(zm | am,Zm) be the CRP mass function with parameter \u03b1am . Each segment C\n(i) mk of Cmk that is an intentional activity is expanded and its members are subdivided recursively according to (1), replacing Cm with C (i) mk and Zm with Zmk. Once all expansions contain exclusively physical activities, the recursion has bottomed out. The resulting tree consists of all intentional activities C1, . . . , CM , all physical activities, CM+1, . . . , CM+N , and, for each intentional activity m = 1, . . . ,M , its membership partition zm, role assignments rm, and subgroup activity sequences Cm. We denote this complete tree by \u039b, whose prior distribution is\np(\u039b) = M\u220f m=1 p(zm, rm,Cm |Cm,Zm). (2)\nGenerating Group Trajectories The leaves of the activity tree are all physical activities, each of which is associated with a group trajectory. In general, the endpoints of different group trajectories are not independent (given \u039b), since they may be constrained to start or end at the same location. Consequently, we define a joint distribution on all of the group trajectory endpoints, and, conditioned on their endpoints, we treat their interiors as independent.\nWe model the interiors as realizations of Gaussian processes (Rasmussen and Williams 2006) with the squaredexponential kernel function. This results in trajectories that are generally smooth, but flexible enough to allow for different kinds of motion. We use different scale parameters \u03c3am depending on the activity am, which determines the rate of change of the trajectory.\nWe specify dependencies among the set of trajectory endpoints by first defining an undirected weighted graph G over the endpoints. We use this graph to construct a constraint matrix over transition points by interpreting the sum of the weights on the shortest path between two nodes as distances. We then apply a positive semidefinite isotropic covariance kernel point-wise to the distance matrix to transform the distances into covariances.\nLet xm \u2208 R2(em\u2212sm+1) represent the sequence of ground-plane positions that make up the group trajectory for activity m. Abusing notation slightly, we will write x(s)\u2217m and x (e) \u2217m for both the endpoints of a group trajectory and the corresponding node in G. We introduce three kinds of edges on G: temporal, transitional, and compositional. Two nodes are connected by a temporal edge when they belong to the same physical activity. The start of an activity, x(s)\u2217m, is connected to the end of another activity, x(e)\u2217m\u2032 , by a transitional edge when they correspond to the same moment in time and the corresponding activities share at least one participant. Finally, two endpoints are connected by a compositional edge if they correspond to the same moment in time and have a common ancestor that specifies they must coincide, e.g., in\na MEET activity, all participants must end in the same location. All transitional and compositional edges have weight (or \u201cdistance\u201d) zero, corresponding to the constraint that the connected edges must correspond to the same trajectory position. The weight assigned to temporal edges is a function of the time elapsed during the intervening physical activity and the \u03c3 associated with the activity label (e.g., \u201cslowermoving\u201d activities having lower weights, corresponding to a stronger dependence between the positions of their endpoints). Figure 3 shows an example G.\nHaving defined G we can compute a distance matrix D for the set of physical activity endpoints, where the entry dii\u2032 is the sum of the weights along the shortest path in G from node i to node i\u2032. If no path exists between two nodes, the distance is set to \u221e. We then transform D into a covariance matrix \u03a6 by applying the covariance function \u03c6ii\u2032 = \u03ba(dii\u2032) = \u03bbe\u2212d 2 ii\u2032 . The locations of the set of group trajectory endpoints X\u2217 = (x (s) \u2217M+1, x (e) \u2217M+1, . . . , x (s) \u2217M+N , x (e) \u2217M+N ) is distributed as X\u2217 |\u039b \u223c N (0,\u03a6). Conditioned on the endpoints, the interiors are mutually independent, so that\np(X\u2212\u2217 |X\u2217) = M+N\u220f\nm=M+1\np(x\u2212\u2217m |x(s)\u2217m, x(e)\u2217m), (3)\nwhere x\u2212\u2217m is the vector of interior points of trajectory xm and X\u2212\u2217 = (x\u2212\u2217M+1, . . . ,x\u2212\u2217M+N ). Each x\u2212\u2217m is generated according to the Gaussian process for activity m; i.e., x\u2212\u2217m |x(s)\u2217m, x(e)\u2217m is normally distributed. Finally, the distribution over the physical trajectories X = (xM+1, . . . ,xM+N ) factorizes as\np(X |\u039b) = p(X\u2212\u2217 |X\u2217)p(X\u2217 |\u039b). (4) Using the fact that factors in (4) are normally distributed, we can easily see that X also has a normal distribution.\nGenerating Individual Trajectories As described above, individual j participates in physical activity sequence C(j), which has the sequence of group trajectories Xj = (x\n(1) j , . . . ,x (Ij) j ). The individual trajectory yj consists of\nsegments, y(1)j , . . . ,y (Ij) j , where y (i) j spans the same temporal interval as x(i)j . Given these group trajectories, the individual trajectory segments are mutually independent, so that\np(yj |Xj ,C(j)) = Ij\u220f i=1 p(y (i) j |x (i) j , a (i) (j)), (5)\nwhere a(i)(j) is the label of the ith activity in sequence C(j). We also use a Gaussian process for individual trajectories, but fix the mean to the (given) group trajectory, i.e. y(i)j \u223c GP(x(i)j , \u03ba), which implies that y (i) j \u223c N (x (i) j ,K (i) j ), where the ijth entry in K(i)j is the covariance function \u03ba evaluated at the ith and jth frames of y(i)j , using the scale corresponding to the activity label associated to x(i)j . See Figure 4 for an example graphical model of this distribution."}, {"heading": "3.4 Specific Activities", "text": "In this work, we limit ourselves to six specific activities, three intentional (FREE-FOR-ALL, MEET, and MOVE-TO)\nand three physical (STAND, WALK, and RUN). FFA has a single role which allows all activities to take place. A MEET activity assigns non-zero probability to two roles, APPROACHER and WAITER; an APPROACHER performs a MEETs (recursively) and MOVE-TOs, and a WAITER only performs STANDs. MOVE-TO only produces one role, MOVER, which switches uniformly at random between the three physical activities. Finally, the physical activities have scale parameters such that \u03c3STAND < \u03c3WALK < \u03c3RUN."}, {"heading": "4 Inference", "text": "Given a set of J individual trajectories Y = (y1, . . . ,yJ), such as those depicted in Figure 1(c), we wish to find an activity tree \u039b, such as that depicted in Figure 1(a), that best describes them. Specifically, we wish to maximize the posterior probability of an activity tree given the observed data\np(\u039b |Y) \u221d p(\u039b)p(Y |\u039b), (6) where the prior is given by (2), and the likelihood is\np(Y |\u039b) = \u222b p(X |\u039b) J\u220f j=1 p(yj |Xj ,Cj) dX. (7)\nThe integrands are given by (4) and (5). In general, the integral in (7) cannot be computed analytically. However, since every factor in (7) is a normal pdf, p(Y |\u039b) is also normal, which makes the evaluation of (6) straightforward.\nWe cannot find \u039b\u2217 = arg max\u039b p(\u039b |Y) analytically. Instead, we draw S samples from the posterior (6) using the Metropolis-Hastings (MH) algorithm, and keep the sample with the highest posterior probability. At the ith iteration, we draw \u039b\u2032 from a proposal distribution q(\u00b7 |\u039b(i\u22121)), where \u039b(i\u22121) is the current sample, and accept the sample with the standard MH acceptance probability (Neal 1993).\nThe ability of MH to efficiently explore the space depends largely on the choice of the proposal distribution q. Although there has been work on MCMC sampling on tree models (Chipman, George, and McCulloch 2002; Pratola 2013) there is no general approach which can be applied to any model. Consequently, we employ a proposal distribution which is specific to our model."}, {"heading": "4.1 Proposal distribution", "text": "Our proposal mechanism is composed of sampling moves which perform edits to the current hypothesized activity tree to produce a new tree sample. When drawing a sample from q, we choose a move uniformly at random to apply. When applying a move, we must make sure that the resulting tree is valid (e.g., start and end times must be consistent; or activity sequences must be possible given the role), which requires book-keeping that is beyond the scope of this document.\nWe have also developed a set of bottom-up activity detectors to help explore the space efficiently. These detectors provide rough estimates of groupings of individuals at each frame, and activities being performed by each group (see Section 4.1, \u201cDetectors\u201d). We use these detectors in two ways. First, we initialize the sampler to a state obtained by transforming the output of the detectors to an activity tree\n\u039b(0). Additionally, we bias our proposal distribution toward groups and activities found by the detectors. For example, when proposing a merge move, we might choose participants which are predicted to be in a group by some activity detector.\nSampling moves During inference, we employ the following moves (see Figure 5 for an illustration). (a) Birth/death: a birth move inserts an intentional activity node between an intentional activity and some of its children. We randomly choose a set of sibling activity sequences Cm1, . . . ,CmKm whose parent is intentional activity Cm, and insert a new intentional activity node C \u2032 (whose label is also chosen at random), such that C \u2032 becomes the parent of Cm1, . . . ,CmKm and a child of Cm. In a death move, we randomly choose a intentional node C \u2032, remove it from the tree, and connect its children nodes to its parent. (b) Merge/split: In a merge move, we take two sibling activity nodes with the same label and combine them into a single activity. IfC \u2032 andC \u2032\u2032 are two activities with label a and groups Z \u2032 and Z \u2032\u2032, we create a new node C with label a and participants Z \u2032 \u222aZ \u2032\u2032. The split move performs the opposite operation, taking a-labeled node C and splitting it into two nodes C \u2032 and C \u2032\u2032, both with activity a, assigning participants in Z to either Z \u2032 or Z \u2032\u2032 uniformly. (c) Sequence/unsequence: Let C1 and C2 be two temporally non-overlapping sibling activity sequences. A sequence move concatenates C1 and C2 into a new sequence C. An unsequence move randomly selecting a split point at which to separate a sequence. (d) Relabel move: The relabel move randomly changes C\u2019s label. Note that the label must be valid, e.g., we cannot assign a physical activity label to an intentional activity node.\nDetectors The bottom-up detectors provide an estimate of how individuals in the video are grouped across time, as well as the physical activity they are performing.\nAt each frame, we cluster individuals into groups using their trajectories on the ground plane. We apply the density-based spatial clustering of applications with noise (DBSCAN) (Ester et al. 1996) algorithm independently on each frame, where our feature is composed of the position\nand velocity of an individual at that frame, both of which are obtained from the smoothed trajectories (which are assumed to be given). Importantly, we keep track of individual identities over time by recording the actors involved in each group in the previous frame and assigning the cluster found in the following frame where the majority of individuals in that new set are still involved. Given the groups as computed above, we want to identify the physical activities of their individuals (e.g., WALK, RUN). For this we use a hidden Markov model, where the observation function is a naive Bayes model with each individual\u2019s speed modeled by a Gamma distribution, and a transition function that prefers staying within the current activity."}, {"heading": "5 Experiments and Results", "text": "We evaluate the model in two ways. First, we demonstrate the model\u2019s expressive power in inferring two different types of complexly structured scenarios from synthetic data. In the first, groups of individuals engage in activities and disband, forming different groups over time. The second demonstrates a recursively structured activity, in which one meeting is a component of a higher-level meeting. We then evaluate the model on real data; specifically on two publicly available group activity datasets, VIRAT (Oh et al. 2011) and the UCLA aerial event dataset (Shu et al. 2015)."}, {"heading": "5.1 Evaluation", "text": "Performance is measured in terms of how well activities are labeled in the scene, and how well individuals are grouped, irrespective of activity label. In the following, \u039bgt and \u039b are the ground truth and inferred activity trees, respectively.\nActivity Labeling For each activity a and video frame f , we compare between \u039bgt and \u039b the set of individuals performing a at f . We first define performance counts in terms of an individual at a frame, then compute overall counts and associated performance measures.\nFor an individual j at frame i, let \u03bbji be the set of individuals which have the same label as j in \u039b. Define \u03bb\u2032ji similarly for \u039bgt. The set of false positives for j is \u03bbji \\ \u03bb\u2032ji,\nthe set of false negatives is \u03bb\u2032ji \\ \u03bbji, the true positives are \u03bb\u2032ji \u2229 \u03bbji, and the true negatives are (Z \\ \u03bbji) \u2229 (Z \\ \u03bb\u2032ji), where Z is the set of all individuals. Grouping We follow a similar approach when evaluating grouping performance. For person j, we compare the groups to which j belongs in \u039bgt and \u039b at each frame t. Since the two trees could have different depths and topologies, it is not necessarily clear which groups should be compared with which; however, every individual is part of exactly one physical activity group at each frame, as well as one highest level node. Consequently, we only compare groups at these two levels of the tree, without penalty for difference in activities within a level. Thus once we determine the group associated with person j at frame t at the physical (resp. highest) activity level of each tree, we compute the score as before."}, {"heading": "5.2 Results", "text": "The performance of our algorithm is summarized in Tables 1 and 2. Table 1 shows the activity labeling precision and recall on the two synthetic scenes (SYNTH1 and SYNTH2), a video sequence obtained from the VIRAT dataset, and four different video sequences from the UCLA aerial event dataset (UAED). In Table 2 we see the performance as measured by our grouping evaluation metric described above.\nSynthetic data The synthetic dataset comprises two videos, where a video is a set of trajectories on the ground plane. In the first, SYNTH1, five actors participate in a series of meetings, where participants repeatedly change group memberships across 20 frames. The second (SYNTH2) features five actors meeting, with four of them participating in a side meeting before joining the global meeting. As Table\n1 shows, our model performs very well on high-level activities, such as MEET, even when presented with nested structure.\nVIRAT We also evaluate on real data, specifically frames 2520 to 3960 of video 2 of the VIRAT dataset. This video features seven people participating in two meetings, where groups exchange members several times. Fig. 6 shows two frames of the video, along with the inferred activity tree. Our model correctly recognizes the two meetings, as well as all of the groups at the highest level of description. The activity labeling results (Table 1) show perfect FFA performance, and the grouping results (Table 2) show a perfect highest-level intentional activity score. As before, there is divergence from ground truth at the physical activity level, but this does not affect the grouping score.\nUCLA aerial event dataset We extracted four video sequences from the UCLA aerial event dataset (UAED). More specifically, we searched for subsequences of videos which featured properties like activity nesting, groups interchanging members, etc. The result is four video sequences of roughly 2000 frames each. As we can see in Table 1, which shows the overall precision and recall scores, for all four videos, our algorithm performs reasonably well across all activities. Note the relatively low recall score of the MEET activity, which is due in large part to one very long missed MEET in the third video sequence. Similarly, Table 2 shows\nthat our algorithm performs well at finding groups of individuals at both the physical and intentional activity levels."}, {"heading": "6 Discussion", "text": "We have presented a probabilistic generative model of complex multi-agent activities over arbitrary time scales. The activities specify component roles between groups of actors and accommodate unboundedly deep recursive, hierarchical structure. The model accommodates arbitrary groups participating in activity roles, describing both between-group and between-individual interactions. Physical and intentional (higher-level description) activities explain hierarchical correlations among individual trajectories. To our knowledge, no existing model of track-based activity recognition provides this expressiveness in a joint model.\nThe modeling framework is naturally extensible. We are currently undertaking several extensions, including (1) developing additional activities, including following, exchanging items, and interacting with vehicles and building entrances, (2) adding prior knowledge about the spatial layout of the scene that naturally constrains what activities are possible, such as roads, sidewalks, impassible buildings, and other spatial features that influence behavior in order to improve both accuracy and speed by reducing the search space, (3) using our model as a prior for a 3D Bayesian tracker (Brau et al. 2013), and (4) connecting natural language to activity descriptions as our model accommodates activity descriptions across multiple events, tracking individual participation throughout, providing opportunities for building natural language narratives about activities at different levels of granularity."}, {"heading": "Acknowledgements", "text": "This research was supported by grants under the DARPA Mind\u2019s Eye program W911NF-10-C-0081 (subcontract to iRobot, 92003) and the DARPA SSIM program W911NF10-2-0064. We give special thanks to Paul R. Cohen and Christopher Geyer for helpful discussions and advice."}], "references": [{"title": "M", "author": ["J.K. Aggarwal", "Ryoo"], "venue": "S.", "citeRegEx": "Aggarwal and Ryoo 2011", "shortCiteRegEx": null, "year": 2011}, {"title": "Z", "author": ["A. Barbu", "A. Bridge", "Z. Burchill", "D. Coroian", "S. Dickinson", "S. Fidler", "A. Michaux", "S. Mussman", "N. Siddharth", "D. Salvi", "L. Schmidt", "J. Shangguan", "J.M. Siskind", "J. Waggoner", "S. Wang", "J. Wei", "Y. Yin", "Zhang"], "venue": "2012. Video in sentences out. In UAI", "citeRegEx": "Barbu et al. 2012", "shortCiteRegEx": null, "year": 2012}, {"title": "Bayesian 3d tracking from monocular video", "author": ["Brau"], "venue": null, "citeRegEx": "Brau,? \\Q2013\\E", "shortCiteRegEx": "Brau", "year": 2013}, {"title": "Group level activity recognition in crowded environments across multiple cameras", "author": ["Chang"], "venue": null, "citeRegEx": "Chang,? \\Q2010\\E", "shortCiteRegEx": "Chang", "year": 2010}, {"title": "Probabilistic group-level motion analysis and scenario recognition", "author": ["Krahnstoever Chang", "M.-C. Ge 2011] Chang", "N. Krahnstoever", "W. Ge"], "venue": null, "citeRegEx": "Chang et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Chang et al\\.", "year": 2011}, {"title": "Recognizing human group action by layered model with multiple cues. Neurocomputing 136:124\u2013135", "author": ["Cheng"], "venue": null, "citeRegEx": "Cheng,? \\Q2014\\E", "shortCiteRegEx": "Cheng", "year": 2014}, {"title": "Bayesian treed models. Machine Learning 48(1-3):299\u2013320", "author": ["George Chipman", "H. McCulloch 2002] Chipman", "E. George", "R. McCulloch"], "venue": null, "citeRegEx": "Chipman et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Chipman et al\\.", "year": 2002}, {"title": "and Savarese", "author": ["W. Choi"], "venue": "S.", "citeRegEx": "Choi and Savarese 2012", "shortCiteRegEx": null, "year": 2012}, {"title": "A density-based algorithm for discovering clusters in large spatial databases with noise. 226\u2013231", "author": ["Ester"], "venue": null, "citeRegEx": "Ester,? \\Q1996\\E", "shortCiteRegEx": "Ester", "year": 1996}, {"title": "F", "author": ["C. Garate", "S. Zaidenberg", "J. Badie", "Bremond"], "venue": "2014. Group tracking and behavior recognition in long video surveillance sequences. In VISIGRAPP", "citeRegEx": "Garate et al. 2014", "shortCiteRegEx": null, "year": 2014}, {"title": "R", "author": ["C.W. Geib", "Goldman"], "venue": "P.", "citeRegEx": "Geib and Goldman 2009", "shortCiteRegEx": null, "year": 2009}, {"title": "J", "author": ["S. Kwak", "B. Han", "Han"], "venue": "H.", "citeRegEx": "Kwak. Han. and Han 2013", "shortCiteRegEx": null, "year": 2013}, {"title": "G", "author": ["T. Lan", "Y. Wang", "W. Yang", "Mori"], "venue": "2010. Beyond actions: Discriminative models for contextual group activities. In Advances in neural information processing systems, 1216\u2013", "citeRegEx": "Lan et al. 2010", "shortCiteRegEx": null, "year": 1224}, {"title": "Social roles in hierarchical models for human activity", "author": ["Sigal Lan", "T. Mori 2012] Lan", "L. Sigal", "G. Mori"], "venue": null, "citeRegEx": "Lan et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Lan et al\\.", "year": 2012}, {"title": "Group event detection with a varying number of group members for video surveillance. Circuits and Systems for Video Technology, IEEE Transactions on 20(8):1057\u20131067", "author": ["Lin"], "venue": null, "citeRegEx": "Lin,? \\Q2010\\E", "shortCiteRegEx": "Lin", "year": 2010}, {"title": "R", "author": ["Neal"], "venue": "M.", "citeRegEx": "Neal 1993", "shortCiteRegEx": null, "year": 1993}, {"title": "T", "author": ["S. Odashima", "M. Shimosaka", "T. Kaneko", "R. Fukui", "Sato"], "venue": "2012. Collective activity localization with contextual spatial pyramid. In Computer Vision\u2013ECCV", "citeRegEx": "Odashima et al. 2012", "shortCiteRegEx": null, "year": 2012}, {"title": "J", "author": ["S. Oh", "A. Hoogs", "A. Perera", "N. Cuntoor", "C.-C. Chen", "Lee"], "venue": "T.; Mukherjee, S.; Aggarwal, J.; Lee, H.; Davis, L.; et al.", "citeRegEx": "Oh et al. 2011", "shortCiteRegEx": null, "year": 2011}, {"title": "M", "author": ["Pratola"], "venue": "T.", "citeRegEx": "Pratola 2013", "shortCiteRegEx": null, "year": 2013}, {"title": "C", "author": ["C.E. Rasmussen", "Williams"], "venue": "K. I.", "citeRegEx": "Rasmussen and Williams 2006", "shortCiteRegEx": null, "year": 2006}, {"title": "J", "author": ["M.S. Ryoo", "Aggarwal"], "venue": "K.", "citeRegEx": "Ryoo and Aggarwal 2011", "shortCiteRegEx": null, "year": 2011}, {"title": "Joint inference of groups, events and human roles in aerial videos", "author": ["Shu"], "venue": null, "citeRegEx": "Shu,? \\Q2015\\E", "shortCiteRegEx": "Shu", "year": 2015}, {"title": "H", "author": ["G. Sukthankar", "R.P. Goldman", "C.W. Geib", "D.V. Pynadath", "Bui"], "venue": "H., eds.", "citeRegEx": "Sukthankar et al. 2014", "shortCiteRegEx": null, "year": 2014}, {"title": "and Agrawal", "author": ["S. Vishwakarma"], "venue": "A.", "citeRegEx": "Vishwakarma and Agrawal 2013", "shortCiteRegEx": null, "year": 2013}, {"title": "A generic framework for video understanding applied to group behavior recognition", "author": ["Boulay Zaidenberg", "S. Bremond 2012] Zaidenberg", "B. Boulay", "F. Bremond"], "venue": "In AVSS,", "citeRegEx": "Zaidenberg et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Zaidenberg et al\\.", "year": 2012}, {"title": "Parsing collective behaviors by hierarchical model with varying structure", "author": ["Zhang"], "venue": null, "citeRegEx": "Zhang,? \\Q2012\\E", "shortCiteRegEx": "Zhang", "year": 2012}, {"title": "Beyond particle flow: Bag of trajectory graphs for dense crowd event recognition", "author": ["Zhang"], "venue": null, "citeRegEx": "Zhang,? \\Q2013\\E", "shortCiteRegEx": "Zhang", "year": 2013}, {"title": "T", "author": ["G. Zhu", "S. Yan", "Han"], "venue": "X.; and Xu, C.", "citeRegEx": "Zhu et al. 2011", "shortCiteRegEx": null, "year": 2011}], "referenceMentions": [], "year": 2016, "abstractText": "We present a probabilistic generative model for inferring a description of coordinated, recursively structured group activities at multiple levels of temporal granularity based on observations of individuals\u2019 trajectories. The model accommodates: (1) hierarchically structured groups, (2) activities that are temporally and compositionally recursive, (3) component roles assigning different subactivity dynamics to subgroups of participants, and (4) a nonparametric Gaussian Process model of trajectories. We present an MCMC sampling framework for performing joint inference over recursive activity descriptions and assignment of trajectories to groups, integrating out continuous parameters. We demonstrate the model\u2019s expressive power in several simulated and complex real-world scenarios from the VIRAT and UCLA Aerial Event video data sets.", "creator": "LaTeX with hyperref package"}}}