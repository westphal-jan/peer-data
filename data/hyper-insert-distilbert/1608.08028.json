{"id": "1608.08028", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "29-Aug-2016", "title": "From Deterministic ODEs to Dynamic Structural Causal Models", "abstract": "we show unexpectedly how, under quite certain conditions, the asymptotic behaviour profile of an ordinary vector differential equation under non - reciprocal constant behavior interventions etc can be modelled using dynamic of structural interface causal error models. in contrast to earlier work, notably we study not only the reciprocal effect of interventions mainly on equilibrium equilibrium states ; not rather, we frequently model specific asymptotic boundary behaviour that nevertheless is usually dynamic under interventions actions that radically vary in time, and such include as a special case when the study of static induced equilibria.", "histories": [["v1", "Mon, 29 Aug 2016 12:43:42 GMT  (175kb,D)", "http://arxiv.org/abs/1608.08028v1", null]], "reviews": [], "SUBJECTS": "cs.AI", "authors": ["paul k rubenstein", "stephan bongers", "joris m mooij", "bernhard schoelkopf"], "accepted": false, "id": "1608.08028"}, "pdf": {"name": "1608.08028.pdf", "metadata": {"source": "CRF", "title": "From Deterministic ODEs to Dynamic Structural Causal Models", "authors": ["Paul K. Rubenstein", "Stephan Bongers"], "emails": ["pkr23@cam.ac.uk", "S.R.Bongers@uva.nl", "j.m.mooij@uva.nl", "bs@tue.mpg.de"], "sections": [{"heading": "1 Introduction", "text": "Ordinary Differential Equations (ODEs) provide a universal language to describe deterministic physical systems in the world via equations that determine how variables change in time as a function of other variables. They are causal in the sense that at least in principle they allow us to reason about interventions: any physical intervention in a system \u2014 e.g., moving an object by applying a force \u2014 can be modelled using modified differential equations by, for instance, including suitable forcing terms. In practice, of course, this may be arbitrarily difficult.\nStatistical dependences in the world are generally the outcome of time evolution governed by differential equations. For instance, to produce a dataset of labelled handwritten digits, we might instruct a writer to produce images of digits belonging to specified classes. This instantiates a complex dynamical process involving neural networks in the brain as well as muscles. At the end, we are left with statistical dependences that machine learning methods can exploit. However, the causal structure that was present in the differential equations is lost.\nStructural Causal Models (SCMs, also known as Structural Equation Models) are another language capable of describing causal relations and interventions and have been widely applied in the social \u2217Also affiliated with the Max Planck Institute for Intelligent Systems, T\u00fcbingen\nar X\niv :1\n60 8.\n08 02\n8v 1\n[ cs\n.A I]\nsciences, economics, genetics and neuroscience [1; 2]. One of the successes of SCMs over other causal frameworks has been their ability to express cyclic causal models [3; 4; 5; 6; 7; 8].\nWe view SCMs as an intermediate level of description, which ideally retains the benefits of a data-driven statistical approach while still allowing a limited set of causal statements about the effect of interventions. While we have a good understanding of how an SCM can imply a statistical model, much less is known about how a differential equation model \u2014 our most fundamental level of modelling \u2014 can imply an SCM in the first place. Recent work has begun to address this question by showing how, under strong assumptions, SCMs can be derived from an underlying discrete time difference equation or continuous time ODE [6; 7; 9; 10; 11]. With the exception of [6], each of these methods assume that the dynamical system comes to a static equilibrium, with the derived SCM describing how this equilibrium changes under intervention.\nIf the equilibrium assumption is reasonable for a particular system under study, the SCM framework can be useful. Although the derived SCM then lacks information about the (possibly rich) transient dynamics of the system, if the system equilibrates quickly then the description of the system as an SCM may be a more natural and compact representation of the causal structure of interest. By making assumptions on the dynamical system and the interventions being made, the SCM effectively allows us to reason about a \u2018higher level\u2019 qualitative description of the dynamics \u2014 in this case, the equilibrium states.\nThere are, however, two major limitations that stem from the equilibrium assumption. First, for many dynamical systems the assumption that the system settles to equilibrium, either in its observational state or under intervention, may be unnatural. Second, this framework is only capable of modelling interventions in which a subset of variables are clamped to fixed values (constant interventions). Even for rather simple physical systems such as a forced damped simple harmonic oscillator, these assumptions are violated.\nThe work presented in this paper is a step towards broadening the above by extending it to encompass time-dependent dynamics and interventions. In Section 2, we introduce notation to describe ODEs. In Section 3, we describe how to apply the notion of an intervention on an ODE to the dynamic case. In Section 4, we define regularity conditions on the asymptotic behaviour of an ODE under a set of interventions. In Section 5, we present our main result: subject to conditions on the dynamical system and interventions being modelled, an SCM can be derived that allows one to reason about how the asymptotic dynamics change under interventions on variables in the system. We refer to this as a Dynamic SCM to distinguish from the static equilibrium case for the purpose of exposition, but note that this is conceptually the same as an SCM on a fundamental level. In doing so, we draw inspiration from the approach of [11]."}, {"heading": "2 Ordinary Differential Equations", "text": "Let I = {1, . . . , D} be a set of variable labels. Consider time-indexed variables Xi(t) \u2208 Ri for i \u2208 I, where Ri \u2286 Rdi and t \u2208 R\u22650. For I \u2286 I, we write XI(t) \u2208 \u220f i\u2208I Ri for the tuple of variables (Xi(t))i\u2208I . By an ODE D, we mean a collection of D coupled ordinary differential equations with initial conditions X(k)0 :\nD : { fi(Xi,Xpa(i))(t) = 0, X (k) i (0) = (X (k) 0 )i 0 \u2264 k \u2264 ni \u2212 1, i \u2208 I\nwhere the ith equation determines the evolution of the variable Xi in terms of Xpa(i) and Xi itself, and where ni is the order of the highest derivative X (k) i of Xi that appears in equation i.\nfi is a functional that can include time-derivatives of its arguments. In addition to defining the evolution of Xi in terms of Xpa(i), we can also interpret it as a constraint: fi(Xi,Xpa(i))(t) = 0 \u2200t \u2208 R\u22650 if and only if Xi and Xpa(i) obey the physical laws of D.\nOne possible way to write down an ODE is to canonically decompose it into a collection of first order differential equations, such as is done in [11]. We choose to present our ODEs as \"one equation per variable\" rather than splitting up the equations due to complications that would otherwise occur when considering time-dependent interventions (Sec. 3.3)\nExample 1 ([11]). Consider a one-dimensional system of D particles of mass mi (i = 1, . . . , D) with positions Xi coupled by springs with natural lengths li and spring constants ki, where the ith spring connects the ith and (i+ 1)th masses and the outermost springs have fixed ends (see Figure 1). Assume further that the ith mass undergoes linear damping with coefficient bi.\nDenoting by X\u0307i and X\u0308i the first and second time derivatives of Xi respectively, the equation of motion for the ith variable is given by:\nmiX\u0308i(t) = ki[Xi+1(t)\u2212Xi(t)\u2212 li]\u2212 ki\u22121[Xi(t)\u2212Xi\u22121(t)\u2212 li\u22121]\u2212 biX\u0307i(t)\nwhere we take X0 = 0 and XD = L to be the fixed positions of the end springs. For the case that D = 3, we can write the system of equations as:\nD :  m1X\u03081(t) + b1X\u03071(t) + (k1 + k0)X1(t)\u2212 k1X2(t)\u2212 k0l0 + k1l1 = 0 m2X\u03082(t) + b2X\u03072(t) + (k2 + k1)X2(t)\u2212 k2X3(t)\u2212 k1X1(t)\u2212 k2l1 + k2l2 = 0 m3X\u03083(t) + b3X\u03073(t) + (k3 + k2)X3(t)\u2212 k3L\u2212 k2X2(t)\u2212 k2l2 + k3l3 = 0 X\n(k) i (0) = (X (k) 0 )i k \u2208 {0, 1}, i \u2208 {1, 2, 3}\nWe can represent the dependence structure between variables implied by the functions fi graphically, in which variables are nodes and arrows point Xj \u2212\u2192 Xi if j \u2208 pa(i). Self loops Xi \u2212\u2192 Xi exist if X(k)i appears in the expression of fi for more than one value of k. This is illustrated for the system described in Example 1 in Figure 2a."}, {"heading": "3 Interventions", "text": ""}, {"heading": "3.1 Time-dependent perfect interventions", "text": "Usually in the causality literature, by a perfect intervention it is meant that a variable is clamped to take a specific given value. The natural analogue of this in the time-dependent case is a perfect intervention that forces a variable to take a particular trajectory. That is, given a subset I \u2286 I and a function \u03b6 I : R\u22650 \u2212\u2192 \u220f i\u2208I Ri, we can intervene on the subset of variables XI by forcing XI(t) = \u03b6 I(t) \u2200t \u2208 R\u22650. Using Pearl\u2019s do-calculus notation [1] and for brevity omitting the t, we write do(XI = \u03b6 I) for this intervention. Such interventions are more general objects than those of the equilibrium or time-independent case, but in the specific case that we restrict ourselves to constant trajectories the two notions coincide."}, {"heading": "3.2 Sets of interventions", "text": "The Dynamic SCMs that we will derive will describe the asymptotic dynamics of the ODE and how they change under different interventions. If we want to model \u2018all possible interventions\u2019, then the resulting asymptotic dynamics that can occur are arbitrarily complicated. The idea is to fix a simpler set of interventions and derive an SCM that models only these interventions, resulting in a model that is simpler than the original ODE but still allows us to reason about interventions we are interested in. In the examples in this paper, we restrict ourselves to periodic or quasi-periodic interventions, but the results hold for more general sets of interventions that satisfy the stability definitions presented later.\nWe need to define some notation to express the sets of interventions we will model. Since interventions correspond to forcing variables to take some trajectory, we describe notation for defining sets of trajectories: For I \u2286 I, let DynI be a set of trajectories in \u220f i\u2208I Ri. Let Dyn = \u222aI\u2208P(I)DynI .\nThus, an element \u03b6 I \u2208 DynI is a function R\u22650 \u2212\u2192 \u220f i\u2208I Ri, and Dyn consists of such functions for different I \u2286 I. The following observation is an important point for later on: elements of DynI define trajectories for the whole system, and will be used later on to define the asymptotic dynamics of the system. For technical reasons, we will make use of the following definition later on. This should be interpreted as saying that interventions on each variable can be made independently and combined in any way, and it is thus related to notions that have been discussed in the literature under various headings [1] (e.g., modularity, autonomy, and invariance).\nDefinition 1. A set of trajectories Dyn is modular if, for any {i1, . . . , in} = I \u2286 I,\n\u03b6 I \u2208 Dyn \u21d0\u21d2 \u03b6ik \u2208 Dyn \u2200k \u2208 {1, . . . , n}\nNot all sets of trajectories Dyn are modular; later on we will assume that the sets of trajectories we are considering are for the purposes of constructing the Dynamic SCMs."}, {"heading": "3.3 Describing interventions in ODEs", "text": "We can realise a perfect intervention by replacing the equations of the intervened variables with new equations that fix them to take the specified trajectories:\nDdo(XI=\u03b6I) : { fi(Xi,Xpa(i))(t) = 0, X (k) i (0) = (X (k) 0 )i 0 \u2264 k \u2264 ni \u2212 1, i \u2208 I \\ I\nXi(t)\u2212 \u03b6i(t) = 0 i \u2208 I\nThis procedure is analogous to the notion of intervention in an SCM. Physically, this corresponds to decoupling the intervened variables from their usual causal mechanism by forcing them to take a particular value, while leaving the non-intervened variables\u2019 causal mechanisms unaffected.\nPerfect interventions will not generally be realisable in the real world. In practice, an intervention on a variable would correspond to altering the differential equation governing its evolution by adding extra forcing terms; perfect interventions could be realised by adding forcing terms that push the variable towards its target value at each instant in time, and considering the limit as these forcing terms become infinitely strong so as to dominate the usual causal mechanism determining the evolution of the variable.\nExample 2. Consider the mass-spring system described in Example 1. If we were to intervene on the system to force the mass X1 to undergo simple harmonic motion, we could express this as a change to the system of differential equations as:\nDdo(X1(t)=l1+A cos(\u03c9t)) : X1(t)\u2212 l1 \u2212A cos(\u03c9t) = 0 m2X\u03082(t) + b2X\u03072(t) + (k2 + k1)X2(t)\u2212 k2X3(t)\u2212 k1X1(t)\u2212 k2l1 + k2l2 = 0 m3X\u03083(t) + b3X\u03073(t) + (k3 + k2)X3(t)\u2212 k3L\u2212 k2X2(t)\u2212 k2l2 + k3l3 = 0 X\n(k) i (0) = (X (k) 0 )i k \u2208 {0, 1}, i \u2208 {2, 3}\nThis induces a change to the graphical description of the causal relationships between the variables. We break any incoming arrows to any intervened variables, including self loops, as the intervened variables are no longer causally influenced by any other variables in the system. See Figure 2b for the result of the intervention in Example 2."}, {"heading": "4 Dynamic Stability", "text": "A crucial assumption of [11] was that the systems considered were stable in the sense that they would converge to unique stable equilibria after arbitrary (constant) interventions. This made them amenable to study by considering the t \u2212\u2192 \u221e limit in which any complex but transient dynamical behaviour would have decayed. The SCMs derived would allow one to reason about the asymptotic equilibrium states of the systems after interventions. Since we want to consider non-constant asymptotic dynamics, this is not a notion of stability that is fit for our purposes.\nInstead, we define our stability with reference to a set of trajectories. We will use DynI for this purpose. Recall that elements of DynI are trajectories for all variables in the system. To be totally explicit, we can think of an element \u03b7 \u2208 DynI as a function\n\u03b7 : R\u22650 \u2212\u2192 RI t 7\u2192 (\u03b71(t), \u03b72(t), . . . , \u03b7D(t))\nwhere \u03b7i(t) \u2208 Ri is the state of the ith variable Xi at time t. Note that DynI is not a single fixed set, independent of the situation we are considering. We can choose DynI depending on the ODE D under consideration, and the interventions that we may wish to make on it.\nInformally, stability in this paper means that the asymptotic dynamics of the dynamical system converge to an element of DynI , independent of initial condition. If DynI is in some sense simple, we can simply characterise the asymptotic dynamics of the system under study. In the particular case that DynI consists of constant trajectories, the following definitions of stability can be seen to be closely related to those of [11].\nDefinition 2. The ODE D is dynamically stable with reference to DynI if there exists a unique \u03b7\u2205 \u2208 DynI such that XI(t) = \u03b7\u2205(t) \u2200t is a solution to D and that for all initial conditions X (k) 0 , XI(t) \u2212\u2192 \u03b7\u2205(t) as t \u2212\u2192\u221e.\nWe use a subscript \u2205 to emphasise that \u03b7\u2205 describes the asymptotic dynamics of D without any intervention. Observe that DynI could consist of the single element {\u03b7\u2205} in this case. The requirement that this hold for all initial conditions can be relaxed to hold for almost all initial conditions, but means that the proofs later on require some more technical details. For the purpose of exposition, we stick to this simpler case.\nExample 3. Consider a single mass on a spring that is undergoing simple periodic forcing and is underdamped. Such a system could be expressed as a single (parent-less) variable with ODE description:\nD : { mX\u03081(t) + bX\u03071(t) + k(X1(t)\u2212 l) = F cos(\u03c9t+ \u03c6), X(k)1 (0) = (X (k) 0 ) k \u2208 {0, 1}.\nThe solution to this differential equation is\nX1(t) = r(t) + l +A cos(\u03c9t+ \u03c6 \u2032) (\u2217)\nwhere r(t) decays exponentially quickly (and is dependent on the initial conditions) and A and \u03c6\u2032 depend on the parameters of the initial equation (but not on the initial conditions).\nTherefore such a system would be dynamically stable with reference to (for example)\nDynI = {l +A cos(\u03c9t+ \u03c6 \u2032) : A \u2208 R, \u03c6\u2032 \u2208 [0, 2\u03c0]}.\nWe straightforwardly extend this definition to intervened systems: Definition 3. Let I \u2286 I and let \u03b6 I be a trajectory in \u220f i\u2208I Ri. The intervened ODE Ddo(XI=\u03b6I) is dynamically stable with reference to DynI if there exists a unique \u03b7\u03b6I \u2208 DynI such that XI(t) = \u03b7\u03b6I (t) \u2200t is a solution to Ddo(XI=\u03b6I) and that for all initial conditions, XI(t) \u2212\u2192 \u03b7\u03b6I (t) as t \u2212\u2192\u221e.\nRemark 1. We use a subscript \u03b6 I to emphasise that \u03b7\u03b6I describes the asymptotic dynamics of D after performing the intervention do(XI = \u03b6 I). Observe that DynI could consist only of the single element {\u03b7\u03b6I} and the above definition would be satisfied. But then the original ODE wouldn\u2019t be dynamically stable with reference to DynI , nor would other intervened versions of D. This motivates the following definition, extending dynamic stability to sets of intervened systems.\nDefinition 4. Let Traj be a set of trajectories. We say that the pair (D, Traj) is dynamically stable with reference to DynI if for any \u03b6 I \u2208 Traj, Ddo(XI=\u03b6I) is dynamically stable with reference to DynI , and the non-intervened ODE D is dynamically stable with reference to DynI .\nExample 3 (continued). Suppose we are interested in modelling the effect of changing the forcing term, either in amplitude, phase or frequency. We introduce a second variable X2 to model the forcing term:\nD : { f1(X1, X2)(t) = mX\u03081(t) + bX\u03071(t) + k(X1(t)\u2212 l)\u2212X2(t) = 0 f2(X2)(t) = X2(t)\u2212 F0 cos(\u03c90t+ \u03c60) = 0\nIf we want to change the forcing term that we apply to the mass, we can interpret this as performing an intervention on X2. We could represent this using the notation we have developed as\nDyn2 = {\u03b62(t) = F cos(\u03c9t+ \u03c6) : F, \u03c9 \u2208 R, \u03c6 \u2208 [0, 2\u03c0]}.\nFor any intervention \u03b62 \u2208 Dyn2, the dynamics of X1 in Ddo(X2=\u03b62) will be of the form (\u2217). Therefore (D, Dyn2) will be dynamically stable with reference to\nDynI = {\u03b6 (t) = (l + F cos(\u03c9t+ \u03c6), F \u2032 cos(\u03c9t+ \u03c6\u2032)) : F, F \u2032, \u03c9 \u2208 R, \u03c6, \u03c6\u2032 \u2208 [0, 2\u03c0]}.\nThe independence of initial conditions for Example 3 is illustrated in Figure 3. Note that if (D, Traj) is dynamically stable with reference to DynI , and Dyn\u2032I \u2287 DynI is such that \u2200\u03b6 6= \u03b6 \u2032 \u2208 Dyn\u2032I , \u03b6(t) 9 \u03b6 \u2032(t) as t \u2212\u2192\u221e,1 then (D, Traj) is dynamically stable with reference to Dyn\u2032I ."}, {"heading": "5 Dynamic Structural Causal Models", "text": "A deterministic SCMM is a collection of Structural Equations, the ith of which defines the value of variable Xi in terms of its parents. We extend this to the case that our variables do not take fixed values but rather represent entire trajectories.\nDefinition 5. A deterministic Dynamic Structural Causal Model (DSCM) on the time-indexed variables XI taking value in a modular set of trajectories Dyn is a collection of structural equations\nM : { Xi = Fi(Xpa(i)) i \u2208 I\nwhere pa(i) \u2286 I \\ {i} and each Fi is a map Dynpa(i) \u2212\u2192 Dyni.\nThe point of this paper is to show that, subject to restrictions on D and Dyn, we can derive a DSCM that allows us to reason about the effect on the asymptotic dynamics as a result of making interventions using trajectories in Dyn.\n\u2018Traditional\u2019 deterministic SCMs and DSCMs are identical except for the fact that the variables in an SCM usually take value in a discrete set or a finite dimensional space such as Rn, whilst variables in a DSCM are trajectories in such sets (and as such are infinite dimensional).\nIn an ODE, the equations fi determine the causal relationship between the variable Xi(t) and its parents Xpa(i)(t) at each instant in time. In contrast, we think of the function Fi of the DSCM\n1That is, DynI \u2286 Dyn\u2032I and Dyn \u2032 I still satisfies the uniqueness conditions in the definition of dynamic stability.\nas a causal mechanism that determines the entire trajectory of Xi in terms of the variables Xpa(i), summarising the instantaneous causal effects over all time. In the case that Dyn consists of constant trajectories (and thus the instantaneous causal effects are constant over time), a DSCM reduces to the definition of a normal deterministic SCM.\nThe rest of this section is laid out as follows. In Sec. 5.1 we define what it means to make an intervention in a DSCM. In Sec. 5.2 we show how, subject to certain conditions, a DSCM can be derived from a pair (D, Dyn). The procedure for doing this relies on intervening on all but one variable at a time. In Sec. 5.3, Theorem 2 states that the DSCM thus derived is capable of modelling the effect of intervening on arbitrary subsets of variables, even though it was constructed by considering the case that we consider interventions on exactly D\u2212 1 variables. Theorem 3 in Sec. 5.4 proves that the notions of intervention in ODE and the derived DSCM coincide. Collectively, these theorems tell us that we can derive a DSCM that allows us to reason about the effects of interventions on the asymptotic dynamics of the ODE. Proofs of these theorems are provided in Section A of the Supplementary Materials."}, {"heading": "5.1 Interventions in a DSCM", "text": "Interventions in (D)SCMs are realized by replacing the structural equations of the intervened variables. Given \u03b6 I \u2208 DynI for some I \u2286 I, the intervened DSCMMdo(XI=\u03b6I) can be written:\nMdo(XI=\u03b6I) : { Xi = Fi(Xpa(i)) i \u2208 I \\ I Xi = \u03b6i i \u2208 I\nThe causal mechanisms determining the non-intervened variables are unaffected, so their structural equations remain the same. The intervened variables are decoupled from their usual causal mechanisms and are forced to take the specified trajectory."}, {"heading": "5.2 Deriving DSCMs from ODEs", "text": "We require the following consistency property between the asymptotic dynamics of the ODE and the set of interventions.\nDefinition 6 (Structural dynamic stability). Let Dyn be modular. The pair (D, Dyn) is structurally dynamically stable if (D, DynI\\{i}) is dynamically stable with reference to DynI for all i.\nThis means that for any trajectory \u03b6I\\{i} \u2208 DynI\\{i}, the asymptotic dynamics of the intervened ODE Ddo(XI\\{i}=\u03b6I\\{i}) are expressible uniquely as an element of DynI . Since Dyn is modular, the asymptotic dynamics of the non-intervened variable can be realised as the trajectory \u03b6 i \u2208 Dyni, and thus Dyn is rich enough to allow us to make an intervention which forces the non-intervened variable to take this trajectory. This is a crucial property that allows the construction of the structural equations. In the particular case that Dyn consists of all constant trajectories, structural dynamic stability means that after any intervention on all-but-one-variable, the non-intervened variable settle to a unique equilibrium. In the language of [11], this would imply that the ODE is structurally stable.\nIt should be noted that (D, Dyn) being structurally dynamically stable is a strong assumption in general. If Dyn is too small,2 then it may be possible to find a larger set Dyn\u2032 \u2283 Dyn such that (D, Dyn\u2032) is structurally dynamically stable. The procedure described in this section describes how to derive a DSCM capable of modelling all interventions in Dyn\u2032, which can thus be used to model interventions in Dyn.\n2For example, if Dyn is not modular or represents interventions on only a subset of the variables.\nHenceforth, we use the notation Ii = I \\ {i} for brevity. Suppose that (D, Dyn) is structurally dynamically stable. We can derive structural equations Fi : Dynpa(i) \u2212\u2192 Dyni to describe the asymptotic dynamics of children variables as functions of their parents as follows. Pick i \u2208 I. The variable Xi has parents Xpa(i). Since Dyn is modular, for any configuration of parent dynamics \u03b7pa(i) \u2208 Dynpa(i) there exists \u03b6 Ii \u2208 DynIi such that (\u03b6 Ii)pa(i) = \u03b7pa(i).\nBy structural dynamic stability, the system Ddo(XIi=\u03b6Ii ) has asymptotic dynamics specified by a unique element \u03b7 \u2208 DynI , which in turn defines a unique element \u03b7i \u2208 Dyni specifying the asymptotic dynamics of variable Xi since Dyn is modular.\nTheorem 1. Suppose that (D, Dyn) is structurally dynamically stable. Then the functions\nFi : Dynpa(i) \u2212\u2192 Dyni \u03b7pa(i) \u2212\u2192 \u03b7i\nconstructed as above are well-defined.\nGiven the structurally dynamically stable tuple (D, Dyn) we define the derived DSCM:\nMD : { Xi = Fi(Xpa(i)) i \u2208 I\nwhere the Fi : Dynpa(i) \u2212\u2192 Dyni are defined as above. Note that structural dynamic stability was a crucial property that ensured Fi(Dynpa(i)) \u2286 Dyni. If (D, Dyn) is not structurally dynamically stable, we cannot build structural equations in this way."}, {"heading": "5.3 Solutions of a DSCM", "text": "Theorem 1 states that we can construct a DSCM by the described procedure. We constructed each equation by intervening on D \u2212 1 variables at a time. The result of this section states that the DSCM can be used to correctly model interventions on arbitrary subsets of variables. We say that \u03b7I \u2208 DynI is a solution ofM if \u03b7i = Fi(\u03b7pa(i)) \u2200i \u2208 I.\nTheorem 2. Suppose that (D, Dyn) is structurally dynamically stable. Let I \u2286 I, and let \u03b6 I \u2208 DynI . Then Ddo(XI=\u03b6I) is dynamically stable if and only if the intervened SCMM(Ddo(XI=\u03b6I )) has a unique solution. If there is a unique solution, it coincides with the element of DynI describing the asymptotic dynamics of Ddo(XI=\u03b6I).\nRemark 2. We could also take I = \u2205, in which case the above theorem applies to just D."}, {"heading": "5.4 Causal reasoning is preserved", "text": "We have defined ways to model interventions in both ODEs and DSCMs. The following theorem proves that these notions of intervention coincide, and hence that DSCMs provide a calculus to reason about the asymptotic behaviour of the ODE under interventions in Dyn. A consequence of this is that the diagram in Figure 4 commutes.\nTheorem 3. Suppose that (D, Dyn) is structurally dynamically stable. Let I \u2286 I and let \u03b6 I \u2208 DynI . ThenM(Ddo(XI=\u03b6I )) = (MD)do(XI=\u03b6I).\nTo summarise, Theorems 1 - 3 collectively state that if (D, Dyn) is dynamically structurally stable then it is possible to derive a DSCM that allows us to reason about the asymptotic dynamics of the ODE under any possible intervention in Dyn. A worked example showing how to derive a DSCM for the mass-spring system of Example 1 is included in the Supplementary Material."}, {"heading": "6 Discussion", "text": "The main contribution of this paper is to show that the SCM framework can be applied to reason about time-dependent interventions on an ODE in a dynamic setting. In particular, we showed that if an ODE is sufficiently well-behaved under a set of interventions, a DSCM can be derived that captures how the asymptotic dynamics change under these interventions. This is in contrast to previous approaches to connecting the language of ODEs with the SCM framework, which used SCMs to describe the stable equilibria of the ODE and how they change under intervention.\nThere are two possible directions in which to extend this work. The first is to relax the assumption that the asymptotic dynamics are independent of initial conditions. This rules out, for example, simple models of neural dynamics such as the FitzHugh-Namugo model which exhibits a limit cycle in the observational system [12]. Indeed, if one were to start two systems at two different points along the limit cycle, they would remain forever out of phase, violating independence of initial condition. Intuitively, systems exhibiting limit cycles might still have dynamics that are sufficiently simple to characterise in an SCM-like framework. The second extension is to move away from deterministic systems and consider Stochastic Differential Equations. This framework could be used to take into account model uncertainty, but also to include systems that may be inherently stochastic."}, {"heading": "Acknowledgments", "text": "Stephan Bongers was supported by NWO, the Netherlands Organization for Scientific Research (VIDI grant 639.072.410). This project has received funding from the European Research Council (ERC) under the European Union\u2019s Horizon 2020 research and innovation programme (grant agreement no 639466)."}, {"heading": "A Proofs", "text": "A.1 Proof of Theorem 1 Proof. We need to show that if \u03b6 Ii and \u03b6 \u2032Ii are such that (\u03b6 Ii)pa(i) = (\u03b6 \u2032 Ii )pa(i) = \u03b7pa(i), then \u03b7i = \u03b7\u2032i. To see that this is the case, observe that the system of equations for Ddo(XIi=\u03b6Ii ) is given by:\nDdo(XIi=\u03b6Ii ) :  Xj(t) = \u03b6j(t) j \u2208 I \\ (pa(i) \u222a {i})Xj(t) = \u03b7j(t) j \u2208 pa(i) fi(Xi,Xpa(i))(t) = 0\nThe equations for Ddo(XIi=\u03b6 \u2032Ii ) are similar, except with Xj(t) = \u03b6 \u2032 j(t) for j \u2208 I \\ (pa(i) \u222a {i})\nIn both cases, the equations for all variables except Xi are solved already. The equation for Xi in both cases reduces to the same thing by substituting in the values of the parents, namely\nfi(Xi, \u03b7pa(i))(t) = 0\nThe solution to this equation in Dyni must be unique, else the dynamic stability of the intervened systems Ddo(XIi=\u03b6Ii ) and Ddo(XIi=\u03b6 \u2032Ii ) would not hold, contradicting the dynamic structural stability of (D, Dyn). It follows that \u03b7i = \u03b7\u2032i.\nA.2 Proof of Theorem 2 Proof. By construction of the SCM, \u03b7 \u2208 DynI is a solution ofM(Ddo(XI=\u03b6I )) if and only if: \u2022 For i \u2208 I \\ I, Xi(t) = \u03b7i(t) \u2200t is a solution to the differential equation fi(Xi, \u03b7pa(i))(t) = 0 \u2022 For i \u2208 I, \u03b7i(t) = \u03b6i(t) for all t. which is true if and only if X = \u03b7 is a solution to Ddo(XI=\u03b6I) in DynI . Thus, by definition of dynamic stability, Ddo(XI=\u03b6I) is dynamically stable with asymptotic dynamics describable by \u03b7 \u2208 Dyn if and only if X = \u03b7 uniquely solvesM(Ddo(XI=\u03b6I )).\nA.3 Proof of Theorem 3 Proof. We need to show that the structural equations ofM(Ddo(XI=\u03b6I )) and (MD)do(XI=\u03b6I) are equal. Observe that the equations for Ddo(XI=\u03b6I) are given by:\nDdo(XI=\u03b6I) : { Xi = \u03b6i, i \u2208 I fi(Xi,Xpa(i)) = 0, i \u2208 I \\ I\nTherefore, when we do the procedure to derive the structural equations for Ddo(XI=\u03b6I), we see that: \u2022 if i \u2208 I, the ith structural equation will simply be Xi = \u03b6i since intervening on Ii does not\naffect variable Xi. \u2022 if i \u2208 I \\ I, the ith structural equation will be the same as forMD, since the dependence of Xi\non the other variables is unchanged. i.e. the structural equations forM(Ddo(XI=\u03b6I )) are given by:\nM(Ddo(XI=\u03b6I )) : { Xi = \u03b6i, i \u2208 I Xi = Fi(Xpa(i)), i \u2208 I \\ I\nand thereforeM(Ddo(XI=\u03b6I )) = (MD)do(XI=\u03b6I)"}, {"heading": "B Deriving the DSCM for the mass-spring system", "text": "Consider the mass-spring system of Example 1, but with D \u2265 3 an arbitrary integer.\nWe repeat the setup. We have D masses attached together on springs. The location of the ith mass at time t is Xi(t), and its mass is mi. For notational ease, we denote by X0 = 0 and XD+1 = L the locations of where the ends of the springs attached to the edge masses meet the walls to which they are affixed. X0 and XD+1 are constant. The natural length and spring constant of the spring connecting masses i and i + 1 are li and ki respectively. The ith mass undergoes linear damping with coefficient bi, where bi is small to ensure that the system is underdamped.\nThe equation of motion for the ith mass (1 \u2264 i \u2264 D) is given by:\nmiX\u0308i(t) = ki[Xi+1(t)\u2212Xi(t)\u2212 li]\u2212 ki\u22121[Xi(t)\u2212Xi\u22121(t)\u2212 li\u22121]\u2212 biX\u0307i(t)\nso, defining\nfi(Xi, Xi\u22121, Xi+1)(t) = miX\u0308i(t)\u2212 ki[Xi+1(t)\u2212Xi(t)\u2212 li] + ki\u22121[Xi(t)\u2212Xi\u22121(t)\u2212 li\u22121] + biX\u0307i(t)\nwe can write the system of equations D for our mass-spring system as\nD : { fi(Xi, Xi\u22121, Xi+1)(t) = 0 i \u2208 I\nIn the rest of this section we will explicitly calculate the structural equations for the DSCM derived from D with two different sets of interventions. First, we will derive the structural equations for the case that Dyn consists of all constant trajectories, corresponding to constant interventions that fix variables to constant values for all time. This shows the correspondence between this paper and [11]. Next, we will derive the structural equations for the case that Dyn consists of interventions corresponding to sums of periodic forcing terms.\nB.1 Mass-spring with constant interventions In order to derive the structural equations we only need to consider, for each variable, the influence of its parents on it. (Formally, this is because of Theorem 1)\nConsidering variable i. If we intervene to fix its parents to have locations Xi\u22121(t) = \u03b7i\u22121 and Xi+1(t) = \u03b7i+1 for all t, then the equation of motion for variable i is given by\nmiX\u0308i(t) + biX\u0307i(t) + (ki + ki\u22121)Xi(t) = ki[\u03b7i+1 \u2212 li] + ki\u22121[\u03b7i\u22121 + li\u22121]\nThere may be some complicated transient dynamics that depend on the initial conditions Xi(0) and X\u0307i(0) but provided that bi > 0, we know that the Xi(t) will converge to a constant and therefore the asymptotic solution to this equation can be found by setting X\u0308i and X\u0307i to zero. Note that in general, we could explicitly find the solution to this differential equation (and indeed, in the next example we will) but for now there is a shortcut to deriving the structural equations3\nThe asymptotic solution is therefore:\nXi = ki[\u03b7i+1 \u2212 li] + ki\u22121[\u03b7i\u22121 + li\u22121]\nki + ki\u22121\n3This is analogous to the approach taken in [11] in which they first define the Labelled Equilibrium Equations and from these derive the SCM.\nTherefore the ith structural equation is:\nFi(Xi\u22121, Xi+1) = ki[Xi+1 \u2212 li] + ki\u22121[Xi\u22121 + li\u22121]\nki + ki\u22121\nHence the SCM for (D, Dync) is\nMD : { Xi =\nki[Xi+1\u2212li]+ki\u22121[Xi\u22121+li\u22121] ki+ki\u22121\ni \u2208 I\nAnd we can use this model to reason about the effect of constant interventions on the asymptotic dynamics of the system.\nB.2 Sums of periodic interventions Suppose now we want to be able to make interventions of the form:\ndo (Xi(t) = A cos(\u03c9t+ \u03c6)) (\u2020)\nSuch interventions cannot be described by the DSCM derived in Section B.1. In this section we will explicitly derive a DSCM capable of reasoning about the effects of such interventions. It will also illustrate why we need dynamic structural stability.\nBy Theorem 1, to derive the structural equation for each variable we only need to consider the effect on the child of intervening on the parents according to interventions of the form \u2020.\nConsider the following linear differential equation:\nmX\u0308(t) + bX\u0307(t) + kX(t) = g(t) (1)\nIn general, the solution to this equation will consist of two parts - the homogeneous solution and the particular solution. The homogeneous solution is one of a family of solutions to the equation:\nmX\u0308(t) + bX\u0307(t) + kX(t) = 0 (2)\nand this family of solutions is parametrised by the initial conditions. If there b > 0 then all of the homogeneous solutions decay to zero as t \u2212\u2192\u221e. The particular solution is any solution to the original equation with arbitrary initial conditions. The particular solution captures the asymptotic dynamics due to the forcing term g.\nEquation 1 is a linear differential equation. This means that if X = X1 is a particular solution for g = g1 and X = X2 is a particular solution for g = g2, then X = X1 +X2 is a particular solution for g = g1 + g2.\nIn order to derive the structural equations, the final ingredient we need is an explicit representation for a particular solution to (1) in the case that g(t) = A cos(\u03c9t+ \u03c6). We state the solution for the case that the system is underdamped - this is a \u2018standard result\u2019 and can be verified by checking that the following satisfies 1:\nX(t) = A\u2032 cos(\u03c9t+ \u03c6\u2032)\nwhere\nA\u2032 = A\u221a\n[k \u2212m\u03c92]2 + bm\u03c92 \u03c6\u2032 = \u03c6\u2212 arctan[ b\u03c9 k \u2212m\u03c92 ] (3)\nTherefore if we go back to our original equation of motion for variable Xi:\nmiX\u0308i(t) + biX\u0307i(t) + (ki + ki\u22121)Xi(t) = ki[Xi+1(t)\u2212 li] + ki\u22121[Xi\u22121(t) + li\u22121] Then if we make the intervention\ndo(Xi\u22121(t) = Ai\u22121 cos(\u03c9i\u22121t+ \u03c6i\u22121), Xi+1(t) = Ai+1 cos(\u03c9i+1t+ \u03c6i+1))\nwe see that we can write the RHS of the above equation as the sum of the three terms\ng1(t) = ki\u22121li\u22121 \u2212 kili g2(t) = ki\u22121Ai\u22121 cos(\u03c9i\u22121t+ \u03c6i\u22121)\ng3(t) = kiAi+1 cos(\u03c9i+1t+ \u03c6i+1)\nUsing the fact that linear differential equation have superposable solutions and Equation 3 we can write down the resulting asymptotic dynamics of Xi:\nXi(t) = ki\u22121li\u22121 \u2212 kili ki + ki\u22121\n+ ki\u22121Ai\u22121\u221a\n[ki + ki\u22121 \u2212mi\u03c92i\u22121]2 + bimi\u03c92i\u22121 cos(\u03c9i\u22121t+ \u03c6i\u22121 \u2212 arctan[ bi\u03c9i\u22121 ki + ki\u22121 \u2212mi\u03c92i\u22121 ])\n+ kiAi+1\u221a\n[ki + ki\u22121 \u2212mi\u03c92i+1]2 + bimi\u03c92i+1 cos(\u03c9i+1t+ \u03c6i+1 \u2212 arctan[ bi\u03c9i+1 ki + ki\u22121 \u2212mi\u03c92i+1 ])\nHowever, note that if we were using Dyn consisting of interventions of the form of equation \u2020, then we have just shown that the mass-spring system would not be structurally dynamically stable with respect to this Dyn, since we need two periodic terms and a constant term to describe the motion of a child under legal interventions of the parents.\nThis illustrates the fact that we may sometimes be only interested in a particular set of interventions that may not itself satisfy structural dynamic stability, and that in this case we must consider a larger set of interventions that does.\nIn this case, we can consider the modular set of trajectories generated by trajectories of the following form for each variable:\nX(t) = \u221e\u2211 j=1 Aj cos(\u03c9jt+ \u03c6j)\nwhere \u2211\u221e j=1 |Aj | <\u221e (so that the series is absolutely convergent and thus does not depend on\nthe ordering of the terms in the sum). Call this set Dynqp (quasi-periodic). By equation 3, we can write down the structural equations:\nFi  \u221e\u2211 j=1 Ai\u22121j cos(\u03c9 i\u22121 j t+ \u03c6 i\u22121 j ), \u221e\u2211 j=1 Ai+1j cos(\u03c9 i+1 j t+ \u03c6 i+1 j )  =\n\u221e\u2211 j=1 ki\u22121A i\u22121 j\u221a\n[ki + ki\u22121 \u2212mi\u03c9i\u22121j 2 ]2 + bimi\u03c9 i\u22121 j\n2 cos\n( \u03c9i\u22121j t+ \u03c6 i\u22121 j \u2212 arctan [ bi\u03c9 i\u22121 j\nki + ki\u22121 \u2212mi\u03c9i\u22121j 2\n])\n+ \u221e\u2211 j=1 kiA i+1 j\u221a\n[ki + ki+1 \u2212mi\u03c9i+1j 2 ]2 + bimi\u03c9 i+1 j\n2 cos\n( \u03c9i+1j t+ \u03c6 i+1 j \u2212 arctan [ bi\u03c9 i+1 j\nki + ki+1 \u2212mi\u03c9i+1j 2\n])\nSince this is also a member of Dynqp, the mass-spring system is dynamically structurally stable with respect to Dynqp and so the equations Fi define the structural causal model for asymptotic dynamics."}], "references": [{"title": "Causality: Models, Reasoning, and Inference", "author": ["J. Pearl"], "venue": null, "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2009}, {"title": "Structural equations with latent variables", "author": ["Kenneth A Bollen"], "venue": null, "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2014}, {"title": "Causality in bayesian belief networks", "author": ["Marek J Druzdzel", "Herbert A Simon"], "venue": "In Proceedings of the Ninth international conference on Uncertainty in artificial intelligence,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 1993}, {"title": "Learning linear cyclic causal models with latent variables", "author": ["Antti Hyttinen", "Frederick Eberhardt", "Patrik O Hoyer"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2012}, {"title": "On causal discovery with cyclic additive noise models", "author": ["Joris M Mooij", "Dominik Janzing", "Tom Heskes", "Bernhard Sch\u00f6lkopf"], "venue": "In Advances in neural information processing systems,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2011}, {"title": "Learning why things change: the difference-based causality learner", "author": ["Mark Voortman", "Denver Dash", "Marek J Druzdzel"], "venue": "Proceedings of the 26th Conference on Uncertainty in Artificial Intelligence", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2010}, {"title": "Discovering cyclic causal models by independent components analysis", "author": ["Gustavo Lacerda", "Peter L Spirtes", "Joseph Ramsey", "Patrik O Hoyer"], "venue": "In Proceedings of the Twenty-Fourth Conference on Uncertainty in Artificial Intelligence (UAI2008),", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2008}, {"title": "Directed cyclic graphical representations of feedback models", "author": ["Peter Spirtes"], "venue": "In Proceedings of the Eleventh conference on Uncertainty in artificial intelligence,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1995}, {"title": "Causality and model abstraction", "author": ["Yumi Iwasaki", "Herbert A Simon"], "venue": "Artificial intelligence,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 1994}, {"title": "Restructuring dynamic causal systems in equilibrium", "author": ["Denver Dash"], "venue": "In AISTATS. Citeseer,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2005}, {"title": "From ordinary differential equations to structural causal models: the deterministic case", "author": ["J. Mooij", "D. Janzing", "B. Sch\u00f6lkopf"], "venue": "Proceedings of the Twenty-Ninth Conference Annual Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2013}], "referenceMentions": [{"referenceID": 5, "context": "With the exception of [6], each of these methods assume that the dynamical system comes to a static equilibrium, with the derived SCM describing how this equilibrium changes under intervention.", "startOffset": 22, "endOffset": 25}, {"referenceID": 10, "context": "In doing so, we draw inspiration from the approach of [11].", "startOffset": 54, "endOffset": 58}, {"referenceID": 10, "context": "One possible way to write down an ODE is to canonically decompose it into a collection of first order differential equations, such as is done in [11].", "startOffset": 145, "endOffset": 149}, {"referenceID": 10, "context": "3) Example 1 ([11]).", "startOffset": 14, "endOffset": 18}, {"referenceID": 0, "context": "Using Pearl\u2019s do-calculus notation [1] and for brevity omitting the t, we write do(XI = \u03b6 I) for this intervention.", "startOffset": 35, "endOffset": 38}, {"referenceID": 0, "context": "This should be interpreted as saying that interventions on each variable can be made independently and combined in any way, and it is thus related to notions that have been discussed in the literature under various headings [1] (e.", "startOffset": 224, "endOffset": 227}, {"referenceID": 10, "context": "A crucial assumption of [11] was that the systems considered were stable in the sense that they would converge to unique stable equilibria after arbitrary (constant) interventions.", "startOffset": 24, "endOffset": 28}, {"referenceID": 10, "context": "In the particular case that DynI consists of constant trajectories, the following definitions of stability can be seen to be closely related to those of [11].", "startOffset": 153, "endOffset": 157}, {"referenceID": 10, "context": "In the language of [11], this would imply that the ODE is structurally stable.", "startOffset": 19, "endOffset": 23}], "year": 2016, "abstractText": "We show how, under certain conditions, the asymptotic behaviour of an Ordinary Differential Equation under non-constant interventions can be modelled using Dynamic Structural Causal Models. In contrast to earlier work, we study not only the effect of interventions on equilibrium states; rather, we model asymptotic behaviour that is dynamic under interventions that vary in time, and include as a special case the study of static equilibria.", "creator": "LaTeX with hyperref package"}}}