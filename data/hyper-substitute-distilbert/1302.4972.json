{"id": "1302.4972", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "20-Feb-2013", "title": "Causal Inference and Causal Explanation with Background Knowledge", "abstract": "chance reasoning presents naive algorithms around answering the following probability questions ; ( i ) probability there exist a coherent explanation consistent with a set of moral knowledge sufficient explains outcomes to these observed statistical facts in a conversation? ( ii ) given that if will such a causal explanation than limits the causal relationships common to every such causal explanation?", "histories": [["v1", "Wed, 20 Feb 2013 15:22:41 GMT  (507kb)", "http://arxiv.org/abs/1302.4972v1", "Appears in Proceedings of the Eleventh Conference on Uncertainty in Artificial Intelligence (UAI1995)"]], "COMMENTS": "Appears in Proceedings of the Eleventh Conference on Uncertainty in Artificial Intelligence (UAI1995)", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["christopher meek"], "accepted": false, "id": "1302.4972"}, "pdf": {"name": "1302.4972.pdf", "metadata": {"source": "CRF", "title": "Causal inference and causal explanation with background knowledge", "authors": ["Christopher Meek"], "emails": [], "sections": [{"heading": null, "text": "This paper presents correct algorithms for answering the following two questions; (i) Does there exist a causal explanation con sistent with a set of background knowledge which explains all of the observed indepen dence facts in a sample? (ii) Given that there is such a causal explanation what are the causal relationships common to every such causal explanation?\n1 INTRODUCTION\nDirected acyclic graphs have had a long history in the modeling of statistical data. One of the earliest uses is by Sewall Wright (1921) under the name path anal ysis. More recently there has been a resurgence of the use of directed acyclic graphical models in statistics and artificial intelligence including work on Bayesian networks, factor analysis, and recursive linear struc tural equation models. The relationship between di rected graphs and (sets of) distributions under a va riety of assumptions has been worked out in detail by Pearl (1988), Lauritzen et al. (1990) and Spirtes et al. (1993).\nA few of the benefits of using directed graphical mod els without latent variables include (i) the existence of direct estimates (i.e. do not need to use iterative methods for maximum likelihood estimation), (ii) the models can represent many joint distributions with a reduction in the number of parameters as compared to the number of parameters required for an uncon strained model, and (iii) the existence of efficient al gorithms for calculation of conditional distributions.\nAn additional benefit of the directed graphical frame work is that there is often a natural causal interpreta tion to the graphical structure. Both Pearl and Verma (1991) and Spirtes et al. (1993) have advanced theo ries relating causality, directed graphs and probability\n*E-mail address: cm1x41andrew. emu. edu\nmeasures and have developed algorithms for inferring causal relationships from statistical data.\nIn this paper, I extend this work on causal inference to consider the following two types of questions. (i) Does there exist a causal explanation consistent with a set of background knowledge which explains all of the observed independence facts in a sample? (ii) Given that there is such a causal explanation what are the causal relationships common to every such causal ex planation? A special case of the first question, where there is no background knowledge, has been answered in Verma and Pearl (1992). I consider the more realis tic case where the modeler may have additional infor mation about causal relationships. The source of the background knowledge may be prior experience of the existence or non-existence of a causal relationship, or knowledge of temporal ordering among the variables. Question (ii) is a fundamental question about the ex tent to which causal relationships can be inferred from a set of independence facts given the assumptions re lating directed graphs, causality, and probability mea sures hold.\n1.1 DEFINITIONS\nA dependency model is a list M of conditional inde pendence statements of the form AliBIS where A, B, and S are disjoint subsets of V.1 M \ufffdAliBIS if and only if AliBIS appears in list M. A graph is a pair (V, E) where V is a set of vertices and E is a set of edges. A partially directed graph is a graph which may have both undirected and directed edges and has at most one edge between any pair of vertices. A partially directed graph is said to be directed if and only if there are no undirected edges in the graph and a partially directed graph is undirected if and only if there are no directed edges in the graph. A -+ B if and only if there is a directed edge between A and B and A B if and only if there is an undirected edge between A and B. The parents of a vertex A (written pa(A)) is the set of vertices such that there is a di rected edge from the vertex to A. The adjacencies of\n1The statement AliBIS is read A is independent of B given S and is equivalent to I(A, S, B).\n404 Meek\nvertex A (written adj(A)) is the set of vertices which share an edge with A.\nFollowing the terminology of Lauritzen et al. (1990), a probability measure over a set of variables V satisfies the local directed Markov property for a directed acyclic graph G with vertices V if and only if for every W in V, W is independent of the set of all its non-descendants conditional on the set of its parents.2 M arkav( G) is the set of probability measures that satisfy the lo cal directed Markov condition with respect to G. Two graphs, G and G' are Markov equivalent if and only if Markav(G) = Markav(G'). G entails that A is inde pendent of B given S (written G F AliBIS) if and only if A is independent of B given S in every proba bility measure in Mar kav (G). It is easy to show that the set of entailed independence facts for two Markov equivalent graphs are identical. The following defi nition is from Verma and Pearl (1992) although the name has been changed. A directed acyclic graph G is a complete causal explanation of M if and only if the set of conditional independence facts entailed by G is exactly the set of facts in M.\nThe pattern for a partially directed graph G is the partially directed graph which has the identical adja cencies as G and which has an oriented edge A -+ B if and only if there is a vertex C \u00a2 adj(A) such that A -+ B and C -+ B in G. Let pattern( G) denote the pattern for G. A triple (A, B, C) is an unshielded col lider in G if and only if A-+ B, C-+ B and A is not adjacent to B. It is easy to show that two directed acyclic graphs have the same pattern if and only if they have the same adjacencies and same unshielded colliders.\nTheorem 1 (Verma and Pearl1990) Two directed acyclic graphs G and G' are Markov equiv alent if and only if pattern( G) =pattern( G').\nA partially directed graph G extends partially directed graph Hif and only if (i)G and Hhave the same adja cencies and (ii) if A -+ B is in H then A -+ B is in G. A graph G is a consistent DA G extension of graph H if and only if G extends H, G is a directed acyclic graph, and pattern( G) = pattern(H). Let K be a pair (F, R) where F is the set of directed edges which are forbid den, R is the set of directed edges which are required; these sets will represent our background knowledge. It is possible to extend the set of background knowledge to include a partial order over the variables but this extension is not handled in this paper. Background knowledge K is consistent with graph G if and only if there exists a graph G' which is a consistent DAG extension of G such that (i) all of the edges in Rare oriented correctly in G' and (ii) no edge A-+ B in F is oriented as such in G.\n2See Lauritzen et al. (1990) for a comparison of a variety of alternative Markov conditions. A is an ancestor of Band B is a descendant of A if and only if A = B or there is a directed path from A to B.\n1.2 PROBLEMS\nIn this paper I will consider the following four question and give algorithms for answering them;\n(A) Does there exists a complete causal explanation for a set of conditional independence statements\nM?\n(B) Does there exists a complete causal explanation for a list of conditional independence statements\nM consistent with background knowledge K?\n(C) Given that there is a complete causal explanation for M what are the causal relationships common to every complete causal explanation?\n(D) Given that there is a complete causal explanation forM what are the causal relationships common to every complete causal explanation consistent with respect to background knowledge K?\nProblems (A) and (C) are just special cases of prob lems (B) and (D) respectively. Verma and Pearl (1992) have given an algorithm to answer problem (A).\n1.3 OVERVIEW OF SOLUTIONS\nIn this section I will outline solutions of problems (B) and (D). The algorithm for solving problem (B) con sists of the following four phases.\nI Examine independence statements in M and try to construct the pattern of some directed acyclic graph G. Let IT1 be the result of Phase I.\nII 'Thy to extend IT1 with the background knowledge K. Let ITn be the result of Phase II.\nIII 'Thy to find a graph ITn1 which is a consistent DAG extension of ITn.\nIV Check whether ITn1 is a complete causal expla nation for M.\nThe solution to problem (D) and thus problem (C) is closely related to the solution of problem (B); The al gorithm to solve problem (D) consists of phase I and phase II described above. The work comes in showing that the orientation rules used in Phase II yield a graph which has the required property of having all and only the orientations common to complete causal explana tions for M consistent with a set of background knowl edge K.\n2 CAUSAL RELATIONSHIPS\nCOMMON TO ALL COMPLETE\nCAUSAL EXPLANATIONS\n2.1 Problem (C)\nThe solution to problem (C) consists of phase I and phase II' described below.\nCausal inference and causal explanation with background knowledge 405\n2.1.1 Phase I\nThe goal of phase I is to find the pattern which repre sents the class of complete causal explanations forM. This is accomplished in two steps described below. A triple (A, B, C) is said to be unshielded if and only if A is adjacent to B, B is adjacent to C and A is not adjacent to C.\n81 Form an undirected graph G by the following rule. A is adjacent to B in G if and only if there does not exist a set S \ufffd V\\ {A, B} such that M f= A.llBjS. If there is such an S let Sep(A, B) = S.\n82 For all unshielded triples (A, B, C) orient A\ufffd B and C \ufffd B if B fj. Sep(A, C).\n2.1.2 Phase II'\nThe goal of phase II' is to find a partially directed graph whose adjacencies are the same as any complete causal explanation for M and whose edges are directed if and only if every complete causal explanation for M has the edges oriented.\nA brief explanation of the schematic rules in Figure 1. Each orientation rule consists of a pair of schematic graphs. A schematic graph matches a pattern II' if there exists a set of vertices D in II' and a bijective mapping (f) from the vertices in the schematic pat tern to D such that (i) pairs of vertices are adjacent in the schematic if and only if the corresponding pair of vertices are adjacent in II' and (ii) if A \ufffd B in the schematic then the corresponding edge is oriented f(A) \ufffd f(B) in II' (iii) if A- B in the schematic then the corresponding edge is unoriented and (iv) if A and B are connected by a dashed line then either f(A) - f(B), f(A) \ufffd f(B), or f(B) \ufffd f(A) appears in II'. If the schematic to the left of the :::? matches pattern II' then orient the unoriented edges in II' ac cording to the oriented edges in the schematic to the right of t he :::? \u2022\nGiven the rule in Figure 1 phase II' is a one step algorithm. 3\n3This phase can be implemented in a procedure with a running time polynomial in the number of vertices in the graph. The output of this phase is a maximally oriented graph (defined below). Chickering (1995) and Andersson et al. (1995) give algorithms for finding the maximally ori ented graph from a directed graph rather than a pattern. Chickering (1995) also gives an algorithm to find the maxi mally oriented graph from a pattern; this algorithm is more\n81 Let II1 be the result of phase I. Orient every edge which can be oriented by successive applications of rules R1, R2 and R3; i.e. close II1 under rules R1, R2 and R3.\n2.2 Problem (D)\nThe solution for problem (D) consists of phases I, II' and II\". Phase II\" is described below.\n2.2.1 Phase II\"\nLet K- = (F, R) be the background knowledge and let II1p be the partially directed graph obtained from phase II'.4\nS1 If there is an edge A\ufffd Bin F such that A\ufffd B is in lin' then FAIL.\n81' If there is an edge A \ufffd B in R such that B \ufffd A is in II11' or A is not adjacent to B then FAIL.\nS2 Randomly choose one edge A \ufffd B from R and let R = R\\{A \ufffd B}.\nS3 Orient A \ufffd B in II1 I' and close orientations un der Rl, R2, R3, and R4.\nS4 If R is not empty then go to Sl.\nIf Phase II\" fails then there is no complete causal ex planation for M consistent with K.\n2.3 Correctness\nBy assumption there is a directed acyclic graph G which is a complete causal explanation for M.5 Since a graph G' which is Markov equivalent to G has the same entailed independence facts G' is also a complete causal explanation forM. Any graph G' which is not Markov equivalent to G is not a complete causal ex planation for M; either G' differs from G by (i) an adjacency between A and B in which case for some set S it is the case that AliBIS is entailed in one but not the other graph and (ii) there is an unshielded triple (A, B, C) which is a oriented A\ufffd Band C \ufffd B in one but not the other graph in which case there is a set S which does not include B such that A.U.CIS in one but not the other graph. The correctness of phase I follows from the correctness of the PC algo rithm (Spirtes et al. 1993) or the correctness of the algorithm presented in Verma and Pearl (1992). How ever, the PC algorithm is more judicious than the al gorithm presented in phase I with respect to the num ber and type of independence facts which need to be\ncomplicated but more efficient than a naive implementa tion of the method described above.\n4This phase can be implemented in a procedure with a running time polynomial in the number of vertices in the graph.\n5The existence of a complete causal explanation for M is equivalent to the assumption of faithfulness (Spirtes et al. 1993) or stability (Verma and Pearl 1990).\n406 Meek\nchecked which, in practice, leads to an efficient imple mentation with nice statistical properties (see Spirtes et al. 1993).\nGiven that the correct pattern has been found in phase I problems (C) and (D) can be restated. To solve problem (C) all of the orientations common to Markov equivalent graphs with the pattern obtained from phase I. To solve problem (D) all of the orienta tions common to Markov equivalent graphs with the pattern obtained from phase I with the additional re striction that the orientations agree with the edges in K, the background knowledge. The following defini tion formalizes these notions.\nThe maximally oriented gmph for pattern G with re spect to a consistent set of background knowledge K = (F, R) is the graph max( G, K) such that for each unoriented edge A - B in max ( G, K) there exist graphs G1 and G2 that are consistent DAG extensions of max( G, K) such that (i) A---+ B in G1 and B ---+ A in G2, (ii) every edge in R is oriented correctly in max( G, K), and (iii) no edge A---+ B in F is oriented as A---+ B in max( G, K).\nAn orientation rule is sound if and only if any orien tation other than the orientation indicated by the rule would lead to a new unshielded collider or a directed cycle.\nTheorem 2 (Orientation Soundness) The four orientation rules given in Figure 1 are sound.\nTheorem 3 (Orientation completeness) The re sult of applying rules Rl, R2 and R3 to a pattern of some directed acyclic gmph is a maximally oriented graph.\nTheorem 4 (Comp. w/ Back. Knowledge) Let K be a set of background knowledge consistent with pattern II of some directed acyclic gmph. The result of applying rules Rl, R2, R3 and R4 (and orienting edges according to K) to a pattern II is a maximally oriented gmph with respect to K.\nThe proofs of these theorems are given in the ap pendix.\n3 EXISTENCE OF COl\\1PLETE\nCAUSAL EXPLANATIONS\nIn this section I will present solutions for problems (A) and (B). As mentioned above, Verma and Pearl (1992) gave a solution to problem (A). Their solution of prob lem (A) consists essentially of phase I described above and of phase III and phase IV presented below. How ever, phase III has been modified and their solution does not handle background knowledge (i.e. does not solve problem (B)). The modification to phase III will be described below.\n3.1 Problem (A) and (B)\nThe solution to problem (B) subsumes the solution to problem (A); problem (A) is the instance of prob lem (B) with no background knowledge. The solu tion of problem (B) consists of four phases. The first two phases (phase I and phase II) have been described above and the final two (phase III and phase IV) are described below.\n3.1.1 Phase III\nLet IIn be the result of phase II. Phase III attempts to find a consistent DAG extension of Iln.\nS1 If Iln has no unoriented edges then STOP\nS2 Choose an unoriented edge A - B from IIn\nS3 Orient edge A ---+ B in Iln and close orientations under rules R1, R2, R3, and R4.\nS4 Go to Sl.\nThe significant difference between this algorithm and the algorithm presented in Verma and Pearl (1992) is that their algorithm has the \"potential\" for backtrack ing. Each time that an edge is oriented in step III the edge had to be pushed onto a stack in case that the specific choice of orientation could not be extended to a consistent DAG extension of Iln. They conjectured that there is no need for the backtracking on the basis of empirical studies. Their conjecture is correct; the conjecture follows from Theorem 4\n3.1.2 Phase IV\nLet Iln1 be the result of Phase III.\nS1 If Ilni is cyclic then FAIL\nS2 Test that every statement I in M is entailed by IIni (i.e. Iln1 I=/).\nS3 Let -< be a total ordering of the nodes of Iln1 which agrees with the orientations in Iln 1, i.e. A ---+ B implies that A -< B. Let A--: be the set of vertices which are before A in ordering-<. For all vertices A test if M I= Ail(A--: \\pa(A))Jpa(A)\nTo test whether an independence fact is entailed by a given directed acyclic graph one can use either d separation (Pearl 1988) or Lauritzen's rule (Lauritzen et al. 1990). The correctness of phase IV has been shown (see Verma and Pearl 1992) for dependency models M closed under the graphoid axioms (see Pearl 1988). An alternative approach without this restric tion is to replace steps 2 and 3 with the single step of checking to see that for all disjoint subsets A, B, and C of the set of vertices it is the case that M I= AliBI C if and only if IIni I= AilBJC.\nCausal inference and causal explanation with background knowledge 407\n3.2 Correctness\nThe correctness of the solution to problem (B) is shown as follows. Assume that there is a complete causal explanation for M with respect to /C and that graph G is such an explanation. As discussed above, phase I finds the graph pattern( G) and phase II finds max(pattern( G), /C). To see that phase III finds a consistent DAG extension of pattern( G) observe that after each iteration of the steps in phase III the re sult is a graph which is a maximally oriented graph for pattern( G) and some set of background knowledge, i.e. max (pattern( G), /C') for some IC'. Thus any choice of orientation in step 3 will be consistent and graph resulting from phase III will be a complete causal ex planation for M with respect to /C. If contrary to our original assumption; there is no complete causal ex planation for M with respect to /C then in the event that the algorithm reaches phase IV with some graph G then the graph will fail phase IV.\n4 RELATED TOPICS\nIn this section the relationship of this work to other questions of interest in graphical modeling is briefly considered.\n4.1 Counting principles\nThe proof of Theorem 3 gives us a method to calcu late the number of Markov equivalent graphs in a given Markov equivalence class and the proof of Theorem 4 gives us a method to calculate the number of Markov equivalent graphs that share a set of orientation in a given Markov equivalence class. While the methods are too involved to present in the space which is avail able the interested reader can reconstruct these algo rithm from an analysis of the proofs of these theorems.\n4.2 Find a DAG from a pattern\nCombining phases II' and III gives us an algorithm which converts a pattern G to a directed acyclic graph H such that pattern(H) = G. This is of use for at least the following reason. Information scores (MDL, AIC, and BIC) and the scores proposed by Hecker man et al. (1994) are identical for Markov equivalent models. These scores are used as the basis of model selection techniques. Phases II' and III allow a model selection procedure to use the more appropriate space of patterns to search for models during the process of model selection. One such procedure is presented in Spirtes and Meek (1995).\n4.3 Chain graphs\nA cycle in a partially directed graph G is a sequence of vertices (A1, A2, \u2022 \u2022 \u2022 , An) with n > 2 such that (i) A1 = An, (ii) all other pairs of vertices are distinct, (iii) for all 1 ::; i < n it is the case that either Ai ---+ Ai+I or\nAi - Ai+l is in G, and (iv) for some 1 ::; i < n it is the case that Ai ---+ Ai+l\u00b7\nA chain graph is an acyclic partially directed graph. The chain graph representation subsumes both di rected and undirected graphical models. A discus sion of directed and undirected models can be found in Pearl (1988) and Whittaker (1990) and a discussion of chain graphs can be found in Lauritzen and Wermuth (1989), Whittaker (1990) and Frydenberg (1990).\nLemma 1 Let II0 be the result of applying the orien tation rules Rl, R2, and R3 to the pattern II of some directed acyclic graph. In ITo, if A ---+ B and B - C then A---+ C.\nFrom Lemma 1 it follows that if II is the pattern for a Markov equivalence class for some directed acyclic graph then the graph max(II, 0) obtained by applying phase II' to II is a chain graph.6 Thus max(II, 0) con stitutes a natural way to represent the entire Markov equivalence class of graphs with a single chain graph. This may allow researchers to develop search tech niques for directed acyclic representations using chain graphs.\nAcknowledgements\nI would like to thank Thomas Richardson, Clark Gly mour, Peter Spirtes and two anonymous referees for helpful comments on an earlier draft of this paper. Research for this paper was supported by the Office of Navel Research grant ONR #N00014-93-1-0568.\nReferences\nFrydenberg, M. (1990). The chain graph Markov prop erty. Scand. J. Statistics 17.\nBeckerman, D., D. Geiger, and D. Chickering (1994). Learning Bayesian networks: The combination of knowledge and statistical data. Technical Report MSR-TR-94-09, Microsoft Research.\nLauritzen, S., A. Dawid, B. Larsen, and H. Leimer (1990). Independence properties of directed Markov fields. Networks 20.\nLauritzen, S. and N. Wermuth (1989). Graphical models for association between variables, some of which are qualitative and some quantitative. An nals of Statistics 17.\nPearl, J. (1988). Probabilistic Reasoning in Intelligent systems. San Mateo: Morgan-Kaufmann.\nPearl, J. and T. Verma (1991). A theory of inferred causation. In Allen, Fikes, and Sandwall (Eds.), Principles of knowledge representation and rea soning: Proc. of the second Int. conf., pp. 441- 452. San Mateo: Morgan Kaufmann.\n6 Andersson et al. {1995) have also shown this result in an unpublished manuscript. In Verma and Pearl {1990) max(TI, 0) is called the completed pattern.\n408 Meek\nSpirtes, P., C. Glymour, and R. Scheines (1993). Cau sation, Prediction, and Search. Springer-Verlag.\nSpirtes, P. and C. Meek (1995). Learning Bayesian net works with discrete variables from data. In Proc. of the first Int. conf. on Knowledge Discovery and Databases, to appear.\nVerma, T. and J. Pearl (1990). Equivalence and syn thesis of causal models. In Proc. of the Sixth Conf. in Art. Int., Mountain View, CA, pp. 220-227.\nVerma, T. and J. Pearl (1992). An algorithm for de ciding if a set of observed independencies has a causal explanation. In Proc. of the 8th Conf. on Unc. and Art. Int., Mountain V iew, pp. 323-330.\nWhittaker, J. (1990). Graphical Models in applied mul tivariate statistics. Wiley.\nWright, S. (1921). Correlations and causation. Journal of Agricultural Research 20.\n5 APPENDIX - PROOFS\nTheorem 2 The four orientation rules given in Fig ure 1 are sound.\nProof Rule Rl; If the edge were oriented in the opposite direction there would be a new unshielded collider. Rule R2; If the edge were oriented in the opposite direction there would be a cycle. Rule R3; i f the edge were oriented in the opposite direction then by two application of the rule R2 there would be a new unshielded collider. Rule R4; If the edge were oriented in the opposite direction then by two applications of rule R2 there would be a new unshielded collider .0\nLemma 1 Let ITo be the result of applying the orien tation rules Rl, R2, and R3 to the pattern IT for some directed acyclic graph. In ITo, if A -+ B and B C then A-+ C.\nProof- A vertex X is an ancestor of vertex Y with respect to ITo if there is a path such that every edge is directed from X to Y in ITo. The orientations in ITo induce a partial ordering on the vertices by the following rule; X< Y if X is an ancestor of Y. With respect to this partial ordering, choose a vertex B to be a minimal vertex such that there are edges A -+ B, B C in ITo and A -+ C is not in ITo . Note that A E adj (C) otherwise B - C would be oriented by rule R1. FUrthermore, A - C must be unoriented; if A - C is oriented A -+ C then we are done and if the edge is oriented C -+ A then B - C oriented by rule R2.\nCase 1 - Edge A -+ B is oriented in ITo by rule Rl. Thus there is an edge D -+ A such that D fl. adj(B). By construction B is a minimal vertex such that there are edges A -+ B and B - C in IT0 but A meets this requirement and A< B. Contradiction.\nCase 2 - Edge A -+ B is oriented because it is part of an unshielded collider. In this case, there is an edge\nD-+ B such that D fl. adj(A). If D \u00a2 adj(C) then B - C would be is oriented by rule Rl. If D E adj (C) and D - C is unoriented then B - C is oriented by R3. Suppose that D - C is oriented. If C -+ D then B C is oriented by rule R2 else if D -+ C then A C is oriented C -+ A by rule Rl and B - C is oriented by rule R2. Contradiction.\nCase 3 Edge A -+ B is oriented by R3. Observe that there is an unshielded collider colliding at B. This case is sufficiently similar to case 2 that the proof is omitted.\nCase 4 - Edge A -+ B is oriented by R2. In this case there exists a vertex D such that A -+ D and D -+ B are in ITo. D E adj (C) otherwise B - C is oriented by Rl. Edge D - C is oriented by construction (D < B). If C -+ D the B - C is oriented by R2; otherwise if D-+ C then A-+ C by R2.D\nAn undirected graph H is chordal if and only if every undirected cycle of length four or more has an edge between two nonconsecutive vertices on the cycle (i.e. has a chord). A total order ( <) induces an orientation in an undirected graph H by the rule that if A B is in H then orient the edge A -+ B if and only if A < B. If H is an undirected graph and a is a total ordering of the vertices in H then Her is the induced directed graph obtained by the rule given above. Clearly Her is acyclic . A total order a is a consistent ordering with respect to H if and only if Her has no unshielded colliders.\nLemma 2 Only chordal graphs have consistent order ings.\nProof - Suppose that a is a consistent or dering with respect to non-chordal graph H. Let (A\ufffd, A2,Aa, . . . , An) be a non-chordal cycle with n \ufffd 4 in undirected graph H. Let Ai be the largest vertex (with respect to the ordering a) in the cycle. If i = n then Ai+l = At and if i = 1 then Ai- l = An. In Her, Ai-l -+ Ai and Ai+t -+ Ai and since the cycle is non-chordal Ai+1 fl. adj(Ai-I)\u00b7 Contradiction.D\nA clique in graph His a set of vertices such that there is an edge in Hbetween each pair of vertices in the set. A maximal clique is a set of vertices that is a clique and such that no superset of the set is a clique. Let c H = { cl' . . . , Cn} denote the set of maximal cliques of graph H. Note that maximal cliques in C H can overlap and that the union of all of the maximal cliques is the set of vertices in H. A join tree for H is a tree whose vertices are inCH and such that (i) Each edge Ci Cj is labeled by the set Ci n Cj, and (ii) for every pair Ci and Ci ( i =F j) and for every A E Ci n Cj each edge along the unique path between c\ufffd. and Ci includes label A. Now I state a useful result from Beeri et al. 1983.\nLemma 3 (Beeri et al.) Graph H is chordal if and only if H has a join tree.\nCausal inference and causal explanation with background knowledge 409\nA partial order 1r is a tree order for tree T if and only if for all A and B which are adjacent in T either 1r(A, B) or 1r(B, A). Conceptually a tree order is obtained by choosing one node as the root of the tree and ordering vertices based on their distance from the root; all tree orderings for a tree T can be obtained in this fashion by selecting each vertex as the root.\nLet 1f'T be a tree ordering of the join tree T for graph H. 7fT induces a partial ordering -<1rT on the vertices of H by the following rules; (i) if 1f'T ( Ci, Ci) and C, is not the minimum element of 7fT then for all A E Ci \\C; and C E Cj \\Ci and B E Cj n Ci order A -<1rT B and B -<1rT C, (li) if 1f'T(Ci,Ci) and Ci is the minimum element of 1f'T then for all C E Cj \\Ci and B E C; n Ci order B -<1rT C , (iii) if A -<1rT D and D -<1rT B then A -<1rT B (i.e. transitive closure of -<,...T).\nLet 1r be a tree ordering for join tree T of H. Note that the partial order -<1r on the vertices in Hinduced by the partial order 1r only orients edges which are involved in an unshielded triple; i.e. A -<1r B only if there is a C such that (A, B, C) or ( C, A, B) is an unshielded triple. In fact all edges involved in unshielded colliders except those edges A B where both A and B are in the minimum vertex (the \"root clique\") of the join tree.\nA partial order 1r1 is an extension of a partial order 1r2 if and only if for all A and B such that 1r2 (A, B) it is the case that 1r1 (A, B).\nLemma 4 Let 1r be a tree ordering of a join tree T for H. Any extension of -<1r to a total ordering is a consistent ordering for H.\nProof- Let a be a total ordering which extends -<1r\u00b7 No unshielded collider can occur inside a clique since all triples are shielded . Let (A, B, C) be an unshielded triple (i.e. A is adjacent to B, B is adjacent to C, and A is not adjacent to C). There exists an i and j such that A E Ci A A \u00a2 Ci A C \u00a2 Ci A C E Ci A B E Ci n Ci; if not A and C would be adjacent. By the join tree property we know that there is a unique path p between Cj and Ci in T.\nCase 1- ...,(7r(Ci,Cj) V 7r(C;,Ci)). There must be a k such that C\ufffdc is on p such that 7r(C\ufffdc,Ci) l\\7r(Ck,CJ)\u00b7 We know that A \u00a2 C\ufffdc V C \u00a2 C\ufffdc otherwise (A, B, C) is not unshielded since C,. is a clique. Without loss of generality suppose that C \u00a2 Ck. We know that BECk by the join tree property and since 7r(Ck,Cj) it is the case that B -<1r C and thus (A, B, C) is not an unshielded collider in Ha.\nCase 2 1r(Ci, Cj) (other case is symmetric). In this case the (A, B, C) unshielded triple is oriented as a non-collider by any extension of -<1r to a total order since B -<1r C .D\nLemma 5 (Orienting chordal graphs) Let H be an undirected chordal graph. For all pairs of adjacent vertices A and B in H there exist total orderings a and"}, {"heading": "1 which are consistent with respect to H and such that", "text": "A -+ B is in Ha and B -+ A is in H-y.\nProof- For the case where H is disconnected apply the argument to each of the disconnected components.\nCase 1 \ufffd For all i either A E Ci A B E Ci or A \u00a2 Ci A B \u00a2 Ci. Let 1r be a tree ordering of a join tree for H. A and B are not comparable with respect to -<1r\u00b7 Thus by Lemma 4 we simply choose two extensions of -<1r; one with A -<1r Band another with B -<1r A.\nCase 2 There exists an i such that A \u00a2 Ci V B \u00a2 Ci and A E Ci VB E Ci. Without loss of generality assume that A \u00a2 Ci 1\\ B E Ci. Given that there is an edge between A and B there is a j such that j ::/= i and A E Cj 1\\B E Cj. Let n1 be a tree ordering of a join tree for H with Ci is the root and let 1r2 be a tree ordering of a join tree for H with C; as the root. Then consider any extension of -<1r1 and -<1r2 to total orderings and apply Lemma 4. We are done since B -<1r1 A and A -<1r2 B.D\nTheorem 3 The result of applying rules R1, R2 and R3 to a pattern of some directed acyclic graph is a maximally oriented graph.\nProof - Let II0 be the result of applying the orien tation rules R1, R2, and R.3 to the pattern II. Given Lemma 1 no orientation of edges not oriented in IIo will create a cycle which includes an edge or edges oriented in II0 and no orientation of an edge not ori ented in II0 can create an unshielded collider with an edge oriented in II0\u2022 Consider the undirected graph H, the subgraph of IIo, obtained by removing all of the oriented edges in II0\u2022 H is the union of disjoint chordal graphs; suppose this is not the case. Then, by Lemma 2 all total orderings of the vertices leads to a new unshielded collider , say (A, B, C), in H. By Lemma 1, the triple {A, B, C) also forms an unshielded triple in II0, that is A \u00a2 adj(C) in IIo. This is a con tradiction; by assumption the graph II and thus IIo have all unshielded colliders oriented and that there is an acyclic orientation of the graph II with no new unshielded colliders. Finally, by applying Lemma 5 we have completed the theorem.D\nLet H be a partially oriented chordal graph and let T be a join tree for H. Let Aii = Ci n Ci. We define\na relation 'YT on the nodes ofT, the maximal cliques of H, from the orientations in H as follows; 'YT(Ci,Cj) if and only if (i) Aii ::/= 0, (li) for all A E Ati and B E Ci \\Aii it is the case that A -+ B is in H and (iii) it is not the case that for all A E Aii and B E Ci \\Aij A -+ B is in H. We define the partial order tT on the nodes ofT as follows; (i) t:T(Ci,Cj) if 'YT(Ci,Cj) and (li) t:T(Ci,C\ufffdc) if t:T(Ci,Cj} 1\\ tT(Cj,C\ufffdc). That t:T is a partial order follows from the fact that T is a tree and condition (iii) of the definition of 'Y\u00b7\nLemma 6 Let T be a join tree for a partially oriented chordal graph H without any unshielded colliders and with orientations closed under rules R1, R2, R:J, and\n410 Meek\nR4. If there exists an unshielded triple (A, B, C) such that A --+ B in H then for all i and j such that A E Ci 1\\ B E Ci 1\\ C f/. Ci and A f/. Ci 1\\ B E Ci 1\\ C E Ci it is the case that '/'I'(Ci,Cj).\nProof- The proof is in two parts; Figure 2 helps to clarify the proof. Part (i) - Show that for all C E Cj \\Aij it is the case that B --+ C is in H. Simply apply Rl to each of the required edges. Part (ii) - Show that for all D E Aij and for all C E Cj \\Aii it is that case that D --+ C is in H. This follows by application of R4 to A, B, C, and D if A- D. If D--+ A then D--+ B by R2 and D--+ C by R2. If A--+ D then D--+ C by Rl.D\nF igure 2: Schematic for Lemma 6\nLemma 7 Let T be a join tree for a partially ori ented chordal graph H without any unshielded colliders and with orientations closed under rules Rl, R2, R3, and R4. (i) If ET(Ci,Ci) then for all k such that the (unique) path p between Ci and Ck in T is through j then ET(Ci,Ck) and (ii} ifCz and Cm are adjacent on the path p then \"( ( C, Cm) .\nProof- Part (i) is proved by induction on length of path between Ci and Ck in the join tree for T. The base case (j = k) is trivial and apply Lemma 6 for induction step. Part (ii) follows in a similar fash ion. Consider the minimal element Cz of ET such that ET(Cz,Ci) or Cz = Ci. Let Cm be an arbitrary clique such that \u20acT ( Cz, Cm) and Azm i= 0. It must be the case that \"f(C1, Cm) otherwise it would not be the case that ET(Cz,Cm)\u00b7 Then we simply apply Lemma 6 to extend the chain of \"f between adjacent cliques.D\nA partial order 1r over vertices is compatible with the orientations in graph H if and only if for no pair of vertices A and B such that A --+ B in H is it the case that rr(B, A).\nLemma 8 Let T be a join tree for a partially oriented chordal graph H without any unshielded colliders and with orientations closed under rules Rl, R2, R3, and R4. (i} there exists a tree ordering which extends ET, (ii) for all tree orderings 1r which extend ET it is the case that \ufffd11\" is compatible with H.\nProof - (i) Since ET is a partial order there is a minimal element. Choose any minimal element as the root of the tree order. By Lemma 7, a tree order con structed in such a manner extends \u20acT\u00b7 (ii) Let 1r be a tree order which extends \u20acT\u00b7 Suppose that \ufffd11\" is not compatible with H. Then there exists a pair of vertices A and B such that A --+ B in H and B \ufffd11\" A. Let Ci be a clique which contains both A and B. For B \ufffd11\" A\nto hold it must be the case that there is a i such that 7r(Ci,Cj)\u00b7 By Lemma 6 B--+ A. Contradiction.D\nTheorem 4 Let JC be a set of background knowledge consistent with pattern IT. The result of applying rules R1, R2, R3 and R4 (and orienting edges according to JC) to a pattern of some directed acyclic graph is a maximally oriented graph with respect to JC.\nProof - Let IIo be the result of applying the orien tation rules Rl, R2, and R3 to the partially directed graph II. Given Lemma 1 no orientation of edges not oriented in II0 will create a cycle which includes an edge or edges oriented in II0 and no orientation of an edge not oriented in IIo can create an unshielded col lider with an edge oriented in IIo. Consider the undi rected graph H, a subgraph of II0, obtained by remov ing all of the oriented edges in IIo. H is a union of disconnected chordal graph(s); suppose this is not the case. Then, by Lemma 2 all total orderings of the ver tices leads to a new unshielded collider, say (A, B, C), in H. By Lemma 1, the triple (A, B, C) also forms an unshielded triple in II0, that is A f/. adj(C) in IIo. This is a contradiction; by assumption graph II and thus IIo have all unshielded colliders oriented and that there is an acyclic orientation of the graph II with no new un shielded colliders. Let III be the result of orienting all of the edges in II0 that can be oriented with back ground knowledge and let II2 be the result of applying orientation rule Rl, R2, R3, and R4 exhaustively to III. Let A - B be unoriented in II2 and show that there exists consistent orderings a and \"( such that A --+ B in Ha. and B --+ A in H-;.\nCase 1 - For all i either A E Ci 1\\ B E Ci or A f/. Ci 1\\ B f/. Ci. Let T be a join tree for H and let 1r be a tree ordering of T which extends ETi that one exists follows from Lemma 8. A and B are not comparable with respect to \ufffd11\" thus by Lemma 4 we simply choose two extensions (consistent with the ordering existing in II2) of -<11\"; one with A \ufffd11\" B and another with B \ufffd11\" A. By Lemma 4 we are done.\nCase 2 - There exists an i such that A f/. Ci V B f/. Ci and A E CiV B E Ci. Without loss of generality assume that A f/. Ci 1\\ B E Ci. Given that there is an edge between A and B there is a j such that j i= i and A E Cj 1\\ B E Cj. Since the edge between A and B is unoriented we know that it is not the case that \"f(Ci,Cj) and thus it is not the case that ET(Ci,Cj)\u00b7 Thus the tree order obtained from by letting Ci to be the root of the tree is compatible with H by Lemma 8 Let 1r be the tree ordering obtained by letting Cj to be the root of the tree. Note that for all pairs of vertices in the root clique of the tree ordering are not ordered in the partial order induced by the tree ordering. Let the total order \ufffdI be an extension of \ufffd1T consistent with the orientations in II2 such that A \ufffdI B and let the total order -<2 be an extension of \ufffd1T consistent with the orientations in II2 such that B \ufffdI A. Apply Lemma 4 and we are done.D"}], "references": [{"title": "The chain graph Markov prop\u00ad erty", "author": ["M. Frydenberg"], "venue": "Scand. J. Statistics", "citeRegEx": "Frydenberg,? \\Q1990\\E", "shortCiteRegEx": "Frydenberg", "year": 1990}, {"title": "Learning Bayesian networks: The combination of knowledge and statistical data", "author": ["D. Beckerman", "D. Geiger", "D. Chickering"], "venue": "Technical Report MSR-TR-94-09,", "citeRegEx": "Beckerman et al\\.,? \\Q1994\\E", "shortCiteRegEx": "Beckerman et al\\.", "year": 1994}, {"title": "Independence properties of directed Markov fields", "author": ["S. Lauritzen", "A. Dawid", "B. Larsen", "H. Leimer"], "venue": null, "citeRegEx": "Lauritzen et al\\.,? \\Q1990\\E", "shortCiteRegEx": "Lauritzen et al\\.", "year": 1990}, {"title": "Graphical models for association between variables, some of which are qualitative and some quantitative", "author": ["S. Lauritzen", "N. Wermuth"], "venue": "An\u00ad nals of Statistics", "citeRegEx": "Lauritzen and Wermuth,? \\Q1989\\E", "shortCiteRegEx": "Lauritzen and Wermuth", "year": 1989}, {"title": "Probabilistic Reasoning in Intelligent systems. San Mateo: Morgan-Kaufmann", "author": ["J. Pearl"], "venue": null, "citeRegEx": "Pearl,? \\Q1988\\E", "shortCiteRegEx": "Pearl", "year": 1988}, {"title": "A theory of inferred causation", "author": ["J. Pearl", "T. Verma"], "venue": "Proc. of the second Int. conf.,", "citeRegEx": "Pearl and Verma,? \\Q1991\\E", "shortCiteRegEx": "Pearl and Verma", "year": 1991}, {"title": "1995) have also shown this result in an unpublished manuscript", "author": ["Andersson"], "venue": "In Verma and Pearl", "citeRegEx": "Andersson,? \\Q1990\\E", "shortCiteRegEx": "Andersson", "year": 1990}, {"title": "Graphical Models in applied mul\u00ad", "author": ["Unc", "Art"], "venue": "Int., Mountain V iew,", "citeRegEx": "Unc. and Art.,? \\Q1990\\E", "shortCiteRegEx": "Unc. and Art.", "year": 1990}], "referenceMentions": [{"referenceID": 3, "context": "rected graphs and (sets of) distributions under a va\u00ad riety of assumptions has been worked out in detail by Pearl (1988), Lauritzen et al.", "startOffset": 108, "endOffset": 121}, {"referenceID": 2, "context": "rected graphs and (sets of) distributions under a va\u00ad riety of assumptions has been worked out in detail by Pearl (1988), Lauritzen et al. (1990) and Spirtes et al.", "startOffset": 122, "endOffset": 146}, {"referenceID": 2, "context": "rected graphs and (sets of) distributions under a va\u00ad riety of assumptions has been worked out in detail by Pearl (1988), Lauritzen et al. (1990) and Spirtes et al. (1993).", "startOffset": 122, "endOffset": 172}, {"referenceID": 4, "context": "Both Pearl and Verma (1991) and Spirtes et al.", "startOffset": 5, "endOffset": 28}, {"referenceID": 4, "context": "Both Pearl and Verma (1991) and Spirtes et al. (1993) have advanced theo\u00ad ries relating causality, directed graphs and probability", "startOffset": 5, "endOffset": 54}, {"referenceID": 4, "context": "causal relationships common to every such causal ex\u00ad planation? A special case of the first question, where there is no background knowledge, has been answered in Verma and Pearl (1992). I consider the more realis\u00ad", "startOffset": 173, "endOffset": 186}, {"referenceID": 2, "context": "Following the terminology of Lauritzen et al. (1990), a probability measure over a set of variables V satisfies the local directed Markov property for a directed acyclic graph G with vertices V if and only if for every W in V, W is independent of the set of all its non-descendants conditional on the set of its parents.", "startOffset": 29, "endOffset": 53}, {"referenceID": 2, "context": "Following the terminology of Lauritzen et al. (1990), a probability measure over a set of variables V satisfies the local directed Markov property for a directed acyclic graph G with vertices V if and only if for every W in V, W is independent of the set of all its non-descendants conditional on the set of its parents.2 M arkav( G) is the set of probability measures that satisfy the lo\u00ad cal directed Markov condition with respect to G. Two graphs, G and G' are Markov equivalent if and only if Markav(G) = Markav(G'). G entails that A is inde\u00ad pendent of B given S (written G F AliBIS) if and only if A is independent of B given S in every proba\u00ad bility measure in Mar kav (G). It is easy to show that the set of entailed independence facts for two Markov equivalent graphs are identical. The following defi\u00ad nition is from Verma and Pearl (1992) although the name has been changed.", "startOffset": 29, "endOffset": 850}, {"referenceID": 2, "context": "2See Lauritzen et al. (1990) for a comparison of a variety of alternative Markov conditions.", "startOffset": 5, "endOffset": 29}, {"referenceID": 4, "context": "Verma and Pearl (1992) have given an algorithm to answer problem (A).", "startOffset": 10, "endOffset": 23}, {"referenceID": 6, "context": "Chickering (1995) and Andersson et al. (1995) give algorithms for finding the maximally ori\u00ad ented graph from a directed graph rather than a pattern.", "startOffset": 22, "endOffset": 46}, {"referenceID": 6, "context": "Chickering (1995) and Andersson et al. (1995) give algorithms for finding the maximally ori\u00ad ented graph from a directed graph rather than a pattern. Chickering (1995) also gives an algorithm to find the maxi\u00ad mally oriented graph from a pattern; this algorithm is more 81 Let II1 be the result of phase I.", "startOffset": 22, "endOffset": 168}, {"referenceID": 4, "context": "1993) or the correctness of the algorithm presented in Verma and Pearl (1992). How\u00ad ever, the PC algorithm is more judicious than the al\u00ad gorithm presented in phase I with respect to the num\u00ad ber and type of independence facts which need to be", "startOffset": 65, "endOffset": 78}, {"referenceID": 4, "context": "As mentioned above, Verma and Pearl (1992) gave a solution to problem (A).", "startOffset": 30, "endOffset": 43}, {"referenceID": 4, "context": "The significant difference between this algorithm and the algorithm presented in Verma and Pearl (1992) is that their algorithm has the \"potential\" for backtrack\u00ad ing.", "startOffset": 91, "endOffset": 104}, {"referenceID": 4, "context": "To test whether an independence fact is entailed by a given directed acyclic graph one can use either d\u00ad separation (Pearl 1988) or Lauritzen's rule (Lauritzen et al.", "startOffset": 116, "endOffset": 128}, {"referenceID": 2, "context": "To test whether an independence fact is entailed by a given directed acyclic graph one can use either d\u00ad separation (Pearl 1988) or Lauritzen's rule (Lauritzen et al. 1990).", "startOffset": 149, "endOffset": 172}, {"referenceID": 2, "context": "A discus\u00ad sion of directed and undirected models can be found in Pearl (1988) and Whittaker (1990) and a discussion of chain graphs can be found in Lauritzen and Wermuth (1989), Whittaker (1990) and Frydenberg (1990).", "startOffset": 65, "endOffset": 78}, {"referenceID": 2, "context": "A discus\u00ad sion of directed and undirected models can be found in Pearl (1988) and Whittaker (1990) and a discussion of chain graphs can be found in Lauritzen and Wermuth (1989), Whittaker (1990) and Frydenberg (1990).", "startOffset": 65, "endOffset": 99}, {"referenceID": 2, "context": "A discus\u00ad sion of directed and undirected models can be found in Pearl (1988) and Whittaker (1990) and a discussion of chain graphs can be found in Lauritzen and Wermuth (1989), Whittaker (1990) and Frydenberg (1990).", "startOffset": 148, "endOffset": 177}, {"referenceID": 2, "context": "A discus\u00ad sion of directed and undirected models can be found in Pearl (1988) and Whittaker (1990) and a discussion of chain graphs can be found in Lauritzen and Wermuth (1989), Whittaker (1990) and Frydenberg (1990).", "startOffset": 148, "endOffset": 195}, {"referenceID": 0, "context": "A discus\u00ad sion of directed and undirected models can be found in Pearl (1988) and Whittaker (1990) and a discussion of chain graphs can be found in Lauritzen and Wermuth (1989), Whittaker (1990) and Frydenberg (1990).", "startOffset": 199, "endOffset": 217}], "year": 2011, "abstractText": "This paper presents correct algorithms for answering the following two questions; (i) Does there exist a causal explanation con\u00ad sistent with a set of background knowledge which explains all of the observed indepen\u00ad dence facts in a sample? (ii) Given that there is such a causal explanation what are the causal relationships common to every such", "creator": "pdftk 1.41 - www.pdftk.com"}}}