{"id": "1308.3506", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "15-Aug-2013", "title": "Computational Rationalization: The Inverse Equilibrium Problem", "abstract": "modeling the purposeful behavior of imperfect agents featuring a small number of observations is a confusing subject. when restricted between the single - user decision - loop model, inverse agent control techniques generate that observed behavior performs an approximately optimal solution to usually unknown decision problem. these simulations learn a utility function bias explains because real behavior options can certainly be calculated remarkably accurately which will imitate future behavior creating similar observed self prediction policies.", "histories": [["v1", "Thu, 15 Aug 2013 20:43:47 GMT  (734kb,D)", "http://arxiv.org/abs/1308.3506v1", "In submission to JMLR, conference version:arXiv:1103.5254"]], "COMMENTS": "In submission to JMLR, conference version:arXiv:1103.5254", "reviews": [], "SUBJECTS": "cs.GT cs.LG stat.ML", "authors": ["kevin waugh", "brian d ziebart", "drew bagnell"], "accepted": true, "id": "1308.3506"}, "pdf": {"name": "1308.3506.pdf", "metadata": {"source": "CRF", "title": "Computational Rationalization: The Inverse Equilibrium Problem", "authors": ["Kevin Waugh"], "emails": ["waugh@cs.cmu.edu", "bziebart@uic.edu", "dbagnell@ri.cmu.edu"], "sections": [{"heading": null, "text": "In this work, we consider similar tasks in competitive and cooperative multi-agent domains. Here, unlike single-agent settings, a player cannot myopically maximize its reward; it must speculate on how the other agents may act to influence the game\u2019s outcome. Employing the\nar X\niv :1\ngame-theoretic notion of regret and the principle of maximum entropy, we introduce a technique for predicting and generalizing behavior."}, {"heading": "1 Introduction", "text": "Predicting the actions of others in complex and strategic settings is an important facet of intelligence that guides our interactions\u2014from walking in crowds to negotiating multi-party deals. Recovering such behavior from merely a few observations is an important and challenging machine learning task.\nWhile mature computational frameworks for decision-making have been developed to prescribe the behavior that an agent should perform, such frameworks are often ill-suited for predicting the behavior that an agent will perform. Foremost, the standard assumption of decision-making frameworks that a criteria for preferring actions (e.g., costs, motivations and goals) is known a priori often does not hold. Moreover, real behavior is typically not consistently optimal or completely rational; it may be influenced by factors that are difficult to model or subject to various types of error when executed. Meanwhile, the standard tools of statistical machine learning (e.g., classification and regression) may be equally poorly matched to modeling purposeful behavior; an agent\u2019s goals often succinctly, but implicitly, encode a strategy that would require a tremendous number of observations to learn.\nA natural approach to mitigate the complexity of recovering a full strategy for an agent is to consider identifying a compactly expressed utility function that rationalizes observed behavior: that is, identify rewards for which the demonstrated behavior is optimal and then leverage these rewards for future prediction. Unfortunately, the problem is fundamentally ill-posed: in general, many reward functions can make behavior seem rational, and in fact, the trivial, everywhere zero reward function makes all behavior appear rational [Ng and Russell, 2000]. Further, after removing such trivial reward functions, there may be no reward function for which the demonstrated behavior is optimal as agents may be imperfect or the world they operate in may only be approximately represented.\nIn the single-agent decision-theoretic setting, inverse optimal control methods have been used to bridge this gap between the prescriptive frameworks and predictive applications [Abbeel and Ng, 2004, Ratliff et al., 2006, Ziebart et al., 2008a, 2010]. Successful applications include learning and prediction tasks in personalized vehicle route planning [Ziebart et al., 2008a],\npredictive cursor control [Ziebart et al., 2012], robotic crowd navigation [Henry et al., 2010], quadruped foot placement and grasp selection [Ratliff et al., 2009]. A reward function is learned by these techniques that both explains demonstrated behavior and approximates the optimality criteria of decisiontheoretic frameworks.\nAs these methods only capture a single reward function and do not reason about competitive or cooperative motives, inverse optimal control proves inadequate for modeling the strategic interactions of multiple agents. In this article, we consider the game-theoretic concept of regret as a standin for the optimality criteria of the single-agent work. As with the inverse optimal control problem, the result is fundamentally ill-posed. We address this by requiring that for any utility function linear in known features, our learned model must have no more regret than that of the observed behavior. We demonstrate that this requirement can be re-cast as a set of equivalent convex constraints that we denote the inverse correlated equilibrium (ICE) polytope.\nAs we are interested in the effective prediction of behavior, we will use a maximum entropy criteria to select behavior from this polytope. We demonstrate that optimizing this criteria leads to mini-max optimal prediction of behavior subject to approximate rationality. We consider the dual of this problem and note that it generalizes the traditional log-linear maximum entropy family of problems [Della Pietra et al., 2002]. We provide a simple and computationally efficient gradient-based optimization strategy for this family and show that only a small number of observations are required for accurate prediction and transfer of behavior. We conclude by considering a variety of experimental results, ranging from predicting travel routes in a synthetic routing game to a market-entry econometric data-analysis exploring regulatory effects on hotel chains in Texas.\nBefore we formalize imitation learning in matrix games, motivate our assumptions and describe and analyze our approach, we review related work."}, {"heading": "2 Related Work", "text": "Many research communities are interested in computational modeling of human behavior and, in particular, in modeling rational and strategic behavior with incomplete knowledge of utility. Here we contrast the contributions of three communities by overviewing their interests and approaches. We conclude by describing our contribution in the same light.\nThe econometrics community combines microeconomics and statistics\nto investigate the empirical properties of markets from sales records, census data and other publicly available statistics. McFadden first considered estimating consumer preferences for transportation by assuming them to be rational utility maximizers [McFadden, 1974]. Berry, Levinsohn and Pakes estimate both supply and demand-side preferences in settings where the firms must price their goods strategically [Berry et al., 1995]. Their initial work described a procedure for measuring the desirability of certain automobile criteria, such as fuel economy and features like air conditioning, to determine substitution effects.\nThe Berry, Levinsohn and Pakes approach and its derivatives can be crudely described as model-fitting techniques. First, a parameterized class of utility functions are assumed for both the producers and consumers. Variables that are unobservable to the econometrician, such as internal production costs and certain aspects of the consumer\u2019s preferences, are known as shocks and are modeled as independent random variables. The draws of these random variables are known to the market\u2019s participants, but only their distributions are known to the econometrician. Second, an equilibrium pricing model is assumed for the producers. The consumers are typically assumed to be utility maximizers having no strategic interactions with in the market. Finally, an estimation technique is optimistically employed to determine a set of parameter values that are consistent with the observed behavior. Ultimately, it is from these parameter values that one derives insight into the unobservable characteristics of the market. Unfortunately, neither efficient sample nor computational complexity bounds are generally available using this family of approaches.\nA variety of questions have been investigated by econometricians using this line of reasoning. Petrin investigated the competitive advantage of being the first producer in a market by considering the introduction of the minivan to the North American automotive industry [Petrin, 2002]. Nevo provided evidence against price-fixing in the breakfast cereal market by measuring the effects of advertising [Nevo, 2001]. Others have examined the mid-scale hotel market to determine the effects of different regulatory practices [Suzuki, 2010] and how overcapacity can be used to deter competition [Conlin and Kadiyali, 2006]. As a general theme, the econometricians are interested in the intentions that guide behavior. That is, the observed behavior is considered to be the truth and the decision-making framework used by the producers and consumers is known a priori.\nThe decision theory community is interested in human behavior on a more individual level. They, too, note that out-of-the-box game theory fails to explain how people act in many scenarios. As opposed to viewing\nthis as a flaw in the theories, they focus on both how to alter the games that model our interactions in addition to devising human-like decisionmaking algorithms. The former can be achieved through modifications to the players\u2019 utility functions, which are known a priori, to incorporate notions such as risk aversion and spite [Myers and Sadler, 1960, Erev et al., 2008]. latter approaches often tweak learning algorithms by integrating memory limitations or emphasizing recent or surprising observations [Camerer and Ho, 1999, Erev and Barron, 2005].\nthe Iterative Weighting and Sampling algorithm (I-SAW) is more likely to choose the action with the highest estimated utility, but recent observations are weighted more highly and, in the absence of a surprising observation, the algorithm favors repeating previous actions [Erev et al., 2010]. Memory limitations, or more generally bounded rationality, have also led to novel equilibrium concepts such as the quantal response equilibrium [McKelvey and Palfrey, 1995]. This concept assumes the players\u2019 strategies have faults, but that small errors, in terms of forgone utility, are much more common than large errors. Contrasting with the econometricians, the decision theory community is mainly interested in the algorithmic process of human decision-making. The players\u2019 preferences are known and observed behavior serves only to validate or inform an experimental hypothesis.\nFinally, the machine learning community is interested in predicting and imitating the behavior of humans and expert systems. Much work in this area focuses on the single-agent setting and in such cases it is known as inverse optimal control or inverse reinforcement learning [Abbeel and Ng, 2004, Ng and Russell, 2000]. Here, the observed behavior is assumed to be an approximately optimal solution to an unknown decision problem. At a high level, known solutions typically summarize the behavior as parameters to a low dimensional utility function. A number of methods have been introduced to learn these weights, including margin-based methods [Ratliff et al., 2006] that can utilize black box optimal control or planning software, as well as maximum entropy-based methods with desirable predictive guarantees [Ziebart et al., 2008a]. These utility weights are then used to mimic the behavior in similar situations through a decision-making algorithm. Unlike the other two communities, it is the predictive performance of the learned model that is most pivotal and noisy observations are expected and managed by those techniques.\nThis article extends our prior publication\u2014a novel maximum entropy approach for predicting behavior in strategic multi-agent domains [Waugh et al., 2011a,b]. We focus on the computationally and statistically efficient recovery of good estimates of behavior (the only observable quantity) by\nleveraging rationality assumptions. The work presented here further develops those ideas in two key ways. First, we consider distributions over games and parameterized families of deviations using the notion of conditional entropy. Second, this work enables more fine-grained assumptions regarding the players\u2019 possible preferences. Finally, this work presents the analysis of data-sets from both the econometric and decision theory communities, comparing and contrasting the methods presented with statistical methods that are blind to the strategic aspects of the domains.\nBefore describing our approach, we will introduce the necessary notation and background."}, {"heading": "3 Preliminaries", "text": ""}, {"heading": "Notation", "text": "Let V be a Hilbert space with an inner product \u3008\u00b7, \u00b7\u3009 : V \u00d7 V \u2192 R. For any set K \u2286 V , let K\u2217 = {x | \u3008x, y\u3009 \u2265 0,\u2200y \u2208 K} be its dual cone. We let \u2016v\u20162 = \u221a \u3008v, v\u3009, and, if V is of finite dimension with orthonormal basis\n{e1, . . . , eK}, let \u2016v\u20161 = \u2211K k=1 |\u03b1k| where v = \u2211K\nk=1 \u03b1kek. Typically, we will take V = RK and use the standard inner product."}, {"heading": "Game Theory", "text": "Matrix games are the canonical tool of game theorists for representing strategic interactions ranging from illustrative toy problems, such as the \u201cPrisoner\u2019s Dilemma\u201d and the \u201cBattle of the Sexes\u201d games, to important negotiations, collaborations, and auctions. Unlike the traditional definition [Osborne and Rubinstein, 1994], in this work we model games where only the features of the players\u2019 utility are known and not the utilities themselves.\nDefinition 1. A vector-valued normal-form game is a tuple \u0393 = (N ,A, u\u0393i ) where\n\u2022 N is the finite set of the game\u2019s N players,\n\u2022 A = \u00d7i\u2208NAi is the set of the game\u2019s outcomes or joint-actions, where\n\u2022 Ai is the finite set of actions or strategies for player i, and\n\u2022 u\u0393i : A \u2192 V is the utility feature function for player i.\nWe let A = maxi\u2208N |Ai|.\nPlayers aim to maximize their utility, a quantity measuring happiness or individual well-being. We assume that the players\u2019 utility is a common linear function of the utility features. This will allow us to treat the players anonymously should we so desire. One can expand the utility feature space if separate utility functions are desired. We write the utility for player i at outcome a under utility function w \u2208 V as\nu\u0393i (a|w) = \u3008u\u0393i (a), w\u3009.\nIn contrast to the standard definition of normal-form games, where the utility functions for game outcomes are known, in this work we assume that the true utility function, formed by w\u2217, which governs observed behavior, is unknown. This allows us to model real-world scenarios where a cardinal utility is not available or is subject to personal taste. Consider, for instance, a scenario where multiple drivers each choose a route among shared roads. Each outcome, which specifies a travel plan for all drivers, has a variety of easily measurable quantities that may impact the utility of a driver, such as travel time, distance, average speed, number of intersections and so on, but how these quantities map to utility depends on the internal preferences of the drivers.\nWe model the players using a joint strategy, \u03c3\u0393 \u2208 \u2206A, which is a distribution over the game\u2019s outcomes. Coordination between players can exist, thus, this distribution need not factor into independent strategies for each player. Conceptually, a trusted signaling mechanism, such as a traffic light, can be thought to sample an outcome from \u03c3\u0393 and communicate to each player ai, its portion of the joint-action. Even in situations where players are incapable of communication prior to play, correlated play is attainable through repetition. In particular, there are simple learning dynamics that, when employed by each player independently, converge to a correlated solution [Foster and Vohra, 1996, Hart and Mas-Colell, 2000].\nIf a player can benefit through a unilateral deviation from the proposed joint strategy, the strategy is unstable. As we are considering coordinated strategies, a player may condition its deviations on the recommended action. That is, a deviation for player i is a function fi : Ai \u2192 Ai [Blum and Mansour, 2007]. To ease the notation, we overload fi : A \u2192 A to be the function that modifies only player i\u2019s action according to fi.\nTwo well-studied classes of deviations are the switch deviation,\nswitchx\u2192yi (ai) = { y if ai = x ai otherwise,\nwhich substitutes one action for another, and the fixed deviation,\nfixed\u2192yi (ai) = y,\nwhich does not condition its change on the prescribed action. A deviation set, denoted \u03a6, is a set of deviation functions. We call the set of all switch deviations the internal deviation set, \u03a6int, and the set of all fixed deviations the external deviation set, \u03a6ext. The set \u03a6swap is the set of all deterministic deviations. Given that the other players indeed play their recommended actions, there is no strategic advantage to considering randomized deviations.\nThe benefit of applying deviation fi when the players jointly play a is known as instantaneous regret. We write the instantaneous regret features as\nr\u0393fi(a) = u \u0393 i (fi(a))\u2212 u\u0393i (a),\nand the instantaneous regret under utility function w as\nr\u0393fi(a|w) = u \u0393 i (fi(a)|w)\u2212 u\u0393i (a|w) = \u3008r\u0393fi(a), w\u3009.\nMore generally, we can consider broader classes of deviations than the two we have mentioned. Conceptually, a deviation is a strategy modification and its regret is its benefit to a particular player. As we will ultimately only work with the regret features, we can now suppress the implementation details while bearing in mind that a deviation typically has these prescribed semantics. That is, a deviation f \u2208 \u03a6 has associated instantaneous regret features, r\u0393f (\u00b7), and instantaneous regret, r\u0393f (\u00b7|w).\nAs a player is only privileged to its own portion of the coordinated outcome, it must reason about its expected regret. We write the expected regret features as\nr\u0393f (\u03c3 \u0393) = Ea\u223c\u03c3\u0393 [ r\u0393f (a) ] ,\nand the expected regret under utility function w as\nr\u0393f (\u03c3 \u0393|w) = Ea\u223c\u03c3\u0393 [ r\u0393f (a|w) ] = \u3008r\u0393f (\u03c3\u0393), w\u3009.\nA joint strategy is in equilibrium or, in a sense, stable if no player can benefit through a unilateral deviation. We can quantify this stability using expected regret with respect to the deviation set \u03a6,\nRegret\u0393\u03a6(\u03c3 \u0393|w) = max f\u2208\u03a6 r\u0393f (\u03c3 \u0393|w),\nand call a joint strategy \u03c3\u0393 an \u03b5-equilibrium if\nRegret\u0393\u03a6(\u03c3 \u0393|w) \u2264 \u03b5.\nThe most general deviation set, \u03a6swap, corresponds with the \u03b5-correlated equilibrium solution concept [Osborne and Rubinstein, 1994, Blum and Mansour, 2007]. Thus, regret can be thought of as the natural substitute for utility when assessing the optimality of behavior in multi-agent settings.\nThe set \u03a6swap is typically intractably large. Fortunately, internal regret closely approximates swap regret and is polynomially-sized in both the number of actions and players.\nLemma 1. If joint strategy \u03c3\u0393 has \u03b5 internal regret, then it is an A\u03b5correlated equilibrium under utility function w. That is, \u2200w \u2208 V ,\nRegret\u0393 \u03a6int (\u03c3\u0393|w) \u2264 Regret\u0393 \u03a6swap(\u03c3 \u0393|w) \u2264 A \u00b7 Regret\u0393 \u03a6int (\u03c3\u0393|w).\nThe proof is provided in the Appendix."}, {"heading": "4 Behavior Estimation in a Matrix Game", "text": "We are now equipped with the tools necessary to introduce our approach for imitation learning in multi-agent settings. We start by assuming a notion of rationality on the part of the game\u2019s players. By leveraging this assumption, we will then derive an estimation procedure with much better statistical properties than methods that are unaware of the game\u2019s structure."}, {"heading": "4.1 Rationality and the ICE Polytope", "text": "Let {at}Tt=1 be a sequence of T independent observations of behavior in game \u0393 distributed according to \u03c3\u0393, the players\u2019 true behavior. We call the empirical distribution of the observations, \u03c3\u0303\u0393, the demonstrated behavior.\nWe aim to learn a distribution \u03c3\u0302\u0393, called the predicted behavior, an estimation of the true behavior from these demonstrations. Moreover, we would like our learning procedure to extract the motives for the behavior so that we may imitate the players in similarly structured, but unobserved games. Initially, let us consider just the estimation problem. While deriving our method, we will assume we have access to the players\u2019 true behavior. Afterwards, we will analyze the error introduced by approximating from the demonstrations.\nImitation appears hard barring further assumptions. In particular, if the agents are unmotivated or their intentions are not coerced by the observed game, there is little hope of recovering principled behavior in a new game. Thus, we require a form of rationality.\nProposition 1. The players in a game are rational with respect to deviation set \u03a6 if they prefer joint-strategy \u03c3\u0393 over joint strategies \u03c3\u0301\u0393 when\nRegret\u0393\u03a6(\u03c3 \u0393|w\u2217) < Regret\u0393\u03a6(\u03c3\u0301\u0393|w\u2217).\nOur rationality assumption states that the players are driven to minimize their regret. It is not necessarily the case that they indeed have low or no regret, but simply that they can evaluate their preferences and that they prefer joint strategies with low regret. Through this assumption, we will be able to reason about the players\u2019 behavior solely through the game\u2019s features; this is what leads to the improved statistical properties of our approach.\nAs agents\u2019 true preferences w\u2217 are unknown, we consider an encompassing assumption that requires that estimated behavior satisfy this property for all possible utility weights. A prediction \u03c3\u0302\u0393 is strongly rational with respect to deviation set \u03a6 if\n\u2200w \u2208 V, Regret\u0393\u03a6(\u03c3\u0302\u0393|w) \u2264 Regret\u0393\u03a6(\u03c3\u0393|w).\nThis assumption is similar in spirit to the utility matching assumption employed by inverse optimal control techniques in single-agent settings. As in those settings, we have an if and only if guarantee relating rationality and strong rationality [Abbeel and Ng, 2004, Ziebart et al., 2008a].\nTheorem 1. If a prediction \u03c3\u0302\u0393 is strongly rational with respect to deviation set \u03a6 and the players are rational with respect to \u03a6, then they do not prefer \u03c3\u0393 over \u03c3\u0302\u0393.\nThis is immediate as w\u2217 \u2208 V . Phrased another way, a strongly rational prediction is no worse than the\ntrue behavior.\nCorollary 1. If a prediction \u03c3\u0302\u0393 is strongly rational with respect to deviation set \u03a6 and the true behavior is an \u03b5-equilibrium with respect to \u03a6 under utility function w\u2217 \u2208 V , then \u03c3\u0302\u0393 is also an \u03b5-equilibrium.\nAgain, the proof is immediate as Regret\u0393\u03a6(\u03c3\u0302 \u0393|w\u2217) \u2264 Regret\u0393\u03a6(\u03c3\u0393|w\u2217) \u2264 \u03b5.\nConversely, if we are uncertain about the true utility function we must assume strong rationality or we risk predicting less desirable behavior.\nTheorem 2. If a prediction \u03c3\u0302\u0393 is not strongly rational with respect to deviation set \u03a6 and the players are rational, then there exists a w\u2217 \u2208 V such that \u03c3\u0393 is preferred to \u03c3\u0302\u0393.\nThe proof follows from the negation of the definition of strong rationality. By restricting our attention to strongly rational behavior, at worst agents acting according to their unknown true preferences will be indifferent between our predictive distribution and their true behavior. That is, strong rationality is necessary and sufficient under the assumption players are rational given no knowledge of their true utility function.\nUnfortunately, a direct translation of the strong rationality requirement into constraints on the distribution \u03c3\u0302\u0393 leads to a non-convex optimization problem as it involves products of varying utility vectors with the behavior to be estimated. Fortunately, we can provide an equivalent concise convex description of the constraints on \u03c3\u0302\u0393 that ensures any feasible distribution satisfies strong rationality. We denote this set of equivalent constraints as the Inverse Correlated Equilibria (ICE) polytope.\nDefinition 2 (Standard ICE Polytope).\nr\u0393f (\u03c3\u0302 \u0393) = Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393) ] , \u2200f \u2208 \u03a6\n\u03b7f \u2208 \u2206\u03a6f , \u2200f \u2208 \u03a6 \u03c3\u0302\u0393 \u2208 \u2206A.\nHere, we have introduced \u03a6f , the set of deviations that f will be compared against. Our rationality assumption corresponds to when \u03a6f = \u03a6, but there are different choices that have reasonable interpretations as alternative rationality assumptions. For example, if each switch deviation is compared only against switches for the same player\u2014a more restrictive condition\u2014 then the quality of the equilibrium is measured by the sum of all players\u2019 regrets, as opposed to only the one with the most regret.\nThe following corollary equates strong rationality and the standard ICE polytope.\nCorollary 2. A prediction \u03c3\u0302\u0393 is strongly rational with respect to deviation set \u03a6 if and only if for all f \u2208 \u03a6 there exists \u03b7f \u2208 \u2206\u03a6 such that \u03c3\u0302\u0393 and \u03b7 satisfy the standard ICE polytope.\nWe now show a more general result that implies Corollary 2. We start by generalizing the notion of strong rationality by restricting w\u2217 to be in\na known set K \u2286 V . We say a prediction \u03c3\u0302\u0393 is K-strongly rational with respect to deviation set \u03a6 if\n\u2200w \u2208 K, Regret\u0393\u03a6(\u03c3\u0302\u0393|w) \u2264 Regret\u0393\u03a6(\u03c3\u0393|w).\nIf K is convex with non-empty relative interior and 0 \u2208 K, we derive the K-ICE polytope.\nDefinition 3 (K-ICE Polytope).\nr\u0393f (\u03c3\u0302 \u0393)\u2212 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393) ] \u2208 \u2212K\u2217, \u2200f \u2208 \u03a6\n\u03b7f \u2208 \u2206\u03a6f , \u2200f \u2208 \u03a6 \u03c3\u0302\u0393 \u2208 \u2206A.\nNote that the above constraints are linear in \u03c3\u0302\u0393 and \u03b7f , and K\u2217, the dual cone, is convex. The following theorem shows the equivalence of the K-ICE polytope and K-strong rationality.\nTheorem 3. A prediction \u03c3\u0302\u0393 is K-strongly rational with respect to deviation set \u03a6 if and only if for all f \u2208 \u03a6 there exists \u03b7f \u2208 \u2206\u03a6 such that \u03c3\u0302\u0393 and \u03b7 satisfy the K-ICE polytope.\nThe proof is provided in the Appendix. By choosing K = V , then K\u2217 = {0} and the polytope reduces to the standard ICE polytope. Thus, Corollary 2 follows directly from Theorem 3. By choosing K to be the positive orthant, K = K\u2217 = RK+ , the polytope reduces to the following inequalities. Here, we explicitly assume the utility to be a positive linear function of the features.\nDefinition 4 (Positive ICE Polytope).\nr\u0393f (\u03c3\u0302 \u0393) \u2264 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393) ] , \u2200f \u2208 \u03a6\n\u03b7f \u2208 \u2206\u03a6f , \u2200f \u2208 \u03a6 \u03c3\u0302\u0393 \u2208 \u2206A.\nPredictive behavior within the ICE polytope will retain the quality of the demonstrations provided. The following corollaries formalize this guarantee.\nCorollary 3. If the true behavior is an \u03b5-correlated equilibrium under w\u2217 in game \u0393, then a prediction \u03c3\u0302\u0393 that satisfies the standard ICE polytope where \u03a6 = \u03a6swap and \u2200f \u2208 \u03a6,\u03a6f = \u03a6 is also an \u03b5-correlated equilibrium.\nThis follows immediately from the definition of an approximate correlated equilibrium.\nCorollary 4. If the true behavior is an \u03b5-correlated equilibrium under w\u2217 in game \u0393, then a prediction \u03c3\u0302\u0393 that satisfies the standard ICE polytope where \u03a6 = \u03a6int and \u2200f \u2208 \u03a6,\u03a6f = \u03a6 is also an A\u03b5-correlated equilibrium.\nThis follows immediately from Lemma 1. In two-player constant-sum games, we can make stronger statements about our predictive behavior. In particular, when these requirements are satisfied we may reason about games without coordination. That is, each player chooses their action independently using their strategy, \u03c3\u0393i a distribution over Ai. A strategy profile \u03c3\n\u0393 consists of a strategy for each player. It defines a joint-strategy with no coordination between the players.\nA game is constant-sum if there is a fixed amount of utility divided among the players. That is, if there is a constant C such that \u2200a \u2208 A,\u2211\ni\u2208N u\u0393i (a|w\u2217) = C.\nIn settings where the players act independently, we use external regret to measure a profile\u2019s stability, which corresponds with the famous Nash equilibrium solution concept [Osborne and Rubinstein, 1994]. By using the ICE polytope with external regret, we can recover a Nash equilibrium if one is demonstrated in a constant-sum game.\nTheorem 4. If the true behavior is an \u03b5-Nash equilibrium in a two-player constant-sum game \u0393, then the marginal strategies formed from a prediction \u03c3\u0302\u0393 that satisfies the standard ICE polytope where \u03a6 = \u03a6ext and \u2200f \u2208 \u03a6,\u03a6f = \u03a6 is a 2\u03b5-Nash equilibrium.\nThe proof is provided in the Appendix. In general, there can be infinitely many correlated equilibrium with vastly different properties. One such property that has received much attention is the social welfare of a joint strategy, which refers to the total utility over all players. Our strong rationality assumption states that the players have no preference on which correlated equilibrium is selected, and thus without modification cannot capture such a concept should it be demonstrated. We can easily maintain the social welfare of the demonstrations by additionally preserving the players\u2019 utilities along side the constraints prescribed by the ICE polytope. A joint strategy is utility-preserving under all utility functions if\n\u2200w \u2208 V, i \u2208 N , u\u0393i (\u03c3\u0302\u0393|w) = u\u0393i (\u03c3\u0393|w).\nAs with the correspondence between strong rationality and the ICE polytope, utility preservation can be represented as a set of linear equality constraints. These utility feature matching constraints are exactly the basis of many methods of inverse optimal control [Abbeel and Ng, 2004, Ziebart et al., 2008a].\nTheorem 5. A joint strategy is utility-preserving under all utility functions if and only if\ni \u2208 N , u\u0393i (\u03c3\u0302\u0393) = u\u0393i (\u03c3\u0393).\nThe proof is due to Abbeel and Ng [2004]. A notable choice for \u03a6f is we compare each deviation only to itself. As a consequence this enforces a stronger constraint that the regret under each deviation, and in turn the overall regret, is the same under our prediction and the demonstrations. That is, \u03c3\u0302\u0393 is regret-matching as for all w \u2208 V ,\nRegret\u0393\u03a6(\u03c3\u0302 \u0393|w) = Regret\u0393\u03a6(\u03c3\u0393|w).\nThus, regret-matching preserves the equilibrium qualities of the demonstrations.\nUnlike the correspondence between the ICE polytope and strong rationality, matching the regret features for each deviation is not required for a strategy to match the regrets of the demonstrations. That is, the converse does not hold.1\nTheorem 6. A prediction \u03c3\u0302\u0393 matches the regret of \u03c3\u0393 for all w \u2208 V does not necessarily match the regret features of \u03c3\u0393.\nWe use both utility and regret matching in our final set of experiments. The former for predictive reasons, the latter to allow for the use of smooth minimization techniques."}, {"heading": "4.2 The Principle of Maximum Entropy", "text": "As we are interested in the problem of statistical prediction of strategic behavior, we must find a mechanism to resolve the ambiguity remaining after accounting for the rationality constraints. The principle of maximum\n1We may sketch a simple counterexample. Consider a game with one player and three actions, x, y and y\u2032, where the utility for playing x is zero, and the utility for playing either y or y\u2032 is one. If the true behavior always plays y, then matching the regret features will force the prediction to also play y. Predicting y\u2032 also matches the regret, though.\nentropy, due to Jaynes [1957], provides a well-justified method for choosing such a distribution. This choice leads to not only statistical guarantees on the resulting predictions, but to efficient optimization.\nThe Shannon entropy of a joint-strategy \u03c3\u0393 is H\u0393(\u03c3\u0393) = Ea\u223c\u03c3\u0393 [ \u2212 log \u03c3\u0393(a) ] ,\nand the principle of maximum entropy advocates choosing the distribution with maximum entropy subject to known constraints [Jaynes, 1957]. That is,\n\u03c3MaxEnt = argmax \u03c3\u0393\u2208\u2206A\nH\u0393(\u03c3\u0393), subject to:\ng(\u03c3\u0393) = 0 and h(\u03c3\u0393) \u2264 0.\nThe constraint functions, g and h, are typically chosen to capture the important or most salient characteristics of the distribution. When those functions are affine and convex respectively, finding this distribution is a convex optimization problem. The resulting log-linear family of distributions (e.g., logistic regression, Markov random fields, conditional random fields) are widely used within statistical machine learning.\nIn the context of multi-agent behavior, the principle of maximum entropy has been employed to obtain correlated equilibria with predictive guarantees in normal-form games when the utilities are known a priori [Ortiz et al., 2007]. We will now leverage its power with our rationality assumption to select predictive distributions in games where the utilities are unknown, but the important features that define them are available.\nFor our problem, the constraints are precisely that the distribution is in the ICE polytope, ensuring that whatever we predict has no more regret than the demonstrated behavior.\nDefinition 5. The primal maximum entropy ICE optimization problem is\nmaximize \u03c3\u0302\u0393,\u03b7\nH\u0393(\u03c3\u0302\u0393) subject to:\nr\u0393f (\u03c3\u0302 \u0393)\u2212 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393) ] \u2208 \u2212K\u2217, \u2200f \u2208 \u03a6\n\u03b7f \u2208 \u2206\u03a6f , \u2200f \u2208 \u03a6 \u03c3\u0302\u0393 \u2208 \u2206A.\nThis program is convex, feasible, and bounded. That is, it has a solution and is efficiently solvable using simple techniques in this form.\nImportantly, the maximum entropy prediction enjoys the following guarantee:\nLemma 2. The maximum entropy ICE distribution minimizes over all strongly rational distributions the worst-case log-loss, Ea\u223c\u03c3\u0393 [ \u2212 log2 \u03c3\u0302\u0393(a) ] , when \u03c3\u0393 is chosen adversarially but subject to strong rationality.\nThe proof of Lemma 2 follows immediately from the result of Gru\u0308nwald and Dawid [2003]."}, {"heading": "4.3 Dual Optimization", "text": "In this section, we will derive and describe a procedure for optimizing the dual program for solving the MaxEnt ICE optimization problem. We will see that the dual multipliers can be interpreted as utility vectors and that optimization in the dual has computational advantages. We begin by presenting the dual program.\nTheorem 7. The dual maximum entropy ICE optimization problem is the following non-smooth, but convex program:\nminimize \u03b8f\u2208K\u2217\u2217 \u2211 f\u2208\u03a6 Regret\u0393\u03a6f (\u03c3 \u0393|\u03b8f ) + logZ\u0393(\u03b8), where\nZ\u0393(\u03b8) = \u2211 a\u2208A exp \u2212\u2211 f\u2208\u03a6 r\u0393f (a|\u03b8f )  . We derive the dual in the Appendix. As the dual\u2019s feasible set has non-empty relative interior, strong duality holds by Slater\u2019s condition\u2014there is no duality gap. We can also use a dual solution to recover \u03c3\u0302\u0393.\nLemma 3. Strong duality holds for the maximum entropy ICE optimization problem and given optimal dual weights \u03b8\u2217, the maximum entropy ICE jointstrategy \u03c3\u0302\u0393 is\n\u03c3\u0302\u0393(a) \u221d exp \u2212\u2211 f\u2208\u03a6 r\u0393f (a|\u03b8\u2217f )  . (1) The dual formulation of our program has important inherent computational advantages. First, so long as K is simple, the optimization is particularly well-suited for gradient-based optimization, a trait not shared by the primal program. Second, the number of dual variables, |\u03a6|dimV , is typically much fewer than the number of primal variables, |A| + |\u03a6|2. Though\nAlgorithm 1 Dual MaxEnt ICE Gradient\nInput: Let \u03c3\u0302\u0393 be the prediction given the current dual weights, \u03b8, as from Equation (1). for f \u2208 \u03a6 do f\u2217 \u2190 argmaxf \u2032\u2208\u03a6f r \u0393 f \u2032(\u03c3\n\u0393|\u03b8f ) gf \u2190 r\u0393f\u2217(\u03c3\u0393)\u2212 r\u0393f (\u03c3\u0302\u0393)\nend for return g\nthe work per iteration is still a function of |A| (to compute the partition function), these two advantages together let us scale to larger problems than if we consider optimizing the primal objective. Computing the expectations necessary to descend the dual gradient can leverage recent advances in the structured, compact game representations: in particular, any graphical game with low-treewidth or finite horizon Markov game [Kakade et al., 2003] enables these computations to be performed in time that scales only polynomially in the number of decision makers.\nAlgorithm 1 describes the dual gradient computation. This can be incorporated with any non-smooth gradient method, such as the projected subgradient method [Shor, 1985], to approach the optimum dual weights."}, {"heading": "5 Behavior Estimation in Parameterized Matrix", "text": "Games\nTo account for stochastic, or varying environments, we now consider distributions over games. For example, rain may affect travel time along some routes and make certain modes of transportation less desirable, or even unavailable. Operationally, nature samples a game prior to play from a distribution known to the players. The players then as a group determine a joint strategy conditioned on the particular game and an outcome is drawn by a coordination device. We let G denote our class of games.\nAs before, we observe a sequence of T independent observations of play, but now in addition to an outcome we also observe nature\u2019s choice at each time t. Let {(\u0393t, at)}Tt=1 be the aforementioned sequence of observations drawn from \u03be and \u03c3, the true behavior. The empirical distribution of the observations, \u03be\u0303 and \u03c3\u0303, together are the demonstrated behavior.\nNow we aim to learn a predictive behavior distribution, \u03c3\u0302\u0393, for any \u0393 \u2208 G, even ones we have not yet observed. Clearly, we must leverage the\nobservations across the entire family to achieve good predictive accuracy. We continue to assume that the players\u2019 utility is an unknown linear function, w\u2217, of the games\u2019 features and that this function is fixed across G. Next, we amend our notion of regret and our rationality assumption."}, {"heading": "5.1 Behavior Estimation through Conditional ICE", "text": "Ultimately, we wish to simply employ an additional expectation over the game distribution when reasoning about the regret and regret features. To do this, our notion of a deviation needs to account for the fact that it may be executed in games with different structures. Operationally, one way to achieve this is by having a deviation not act when it is applied to such a game, which increases the size of \u03a6 by a factor of |G|. If the actions, and in turn the deviations, have similar semantic meanings across our entire family of games, one can simply share the deviations across all games. This allows for one to achieve transfer over an infinitely large class. Given such a decision, we write the expected regret features under deviation f as\nr\u03bef (\u03c3) = E\u0393\u223c\u03be [ r\u0393f (\u03c3 \u0393) ] ,\nand the expected regret under utility function w as r\u03bef (\u03c3|w) = E\u0393\u223c\u03be [ r\u0393f (\u03c3 \u0393|w) ] .\nAgain, we quantify the stability of a set of joint strategies using this new notion of expected regret with respect to the deviation set \u03a6,\nRegret\u03be\u03a6(\u03c3|w) = maxf\u2208\u03a6 r \u03be f (\u03c3|w),\nwhich, in turn, entails a notion of an \u03b5-equilibrium for a set of joint strategies, a modified rationality assumption, and a slight modification to the K-ICE polytope,\nDefinition 6 (Conditional K-ICE Polytope). r\u03bef (\u03c3\u0302)\u2212 Eg\u223c\u03b7f [ r\u03beg(\u03c3) ] \u2208 \u2212K\u2217, \u2200f \u2208 \u03a6\n\u03b7f \u2208 \u2206\u03a6f , \u2200f \u2208 \u03a6 \u03c3\u0302\u0393 \u2208 \u2206A. \u2200\u0393 \u2208 G\nAll that remains is to adjust our notion of entropy to take into account a distribution over games. In particular, we choose to maximize the expected entropy of our prediction, which is conditioned on the game sampled by chance.\nDefinition 7. The conditional Shannon entropy of a set of strategies \u03c3 when games are distributed according to \u03be is\nH\u03be(\u03c3) = E\u0393\u223c\u03be [ H\u0393(\u03c3\u0393) ] .\nThe modified dual optimization problem has a familiar form. We now use the new notion of regret and take the expected value of the log partition function.\nTheorem 8. The dual conditional maximum entropy ICE optimization problem is\nminimize \u03b8f\u2208K\u2217\u2217 \u2211 f\u2208\u03a6 Regret\u03be\u03a6f (\u03c3|\u03b8f ) + E\u0393\u223c\u03be [ logZ\u0393(\u03b8) ] .\nTo recover the predicted behavior for a particular game, we use the same exponential family form as before.\nAs with any machine learning technique, it is advisable to employ some form of complexity control on the resulting predictor to prevent over-fitting. As we now wish to generalize to unobserved games, we too should take the appropriate precautions. In our experiments, we employ L1 and L2 regularization terms to the dual objective for this purpose. Regularization of the dual weights effectively alters the primal constraints by allowing them to hold approximately, leading to higher entropy solutions [Dud\u0301\u0131k et al., 2007]."}, {"heading": "5.2 Behavior Transfer without common deviations", "text": "A principal justification of inverse optimal control techniques that attempt to identify behavior in terms of utility functions is the ability to consider what behavior might result if the underlying decision problem were changed while the interpretation of features into utilities remain the same [Ng and Russell, 2000, Ratliff et al., 2006]. This enables prediction of agent behavior in a no-regret or agnostic sense in problems such as a robot encountering novel terrain [Silver et al., 2010] as well as route recommendation for drivers traveling to unseen destinations [Ziebart et al., 2008b].\nEconometricians are interested in similar situations, but for much different reasons. Typically, they aim to validate a model of market behavior from observations of product sales. In these models, the firms assume a fixed pricing policy given known demand. The econometrician uses this fixed policy along with product features and sales data to estimate or bound both the consumers\u2019 utility functions as well as unknown production parameters,\nlike markup and production cost [Berry et al., 1995, Nevo, 2001]. In this line of work, the observed behavior is considered accurate to start with; it is unclear how suitable these methods are for settings with limited or noisy observations.\nIn our prior work, we introduced an approach to behavior transfer applicable between games with different action sets [Waugh et al., 2011a]. It is based off the assumption of transfer rationality, or for two games \u0393 and \u0393\u0301 and some constant \u03ba > 0,\n\u2200w \u2208 V, Regret\u0393\u0301\u03a6(\u03c3\u0302\u0393|w) \u2264 \u03baRegret\u0393\u03a6(\u03c3\u0393|w).\nRoughly, we assume that under preferences with low regret in the original game, the behavior in the unobserved game should also have low regret. By enforcing this property, if the agents are performing well with respect to their true preferences, then the transferred behavior will also be of high quality.\nAssuming transfer rationality is equivalent to using the conditional ICE estimation program with differing game distributions for the predicted and demonstrated regret features. In such a case, the program is not necessarily feasible and the constraints must be relaxed. For example, a slack variable may be added to the primal, or through regularization in the dual. We note that this requires the estimation program to be run at test time."}, {"heading": "6 Sample Complexity", "text": "In practice, we do not have full access to the agents\u2019 true behavior\u2014if we did, prediction would be straightforward and we would not require our estimation technique. Instead, we may only approximate the desired expectations by averaging over a finite number of observations,\nr\u03be\u0303f (\u03c3\u0303|w) \u2248 1\nT T\u2211 t=1 r\u0393 t f (a t|w).\nIn real applications there are costs associated with gathering these observations and, thus, there are inherent limitations on the quality of this approximation. Next, we will analyze the sensitivity of our approach to these types of errors.\nFirst, although |A| is exponential in the number of players, our technique only accesses \u03c3\u0303 through expected regret features of the form r\u03be\u0303f (\u03c3\u0303). That is, we need only approximate these features accurately, not the distribution\n\u03c3. For finite-dimensional vector spaces, we can bound how well the regrets match in terms of |\u03a6| and the dimension of the space.\nTheorem 9. With probability at least 1 \u2212 \u03b4, for any w, by observing T \u2265 1\n2 2 log 2|\u03a6| dimV\u03b4 outcomes we have for all deviations r \u03be\u0303 f (\u03c3\u0303|w) \u2264 r \u03be f (\u03c3|w) +\n\u2206\u2016w\u20161.\nwhere \u2206 is the maximum possible regret over all basis directions. The proof is an application of the union bound and Hoeffding\u2019s inequality and is provided in the Appendix.\nAlternatively, we can bound how well the regrets match independently of the space\u2019s dimension by considering each utility function separately.\nTheorem 10. With probability at least 1\u2212 \u03b4, for any w, by observing T \u2265 1\n2 2 log |\u03a6|\u03b4 outcomes we have for all deviations r \u03be\u0303 f (\u03c3\u0303|w) \u2264 r \u03be f (\u03c3|w) + \u2206(w).\nwhere \u2206(w) is the maximum possible regret under w. Again, the proof is in the Appendix.\nBoth of the above bounds imply that, so long as the true utility function is not too complex, with high probability we need only logarithmic many samples in terms of |\u03a6| and dimV to closely approximate r\u03bef (\u03c3) and avoid a large violation of our rationality condition.\nTheorem 11. If for all f , r\u03be\u0303f (\u03c3\u0303|w) \u2264 r \u03be f (\u03c3|w) + \u03b3, then Regret \u03be\u0303 \u03a6(\u03c3\u0303|w) \u2264 Regret\u03be\u03a6(\u03c3|w) + \u03b3.\nProof. For all deviations, f \u2208 \u03a6, r\u03be\u0303f (\u03c3\u0303|w) \u2264 r \u03be f (\u03c3|w)+\u03b3 \u2264 Regret \u03be \u03a6(\u03c3|w)+\u03b3. In particular, this holds for the deviation that maximizes the demonstrated regret."}, {"heading": "7 Experimental Results", "text": ""}, {"heading": "7.1 Synthetic Routing Game", "text": "To evaluate our approach experimentally, we first consider a simple synthetic routing game. Seven drivers in this game choose how to travel home during rush hour after a long day at the office. The different road segments have varying capacities that make some of them more or less susceptible to congestion. Upon arrival home, the drivers record the total time and distance they traveled, the fuel that they used, and the amount of time they spent stopped at intersections or in congestion\u2014their utility features.\nIn this game, each of the drivers chooses from four possible routes, yielding over 16, 000 possible outcomes. We obtained an \u03b5-social welfare maximizing correlated equilibrium for those drivers using a subgradient method where the drivers preferred mainly to minimize their travel time, but were also slightly concerned with fuel cost. The demonstrated behavior \u03c3\u0303\u0393 was sampled from this true behavior distribution \u03c3\u0393.\nIn Figure 1 we compare the prediction accuracy of MaxEnt ICE, measured using log loss, Ea\u223c\u03c3\u0393 [ \u2212 log2 \u03c3\u0302\u0393(a) ] , against a number of baselines by varying the number of observations sampled from the \u03b5-equilibrium. The baseline algorithms are: a smoothed multinomial distribution over the jointactions, a logistic regression classifier parameterized with the outcome utilities, and a maximum entropy inverse optimal control approach [Ziebart et al., 2008a] trained individually for each player.\nIn Figure 1, we see that MaxEnt ICE predicts behavior with higher accuracy than all other algorithms when the number of observations is limited. In particular, it achieves close to its best performance with only 16 observations. The maximum likelihood estimator eventually overtakes it, as expected since it will ultimately converge to \u03c3\u0393, but only after 10, 000 observations, or close to as many observations as there are outcomes in the game. MaxEnt ICE cannot learn the true behavior exactly in this case without\nadditional constraints due to the social welfare criteria the true behavior optimizes. That is, our rationality assumption does not hold in this case. We note that the logistic regression classifier and the inverse optimal control techniques perform better than the multinomial under low sample sizes, but they fail to outperform MaxEnt ICE due to their inability to appreciate the strategic nature of the game.\nNext, we evaluate behavior transfer from this routing game to four similar games, the results of which are displayed in Table 1. The first game, Add Highway, adds a new route to the game. That is, we simulate the city building a new highway. The second game, Add Driver, adds another driver to the game. The third game, Gas Shortage, keeps the structure of the game the same, but changes the reward function to make gas mileage more important to the drivers. The final game, Congestion, simulates adding construction to the major roadway, delaying the drivers. Here, we do not share deviations across the training and test game and we add a slack variable in the primal to ensure feasibility.\nThese transfer experiments even more directly demonstrate the benefits of learning utility weights rather than directly learning the joint-action distribution; direct strategy-learning approaches are incapable of being applied to general transfer setting. Thus, we can only compare against the Logistic Regression. We see from Table 1 that MaxEnt ICE outperforms the Logistic Regression in all of our tests. For reference, in these new games, the uniform strategy has a loss of approximately 6.8 in all games, and the true behavior has a loss of approximately 2.7.\nThese experiment demonstrates that learning underlying utility functions to estimate observed behavior can be much more data-efficient for small sample sizes. Additionally, it shows that the regret-based assumptions of MaxEnt ICE are beneficial in strategic settings, even though our rationality assumption does not hold in this case."}, {"heading": "7.2 Market Entry Game", "text": "We next evaluate our approach against a number of baselines on data gathered for the Market Entry Prediction Competition [Erev et al., 2010]. The game has four players and is repeated for fifty trials and is meant to simulate a firm\u2019s decision to enter into a market. On each round, all four players simultaneous decide whether or not to open a business. All players who enter the market receive a stochastic payoff centered at 10\u2212 kE, where k is a fixed parameter unknown to the players and E is the number of players who entered. Players who do not enter the market receive a stochastic payoff with zero mean. After each round, each player is shown their reward, as well as the reward they would have received by choosing the alternative.\nObservations of human play were gathered by the CLER lab at Harvard [Erev et al., 2010]. Each student involved in the experiment played ten games lasting fifty rounds each. The students were incentivized to play well through a monetary reward proportional to their cumulative utility. The parameter k was randomly selected in a fashion so that the Nash equilibrium had an entry rate of 50% in expectation. In total, 30, 000 observations of play were recorded. The intent of the competition was to have teams submit programs that would play in a similar fashion to the human subjects. That is, the data was used at test time to validate performance. In contrast, our experiments use actual observations of play at training time to build a predictive model of the human behavior. As we are interested in stationary behavior, we train and test on only the last twenty five trials of each game.\nWe compared against two baselines. The first baseline, labeled Multinomial in the figures, is a smoothed multinomial distribution trained to minimize the leave-one-out cross validation loss. This baseline does not make use of any features of the games. That is, if the players indeed play according to the Nash equilibrium we would expect this baseline to learn the uniform distribution. The second baseline, labeled Logistic Regression in the figures, simply uses regularized logistic regression to learn a linear classification boundary over the outcomes of the game using the same features presented to our method. Operationally, this is equivalent to using MaxEnt Inverse Optimal Control in a single-agent setting where the utility is summed across all the players. This baseline has similar representational power to our method, but lacks an understanding of the strategic elements of the game.\nIn Figure 2, we see a comparison of our method against the baselines when only the game\u2019s true expected utility is used as the only feature. We see that our method outperforms both baselines across all sample sizes. We\nalso observe the multinomial distribution performs slightly better than the uniform distribution, which attains a log loss of 4, though substantially worse than logistic regression and our method, indicating that the human players are not particularly well-modeled by the Nash equilibrium. Our method substantially outperforms logistic regression, indicating that there is indeed a strategic interaction that is not captured in the utility features alone.\nIn Figure 3, we see a comparison of our method against the baselines using a variety of predictive features. In particular, we summarize a round using the observed action frequencies, average reward, and reward variance up to that point in the round. To weigh recent observations more strongly, we also employ exponentially-weighted averages. We observe that the use of these features substantially improves the predictive power of the featurebased methods. Interestingly, we also note that the addition of these summary features also narrows the gap between logistic regression and MaxEnt ICE. Under low sample sizes, the logistic model performs the best, but our method overtakes it as more data is made available for training. It appears that in this scenario, much of the strategic behavior demonstrated by the participants can be captured by these history features."}, {"heading": "7.3 Mid-scale Hotel Market Entry", "text": "For our final experimental evaluation, we considered the task of predicting the behavior of mid-scale hotel chains, like Holiday Inn and Ramada, in the state of Texas. Given demographic and regulatory features of a county, we wish to predict if each chain is likely to open a new hotel or to close an existing one. The observations of play are derived from quarterly tax records over a fifteen year period from forty counties, amounting to a total of 2, 205 observations. The particular counties selected had records of all of the demographic and regulatory features, had at least four action observations, and none was a chain\u2019s flagship county. Figure 4 highlights the selected counties and visualizes their regulatory practices.\nThe demographic and regulatory features were aggregated from various sources and generously provided to us by Prof. Junichi Suzuki (2010). The demographic features for each county include quantities such as size of its population and its area, employment and household income statistics, as well as the presence or absence of an interstate, airport or national park. The regulatory features are indices measuring quantities such as commercial land zoning restrictions, tax rates and building costs. In addition to these noted features, which are fixed across all time periods, there are time-varying features such as the number of hotels and rooms for each chain and the\naggregate quarterly income. We model each quarterly decision as a parameterized simultaneous-move game with six players. Each player, a mid-scale hotel chain, has the action set {Close,NoAction,Open}, resulting in 729 total outcomes. For the game\u2019s utility, we allocated the county\u2019s features to each player in proportion to how many hotels they owned. That is, if a player operated 3 out of 10 hotels, the features associated with utility at that outcome would be the county\u2019s feature vector scaled by 0.3. We included bias features associated with each action to account for fixed costs associated with opening or closing a hotel.\nIn the observation data, there are a small number of instances where a chain opens or closes more than one hotel during a quarter. These events are mapped to Open and Close respectively. Though the outcome-space is quite large, the outcome distribution is extremely biased and the actions of the chains are highly correlated. In particular, over 80% of time the time no action is taken, around 17% of the time a single chain acts, and less than 3% of the time more than one chain acts. As a result, one expects the featureless multinomial estimator to have reasonable performance despite a large number of classes.\nFor experimentation, we evaluated four algorithms: a smoothed multi-\nnomial distribution trained to minimize the leave one out cross-validation loss, MaxEnt inverse optimal control trained once for all players, multi-class logistic regression over the joint action space, and regret-matching ICE with utility matching constraints. As the resulting optimizations for the latter two algorithms are smooth, we employed the L-BFGS quasi-Newton method with L2-regularization for training [Nocedal, 1980]. As a substitute for L1regularization, we selected the 23 best features based on their reduction in training error when using logistic regression. Each county had 63 features available. Of the top 23 features selected, 11 were regulatory indices.\nFor the logistic regression and ICE predictors, we only used utility features on the 13 high probability outcomes (no firms build, and one firm acting). The remaining outcomes had only bias features associated with them to help prevent overfitting. We experimented with a number of types of bias features, for example, 4 bias features (one for no firms build, one for a single firm builds, one for a single firm closes and one for all remaining outcomes), as well as 729 bias features (one for each outcome). We found that, though on their own the different bias features had varied predictive performance, when combined with utility and regret features they were quite similar given the appropriate regularization. In the best performing model, which we present here, we used 729 bias features resulting in 1, 028 parameters to the logistic regression model.\nIn the ICE predictor, we tied together the weights for each deviation across all the players to reduce the number of model parameters. For example, all players shared the same dual parameters for the NoAction\u2192 Open deviation. Effectively, this alters the rationality assumption such that the average regret across all players is the quantity of interest, instead of the maximum regret. Operationally, this is implemented as summing each deviation\u2019s gradient in the dual. This treats the players anonymously, thus we implicitly and incorrectly assume that conditioned on the county\u2019s parameters each firm is identical. Due to the use parameter tying, the ICE predictor has an additional 156 model parameters.\nThe test losses reported were computed using ten-fold cross validation. To fit the regularization parameters for logistic regression, MaxEnt IOC and MaxEnt ICE, we held out 10% of the training data and performed a parameter sweep. For logistic regression, a separate parameter sweep and regularization was used for the bias and utility features. For MaxEnt ICE, an additional regularization parameter was selected for the regret parameters. A sample of the predictions from MaxEnt ICE are shown in Figure 5.\nIn the left of Figure 6, we present the test errors of the three parameterized methods in terms of their offset from that of the featureless multino-\nmial. This quantity has lower variance than the absolute errors, allowing for more accurate comparisons. We see that the addition of the regret features more than doubles the improvement of logistic regression from 2.6% to 6.3%, where as the inverse optimal control method only sees a 4.3% improvement.\nIn the center of Figure 6, we show the test log-loss when the methods are only required to predict if any firm acts. Here, the models are still trained over their complete outcome spaces and their predictions are marginalized. We see that all three methods are equal within noise. That is, the differences in the predictive performances come solely from each method\u2019s ability to predict who acts. We additionally performed this experiment without the use of regulatory features and found that the logistic regression method achieved a relative loss of \u22120.027300. Using a paired comparison between the two methods, we note that this difference of 0.004443 is significant with error 0.001886. This echoes Suzuki\u2019s conclusions the regulatory environment in this industry affect firms\u2019 decisions to build new hotels [Suzuki, 2010], measured here by improvements in predictive performance.\nIn the right of Figure 6, we demonstrate the test log loss conditioned on at least one firm acting\u2014the portion of the loss that differentiates the methods. The logistic regression method with only utility features performs\nthe worst with a 1.8% improvement over the multinomial base line, the individual inverse optimal control method improves by 4.1% and MaxEnt ICE performs the best with a 6.3% improvement. That is, the addition of regret features, and hence accounting for the strategic aspects of the game, have a significant effect on the predictive performance in this setting. We note that replacing the regulatory features in the regret portion of the MaxEnt ICE model actually slightly improves performance to \u22120.471763, though not by a significant margin. This implies that the regulatory features have little or no bearing on predicting exactly the firm that will act, which suggests the regulatory practices are unbiased."}, {"heading": "8 Conclusion", "text": "In this article, we develop a novel approach to behavior prediction in strategic multi-agent domains. We demonstrate that by leveraging a rationality assumption and the principle of maximum entropy our method can be efficiently implemented while achieving good statistical performance. Empirically, we displayed the effectiveness of our approach on two market entry data sets. We demonstrated both the robustness of our approach to errors in our assumption as well as the importance of considering strategic interactions.\nOur future work will consider two new directions. First, we will address classes of games where the action sets and players differ. A key benefit of our current approach is that it enables these to differ between training and testing which we only leverage modestly in the transfer experiments for route prediction. This will involve investigating from a statistical point of view novel notions of a deviation and their corresponding equilibrium\nconcepts Second, we will consider different models of interactions, such as stochastic games and extensive-form games. These models, though no more expressive than matrix games, can often represent interactions exponentially more succinctly. From a practical standpoint, this avenue of research will allow for the application of our methods to a broader class of problems, including, for instance, exploring the time series dependencies within the Texas Hotel Chain data."}, {"heading": "Acknowledgements", "text": "This work is supported by the ONR MURI grant N00014-09-1-1052 and by the National Sciences and Engineering Research Council of Canada (NSERC). The authors gratefully acknowledge Prof. Junichi Suzuki for providing the aggregated mid-scale hotel data and Alex Grubb for the application of density estimation code to the data-sets."}, {"heading": "Appendix", "text": ""}, {"heading": "Proof of Lemma 1", "text": "Proof. The lower bound holds as a consequence of \u03a6int \u2286 \u03a6swap.\nSince max x\u2208Ai,y\u2208Ai\nr\u0393i;x\u2192y(\u03c3 \u0393|w) \u2265 r\u0393i;x\u2192x(\u03c3\u0393|w) = 0,\nRegret\u0393 \u03a6swap(\u03c3 \u0393|w) = max i\u2208N \u2211 x\u2208Ai max y\u2208Ai r\u0393i;x\u2192y(\u03c3 \u0393|w)\n\u2264 A \u00b7max i\u2208N max x\u2208Ai max y\u2208Ai r\u0393i;x\u2192y(\u03c3 \u0393|w) = A \u00b7 Regret\u0393 \u03a6int (\u03c3\u0393|w)."}, {"heading": "Proof of Theorem 3", "text": "The proof of Theorem 3 immediately follows from the following lemma.\nLemma 4. For any utility function w \u2208 K, r\u0393f (\u03c3\u0302\u0393|w) \u2264 Regret \u0393 \u03a6f (\u03c3\u0393|w) if and only if there exists an \u03b7f \u2208 \u2206\u03a6f such that r\u0393f (\u03c3\u0302\u0393) \u2212 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393) ] \u2208 \u2212K\u2217.\nProof. Assume that for all w \u2208 K, r\u0393f (\u03c3\u0302\u0393|w) \u2264 Regret \u0393 \u03a6f (\u03c3\u0393|w), \u2203\u03b7f \u2208 \u2206\u03a6f such that\nr\u0393f (\u03c3\u0302 \u0393|w) \u2264 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393|w) ]\nSince 0 \u2208 K, max w\u2208K r\u0393f (\u03c3\u0302 \u0393|w)\u2212 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393|w) ] \u2264 0\n= r\u0393f (\u03c3\u0302 \u0393|0)\u2212 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393|0) ]\n= max w\u2208K,t\nr\u0393f (\u03c3\u0302 \u0393|w)\u2212 t, subject to: t \u2265 r\u0393g (\u03c3\u0393|w), \u2200g \u2208 \u03a6f .\nBy Slater\u2019s condition, strong duality holds and the resulting dual is the feasibility problem\n= min \u03b7f\u2208\u2206\u03a6f\n0, subject to: r\u0393f (\u03c3\u0302 \u0393)\u2212 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393) ] \u2208 \u2212K\u2217.\nAssume \u2203\u03b7f \u2208 \u2206\u03a6f and y \u2208 K\u2217 such that r\u0393f (\u03c3\u0302\u0393)\u2212 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393) ]\n+ y = 0, then for any w \u2208 K\nr\u0393f (\u03c3\u0302 \u0393|w)\u2212 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393|w) ]\n+ \u3008y, w\u3009 = \u30080, w\u3009 = 0. By the definition of the dual cone \u3008y, w\u3009 \u2265 0, therefore\nr\u0393f (\u03c3\u0302 \u0393|w) \u2264 Eg\u223c\u03b7f [ r\u0393g (\u03c3 \u0393|w) ] \u2264 max\ng\u2208\u03a6f r\u0393g (\u03c3 \u0393|w) = Regret\u0393\u03a6f (\u03c3 \u0393|w)."}, {"heading": "Proof of Theorem 4", "text": "The proof of Theorem 4 immediately follows from the following lemma.\nLemma 5. If joint strategy \u03c3\u0393 has \u03b5 external regret, and \u0393 is 2-player and constant-sum with respect to w, then the marginal strategies form a 2\u03b5-Nash equilibrium under utility function w.\nProof. Denote one player x and the other y and their marginal strategies as \u03c3\u0304\u0393x and \u03c3\u0304 \u0393 y respectively. We are given\n\u2200\u03c3\u0393x \u2208 \u2206Ax , u\u0393x(\u03c3\u0393x , \u03c3\u0304\u0393y |w)\u2212 u\u0393x(\u03c3\u0393|w) \u2264 \u03b5 and, \u2200\u03c3\u0393y \u2208 \u2206Ay , u\u0393y (\u03c3\u0393y , \u03c3\u0304\u0393x |w)\u2212 u\u0393y (\u03c3\u0393|w) \u2264 \u03b5\nas when either player deviates, the other resorts to playing his marginal strategy. Substituting \u03c3\u0304\u0393y for \u03c3 \u0393 y and summing, we get \u2200\u03c3\u0393x \u2208 \u2206Ax\nu\u0393x(\u03c3 \u0393 x , \u03c3\u0304 \u0393 y |w) + u\u0393y (\u03c3\u0304\u0393y , \u03c3\u0304\u0393x |w)\u2212 [ u\u0393y (\u03c3 \u0393|w) + u\u0393x(\u03c3\u0393|w) ] \u2264 2\u03b5\nu\u0393x(\u03c3 \u0393 x , \u03c3\u0304 \u0393 y |w) + u\u0393y (\u03c3\u0304\u0393y , \u03c3\u0304\u0393x |w)\u2212 C \u2264 2\u03b5\nu\u0393x(\u03c3 \u0393 x , \u03c3\u0304 \u0393 y |w) + [ C \u2212 u\u0393x(\u03c3\u0304\u0393y , \u03c3\u0304\u0393x |w) ] \u2212 C \u2264 2\u03b5\nu\u0393x(\u03c3 \u0393 x , \u03c3\u0304 \u0393 y |w)\u2212 u\u0393x(\u03c3\u0304\u0393y , \u03c3\u0304\u0393x |w) \u2264 2\u03b5\nA symmetric argument shows the equivalent statement for the opposing player."}, {"heading": "Proof of Theorem 7", "text": "Proof. The Legrange dual function,\nL(\u03b8, \u03b1, \u03b2, u, v, x) = max \u03c3\u0302\u0393,\u03b7,y \u2212 \u2211 a\u2208A \u03c3\u0302\u0393(a) log \u03c3\u0302\u0393(a)+\n\u2211 f\u2208\u03a6 \u03b1f 1\u2212\u2211 g\u2208\u03a6 \u03b7f (g) + \u03b2(1\u2212\u2211 a\u2208A \u03c3\u0302\u0393(a) ) + \u2211 f\u2208\u03a6 \u3008r\u0393f (\u03c3\u0302\u0393)\u2212 \u2211 f,g\u2208\u03a6 \u03b7f (g)r \u0393 g (\u03c3\n\u0393) + yf , \u03b8f \u3009+\u2211 f\u2208\u03a6 vf \u00b7 \u03b7f + u \u00b7 \u03c3\u0302\u0393 + \u3008yf , xf \u3009,\nis an upper bound on the primal objective for all u, v \u2265 0 and x \u2208 K\u2217\u2217. We solve the unconstrained maximization by setting the derivatives with respect to \u03c3\u0302\u0393, \u03b7, y to zero,\nlog \u03c3\u0302\u0393(a) = u(a)\u2212 1\u2212 \u03b2 \u2212 \u2211 f\u2208\u03a6 \u3008r\u0393f (a), \u03b8f \u3009\n\u3008r\u0393g (\u03c3\u0393), \u03b8f \u3009 \u2212 \u03b1f + vf (g) = 0 \u2200f, g \u2208 \u03a6 \u03b8f = \u2212xf . \u2200f \u2208 \u03a6\nSubstituting this solution back into the Legrangian and minimizing this upper bound gives\nmin \u03b8\u2208K\u2217\u2217,\u03b2 exp(\u22121\u2212 \u03b2)Z\u0393(\u03b8) + \u2211 f\u2208\u03a6 \u03b1f + \u03b2 subject to:\n\u3008r\u0393g (\u03c3\u0393), \u03b8f \u3009 \u2264 \u03b1f . \u2200f, g \u2208 \u03a6\nSolving for \u03b2 explicitly we get \u03b2 = logZ\u0393(\u03b8)\u2212 1, and moving the constraint into the objective gives our result:\nmin \u03b8\u2208K\u2217\u2217 \u2211 f\u2208\u03a6 Regret\u0393\u03a6(\u03c3 \u0393|\u03b8f ) + logZ\u0393(\u03b8)."}, {"heading": "Proof of Theorem 9", "text": "Proof. Let {e1, e2, . . . , eK} be an orthonormal basis for V , where K = dimV . We first bound how well the regrets match in each basis direction.\nP [\nmax f\u2208\u03a6,k\u2208[K]\n|r\u03be\u0303f (\u03c3\u0303|ek)\u2212 r \u03be f (\u03c3|ek)| \u2265 \u2206\n] \u2264 P [ \u22c3 f\u2208\u03a6,k\u2208[K] ( |r\u03be\u0303f (\u03c3\u0303|ek)\u2212 r \u03be f (\u03c3|ek)| \u2265 \u2206 )]\n\u2264 \u2211\nf\u2208\u03a6,k\u2208[K]\nP [ |r\u03be\u0303f (\u03c3\u0303|ek)\u2212 r \u03be f (\u03c3|ek)| \u2265 \u2206 ]\n\u2264 2|\u03a6|K exp ( \u22122T 2 ) \u2264 \u03b4.\nT \u2265 1 2 2 log 2|\u03a6|dimV \u03b4 .\nNext, we bound how well the regrets match under w, given all regrets are close.\n|r\u03be\u0303f (\u03c3\u0303|w)\u2212 r \u03be f (\u03c3|w)| = | K\u2211 k=1 \u03b1kr \u03be\u0303 f (\u03c3\u0303|ek)\u2212 \u03b1kr \u03be f (\u03c3|ek)|\n\u2264 K\u2211 k=1 |\u03b1k||r\u03be\u0303f (\u03c3\u0303|ek)\u2212 r \u03be f (\u03c3|ek)|\n\u2264 \u2206 K\u2211 k=1 |\u03b1k| \u2264 \u2206\u2016w\u20161."}, {"heading": "Proof of Theorem 10", "text": "Proof. Unlike Theorem 9, we will bound the error of regrets directly. P [\nmax f\u2208\u03a6\nr\u03be\u0303f (\u03c3\u0303|w)\u2212 r \u03be f (\u03c3|w) \u2265 \u2206(w)\n] \u2264 P [ \u22c3 f\u2208\u03a6 ( r\u03be\u0303f (\u03c3\u0303|w)\u2212 r \u03be f (\u03c3|w) \u2265 \u2206(w) )]\n\u2264 \u2211 f\u2208\u03a6 P [ r\u03be\u0303f (\u03c3\u0303|w)\u2212 r \u03be f (\u03c3|w) \u2265 \u2206(w) ] \u2264 2|\u03a6| exp ( \u22122T 2 ) \u2264 \u03b4\nT \u2265 1 2 2 log |\u03a6| \u03b4 ."}], "references": [], "referenceMentions": [], "year": 2013, "abstractText": "Modeling the purposeful behavior of imperfect agents from a small number of observations is a challenging task. When restricted to the single-agent decision-theoretic setting, inverse optimal control techniques assume that observed behavior is an approximately optimal solution to an unknown decision problem. These techniques learn a utility function that explains the example behavior and can then be used to accurately predict or imitate future behavior in similar observed or unobserved situations. In this work, we consider similar tasks in competitive and cooperative multi-agent domains. Here, unlike single-agent settings, a player cannot myopically maximize its reward; it must speculate on how the other agents may act to influence the game\u2019s outcome. Employing the 1 ar X iv :1 30 8. 35 06 v1 [ cs .G T ] 1 5 A ug 2 01 3 game-theoretic notion of regret and the principle of maximum entropy, we introduce a technique for predicting and generalizing behavior.", "creator": "LaTeX with hyperref package"}}}