{"id": "1506.03271", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "10-Jun-2015", "title": "Explore no more: Improved high-probability regret bounds for non-stochastic bandits", "abstract": "similar work addresses the problem of regret variation along non - finite multi - directional bandit problems, bearing on performance assumptions and hold with high probability. quantitative results are often scarce in the literature suggesting this successful requires a significantly greatly needed technical implementation and predictable modifications to the standard, more traditional algorithms that come only with guarantees so deny conditional expectation. one before these modifications is entitled the opponent to seek excess losses of every likelihood at least $ \\ omega ( \\ sqrt { t } ) $ l v $ t $ rounds, perhaps also adversely lose performance if many of the variants are obviously suboptimal. indeed it is widely adopted that this property is essential for proving high - probability regret coefficients, psychologists show in their paper about it is possible a realize very strong sums without performing rapid exploration capabilities. our result relies under a simple constrained intuitive loss - filtering variant applying \\ emph { ; assume } ( ix ) that allows exceptionally remarkably clean analysis. to realize the optimization via guerrilla technique, we try viable autonomous high - trajectory systems around various occasions establishing the standard multi - armed bandit performance. tomorrow, we conduct a behavioral experiment that illustrates the robustness of normal indirect exploration technique.", "histories": [["v1", "Wed, 10 Jun 2015 12:19:21 GMT  (125kb,D)", "https://arxiv.org/abs/1506.03271v1", null], ["v2", "Thu, 16 Jul 2015 12:59:46 GMT  (125kb,D)", "http://arxiv.org/abs/1506.03271v2", null], ["v3", "Tue, 3 Nov 2015 08:42:39 GMT  (121kb,D)", "http://arxiv.org/abs/1506.03271v3", "To appear at NIPS 2015"]], "reviews": [], "SUBJECTS": "cs.LG stat.ML", "authors": ["gergely neu"], "accepted": true, "id": "1506.03271"}, "pdf": {"name": "1506.03271.pdf", "metadata": {"source": "CRF", "title": "Explore no more: Improved high-probability regret bounds for non-stochastic bandits", "authors": ["Gergely Neu"], "emails": ["gergely.neu@gmail.com"], "sections": [{"heading": null, "text": "\u221a T ) times over T rounds, which can adversely affect per-\nformance if many of the arms are suboptimal. While it is widely conjectured that this property is essential for proving high-probability regret bounds, we show in this paper that it is possible to achieve such strong results without this undesirable exploration component. Our result relies on a simple and intuitive loss-estimation strategy called Implicit eXploration (IX) that allows a remarkably clean analysis. To demonstrate the flexibility of our technique, we derive several improved high-probability bounds for various extensions of the standard multi-armed bandit framework. Finally, we conduct a simple experiment that illustrates the robustness of our implicit exploration technique."}, {"heading": "1 Introduction", "text": "Consider the problem of regret minimization in non-stochastic multi-armed bandits, as defined in the classic paper of Auer, Cesa-Bianchi, Freund, and Schapire [5]. This sequential decision-making problem can be formalized as a repeated game between a learner and an environment (sometimes called the adversary). In each round t = 1, 2, . . . , T , the two players interact as follows: The learner picks an arm (also called an action) It \u2208 [K] = {1, 2, . . . ,K} and the environment selects a loss function `t : [K] \u2192 [0, 1], where the loss associated with arm i \u2208 [K] is denoted as `t,i. Subsequently, the learner incurs and observes the loss `t,It . Based solely on these observations, the goal of the learner is to choose its actions so as to accumulate as little loss as possible during the course of the game. As traditional in the online learning literature [10], we measure the performance of the learner in terms of the regret defined as\nRT = T\u2211 t=1 `t,It \u2212 min i\u2208[K] T\u2211 t=1 `t,i.\nWe say that the environment is oblivious if it selects the sequence of loss vectors irrespective of the past actions taken by the learner, and adaptive (or non-oblivious) if it is allowed to choose `t as a function of the past actions It\u22121, . . . , I1. An equivalent formulation of the multi-armed bandit game uses the concept of rewards (also called gains or payoffs) instead of losses: in this version,\n\u2217The author is currently with the Department of Information and Communication Technologies, Pompeu Fabra University, Barcelona, Spain.\nar X\niv :1\n50 6.\n03 27\n1v 3\n[ cs\n.L G\n] 3\nN ov\nthe adversary chooses the sequence of reward functions (rt) with rt,i denoting the reward given to the learner for choosing action i in round t. In this game, the learner aims at maximizing its total rewards. We will refer to the above two formulations as the loss game and the reward game, respectively.\nOur goal in this paper is to construct algorithms for the learner that guarantee that the regret grows sublinearly. Since it is well known that no deterministic learning algorithm can achieve this goal [10], we are interested in randomized algorithms. Accordingly, the regret RT then becomes a random variable that we need to bound in some probabilistic sense. Most of the existing literature on non-stochastic bandits is concerned with bounding the pseudo-regret (or weak regret) defined as\nR\u0302T = max i\u2208[K]\nE [ T\u2211 t=1 `t,It \u2212 T\u2211 t=1 `t,i ] ,\nwhere the expectation integrates over the randomness injected by the learner. Proving bounds on the actual regret that hold with high probability is considered to be a significantly harder task that can be achieved by serious changes made to the learning algorithms and much more complicated analyses. One particular common belief is that in order to guarantee high-confidence performance guarantees, the learner cannot avoid repeatedly sampling arms from a uniform distribution, typically \u2126 (\u221a KT ) times [5, 4, 7, 9]. It is easy to see that such explicit exploration can impact the empirical performance of learning algorithms in a very negative way if there are many arms with high losses: even if the base learning algorithm quickly learns to focus on good arms, explicit exploration still forces the regret to grow at a steady rate. As a result, algorithms with high-probability performance guarantees tend to perform poorly even in very simple problems [25, 7].\nIn the current paper, we propose an algorithm that guarantees strong regret bounds that hold with high probability without the explicit exploration component. One component that we preserve from the classical recipe for such algorithms is the biased estimation of losses, although our bias is of a much more delicate nature, and arguably more elegant than previous approaches. In particular, we adopt the implicit exploration (IX) strategy first proposed by Koca\u0301k, Neu, Valko, and Munos [19] for the problem of online learning with side-observations. As we show in the current paper, this simple loss-estimation strategy allows proving high-probability bounds for a range of nonstochastic bandit problems including bandits with expert advice, tracking the best arm and bandits with side-observations. Our proofs are arguably cleaner and less involved than previous ones, and very elementary in the sense that they do not rely on advanced results from probability theory like Freedman\u2019s inequality [12]. The resulting bounds are tighter than all previously known bounds and hold simultaneously for all confidence levels, unlike most previously known bounds [5, 7]. For the first time in the literature, we also provide high-probability bounds for anytime algorithms that do not require prior knowledge of the time horizon T . A minor conceptual improvement in our analysis is a direct treatment of the loss game, as opposed to previous analyses that focused on the reward game, making our treatment more coherent with other state-of-the-art results in the online learning literature1.\nThe rest of the paper is organized as follows. In Section 2, we review the known techniques for proving high-probability regret bounds for non-stochastic bandits and describe our implicit exploration strategy in precise terms. Section 3 states our main result concerning the concentration of the IX loss estimates and shows applications of this result to several problem settings. Finally, we conduct a set of simple experiments to illustrate the benefits of implicit exploration over previous techniques in Section 4."}, {"heading": "2 Explicit and implicit exploration", "text": "Most principled learning algorithms for the non-stochastic bandit problem are constructed by using a standard online learning algorithm such as the exponentially weighted forecaster ([26, 20, 13]) or follow the perturbed leader ([14, 18]) as a black box, with the true (unobserved) losses replaced by some appropriate estimates. One of the key challenges is constructing reliable estimates of the losses `t,i for all i \u2208 [K] based on the single observation `t,It . Following Auer et al. [5], this is\n1In fact, studying the loss game is colloquially known to allow better constant factors in the bounds in many settings (see, e.g., Bubeck and Cesa-Bianchi [9]). Our result further reinforces these observations.\ntraditionally achieved by using importance-weighted loss/reward estimates of the form\n\u0302\u0300 t,i =\n`t,i pt,i I{It=i} or r\u0302t,i = rt,i pt,i I{It=i} (1)\nwhere pt,i = P [It = i| Ft\u22121] is the probability that the learner picks action i in round t, conditioned on the observation history Ft\u22121 of the learner up to the beginning of round t. It is easy to show that these estimates are unbiased for all i with pt,i > 0 in the sense that E\u0302\u0300t,i = `t,i for all such i. For concreteness, consider the EXP3 algorithm of Auer et al. [5] as described in Bubeck and CesaBianchi [9, Section 3]. In every round t, this algorithm uses the loss estimates defined in Equation (1) to compute the weights wt,i = exp ( \u2212\u03b7 \u2211t\u22121 s=1 \u0302\u0300 s\u22121,i ) for all i and some positive parameter \u03b7 that is often called the learning rate. Having computed these weights, EXP3 draws arm It = i with probability proportional to wt,i. Relying on the unbiasedness of the estimates (1) and an optimized setting of \u03b7, one can prove that EXP3 enjoys a pseudo-regret bound of \u221a 2TK logK. However, the fluctuations of the loss estimates around the true losses are too large to permit bounding the true regret with high probability. To keep these fluctuations under control, Auer et al. [5] propose to use the biased reward-estimates\nr\u0303t,i = r\u0302t,i + \u03b2\npt,i (2)\nwith an appropriately chosen \u03b2 > 0. Given these estimates, the EXP3.P algorithm of Auer et al. [5] computes the weights wt,i = exp ( \u03b7 \u2211t\u22121 s=1 r\u0303s,i ) for all arms i and then samples It according to the distribution pt,i = (1\u2212 \u03b3)\nwt,i\u2211K j=1 wt,j + \u03b3 K ,\nwhere \u03b3 \u2208 [0, 1] is the exploration parameter. The argument for this explicit exploration is that it helps to keep the range (and thus the variance) of the above reward estimates bounded, thus enabling the use of (more or less) standard concentration results2. In particular, the key element in the analysis of EXP3.P [5, 9, 7, 6] is showing that the inequality\nT\u2211 t=1 (rt,i \u2212 r\u0303t,i) \u2264 log(K/\u03b4) \u03b2\nholds simultaneously for all i with probability at least 1 \u2212 \u03b4. In other words, this shows that the cumulative estimates \u2211T t=1 r\u0303t,i are upper confidence bounds for the true rewards \u2211T t=1 rt,i.\nIn the current paper, we propose to use the loss estimates defined as\n\u02dc\u0300 t,i =\n`t,i pt,i + \u03b3t I{It=i}, (3)\nfor all i and an appropriately chosen \u03b3t > 0, and then use the resulting estimates in an exponentialweights algorithm scheme without any explicit exploration. Loss estimates of this form were first used by Koca\u0301k et al. [19]\u2014following them, we refer to this technique as Implicit eXploration, or, in short, IX. In what follows, we argue that that IX as defined above achieves a similar variancereducing effect as the one achieved by the combination of explicit exploration and the biased reward estimates of Equation (2). In particular, we show that the IX estimates (3) constitute a lower confidence bound for the true losses which allows proving high-probability bounds for a number of variants of the multi-armed bandit problem."}, {"heading": "3 High-probability regret bounds via implicit exploration", "text": "In this section, we present a concentration result concerning the IX loss estimates of Equation (3), and apply this result to prove high-probability performance guarantees for a number of nonstochastic bandit problems. The following lemma states our concentration result in its most general form:\n2Explicit exploration is believed to be inevitable for proving bounds in the reward game for various other reasons, too\u2014see Bubeck and Cesa-Bianchi [9] for a discussion.\nLemma 1. Let (\u03b3t) be a fixed non-increasing sequence with \u03b3t \u2265 0 and let \u03b1t,i be nonnegative Ft\u22121-measurable random variables satisfying \u03b1t,i \u2264 2\u03b3t for all t and i. Then, with probability at least 1\u2212 \u03b4,\nT\u2211 t=1 K\u2211 i=1 \u03b1t,i (\u02dc\u0300 t,i \u2212 `t,i ) \u2264 log (1/\u03b4) .\nA particularly important special case of the above lemma is the following: Corollary 1. Let \u03b3t = \u03b3 \u2265 0 for all t. With probability at least 1\u2212 \u03b4,\nT\u2211 t=1 (\u02dc\u0300 t,i \u2212 `t,i ) \u2264 log (K/\u03b4) 2\u03b3 .\nsimultaneously holds for all i \u2208 [K].\nThis corollary follows from applying Lemma 1 to the functions \u03b1t,i = 2\u03b3I{i=j} for all j and applying the union bound. The full proof of Lemma 1 is presented in the Appendix. For didactic purposes, we now present a direct proof for Corollary 1, which is essentially a simpler version of Lemma 1.\nProof of Corollary 1. For convenience, we will use the notation \u03b2 = 2\u03b3. First, observe that\n\u02dc\u0300 t,i =\n`t,i pt,i + \u03b3 I{It=i} \u2264 `t,i pt,i + \u03b3`t,i I{It=i} = 1 2\u03b3 \u00b7 2\u03b3`t,i/pt,i 1 + \u03b3`t,i/pt,i I{It=i} \u2264 1 \u03b2 \u00b7 log\n( 1 + \u03b2 \u0302\u0300t,i) ,\nwhere the first step follows from `t,i \u2208 [0, 1] and last one from the elementary inequality z1+z/2 \u2264 log(1 + z) that holds for all z \u2265 0. Using the above inequality, we get that\nE [ exp ( \u03b2 \u02dc\u0300t,i)\u2223\u2223\u2223Ft\u22121] \u2264E [1 + \u03b2 \u0302\u0300t,i\u2223\u2223\u2223Ft\u22121] \u2264 1 + \u03b2`t,i \u2264 exp (\u03b2`t,i) ,\nwhere the second and third steps are obtained by using E [ \u0302\u0300 t,i \u2223\u2223\u2223Ft\u22121] \u2264 `t,i that holds by definition of \u0302\u0300t,i, and the inequality 1 + z \u2264 ez that holds for all z \u2208 R. As a result, the process Zt = exp ( \u03b2 \u2211t s=1 (\u02dc\u0300 s,i\u2212 `s,i )) is a supermartingale with respect to (Ft): E [Zt| Ft\u22121] \u2264 Zt\u22121. Observe that, since Z0 = 1, this implies E [ZT ] \u2264 E [ZT\u22121] \u2264 . . . \u2264 1, and thus by Markov\u2019s inequality,\nP [ T\u2211 t=1 (\u02dc\u0300 t,i \u2212 `t,i ) > \u03b5 ] \u2264 E [ exp ( \u03b2 T\u2211 t=1 (\u02dc\u0300 t,i \u2212 `t,i ))] \u00b7 exp(\u2212\u03b2\u03b5) \u2264 exp(\u2212\u03b2\u03b5)\nholds for any \u03b5 > 0. The statement of the lemma follows from solving exp(\u2212\u03b2\u03b5) = \u03b4/K for \u03b5 and using the union bound over all arms i.\nIn what follows, we put Lemma 1 to use and prove improved high-probability performance guarantees for several well-studied variants of the non-stochastic bandit problem, namely, the multi-armed bandit problem with expert advice, tracking the best arm for multi-armed bandits, and bandits with side-observations. The general form of Lemma 1 will allow us to prove high-probability bounds for anytime algorithms that can operate without prior knowledge of T . For clarity, we will only provide such bounds for the standard multi-armed bandit setting; extending the derivations to other settings is left as an easy exercise. For all algorithms, we prove bounds that scale linearly with log(1/\u03b4) and hold simultaneously for all levels \u03b4. Note that this dependence can be improved to \u221a log(1/\u03b4) for a fixed confidence level \u03b4, if the algorithm can use this \u03b4 to tune its parameters. This is the way that Table 1 presents our new bounds side-by-side with the best previously known ones.\n3.1 Multi-armed bandits\nAlgorithm 1 EXP3-IX Parameters: \u03b7 > 0, \u03b3 > 0. Initialization: w1,i = 1. for t = 1, 2, . . . , T , repeat\n1. pt,i = wt,i\u2211K\nj=1 wt,j .\n2. Draw It \u223c pt = (pt,1, . . . , pt,K). 3. Observe loss `t,It .\n4. \u02dc\u0300t,i \u2190 `t,ipt,i+\u03b3 I{It=i} for all i \u2208 [K]. 5. wt+1,i \u2190 wt,ie\u2212\u03b7 \u02dc\u0300 t,i for all i \u2208 [K].\nIn this section, we propose a variant of the EXP3 algorithm of Auer et al. [5] that uses the IX loss estimates (3): EXP3-IX. The algorithm in its most general form uses two nonincreasing sequences of nonnegative parameters: (\u03b7t) and (\u03b3t). In every round, EXP3-IX chooses action It = i with probability proportional to\npt,i \u221d wt,i = exp ( \u2212\u03b7t\nt\u22121\u2211 s=1 \u02dc\u0300 s,i\n) , (4)\nwithout mixing any explicit exploration term into the distribution. A fixed-parameter version of EXP3-IX is presented as Algorithm 1.\nOur theorem below states a high-probability bound on the regret of EXP3-IX. Notably, our bound exhibits the best known constant factor of 2 \u221a 2 in the leading term, improving on the factor of 5.15 due to Bubeck and Cesa-Bianchi [9]. The best known leading constant for the pseudo-regret bound of EXP3 is \u221a 2, also proved in Bubeck and Cesa-Bianchi [9].\nTheorem 1. Fix an arbitrary \u03b4 > 0. With \u03b7t = 2\u03b3t = \u221a 2 logK KT for all t, EXP3-IX guarantees\nRT \u2264 2 \u221a 2KT logK +\n(\u221a 2KT\nlogK + 1\n) log (2/\u03b4)\nwith probability at least 1\u2212\u03b4. Furthermore, setting \u03b7t = 2\u03b3t = \u221a logK Kt for all t, the bound becomes\nRT \u2264 4 \u221a KT logK + ( 2 \u221a KT\nlogK + 1\n) log (2/\u03b4) .\nProof. Let us fix an arbitrary \u03b4\u2032 \u2208 (0, 1). Following the standard analysis of EXP3 in the loss game and nonincreasing learning rates [9], we can obtain the bound\nT\u2211 t=1 ( K\u2211 i=1 pt,i \u02dc\u0300t,i \u2212 \u02dc\u0300t,j) \u2264 logK \u03b7T + T\u2211 t=1 \u03b7t 2 K\u2211 i=1 pt,i (\u02dc\u0300 t,i )2 for any j. Now observe that\nK\u2211 i=1 pt,i \u02dc\u0300t,i = K\u2211 i=1 I{It=i} `t,i (pt,i + \u03b3t) pt,i + \u03b3t \u2212 \u03b3t K\u2211 i=1 I{It=i} `t,i pt,i + \u03b3t`t,i = `t,It \u2212 \u03b3t K\u2211 i=1 \u02dc\u0300 t,i. (5)\nSimilarly, \u2211K i=1 pt,i \u02dc\u03002 t,i \u2264 \u2211K i=1 \u02dc\u0300 t,i holds by the boundedness of the losses. Thus, we get that\nT\u2211 t=1 (`t,It \u2212 `t,j) \u2264 T\u2211 t=1 ( `t,j \u2212 \u02dc\u0300t,j)+ logK \u03b7T + T\u2211 t=1 (\u03b7t 2 + \u03b3t ) K\u2211 i=1 \u02dc\u0300 t,i\n\u2264 log (K/\u03b4 \u2032)\n2\u03b3 +\nlogK\n\u03b7 + T\u2211 t=1 (\u03b7t 2 + \u03b3t ) K\u2211 i=1 `t,i + log (1/\u03b4 \u2032)\nholds with probability at least 1 \u2212 2\u03b4\u2032, where the last line follows from an application of Lemma 1 with \u03b1t,i = \u03b7t/2 + \u03b3t for all t, i and taking the union bound. By taking j = arg mini LT,i and \u03b4\u2032 = \u03b4/2, and using the boundedness of the losses, we obtain\nRT \u2264 log (2K/\u03b4)\n2\u03b3T +\nlogK\n\u03b7T +K T\u2211 t=1 (\u03b7t 2 + \u03b3t ) + log (2/\u03b4) .\nThe statements of the theorem then follow immediately, noting that \u2211T t=1 1/ \u221a t \u2264 2 \u221a T ."}, {"heading": "3.2 Bandits with expert advice", "text": "We now turn to the setting of multi-armed bandits with expert advice, as defined in Auer et al. [5], and later revisited by McMahan and Streeter [22] and Beygelzimer et al. [7]. In this setting, we assume that in every round t = 1, 2, . . . , T , the learner observes a set of N probability distributions \u03bet(1), \u03bet(2), . . . , \u03bet(N) \u2208 [0, 1]K over the K arms, such that \u2211K i=1 \u03bet,i(n) = 1 for all n \u2208 [N ]. We assume that the sequences (\u03bet(n)) are measurable with respect to (Ft). The nthof these vectors represent the probabilistic advice of the corresponding nth expert. The goal of the learner in this setting is to pick a sequence of arms so as to minimize the regret against the best expert:\nR\u03beT = T\u2211 t=1 `t,It \u2212 min n\u2208[N ] T\u2211 t=1 K\u2211 i=1 \u03bet,i(n)`t,i \u2192 min .\nTo tackle this problem, we propose a modification of the EXP4 algorithm of Auer et al. [5] that uses the IX loss estimates (3), and also drops the explicit exploration component of the original algorithm. Specifically, EXP4-IX uses the loss estimates defined in Equation (3) to compute the weights\nwt,n = exp\n( \u2212\u03b7\nt\u22121\u2211 s=1 K\u2211 i=1\n\u03bes,i(n)\u02dc\u0300s,i)\nfor every expert n \u2208 [N ], and then draw arm i with probability pt,i \u221d \u2211N n=1 wt,n\u03bet,i(n). We now state the performance guarantee of EXP4-IX. Our bound improves the best known leading constant of 6 due to Beygelzimer et al. [7] to 2 \u221a 2 and is a factor of 2 worse than the best known constant in the pseudo-regret bound for EXP4 [9]. The proof of the theorem is presented in the Appendix.\nTheorem 2. Fix an arbitrary \u03b4 > 0 and set \u03b7 = 2\u03b3 = \u221a\n2 logN KT for all t. Then, with probability at\nleast 1\u2212 \u03b4, the regret of EXP4-IX satisfies\nR\u03beT \u2264 2 \u221a 2KT logN +\n(\u221a 2KT\nlogN + 1\n) log (2/\u03b4) ."}, {"heading": "3.3 Tracking the best sequence of arms", "text": "In this section, we consider the problem of competing with sequences of actions. Similarly to Herbster and Warmuth [17], we consider the class of sequences that switch at most S times between actions. We measure the performance of the learner in this setting in terms of the regret against the best sequence from this class C(S) \u2286 [K]T , defined as\nRST = T\u2211 t=1 `t,It \u2212 min (Jt)\u2208C(S) T\u2211 t=1 `t,Jt .\nSimilarly to Auer et al. [5], we now propose to adapt the Fixed Share algorithm of Herbster and Warmuth [17] to our setting. Our algorithm, called EXP3-SIX, updates a set of weights wt,\u00b7 over the arms in a recursive fashion. In the first round, EXP3-SIX sets w1,i = 1/K for all i. In the following rounds, the weights are updated for every arm i as\nwt+1,i = (1\u2212 \u03b1)wt,i \u00b7 e\u2212\u03b7 \u02dc\u0300 t,i + \u03b1\nK K\u2211 j=1 wt,j \u00b7 e\u2212\u03b7 \u02dc\u0300 t,j .\nIn round t, the algorithm draws arm It = i with probability pt,i \u221d wt,i. Below, we give the performance guarantees of EXP3-SIX. Note that our leading factor of 2 \u221a 2 again improves over the best previously known leading factor of 7, shown by Audibert and Bubeck [3]. The proof of the theorem is given in the Appendix.\nTheorem 3. Fix an arbitrary \u03b4 > 0 and set \u03b7 = 2\u03b3 = \u221a\n2S\u0304 logK KT and \u03b1 = S T\u22121 , where S\u0304 = S + 1.\nThen, with probability at least 1\u2212 \u03b4, the regret of EXP3-SIX satisfies\nRST \u2264 2\n\u221a 2KTS\u0304 log ( eKT\nS\n) + (\u221a 2KT\nS\u0304 logK + 1\n) log (2/\u03b4) ."}, {"heading": "3.4 Bandits with side-observations", "text": "Let us now turn to the problem of online learning in bandit problems in the presence of side observations, as defined by Mannor and Shamir [21] and later elaborated by Alon et al. [1]. In this setting, the learner and the environment interact exactly as in the multi-armed bandit problem, the main difference being that in every round, the learner observes the losses of some arms other than its actually chosen arm It. The structure of the side observations is described by the directed graph G: nodes of G correspond to individual arms, and the presence of arc i\u2192 j implies that the learner will observe `t,j upon selecting It = i.\nImplicit exploration and EXP3-IX was first proposed by Koca\u0301k et al. [19] for this precise setting. To describe this variant, let us introduce the notations Ot,i = I{It=i} + I{(It\u2192i)\u2208G} and ot,i = E [Ot,i| Ft\u22121]. Then, the IX loss estimates in this setting are defined for all t, i as \u02dc\u0300t,i = Ot,i`t,iot,i+\u03b3t . With these estimates at hand, EXP3-IX draws arm It from the exponentially weighted distribution defined in Equation (4). The following theorem provides the regret bound concerning this algorithm.\nTheorem 4. Fix an arbitrary \u03b4 > 0. Assume that T \u2265 K2/(8\u03b1) and set \u03b7 = 2\u03b3 = \u221a\nlogK 2\u03b1T log(KT ) ,\nwhere \u03b1 is the independence number of G. With probability at least 1\u2212 \u03b4, EXP3-IX guarantees RT \u2264 ( 4+2 \u221a log (4/\u03b4) ) \u00b7 \u221a 2\u03b1T ( log2K+logKT ) +2 \u221a \u03b1T log(KT )\nlogK log (4/\u03b4)+\n\u221a T log(4/\u03b4)\n2 .\nThe proof of the theorem is given in the Appendix. While the proof of this statement is significantly more involved than the other proofs presented in this paper, it provides a fundamentally new result. In particular, our bound is in terms of the independence number \u03b1 and thus matches the minimax regret bound proved by Alon et al. [1] for this setting up to logarithmic factors. In contrast, the only high-probability regret bound for this setting due to Alon et al. [2] scales with the size m of the maximal acyclic subgraph of G, which can be much larger than \u03b1 in general (i.e., m may be o(\u03b1) for some graphs [1])."}, {"heading": "4 Empirical evaluation", "text": "We conduct a simple experiment to demonstrate the robustness of EXP3-IX as compared to EXP3 and its superior performance as compared to EXP3.P. Our setting is a 10-arm bandit problem where all losses are independent draws of Bernoulli random variables. The mean losses of arms 1 through 8 are 1/2 and the mean loss of arm 9 is 1/2\u2212\u2206 for all rounds t = 1, 2, . . . , T . The mean losses of arm 10 are changing over time: for rounds t \u2264 T/2, the mean is 1/2+ \u2206, and 1/2\u22124\u2206 afterwards. This choice ensures that up to at least round T/2, arm 9 is clearly better than other arms. In the second half of the game, arm 10 starts to outperform arm 9 and eventually becomes the leader.\nWe have evaluated the performance of EXP3, EXP3.P and EXP3-IX in the above setting with T = 106 and \u2206 = 0.1. For fairness of comparison, we evaluate all three algorithms for a wide range of parameters. In particular, for all three algorithms, we set a base learning rate \u03b7 according to the best known theoretical results [9, Theorems 3.1 and 3.3] and varied the multiplier of the respective base parameters between 0.01 and 100. Other parameters are set as \u03b3 = \u03b7/2 for EXP3-IX and \u03b2 = \u03b3/K = \u03b7 for EXP3.P. We studied the regret up to two interesting rounds in the game: up to T/2, where the losses are i.i.d., and up to T where the algorithms have to notice the shift in the\nloss distributions. Figure 1 shows the empirical means and standard deviations over 50 runs of the regrets of the three algorithms as a function of the multipliers. The results clearly show that EXP3IX largely improves on the empirical performance of EXP3.P and is also much more robust in the non-stochastic regime than vanilla EXP3."}, {"heading": "5 Discussion", "text": "In this paper, we have shown that, contrary to popular belief, explicit exploration is not necessary to achieve high-probability regret bounds for non-stochastic bandit problems. Interestingly, however, we have observed in several of our experiments that our IX-based algorithms still draw every arm roughly \u221a T times, even though this is not explicitly enforced by the algorithm. This suggests a need for a more complete study of the role of exploration, to find out whether pulling every single arm \u2126( \u221a T ) times is necessary for achieving near-optimal guarantees.\nOne can argue that tuning the IX parameter that we introduce may actually be just as difficult in practice as tuning the parameters of EXP3.P. However, every aspect of our analysis suggests that \u03b3t = \u03b7t/2 is the most natural choice for these parameters, and thus this is the choice that we recommend. One limitation of our current analysis is that it only permits deterministic learning-rate and IX parameters (see the conditions of Lemma 1). That is, proving adaptive regret bounds in the vein of [15, 24, 23] that hold with high probability is still an open challenge.\nAnother interesting question for future study is whether the implicit exploration approach can help in advancing the state of the art in the more general setting of linear bandits. All known algorithms for this setting rely on explicit exploration techniques, and the strength of the obtained results depend crucially on the choice of the exploration distribution (see [8, 16] for recent advances). Interestingly, IX has a natural extension to the linear bandit problem. To see this, consider the vector Vt = eIt and the matrix Pt = E [VtV Tt ]. Then, the IX loss estimates can be written as \u02dc\u0300t = (Pt + \u03b3I)\u22121VtV Tt `t. Whether or not this estimate is the right choice for linear bandits remains to be seen.\nFinally, we note that our estimates (3) are certainly not the only ones that allow avoiding explicit exploration. In fact, the careful reader might deduce from the proof of Lemma 1 that the same concentration bound can be shown to hold for the alternative loss estimates `t,iI{It=i}/ (pt,i + \u03b3`t,i) and log ( 1 + 2\u03b3`t,iI{It=i}/pt,i ) /(2\u03b3). Actually, a variant of the latter estimate was used previously for proving high-probability regret bounds in the reward game by Audibert and Bubeck [4]\u2014however, their proof still relied on explicit exploration. It is not hard to verify that all the results we presented in this paper (except Theorem 4) can be shown to hold for the above two estimates, too.\nAcknowledgments This work was supported by INRIA, the French Ministry of Higher Education and Research, and by FUI project Herme\u0300s. The author wishes to thank Haipeng Luo for catching a bug in an earlier version of the paper, and the anonymous reviewers for their helpful suggestions."}, {"heading": "A The proof of Lemma 1", "text": "Fix any t. For convenience, we will use the notation \u03b2t = 2\u03b3t. First, observe that for any i, \u02dc\u0300 t,i =\n`t,i pt,i + \u03b3t I{It=i} \u2264 `t,i pt,i + \u03b3t`t,i I{It=i} = 1 2\u03b3t \u00b7 2\u03b3t`t,i/pt,i 1 + \u03b3t`t,i/pt,i I{It=i} \u2264 1 \u03b2t \u00b7 log\n( 1 + \u03b2t \u0302\u0300t,i) ,\nwhere the first step follows from `t,i \u2208 [0, 1] and last one from the elementary inequality z1+z/2 \u2264 log(1 + z) that holds for all z \u2265 0.\nDefine the notations \u03bb\u0303t = \u2211K i=1 \u03b1t,i \u02dc\u0300 t,i and \u03bbt = \u2211K i=1 \u03b1t,i`t,i. Using the above inequality, we get that\nE [ exp ( \u03bb\u0303t )\u2223\u2223\u2223Ft\u22121] \u2264E[exp( K\u2211\ni=1\n\u03b1t,i \u03b2t \u00b7 log\n( 1 + \u03b2t \u0302\u0300t,i)) \u2223\u2223\u2223\u2223\u2223Ft\u22121 ]\n\u2264E [ K\u220f i=1 ( 1 + \u03b1t,i \u0302\u0300t,i) \u2223\u2223\u2223\u2223\u2223Ft\u22121 ] = E [ 1 + K\u2211 i=1 \u03b1t,i \u0302\u0300t,i \u2223\u2223\u2223\u2223\u2223Ft\u22121 ]\n\u22641 + K\u2211 i=1 \u03b1t,i`t,i \u2264 exp ( K\u2211 i=1 \u03b1t,i`t,i ) = exp (\u03bbt) ,\n(6)\nwhere the second line follows from noting that \u03b1t,i \u2264 \u03b2t, using the inequality x log(1+y) \u2264 log(1+ xy) that holds for all y > \u22121 and x \u2208 [0, 1] and the identity \u220fK i=1 ( 1 + \u03b1t,i \u0302\u0300t,i) = 1+\u2211Ki=1 \u03b1t,i \u0302\u0300t,i\nthat follows from the fact that \u0302\u0300t,i \u00b7 \u0302\u0300t,j = 0 holds whenever i 6= j. The last line is obtained by using E [ \u0302\u0300 t,i \u2223\u2223\u2223Ft\u22121] \u2264 `t,i that holds by definition of \u0302\u0300t,i, and the inequality 1 + z \u2264 ez that holds for all z \u2208 R. As a result, the process Zt = exp (\u2211t s=1 ( \u03bb\u0303s \u2212 \u03bbs )) is a supermartingale with respect to (Ft): E [Zt| Ft\u22121] \u2264 Zt\u22121. Observe that, since Z0 = 1, this implies E [ZT ] \u2264 E [ZT\u22121] \u2264 . . . \u2264 1, and thus by Markov\u2019s inequality,\nP [ T\u2211 t=1 ( \u03bb\u0303t \u2212 \u03bbt ) > \u03b5 ] \u2264 E [ exp ( T\u2211 t=1 ( \u03bb\u0303t \u2212 \u03bbt ))] \u00b7 exp(\u2212\u03b5) \u2264 exp(\u2212\u03b5)\nholds for any \u03b5 > 0. The statement of the lemma follows from solving exp(\u2212\u03b5) = \u03b4 for \u03b5."}, {"heading": "B Further proofs", "text": "B.1 The proof of Theorem 2\nFix an arbitrary \u03b4\u2032. For ease of notation, let us define \u03c0t(n) = wt,n/ (\u2211N m=1 wt,m ) . By standard arguments (along the lines of [5, 9]), we can obtain\nT\u2211 t=1 K\u2211 i=1 ( pt,i \u2212 \u03bet,i(m) )\u02dc\u0300 t,i \u2264 logK \u03b7 + \u03b7 2 T\u2211 t=1 N\u2211 n=1 \u03c0t(n) ( K\u2211 i=1 \u03bet,i(n)\u02dc\u0300t,i)2 for any fixed m \u2208 [N ]. The last term on the right-hand side can be bounded as\nN\u2211 n=1 \u03c0t(n) ( K\u2211 i=1 \u03bet,i(n)\u02dc\u0300t,i)2 \u2264 N\u2211 n=1 \u03c0t(n) K\u2211 i=1 \u03bet,i(n) (\u02dc\u0300 t,i )2 = K\u2211 i=1 pt,i (\u02dc\u0300 t,i )2 \u2264 K\u2211 i=1 \u02dc\u0300 t,i,\nwhere the first step uses Jensen\u2019s inequality and the last uses pt,i \u02dc\u0300t,i \u2264 1. Now, we can apply Lemma 1 and the union bound to show that\nT\u2211 t=1 K\u2211 i=1 \u03bet,i(m) (\u02dc\u0300 t,i \u2212 `t,i ) \u2264 log (N/\u03b4 \u2032) 2\u03b3\nholds simultaneously for all experts with probability at least 1 \u2212 \u03b4\u2032, and in particular for the best expert, too. Putting this observation together with the above bound and Equation (5), we get that\nR\u03beT \u2264 logN\n\u03b7 +\nlog (N/\u03b4\u2032) 2\u03b3 + (\u03b7 2 + \u03b3 ) T\u2211 t=1 K\u2211 i=1 \u02dc\u0300 t,i\n\u2264 logK \u03b7\n+ log (N/\u03b4\u2032) 2\u03b3 + (\u03b7 2 + \u03b3 ) K\u2211 i=1 LT,i + (\u03b7 2 + \u03b3 ) log (1/\u03b4\u2032) 2\u03b3\nholds with probability at least 1 \u2212 2\u03b4\u2032, where the last line follows from Lemma 1 and the union bound. The proof is concluded by taking \u03b4\u2032 = \u03b4/2 and plugging in the choices of \u03b3 and \u03b7.\nB.2 The proof of Theorem 3\nThe proof of the theorem builds on the techniques of Cesa-Bianchi et al. [11] and Auer et al. [5]. Let us fix an arbitrary \u03b4\u2032 \u2208 (0, 1) and denote the best sequence from C(S) by J\u22171:T . Then, a straightforward modification of Theorem 2 of [11] yields the bound3\nT\u2211 t=1 ( K\u2211 i=1 pt,i \u02dc\u0300t,i \u2212 \u02dc\u0300t,J\u2217t ) \u2264 2S\u0304 logK \u03b7 \u2212 1 \u03b7 log ( \u03b1S(1\u2212\u03b1)T\u2212S\u0304 ) + \u03b7 2 T\u2211 t=1 K\u2211 i=1 pt,i (\u02dc\u0300 t,i )2 .\nTo proceed, let us apply Lemma 1 to obtain that\nT\u2211 t=1 (\u02dc\u0300 t,Jt \u2212 `t,Jt ) \u2264 log ( |C(S)| /\u03b4 ) 2\u03b3\nsimultaneously holds for all sequences J1:T \u2208 C(S). By standard arguments (see, e.g., the proof of Theorem 22 in Audibert and Bubeck [3]), one can show that |C(S)| \u2264 KS\u0304 ( eT S )S . Now, combining\nthe above with Equation (5) and \u2211K i=1 pt,i \u02dc\u03002 t,i \u2264 \u2211K i=1 \u02dc\u0300 t,i, we get that T\u2211 t=1 ( `t,It \u2212 `t,J\u2217t ) \u22642S\u0304 logK \u03b7 \u2212 1 \u03b7 log ( \u03b1S(1\u2212 \u03b1)T\u2212S\u0304 ) + log ( T/(S\u03b4\u2032) ) + 1 2\u03b3 + (\u03b7 2 + \u03b3 ) T\u2211 t=1 K\u2211 i=1 \u02dc\u0300 t,i\n\u22642S\u0304 logK \u03b7 \u2212 1 \u03b7\nlog ( \u03b1S(1\u2212 \u03b1)T\u2212S\u0304 ) + log ( T/(S\u03b4\u2032) ) + 1\n2\u03b3 + (\u03b7 2 + \u03b3 ) K\u2211 i=1 Lt,i + (\u03b7 2 + \u03b3 ) log (1/\u03b4\u2032) 2\u03b3 ,\nholds with probability at least 1 \u2212 2\u03b4\u2032. where the last line follows from Lemma 1 and the union bound. Then, after observing that the losses are bounded in [0, 1] and choosing \u03b4\u2032 = \u03b4/2, we get that\nRST \u2264 (S + 1) logK \u03b7 \u2212 1 \u03b7\nlog ( \u03b1S(1\u2212 \u03b1)T\u2212S\u22121 ) +\n(S + 1) logK + S log (\n2eT S\u03b4 ) 2\u03b3\n+ (\u03b7 2 + \u03b3 ) KT + (\u03b7 2 + \u03b3 ) log (2/\u03b4) 2\u03b3\nholds with probability at least 1 \u2212 \u03b4. The only remaining piece required for proving the theorem is showing that\n\u2212 log ( \u03b1S(1\u2212 \u03b1)T\u2212S\u0304 ) \u2264 S log ( eT\nS\n) ,\nwhich follows from the proof of Corollary 1 in [11], and then substituting the choice of \u03b7 and \u03b3.\n3Proving this bound requires replacing Hoeffding\u2019s inequality in their Lemma 1 by the inequality e\u2212z \u2264 1\u2212 z + z2/2 that holds for all z \u2265 0.\nB.3 The proof of Theorem 4\nBefore we dive into the proof, we note that Lemma 1 does not hold for the loss estimates used by this variant of EXP3-IX due to a subtle technical issue. Precisely, in this case \u220fK i=1 ( 1 + \u0302\u0300t,i) 6=\u2211K\ni=1\n( 1 + \u0302\u0300t,i) prevents us from directly applying Lemma 1. However, Corollary 1 can still be\nproven exactly the same way as done in Section 3. The only effect of this change is that the term log(1/\u03b4\u2032) is replaced by K log(K/\u03b4\u2032).\nTurning to the actual proof, let us fix an arbitrary \u03b4\u2032 \u2208 (0, 1) and introduce the notation\nQt = K\u2211 i=1 pt,i ot,i + \u03b3 .\nBy the standard EXP3-analysis, we have\nT\u2211 t=1 ( K\u2211 i=1 pt,i \u02dc\u0300t,i \u2212 \u02dc\u0300t,j) \u2264 logK \u03b7 + \u03b7 2 T\u2211 t=1 K\u2211 i=1 pt,i (\u02dc\u0300 t,i )2 .\nNow observe that T\u2211 t=1 K\u2211 i=1 pt,i (\u02dc\u0300 t,i )2 = T\u2211 t=1 K\u2211 i=1 pt,i ot,i + \u03b3\n\u00b7 \u02dc\u0300t,i \u2264\nT\u2211 t=1 K\u2211 i=1 pt,i ot,i + \u03b3 \u00b7 `t,i + K log(K/\u03b4\u2032) 2\u03b3\n\u2264 T\u2211 t=1 Qt + K log(K/\u03b4\u2032) 2\u03b3 ,\nholds with probability at least 1 \u2212 \u03b4\u2032 by an application of Corollary 1 for all i and taking a union bound. Furthermore, we have\nK\u2211 i=1 pt,i \u02dc\u0300t,i = K\u2211 i=1 pt,i`t,i + K\u2211 i=1 (Ot,i \u2212 ot,i \u2212 \u03b3) pt,i`t,i ot,i + \u03b3\n\u2265 K\u2211 i=1 pt,i`t,i + K\u2211 i=1 (Ot,i \u2212 ot,i) pt,i`t,i ot,i + \u03b3 \u2212 \u03b3Qt.\nBy the Hoeffding\u2013Azuma inequality, we have\nT\u2211 t=1 `t,It \u2264 T\u2211 t=1 K\u2211 i=1 pt,i`t,i +\n\u221a T log(1/\u03b4\u2032)\n2\nwith probability at least 1\u2212 \u03b4\u2032. After putting the above inequalities together and applying Lemma 1, we obtain the bound\nRT \u2264 logK\n\u03b7 +\nlog(K/\u03b4\u2032) 2\u03b3 + (\u03b7 2 + \u03b3 ) T\u2211 t=1 Qt + \u03b7 2 \u00b7 K log(K/\u03b4 \u2032) 2\u03b3 + \u221a T log(1/\u03b4\u2032) 2\n+ T\u2211 t=1 K\u2211 i=1 (ot,i \u2212Ot,i) pt,i`t,i ot,i + \u03b3\nthat holds with probability at least 1 \u2212 3\u03b4\u2032 by the union bound. To bound the last term on the right hand side, observe that\nXt = K\u2211 i=1 (ot,i \u2212Ot,i) pt,i`t,i ot,i + \u03b3\nis a martingale-difference sequence for all i \u2208 [K] with |Xt| \u2264 K and conditional variance\n\u03c32t (Xt) =E ( K\u2211 i=1 (ot,i \u2212Ot,i) pt,i ot,i + \u03b3 )2\u2223\u2223\u2223\u2223\u2223\u2223Ft\u22121 \n\u2264E ( K\u2211 i=1 Ot,i pt,i ot,i + \u03b3 )2\u2223\u2223\u2223\u2223\u2223\u2223Ft\u22121  (since E [Ot,i| Ft\u22121] = ot,i)\n=E  K\u2211 i=1 K\u2211 j=1 Ot,iOt,j pt,i ot,i + \u03b3 \u00b7 pt,j ot,j + \u03b3 \u2223\u2223\u2223\u2223\u2223\u2223Ft\u22121 \n\u2264E  K\u2211 i=1 K\u2211 j=1 Ot,i pt,i ot,i + \u03b3 \u00b7 pt,j ot,j + \u03b3 \u2223\u2223\u2223\u2223\u2223\u2223Ft\u22121  (since Ot,j\u22641)\n= K\u2211 i=1 K\u2211 j=1 pt,iot,i ot,i + \u03b3 \u00b7 pt,j ot,j + \u03b3 \u2264 K\u2211 i=1 pt,i K\u2211 j=1 pt,j ot,j + \u03b3 = Qt.\nThus, an application of Freedman\u2019s inequality (see, e.g., Theorem 1 of Beygelzimer et al. [7]), we can thus obtain the bound\nT\u2211 t=1 Xt \u2264 log(1/\u03b4\u2032) \u03c9 + (e\u2212 2)\u03c9 T\u2211 t=1 Qt\nthat holds with probability at least 1\u2212 \u03b4\u2032 for all \u03c9 \u2264 1/K. Combining this result with the previous bounds and using the union bound, we arrive at the bound\nRT \u2264 logK\n\u03b7 +\nlog(K/\u03b4\u2032)\n2\u03b3 +\nlog(1/\u03b4\u2032) \u03c9 + (\u03b7 2 + \u03b3 + \u03c9 ) T\u2211 t=1 Qt + \u03b7 2 \u00b7 K log(K/\u03b4 \u2032) 2\u03b3 + \u221a T log(1/\u03b4\u2032) 2\nthat holds with probability at least 1\u2212 4\u03b4\u2032. Invoking Lemma 1 of Koca\u0301k et al. [19] that states that\nK\u2211 i=1 pt,i ot,i + \u03b3 \u2264 2\u03b1 log ( 1 + dK2/\u03b3e+K \u03b1 ) + 2\nholds almost surely and setting \u03b4\u2032 = \u03b4/4, we obtain the bound\nRT \u2264 logK\n\u03b7 +\nlog(4K/\u03b4)\n2\u03b3 +\nlog(4/\u03b4)\n\u03c9 + (\u03b7 + 2\u03b3 + 2\u03c9)\u03b1\u2032T +\n\u03b7 2 \u00b7 K log(4K/\u03b4) 2\u03b3 +\n\u221a T log(4/\u03b4)\n2 that holds with probability at least 1\u2212 \u03b4, where \u03b1\u2032 = \u03b1 log (\n1 + dK 2/\u03b3e+K \u03b1\n) + 1.\nNow notice that when setting \u03b7 = 2\u03b3 = \u221a\nlogK 2\u03b1T log(KT ) and \u03c9 =\n\u221a log(4/\u03b4)\n2\u03b1T log(KT ) , we have \u03b1 \u2032 \u2264\n2\u03b1 log(KT ) and the above bound becomes\nRT \u2264 ( 4 + 2 \u221a log (4/\u03b4) ) \u00b7 \u221a 2\u03b1T ( log2K + logKT ) + \u221a 2\u03b1T log(KT )\nlogK log (4/\u03b4) +\n+\n\u221a T log(4/\u03b4)\n2 + K log (4K/\u03b4) 2 .\nThe proof is concluded by observing that the last term is bounded by the third one if T \u2265 K2/(8\u03b1)."}], "references": [], "referenceMentions": [], "year": 2015, "abstractText": "<lb>This work addresses the problem of regret minimization in non-stochastic multi-<lb>armed bandit problems, focusing on performance guarantees that hold with high<lb>probability. Such results are rather scarce in the literature since proving them re-<lb>quires a large deal of technical effort and significant modifications to the standard,<lb>more intuitive algorithms that come only with guarantees that hold on expectation.<lb>One of these modifications is forcing the learner to sample arms from the uniform<lb>distribution at least \u03a9(<lb>\u221a<lb>T ) times over T rounds, which can adversely affect per-<lb>formance if many of the arms are suboptimal. While it is widely conjectured that<lb>this property is essential for proving high-probability regret bounds, we show in<lb>this paper that it is possible to achieve such strong results without this undesirable<lb>exploration component. Our result relies on a simple and intuitive loss-estimation<lb>strategy called Implicit eXploration (IX) that allows a remarkably clean analy-<lb>sis. To demonstrate the flexibility of our technique, we derive several improved<lb>high-probability bounds for various extensions of the standard multi-armed bandit<lb>framework. Finally, we conduct a simple experiment that illustrates the robustness<lb>of our implicit exploration technique.", "creator": "LaTeX with hyperref package"}}}