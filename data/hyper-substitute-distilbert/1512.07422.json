{"id": "1512.07422", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "23-Dec-2015", "title": "Adaptive Algorithms for Online Convex Optimization with Long-term Constraints", "abstract": "we employ first imperative nonlinear gradient descent algorithm to forecast maximal neural decision problems with indefinite - term parameters, all are constraints that need to be satisfied when accumulated n a natural number from rounds t, so seldom partially applied in intermediate rounds. to some user - defined turn - off parameter $ \\ beta $ $ \\ in $ ( 0, 1 ), algorithm revision algorithm makes cumulative regret predict of ee ( gamma ^ max { $ \\ + $, and - - $ \\ omega $ } ) and o ( g ^ ( 1 - - $ \\ max $ / 20 ) ) for the expressions containing the constraint violations respectively. compression equations specify for convex tori and do denote initial wiener graphs without requiring knowledge of the number so rounds needed advance. sets time limit over additional fully known cumulative regret predicted by tata, laszlo c. ( 2012 ) that yield respectively an ( th ^ 1 / 2 ) / o ( sh ^ 9 / 4 ) handling maximum convex dynamics, and respectively o ( t ^ 2 / 3 ) and o ( 7 ^ 3 / 3 ) when further restricting to polyhedral domains. we supplement the analysis with algorithm validating the universally evaluated adaptive functions in practice.", "histories": [["v1", "Wed, 23 Dec 2015 10:32:09 GMT  (126kb,D)", "http://arxiv.org/abs/1512.07422v1", null]], "reviews": [], "SUBJECTS": "stat.ML cs.LG math.OC", "authors": ["rodolphe jenatton", "jim c huang", "c\u00e9dric archambeau"], "accepted": true, "id": "1512.07422"}, "pdf": {"name": "1512.07422.pdf", "metadata": {"source": "CRF", "title": "Adaptive Algorithms for Online Convex Optimization with Long-term Constraints", "authors": ["Rodolphe Jenatton", "Jim Huang", "C\u00e9dric Archambeau"], "emails": ["jenatton@amazon.com", "huangjim@amazon.com", "cedrica@amazon.com"], "sections": [{"heading": null, "text": "We present an adaptive online gradient descent algorithm to solve online convex optimization problems with long-term constraints, which are constraints that need to be satisfied when accumulated over a finite number of rounds T , but can be violated in intermediate rounds. For some user-defined trade-off parameter \u03b2 \u2208 (0, 1), the proposed algorithm achieves cumulative regret bounds ofO(Tmax{\u03b2,1\u2212\u03b2}) andO(T 1\u2212\u03b2/2) for the loss and the constraint violations respectively. Our results hold for convex losses and can handle arbitrary convex constraints without requiring knowledge of the number of rounds in advance. Our contributions improve over the best known cumulative regret bounds by Mahdavi, et al. (2012) that are respectively O(T 1/2) and O(T 3/4) for general convex domains, and respectively O(T 2/3) andO(T 2/3) when further restricting to polyhedral domains. We supplement the analysis with experiments validating the performance of our algorithm in practice."}, {"heading": "1 Introduction", "text": "Online convex optimization (OCO) plays a key role in machine learning applications, such as adaptive routing in networks [2] and online display advertising [1]. In general, an OCO problem can be formulated as a sequential and repeated game between a learner and an adversary. In each round t, the learner first plays a vector xt \u2208 X \u2286 Rp, where X is a compact convex set corresponding to the set of possible solutions. The learner then incurs a loss ft(xt) for playing vector xt. The function ft(x) : X \u2192 R+ is defined by the adversary and can vary in each round, but it is assumed to\nbe convex. We say that a function ft : Rd 7\u2192 R+ is strongly convex with modulus \u03c3 > 0 if\nft(x) \u2264 ft(y) +\u2207ft(x)>(x\u2212 y)\u2212 \u03c3\n2 \u2016x\u2212 y\u20162.\nfor any x,y \u2208 Rd. We use the notation \u2207ft(x) to refer to any (sub-)gradient of ft at x. Furthermore, we say that ft is convex if \u03c3 = 0.\nThe learner\u2019s objective is to generate a sequence of vectors xt \u2208 X for t = 1, 2, \u00b7 \u00b7 \u00b7 , T that minimizes the cumulative regret over T rounds relative to the optimal vector x?:\nRegretT (x \u2217), T\u2211 t=1 ft(xt)\u2212 T\u2211 t=1 ft(x ?). (1)\nThe latter measures the difference between the cumulative loss of the learner\u2019s sequence of vectors {xt}Tt=1 and the accumulated loss that would be incurred if the sequence of loss functions ft would be known in advance and the learner could choose the best vector x? in hindsight.\nSeveral algorithms have been developed over the past decade that achieve sub-linear cumulative regret in the OCO setting. The problem was formalized in the seminal work of [26], which presents an online algorithm based on projected gradient descent [3] that guarantees a cumulative regret of O(T 1/2) when the set X is convex and the loss functions are Lipschitz-continuous over X . In [11] and [22], algorithms with logarithmic regret bounds were proposed for strongly convex loss functions. Notably, online gradient descent achieves anO(log T ) regret bound for strongly convex loss functions for appropriate choices of step size.\nIn the aforementioned work, the constraint on vector xt is assumed to hold in round t, such that a projection step is applied in every round to enforce the feasibility of each xt. For general convex sets X , the projection step may require solving an auxiliary optimization problem, which can be computationally expensive (e.g., projections onto the semi-definite cone). More importantly, in practical applications, the learner may\nar X\niv :1\n51 2.\n07 42\n2v 1\n[ st\nat .M\nL ]\n2 3\nD ec\n2 01\nin fact only be concerned with satisfying long-term constraints, that is, the cumulative constraint violations resulting from the sequence of vectors {xt}Tt=1 should not exceed a certain amount by the final round T . An example of such an application is in online display advertising, where xt corresponds to a vector of ad budget allocations and the learner is primarily concerned in enforcing the long-term constraint that each ad consumes its budget in full over the lifetime of the ad. Another example is from wireless communications [18], where xt is a vector of power allocations across multiple devices, and the learner must satisfy average power consumption constraints per device.\nIn this work, we consider OCO problems where the learner is required to satisfy long-term constraints. For such problems, we will be concerned both with a) the learner\u2019s cumulative regret as defined by (1) and b) the learner\u2019s ability to satisfy long-term constraints \u2013 the notion of long-term shall be made more formal in Section 2.2. This class of problems was studied previously in [15, 16]. In particular, [16] considered online exponentially-weighted average in the case where the loss and constraints are linear, while [15] presented online algorithms based on projected subgradients and the mirror prox method [20]. The authors derived cumulative regret bounds for the cumulative loss and cumulative constraint violations respectively of O(T 1/2) and O(T 3/4) in the case of online projected subgradients, and respectively of O(T 2/3) and O(T 2/3) in the case of mirror prox. To our knowledge, these are the best-known regret bounds for OCO with long-term constraints. The analysis of [15] assumes the number of rounds is known ahead of time, which enables the authors to set the various constants in the algorithm that lead to the desired regret bounds. For the mirror prox method, it is additionally required that the constraint set X is fully specified by a finite number of linear constraints.\nThe concept of long-term constraints also enables us to avoid the computation of potentially expensive projections onto the domain X of x in each round. This is closely related to recent work in stochastic optimization that aims to minimize the number of expensive projection steps [17]. The guarantees sought in our analysis have also similarities with the results obtained in the context of the online alternating direction method [23], where regret bounds are provided for the violation of equality constraints.\nContributions: Building on the work of [15], we propose an algorithm based on a saddle-point formulation of the OCO problem with long-term constraints, which is adaptive (i.e., the step sizes and the regularisation parameter depend on the round t). We show that the algorithm satisfies cumulative regret bounds\nof O(T 2/3) for both the cumulative loss and the cumulative constraint violations without requiring us to know the number of rounds T in advance to set the algorithmic hyperparameters. Unlike mirror prox, our method can deal with any convex constraint set X , making it amenable to a wider range of OCO problems. Also, the algorithm we derive allows us to interpolate between the regret bounds of O(T 1/2) and O(T 3/4) from [15] and the above bound of O(T 2/3), depending on how we wish to trade off between the cumulative regret associated to the loss and the long-term constraints. In addition to our analysis of regret bounds, we empirically validate our algorithm by comparing it to the methods of [15] on a) the online estimation of doubly stochastic matrices and b) the online learning of sparse logistic regression based on the elastic net penalty [27]."}, {"heading": "2 Online Convex Optimization with Long-term Constraints", "text": ""}, {"heading": "2.1 Preliminaries", "text": "Consider m convex functions gj : Rd 7\u2192 R which induce a convex constraint set\nX , {\nx \u2208 Rd : max j\u2208{1,\u00b7\u00b7\u00b7 ,m}\ngj(x) \u2264 0 } .\nWe assume that the set X is bounded so that it is included in some Euclidean ball B with radius R > 0 (to be further discussed in Section 5):\nX \u2286 B , { x \u2208 Rd : \u2016x\u20162 \u2264 R } .\nAlong with the functions gj , we consider a sequence of convex functions ft : Rd 7\u2192 R+ such that\nmax t\u2208{1,\u00b7\u00b7\u00b7 ,T} max x,x\u2032\u2208B\n|ft(x)\u2212 ft(x\u2032)| \u2264 F for some F > 0.\nAs is typically assumed in online learning [6], the functions gj and ft shall be taken to be Lipschitz continuous. We do not generally assume gj and ft to be differentiable. We further assume that for some finite G > 0 the (sub-)gradients of f and gj are bounded\nmax j\u2208{1,\u00b7\u00b7\u00b7 ,m} max x\u2208B \u2016\u2207gj(x)\u20162 \u2264 G,\nmax t\u2208{1,\u00b7\u00b7\u00b7 ,T} max x\u2208B \u2016\u2207ft(x)\u20162 \u2264 G.\nWe take the same constant G for, both, gj and ft for simplicity as we can always take the maximum between that of gj and that of ft. Finally, we assume that there exists a finite D > 0 such that the constraint functions are bounded over B:\nmax j\u2208{1,\u00b7\u00b7\u00b7 ,m} max x\u2208B |gj(x)| \u2264 D.\nFinally, we note that the set of assumptions enumerated in this section are equivalent to the ones in [15].\nR.Jenatton, J.Huang, C. Archambeau"}, {"heading": "2.2 Problem Statement", "text": "Let {xt}Tt=1 be the sequence of vectors played by the learner and {ft(xt)}Tt=1 the corresponding sequence of incurred losses. We aim at efficiently solving the following optimization problem in online fashion:\nmin xT\u2208B\n{ fT (xT ) + . . .\n+ min x2\u2208B\n{ f2(x2) + min\nx1\u2208B f1(x1)\n}} \u2212min\nx\u2208X T\u2211 t=1 ft(x)\nsubject to the following long-term constraint :\nmax j\u2208{1,\u00b7\u00b7\u00b7 ,m} T\u2211 t=1 gj(xt) \u2264 0."}, {"heading": "3 Adaptive Online Algorithms based on a Saddle-point Formulation", "text": "Following [15], we consider a saddle-point formulation of the optimization problem. For any \u03bb \u2208 R+,x \u2208 B we define the following function:\nLt(x, \u03bb) , ft(x) + \u03bbg(x)\u2212 \u03b8t 2 \u03bb2\nwhere g(x) , maxj\u2208{1,\u00b7\u00b7\u00b7 ,m} gj(x) and {\u03b8t}Tt=1 is a sequence of positive numbers to be specified later. The role of g is to aggregate the m constraints into a single function. It otherwise preserves the same properties as those of individual gj \u2019s (sub-differentiability, bounded (sub-)gradients and bounded values; see Proposition 6 in [15] or Section 2.3 in [5] for a proof). In the saddle-point formulation (2), we will alternate between minimizing with respect to the primal variable x and maximizing with respect to the dual parameter \u03bb. A closer look at the function \u03bb 7\u2192 Lt(x, \u03bb) indicates that we penalize the violation of the constraint g(x) \u2264 0 through, using [u]+ , max{0, u},\n1\n2\u03b8t [g(x)]2+ = sup \u03bb\u2208R+\n[ \u03bbg(x)\u2212 \u03b8t 2 \u03bb2 ] , (2)\nwhich is a penalty commonly used when going from constrained to unconstrained problems (e.g., Section 17.1 in [21]). Also, we can see from (2) that \u03b8t acts as a regularization parameter. We note at this point that in contrast to our method, [15] make use of a single \u03b8 that is constant in all rounds.1\nIn the sequel, we study the following online algorithm where we alternate between primal-descent and dualascent steps:\n\u2022 Initialize x1 = 0 and \u03bb1 = 0 1More precisely, in [15], \u03b8 is equal to the product of a\nconstant step size times a constant scaling factor.\n\u2022 For t \u2208 {1, \u00b7 \u00b7 \u00b7 , T \u2212 1}: xt+1 = \u03a0B(xt \u2212 \u03b7t\u2207xLt(xt, \u03bbt)) \u03bbt+1 = \u03a0R+(\u03bbt + \u00b5t\u2207\u03bbLt(xt, \u03bbt)),\nwhere \u03a0C stands for the Euclidean projection onto the set C, while {\u03b7t}Tt=1 and {\u00b5t}Tt=1 are sequences of nonnegative step sizes that respectively drive the update of x and \u03bb. The algorithm is in the same vein as the ones proposed in [15, 13], but it is adaptive. The step sizes, which are different for the updates of x and \u03bb, are listed in Table 1. They result from the analysis we provide in the next section. We also derive sub-linear regret bounds associated to these instantiations of the sequences {\u03b8t}Tt=1, {\u03b7t}Tt=1 and {\u00b5t}Tt=1."}, {"heading": "3.1 Main Results", "text": "We begin by listing three sufficient conditions for obtaining sub-linear regret bounds for the proposed algorithm:\n(C1): For any t \u2265 2, 1\u00b5t \u2212 1 \u00b5t\u22121 \u2212 \u03b8t \u2264 0.\n(C2): For any t \u2265 2, \u03b7tG2 + \u00b5t\u03b82t \u2212 12\u03b8t \u2264 0. (C3): For some finite U\u03b7 > 0,\u2211T t=2 [ 1 \u03b7t \u2212 1\u03b7t\u22121 \u2212 \u03c3 ] \u2264 U\u03b7.\nConditions C1 and C3 impose constraints on the decreasing speed of the step sizes. We note that there is an asymmetry between \u00b5t and \u03b7t: while we will always be able to control the norm of the variables xt (by design, they must lie in B), the sequence {\u03bbt}Tt=1 is not directly upper-bounded in the absence of further assumptions on the gradient of g, hence the most stringent condition C1 is to avoid any dependencies on \u03bbt. Condition C2 couples the behaviour of the three sequences to guarantee their validity. Finally, C1, C2 and C3 are expressed for t \u2265 2 because of our choice for the initial conditions x1 = 0 and \u03bb1 = 0.\nOur main result is described in the following theorem, whose proof is in Section 3.2:\nTheorem 1. Consider the convex case (\u03c3 = 0) and the corresponding instantiations of the sequences \u00b5t, \u03b7t and \u03b8t for some \u03b2 \u2208 (0, 1), as summarized in Table 1. It holds for any T \u2265 1 that\nT\u2211 t=1 \u2206ft\u2264RfT , [ RG+ D2 6\u03b2RG ] T \u03b2 + 2RG 1\u2212 \u03b2 T 1\u2212\u03b2\nwhere \u2206ft , ft(xt)\u2212 ft(x?), and\nT\u2211 t=1 g(xt) \u2264\n\u221a 24RG\n1\u2212 \u03b2\n( RfT + FT ) T 1\u2212\u03b2 .\nFor the strongly convex case (\u03c3 > 0), we also have valid instantiations of \u03b7t, \u00b5t, \u03b8t (see Table 1), whose resulting cumulative regret bounds are tighter than those given in Theorem 1, but with the same leading terms. Theorem 1 can be stated in a simplified form, forgetting momentarily about the dependencies on {D,G,R, F}:\u2211T\nt=1 \u2206ft \u2264 O(max{T \u03b2 , T 1\u2212\u03b2}),\u2211T t=1 g(xt) \u2264 O(T 1\u2212\u03b2/2).\nIn particular, by setting \u03b2 = 2/3, we obtain\nT\u2211 t=1 \u2206ft \u2264 O(T 2/3) and T\u2211 t=1 g(xt) \u2264 O(T 2/3),\nwhich matches the mirror prox guarantees of [15] while being valid for general convex constraint sets X as opposed to just polyhedral constraint sets. Similarly, taking \u03b2 = 1/2, we recover the regret bounds\nT\u2211 t=1 \u2206ft \u2264 O(T 1/2) and T\u2211 t=1 g(xt) \u2264 O(T 3/4),\nof Section 3.1 in [15]. We can, of course, also define novel trade-offs between loss and constraint violations, e.g., \u03b2 = 3/4 with regret bounds of O(T 3/4) and O(T 5/8) respectively."}, {"heading": "3.2 Analysis and Proofs", "text": "To analyze the above algorithm, we first introduce a series of lemmas. The analysis is analogous to that developed in [15], which we provide below for selfcontainedness. We begin by upper-bounding the variations of Lt with respect to its two arguments. In particular, the following lemma takes advantage of the fact that the partial function \u03bb 7\u2192 Lt(xt, \u03bb) is not only concave as considered in [15], but strongly concave with parameter \u03b8t. This observation is at the origin of our improved regret bounds.\nLemma 1 (Upper bound of Lt(xt, \u03bb)\u2212Lt(xt, \u03bbt)). For Lt(x, \u03bb) as defined above and for non-negative \u03b7t, \u03b8t and \u00b5t, we have\nLt(xt, \u03bb)\u2212 Lt(xt, \u03bbt) \u2264 12\u00b5t [ bt \u2212 bt+1 ] \u2212 \u03b8t2 bt\n+\u00b5t2 [\u2207\u03bbLt(xt, \u03bbt)] 2\nwhere bt , (\u03bb\u2212 \u03bbt)2.\nProof. Expanding (\u03bb\u2212 \u03bbt+1)2 yields (\u03bb\u2212 \u03bbt+1)2 = ( \u03bb\u2212\u03a0R+(\u03bbt + \u00b5t\u2207\u03bbLt(xt, \u03bbt)) )2 \u2264 ( \u03bb\u2212 (\u03bbt + \u00b5t\u2207\u03bbLt(xt, \u03bbt))\n)2 = (\u03bb\u2212 \u03bbt)2 \u2212 2\u00b5t(\u03bb\u2212 \u03bbt)\u2207\u03bbLt(xt, \u03bbt) + \u00b52t (\u2207\u03bbLt(xt, \u03bbt))2\nBy strong concavity of Lt(xt, \u03bb) with respect to \u03bb,\nLt(xt, \u03bbt)\u2212 Lt(x\u0302t, \u03bb) \u2264 (\u03bb\u2212 \u03bbt)\u2207\u03bbLt(xt, \u03bbt)\u2212 \u03b8t 2 bt.\nSubstituting the inequality for \u00b5t(\u03bb\u2212 \u03bbt)\u2207\u03bbLt(xt, \u03bbt) completes the proof.\nWe omit the derivation for x 7\u2192 Lt(x, \u03bbt) that follows similar arguments. We now turn to a lower-bound of the variations of Lt. Lemma 2. Let x? = arg minx\u2208X \u2211T t=1 ft(x). Then\nT\u2211 t=1 Lt(xt, \u03bb)\u2212 Lt(x?, \u03bbt) \u2265\nT\u2211 t=1 \u2206ft + \u03bb T\u2211 t=1 g(xt)\u2212 \u03bb2 2 T\u2211 t=1 \u03b8t + 1 2 T\u2211 t=1 \u03b8t\u03bb 2 t .\nProof. We have Lt(xt, \u03bb)\u2212 Lt(x?, \u03bbt) equal to\nft(xt)\u2212 ft(x?) + \u03bbg(xt)\u2212 \u03bbtg(x?)\u2212 \u03b8t 2 (\u03bb2 \u2212 \u03bb2t ).\nWe simply notice that g(x?) \u2264 0 to obtain a lower bound \u2212g(x?) \u2211T t=1 \u03bbt to complete the proof after summing both sides over rounds t = 1, \u00b7 \u00b7 \u00b7 , T .\nLemma 3. Let at , \u2016xt \u2212 x\u20162. For any \u03c3, \u03b8t \u2265 0, T\u2211 t=1 1 2\u03b7t [ at \u2212 at+1 ] \u2212 \u03c3 2 at \u2264\nR2\n2 \u03b4\u03b7 +\n1\n2 T\u2211 t=2 at [ 1 \u03b7t \u2212 1 \u03b7t\u22121 \u2212 \u03c3 ] ,\nT\u2211 t=1 1 2\u00b5t [ bt \u2212 bt+1 ] \u2212 \u03b8t 2 bt \u2264\n\u03bb2\n2 \u03b4\u00b5 +\n1\n2 T\u2211 t=2 bt [ 1 \u00b5t \u2212 1 \u00b5t\u22121 \u2212 \u03b8t ]\nR.Jenatton, J.Huang, C. Archambeau\nwhere we have used \u03b4\u03b7 , 1\u03b71 \u2212 \u03c3 and \u03b4\u00b5 , 1 \u00b51 \u2212 \u03b81.\nProof. Shifting indices in the sums for terms that depend on at+1/\u03b7t, bt+1/\u00b5t and collecting terms that depend on at, bt, we then use a1 = \u2016x1 \u2212 x\u201622 = \u2016x\u201622 \u2264 R2 and b1 = (\u03bb\u2212 \u03bb1)2 = \u03bb2 to conclude.\nWe now present the key lemma of the analysis.\nLemma 4. [Cumulative regret bound] Let x? = arg minx\u2208X \u2211T t=1 ft(x) and assume C1, C2 and C3 hold. Define RfT , R2 2 \u03b4\u03b7+G 2S\u03b7+D 2S\u00b5+R 2U\u03b7, where\nwe have introduced S\u03b7 , \u2211T t=1 \u03b7t, S\u00b5 , \u2211T t=1 \u00b5t and\nS\u03b8 , \u2211T t=1 \u03b8t. Then, it holds that\u2211T\nt=1 \u2206ft \u2264 R f T ,\nand\u2211T t=1 g(xt) \u2264 \u221a 2(S\u03b8 + \u03b4\u00b5)(RfT + FT ).\nProof. By the triangle inequality, we have \u2016\u2207xLt(x, \u03bb)\u201622 \u2264 2G2(1 + \u03bb2) and ( \u2207\u03bbLt(x, \u03bb) )2 \u2264 2(D2 + \u03b82t\u03bb\n2). We then combine Lemmas 1-3, starting from Lt(xt, \u03bb) \u2212 Lt(x\u2217, \u03bbt) = Lt(xt, \u03bb) \u2212 Lt(xt, \u03bbt) + Lt(xt, \u03bbt) \u2212 Lt(x\u2217, \u03bbt), yielding\u2211T\nt=1 \u2206ft + \u03bb \u2211T t=1 g(xt)\u2212 \u03bb2 2 [ S\u03b8 + \u03b4\u00b5 ] \u2264\nRfT + \u2211T t=1 \u03bb 2 t [ \u03b7tG 2 + \u00b5t\u03b8 2 t \u2212 12\u03b8t ] .\nMaximizing the left-hand side with respect to \u03bb \u2208 R+, we obtain:\n\u2211T t=1 \u2206ft +\n[\u2211T t=1 g(xt) ]2 +\n2 [ S\u03b8+\u03b4\u00b5 ] \u2264 RfT + \u2211T t=1 \u03bb 2 t [ \u03b7tG 2 + \u00b5t\u03b8 2 t \u2212 12\u03b8t ] .\nThe regret bound on the loss is obtained by using C2 and [ \u2211T t=1 g(xt)] 2 +/(2[S\u03b8 + \u03b4\u00b5]) \u2265 0. The bound on constraint violations is obtained as above, but by substituting the lower bound \u2211 t \u2206ft \u2265 \u2212FT .\nIn order to discuss the scaling of our regret bounds, we state the next simple lemma without proof\nLemma 5. Let \u03b2 \u2208 (0, 1). Then \u2211T t=1 1 t\u03b2 \u2264 T 1\u2212\u03b2 1\u2212\u03b2 .\nWith the above lemmas, we now prove Theorem 1:\nProof of Theorem 1. For the proposed choices of \u03b8t, \u00b5t and \u03b7t, we can verify that C1, C2 and C3 hold. Here we focus on the convex case, the strongly convex one following along the same lines. First, we can easily see that C1 is true as long as \u03b8t is non-increasing. Then, we can notice that, given the choice of \u00b5t, condition C2\nis implied by the stronger condition \u03b7t \u2264 \u03b8t6G2 (satisfied by the choice of \u03b7t and \u03b8t in Table 1). This results in\nS\u00b5 = T\u2211 t=1\n1\n\u03b8t(t+ 1) \u2264 T\u2211 t=1 t\u03b2 6RGt \u2264 T \u03b2 6\u03b2RG .\nS\u03b7 = T\u2211 t=1 \u03b7t \u2264 R G T 1\u2212\u03b2 1\u2212 \u03b2 , S\u03b8 = T\u2211 t=1 6RG t\u03b2 \u2264 6RG 1\u2212 \u03b2 T 1\u2212\u03b2 ,\nalong with 1/\u00b51 \u2212 \u03b81 = 6RG and 1/\u03b71 \u2212 \u03c3 = G/R. The term U\u03b7 can be obtained by summing the series 1/\u03b7t \u2212 1/\u03b7t\u22121 = (G/R)(t\u03b2 \u2212 (t \u2212 1)\u03b2) over t, which directly simplifies by telescoping for the \u03c3 = 0 case, and is identically equal to zero for \u03c3 > 0. As a result, we obtain from Lemma 4 T\u2211 t=1 \u2206ft\u2264RfT , [ RG+ D2 6\u03b2RG ] T \u03b2 + RG 1\u2212 \u03b2 T 1\u2212\u03b2 + RG 2\nand for the constraint\nT\u2211 t=1 g(xt) \u2264\n\u221a 2(RfT + FT ) [ 6RG\n1\u2212 \u03b2 T 1\u2212\u03b2 + 6RG\n] .\nWe obtain the desired conclusion by noticing that for any T \u2265 1 and \u03b2 \u2208 (0, 1), we have T 1\u2212\u03b2\n1\u2212\u03b2 \u2265 1."}, {"heading": "3.3 Towards No Violation of Constraints", "text": "We next show that our extension also applies to the more specific setting developed in Section 3.2 from [15], where additional assumptions on the gradient of g can translate into no constraint violations. For the sake of self-containedness, we briefly recall it. Assume that there exist \u03b3 \u2265 0 and r > 0 such that the variations of g are lower bounded as\nmin x\u2208Rd:g(x)+\u03b3=0\n\u2016\u2207g(x)\u20162 \u2265 r. (3)\nDenote X\u03b3 , {x \u2208 Rd : g(x) + \u03b3 \u2264 0} \u2282 X . It can then be shown that (see Theorem 7 in [15]):\u2223\u2223\u2223\u2211Tt=1 ft(x?)\u2212\u2211Tt=1 ft(x\u03b3)\u2223\u2223\u2223 \u2264 Gr T\u03b3, (4) where x? and x\u03b3 are solutions of minx\u2208X \u2211T t=1 ft(x)\nand minx\u2208X\u03b3 \u2211T t=1 ft(x) respectively. In words, the gap between the optimal value of the original optimization problem and that of the problem over X\u03b3 is well-controlled as a function of (\u03b3, r). Examples where (3) holds include the positive semi-definite cone, as described in Section 4 of [17]. For space limitation reasons, we state our result in a simplified form, only briefly sketching its proof that follows the same logic as that of the previous section.\nCorollary 1. Assume (3) holds. Consider the convex case (\u03c3 = 0) and some instantiations of the sequences \u00b5t, \u03b7t and \u03b8t for some \u03b2 \u2208 (0, 1), differing from Table 1 only up to numerical constants. There exist c0 and c1 depending on {D,G,R, F, r} such that setting \u03b3 , c1T\n\u2212\u03b2/2, we have for any T \u2265 c0\u2211T t=1 \u2206ft \u2264 O(max{T \u03b2 , T 1\u2212\u03b2 , T 1\u2212\u03b2/2}),\nand no constraint violations \u2211T t=1 g(xt) \u2264 0.\nSketch of proof. We can apply the same analysis as before to the function g\u03b3(x) , g(x) + \u03b3, replacing D by D + \u03b3 and adapting the constants in both C2 (i.e., \u03b7tG 2 + 32\u00b5t\u03b8 2 t \u2212 12\u03b8t) as well as for the instantia-\ntions of \u00b5t, \u03b7t and \u03b8t. The regret bound on \u2211T t=1 \u2206ft is identical as earlier, with additional additive terms 3\u03b32S\u00b5/2 and GT\u03b3/r introduced as a result of (4). As\nfor \u2211T t=1 g(xt), the term [ \u2211T t=1 g(xt)] 2 + becomes here\n[ \u2211T t=1 g(xt) + \u03b3T ] 2 +, which in turn leads to the same regret bound as previously stated, minus the contribution \u2212\u03b3T . We cancel out the constraint violations\u2014 scaling in O(T 1\u2212\u03b2/2) according to Theorem 1\u2014by setting \u03b3 = c1T\n\u2212\u03b2/2. Note that c0 is determined by examining when the extra term 3\u03b32S\u00b5/2 can be upper bounded by those in RfT .\nThe regret bound presented in Corollary 1 is minimized for \u03b2 = 2/3, leading to a regret of O(T 2/3) with no constraint violations. This result extends Theorem 8 and Corollary 13 from [15] in that it holds for general convex domains X (as opposed to only polyhedral ones)."}, {"heading": "4 Experiments", "text": "We ran two sets of experiments to validate the regret bounds obtained for our adaptive algorithms for OCO with long-term constraints and compare to the algorithms proposed in [15]. First, we examine the online estimation of doubly-stochastic matrices where the convex domain of interest X is polyhedral but whose projection operator is difficult to compute [12, 10]. Second, we consider sparse online binary classification based on the elastic net penalty [27].\nWe shall refer to our adaptive online gradient descent (A-OGD) for convex ft (i.e., \u03c3 = 0) as Convex A-OGD and for strongly convex ft (i.e., \u03c3 > 0) as Strongly convex A-OGD, which enjoy the same regret guarantees of O(T 2/3) for the loss and constraint. The method of [15] that handles general convex domains X will be referred to as Convex OGD, while the mirror prox method analyzed in [15], which is only applicable to polyhedral domains, will be denoted by Convex mirror prox. The parameters of\nConvex OGD and Convex mirror prox are instantiated according to [15].\nAlthough we generate the sequence of losses {ft}Tt=1 stochastically in the experiments, we would like to emphasize that the regret bounds we obtain are also valid for adversarially-generated sequences, so that it is not required that {ft}Tt=1 are generated in i.i.d. fashion."}, {"heading": "4.1 Doubly-Stochastic Matrices", "text": "Doubly-stochastic matrices appear in many machine learning and optimization problems, such as clustering applications [25] or learning permutations [12, 10]. Briefly, for a sequence of matrices {Yt}Tt=1 in Rp\u00d7p, we solve the following optimization problem in an online fashion:\nmin X\u2208Rp\u00d7p T\u2211 t=1 1 2 \u2016Yt \u2212X\u20162F (5)\nsubject to the (linear) convex constraints\nX \u2265 0, X1 = 1 and X>1 = 1.\nThis problem can easily be mapped to OCO setting by assuming that the sequence {Y}Tt=1 is generated by random permutation matrices which are known to constitute the extreme points of the set of doublystochastic matrices [4]. We have d = p2, ft(X) = 1 2\u2016Yt \u2212 X\u2016 2 F and m = p\n2 + 4p to describe all the linear constraints, more specifically there are p2 nonnegativity constraints, along with 4p inequalities to model the 2p equality constraints. This leads to the following instantiations of the parameters controlling ft and g: R = \u221a p, G = 2R and D = R. Note that we can apply a) Strongly convex A-OGD (since ft is by construction strongly convex with parameter \u03c3 = 1), and b) Convex mirror prox since X is polyhedral.\nThe cumulative regret for the loss and the long-term constraint are shown in Figures 1 and 2. They are computed over T = 1000 iterations with d = 64, and are averaged over 10 random sequences {Yt}Tt=1 (the standard deviations are not shown since they are negligible). The offline solutions of (5) required for various t \u2208 {1, \u00b7 \u00b7 \u00b7 , T} to compute the regret are obtained using CVXPY [8].\nThe results shown in Figure 1 and 2 indicate that although the cumulative regret bounds for Strongly convex A-OGD were not demonstrated to be tighter in our analysis than those for Convex A-OGD, they achieve a better cumulative regret for this problem, especially with respect to the long-term constraint. Also, while Convex mirror prox and Convex A-OGD should theoretically exhibit the same behavior, the results suggest that mirror prox is not able to decrease cumulative regret at the same\nR.Jenatton, J.Huang, C. Archambeau\nrate as our proposed method. We surmise that this may be due to the fact that the guarantees of Convex mirror prox proved in [15] only hold for very large T .2"}, {"heading": "4.2 Sparse Online Binary Classification", "text": "Next, we examine the application of sparse online binary classification. Our goal will be to minimize the log-loss subject to a constrained elastic-net penalty:3\nmin x\u2208Rd:\u2016x\u20161+ 12\u2016x\u2016 2 2\u2264\u03c1 T\u2211 t=1 log(1 + e\u2212ytx >ut), (6)\nwhere {yt,ut}Tt=1 denotes a sequence of label/featurevector pairs and \u03c1 > 0 is a parameter that measures the degree of the sparsity of the solutions of (6).\nThis problem is mapped to our formulation by setting ft(x) = log(1 + e \u2212ytx>ut) with m = 1, g(x) = \u2016x\u20161 + 12\u2016x\u2016 2 2 \u2212 \u03c1, R = \u221a 1 + 2\u03c1\u2212 1,4 G = max{ \u221a d+\nR,maxt \u2016ut\u20162} and D = \u221a dR+R2/2. The sequences {yt,ut}Tt=1 are generated by drawing pairs at random with replacement.\nWe solve the above problem using the datasets ijcnn1 and covtype, consisting respectively of 49, 990 and 581, 012 samples of dimension d = 22 and d = 54\n2Theorem 12 from [15] requires T \u2265 164(m+1)2, which translates into T > 107 in our setting.\n3Constraint formulations with sparsity-inducing terms are sometimes preferred over their penalized counterparts when they express some concrete physical budget, e.g., in the context of learning predictors with low-latency [24].\n4The value for R is found by noticing that \u2016x\u20161 + 1 2 \u2016x\u201622 \u2265 \u2016x\u20162 + 12\u2016x\u2016 2 2 and solving the resulting secondorder polynomial inequality.\neach5. The parameter \u03c1 is set to obtain approximately 30% of non-zero variables. Moreover, and in order to best display cumulative regret, we compute offline solutions of (6) for various t \u2208 {1, \u00b7 \u00b7 \u00b7 , T} thanks to an implementation of [7].\nThe results are summarized in Figures 3 and 4 and represent an average over 10 random sequences {yt,ut}Tt=1 (the standard deviations are not shown since they are negligible). The number of iterations T is equal to the number of samples in each dataset. Interestingly, we observe that the constraint is not violated on average (i.e., via a negative cumulative regret) and the iterates xt remain feasible within the domain \u2016x\u20161 + 12\u2016x\u2016 2 2 \u2264 \u03c1. This tendency is more pronounced for Convex OGD\n5 www.csie.ntu.edu.tw/ cjlin/libsvmtools/datasets/binary.html\nsince a closer inspection of the sequence {\u03b7t}Tt=1 shows numerical values smaller than those of our approach Convex A-OGD (by 2 to 3 orders of magnitude). As a result, starting from x1 = 0, we found that the iterates generated by Convex OGD do not approach the boundary of the domain, hence increasing regret on cumulative loss. We also note that the offline solutions of (6) always saturate the constraint. Although our analysis predicts that the cumulative regret of Convex OGD associated to the loss (i.e., O(T 1/2)) should be smaller than that associated to Convex A-OGD (i.e., O(T 2/3)), Convex A-OGD achieves here a lower cumulative regret. This observation may be explained by the same argument as that described previously, namely that the larger step sizes {\u03b7t}Tt=1 of Convex A-OGD enables us to make faster progress."}, {"heading": "5 Discussion", "text": "In this section, we discuss several generalizations.\nBroader families of step sizes. We have assumed that the updates of the primal variable x are driven by a projected gradient step controlled through a single step size \u03b7t. Following the ideas developed in [19, 9], we could analyze the regret guarantees of our algorithm when there is a vector of step sizes \u03b7t that is given by a diagonal matrix Diag(\u03b7t) \u2208 Rd\u00d7d, updating adaptively and separately each coordinate of x.\nCan we identify a better penalty? In the light of (2), it is tempting to ask whether we can find a penalty function that will lead to lower cumulative regret guarantees. To this end, we could for example introduce a smooth, 1-strongly-convex function \u03c6 with domain \u2126. The saddle-point formulation of the new problem is then given by\nLt(x, \u03bb) , ft(x) + \u03bbg(x)\u2212 \u03b8t\u03c6(\u03bb),\nwhere {\u03b8t}Tt=1 is, as earlier, a sequence of non-negative numbers to be specified subsequently for any \u03bb \u2208 \u2126,x \u2208 B. Interestingly, it can be shown that condition C2 becomes a first-order nonlinear ordinary differential inequality in this setting, leading to\n\u03b7tG 2\u03bb2 + \u00b5t\u03b8 2 t\n[ d\u03c6\nd\u03bb\n]2 \u2212 \u03b8t\u03c6(\u03bb) \u2264 0, for all \u03bb \u2208 \u2126.\nHence, the above differential inequality suggests a family of penalty functions which we could use. In particular, we see that \u03c6 must grow at least quadratically and stay greater than its squared first derivative, which rules out a softmax penalty like \u03bb 7\u2192 log(1+e\u03bb). Moreover, the maximization with respect to \u03bb in the last step of Lemma 4 introduces the Moreau envelope [14] of the Fenchel conjugate of \u03c6, namely\n\u03c6\u2217S\u03b8 (u) , sup \u03bb\u2208\u2126\n[ \u03bbu\u2212 S\u03b8\u03c6(\u03bb)\u2212 \u03b4\u00b5 \u03bb2\n2\n] .\nThe goal is then to find a feasible penalty \u03c6 of which the inverse mapping u 7\u2192 [\u03c6\u2217S\u03b8 ]\n\u22121(u) would minimize the regret bound. For instance, the inverse mapping would scale as u 7\u2192 \u221a u when using the squared `2 norm over \u2126 = R+. We defer to future work the study of this admissible family of penalties.\nWhich enclosing set for X? Our current analysis relies on the idea that instead of having to perform a projection on X in each update (which could be computationally costly and perhaps intractable in some cases), we restrict the iterates xt to remain within a simpler convex set B \u2287 X . While we assumed de facto an Euclidean ball for B, we could consider sets enclosing X more tightly, while preserving the appealing computational properties. Having a principled methodology to choose B and carefully assessing its impact on the regret bounds is an interesting avenue for future research."}], "references": [{"title": "Fast algorithms for online stochastic convex programming", "author": ["Shipra Agrawal", "Nikhil R. Devanur"], "venue": "In SODA 2015 (ACM-SIAM Symposium on Discrete Algorithms). SIAM-Society for Industrial and Applied Mathematics,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2015}, {"title": "Online linear optimization and adaptive routing", "author": ["Baruch Awerbuch", "Robert Kleinberg"], "venue": "Journal of Computer and System Sciences,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2008}, {"title": "Parallel and Distributed Computation: Numerical Methods", "author": ["Dimitri P. Bertsekas", "John N. Tsitsiklis"], "venue": "Prentice-Hall, Inc.,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 1989}, {"title": "Tres observaciones sobre el algebra lineal", "author": ["Garrett Birkhoff"], "venue": "Univ. Nac. Tucuma\u0301n Rev. Ser. A,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 1946}, {"title": "Convex Analysis and Nonlinear Optimization: Theory and Examples", "author": ["J.M. Borwein", "A.S. Lewis"], "venue": "Springer", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2006}, {"title": "Prediction, learning, and games", "author": ["Nicolo Cesa-Bianchi", "G\u00e1bor Lugosi"], "venue": null, "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2006}, {"title": "Saga: A fast incremental gradient method with support for non-strongly convex composite objectives", "author": ["Aaron Defazio", "Francis Bach", "Simon Lacoste- Julien"], "venue": "Technical report, preprint arXiv:1407.0202,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2014}, {"title": "CVXPY: A Python-embedded modeling language for convex optimization, version 0.2", "author": ["Steven Diamond", "Eric Chu", "Stephen Boyd"], "venue": "http://cvxpy.org/,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2014}, {"title": "Adaptive subgradient methods for online learning and stochastic optimization", "author": ["J. Duchi", "E. Hazan", "Y. Singer"], "venue": "Journal of Machine Learning Research, 12:2121\u20132159", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2011}, {"title": "d\u2019Aspremont. Convex relaxations for permutation problems", "author": ["Fajwel Fogel", "Rodolphe Jenatton", "Francis Bach", "Alexandre"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2013}, {"title": "Logarithmic regret algorithms for online convex optimization", "author": ["Elad Hazan", "Amit Agarwal", "Satyen Kale"], "venue": "Machine Learning,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2007}, {"title": "Learning permutations with exponential weights", "author": ["D.P. Helmbold", "M.K. Warmuth"], "venue": "Journal of Machine Learning Research, 10:1705\u20131736", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2009}, {"title": "A saddle point algorithm for networked online convex optimization", "author": ["Alec Koppel", "Felicia Y Jakubiec", "Alejandro Ribeiro"], "venue": "In Acoustics, Speech and Signal Processing (ICASSP),", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2014}, {"title": "Practical aspects of the moreau\u2013yosida regularization: Theoretical preliminaries", "author": ["Claude Lemar\u00e9chal", "Claudia Sagastiz\u00e1bal"], "venue": "SIAM Journal on Optimization,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 1997}, {"title": "Trading regret for efficiency: online convex optimization with long term constraints", "author": ["Mehrdad Mahdavi", "Rong Jin", "Tianbao Yang"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2012}, {"title": "Efficient constrained regret minimization", "author": ["Mehrdad Mahdavi", "Tianbao Yang", "Rong Jin"], "venue": "Technical report, preprint arXiv:1205.2265,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2012}, {"title": "Stochastic gradient descent with only one projection", "author": ["Mehrdad Mahdavi", "Tianbao Yang", "Rong Jin", "Shenghuo Zhu", "Jinfeng Yi"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2012}, {"title": "Online learning with constraints. In Learning Theory, pages 529\u2013543", "author": ["Shie Mannor", "John N Tsitsiklis"], "venue": null, "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2006}, {"title": "Adaptive bound optimization for online convex optimization", "author": ["H Brendan McMahan", "Matthew Streeter"], "venue": "In Proceedings of the annual conference on Computational Learning Theory (COLT),", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2010}, {"title": "Prox-method with rate of convergence o (1/t) for variational inequalities with lipschitz continuous monotone operators and smooth convex-concave saddle point problems", "author": ["Arkadi Nemirovski"], "venue": "SIAM Journal on Optimization,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2004}, {"title": "Numerical Optimization", "author": ["J. Nocedal", "S.J. Wright"], "venue": "Springer", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2006}, {"title": "Mind the duality gap: Logarithmic regret algorithms for online optimization", "author": ["Shai Shalev-Shwartz", "Sham M Kakade"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2009}, {"title": "Online alternating direction method", "author": ["Huahua Wang", "Arindam Banerjee"], "venue": "Technical report, preprint arXiv:1306.3721,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2013}, {"title": "The greedy miser: Learning under test-time budgets", "author": ["Zhixiang Xu", "Kilian Weinberger", "Olivier Chapelle"], "venue": "Technical report, preprint arXiv:1206.6451,", "citeRegEx": "24", "shortCiteRegEx": "24", "year": 2012}, {"title": "Doubly stochastic normalization for spectral clustering", "author": ["Ron Zass", "Amnon Shashua"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "25", "shortCiteRegEx": "25", "year": 2006}, {"title": "Online convex programming and generalized infinitesimal gradient ascent", "author": ["Martin Zinkevich"], "venue": "In Proceedings of the International Conference on Machine Learning (ICML),", "citeRegEx": "26", "shortCiteRegEx": "26", "year": 2003}, {"title": "Regularization and variable selection via the elastic net", "author": ["H. Zou", "T. Hastie"], "venue": "Journal of the Royal Statistical Society. Series B, 67(2):301\u2013320", "citeRegEx": "27", "shortCiteRegEx": null, "year": 2005}], "referenceMentions": [{"referenceID": 1, "context": "Online convex optimization (OCO) plays a key role in machine learning applications, such as adaptive routing in networks [2] and online display advertising [1].", "startOffset": 121, "endOffset": 124}, {"referenceID": 0, "context": "Online convex optimization (OCO) plays a key role in machine learning applications, such as adaptive routing in networks [2] and online display advertising [1].", "startOffset": 156, "endOffset": 159}, {"referenceID": 25, "context": "The problem was formalized in the seminal work of [26], which presents an online algorithm based on projected gradient descent [3] that guarantees a cumulative regret of O(T ) when the set X is convex and the loss functions are Lipschitz-continuous over X .", "startOffset": 50, "endOffset": 54}, {"referenceID": 2, "context": "The problem was formalized in the seminal work of [26], which presents an online algorithm based on projected gradient descent [3] that guarantees a cumulative regret of O(T ) when the set X is convex and the loss functions are Lipschitz-continuous over X .", "startOffset": 127, "endOffset": 130}, {"referenceID": 10, "context": "In [11] and [22], algorithms with logarithmic regret bounds were proposed for strongly convex loss functions.", "startOffset": 3, "endOffset": 7}, {"referenceID": 21, "context": "In [11] and [22], algorithms with logarithmic regret bounds were proposed for strongly convex loss functions.", "startOffset": 12, "endOffset": 16}, {"referenceID": 17, "context": "Another example is from wireless communications [18], where xt is a vector of power allocations across multiple devices, and the learner must satisfy average power consumption constraints per device.", "startOffset": 48, "endOffset": 52}, {"referenceID": 14, "context": "This class of problems was studied previously in [15, 16].", "startOffset": 49, "endOffset": 57}, {"referenceID": 15, "context": "This class of problems was studied previously in [15, 16].", "startOffset": 49, "endOffset": 57}, {"referenceID": 15, "context": "In particular, [16] considered online exponentially-weighted average in the case where the loss and constraints are linear, while [15] presented online algorithms based on projected subgradients and the mirror prox method [20].", "startOffset": 15, "endOffset": 19}, {"referenceID": 14, "context": "In particular, [16] considered online exponentially-weighted average in the case where the loss and constraints are linear, while [15] presented online algorithms based on projected subgradients and the mirror prox method [20].", "startOffset": 130, "endOffset": 134}, {"referenceID": 19, "context": "In particular, [16] considered online exponentially-weighted average in the case where the loss and constraints are linear, while [15] presented online algorithms based on projected subgradients and the mirror prox method [20].", "startOffset": 222, "endOffset": 226}, {"referenceID": 14, "context": "The analysis of [15] assumes the number of rounds is known ahead of time, which enables the authors to set the various constants in the algorithm that lead to the desired regret bounds.", "startOffset": 16, "endOffset": 20}, {"referenceID": 16, "context": "This is closely related to recent work in stochastic optimization that aims to minimize the number of expensive projection steps [17].", "startOffset": 129, "endOffset": 133}, {"referenceID": 22, "context": "The guarantees sought in our analysis have also similarities with the results obtained in the context of the online alternating direction method [23], where regret bounds are provided for the violation of equality constraints.", "startOffset": 145, "endOffset": 149}, {"referenceID": 14, "context": "Contributions: Building on the work of [15], we propose an algorithm based on a saddle-point formulation of the OCO problem with long-term constraints, which is adaptive (i.", "startOffset": 39, "endOffset": 43}, {"referenceID": 14, "context": "Also, the algorithm we derive allows us to interpolate between the regret bounds of O(T ) and O(T ) from [15] and the above bound of O(T ), depending on how we wish to trade off between the cumulative regret associated to the loss and the long-term constraints.", "startOffset": 105, "endOffset": 109}, {"referenceID": 14, "context": "In addition to our analysis of regret bounds, we empirically validate our algorithm by comparing it to the methods of [15] on a) the online estimation of doubly stochastic matrices and b) the online learning of sparse logistic regression based on the elastic net penalty [27].", "startOffset": 118, "endOffset": 122}, {"referenceID": 26, "context": "In addition to our analysis of regret bounds, we empirically validate our algorithm by comparing it to the methods of [15] on a) the online estimation of doubly stochastic matrices and b) the online learning of sparse logistic regression based on the elastic net penalty [27].", "startOffset": 271, "endOffset": 275}, {"referenceID": 5, "context": "As is typically assumed in online learning [6], the functions gj and ft shall be taken to be Lipschitz continuous.", "startOffset": 43, "endOffset": 46}, {"referenceID": 14, "context": "Finally, we note that the set of assumptions enumerated in this section are equivalent to the ones in [15].", "startOffset": 102, "endOffset": 106}, {"referenceID": 14, "context": "Following [15], we consider a saddle-point formulation of the optimization problem.", "startOffset": 10, "endOffset": 14}, {"referenceID": 14, "context": "It otherwise preserves the same properties as those of individual gj \u2019s (sub-differentiability, bounded (sub-)gradients and bounded values; see Proposition 6 in [15] or Section 2.", "startOffset": 161, "endOffset": 165}, {"referenceID": 4, "context": "3 in [5] for a proof).", "startOffset": 5, "endOffset": 8}, {"referenceID": 20, "context": "1 in [21]).", "startOffset": 5, "endOffset": 9}, {"referenceID": 14, "context": "We note at this point that in contrast to our method, [15] make use of a single \u03b8 that is constant in all rounds.", "startOffset": 54, "endOffset": 58}, {"referenceID": 14, "context": "\u2022 Initialize x1 = 0 and \u03bb1 = 0 More precisely, in [15], \u03b8 is equal to the product of a constant step size times a constant scaling factor.", "startOffset": 50, "endOffset": 54}, {"referenceID": 14, "context": "The algorithm is in the same vein as the ones proposed in [15, 13], but it is adaptive.", "startOffset": 58, "endOffset": 66}, {"referenceID": 12, "context": "The algorithm is in the same vein as the ones proposed in [15, 13], but it is adaptive.", "startOffset": 58, "endOffset": 66}, {"referenceID": 14, "context": "which matches the mirror prox guarantees of [15] while being valid for general convex constraint sets X as opposed to just polyhedral constraint sets.", "startOffset": 44, "endOffset": 48}, {"referenceID": 14, "context": "1 in [15].", "startOffset": 5, "endOffset": 9}, {"referenceID": 14, "context": "The analysis is analogous to that developed in [15], which we provide below for selfcontainedness.", "startOffset": 47, "endOffset": 51}, {"referenceID": 14, "context": "In particular, the following lemma takes advantage of the fact that the partial function \u03bb 7\u2192 Lt(xt, \u03bb) is not only concave as considered in [15], but strongly concave with parameter \u03b8t.", "startOffset": 141, "endOffset": 145}, {"referenceID": 14, "context": "2 from [15], where additional assumptions on the gradient of g can translate into no constraint violations.", "startOffset": 7, "endOffset": 11}, {"referenceID": 14, "context": "It can then be shown that (see Theorem 7 in [15]): \u2223\u2223\u2223\u2211Tt=1 ft(x?)\u2212\u2211Tt=1 ft(x\u03b3)\u2223\u2223\u2223 \u2264 Gr T\u03b3, (4)", "startOffset": 44, "endOffset": 48}, {"referenceID": 16, "context": "Examples where (3) holds include the positive semi-definite cone, as described in Section 4 of [17].", "startOffset": 95, "endOffset": 99}, {"referenceID": 14, "context": "This result extends Theorem 8 and Corollary 13 from [15] in that it holds for general convex domains X (as opposed to only polyhedral ones).", "startOffset": 52, "endOffset": 56}, {"referenceID": 14, "context": "We ran two sets of experiments to validate the regret bounds obtained for our adaptive algorithms for OCO with long-term constraints and compare to the algorithms proposed in [15].", "startOffset": 175, "endOffset": 179}, {"referenceID": 11, "context": "First, we examine the online estimation of doubly-stochastic matrices where the convex domain of interest X is polyhedral but whose projection operator is difficult to compute [12, 10].", "startOffset": 176, "endOffset": 184}, {"referenceID": 9, "context": "First, we examine the online estimation of doubly-stochastic matrices where the convex domain of interest X is polyhedral but whose projection operator is difficult to compute [12, 10].", "startOffset": 176, "endOffset": 184}, {"referenceID": 26, "context": "Second, we consider sparse online binary classification based on the elastic net penalty [27].", "startOffset": 89, "endOffset": 93}, {"referenceID": 14, "context": "The method of [15] that handles general convex domains X will be referred to as Convex OGD, while the mirror prox method analyzed in [15], which is only applicable to polyhedral domains, will be denoted by Convex mirror prox.", "startOffset": 14, "endOffset": 18}, {"referenceID": 14, "context": "The method of [15] that handles general convex domains X will be referred to as Convex OGD, while the mirror prox method analyzed in [15], which is only applicable to polyhedral domains, will be denoted by Convex mirror prox.", "startOffset": 133, "endOffset": 137}, {"referenceID": 14, "context": "The parameters of Convex OGD and Convex mirror prox are instantiated according to [15].", "startOffset": 82, "endOffset": 86}, {"referenceID": 24, "context": "1 Doubly-Stochastic Matrices Doubly-stochastic matrices appear in many machine learning and optimization problems, such as clustering applications [25] or learning permutations [12, 10].", "startOffset": 147, "endOffset": 151}, {"referenceID": 11, "context": "1 Doubly-Stochastic Matrices Doubly-stochastic matrices appear in many machine learning and optimization problems, such as clustering applications [25] or learning permutations [12, 10].", "startOffset": 177, "endOffset": 185}, {"referenceID": 9, "context": "1 Doubly-Stochastic Matrices Doubly-stochastic matrices appear in many machine learning and optimization problems, such as clustering applications [25] or learning permutations [12, 10].", "startOffset": 177, "endOffset": 185}, {"referenceID": 3, "context": "This problem can easily be mapped to OCO setting by assuming that the sequence {Y}t=1 is generated by random permutation matrices which are known to constitute the extreme points of the set of doublystochastic matrices [4].", "startOffset": 219, "endOffset": 222}, {"referenceID": 7, "context": "The offline solutions of (5) required for various t \u2208 {1, \u00b7 \u00b7 \u00b7 , T} to compute the regret are obtained using CVXPY [8].", "startOffset": 116, "endOffset": 119}, {"referenceID": 14, "context": "We surmise that this may be due to the fact that the guarantees of Convex mirror prox proved in [15] only hold for very large T .", "startOffset": 96, "endOffset": 100}, {"referenceID": 14, "context": "Theorem 12 from [15] requires T \u2265 164(m+1), which translates into T > 10 in our setting.", "startOffset": 16, "endOffset": 20}, {"referenceID": 23, "context": ", in the context of learning predictors with low-latency [24].", "startOffset": 57, "endOffset": 61}, {"referenceID": 6, "context": "Moreover, and in order to best display cumulative regret, we compute offline solutions of (6) for various t \u2208 {1, \u00b7 \u00b7 \u00b7 , T} thanks to an implementation of [7].", "startOffset": 156, "endOffset": 159}, {"referenceID": 18, "context": "Following the ideas developed in [19, 9], we could analyze the regret guarantees of our algorithm when there is a vector of step sizes \u03b7t that is given by a diagonal matrix Diag(\u03b7t) \u2208 Rd\u00d7d, updating adaptively and separately each coordinate of x.", "startOffset": 33, "endOffset": 40}, {"referenceID": 8, "context": "Following the ideas developed in [19, 9], we could analyze the regret guarantees of our algorithm when there is a vector of step sizes \u03b7t that is given by a diagonal matrix Diag(\u03b7t) \u2208 Rd\u00d7d, updating adaptively and separately each coordinate of x.", "startOffset": 33, "endOffset": 40}, {"referenceID": 13, "context": "Moreover, the maximization with respect to \u03bb in the last step of Lemma 4 introduces the Moreau envelope [14] of the Fenchel conjugate of \u03c6, namely", "startOffset": 104, "endOffset": 108}], "year": 2015, "abstractText": "We present an adaptive online gradient descent algorithm to solve online convex optimization problems with long-term constraints, which are constraints that need to be satisfied when accumulated over a finite number of rounds T , but can be violated in intermediate rounds. For some user-defined trade-off parameter \u03b2 \u2208 (0, 1), the proposed algorithm achieves cumulative regret bounds ofO(Tmax{\u03b2,1\u2212\u03b2}) andO(T 1\u2212\u03b2/2) for the loss and the constraint violations respectively. Our results hold for convex losses and can handle arbitrary convex constraints without requiring knowledge of the number of rounds in advance. Our contributions improve over the best known cumulative regret bounds by Mahdavi, et al. (2012) that are respectively O(T ) and O(T ) for general convex domains, and respectively O(T ) andO(T ) when further restricting to polyhedral domains. We supplement the analysis with experiments validating the performance of our algorithm in practice.", "creator": "LaTeX with hyperref package"}}}