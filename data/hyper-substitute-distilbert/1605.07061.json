{"id": "1605.07061", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "23-May-2016", "title": "On Restricted Nonnegative Matrix Factorization", "abstract": "complex dual factorization ( nmf ) is various approaches proposed implementing a rank tensor $ n \\ sum bat $ matrix $ y $ as a case of a nonnegative $ 6 \\ whose net $ matrix $ w $ is a nonnegative $ d \\ times box $ matrix $ th $. restricted nmf requires such addition that the column combinations of $ m $ and $ 0 $ coincide. finding the minimal inner dimension $ d $ already known may be np - hard, having preferred nmf and restricted nmf. techniques show that restricted nmf is closely constrained via these question about the symmetry of universal representation relations, summarized by paz showing his successful 1971 manifesto. we detect this model using answer paz's inequality promptly, even establishing a positive answer supplied in 1974. furthermore, we detect whether special rational matrix $ l $ always represents any weight function of minimal interior dimension whose dimensions $ w $ and $ 7 $ contain also combined. : check that v holds } var $ [UNK] $ & rank at values $ 3 $ and we exhibit closed rank - $ boo $ matrix for values $ m\u00b3 $ not $ h $ require equal entries.", "histories": [["v1", "Mon, 23 May 2016 15:26:26 GMT  (97kb,D)", "http://arxiv.org/abs/1605.07061v1", "Full version of an ICALP'16 paper"]], "COMMENTS": "Full version of an ICALP'16 paper", "reviews": [], "SUBJECTS": "cs.FL cs.CC cs.LG", "authors": ["dmitry chistikov", "stefan kiefer", "ines maru\\v{s}i\\'c", "mahsa shirmohammadi", "james worrell"], "accepted": false, "id": "1605.07061"}, "pdf": {"name": "1605.07061.pdf", "metadata": {"source": "CRF", "title": "On Restricted Nonnegative Matrix Factorization", "authors": ["Dmitry Chistikov", "Stefan Kiefer", "Ines Maru\u0161i\u0107", "Mahsa Shirmohammadi", "James Worrell"], "emails": ["dch@mpi-sws.org", "FirstName.LastName@cs.ox.ac.uk"], "sections": [{"heading": null, "text": "Furthermore, we investigate whether a rational matrix M always has a restricted NMF of minimal inner dimension whose factors W and H are also rational. We show that this holds for matrices M of rank at most 3 and we exhibit a rank-4 matrix for which W and H require irrational entries.\n1998 ACM Subject Classification F.1.1 Models of Computation, F.2.1 Numerical Algorithms and Problems\nKeywords and phrases nonnegative matrix factorization, nonnegative rank, probabilistic automata, labelled Markov chains, minimization\nDigital Object Identifier 10.4230/LIPIcs.ICALP.2016.XXX\n1 Introduction\nNonnegative matrix factorization (NMF) is the task of factoring a matrix of nonnegative real numbers M (henceforth a nonnegative matrix) as a product M = W \u00b7H such that matrices W and H are also nonnegative. The smallest inner dimension of any such factorization is called the nonnegative rank of M , written rank+(M).\nIn machine learning, NMF was popularized by the seminal work of Lee and Seung [14] as a tool for finding features in facial-image databases. Since then, NMF has found a broad range of applications\u2014including document clustering, topic modelling, computer vision, recommender systems, bioinformatics, and acoustic signal processing [5, 4, 7, 19, 21, 22]. In applications, matrix M can typically be seen as a matrix of data points: each column of M corresponds to a data point and each row to a feature. Then, computing a nonnegative factorization M = W \u00b7H corresponds to expressing the data points (columns of M) as convex combinations of latent factors (columns of W ), i.e., as linear combinations of latent factors with nonnegative coefficients (columns of H).\n\u2217 Present address: Department of Computer Science, University of Oxford, UK.\n43rd International Colloquium on Automata, Languages, and Programming (ICALP 2016). Editors: Ioannis Chatzigiannakis, Michael Mitzenmacher, Yuval Rabani, and Davide Sangiorgi; Article No.XXX; pp.XXX:1\u2013XXX:24\nLeibniz International Proceedings in Informatics Schloss Dagstuhl \u2013 Leibniz-Zentrum f\u00fcr Informatik, Dagstuhl Publishing, Germany\nar X\niv :1\n60 5.\n07 06\n1v 1\n[ cs\n.F L\n] 2\n3 M\nay 2\n01 6\nXXX:2 On Restricted Nonnegative Matrix Factorization\nFrom a computational perspective, perhaps the most basic problem concerning NMF is whether a given nonnegative matrix of rational numbers M admits an NMF with inner dimension at most a given number k. Formally, the NMF problem asks whether rank+(M) \u2264 k. In practical applications, various heuristics and local-search algorithms are used to compute an approximate nonnegative factorization, but little is known in terms of their theoretical guarantees. The NMF problem under the separability assumption of Donoho and Stodden [9] is tractable: an NMF M = W \u00b7H is called separable if every column of W is also a column of M . In 2012, Arora et al. [2] showed that it is decidable in polynomial time whether a given matrix admits a separable NMF with a given inner dimension. Further progress was made recently, with several efficient algorithms for computing near-separable NMFs [13, 12].\nVavasis [20] showed that the problem of deciding whether the rank of a nonnegative matrix is equal to its nonnegative rank is NP-hard. This result implies that generalizations of this problem, such as the aforementioned NMF problem, the problem of computing the factors W,H (in both exact and approximate versions), and nonnegative rank determination, are also NP-hard. It is not known whether any of these problems are in NP.\nVavasis [20] notes that the difficulty in proving membership in NP lies in the fact that a certificate for a positive answer to the NMF problem seems to require the sought factors: a pair of nonnegative matrices W,H such that M = W \u00b7H. Related to this, Cohen and Rothblum [8] posed the question of whether, given a nonnegative matrix of rational numbers M , there always exists an NMF M = W \u00b7H of inner dimension equal to rank+(M) such that both W and H are also matrices of rational numbers. A natural route to proving membership of the NMF problem in NP would be to give a positive answer to the question of Cohen and Rothblum (as well as a polynomial bound on the bit-length of the factors W and H). However, the question remains open. Currently the best complexity bound for the NMF problem is membership in PSPACE, which is obtained by translation into the existential theory of real-closed fields [2]. Such a translation shows that one can always choose the entries of W and H to be algebraic numbers.\nIn this work, we focus on the so-called restricted NMF (RNMF) problem, introduced by Gillis and Glineur [11]. The RNMF problem is defined as the NMF problem, except that the column spaces of M and W are required to coincide. (Note that for any NMF, the column space of M is a subspace of the column space of W .) This problem has a natural geometric interpretation as the nested polytope problem (NPP): the problem of finding a minimum-vertex polytope nested between two given convex polytopes. In more detail, for a rank-r matrix M , finding an RNMF with inner dimension d is known to correspond exactly to finding a nested polytope with d vertices in an (r \u2212 1)-dimensional NPP.\nOur contributions are as follows. 1. We establish a tight connection between NMF and the coverability relation in labelled\nMarkov chains (LMCs). The latter notion was introduced by Paz [15]. Loosely speaking, an LMCM\u2032 covers an LMCM if for any initial distribution over the states ofM there is an initial distribution over the states ofM\u2032 such thatM andM\u2032 are equivalent. In 1971, Paz [15] asked a question about the nature of minimal covering LMCs. The question was supposedly answered positively in 1974 [3]. However, we show that the correct answer is negative, thus falsifying the claim in [3]. Instrumental to our counterexample is the observation that restricted nonnegative rank and nonnegative rank can be different. (Indeed, the wrong claims in [3] seem to implicitly rely on the opposite assumption, although the notions of NMF and RNMF had not yet been developed.)\n2. We show that the RNMF problem for matrices M of rank 3 or less can be solved in polynomial time. In fact, we show that there is always a rational NMF of M with inner"}, {"heading": "D. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:3", "text": "dimension rank+(M), and that it can be computed in polynomial time in the Turing model of computation. This improves a result in [11] where the RNMF problem is shown to be solvable in polynomial time assuming a RAM model with unit-cost arithmetic. Both our algorithm and the one in [11] exploit the connection to the 2-dimensional NPP, allowing us to take advantage of a geometric algorithm by Aggarwal et al. [1]. We need to adapt the algorithm in [1] to ensure that the occurring numbers are rational and can be computed in polynomial time in the Turing model of computation.\n3. We exhibit a rank-4 matrix that has an RNMF with inner dimension 5 but no rational RNMF with inner dimension 5. We construct this matrix via a particular instance of the 3-dimensional NPP, again taking advantage of the geometric interpretation of RNMF. Our result answers the RNMF variant of Cohen and Rothblum\u2019s question in [8] negatively. The original (NMF) variant remains open.\nDetailed proofs of all results can be found in the appendix.\n2 Nonnegative Matrix Factorization\nLet N and N0 denote the set of all positive and nonnegative integers, respectively. For every n \u2208 N, we write [n] for the set {1, 2, . . . , n} and write In for the identity matrix of order n. For any ordered field F, we denote by F+ the set of all its nonnegative elements. For any vector v, we write vi for its ith entry. A vector v is called stochastic if its entries are nonnegative real numbers that sum up to one. For every i \u2208 [n], we write ei for the ith coordinate vector in Rn. We write 1(n) for the n-dimensional column vector with all ones. We omit the superscript if it is understood from the context.\nFor any matrix M , we write Mi for its ith row, M j for its jth column, and Mi,j for its (i, j)th entry. The column space (resp., row space) of M , written Col(M) (resp., Row(M)), is the vector space spanned by the columns (resp., rows) of M . A matrix is called nonnegative (resp., zero or rational) if so are all its entries. A nonnegative matrix is column-stochastic (resp., row-stochastic) if the element sum of each of its columns (resp., rows) is one."}, {"heading": "2.1 Nonnegative Rank", "text": "Let F be an ordered field, such as the reals R or the rationals Q. Given a nonnegative matrix M \u2208 Fn\u00d7m+ , a nonnegative matrix factorization (NMF) over F of M is any representation of the form M = W \u00b7H where W \u2208 Fn\u00d7d+ and H \u2208 Fd\u00d7m+ are nonnegative matrices. Note that Col(M) \u2286 Col(W ). We refer to d as the inner dimension of the NMF, and hence refer to NMF M = W \u00b7H as being d-dimensional. The nonnegative rank over F of M is the smallest number d \u2208 N0 such that there exists a d-dimensional NMF over F of M . An equivalent characterization [8] of the nonnegative rank over F of M is as the smallest number of rank-1 matrices in Fn\u00d7m+ such that M is equal to their sum. The nonnegative rank over R will henceforth simply be called nonnegative rank, and will be denoted by rank+(M). For any nonnegative matrix M \u2208 Rn\u00d7m+ , it is easy to see that rank(M) \u2264 rank+(M) \u2264 min{n,m}.\nGiven a nonzero matrixM \u2208 Fn\u00d7m+ , by removing the zero columns ofM and dividing each remaining column by the sum of its elements, we obtain a column-stochastic matrix M \u2032 with equal nonnegative rank. Similarly, if M = W \u00b7H then after removing zero columns in W and multiplying with a suitable diagonal matrixD, we getM = W \u00b7H = WD\u00b7D\u22121H whereWD is column-stochastic. IfM is column-stochastic then 1> = 1>M = 1>WD \u00b7D\u22121H = 1>D\u22121H, hence D\u22121H is column-stochastic as well. Thus, without loss of generality one can consider NMFs of column-stochastic matrices into column-stochastic matrices [8, Theorem 3.2].\nICALP 2016\nXXX:4 On Restricted Nonnegative Matrix Factorization\nNMF problem: Given a matrix M \u2208 Qn\u00d7m+ and k \u2208 N, is rank+(M) \u2264 k?\nThe NMF problem is NP-hard, even for k = rank(M) (see [20]). On the other hand, it is reducible to the existential theory of the reals, hence by [6, 16] it is in PSPACE.\nFor a matrixM \u2208 Qn\u00d7m+ , its nonnegative rank over Q is clearly at least rank+(M). While those ranks are equal if rank(M) \u2264 2, a longstanding open question by Cohen and Rothblum asks whether they are always equal [8]. In other words, it is conceivable that there exists a rational matrix M \u2208 Qn\u00d7m+ with rank+(M) = d that has no rational NMF with inner dimension d. Recently, Shitov [17] exhibited a nonnegative matrix (with irrational entries) whose nonnegative rank over a subfield of R is different from its nonnegative rank over R."}, {"heading": "2.2 Restricted Nonnegative Rank", "text": "For all matrices M \u2208 Fn\u00d7m+ , an NMF M = W \u00b7H is called restricted NMF (RNMF) [11] if rank(M) = rank(W ). As we know Col(M) \u2286 Col(W ) holds for all NMF instances, the condition rank(M) = rank(W ) is then equivalent to Col(M) = Col(W ). The restricted nonnegative rank over F of M is the smallest number d \u2208 N0 such that there exists a d-dimensional restricted nonnegative factorization over F of M . Unless indicated otherwise, henceforth we will assume F = R when speaking of the restricted nonnegative rank of M , and denote it by rrank+(M).\nRNMF problem: Given a matrix M \u2208 Qn\u00d7m+ and k \u2208 N, is rrank+(M) \u2264 k?\nWe have the following basic properties.\nI Lemma 1 ([11]). Let M \u2208 Rn\u00d7m+ . Then rank(M) \u2264 rank+(M) \u2264 rrank+(M) \u2264 m. Moreover, if rank(M) = rank+(M) then rank(M) = rrank+(M).\nThus, with the above-mentioned NP-hardness result, it follows that the RNMF problem is also NP-hard and in PSPACE.\nFor a matrix M \u2208 Qn\u00d7m+ , its restricted nonnegative rank over Q is clearly at least rrank+(M). As with nonnegative rank, in general it is not known whether the restricted nonnegative ranks of M over R and over Q are equal. By [8, Theorem 4.1] and Lemma 1, this is true when rank(M) \u2264 2.\nRNMF has the following geometric interpretation. For a dimension ` \u2208 N, the convex combination of a set {v1, . . . , vm} \u2282 R` is a point \u03bb1v1 + \u00b7 \u00b7 \u00b7+ \u03bbmvm where (\u03bb1, . . . , \u03bbm) is a stochastic vector. The convex hull of {v1, . . . , vm}, written as conv{v1, . . . , vm}, is the set of all convex combinations of {v1, . . . , vm}. We call conv{v1, . . . , vm} a polytope spanned by v1, . . . , vm. A polyhedron is a set {x \u2208 R` | Ax+ b \u2265 0 } with A \u2208 Rn\u00d7` and b \u2208 Rn. A set is a polytope if and only if it is a bounded polyhedron. A polytope is full-dimensional (i.e., has volume) if the matrix (A b) \u2208 Rn\u00d7(`+1) has rank `+ 1.\nNested polytope problem (NPP): Given r, n \u2208 N, let A \u2208 Qn\u00d7(r\u22121) and b \u2208 Qn be such that P = {x \u2208 Rr\u22121 | Ax + b \u2265 0 } is a full-dimensional polytope. Let S \u2286 P be a full-dimensional polytope described by spanning points. The nested polytope problem (NPP) asks, given A, b, S and a number k \u2208 N, whether there exist k points that span a polytope Q with S \u2286 Q \u2286 P . Such a polytope Q is called nested between P and S.\nThe following proposition appears as Theorem 1 in [11].\nI Proposition 2. The RNMF problem and the NPP are interreducible in polynomial time."}, {"heading": "D. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:5", "text": "More specifically, the reductions are as follows. 1. Given a nonnegative matrix M \u2208 Qn\u00d7m+ of rank r, one can compute in polynomial time\nA \u2208 Qn\u00d7(r\u22121) and b \u2208 Qn such that P = {x \u2208 Rr\u22121 | Ax+ b \u2265 0 } is a full-dimensional polytope, and m rational points that span a full-dimensional polytope S \u2286 P such that (a) any d-dimensional RNMF (rational or irrational) of M determines d points that span\na polytope Q with S \u2286 Q \u2286 P , and (b) any d points (rational or irrational) that span a polytope Q with S \u2286 Q \u2286 P determine\na d-dimensional RNMF of M . 2. Let A \u2208 Qn\u00d7(r\u22121) and b \u2208 Qn such that P = {x \u2208 Rr\u22121 | Ax+b \u2265 0 } is a full-dimensional\npolytope. Let S \u2286 P be a full-dimensional polytope spanned by s1, . . . , sm \u2208 Qr\u22121. Then matrix M \u2208 Qn\u00d7m with M i = Asi + b for i \u2208 [m] satisfies (a) and (b).\nImportantly, the correspondences (a) and (b) preserve rationality. In Appendix A we detail the reduction from point 2 above, thereby filling in a small gap in the proof of [11].\nI Example 3 ([11, Example 1]). Using the geometric interpretation of restricted nonnegative rank it follows easily that, in general, we may have rank(M) < rank+(M) < rrank+(M). Let 3D-cube NPP be the NPP instance where the inner and outer polytope are the standard 3D cube, i.e., P = S = {x \u2208 R3 | xi \u2208 [0, 1], 1 \u2264 i \u2264 3 }. The only nested polytope is Q = P . The corresponding restricted NMF problem consists of the following matrix M \u2208 R6\u00d78+ :\nM =  0 0 0 0 1 1 1 11 1 1 1 0 0 0 00 0 1 1 0 0 1 1 1 1 0 0 1 1 0 0 0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0  . We have rrank+(M) = 8 and rank(M) = 4. Since rank+(M) is bounded above by the number of rows in M , we have rank+(M) \u2264 6. It is shown in [11] that rank+(M) = 6.\n3 Coverability of Labelled Markov Chains\nIn this section, we establish a connection between RNMF and the coverability relation for labelled Markov chains. We thereby answer an open question posed in 1971 by Paz [15] about the nature of minimal covering labelled Markov chains.\nA labelled Markov chain (LMC ) is a tupleM = (n,\u03a3, \u00b5) where n \u2208 N is the number of states, \u03a3 is a finite alphabet of labels, and function \u00b5 : \u03a3\u2192 [0, 1]n\u00d7n specifies the transition matrices and is such that \u2211 \u03c3\u2208\u03a3 \u00b5(\u03c3) is a row-stochastic matrix. The intuitive behaviour of the LMCM is as follows: WhenM is in state i \u2208 [n], it emits label \u03c3 and moves to state j, with probability \u00b5(\u03c3)i,j .\nWe extend the function \u00b5 to words by defining \u00b5(\u03b5) := In and \u00b5(\u03c31 . . . \u03c3k) := \u00b5(\u03c31) \u00b7 \u00b7 \u00b7\u00b5(\u03c3k) for all k \u2208 N, and all \u03c31, . . . , \u03c3k \u2208 \u03a3. Observe that \u00b5(xy) = \u00b5(x) \u00b7\u00b5(y) for all words x, y \u2208 \u03a3\u2217. We view \u00b5(w) for a word w \u2208 \u03a3\u2217 as follows: ifM is in state i \u2208 [n], it emits w and moves to state j in |w| steps, with probability \u00b5(w)i,j .\nFor i \u2208 [n] and w \u2208 \u03a3\u2217, we write prMi (w) := e>i \u00b7 \u00b5(w) \u00b7 1(n) for the probability that, starting in state i, M emits word w. For example, in Figure 1 we have prM0 (a1b1) = 112 . More generally, for a given initial distribution \u03c0 on the set of states [n] (viewed as a stochastic row vector), we write prM\u03c0 (w) := \u03c0 \u00b7 \u00b5(w) \u00b7 1(n) for the probability thatM emits word w starting from state distribution \u03c0. We omit the superscriptM from prM\u03c0 when it is clear from the context.\nWe say that an LMCM is covered by an LMCM\u2032, written asM\u2032 \u2265M, if for every initial distribution \u03c0 forM there exists a distribution \u03c0\u2032 forM\u2032 such that prM\u03c0 (w) = prM \u2032\n\u03c0\u2032 (w) for all words w \u2208 \u03a3\u2217.\nICALP 2016\nXXX:6 On Restricted Nonnegative Matrix Factorization\nThe backward matrix ofM is a matrix BackM\u2208 R[n]\u00d7\u03a3 \u2217\n+ where (BackM)i,w = prMi (w) for every i \u2208 [n] and w \u2208 \u03a3\u2217. The rank of M is defined by rank(M) = rank(BackM). (Matrix BackM is infinite, but since it has n rows, its rank is at most n.) It follows easily from the definition (see also [15, Theorem 3.1]) thatM\u2032 \u2265M if and only if there exists a row-stochastic matrix A such that A \u00b7 BackM\u2032 = BackM.\nLMCs can be seen as a special case of stochastic sequential machines, a class of probabilistic automata introduced and studied by Paz [15]. More specifically, they are stochastic sequential machines with a singleton input alphabet and \u03a3 as output alphabet. In his seminal 1971 textbook on probabilistic automata [15], Paz asks the following question:\nI Question 4 (Paz [15], p. 38). If an n-state LMC M is covered by an n\u2032-state LMC M\u2032 where n\u2032 < n, isM necessarily covered by some n\u2217-state LMCM\u2217, where n\u2217 < n, such that M\u2217 andM have the same rank?\nIn 1974, a positive answer to this question was claimed [3, Theorem 13]. In fact, the author of [3] makes a stronger claim, namely that the answer to Question 4 is yes, even if the inequality n\u2217 < n in Question 4 is replaced by n\u2217 \u2264 n\u2032. To the contrary, we show:\nI Theorem 5. The answer to Question 4 is negative.\nTheorem 5 falsifies the claim in [3]. In Appendix B.1 we discuss in detail the mistake in [3]. To prove Theorem 5 we establish a tight connection between NMF and LMC coverability:\nI Proposition 6. Given a nonnegative matrix M \u2208 Qn\u00d7m+ of rank r, one can compute in polynomial time an LMCM = (m+ 2,\u03a3, \u00b5) of rank r + 2 such that for all d \u2208 N: (a) any d-dimensional NMF M = W \u00b7 H determines an LMC M\u2032 = (d + 2,\u03a3, \u00b5\u2032) with M\u2032 \u2265M and rank(M\u2032) = rank(W ) + 2, and (b) any LMCM\u2032 = (d+2,\u03a3, \u00b5\u2032) withM\u2032 \u2265M determines a d-dimensional NMF M = W \u00b7H with rank(M\u2032) = rank(W ) + 2.\nIn particular, for all d \u2208 N the inequality rrank+(M) \u2264 d holds if and only ifM is covered by some (d+ 2)-state LMCM\u2032 such thatM\u2032 andM have the same rank.\nAssuming Proposition 6 we can prove Theorem 5:\nProof of Theorem 5. Let M \u2208 {0, 1}6\u00d78 be the matrix from Example 3. LetM = (10,\u03a3, \u00b5) be the associated LMC from Proposition 6. Since M = I6 \u00b7 M is an NMF with inner dimension 6, by Proposition 6 (a) there is an LMCM\u2032 = (8,\u03a3, \u00b5\u2032) withM\u2032 \u2265M. Towards a contradiction, suppose the answer to Question 4 were yes. Then M is also covered by some n\u2217-state LMC M\u2217, where n\u2217 \u2264 9, such that M\u2217 and M have the same rank. The last sentence of Proposition 6 then implies that rrank+(M) \u2264 7. But this contradicts the equality rrank+(M) = 8 from Example 3. Hence, the answer to Question 4 is no. J\nTo prove Proposition 6 we adapt a reduction from NMF to the trace-refinement problem in Markov decision processes [10].\nProof sketch of Proposition 6. Let M \u2208 Qn\u00d7m+ be a nonnegative matrix of rank r. As argued in Section 2.1, without loss of generality we may assume that M is column-stochastic and consider factorizations of M into column-stochastic matrices only.\nWe define an LMC M = (m + 2,\u03a3, \u00b5) with m + 2 states {0, 1, . . . ,m,m + 1}. The alphabet is \u03a3 = {a1, . . . , am} \u222a {b1, . . . , bn} \u222a {X} and the function \u00b5, for all i \u2208 [m] and all j \u2208 [n], is defined by:\n\u00b5(ai)0,i = 1m , \u00b5(bj)i,m+1 = (M >)i,j = Mj,i, \u00b5(X)m+1,m+1 = 1,\nD. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:7\n0\n1\n2\n3\n4\nM: 1 3 , a1\n1 3 , a2\n1 3 , a3\n1 4 , b1\n3 4 , b2\n1 2 , b1\n1 2 , b2\n3 4 , b1\n1 4 , b2\n1,X 0\n1\n2\n3\nM\u2032: 112 , a1 1 6 , a2\n1 4 , a3\n1 4 , a1\n1 6 , a2\n1 12 , a3\n1, b1\n1, b2\n1,X\nFigure 1 LMCM is constructed from matrix M =\n( 1/4 1/2 3/4\n3/4 1/2 1/4\n) whereas LMCM\u2032 is obtained\nby NMF M = I2 \u00b7M .\nand all other entries of \u00b5(ai), \u00b5(bj), and \u00b5(X) are 0. See Figure 1 for an example. We have:\nBackM =  \u03b5 b1 \u00b7\u00b7\u00b7 bn X ai aibj b1X \u00b7\u00b7\u00b7 bnX X2 \u00b7\u00b7\u00b7 1 0 \u00b7 \u00b7 \u00b7 0 0 1m 1 mMj,i 0 \u00b7 \u00b7 \u00b7 0 0 \u00b7 \u00b7 \u00b7 1 M1,1 \u00b7 \u00b7 \u00b7 Mn,1 0 0 0 M1,1 \u00b7 \u00b7 \u00b7 Mn,1 0 \u00b7 \u00b7 \u00b7 ... ... . . . ... ... ... ... ... . . . ... ... \u00b7 \u00b7 \u00b7\n1 M1,m \u00b7 \u00b7 \u00b7 Mn,m 0 0 0 M1,m \u00b7 \u00b7 \u00b7 Mn,m 0 \u00b7 \u00b7 \u00b7 1 0 \u00b7 \u00b7 \u00b7 0 1 0 0 0 \u00b7 \u00b7 \u00b7 0 1 \u00b7 \u00b7 \u00b7\n.\nThus rank(M) = rank(BackM) \u2265 rank(M) + 2. The first n + 2 columns (indexed by \u03b5, b1, . . . , bn,X) in BackM span Col(BackM). Therefore, rank(M) = rank(M) + 2 = r + 2.\nFor d \u2208 N, letM = W \u00b7H for some column-stochastic matricesW \u2208 Rn\u00d7d+ and H \u2208 Rd\u00d7m+ . Define an LMCM\u2032 = (d+ 2,\u03a3, \u00b5\u2032) where the states are {0, 1, . . . , d, d+ 1}. The function \u00b5\u2032, for all i \u2208 [m], j \u2208 [n], and l \u2208 [d], is defined by:\n\u00b5\u2032(ai)0,l = 1mHl,i, \u00b5 \u2032(bj)l,d+1 = Wj,l, \u00b5\u2032(X)d+1,d+1 = 1,\nand all other entries of \u00b5\u2032(ai), \u00b5\u2032(bj), and \u00b5\u2032(X) are 0. From the NMF M = W \u00b7H it follows that we can factor BackM as follows:\n 1 0 \u00b7 \u00b7 \u00b7 0 0 0 H1,1 \u00b7 \u00b7 \u00b7 Hd,1 0 ... ... . . . ... ...\n0 H1,m \u00b7 \u00b7 \u00b7 Hd,m 0 0 0 \u00b7 \u00b7 \u00b7 0 1\n\u00b7  \u03b5 b1 \u00b7\u00b7\u00b7 bn X ai aibj bjX X2 \u00b7\u00b7\u00b7 1 0 \u00b7 \u00b7 \u00b7 0 0 1m 1 mMj,i 0 0 \u00b7 \u00b7 \u00b7 1 W1,1 \u00b7 \u00b7 \u00b7 Wn,1 0 0 0 Wj,1 0 \u00b7 \u00b7 \u00b7 ... ... . . . ... ... ... ... ... ... \u00b7 \u00b7 \u00b7\n1 W1,d \u00b7 \u00b7 \u00b7 Wn,d 0 0 0 Wj,d 0 \u00b7 \u00b7 \u00b7 1 0 \u00b7 \u00b7 \u00b7 0 1 0 0 0 1 \u00b7 \u00b7 \u00b7  where the left factor is row-stochastic (as H is column-stochastic), and the right factor equals BackM\u2032. It follows thatM\u2032 \u2265M. J\n4 Restricted NMF of Rank-3 Matrices\nIn this section we consider rational matrices of rank at most 3. We show that for such matrices the restricted nonnegative ranks over R and Q are equal and we give a polynomial-time algorithm that computes a minimal-dimension RNMF over Q.\nI Theorem 7. Given a matrix M \u2208 Qn\u00d7m+ where rank(M) \u2264 3, there is a rational RNMF of M with inner dimension rrank+(M) and it can be computed in polynomial time in the Turing model of computation.\nICALP 2016\nXXX:8 On Restricted Nonnegative Matrix Factorization\nUsing reduction 1 of Proposition 2, we can reduce in polynomial time the RNMF problem for rank-3 matrices to the 2-dimensional NPP, i.e., the nested polygon problem in the plane. As noted in Section 2.2, the correspondence between restricted nonnegative factorizations and nested polygons preserves rationality. Thus to prove Theorem 7 it suffices to prove:\nI Theorem 8. Given polygons S \u2286 P \u2286 R2 with rational vertices, there exists a minimumvertex polygon Q nested between P and S that also has rational vertices. Moreover there is an algorithm that, given P and S, computes such a polygon in polynomial time in the Turing machine model.\nIn fact, Aggarwal et al. [1] give an algorithm for the 2-dimensional NPP and prove that it runs in polynomial time in the RAM model with unit-cost arithmetic. However, they freely use trigonometric functions and do not address the rationality of the output of the algorithm nor its complexity in the Turing model. To prove Theorem 8 we show that, by adopting a suitable representation of the vertices of a nested polygon, the algorithm in [1] can be adapted so that it runs in polynomial time in the Turing model. We furthermore use this representation to prove that the minimum-vertex nested polygon identified by the resulting algorithm has rational vertices.\nThe remainder of the section is devoted to the proof of Theorem 8. We first recall some terminology from [1] and describe their algorithm.\nA supporting line segment is a directed line segment, with its initial and final points on the boundary of the outer polygon P , that touches the inner polygon S on its left. A nested polygon with vertices on the boundary of P is said to be supporting if all but at most one of its edges are supporting line segments. A polygon nested between P and S is called minimal if it has the minimum number of vertices among all polygons nested between P and S. It is shown in [1, Lemma 4] that there is always a supporting polygon that is also minimal, and the algorithm given therein outputs such a polygon.\nLet k be the number of vertices of a minimal nested polygon. Given a vertex v on the boundary of P , there is a uniquely defined supporting polygon Qv with at most k+ 1 vertices. To determine Qv one computes the supporting line segments v1v2, . . . , vkvk+1, where v1 = v; see Figure 2. Then Qv is either the polygon with vertices v1, . . . , vk or the polygon with vertices v1, . . . , vk+1. In the first case, Qv is minimal. The idea behind the algorithm of [1] is to search along the boundary of P for an initial vertex v such that Qv is minimal.\nAs a central ingredient for our proof of Theorem 8, we choose a convenient representation of the vertices of supporting polygons. To this end, we assume that the edges of P are oriented counter-clockwise, and we represent a vertex v on an edge pq of P by the unique \u03bb \u2208 [0, 1] such that v = (1\u2212 \u03bb)p+ \u03bbq. We call this the convex representation of v.\nSimilar to [1], we associate with each supporting line segment uv a ray function r, such that if \u03bb is the convex representation of u then r(\u03bb) is the convex representation of v. The same ray function applies for supporting line segments u\u2032v\u2032 with u\u2032 in a small enough interval containing u.\nIn the following, when we say polynomial time, we mean polynomial time in the Turing model. To obtain a polynomial time bound, the key lemma is as follows:\nI Lemma 9. Consider bounded polygons S \u2286 P \u2286 R2 whose vertices are rational and of bit-length L. Then the ray function associated with a supporting line segment uv has the form r(\u03bb) = a\u03bb+bc\u03bb+d , where coefficients a, b, c, d are rational numbers with bit-length O(L) that can be computed in polynomial time.\nSuppose that v1v2, . . . , vkvk+1 is a sequence of k supporting line segments, with corresponding ray functions r1, . . . , rk. Then v1, . . . , vk are the vertices of a minimal supporting\nD. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:9\npolygon if and only if (rk \u25e6 . . . \u25e6 r1)(\u03bb) \u2265 \u03bb, where \u03bb is the convex representation of v1. It follows from [1] that, for each edge of P , one can compute in polynomial time a partition I of [0, 1] into intervals with rational endpoints such that if \u03bb1, \u03bb2 are in the same interval I \u2208 I then the points with convex representation \u03bb1 and \u03bb2 are associated with the same sequence of ray functions r1, . . . , rk. Using Lemma 9 we can, for each interval I \u2208 I, compute these ray functions in polynomial time. Define the slack function s(\u03bb) = (rk \u25e6 . . . \u25e6 r1)(\u03bb) \u2212 \u03bb. In fact, this function has the form s(\u03bb) = a\u03bb+bc\u03bb+d \u2212 \u03bb for rational numbers a, b, c, d that are also computable in polynomial time (see Corollary 15 in Appendix C). Then it is straightforward to check whether s(\u03bb) \u2265 0 has a solution \u03bb \u2208 I.\nNext we show that if such a solution exists, then there exists a rational solution, which, moreover, can be computed in polynomial time. To this end, let \u03bb\u2217 \u2208 I be such that s(\u03bb\u2217) \u2265 0. If \u03bb\u2217 is on the boundary of I, then \u03bb\u2217 \u2208 Q. If \u03bb\u2217 is not on the boundary and is not an isolated solution, then there exists a rational solution in its neighbourhood. Lastly, let \u03bb\u2217 be an isolated solution not on the boundary. Then, \u03bb\u2217 is a root of both s and its derivative s\u2032. For every \u03bb \u2208 I, we have\n(c\u03bb+ d) \u00b7 s(\u03bb) = a\u03bb+ b\u2212 \u03bb \u00b7 (c\u03bb+ d).\nTaking the derivative of the above equation with respect to \u03bb, we get\nc \u00b7 s(\u03bb) + (c\u03bb+ d) \u00b7 s\u2032(\u03bb) = a\u2212 d\u2212 2c\u03bb. (1)\nSince s(\u03bb\u2217) = s\u2032(\u03bb\u2217) = 0, from (1) we get 0 = a\u2212 d\u2212 2c\u03bb\u2217. Note that c 6= 0 since otherwise s \u2261 0. Therefore, \u03bb\u2217 = a\u2212d2c \u2208 Q.\nIt follows that the vertex v represented by \u03bb\u2217 has rational coordinates computable in polynomial time. By computing (ri \u25e6 . . . \u25e6 r1)(\u03bb\u2217) for i \u2208 [k], we can compute in polynomial time the convex representation of all vertices of the supporting polygon Qv. Observe, in particular, that all vertices are rational. Hence we have proved Theorem 8.\n5 Restricted NMF Requires Irrationality\nHere we show that the restricted nonnegative ranks over R and Q are, in general, different.\nICALP 2016\nXXX:10 On Restricted Nonnegative Matrix Factorization\nof a 3-dimensional outer polytope P . The black dots indicate 6 inner points (3 on the brown xy-face, and 3 on the blue xz-face) that span the interior polytope S. The two triangles on the xy-face and on the xz-face indicate the (unique) location of 5 points that span the nested polytope Q. The two slightly different projections are designed to create a 3-dimensional impression using stereoscopy. The \u201cparallel-eye\u201d technique should be used, see, e.g., [18]. See Figure 8 in Appendix D for a \u201ccross-eyed\u201d variant.\nI Theorem 10. Let\nM =  1/8 1/2 17/22 0 0 0 0 0 0 1/2 3/4 7/12 3/4 3/4 3/11 2 1/2 1/6 1/4 1/4 8/11 1/4 19/8 55/24 1/2 1/8 1/11 1/8 15/16 17/16\n11/16 5/16 7/44 1/16 7/32 43/96\n \u2208 Q6\u00d76+ .\nThe restricted nonnegative rank of M over R is 5. The restricted nonnegative rank of M over Q is 6.\nProof. Matrix M has an NMF M = W \u00b7H with inner dimension 5 with W,H as follows:\nW = \n0 3+ \u221a\n2 14\n11+ \u221a\n2 14 0 0\n0 0 0 12\u22122 \u221a\n2 17\n5 7 +\n\u221a 2\n14 2\u2212 \u221a 2 1 3\u2212 \u221a\n2 7\n26+7 \u221a\n2 17 0\n\u22121 + \u221a 2 0 4+ \u221a\n2 7\n21\u221212 \u221a\n2 17 39 14 +\n5 \u221a\n2 28\u221a\n2 2\n2 7 \u2212\n\u221a 2 14 0 7\u22124 \u221a 2 17\n33 28 +\n\u221a 2\n56 1 2 + \u221a 2 4 15 28 \u2212 \u221a 2 14 3\u2212 \u221a 2 28 0 3 8 \u2212 \u221a 2 16\n ,\nH =  1+ \u221a 2 4 0\n\u221a 2\n11 1 4 \u2212\n\u221a 2\n8 0 1 6 +\n\u221a 2\n12 3\u2212 \u221a\n2 4 1 2 +\n\u221a 2\n8 0 0 0 0 0 12 \u2212 \u221a 2 8 1\u2212 \u221a 2 11 0 0 0 0 0 0 34 + \u221a 2 8 13 34 \u2212 7 \u221a 2 68 0 0 0 0 0 2134 + 7 \u221a 2 68 5 6 \u2212 \u221a 2 12\n .\nSince rank(M) = rank(W ) = 4, the NMF M = W \u00b7H is restricted. This RNMF has been obtained by reducing, according to Proposition 2, an NPP instance, which we now describe.\nFigure 3 shows the outer 3-dimensional polytope P with 6 faces. The polytope P is the intersection of the following half-spaces: y \u2265 0 (blue), z \u2265 0 (brown), x \u2265 0 (pink), \u2212x + 52z + 1 \u2265 0 (yellow), \u2212 1 2x \u2212 y + 1 4z + 1 \u2265 0 (green), \u2212 1 4x \u2212 y \u2212 7 8z + 1 \u2265 0\nD. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:11\nx\ny\n0.2 0.4 0.8 1.00.6\n0.2\n0.4\n0.6\n0.8\n1.0\ns1\ns2\ns3\nq\u22172\nq\u22173\nq\u22171 = (2\u2212 \u221a 2, 0, 0)> \u2248 (0.5858, 0, 0)>\nx\ny\n0.2 0.4 0.8 1.00.6\n0.2\n0.4 0.6 0.8 1.0\ns1\ns2 s3\nq\u22172 q\u22173\nq\u22171 = (2\u2212\n\u221a\n2, 0, 0)> \u2248 (0.5858, 0, 0)>\nFigure 4 Detailed view of the xy-plane. The outer quadrilateral is one of 6 faces of P , the brown face in Figure 3. The points s1, s2, s3 are among the 6 points that span the inner polytope S. The points q\u22171 , q\u22172 , q\u22173 are among the 5 points that span the nested polytope Q. The area around q\u22171 is zoomed in on the right-hand side. The picture illustrates that q\u22171 cannot be moved left on the x-axis without increasing the number of vertices of the nested polytope: A dotted ray from a point slightly to the left of q\u22171 is drawn through s1. Its intersection with the line x = 1 is slightly below q\u22172 . Following the algorithm of [1], the dotted ray is continued in a similar fashion, \u201cwrapping around\u201d s2 and s3, and ending on the x-axis at around x \u2248 0.2, far left of the starting point. On the other hand, the dashed line illustrates that q\u22171 could be moved right (considering only this face).\n(transparent front). The figure also indicates an interior polytope S spanned by 6 points (black dots): s1 = ( 34 , 1 8 , 0) >, s2 = ( 34 , 1 2 , 0) >, s3 = ( 311 , 17 22 , 0) >, s4 = (2, 0, 12 ) >, s5 = ( 12 , 0, 3 4 ) >, s6 = ( 16 , 0, 7 12 ) >. In the following we discuss possible locations of 5 points q1, q2, q3, q4, q5 that span a nested polytope Q. Since s1, s2, s3 all lie on the (brown) face on the xy-plane, but not on a common line, at least 3 of the qi must lie on the xy-plane. A similar statement holds for s4, s5, s6 and the xz-plane. So at least one qi, say q1, must lie on the x-axis.\nSuppose another qi, say q2, lies on the x-axis. Without loss of generality we can take q1 = (0, 0, 0)> and q2 = (1, 0, 0)>, as all points in P on the x-axis are enclosed by these q1, q2. Figure 4 provides a detailed view of the xy-plane. To enclose s2, some q \u2208 {q3, q4, q5} must also lie on the xy-plane and to the right of the line that connects q2 = (1, 0, 0)> and s2. To enclose s3, some q\u2032 \u2208 {q3, q4, q5} must also lie on the xy-plane and to the left of the line that connects q1 = (0, 0, 0)> and s3. If q and q\u2032 were identical then they would lie outside P\u2014a contradiction. Hence 4 points (namely, q1, q2, q, q\u2032) are on the xy-plane. This leaves only one point, say q\u2032\u2032, that is not on the xy-plane. To enclose s4 (see Figure 9 in Appendix D), point q\u2032\u2032 must lie on the xz-plane and must lie to the right of the line that connects q2 = (1, 0, 0)> and s4. To enclose s6, point q\u2032\u2032 must lie to the left of the line that connects q1 = (0, 0, 0)> and s6. Hence q\u2032\u2032 lies outside P\u2014a contradiction.\nHence we have shown that only one point, say q1, lies on the x-axis, and two points besides q1, say q2, q3, lie on the xy-plane, and two points besides q1, say q4, q5, lie on the xz-plane. Figure 4 indicates a possible location (q\u22171 , q\u22172 , q\u22173) of q1, q2, q3. The figure illustrates\nICALP 2016\nXXX:12 On Restricted Nonnegative Matrix Factorization\nthat the x-coordinate of q\u22171 must be at least 2\u2212 \u221a\n2. Figure 5 illustrates how to prove the same fact more formally, using the concept of a slack function (see Section 4): The slack function s(\u03bb) for the interval containing 2\u2212 \u221a 2 has a zero at \u03bb = 2\u2212 \u221a 2, with a sign change from negative to positive. An inspection of the intervals (of the partition I from Section 4) to the \u201cleft\u201d of 2\u2212 \u221a 2 reveals that none of the corresponding slack functions s\u0303 satisfies s\u0303(\u03bb) \u2265 0 for \u03bb < 2 \u2212 \u221a 2. Similarly, the x-coordinate of q\u22171 must be at most 2 \u2212 \u221a\n2, as illustrated by Figures 9 and 10 in Appendix D. Hence q\u22171 = (2\u2212 \u221a 2, 0, 0)> is necessary. This uniquely (up to permutations) determines q\u22172 , q\u22173 and similarly the locations q\u22174 , q\u22175 of q4, q5. With the reduction from Proposition 2 this NPP solution determines the RNMF of M mentioned at the beginning of the proof. Since there is no 4-point solution of the NPP instance, we have rrank+(M) = 5. (Since rank(M) = 4, Lemma 1 implies rank+(M) = 5.) Since there is no 5-point rational solution of the NPP instance, the restricted nonnegative rank of M over Q is 6. J\n6 Conclusion and Future Work\nWe have shown that an optimal restricted nonnegative factorization of a rational matrix may require factors that have irrational entries. An outstanding open problem is whether the same holds for general nonnegative factorizations. An answer to this question will likely shed light on the issue of whether the nonnegative rank can be computed in NP.\nAnother contribution of the paper has been to develop connections between nonnegative matrix factorization and probabilistic automata, thereby answering an old question concerning the latter. Pursuing this connection, and closely related to the above-mentioned open problem, one can ask whether, given a probabilistic automaton with rational transition probabilities, one can always find a minimal equivalent probabilistic automaton that also has rational transition probabilities.\nAcknowledgements. The authors would like to thank Michael Benedikt for stimulating discussions, and anonymous referees for their helpful suggestions. Chistikov was sponsored in part by the ERC Synergy award ImPACT. Kiefer is supported by a University Research Fellowship of the Royal Society. Kiefer, Maru\u0161i\u0107, Shirmohammadi, and Worrell gratefully acknowledge the support of the EPSRC."}, {"heading": "D. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:13", "text": "References 1 A. Aggarwal, H. Booth, J. O\u2019Rourke, S. Suri, and C. K. Yap. Finding minimal convex\nnested polygons. Information and Computation, 83(1):98\u2013110, 1989. 2 S. Arora, R. Ge, R. Kannan, and A. Moitra. Computing a nonnegative matrix factorization\n- provably. In Proceedings of the 44th Symposium on Theory of Computing (STOC), pages 145\u2013162, 2012. 3 F. Bancilhon. A geometric model for stochastic automata. IEEE Trans. Computers, 23(12):1290\u20131299, 1974. 4 M. W. Berry, N. Gillis, and F. Glineur. Document classification using nonnegative matrix factorization and underapproximation. In International Symposium on Circuits and Systems (ISCAS), pages 2782\u20132785. IEEE, 2009. 5 S. S. Bucak and B. G\u00fcnsel. Video content representation by incremental non-negative matrix factorization. In Proceedings of the International Conference on Image Processing (ICIP), pages 113\u2013116. IEEE, 2007. 6 J. Canny. Some algebraic and geometric computations in PSPACE. In Proceedings of the 20th Annual Symposium on Theory of Computing (STOC), pages 460\u2013467, 1988. 7 A. Cichocki, R. Zdunek, A. H. Phan, and S.-i. Amari. Nonnegative Matrix and Tensor Factorizations: Applications to Exploratory Multi-way Data Analysis and Blind Source Separation. Wiley Publishing, 2009. 8 J. E. Cohen and U. G. Rothblum. Nonnegative ranks, decompositions, and factorizations of nonnegative matrices. Linear Algebra and its Applications, 190:149\u2013168, 1993. 9 D. L. Donoho and V. Stodden. When does non-negative matrix factorization give a correct decomposition into parts? In Advances in Neural Information Processing Systems (NIPS), pages 1141\u20131148, 2003. 10 N. Fijalkow, S. Kiefer, and M. Shirmohammadi. Trace refinement in labelled Markov decision processes. In Proceedings of the 19th International Conference on Foundations of Software Science and Computation Structures (FoSSaCS), volume 9634 of Lecture Notes in Computer Science, pages 303\u2013318. Springer, 2016. 11 N. Gillis and F. Glineur. On the geometric interpretation of the nonnegative rank. Linear Algebra and its Applications, 437(11):2685\u20132712, 2012. 12 N. Gillis and S. A. Vavasis. Semidefinite programming based preconditioning for more robust near-separable nonnegative matrix factorization. SIAM Journal on Optimization, 25(1):677\u2013698, 2015. 13 A. Kumar, V. Sindhwani, and P. Kambadur. Fast conical hull algorithms for near-separable non-negative matrix factorization. In Proceedings of the 30th International Conference on Machine Learning (ICML), page 231\u2013239, 2013. 14 D. D. Lee and H. S. Seung. Learning the parts of objects by non-negative matrix factorization. Nature, 401(6755):788\u2013791, 1999. 15 A. Paz. Introduction to probabilistic automata. Academic Press, New York, 1971. 16 J. Renegar. On the computational complexity and geometry of the first-order theory of the reals. Parts I\u2013III. Journal of Symbolic Computation, 13(3):255\u2013352, 1992. 17 Y. Shitov. Nonnegative rank depends on the field. Technical report, arxiv.org, 2015. Available at http://arxiv.org/abs/1505.01893. 18 D. Simanek. How to view 3D without glasses. https://www.lhup.edu/~dsimanek/3d/ view3d.htm. Online, accessed in April 2016. 19 E. Tjioe, M. W. Berry, and R. Homayouni. Discovering gene functional relationships using\nFAUN (feature annotation using nonnegative matrix factorization). BMC Bioinformatics, 11(S-6):S14, 2010.\n20 S. A. Vavasis. On the complexity of nonnegative matrix factorization. SIAM Journal on Optimization, 20(3):1364\u20131377, 2009.\nICALP 2016\nXXX:14 On Restricted Nonnegative Matrix Factorization\n21 T. Yokota, R. Zdunek, A. Cichocki, and Y. Yamashita. Smooth nonnegative matrix and tensor factorizations for robust multi-way data analysis. Signal Processing, 113:234\u2013249, 2015. 22 S. Zhang, W. Wang, J. Ford, and F. Makedon. Learning from incomplete ratings using nonnegative matrix factorization. In Proceedings of the 6th SIAM International Conference on Data Mining, pages 549\u2013553. SIAM, 2006."}, {"heading": "D. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:15", "text": "A Proofs of Section 2\nWe show point 2 from the description of Proposition 2. Let A \u2208 Qn\u00d7(r\u22121) and b \u2208 Qn such that P = {x \u2208 Rr\u22121 | Ax+ b \u2265 0 } is a full-dimensional polytope. Hence (A b) \u2208 Qn\u00d7r has full rank r. Let S = conv{s1, . . . , sm} \u2282 P be a full-dimensional polytope. Define matrix M \u2208 Qn\u00d7m with M j = Asj + b for j \u2208 [m]. We show the correspondences (a) and (b) from the main text.\n(a) Consider an RNMF M = W \u00b7H with inner dimension d. We can assume that W has no zero-columns. We have Col(W ) = Col(M) = Col((A b)): indeed, the first equality holds because the NMF is restricted, and the second equality holds as S is full-dimensional. So there is a matrix C \u2208 Rr\u00d7d such that W = (A b) \u00b7 C. For all i \u2208 [d] define c\u0302i \u2208 Rr\u22121 so\nthat Ci = ( c\u0302i Cr,i ) . Since W is nonnegative, we have Ac\u0302i + Cr,ib \u2265 0. Observe that there is no y \u2208 Rr\u22121 \\ {0} with Ay \u2265 0: indeed, if Ay \u2265 0 for some nonzero y then for any x \u2208 P and any t > 0 we have A(x+ ty) + b \u2265 Ax+ b \u2265 0, implying that P is unbounded, which is false. We use this observation to show that Cr,i > 0.\nTowards a contradiction, suppose Cr,i = 0. Then Ac\u0302i \u2265 0. Since W has no zerocolumns, we have c\u0302i 6= 0, contradicting the observation above.\nTowards a contradiction, suppose Cr,i < 0. By dividing the inequality Ac\u0302i + Cr,ib \u2265 0 by \u2212Cr,i we obtain A(\u2212c\u0302i/Cr,i)\u2212 b \u2265 0. Let x \u2208 P \\ {c\u0302i/Cr,i}. Then Ax+ b \u2265 0, and by adding the previous inequality, we obtain A(x \u2212 c\u0302i/Cr,i) \u2265 0. Since x 6= c\u0302i/Cr,i, this also contradicts the observation above.\nThus we have shown that Cr,i > 0 for all i \u2208 [d]. Define a diagonal matrix D \u2208 Rd\u00d7d such that Di,i = Cri > 0, and define H \u2032 = D \u00b7H. Then we have:\n(A b) ( s1 s2 \u00b7 \u00b7 \u00b7 sm 1 1 \u00b7 \u00b7 \u00b7 1 ) = M = W \u00b7H = (A b)C \u00b7H = (A b)CD\u22121 \u00b7DH\n= (A b) ( c\u03021/Cr,1 c\u03022/Cr,2 \u00b7 \u00b7 \u00b7 c\u0302d/Cr,d\n1 1 \u00b7 \u00b7 \u00b7 1\n) H \u2032.\nSince the columns of (A b) are linearly independent, it follows:\n( s1 s2 \u00b7 \u00b7 \u00b7 sm 1 1 \u00b7 \u00b7 \u00b7 1 ) = ( c\u03021/Cr,1 c\u03022/Cr,2 \u00b7 \u00b7 \u00b7 c\u0302d/Cr,d 1 1 \u00b7 \u00b7 \u00b7 1 ) H \u2032.\nConsidering the last row, we see that each column of H \u2032 sums up to 1. Since H \u2032 is nonnegative, H \u2032 is column-stochastic. For i \u2208 [d] define qi = c\u0302i/Cr,i. Then for all j \u2208 [m] we have sj \u2208 conv{q1, \u00b7 \u00b7 \u00b7 , qd}. Hence, defining the polytope Q = conv{q1, \u00b7 \u00b7 \u00b7 , qd} we have S \u2286 Q. For all i \u2208 [d] we have Ac\u0302i +Cr,ib \u2265 0, hence Aqi + b \u2265 0. It follows Q \u2286 P . Thus Q is nested between P and S.\n(b) Consider d points q1, . . . , qd \u2208 Rr\u22121 with S \u2286 conv{q1, . . . , qd} \u2286 P . Define a matrix W \u2208 Qn\u00d7d by W i = Aqi + b for i \u2208 [d]. Matrix W is nonnegative, as qi \u2208 P . Define a column-stochastic matrix H \u2208 Qd\u00d7m so that sj = \u2211d i=1Hi,jqi for j \u2208 [m]. Such Hi,j\nICALP 2016\nXXX:16 On Restricted Nonnegative Matrix Factorization\nexist, as sj \u2208 conv{q1, . . . , qd}. We have for all j \u2208 [m]:\nM j = Asj + b definition of M = A (\nd\u2211 i=1 Hi,jqi\n) + b definition of H\n= (\nd\u2211 i=1 Aqi \u00b7Hi,j\n) + b\n= d\u2211 i=1 (Aqi + b\ufe38 \ufe37\ufe37 \ufe38 W i ) \u00b7Hi,j as H is column-stochastic = (W \u00b7H)j .\nHence M = W \u00b7H is an NMF. Since S is full-dimensional, we have Col(M) = Col((A b)). As Col(W ) \u2286 Col((A b)) it follows that Col(W ) \u2286 Col(M), hence NMF M = W \u00b7H is restricted.\nB Proofs of Section 3\nB.1 Discussion of Erroneous Claims in [3]\nAs mentioned in the main text, Bancilhon [3, Theorem 13] claims a statement that implies a positive answer to Paz\u2019s Question 4. We have shown that the correct answer to Paz\u2019s question is negative. In the following we track down where the paper [3] goes wrong. The proof of [3, Theorem 13] offered therein relies on another (wrong) claim about cones.\nLet V be a vector space. Let v1, . . . , vn \u2208 V. The polyhedral cone generated by v1, . . . , vn is the set{\nn\u2211 i=1 \u03bbivi \u2223\u2223\u2223\u2223\u2223 \u03bb1, . . . , \u03bbn \u2265 0 } \u2286 V .\nI Claim 11 ([3, Theorem 2], slightly paraphrased). Let V be a vector space. Let V \u2032 \u2286 V be a subspace of V. Let C \u2286 V be a polyhedral cone generated by n vectors that also span V. Then C \u2229 V \u2032 is a polyhedral cone generated by at most n vectors.\nClaim 11 is false. For a counterexample, consider the polyhedral cone C generated by the following 6 vectors: 1 0 0 1 0 0  ,  0 0 0 1 0 0  ,  0 1 0 0 1 0  ,  0 0 0 0 1 0  ,  0 0 1 0 0 1  ,  0 0 0 0 0 1  It can be described equivalently by the conjunction of inequalities 0 \u2264 x1 \u2264 x4 and 0 \u2264 x2 \u2264 x5 and 0 \u2264 x3 \u2264 x6. Let V \u2032 \u2282 R6 be the vector space defined by the equalities x4 = x5 = x6. Then the cone C\u2032 = C \u2229V \u2032 can be described by the inequalities 0 \u2264 x1, x2, x3 \u2264 x4 = x5 = x6."}, {"heading": "D. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:17", "text": "The cone C\u2032 is generated by the following 8 vectors: 0 0 0 1 1 1  ,  0 0 1 1 1 1  ,  0 1 0 1 1 1  ,  0 1 1 1 1 1  ,  1 0 0 1 1 1  ,  1 0 1 1 1 1  ,  1 1 0 1 1 1  ,  1 1 1 1 1 1  .\nAll those vectors are extremal in cone C\u2032, so it cannot be generated by fewer than 8 vectors. Hence, Claim 11 is false.\nLet us further examine how Claim 11 was justified in [3]. The proof offered therein starts with the following claim, which is stated there without further justification:\nI Claim 12 (proof of [3, Theorem 2], slightly paraphrased). A cone C is generated by n vectors if and only if it is limited by n hyperplanes.\nClaim 12 is also false. For a counterexample, consider the cone C \u2286 R4+ limited by the following 6 hyperplanes:\n0 \u2264 x1 \u2264 y, 0 \u2264 x2 \u2264 y, 0 \u2264 x3 \u2264 y.\n(All vectors in C with y = y\u2217 form a cube of length y\u2217.) The following set contains 8 vectors, all of which are extremal in C:\n{0, 1} \u00d7 {0, 1} \u00d7 {0, 1} \u00d7 {1} \u2282 C.\nHence C is not generated by 6 vectors, contradicting Claim 12.\nB.2 Details of the Proof of Proposition 6\nIn this subsection, we complete some details from the proof of Proposition 6.\nProposition 6. Given a nonnegative matrix M \u2208 Qn\u00d7m+ of rank r, one can compute in polynomial time an LMCM = (m+ 2,\u03a3, \u00b5) of rank r + 2 such that for all d \u2208 N:\n(a) any d-dimensional NMF M = W \u00b7 H determines an LMC M\u2032 = (d + 2,\u03a3, \u00b5\u2032) with M\u2032 \u2265M and rank(M\u2032) = rank(W ) + 2, and\n(b) any LMCM\u2032 = (d+2,\u03a3, \u00b5\u2032) withM\u2032 \u2265M determines a d-dimensional NMF M = W \u00b7H with rank(M\u2032) = rank(W ) + 2.\nIn particular, for all d \u2208 N the inequality rrank+(M) \u2264 d holds if and only ifM is covered by some (d+ 2)-state LMCM\u2032 such thatM\u2032 andM have the same rank.\nHere we will write 0 for the column vector with all zeros, whose dimension will be clear from the context. For every p \u2208 N, we denote by Xp the p-fold concatenation of X by itself.\nLet us first take a detailed look at BackM. For every i \u2208 [m] and j \u2208 [n], we have\n(BackM)i,bj = \u00b5(bj)i \u00b7 1 = \u00b5(bj)i,m+1 = Mj,i.\nICALP 2016\nXXX:18 On Restricted Nonnegative Matrix Factorization\nFrom here it is easy to see that for every w \u2208 \u03a3\u2217:\n(BackM)w =  1 w = \u03b5 1 m \u00b7 e0 w = ai with i \u2208 [m] em+1 w = Xp with p \u2208 N (0,Mj , 0)> w = bjXp with j \u2208 [n], p \u2208 N0( 1 mMj,i ) \u00b7 e0 w = aibjXp with i \u2208 [m], j \u2208 [n], p \u2208 N0\n0 otherwise.\nThat is,\nBackM =  \u03b5 b1 \u00b7\u00b7\u00b7 bn X ai aibj b1X \u00b7\u00b7\u00b7 bnX X2 \u00b7\u00b7\u00b7 1 0 \u00b7 \u00b7 \u00b7 0 0 1m 1 mMj,i 0 \u00b7 \u00b7 \u00b7 0 0 \u00b7 \u00b7 \u00b7 1 M1,1 \u00b7 \u00b7 \u00b7 Mn,1 0 0 0 M1,1 \u00b7 \u00b7 \u00b7 Mn,1 0 \u00b7 \u00b7 \u00b7 ... ... . . . ... ... ... ... ... . . . ... ... \u00b7 \u00b7 \u00b7\n1 M1,m \u00b7 \u00b7 \u00b7 Mn,m 0 0 0 M1,m \u00b7 \u00b7 \u00b7 Mn,m 0 \u00b7 \u00b7 \u00b7 1 0 \u00b7 \u00b7 \u00b7 0 1 0 0 0 \u00b7 \u00b7 \u00b7 0 1 \u00b7 \u00b7 \u00b7  Clearly, the following submatrix of BackM has the same column space as BackM:\n \u03b5 b1 \u00b7\u00b7\u00b7 bn X 0 1 0 \u00b7 \u00b7 \u00b7 0 0 1 1 M1,1 \u00b7 \u00b7 \u00b7 Mn,1 0 ... ... ... . . . ...\n... m 1 M1,m \u00b7 \u00b7 \u00b7 Mn,m 0 m+1 1 0 \u00b7 \u00b7 \u00b7 0 1  This implies that rank(M) = rank(M) + 2 = r + 2.\nFor direction (a), consider an NMFM = W \u00b7H and the LMCM\u2032 defined in the main text. For its backward matrix BackM\u2032 \u2208 R{0,1,...,d,d+1}\u00d7\u03a3 \u2217\n+ , it is easy to see from the definition that for every w \u2208 \u03a3\u2217:\n(BackM\u2032)w =  1 w = \u03b5 1 m \u00b7 e0 w = ai with i \u2208 [m] ed+1 w = Xp with p \u2208 N (0,Wj , 0)> w = bjXp with j \u2208 [n], p \u2208 N0( 1 mMj,i ) \u00b7 e0 w = aibjXp with i \u2208 [m], j \u2208 [n], p \u2208 N0\n0 otherwise.\nIndeed, for every i \u2208 [m]:\n(BackM\u2032)ai = \u2211 l\u2208[d] 1 m Hl,i  \u00b7 e0 = 1 m \u00b7 e0,\nsince H is a column-stochastic matrix. From here it is clear that the columns of the following"}, {"heading": "D. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:19", "text": "submatrix of BackM\u2032 span Col(BackM\u2032):\n \u03b5 b1 \u00b7\u00b7\u00b7 bn X 0 1 0 \u00b7 \u00b7 \u00b7 0 0 1 1 W1,1 \u00b7 \u00b7 \u00b7 Wn,1 0 ... ... ... . . . ...\n... d 1 W1,d \u00b7 \u00b7 \u00b7 Wn,d 0 d+1 1 0 \u00b7 \u00b7 \u00b7 0 1  Hence, rank(M\u2032) = rank(W ) + 2. In particular, if NMF M = W \u00b7 H is restricted, then rank(M) = rank(M) + 2 = rank(W ) + 2 = rank(M\u2032).\nNow we show in more detail thatM\u2032 \u2265M. We define a row-stochastic matrix:\nA =  1 0 \u00b7 \u00b7 \u00b7 0 0 0 H1,1 \u00b7 \u00b7 \u00b7 Hd,1 0 ... ... . . . ... ...\n0 H1,m \u00b7 \u00b7 \u00b7 Hd,m 0 0 0 \u00b7 \u00b7 \u00b7 0 1\n \u2208 R{0,1,...,m,m+1}\u00d7{0,1,...,d,d+1}+ .\nFor every i \u2208 [m] and j \u2208 [n]:\n(A \u00b7BackM\u2032)i,bj = Ai \u00b7(BackM\u2032)bj = (Hi)> \u00b7(Wj)> = (Wj \u00b7Hi)> = Mj,i = (BackM)i,bj .\nFrom here it follows easily that A \u00b7 BackM\u2032 = BackM. Hence,M\u2032 \u2265M. Lastly we prove the other direction, (b). Let LMC M\u2032 = (d + 2,\u03a3, \u00b5\u2032) be such that M\u2032 \u2265M. This implies that there exists a row-stochastic matrix A such that A \u00b7 BackM\u2032 = BackM. Given nonempty subsets I and J of the row and column indices of a matrix C, respectively, we write CI,J for the submatrix (Ci,j)i\u2208I,j\u2208J . It is clear from the description of BackM that M has the following (d+ 2)-dimensional nonnegative factorization:\nM> = (BackM)[m],{b1,...,bn} = A[m],{0,1,...,d,d+1} \u00b7 (BackM \u2032){0,1,...,d,d+1},{b1,...,bn}. (2)\nAssuming M is a non-zero matrix, there exist i \u2208 [m] and j \u2208 [n] such that Mj,i > 0. Then,\n1 m Mj,i = (BackM)0,aibj = A0 \u00b7 (BackM\u2032)aibj = d+1\u2211 i1=0 A0,i1 \u00b7 (BackM\u2032)i1,aibj > 0.\nSince A and (BackM\u2032) are nonnegative matrices, there exists i1 \u2208 {0, 1, ..., d, d + 1} such that A0,i1 \u00b7 (BackM\u2032)i1,aibj > 0. Without loss of generality, we may assume that i1 = 0. That is,\nA0,0 \u00b7 (BackM\u2032)0,aibj > 0. (3)\nMoreover, (BackM)m+1,X = Am+1 \u00b7 (BackM\u2032)X = 1. The nonnegativity implies that there exists i2 \u2208 {0, 1, ..., d, d+ 1} such that Am+1,i2 \u00b7 (BackM\u2032)i2,X > 0. Note that i2 6= 0 since otherwise we would have that (BackM)m+1,aibj \u2265 Am+1,0 \u00b7 (BackM\u2032)0,aibj > 0 which is a contradiction. We may therefore, without loss of generality, assume that i2 = d+ 1, i.e.,\nAm+1,d+1 \u00b7 (BackM\u2032)d+1,X > 0. (4)\nI Lemma 13. It holds that M> = A[m],[d] \u00b7 (BackM\u2032)[d],{b1,...,bn}, where matrix A[m],[d] is row-stochastic.\nICALP 2016\nXXX:20 On Restricted Nonnegative Matrix Factorization\nProof. By (2), it suffices to show that\nA[m],{0,1,...,d,d+1} \u00b7 (BackM\u2032){0,1,...,d,d+1},{b1,...,bn} = A[m],[d] \u00b7 (BackM \u2032)[d],{b1,...,bn}.\nThat is, for any l1 \u2208 [m] and l2 \u2208 [n] we need to show that\nAl1,{0,1,...,d,d+1} \u00b7 (BackM \u2032){0,1,...,d,d+1},bl2 = Al1,[d] \u00b7 (BackM \u2032)[d],bl2 .\nTo do this, it suffices to show that Al1,0 \u00b7 (BackM\u2032)0,bl2 +Al1,d+1 \u00b7 (BackM \u2032)d+1,bl2 = 0. In the following, we prove that Al1,0 = 0 and Al1,d+1 = 0. By an analogous argument, it also holds that (BackM\u2032)0,bl2 = 0 and (BackM\n\u2032)d+1,bl2 = 0. If Al1,0 > 0, then from (3) it would follow that\n(BackM)l1,aibj = Al1 \u00b7 (BackM\u2032)aibj \u2265 Al1,0 \u00b7 (BackM\u2032)0,aibj > 0,\nwhich is a contradiction since (BackM)l1,aibj = 0 for all l1 \u2208 [m]. Similarly, if Al1,d+1 > 0 then by (4) we would have that\n(BackM)l1,X = Al1 \u00b7 (BackM\u2032)X \u2265 Al1,d+1 \u00b7 (BackM\u2032)d+1,X > 0,\nwhich is a contradiction since (BackM)l1,X = 0 for all l1 \u2208 [m]. Hence, Al1,0 = Al1,d+1 = 0. We have thus shown that A[m],{0} = A[m],{d+1} = (0, . . . , 0)>. Since A is row stochastic, this implies that A[m],[d] is row-stochastic. J\nFrom Lemma 13 we get a d-dimensional nonnegative factorizaton M = W \u00b7 H where W = ((BackM\u2032)[d],{b1,...,bn})> and H = (A[m],[d])>.\nSuppose M\u2032 and M have the same rank. Then Row(BackM) = Row(BackM\u2032), as we already knew that Row(BackM) \u2286 Row(BackM\u2032) since A \u00b7 BackM\u2032 = BackM. Take any v \u2208 Col(W ). Since W> = (BackM\u2032)[d],{b1,...,bn}, there exists u \u2208 Row(BackM\u2032) such that v> = u{b1,...,bn}. As Row(BackM\u2032) = Row(BackM), from BackM it is clear that v \u2208 Col(M). Hence, Col(W ) \u2286 Col(M) and therefore rank(W ) \u2264 rank(M). Since M = W \u00b7H, this implies that rank(W ) = rank(M) as required. This completes the proof of Proposition 6.\nC Proofs of Section 4\nFirst we prove Lemma 9 from the main text.\nLemma 9. Consider bounded polygons S \u2286 P \u2286 R2 whose vertices are rational and of bit-length L. Then the ray function associated with a supporting line segment uv has the form r(\u03bb) = a\u03bb+bc\u03bb+d , where coefficients a, b, c, d are rational numbers with bit-length O(L) that can be computed in polynomial time.\nProof. Let vertices u and v lie on edges p1p\u20321 and p2p\u20322 of P , respectively. Let s1 be the point where the supporting line segment uv touches the inner polygon S on its left. Let \u03bb1 and \u03bb2 be the convex representations of u and v, respectively. That is, u = (1\u2212 \u03bb1)p1 + \u03bb1p\u20321 and v = (1\u2212 \u03bb2)p2 + \u03bb2p\u20322. By definition of the ray function r we have \u03bb2 = r(\u03bb1).\nLet us first consider the case when lines p1p\u20321 and p2p\u20322 are parallel; see Figure 6 for illustration. Let t denote the intersection of lines p1p\u20321 and s1p2, and let t\u2032 denote the intersection of lines p2p\u20322 and s1p\u20321. Since s1 \u2208 Q2, we have t = (1 \u2212 b) \u00b7 p1 + b \u00b7 p\u20321 and t\u2032 = (1 \u2212 d) \u00b7 p2 + d \u00b7 p\u20322 for some b, d \u2208 Q. Numbers b, d can be computed from the input vertices p1, p\u20321, p2, p\u20322 using a constant number of arithmetic operations and therefore have"}, {"heading": "D. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:21", "text": "bit-length O(L). Since 4tus1 \u223c 4p2vs1 and 4tp\u20321s1 \u223c 4p2t\u2032s1, we have utvp2 = ts1 s1p2 and ts1 s1p2 = p \u2032 1t t\u2032p2 . Hence, utvp2 = p\u20321t t\u2032p2 and therefore \u03bb1\u2212b\u03bb2 = 1\u2212b d . Hence,\n\u03bb2 = d 1\u2212 b \u00b7 \u03bb1 \u2212 bd 1\u2212 b\nwhere the coefficients d1\u2212b , bd 1\u2212b \u2208 Q have bit-length O(L). Let us now consider the second case: when lines p1p\u20321 and p2p\u20322 are not parallel. Let t denote their intersection; see Figure 7 for illustration. Note that t \u2208 Q2. Without loss of generality, let p\u20321 be a convex combination of {p1, t} and p2 be a convex combination of {t, p\u20322}. Then p\u20321 = (1\u2212 a) \u00b7 p1 + a \u00b7 t and p2 = (1\u2212 b) \u00b7 t+ b \u00b7 p\u20322 for some a, b \u2208 [0, 1]. Numbers a, b are rational as they are each the unique solution of a linear system with rational coefficients. Moreover a, b can be computed from the input vertices p1, p\u20321, p2, p\u20322 using a constant number of arithmetic operations and therefore have bit-length O(L). Using the above representation of p\u20321 as a convex combination of {p1, t}, we get\nu = (1\u2212 \u03bb1) \u00b7 p1 + \u03bb1 \u00b7 ((1\u2212 a) \u00b7 p1 + a \u00b7 t) = (1\u2212 a\u03bb1) \u00b7 p1 + a\u03bb1 \u00b7 t\nand therefore u\u2212 t = (1\u2212 a\u03bb1) \u00b7 (p1 \u2212 t). Similarly, we have\nv = (1\u2212 b\u2212 \u03bb2 + \u03bb2b) \u00b7 t+ (b+ \u03bb2 \u2212 \u03bb2b) \u00b7 p\u20322\nICALP 2016\nXXX:22 On Restricted Nonnegative Matrix Factorization\nand therefore v \u2212 t = (b + \u03bb2 \u2212 \u03bb2b) \u00b7 (p\u20322 \u2212 t). Let the line through s1 parallel with p1t intersect p\u20322t at point t\u2032. Note that s1 \u2212 t\u2032 = c \u00b7 (p1 \u2212 t) and t\u2032 \u2212 t = d \u00b7 (p\u20322 \u2212 t) for some c, d \u2208 [0, 1] \u2229Q. Numbers c, d can be computed from vertices p1, p\u20321, p2, p\u20322 using a constant number of arithmetic operations and thus have bit-length O(L). Since 4vt\u2032s1 \u223c 4vtu, it holds that vt \u2032\nvt = s1t \u2032 ut . We therefore have that\nb+ \u03bb2 \u2212 \u03bb2b\u2212 d b+ \u03bb2 \u2212 \u03bb2b = c1\u2212 a\u03bb1 .\nFrom the above equation we get that\n\u03bb2 = a(b\u2212 d) \u00b7 \u03bb1 + b(c\u2212 1) + d a(b\u2212 1) \u00b7 \u03bb1 + (b\u2212 1)(c\u2212 1)\nwhere a(b\u2212 d), b(c\u2212 1) + d, a(b\u2212 1), (b\u2212 1)(c\u2212 1) \u2208 Q have bit-length O(L). J\nA function f : I \u2192 R, where I \u2286 R, is called a rational linear fractional transformation if there exist a, b, c, d \u2208 Q such that f(\u03bb) = a\u03bb+bc\u03bb+d for every \u03bb \u2208 I.\nI Lemma 14. Given two rational linear fractional transformations f1(\u03bb) = a1\u03bb+b1c1\u03bb+d1 and f2(\u03bb) = a2\u03bb+b2c2\u03bb+d2 , their composition f2 \u25e6 f1 is also a rational linear fractional transformation. Specifically, (f2 \u25e6 f1)(\u03bb) = a\u03bb+bc\u03bb+d where a, b, c, d \u2208 Q are such that[\na b\nc d ] = [ a2 b2 c2 d2 ] \u00b7 [ a1 b1 c1 d1 ] .\nProof. For every \u03bb we have\n(f2 \u25e6 f1)(\u03bb) = a2\na1\u03bb+b1 c1\u03bb+d1 + b2 c2 a1\u03bb+b1 c1\u03bb+d1 + d2\n= a2(a1\u03bb+ b1) + b2(c1\u03bb+ d1) c2(a1\u03bb+ b1) + d2(c1\u03bb+ d1) = (a2a1 + b2c1)\u03bb+ (a2b1 + b2d1)(c2a1 + d2c1)\u03bb+ (c2b1 + d2d1) .\nJ\nI Corollary 15. Given ri(\u03bb) = ai\u03bb+bici\u03bb+di in terms of ai, bi, ci, di \u2208 Q, for i \u2208 [k], one can compute in polynomial time a, b, c, d \u2208 Q such that r(\u03bb) = (rk \u25e6 . . . \u25e6 r2 \u25e6 r1)(\u03bb) = a\u03bb+bc\u03bb+d .\nProof. By Lemma 14, the coefficients of the composition rk \u25e6 . . . \u25e6 r2 \u25e6 r1 are computable by iterative matrix multiplication:[\na b\nc d ] = [ ak bk ck dk ] \u00b7 . . . \u00b7 [ a2 b2 c2 d2 ] \u00b7 [ a1 b1 c1 d1 ] .\nThe result follows. J\nD Additional Figures for Section 5\nFigure 8 shows a variant of Figure 3, suitable for \u201ccross-eyed\u201d stereoscopic viewing. Figure 9 shows the xz-plane, in the same way as Figure 4 shows the xy-plane. Figure 10 plots the corresponding slack function. It shows that a sign change from positive to negative occurs at the root \u03bb = 2\u2212 \u221a\n2. Figure 11 provides a combined view of the xy-plane and the xz-plane, with the coordinates\nof some vertices of P .\nD. Chistikov and S. Kiefer and I. Maru\u0161i\u0107 and M. Shirmohammadi and J. Worrell XXX:23\nx\ny\nz\nx\ny\nz\nFigure 8 Two projections of P suitable for \u201ccross-eyed\u201d stereoscopic viewing.\nx\nz\n0.25 0.5 0.75 1.0 1.25 1.5 1.75 2.0 2.25\n0.25\n0.5\n0.75\n1.0\n1.25\ns4\ns5\ns6\nq\u22171 = (2\u2212 \u221a 2, 0, 0)> \u2248 (0.5858, 0, 0)>\nq\u22174\nq\u22175 x\nz\n0.25 5 0.75 1.0 1.25 1.5 1.75 2.0 2.25\n0.25\n0.5 0.75 1.0 1.25\ns4 s5 s6\nq\u22171 = (2\u2212\n\u221a 2, 0, 0)> \u2248 (0.5858, 0, 0)>\nq\u22174 q\u22175\nFigure 9 Detailed view on the xz-plane. The image shows that q\u22171 cannot be moved right on the x-axis without increasing the number of vertices of the nested polytope.\nICALP 2016\nXXX:24 On Restricted Nonnegative Matrix Factorization"}], "references": [{"title": "Finding minimal convex nested polygons", "author": ["A. Aggarwal", "H. Booth", "J. O\u2019Rourke", "S. Suri", "C.K. Yap"], "venue": "Information and Computation,", "citeRegEx": "Aggarwal et al\\.,? \\Q1989\\E", "shortCiteRegEx": "Aggarwal et al\\.", "year": 1989}, {"title": "Computing a nonnegative matrix factorization - provably", "author": ["S. Arora", "R. Ge", "R. Kannan", "A. Moitra"], "venue": "In Proceedings of the 44th Symposium on Theory of Computing (STOC),", "citeRegEx": "Arora et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Arora et al\\.", "year": 2012}, {"title": "A geometric model for stochastic automata", "author": ["F. Bancilhon"], "venue": "IEEE Trans. Computers,", "citeRegEx": "Bancilhon.,? \\Q1974\\E", "shortCiteRegEx": "Bancilhon.", "year": 1974}, {"title": "Document classification using nonnegative matrix factorization and underapproximation", "author": ["M.W. Berry", "N. Gillis", "F. Glineur"], "venue": "In International Symposium on Circuits and Systems (ISCAS),", "citeRegEx": "Berry et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Berry et al\\.", "year": 2009}, {"title": "Video content representation by incremental non-negative matrix factorization", "author": ["S.S. Bucak", "B. G\u00fcnsel"], "venue": "In Proceedings of the International Conference on Image Processing (ICIP),", "citeRegEx": "Bucak and G\u00fcnsel.,? \\Q2007\\E", "shortCiteRegEx": "Bucak and G\u00fcnsel.", "year": 2007}, {"title": "Some algebraic and geometric computations in PSPACE", "author": ["J. Canny"], "venue": "In Proceedings of the 20th Annual Symposium on Theory of Computing (STOC),", "citeRegEx": "Canny.,? \\Q1988\\E", "shortCiteRegEx": "Canny.", "year": 1988}, {"title": "Nonnegative Matrix and Tensor Factorizations: Applications to Exploratory Multi-way Data Analysis and Blind Source Separation", "author": ["A. Cichocki", "R. Zdunek", "A.H. Phan", "S.-i. Amari"], "venue": "Wiley Publishing,", "citeRegEx": "Cichocki et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Cichocki et al\\.", "year": 2009}, {"title": "Nonnegative ranks, decompositions, and factorizations of nonnegative matrices", "author": ["J.E. Cohen", "U.G. Rothblum"], "venue": "Linear Algebra and its Applications,", "citeRegEx": "Cohen and Rothblum.,? \\Q1993\\E", "shortCiteRegEx": "Cohen and Rothblum.", "year": 1993}, {"title": "When does non-negative matrix factorization give a correct decomposition into parts", "author": ["D.L. Donoho", "V. Stodden"], "venue": "In Advances in Neural Information Processing Systems (NIPS),", "citeRegEx": "Donoho and Stodden.,? \\Q2003\\E", "shortCiteRegEx": "Donoho and Stodden.", "year": 2003}, {"title": "Trace refinement in labelled Markov decision processes", "author": ["N. Fijalkow", "S. Kiefer", "M. Shirmohammadi"], "venue": "In Proceedings of the 19th International Conference on Foundations of Software Science and Computation Structures (FoSSaCS),", "citeRegEx": "Fijalkow et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Fijalkow et al\\.", "year": 2016}, {"title": "On the geometric interpretation of the nonnegative rank", "author": ["N. Gillis", "F. Glineur"], "venue": "Linear Algebra and its Applications,", "citeRegEx": "Gillis and Glineur.,? \\Q2012\\E", "shortCiteRegEx": "Gillis and Glineur.", "year": 2012}, {"title": "Semidefinite programming based preconditioning for more robust near-separable nonnegative matrix factorization", "author": ["N. Gillis", "S.A. Vavasis"], "venue": "SIAM Journal on Optimization,", "citeRegEx": "Gillis and Vavasis.,? \\Q2015\\E", "shortCiteRegEx": "Gillis and Vavasis.", "year": 2015}, {"title": "Fast conical hull algorithms for near-separable non-negative matrix factorization", "author": ["A. Kumar", "V. Sindhwani", "P. Kambadur"], "venue": "In Proceedings of the 30th International Conference on Machine Learning (ICML),", "citeRegEx": "Kumar et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Kumar et al\\.", "year": 2013}, {"title": "Learning the parts of objects by non-negative matrix factorization", "author": ["D.D. Lee", "H.S. Seung"], "venue": null, "citeRegEx": "Lee and Seung.,? \\Q1999\\E", "shortCiteRegEx": "Lee and Seung.", "year": 1999}, {"title": "Introduction to probabilistic automata", "author": ["A. Paz"], "venue": null, "citeRegEx": "Paz.,? \\Q1971\\E", "shortCiteRegEx": "Paz.", "year": 1971}, {"title": "On the computational complexity and geometry of the first-order theory of the reals. Parts I\u2013III", "author": ["J. Renegar"], "venue": "Journal of Symbolic Computation,", "citeRegEx": "Renegar.,? \\Q1992\\E", "shortCiteRegEx": "Renegar.", "year": 1992}, {"title": "Nonnegative rank depends on the field", "author": ["Y. Shitov"], "venue": "Technical report, arxiv.org,", "citeRegEx": "Shitov.,? \\Q2015\\E", "shortCiteRegEx": "Shitov.", "year": 2015}, {"title": "How to view 3D without glasses. https://www.lhup.edu/~dsimanek/3d/ view3d.htm. Online, accessed in April 2016", "author": ["D. Simanek"], "venue": null, "citeRegEx": "Simanek.,? \\Q2016\\E", "shortCiteRegEx": "Simanek.", "year": 2016}, {"title": "Discovering gene functional relationships using FAUN (feature annotation using nonnegative matrix factorization)", "author": ["E. Tjioe", "M.W. Berry", "R. Homayouni"], "venue": "BMC Bioinformatics,", "citeRegEx": "Tjioe et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Tjioe et al\\.", "year": 2010}, {"title": "On the complexity of nonnegative matrix factorization", "author": ["S.A. Vavasis"], "venue": "SIAM Journal on Optimization,", "citeRegEx": "Vavasis.,? \\Q2009\\E", "shortCiteRegEx": "Vavasis.", "year": 2009}, {"title": "Smooth nonnegative matrix and tensor factorizations for robust multi-way data analysis", "author": ["T. Yokota", "R. Zdunek", "A. Cichocki", "Y. Yamashita"], "venue": "Signal Processing,", "citeRegEx": "Yokota et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Yokota et al\\.", "year": 2015}, {"title": "Learning from incomplete ratings using nonnegative matrix factorization", "author": ["S. Zhang", "W. Wang", "J. Ford", "F. Makedon"], "venue": "In Proceedings of the 6th SIAM International Conference on Data Mining,", "citeRegEx": "Zhang et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Zhang et al\\.", "year": 2006}], "referenceMentions": [], "year": 2016, "abstractText": "Nonnegative matrix factorization (NMF) is the problem of decomposing a given nonnegative n \u00d7 m matrix M into a product of a nonnegative n \u00d7 d matrix W and a nonnegative d \u00d7 m matrix H. Restricted NMF requires in addition that the column spaces of M and W coincide. Finding the minimal inner dimension d is known to be NP-hard, both for NMF and restricted NMF. We show that restricted NMF is closely related to a question about the nature of minimal probabilistic automata, posed by Paz in his seminal 1971 textbook. We use this connection to answer Paz\u2019s question negatively, thus falsifying a positive answer claimed in 1974. Furthermore, we investigate whether a rational matrix M always has a restricted NMF of minimal inner dimension whose factors W and H are also rational. We show that this holds for matrices M of rank at most 3 and we exhibit a rank-4 matrix for which W and H require irrational entries. 1998 ACM Subject Classification F.1.1 Models of Computation, F.2.1 Numerical Algorithms and Problems", "creator": "LaTeX with hyperref package"}}}