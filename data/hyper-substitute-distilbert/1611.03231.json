{"id": "1611.03231", "review": {"conference": "AAAI", "VERSION": "v1", "DATE_OF_SUBMISSION": "10-Nov-2016", "title": "Policy Search with High-Dimensional Context Variables", "abstract": "direct vector constraint search methods learn effectively improve policy parameters and sufficiently assess government behavior using different context or data needs. however, learning from high - dimensional context variables, which included camera operators, is still extremely prominent characteristic performing many real - world tasks. a naive task combine infinite dimensionality reduction methods and assess dynamic,, such as principal component analysis, is significant as task - type input may remain ignored. in classroom paper, programs propose a static consensus reconstruction argument in the model - based relative entropy stochastic analysis framework describing integrated dimensionality reduction. we learn a law of selection law that is locally quadratic in both multiple policy curves minus common focus variables. lastly, objects perform maximal linear dimensionality attacks on the context variables through nuclear norm transformation. the comparison results show between the dependency method implement simple dimensionality replacement approaches principal component analysis and a state - of - the - element behavioral policy search method.", "histories": [["v1", "Thu, 10 Nov 2016 09:25:12 GMT  (749kb)", "http://arxiv.org/abs/1611.03231v1", null]], "reviews": [], "SUBJECTS": "stat.ML cs.LG", "authors": ["voot tangkaratt", "herke van hoof", "simone parisi", "gerhard neumann", "jan peters 0001", "masashi sugiyama"], "accepted": true, "id": "1611.03231"}, "pdf": {"name": "1611.03231.pdf", "metadata": {"source": "CRF", "title": "Policy Search with High-Dimensional Context Variables", "authors": ["Voot Tangkaratt", "Herke van Hoof", "Simone Parisi", "Gerhard Neumann", "Jan Peters", "Masashi Sugiyama"], "emails": [], "sections": [{"heading": null, "text": "ar X\niv :1\n61 1.\n03 23\n1v 1\n[ st\nat .M\nL ]\n1 0\nN ov\n2 01\nDirect contextual policy search methods learn to improve policy parameters and simultaneously generalize these parameters to different context or task variables. However, learning from high-dimensional context variables, such as camera images, is still a prominent problem in many real-world tasks. A naive application of unsupervised dimensionality reduction methods to the context variables, such as principal component analysis, is insufficient as task-relevant input may be ignored. In this paper, we propose a contextual policy search method in the model-based relative entropy stochastic search framework with integrated dimensionality reduction. We learn a model of the reward that is locally quadratic in both the policy parameters and the context variables. Furthermore, we perform supervised linear dimensionality reduction on the context variables by nuclear norm regularization. The experimental results show that the proposed method outperforms naive dimensionality reduction via principal component analysis and a state-ofthe-art contextual policy search method."}, {"heading": "Introduction", "text": "An autonomous agent often requires different policies for solving tasks with different contexts. For instance, in a ball hitting task the robot has to adapt his controller according to the ball position, i.e., the context. Direct policy search approaches (Baxter and Bartlett, 2000; Rosenstein and Barto, 2001; Deisenroth, Neumann, and Peters, 2013) allow the agent to learn a separate policy for each context through trial and error. However, learning optimal policies for many large contexts, such as in the presence of continuous context variables, is impracticable. On the other hand, direct contextual policy search approaches (Kober, Oztop, and Peters, 2011; Neumann, 2011; da Silva, Konidaris, and Barto, 2012) represent\nthe contexts by real-valued vectors and are able to learn a context-dependent distribution over the policy parameters. Such a distribution can generalize across context values and therefore the agent is able to adapt to unseen contexts.\nYet, direct policy search methods (both contextual and plain) usually require a lot of evaluations of the objective and may converge prematurely. To alleviate these issues, Abdolmaleki et al. (2015) recently proposed a stochastic search framework called model-based relative entropy stochastic search (MORE). In this framework, the new search distribution can be computed efficiently in a closed form using a learned model of the objective function. MORE outperformed state-of-the-art methods in stochastic optimization problems and single-context policy search problems, but its application to contextual policy search has not been explored yet. One of the contributions in this paper is a novel contextual policy search method in the MORE framework.\nHowever, a naive extension of the original MORE would still suffer from high-dimensional contexts. Learning from high-dimensional variables, in fact, is still an important problem in statistics and machine learning (Bishop, 2006). Nowadays, high-dimensional data (e.g., camera images) can often be obtained quite easily, but obtaining informative low-dimensional variables (e.g., exact ball positions) is non-trivial and requires prior knowledge and/or human guidance.\nIn this paper, we propose to handle high-dimensional context variables by learning a low-rank representation of the objective function. We show that learning a lowrank representation corresponds to performing linear dimensionality reduction on the context variables. Since optimization with a rank constraint is generally NPhard, we minimize the nuclear norm (also called trace norm), which is a convex surrogate of the rank function (Recht, Fazel, and Parrilo, 2010). This minimization allows us to learn a low-rank representation in a fully supervised manner by just solving a convex optimization problem. We evaluate the proposed method on a syn-\nthetic task with known ground truth and on robotic ball hitting tasks based on camera images. The evaluation shows that the proposed method with nuclear norm minimization outperforms the methods that naively perform principal component analysis to reduce the dimensionality of context variables."}, {"heading": "Contextual Policy Search", "text": "In this section, we formulate the direct contextual policy search problem and briefly discuss existing methods."}, {"heading": "Problem Formulation", "text": "The direct contextual policy search is formulated as follows. An agent observes the context variable c \u2208 Rdc and draws a parameter \u03b8 \u2208 Rd\u03b8 from a search distribution \u03c0(\u03b8|c). Subsequently, the agent executes a policy with the parameter \u03b8 and observes a scalar reward computed by a reward function R(\u03b8, c). The goal is to find a search distribution \u03c0(\u03b8|c) maximizing the expected reward\n\u222b\u222b \u00b5(c)\u03c0(\u03b8|c)R(\u03b8, c)d\u03b8dc, (1)\nwhere \u00b5(c) denotes the context distribution. We assume that the reward function R(\u03b8, c) itself is unknown, but the agent can always access the reward value."}, {"heading": "Related Work", "text": "In the basic direct contextual policy search framework, the agent iteratively collects samples {(\u03b8n, cn, R(\u03b8n, cn))}Nn=1 using a sampling distribution q(\u03b8|c). Subsequently, it computes a new search distribution \u03c0(\u03b8|c) such that the expected reward increases or is maximized. In literature, different approaches have been used to compute the new search distribution, e.g., evolutionary strategies (Hansen, Mu\u0308ller, and Koumoutsakos, 2003), expectation-maximization algorithms (Kober, Oztop, and Peters, 2011), or information theoretic approaches (Deisenroth, Neumann, and Peters, 2013).\nMost of the existing direct contextual policy search methods focus on tasks with low-dimensional context variables. To learn from high-dimensional context variables, usually the problem of learning a lowdimensional context representation is separated from the direct policy search by preprocessing the context space. However, unsupervised linear dimensionality reduction techniques are insufficient in problems where the latent representation contains distractor dimensions that do not influence the reward. A prominent example is principal component analysis (PCA) (Jolliffe, 1986), that does not take the supervisory signal into\naccount and therefore cannot discriminate between relevant and irrelevant latent dimensions. On the other hand, supervised linear dimensionality reduction techniques require a suitable response variable. However, defining such a variable can be subjective. Moreover, they often involve non-convex optimization and suffer from local optima (Fukumizu, Bach, and Jordan, 2009; Suzuki and Sugiyama, 2013).\nIn the last years, non-linear dimensionality reduction techniques based on deep learning have gained popularity (Bengio, 2009). For instance, Watter et al. (2015) proposed a generative deep network to learn lowdimensional representations of images in order to capture information about the system transition dynamics and allow optimal control problems to be solved in lowdimensional spaces. More recently, Silver et al. (2016) successfully trained a machine to play a high-level game of go using a deep convolutional network. Although their work does not directly focus on dimensionality reduction, the deep convolutional network is known to be able to extract meaningful representation of data. Thus, the effect of dimensionality reduction is achieved.\nHowever, deep learning approaches generally require large datasets that are difficult to obtain in real-world scenarios (e.g., robotics). Furthermore, they involve solving non-convex optimization, which can suffer from local optima.\nIn this paper, we tackle the issues raised above. First, the proposed approach integrates supervised linear dimensionality reduction on the context variables by learning a low-rank representation for the reward model. Second, the problem is formalized as a convex optimization problem and is therefore guaranteed to converge to a global optimum."}, {"heading": "Contextual MORE", "text": "The original MORE (Abdolmaleki et al., 2015) finds a search distribution (without context) that maximizes the expected reward while upper-bounding the KullbackLeibler (KL) divergence (Kullback and Leibler, 1951) and lower-bounding the entropy. The KL and the entropy are bounded to control the exploration-exploitation trade-off. The key insight of MORE is to learn a reward model to efficiently compute a new search distribution in closed form. Below, we propose our method called contextual model-based relative entropy stochastic search (C-MORE), which is a direct contextual policy search method in the MORE framework."}, {"heading": "Learning the Search Distribution", "text": "The goal of C-MORE is to find a search distribution \u03c0(\u03b8|c) that maximizes the expected reward while upperbounding the expected KL divergence between \u03c0(\u03b8|c)\nand q(\u03b8|c), and lower-bounding the expected entropy of \u03c0(\u03b8|c). Formally,\nmax \u03c0\n\u222b\u222b \u00b5(c)\u03c0(\u03b8|c)R(\u03b8, c)d\u03b8dc,\ns.t. \u222b\u222b \u00b5(c)\u03c0(\u03b8|c) log \u03c0(\u03b8|c)\nq(\u03b8|c) d\u03b8dc \u2264 \u01eb,\n\u2212 \u222b\u222b\n\u00b5(c)\u03c0(\u03b8|c) log \u03c0(\u03b8|c)d\u03b8dc \u2265 \u03b2, \u222b\u222b\n\u00b5(c)\u03c0(\u03b8|c)d\u03b8dc = 1,\nwhere the KL upper-bound \u01eb and the entropy lowerbound \u03b2 are parameters specified by the user. The former is fixed for the whole learning process. The latter is adaptively changed according to the percentage of the relative difference between the sampling policy\u2019s expected entropy and the minimal entropy, as described by Abdolmaleki et al. (2015), i.e.,\n\u03b2 = \u03b3(E[H(q)]\u2212H0) +H0,\nwhere E[H(q)] = \u2212 \u222b\u222b\n\u00b5(c)q(\u03b8|c) log q(\u03b8|c)d\u03b8dc is the sampling policy\u2019s expected entropy and H0 is the minimal entropy. In the experiments, we set \u03b3 = 0.99 and H0 = \u2212150. The above optimization problem can be solved by the method of Lagrange multipliers1. The solution is given by \u03c0(\u03b8|c) = q(\u03b8|c) \u03b7\u03b7+\u03c9 exp ( R(\u03b8, c)\n\u03b7 + \u03c9\n) exp ( \u2212\u03b7 + \u03c9 \u2212 \u03b3\n\u03b7 + \u03c9\n) ,\nwhere \u03b7 > 0 and \u03c9 > 0 are the Lagrange multipliers obtained by minimizing the dual function\ng(\u03b7, \u03c9) = \u03b7\u01eb\u2212 \u03c9\u03b2 + (\u03b7 + \u03c9)\u00d7 \u222b \u00b5(c)\nlog (\u222b q(\u03b8|c) \u03b7\u03b7+\u03c9 exp ( R(\u03b8, c)\n\u03b7 + \u03c9\n) d\u03b8 ) dc.\n(2)\nEvaluating the above integral is not trivial due to the integration over q(\u03b8|c) \u03b7\u03b7+\u03c9 , that cannot be approximated straightforwardly by sample averages. Below, we describe how to solve this issue and evaluate the dual function from data."}, {"heading": "Dual Function Evaluation via the Quadratic Model", "text": "We assume that the reward function R(\u03b8, c) can be approximated by a quadratic model\nR\u0302(\u03b8, c) = \u03b8\u22a4A\u03b8 + c\u22a4Bc+ 2\u03b8\u22a4Dc\n+ \u03b8\u22a4r1 + c \u22a4r2 + r0, (3)\n1All derivations are given in the supplementary material.\nAlgorithm 1: C-MORE Input: Parameters \u01eb and \u03b2, initial distribution\n\u03c0(\u03b8|c) 1 for k = 1, . . . ,K do 2 for n = 1, . . . , N do 3 Observe context cn \u223c \u00b5(c) 4 Draw parameter \u03b8n \u223c \u03c0(\u03b8|cn) 5 Execute task with \u03b8n and receive R(\u03b8n, cn)\n6 Learn the quadratic model R\u0302(\u03b8, c) 7 Solve argmin\u03b7>0,\u03c9>0 g(\u03b7, \u03c9) using Eq. (5) 8 Set new search distribution \u03c0(\u03b8|c) using Eq. (6)\nwhere A \u2208 Rd\u03b8\u00d7d\u03b8 ,B \u2208 Rdc\u00d7dc ,D \u2208 Rd\u03b8\u00d7dc , r1 \u2208 R\nd\u03b8 , r2 \u2208 Rdc , and r0 \u2208 R are the model parameters. Matrices A and B are symmetric. We also assume the sampling distribution q(\u03b8|c) to be Gaussian of the form\nq(\u03b8|c) = N (\u03b8|b+Kc,Q). (4)\nUnder these assumptions, the dual function in Eq. (2) can be expressed by\ng(\u03b7, \u03c9) = \u03b7\u01eb\u2212 \u03c9\u03b2 + 1 2\n( f\u22a4F\u22121f \u2212 \u03b7b\u22a4Q\u22121b\n+ (\u03b7 + \u03c9) log |2\u03c0F\u22121(\u03b7 + \u03c9)| \u2212 \u03b7 log |2\u03c0Q| )\n+ \u222b \u00b5(c) ( c\u22a4m+ 1\n2 c\u22a4Mc\n) dc, (5)\nwhere\nf = \u03b7Q\u22121b+ r1,\nF = \u03b7Q\u22121 \u2212 2A, m = L\u22a4F\u22121f \u2212 \u03b7K\u22a4Q\u22121b, M = L\u22a4F\u22121L\u2212 \u03b7K\u22a4Q\u22121K, L = \u03b7Q\u22121K + 2D.\nSince the context distribution \u00b5(c) is unknown, we approximate the expectation in Eq. (5) by sample averages. The dual function can be minimized by standard non-linear optimization routines such as IPOPT (Wa\u0308chter and Biegler, 2006). Finally, using Eq. (3) and Eq. (4) the new search distribution \u03c0(\u03b8|c) is computed in closed form as\n\u03c0(\u03b8|c) = N ( \u03b8|F\u22121f + F\u22121Lc,F\u22121(\u03b7 + \u03c9) ) . (6)\nTo ensure that the covarianceF\u22121(\u03b7+\u03c9) is positive definite, the model parameterA is constrained to be negative definite. C-MORE is summarized in Algorithm 1."}, {"heading": "Learning the Quadratic Model", "text": "The performance of C-MORE depends on the accuracy of the quadratic model. For many problems, the reward function R(\u03b8, c) is not quadratic and the quadratic model is not suitable to approximate the entire reward function. However, the reward function is often smooth and it can be locally approximated by a quadratic model. Therefore, we locally approximate the reward function by learning a new quadratic model for each policy update. The quadratic model can be learned by regression methods such as ridge regression2 (Bishop, 2006). However, ridge regression is prone to error when the context is high-dimensional. Below, we address this issue by firstly showing that performing linear dimensionality reduction on the context variables yields a low-rank matrix of parameters. Secondly, we propose a nuclear norm minimization approach to learn a low-rank matrix without explicitly performing dimensionality reduction."}, {"heading": "Dimensionality Reduction and Low-Rank Representation", "text": "Linear dimensionality reduction learns a low-rank matrix W and projects the data onto a lower dimensional subspace. Performing linear dimensionality reduction on the context variables yields the following quadratic model\nR\u0302(\u03b8, c) = \u03b8\u22a4A\u03b8 + c\u22a4W\u22a4B\u0303Wc+ 2\u03b8\u22a4D\u0303Wc\n+ \u03b8\u22a4r1 + c \u22a4W\u22a4r\u03032 + r0, (7)\nwhere W \u2208 Rdz\u00d7dc denotes a rank-dz matrix with dz < dc. The model parameters A, B\u0303, D\u0303, r1, r\u03032 and r0 can be learned by ridge regression. However, the matrix B = W\u22a4B\u0303W is low-rank, i.e., rank(B) = dz < dc. Thus, performing linear dimensionality reduction on the contexts makes B low-rank. Note that the rank of D = D\u0303W depends on \u03b8 and is problem dependent. Hence, we do not consider the rank of D for dimensionality reduction.\nThere are several linear dimensionality reduction methods that can be applied to learn W . Principal component analysis (PCA) (Jolliffe, 1986) is a common method used in statistics and machine learning. However, being unsupervised, it does not take the regression targets into account, i.e., the reward. Alternative supervised techniques, such as KDR (Fukumizu, Bach, and Jordan, 2009) and LSDR (Suzuki and Sugiyama, 2013), do not take the regression model, i.e., the quadratic\n2After learning the parameters, A is enforced to be negative definite by truncating its positive eigenvalues. Subsequently, we re-learn the remainder parameters. An alternative approach is projected gradient descend, but it is more computationally demanding and requires step size tuning.\nmodel, into account. On the contrary, in projection regression (Friedman and Stuetzle, 1981; Vijayakumar and Schaal, 2000) the model parameters and the projection matrix are learned simultaneously. However, applying this approach to the model in Eq. (7) requires alternately optimizing for the model parameters and the projection matrix and is computationally expensive.\nIn the original MORE, Bayesian dimensionality reduction (Go\u0308nen, 2013) is applied to perform linear supervised dimensionality reduction on \u03b8, i.e., the algorithm considers a projectionW\u03b8. The matrix W is sampled from a prior distribution and the algorithm learns the model parameters using weighted average over the sampled W . However, for high-dimensionalW , this approach requires an impractically large amount of samples W to obtain an accurate model, leading to computationally expensive updates."}, {"heading": "Learning a Low-Rank Matrix with Nuclear Norm Regularization", "text": "The quadratic model in Eq. (3) can be re-written as\nR\u0302(x) = x\u22a4Hx,\nwhere the input vectorx and the parameter matrix H are defined as\nx =\n  \u03b8\nc\n1\n  , H =  \nA D 0.5r1 D\u22a4 B 0.5r2 0.5r\u22a41 0.5r \u22a4 2 r0\n  .\nNote that H is symmetric since both A and B are symmetric. As discussed in the previous section, we desire B to be low-rank. Unlike Eq. (7), we do not consider dimensionality reduction for the linear terms in c, i.e., 2\u03b8\u22a4Dc and c\u22a4r2. Instead, we learn H by solving the following convex optimization problem\nmin H\n[J (H) + \u03bb\u2217\u2016B\u2016\u2217] ,\ns.t. A is negative definite, (8)\nwhere J (H) denotes the differentiable part\nJ (H) = 1 2N\nN\u2211\nn=1\n( x\u22a4nHxn \u2212R(\u03b8n, cn) )2 + \u03bb\n2 \u2016H\u20162F,\nwhere \u03bb > 0 and \u03bb\u2217 > 0 are regularization parameters. The Frobenius norm \u2016 \u00b7 \u2016F is defined as \u2016H\u2016F =\u221a\ntr(HH\u22a4). The nuclear norm of a matrix \u2016 \u00b7 \u2016\u2217 is defined as the \u21131-norm of its singular values . This optimization problem can be explained as follows. The term J (H) consists of the mean squared error and the \u21132-regularization term. Thus, minimizing J (H) corresponds to ridge regression. Minimizing the nuclear norm\n\u2016B\u2016\u2217 shrinks the singular values of B. Thus, the solution tends to have sparse singular values and to be lowrank. The negative definite constraint further ensures that the covariance matrix in Eq. (6) is positive definite.\nThe convexity of this optimization problem can be verified by checking the following conditions. First, the convexity of the mean squared error can be proven following Boyd and Vandenberghe, 2004, page 74. Let g(t) = J\u0302 (Z + tV ) be the mean squared error and Z and V are symmetric matrices. Then we have that \u22072g(t) = 1\nN\n\u2211 (x\u22a4nV xn)\n2 \u2265 0. Thus, the mean squared error is convex. Since the Frobenius norm is convex, J (H) is convex as well. Second, a set of negative definite matrices is convex since y\u22a4(aX + (1 \u2212 a)Y )y < 0 for any negative definite matrices X and Y , 0 \u2264 a \u2264 1, and any vector y (Boyd and Vandenberghe, 2004). Third, the nuclear norm is a convex function (Recht, Fazel, and Parrilo, 2010). Note that, since the gradient \u2207J (H) is symmetric, H is guaranteed to be symmetric as well given that the initial solution is also symmetric.\nIt is also possible to enforce the matrix H (rather than B) to be low-rank, implying that both \u03b8 and c can be projected onto a common low-dimensional subspace. However, this is often not the case, and regularizing by the nuclear norm of H did not perform well in our experiments. We may also directly constrain rank(B) = dz in Eq. (8) instead of performing nuclear norm regularization. However, minimization problems with rank constraints are NP-hard. On the contrary, the nuclear norm is the convex envelop of the rank function and can be optimized more efficiently (Recht, Fazel, and Parrilo, 2010). For this reason, the nuclear norm has been a popular surrogate to a low-rank constraint in many applications, such as matrix completion (Cande\u0300s and Tao, 2010) and multi-task learning (Pong et al., 2010).\nSince the optimization problem in Eq. (8) is convex, any convex optimization method can be used (Boyd and Vandenberghe, 2004). For our experiments, we use the accelerated proximal gradient descend (APG) (Toh and Yun, 2009). The pseudocode of our implementation of APG for solving Eq. (8) is given in the supplementary material. Note that APG requires computing the SVD of the matrix B. Since computing the exact SVD of a high-dimensional matrix can be computationally expensive, we approximate it by randomized SVD (Halko, Martinsson, and Tropp, 2011)."}, {"heading": "Experiments", "text": "We evaluate the proposed method on three problems. We start by studying C-MORE behavior in a scenario where we know the true reward model and the true lowdimensional context. Subsequently, we focus our attention on two simulated robotic ball hitting tasks. In the\nfirst task, a toy 2-DoF planar robot arm has to hit a ball placed on a plane. In the second task, a simulated 6-DoF robot arm has to hit a ball placed in a three-dimensional space. In both cases, the robots accomplish their task by using raw camera images as context variables. However, in the latter case we have limited data and therefore sample efficiency is of primary importance.\nThe evaluation is performed on three different versions of C-MORE, according to the model learning approach: using only ridge regression (C-MORE Ridge), aided by a low-dimensional context variables learned by PCA (C-MORE Ridge+PCA) and aided by nuclear norm regularization (C-MORE Nuc. Norm). We also use C-REPS (Deisenroth, Neumann, and Peters, 2013) with PCA as baseline. For the ball hitting tasks, we also tried to preprocess the context space with an autoencoder. However, the learned representation performed poorly, possibly due to the limited amount of data at our disposal, and therefore this method is not reported.\nFor each case study, first, the experiments are presented and then the results are reported and discussed. For additional details, we refer to the supplementary material."}, {"heading": "Quadratic Cost Function Optimization", "text": "In the first experiment, we want to study the performance of the algorithms in a setup where we are able to analytically compute both the reward and the true lowdimensional context. To this aim, we define the following problem\nR(\u03b8, c) = \u2212(||\u03b8 \u2212 T 1c\u0303||2)2, c\u0303 = I\u0303T\u221212 c, T 1 \u2208 Rd\u03b8\u00d7dc\u0303, T 2 \u2208 Rdc\u00d7dc , I\u0303 \u2208 Rdc\u0303\u00d7dc , dc\u0303 < dc,\nwhere I is the identity matrix, I\u0303 is a rectangular matrix with ones in its main diagonal and zeros otherwise, c\u0303 is the true low-dimensional context, and T 1 is to match the dimension of the true context and the parameter \u03b8 in order to compute the reward. This setup is particularly interesting because only a subset of the observed context influences the reward. First, the observed context c is linearly transformed by T\u221212 . Subsequently, thanks to the matrix I\u0303 , only the first dc\u0303 elements are kept to compose the true context, while the remainder is treated as noise. Finally, the reward is computed by linearly transforming the true context by T 1.\nSetup. We set dc\u0303 = 3, d\u03b8 = 10, dc = 25, while the elements of T 1,T 2 are chosen uniformly randomly in [0, 1]. The sampling Gaussian distribution is initialized with random mean and covariance Q = 10, 000I. For learning, we collect 35 new samples and keeps track of the samples collected during the last 20 iterations to stabilize the policy update. The evaluation is performed\nat each iteration over 1,000 contexts. Each context element is drawn from a uniform random distribution in [\u221210, 10]. Since we can generate a large amount of data in this setting, we pre-train PCA using 10,000 random context samples and fixed the dimensionality to dz = 20 (chosen by cross-validation). The learning is performed for a maximum of 100 iterations. If the KL divergence is lower than 0.1, then the learning is considered to be converged and the policy is not updated anymore.\nResults. As shown in Figure 1 , C-MORE Nuc. Norm clearly outperforms all the competitors, learning an almost optimal policy and being the only one to converge within the maximum number of iterations. It is also the only algorithm correctly learning the true context dimensionality, as nuclear norm successfully regularizes B to have rank three. On the contrary, PCA does not help C-MORE much and yields only slightly better results than plain ridge regression. PCA cannot in fact determine task-relevant dimensions as non-relevant dimensions have equally-high variance."}, {"heading": "Ball Hitting with a 2-DoF Robot Arm", "text": "Figure 5: 2-DoF hitting task. The context observed by the robot (blue and red lines) consists of a virtual green ball and the background image.\nIn this task, a simulated planar robot arm (shown aside) has to hit a green virtual ball placed on RGB camera images of size 32 \u00d7 24. The context is defined by the observed pixels, for a total of 2304 context variables. The ball is randomly and uniformly placed in the robot workspace. Noise drawn\nfrom a uniform random distribution in [\u221230, 30]\nis also added to the context, to simulate different light conditions. The robot controls the joint accelerations at each time step by a linear-in-parameter controller with Gaussian basis functions, for a total of 32 parameters \u03b8 to be learned. The reward R(\u03b8, c) is the negative cumulative joint accelerations plus the negative distance between the end-effector and the ball at the final time step.\nSetup. For learning, the agent collects 50 samples at each iteration and keeps samples from the last four previous iterations. The evaluation is performed at each iteration over 500 contexts. Pixel values are normalized in [\u22121, 1]. The sampling Gaussian distribution is initialized with random mean and identity covariance. For both C-MORE Nuc. Norm and C-MORE PCA, we perform 5-fold cross-validation every 100 policy updates to choose the values of \u03bb\u2217 and dz, respectively, based on the mean squared error between the collected returns and the model-predicted ones. For C-REPS PCA, we tried different values of dz \u2208 {10, 20, 30, 40} and selected dz = 10 which gave the best result.\nResults. Figure 2 shows the averaged reward against the number of iterations. Once again, C-MORE aided by nuclear norm regularization performs the best, achieving the highest average reward. At the 1000th iteration, the learned controller hits the ball with 76% accuracy. The rank of its learned matrix B is approximately 31, which shows that the algorithm successfully learns a low-rank model representation. On the contrary, preprocessing the context space through PCA still helps C-MORE (the rank of its learned B is approximately 25), but yields poor results for C-REPS, which suffers of premature\nconvergence."}, {"heading": "Ball Hitting with a 6-DoF Robot Arm", "text": "Similarly to the previous task, here a 6-DoF robotic arm has to hit a ball placed on a three-dimensional space, as shown in Figure 3. The context is once again defined by the vectorized pixels of RGB images of size 32 \u00d7 24, for a total of 2304 context variables. Note that Figure 3a shows an image before we rescale it to size 32 \u00d7 24. However, unlike the 2-DoF task, the ball is directly recorded by a real camera placed near the physical robot, and it is not virtually generated on the images. Furthermore, the robot is controlled by dynamic motor primitives (Ijspeert, Nakanishi, and Schaal, 2002) (DMPs), which are non-linear dynamical systems. We use one DMP per joint, with five basis functions per DMP. We also learn the goal attractor of the DMPs, for a total of 36 parameters \u03b8 to be learned. The reward R(\u03b8, c) is computed as the negative cumulative joint accelerations and minimum distance between the endeffector and the ball as well.\nSetup. The image dataset is collected by taking pictures with the ball placed at 50 different positions. To increase the number of data, we add a uniform random noise in [\u221230, 30] to the context to simulate different light conditions. Therefore, although some samples determine the same ball position, they are considered different due to the added noise. The search distribution is initialized by imitation learning using 50 demonstration samples. For learning, the agent collects 50 samples at each iteration and always keeps samples from the last four previous iterations.\nResults. We only evaluate C-MORE with nuclear norm and PCA since they performed well in the previous evaluation. Figure 4 shows that nuclear norm again out-\nperforms PCA. At the 500th iteration, the learned controller hits the ball with 80% accuracy. Considering that the robot is not able to hit the ball in some contexts and can achieve a maximum accuracy of 90%, this accuracy is impressive for the task. The averaged rank of matrix B learned by the nuclear norm approach is approximately 25, which shows that minimizing the nuclear norm successfully learns a low-rank matrix. For PCA, the averaged rank of B is approximately 30."}, {"heading": "Conclusion", "text": "Learning with high-dimensional context variables is a challenging and prominent problem in machine learning. In this paper, we proposed C-MORE, a novel contextual policy search method with integrated dimensionality reduction. C-MORE learns a reward model that is locally quadratic in the policy parameters and the context variables. By enforcing the model representation to be low-rank, we perform supervised linear dimensionality reduction. Unlike existing techniques relying on nonconvex formulations, the nuclear norm allows us to learn the low-rank representation by solving a convex optimization problem, thus guaranteeing convergence to a global optimum. The main disadvantage of the proposed method is that it demands more computation time due to the nuclear norm regularization. Although we did not encounter severe problems in our experiments, for very large dimensional tasks this issue can be mitigated by using more efficient techniques, such as active subspace selection (Hsieh and Olsen, 2014).\nIn this paper, we only focused on linear dimensionality reduction techniques. Recently, non-linear techniques based on deep network has been showing impressive performance (Bengio, 2009; Watter et al., 2015). In future work, we will incorporate deep network into C-MORE, e.g., by using a deep convolutional network to represent the reward model."}, {"heading": "Derivations of C-MORE", "text": "In this section, we derive C-MORE in details. C-MORE solves\nmax \u03c0\n\u222b\u222b \u00b5(c)\u03c0(\u03b8|c)R(\u03b8, c)d\u03b8dc,\ns.t. \u222b\u222b \u00b5(c)\u03c0(\u03b8|c) log \u03c0(\u03b8|c)\nq(\u03b8|c) d\u03b8dc \u2264 \u01eb,\n\u2212 \u222b\u222b\n\u00b5(c)\u03c0(\u03b8|c) log \u03c0(\u03b8|c)d\u03b8dc \u2265 \u03b2, \u222b\u222b\n\u00b5(c)\u03c0(\u03b8|c)d\u03b8dc = 1,\nby the method of Lagrange multipliers. Firstly, we write the Lagrangian L with the Lagrange multipliers \u03b7 > 0, \u03c9 > 0, and \u03b3, which correspond to the first, second, and third constraints, respectively L(\u03c0, \u03b7, \u03c9, \u03b3) = \u222b\u222b \u00b5(c)\u03c0(\u03b8|c)R(\u03b8, c)d\u03b8dc + \u03b7 ( \u01eb\u2212 \u222b\u222b \u00b5(c)\u03c0(\u03b8|c) log \u03c0(\u03b8|c)\nq(\u03b8|c) d\u03b8dc )\n+ \u03c9 ( \u2212 \u222b\u222b \u00b5(c)\u03c0(\u03b8|c) log \u03c0(\u03b8|c)d\u03b8dc\u2212 \u03b2 ) + \u03b3 (\u222b\u222b \u00b5(c)\u03c0(\u03b8|c)d\u03b8dc\u2212 1 ) .\nThen, we maximize the Lagrangian L(\u03c0, \u03b7, \u03c9, \u03b3) w.r.t. the primal variable \u03c0. The derivative of the Lagrangian w.r.t. \u03c0 is\n\u2202\u03c0L(\u03c0, \u03b7, \u03c9, \u03b3) = \u222b\u222b \u00b5(c) ( R(\u03b8, c)\u2212 (\u03b7 + \u03c9) log\u03c0(\u03b8|c) + \u03b7 log q(\u03b8|c) ) d\u03b8dc\u2212 (\u03b7 + \u03c9 \u2212 \u03b3).\nBy setting this derivative to zero, we have\n0 = \u222b\u222b \u00b5(c) ( R(\u03b8, c)\u2212 (\u03b7 + \u03c9) log \u03c0(\u03b8|c) + \u03b7 log q(\u03b8|c) ) d\u03b8dc\u2212 (\u03b7 + \u03c9 \u2212 \u03b3)\n= R(\u03b8, c)\u2212 (\u03b7 + \u03c9) log \u03c0(\u03b8|c) + \u03b7 log q(\u03b8|c)\u2212 (\u03b7 + \u03c9 \u2212 \u03b3). This gives us\nlog \u03c0(\u03b8|c) = R(\u03b8, c) \u03b7 + \u03c9 + \u03b7 \u03b7 + \u03c9 log q(\u03b8|c)\u2212 \u03b7 + \u03c9 \u2212 \u03b3 \u03b7 + \u03c9 ,\n\u03c0(\u03b8|c) = q(\u03b8|c) \u03b7 \u03b7+\u03c9 exp\n( R(\u03b8, c)\n\u03b7 + \u03c9\n) exp ( \u2212\u03b7 + \u03c9 \u2212 \u03b3\n\u03b7 + \u03c9\n) . (9)\nThe last exponential term in Eq. (9) is the normalization constant for the search distribution \u03c0(\u03b8|c) since it does not depend on \u03b8 or c. Thus, we have\nexp ( \u03b7 + \u03c9 \u2212 \u03b3 \u03b7 + \u03c9 ) = \u222b q(\u03b8|c) \u03b7\u03b7+\u03c9 exp ( R(\u03b8, c) \u03b7 + \u03c9 ) d\u03b8,\n\u03b7 + \u03c9 \u2212 \u03b3 = (\u03b7 + \u03c9) log (\u222b q(\u03b8|c) \u03b7 \u03b7+\u03c9 exp ( R(\u03b8, c)\n\u03b7 + \u03c9\n) d\u03b8 ) .\n(The minus sign in the exponent in Eq. (9) becomes the inverse operator and cancels out). This normalization term will be used to derive the dual function. Next, we substitute the term log \u03c0(\u03b8|c) back to the Lagrangian\nL(\u03c0\u2217, \u03b7, \u03c9, \u03b3) = \u222b\u222b \u00b5(c)\u03c0(\u03b8|c)R(\u03b8, c)d\u03b8dc\n\u2212 \u03b7 (\u222b\u222b \u00b5(c)\u03c0(\u03b8|c) [ R(\u03b8, c)\n\u03b7 + \u03c9 +\n\u03b7 \u03b7 + \u03c9 log q(\u03b8|c)\u2212 \u03b7 + \u03c9 \u2212 \u03b3 \u03b7 + \u03c9\n] d\u03b8dc )\n\u2212 \u03c9 (\u222b\u222b \u00b5(c)\u03c0(\u03b8|c) [ R(\u03b8, c)\n\u03b7 + \u03c9 +\n\u03b7 \u03b7 + \u03c9 log q(\u03b8|c)\u2212 \u03b7 + \u03c9 \u2212 \u03b3 \u03b7 + \u03c9\n] d\u03b8dc )\n+ \u03b7 \u222b\u222b \u00b5(c)\u03c0(\u03b8|c) log q(\u03b8|c)d\u03b8dc+ \u03b3 (\u222b\u222b \u00b5(c)\u03c0(\u03b8|c)d\u03b8dc\u2212 1 ) + \u03b7\u01eb\u2212 \u03c9\u03b2.\nMost terms cancel out and we only have\nL(\u03c0\u2217, \u03b7, \u03c9, \u03b3) = \u03b7\u01eb\u2212 \u03c9\u03b2 \u2212 \u03b3 + \u222b \u00b5(c) (\u03b7 + \u03c9) dc\n= \u03b7\u01eb\u2212 \u03c9\u03b2 + \u222b \u00b5(c) (\u03b7 + \u03c9 \u2212 \u03b3) dc = \u03b7\u01eb\u2212 \u03c9\u03b2 + (\u03b7 + \u03c9) \u222b \u00b5(c) log (\u222b q(\u03b8|c) \u03b7\u03b7+\u03c9 exp ( R(\u03b8, c)\n\u03b7 + \u03c9\n) d\u03b8 ) dc\n= g(\u03b7, \u03c9).\nThe Lagrange multipliers \u03b7 > 0 and \u03c9 > 0 are obtained by minimizing the dual function g(\u03b7, \u03c9). Then, the search distribution in Eq. (9) can be computed using these Lagrange multipliers."}, {"heading": "Evaluating the Dual Function", "text": "Here, we show how to compute the new search distribution in closed form. Recall that our quadratic model is\nR\u0302(\u03b8, c) = \u03b8\u22a4A\u03b8 + c\u22a4Bc+ 2\u03b8\u22a4Dc+ \u03b8\u22a4r1 + c \u22a4r2 + r0,\nwith symmetric A and B. Also recall that the sampling distribution q(\u03b8|c) is Gaussian\nq(\u03b8|c) = N (\u03b8|b+Kc,Q)\n= 1\n|2\u03c0Q| 12 exp ( \u22121 2 [\u03b8 \u2212 (b+Kc)]\u22a4Q\u22121[\u03b8 \u2212 (b+Kc)] ) .\nThe quadratic model and the Gaussian distribution allow us to compute the dual function from data as follows. Firstly, we consider the term\nq(\u03b8|c) \u03b7 \u03b7+\u03c9 exp\n( R(\u03b8, c)\n\u03b7 + \u03c9\n) .\nUsing the Gaussian distribution q(\u03b8|c) and replacing R(\u03b8, c) with R\u0302(\u03b8, c) yield q(\u03b8|c) \u03b7\u03b7+\u03c9 exp ( R\u0302(\u03b8, c)\n\u03b7 + \u03c9\n)\n= 1\n|2\u03c0Q| \u03b7 2(\u03b7+\u03c9)\nexp ( \u2212 \u03b7 2(\u03b7 + \u03c9) [\u03b8 \u2212 (b+Kc)]\u22a4Q\u22121[\u03b8 \u2212 (b+Kc)] )\n\u00d7 exp ( \u03b8\u22a4A\u03b8 + c\u22a4Bc+ 2\u03b8\u22a4Dc+ \u03b8\u22a4r1 + c\n\u22a4r2 + r0 \u03b7 + \u03c9\n)\n= 1\n|2\u03c0Q| \u03b7 2(\u03b7+\u03c9)\nexp ( \u2212 1\n\u03b7 + \u03c9\n( \u2212 \u03b7\n2 [\u03b8 \u2212 (b+Kc)]\u22a4Q\u22121[\u03b8 \u2212 (b+Kc)]\n+ \u03b8\u22a4A\u03b8 + c\u22a4Bc + 2\u03b8\u22a4Dc + \u03b8\u22a4r1 + c \u22a4r2 + r0\n))\n= 1\n|2\u03c0Q| \u03b7 2(\u03b7+\u03c9)\nexp\n( 1\n2(\u03b7 + \u03c9)\n( \u2212 \u03b7\u03b8\u22a4Q\u22121\u03b8 + 2\u03b7\u03b8\u22a4Q\u22121b+ 2\u03b7\u03b8\u22a4Q\u22121Kc\u2212 \u03b7b\u22a4Q\u22121b\n\u2212 2\u03b7b\u22a4Q\u22121Kc\u2212 \u03b7c\u22a4K\u22a4Q\u22121Kc+ 2\u03b8\u22a4A\u03b8 + 2c\u22a4Bc+ 4\u03b8\u22a4Dc+ 2\u03b8\u22a4r1 + 2c\u22a4r2 + 2r0 ))\n= 1\n|2\u03c0Q| \u03b7 2(\u03b7+\u03c9)\nexp\n( 1\n2(\u03b7 + \u03c9)\n( \u03b8\u22a4 ( \u2212\u03b7Q\u22121 + 2A ) \u03b8 + \u03b8\u22a4 ( 2\u03b7Q\u22121b+ 2r1 )\n+ \u03b8\u22a4 ( 2\u03b7Q\u22121K + 4D ) c +G\n))\n= 1\n|2\u03c0Q| \u03b7 2(\u03b7+\u03c9)\nexp\n( 1\n2(\u03b7 + \u03c9)\n( \u2212 (\u03b8\u22a4F\u03b8 \u2212 2\u03b8\u22a4f \u2212 2\u03b8\u22a4Lc) )) exp ( G\n2(\u03b7 + \u03c9)\n) ,\nwhere\nF = \u03b7Q\u22121 \u2212 2A, f = \u03b7Q\u22121b+ r1,\nL = \u03b7Q\u22121K + 2D,\nG = \u2212\u03b7b\u22a4Q\u22121b\u2212 2\u03b7b\u22a4Q\u22121Kc\u2212 \u03b7c\u22a4K\u22a4Q\u22121Kc+ 2c\u22a4Bc + 2c\u22a4r2 + 2r0. Next, we \u201ccomplete the square\u201d by considering the following quadratic term\n[\u03b8 \u2212 (F\u22121f + F\u22121Lc)]\u22a4F [\u03b8 \u2212 (F\u22121f + F\u22121Lc)] = \u03b8\u22a4F\u03b8 \u2212 2\u03b8\u22a4f \u2212 2\u03b8\u22a4Lc+ (F\u22121f + F\u22121Lc)\u22a4F (F\u22121f + F\u22121Lc) = ( \u03b8\u22a4F\u03b8 \u2212 2\u03b8\u22a4f \u2212 2\u03b8\u22a4Lc ) + f\u22a4F\u22121f + 2f\u22a4F\u22121Lc+ c\u22a4L\u22a4F\u22121Lc.\nTherefore, we have\nq(\u03b8|c) \u03b7\u03b7+\u03c9 exp ( R(\u03b8, c)\n\u03b7 + \u03c9\n)\n= 1\n|2\u03c0Q| \u03b7 2(\u03b7+\u03c9)\nexp\n( 1\n2(\u03b7 + \u03c9)\n( \u2212 ([\u03b8 \u2212 (F\u22121f + F\u22121Lc)]\u22a4F [\u03b8 \u2212 (F\u22121f + F\u22121Lc)]\n+ f\u22a4F\u22121f + 2f\u22a4F\u22121Lc+ c\u22a4L\u22a4F\u22121Lc) )) exp ( G\n2(\u03b7 + \u03c9)\n) . (10)\nUsing the above result, the inner integral term in the dual function is\n\u222b q(\u03b8|c) \u03b7 \u03b7+\u03c9 exp ( R\u0302(\u03b8, c)\n\u03b7 + \u03c9\n) d\u03b8\n= |2\u03c0F\u22121(\u03b7 + \u03c9)| 12\n|2\u03c0Q| \u03b7 2(\u03b7+\u03c9)\nexp\n( 1\n2(\u03b7 + \u03c9)\n( f\u22a4F\u22121f + 2f\u22a4F\u22121Lc + c\u22a4L\u22a4F\u22121Lc )) exp ( G\n2(\u03b7 + \u03c9)\n) ,\nwhere the squared exponential term in Eq. (10) depending on \u03b8 is \u201cintegrated out\u201d and becomes the inverted normalization term |2\u03c0F\u22121(\u03b7 + \u03c9)| 12 . Plugging this term back to the dual function yields\ng(\u03b7, \u03c9) = \u03b7\u01eb\u2212 \u03c9\u03b2 + 1 2\n( f\u22a4F\u22121f \u2212 \u03b7b\u22a4Q\u22121b+ (\u03b7 + \u03c9) log |2\u03c0F\u22121(\u03b7 + \u03c9)| \u2212 \u03b7 log |2\u03c0Q| )\n+ \u222b \u00b5(c) ( f\u22a4F\u22121L\u2212 \u03b7b\u22a4Q\u22121K ) cdc + 1\n2\n\u222b \u00b5(c)c\u22a4 ( L\u22a4F\u22121L\u2212 \u03b7K\u22a4Q\u22121K ) cdc\n= \u03b7\u01eb\u2212 \u03c9\u03b2 + 1 2\n( f\u22a4F\u22121f \u2212 \u03b7b\u22a4Q\u22121b+ (\u03b7 + \u03c9) log |2\u03c0F\u22121(\u03b7 + \u03c9)| \u2212 \u03b7 log |2\u03c0Q| )\n+ \u222b \u00b5(c) ( c\u22a4m+ 1\n2 c\u22a4Mc\n) dc,\nwhere\nm = L\u22a4F\u22121f \u2212 \u03b7K\u22a4Q\u22121b, M = L\u22a4F\u22121L\u2212 \u03b7K\u22a4Q\u22121K.\nThe expectation over \u00b5(c) can be approximated by the context samples. The term 2c\u22a4Bc + 2c\u22a4r2 + 2r0 in G does not appear in the dual function since this is constant w.r.t. \u03b7 and \u03c9. Similarly to the dual function, by using Eq. (9) and Eq. (10) we compute the new search distribution in closed form as\n\u03c0(\u03b8|c) \u221d q(\u03b8|c) \u03b7\u03b7+\u03c9 exp ( R\u0302(\u03b8, c)\n\u03b7 + \u03c9\n)\n\u221d exp (\n1\n2(\u03b7 + \u03c9)\n( \u2212 ([\u03b8 \u2212 (F\u22121f + F\u22121Lc)]\u22a4F [\u03b8 \u2212 (F\u22121f + F\u22121Lc)]\n))\n= N ( \u03b8|F\u22121f + F\u22121Lc,F\u22121(\u03b7 + \u03c9) ) .\nProof of Convexity of J\u0302 (H)\nTo show that J\u0302 (H) = 1 2N \u2211N n=1 ( x\u22a4nHxn \u2212R(\u03b8n, cn) )2 is a convex function, we follow the proof in Boyd and Vandenberghe 2004, page 74. Let g(t) = J\u0302 (Z+tV ) with symmetric matrices Z and V and scalar t. Then, we can verify the convexity of J\u0302 through g. Through simple calculation,\nwe have that\ng(t) = 1\n2N\nN\u2211\nn=1\n( x\u22a4n (Z + tV )xn \u2212 R(\u03b8n, cn) )2\n= 1\n2N\nN\u2211\nn=1\n( (x\u22a4nZxn) 2 + 2t(x\u22a4nZxn)(x \u22a4 nV xn)\u2212 2(x\u22a4nZxn)R(xn)\n+ t2(x\u22a4nV xn) 2 \u2212 2t(x\u22a4nV xn)R(xn) +R(xn)2\n) .\nThe first and second derivatives of g(t) are\n\u2207g(t) = 1 N\nN\u2211\nn=1\n( (x\u22a4Zx)(x\u22a4V x) + t(x\u22a4nV xn) 2 \u2212 (x\u22a4nV xn)R(xn) ) ,\n\u22072g(t) = 1 N\nN\u2211\nn=1\n(x\u22a4nV xn) 2 \u2265 0.\nSince the second derivative is non-negative, the function J\u0302 (H) is convex."}, {"heading": "Experiments Details", "text": "Here, we provide all additional details regarding the experiments that are not mentioned in the paper."}, {"heading": "Quadratic Cost Function Optimization", "text": "The sampling Gaussian distribution mean is initialized uniformly randomly in [0, 5], while the initial covariance is Q = 10, 000I. For nuclear norm, the regularization parameters are set to \u03bb\u2217 = 0.00002 and \u03bb = 0.00001. For PCA, the dimensionality candidates are dz \u2208 {3, 6, 10, 20}. Figure 6 shows the performance with different dimensionality. The regularization parameter for the \u21132-regularization is set at \u03bb = 0.00001. The step size for accelerated proximal gradient (APG) is fixed at 0.001. We also normalize the gradient such that the Frobenius norm is 1. The maximum iteration of APG is set at K = 300. C-REPS and C-MORE KL divergence is set to 0.9."}, {"heading": "Ball Hitting with a 2-DoF Robot Arm", "text": "We use a linear-in-parameter controller with Gaussian basis functions to control the joint accelerations q\u0308 of the robot\nq\u0308 = [ \u03b8\u22a41 \u03d5(q), \u03b8 \u22a4 2 \u03d5(q) ]\u22a4 ,\nwhere \u03b8 = [ \u03b8\u22a41 , \u03b8 \u22a4 2 ]\u22a4 is the policy parameters vector, q \u2208 R2 is the joint angles vector, and \u03d5 is the Gaussian basis functions vector with 16 Gaussian centers placed at {0, \u03c0 2 , \u03c0, 3\u03c0 2 }\u00d7{0, \u03c0 2 , \u03c0, 3\u03c0 2 } for both joints. The number of total parameter \u03b8 is 32. The reward R(\u03b8, c) is computed as the negative cumulative joint accelerations plus the negative distance between the end-effector and the ball at\nthe final time step\nR(\u03b8, c) = \u22120.05 40\u2211\nt=1\n|q\u0308t|+ 10 exp ( \u2212(ballx \u2212 effx)\n2 \u2212 (bally \u2212 effy)2 50\n) ,\nwhere q\u0308t denotes the joint accelerations at time step t, ballx and effx denotes the x coordinate of the ball and end-effector at the final time step, respectively. Variables bally and effy are also also defined similarly. We use the following transition dynamics to govern the joint angles\nq\u0307 \u2190 q\u0307 +\u2206q\u0308, q \u2190 q +\u2206q\u0307,\nwhere \u2206 = 0.1. Each arm has length 7.5. The robot is initialized such that the end-effector is at the bottom position.\nThe sampling Gaussian distribution N (\u03b8|b + Kc,Q) is initialized by bij \u223c N (0, 1), Kij \u223c N (0, 0.012), for each entry (i, j) and Q = I. For nuclear norm, the regularization parameter candidates are \u03bb\u2217 \u2208 {1\u00d7 10\u22127, 5\u00d7 10\u22127, 1\u00d7 10\u22126, 2\u00d7 10\u22126}. For PCA, the dimensionlaity candidates are d z \u2208 {10, 20, 30, 40}. The regularization parameter for the \u21132-regularization is set at \u03bb = 0.0001. The step size for accelerated proximal gradient (APG) is fixed at 0.001. We also normalize the gradient such that the Frobenius norm is 1. The maximum iteration of APG is initialize at K = 500 and it is reduced by 2 after each update to reduce the computation time until a minimum of K = 300. K is reset to 500 when cross-validation is performed.\nFigure 7 shows the performance of C-REPS with PCA on different dimensionality d z and different KL upper-bound \u01eb. The best result of C-REPS is the one reported in the main paper for the comparison with C-MORE. Figure 8 shows the rank of B against update iteration averaged over ten trials. C-MORE with nuclear norm is quite unstable early on. However, the rank stabilizes after some iterations and the rank converges to 31."}, {"heading": "Ball Hitting with a 6-DoF Robot Arm", "text": "In this task, the reward function is defined as\nR(\u03b8, c) = { \u22120.05\u2211 |qt|+ 10 \u2217 exp(\u2212distance2), if distance > 0.1 cm. \u22120.05\u2211qt + 10 \u2217 exp(\u2212distance2) + 20, otherwise,\nwhere distance denotes the minimum distance between the ball and the end-effector along the trajectory. APG and PCA setup is the same as in the 2-DoF robot experiment. Figure 9 and Figure 10 show the average reward and hit accuracy averaged over 50 contexts on three individual trial, respectively. On all trials, the nuclear norm performs better than PCA and consistently achieves 80% hit accuracy.\nAlgorithm 2: APG for solving the nuclear norm minimization problem Input: Parameters \u03bb and \u03bb\u2217, gradient step size \u03c4 , maximum number of iteration K , initial solution H0\n1 Initialize H\u22121 = H0 and t\u22121 = t0 = 1 2 for k = 1, . . . ,K do 3 Set intermediate point\nY k = Hk + tk\n\u22121 \u2212 1\ntk (Hk \u2212Hk\u22121)\n4 Do gradient descent using the differentiable term\nY + = Y k + \u03c4\u2207J (Y k),\nwhere\nY + =\n \nA+ D+ 0.5r1+ D\u22a4+ B+ 0.5r2+\n0.5r\u22a41+ 0.5r \u22a4 2+ r0+\n \n5 Shrink singular values of B+\nB\u2217 = U max(\u03a3\u2212 \u03bb\u2217I,0)V \u22a4,\nwhere B+ = U\u03a3V \u22a4 is the SVD of B+\n6 Truncate positive eigenvalues of A+\nA\u2217 = P min(\u039b,0)P \u22a4,\nwhere A+ = P\u039bP \u22a4 is the eigendecomposition of A+\n7 Update solution\nHk+1 =\n \nA\u2217 D+ 0.5r1+ D\u22a4+ B\u2217 0.5r2+\n0.5r\u22a41+ 0.5r \u22a4 2+ r0+\n \n8 Update parameter tk+1 = 1+\n\u221a 1+4(tk)2\n2\n9 if stopping criterion is met then 10 return"}], "references": [{"title": "Model-based relative entropy stochastic search", "author": ["A. Abdolmaleki", "R. Lioutikov", "J. Peters", "N. Lau", "L.P. Reis", "G. Neumann"], "venue": "Advances in Neural Information Processing Systems 28, 3537\u20133545.", "citeRegEx": "Abdolmaleki et al\\.,? 2015", "shortCiteRegEx": "Abdolmaleki et al\\.", "year": 2015}, {"title": "Reinforcement learning in POMDP\u2019s via direct gradient ascent", "author": ["J. Baxter", "P.L. Bartlett"], "venue": "The 17th International Conference on Machine Learning, 41\u201348.", "citeRegEx": "Baxter and Bartlett,? 2000", "shortCiteRegEx": "Baxter and Bartlett", "year": 2000}, {"title": "Learning deep architectures for AI", "author": ["Y. Bengio"], "venue": "Foundations and Trends in Machine Learning 2(1):1\u2013 127.", "citeRegEx": "Bengio,? 2009", "shortCiteRegEx": "Bengio", "year": 2009}, {"title": "Pattern Recognition and Machine Learning (Information Science and Statistics)", "author": ["C.M. Bishop"], "venue": "Secaucus, NJ, USA: Springer-Verlag New York, Inc.", "citeRegEx": "Bishop,? 2006", "shortCiteRegEx": "Bishop", "year": 2006}, {"title": "Convex Optimization", "author": ["S. Boyd", "L. Vandenberghe"], "venue": "New York, NY, USA: Cambridge University Press.", "citeRegEx": "Boyd and Vandenberghe,? 2004", "shortCiteRegEx": "Boyd and Vandenberghe", "year": 2004}, {"title": "The power of convex relaxation: near-optimal matrix completion", "author": ["E.J. Cand\u00e8s", "T. Tao"], "venue": "IEEE Transactions on Information Theory 56(5):2053\u20132080.", "citeRegEx": "Cand\u00e8s and Tao,? 2010", "shortCiteRegEx": "Cand\u00e8s and Tao", "year": 2010}, {"title": "Learning parameterized skills", "author": ["B.C. da Silva", "G. Konidaris", "A.G. Barto"], "venue": "In The 29th International Conference on Machine Learning", "citeRegEx": "Silva et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Silva et al\\.", "year": 2012}, {"title": "A survey on policy search for robotics", "author": ["M.P. Deisenroth", "G. Neumann", "J. Peters"], "venue": "Foundations and Trends in Robotics 2(1-2):1\u2013142.", "citeRegEx": "Deisenroth et al\\.,? 2013", "shortCiteRegEx": "Deisenroth et al\\.", "year": 2013}, {"title": "Projection pursuit regression", "author": ["J.H. Friedman", "W. Stuetzle"], "venue": "Journal of the American Statistical Association 76(376):817\u2013823.", "citeRegEx": "Friedman and Stuetzle,? 1981", "shortCiteRegEx": "Friedman and Stuetzle", "year": 1981}, {"title": "Kernel dimension reduction in regression", "author": ["K. Fukumizu", "F.R. Bach", "M.I. Jordan"], "venue": "The Annals of Statistics 37(4):1871\u20131905.", "citeRegEx": "Fukumizu et al\\.,? 2009", "shortCiteRegEx": "Fukumizu et al\\.", "year": 2009}, {"title": "Bayesian supervised dimensionality reduction", "author": ["M. G\u00f6nen"], "venue": "IEEE Transanscation on Cybernetics 43(6):2179\u20132189.", "citeRegEx": "G\u00f6nen,? 2013", "shortCiteRegEx": "G\u00f6nen", "year": 2013}, {"title": "Finding structure with randomness: Probabilistic algorithms for constructing approximate matrix decompositions", "author": ["N. Halko", "P. Martinsson", "J.A. Tropp"], "venue": "SIAM Review 53(2):217\u2013288.", "citeRegEx": "Halko et al\\.,? 2011", "shortCiteRegEx": "Halko et al\\.", "year": 2011}, {"title": "Reducing the time complexity of the derandomized evolution strategy with covariance matrix adaptation (CMA-ES)", "author": ["N. Hansen", "S.D. M\u00fcller", "P. Koumoutsakos"], "venue": "Evolutionary Computation 11(1):1\u201318.", "citeRegEx": "Hansen et al\\.,? 2003", "shortCiteRegEx": "Hansen et al\\.", "year": 2003}, {"title": "Nuclear norm minimization via active subspace selection", "author": ["C. Hsieh", "P.A. Olsen"], "venue": "The 31st International Conference on Machine Learning, 575\u2013 583.", "citeRegEx": "Hsieh and Olsen,? 2014", "shortCiteRegEx": "Hsieh and Olsen", "year": 2014}, {"title": "Learning attractor landscapes for learning motor primitives", "author": ["A.J. Ijspeert", "J. Nakanishi", "S. Schaal"], "venue": "Advances in Neural Information Processing Systems 15, 1523\u20131530.", "citeRegEx": "Ijspeert et al\\.,? 2002", "shortCiteRegEx": "Ijspeert et al\\.", "year": 2002}, {"title": "Principal Component Analysis", "author": ["I.T. Jolliffe"], "venue": "Springer Verlag.", "citeRegEx": "Jolliffe,? 1986", "shortCiteRegEx": "Jolliffe", "year": 1986}, {"title": "Reinforcement learning to adjust robot movements to new situations", "author": ["J. Kober", "E. Oztop", "J. Peters"], "venue": "The 22nd International Joint Conference on Artificial Intelligence, 2650\u20132655.", "citeRegEx": "Kober et al\\.,? 2011", "shortCiteRegEx": "Kober et al\\.", "year": 2011}, {"title": "On information and sufficiency", "author": ["S. Kullback", "R.A. Leibler"], "venue": "The Annals of Mathematical Statistics 22(1):79\u201386.", "citeRegEx": "Kullback and Leibler,? 1951", "shortCiteRegEx": "Kullback and Leibler", "year": 1951}, {"title": "Variational inference for policy search in changing situations", "author": ["G. Neumann"], "venue": "The 28th International Conference on Machine Learning, 817\u2013824.", "citeRegEx": "Neumann,? 2011", "shortCiteRegEx": "Neumann", "year": 2011}, {"title": "Trace norm regularization: Reformulations, algorithms, and multi-task learning", "author": ["T.K. Pong", "P. Tseng", "S. Ji", "J. Ye"], "venue": "SIAM Journal on Optimization 20(6):3465\u20133489.", "citeRegEx": "Pong et al\\.,? 2010", "shortCiteRegEx": "Pong et al\\.", "year": 2010}, {"title": "Guaranteed minimum-rank solutions of linear matrix equations via nuclear norm minimization", "author": ["B. Recht", "M. Fazel", "P.A. Parrilo"], "venue": "SIAM Review 52(3):471\u2013501.", "citeRegEx": "Recht et al\\.,? 2010", "shortCiteRegEx": "Recht et al\\.", "year": 2010}, {"title": "Robot weightlifting by direct policy search", "author": ["M.T. Rosenstein", "A.G. Barto"], "venue": "The 17th International Joint Conference on Artificial Intelligence, 839\u2013846.", "citeRegEx": "Rosenstein and Barto,? 2001", "shortCiteRegEx": "Rosenstein and Barto", "year": 2001}, {"title": "Mastering the game of go with deep neural networks and tree search", "author": ["K.", "T. Graepel", "D. Hassabis"], "venue": "Nature 529:484\u2013503.", "citeRegEx": "K. et al\\.,? 2016", "shortCiteRegEx": "K. et al\\.", "year": 2016}, {"title": "Sufficient dimension reduction via squared-loss mutual information estimation", "author": ["T. Suzuki", "M. Sugiyama"], "venue": "Neural Computation 25:725\u2013758.", "citeRegEx": "Suzuki and Sugiyama,? 2013", "shortCiteRegEx": "Suzuki and Sugiyama", "year": 2013}, {"title": "An accelerated proximal gradient algorithm for nuclear norm regularized least squares problems", "author": ["K. Toh", "S. Yun"], "venue": "International Symposium on Mathematical Programming.", "citeRegEx": "Toh and Yun,? 2009", "shortCiteRegEx": "Toh and Yun", "year": 2009}, {"title": "Locally weighted projection regression: Incremental real time learning in high dimensional space", "author": ["S. Vijayakumar", "S. Schaal"], "venue": "The 17th International Conference on Machine Learning, 1079\u20131086.", "citeRegEx": "Vijayakumar and Schaal,? 2000", "shortCiteRegEx": "Vijayakumar and Schaal", "year": 2000}, {"title": "On the implementation of an interior-point filter line-search algorithm for large-scale nonlinear programming", "author": ["A. W\u00e4chter", "L.T. Biegler"], "venue": "Mathametical Programming 106(1):25\u201357.", "citeRegEx": "W\u00e4chter and Biegler,? 2006", "shortCiteRegEx": "W\u00e4chter and Biegler", "year": 2006}, {"title": "Embed to control: A locally linear latent dynamics model for control from raw images", "author": ["M. Watter", "J.T. Springenberg", "J. Boedecker", "M.A. Riedmiller"], "venue": "Advances in Neural Information Processing Systems 28, 2746\u20132754.", "citeRegEx": "Watter et al\\.,? 2015", "shortCiteRegEx": "Watter et al\\.", "year": 2015}], "referenceMentions": [{"referenceID": 1, "context": "Direct policy search approaches (Baxter and Bartlett, 2000; Rosenstein and Barto, 2001; Deisenroth, Neumann, and Peters, 2013) allow the agent to learn a separate policy for each context through trial and error.", "startOffset": 32, "endOffset": 126}, {"referenceID": 21, "context": "Direct policy search approaches (Baxter and Bartlett, 2000; Rosenstein and Barto, 2001; Deisenroth, Neumann, and Peters, 2013) allow the agent to learn a separate policy for each context through trial and error.", "startOffset": 32, "endOffset": 126}, {"referenceID": 18, "context": "On the other hand, direct contextual policy search approaches (Kober, Oztop, and Peters, 2011; Neumann, 2011; da Silva, Konidaris, and Barto, 2012) represent the contexts by real-valued vectors and are able to learn a context-dependent distribution over the policy parameters.", "startOffset": 62, "endOffset": 147}, {"referenceID": 3, "context": "Learning from high-dimensional variables, in fact, is still an important problem in statistics and machine learning (Bishop, 2006).", "startOffset": 116, "endOffset": 130}, {"referenceID": 0, "context": "To alleviate these issues, Abdolmaleki et al. (2015) recently proposed a stochastic search framework called model-based relative entropy stochastic search (MORE).", "startOffset": 27, "endOffset": 53}, {"referenceID": 15, "context": "A prominent example is principal component analysis (PCA) (Jolliffe, 1986), that does not take the supervisory signal into account and therefore cannot discriminate between relevant and irrelevant latent dimensions.", "startOffset": 58, "endOffset": 74}, {"referenceID": 23, "context": "Moreover, they often involve non-convex optimization and suffer from local optima (Fukumizu, Bach, and Jordan, 2009; Suzuki and Sugiyama, 2013).", "startOffset": 82, "endOffset": 143}, {"referenceID": 2, "context": "In the last years, non-linear dimensionality reduction techniques based on deep learning have gained popularity (Bengio, 2009).", "startOffset": 112, "endOffset": 126}, {"referenceID": 2, "context": "In the last years, non-linear dimensionality reduction techniques based on deep learning have gained popularity (Bengio, 2009). For instance, Watter et al. (2015) proposed a generative deep network to learn lowdimensional representations of images in order to capture information about the system transition dynamics and allow optimal control problems to be solved in lowdimensional spaces.", "startOffset": 113, "endOffset": 163}, {"referenceID": 2, "context": "In the last years, non-linear dimensionality reduction techniques based on deep learning have gained popularity (Bengio, 2009). For instance, Watter et al. (2015) proposed a generative deep network to learn lowdimensional representations of images in order to capture information about the system transition dynamics and allow optimal control problems to be solved in lowdimensional spaces. More recently, Silver et al. (2016) successfully trained a machine to play a high-level game of go using a deep convolutional network.", "startOffset": 113, "endOffset": 427}, {"referenceID": 0, "context": "The original MORE (Abdolmaleki et al., 2015) finds a search distribution (without context) that maximizes the expected reward while upper-bounding the KullbackLeibler (KL) divergence (Kullback and Leibler, 1951) and lower-bounding the entropy.", "startOffset": 18, "endOffset": 44}, {"referenceID": 17, "context": ", 2015) finds a search distribution (without context) that maximizes the expected reward while upper-bounding the KullbackLeibler (KL) divergence (Kullback and Leibler, 1951) and lower-bounding the entropy.", "startOffset": 146, "endOffset": 174}, {"referenceID": 0, "context": "The latter is adaptively changed according to the percentage of the relative difference between the sampling policy\u2019s expected entropy and the minimal entropy, as described by Abdolmaleki et al. (2015), i.", "startOffset": 176, "endOffset": 202}, {"referenceID": 26, "context": "The dual function can be minimized by standard non-linear optimization routines such as IPOPT (W\u00e4chter and Biegler, 2006).", "startOffset": 94, "endOffset": 121}, {"referenceID": 3, "context": "The quadratic model can be learned by regression methods such as ridge regression2 (Bishop, 2006).", "startOffset": 83, "endOffset": 97}, {"referenceID": 15, "context": "Principal component analysis (PCA) (Jolliffe, 1986) is a common method used in statistics and machine learning.", "startOffset": 35, "endOffset": 51}, {"referenceID": 23, "context": "Alternative supervised techniques, such as KDR (Fukumizu, Bach, and Jordan, 2009) and LSDR (Suzuki and Sugiyama, 2013), do not take the regression model, i.", "startOffset": 91, "endOffset": 118}, {"referenceID": 8, "context": "On the contrary, in projection regression (Friedman and Stuetzle, 1981; Vijayakumar and Schaal, 2000) the model parameters and the projection matrix are learned simultaneously.", "startOffset": 42, "endOffset": 101}, {"referenceID": 25, "context": "On the contrary, in projection regression (Friedman and Stuetzle, 1981; Vijayakumar and Schaal, 2000) the model parameters and the projection matrix are learned simultaneously.", "startOffset": 42, "endOffset": 101}, {"referenceID": 10, "context": "In the original MORE, Bayesian dimensionality reduction (G\u00f6nen, 2013) is applied to perform linear supervised dimensionality reduction on \u03b8, i.", "startOffset": 56, "endOffset": 69}, {"referenceID": 4, "context": "Second, a set of negative definite matrices is convex since y(aX + (1 \u2212 a)Y )y < 0 for any negative definite matrices X and Y , 0 \u2264 a \u2264 1, and any vector y (Boyd and Vandenberghe, 2004).", "startOffset": 156, "endOffset": 185}, {"referenceID": 5, "context": "For this reason, the nuclear norm has been a popular surrogate to a low-rank constraint in many applications, such as matrix completion (Cand\u00e8s and Tao, 2010) and multi-task learning (Pong et al.", "startOffset": 136, "endOffset": 158}, {"referenceID": 19, "context": "For this reason, the nuclear norm has been a popular surrogate to a low-rank constraint in many applications, such as matrix completion (Cand\u00e8s and Tao, 2010) and multi-task learning (Pong et al., 2010).", "startOffset": 183, "endOffset": 202}, {"referenceID": 4, "context": "(8) is convex, any convex optimization method can be used (Boyd and Vandenberghe, 2004).", "startOffset": 58, "endOffset": 87}, {"referenceID": 24, "context": "For our experiments, we use the accelerated proximal gradient descend (APG) (Toh and Yun, 2009).", "startOffset": 76, "endOffset": 95}, {"referenceID": 13, "context": "Although we did not encounter severe problems in our experiments, for very large dimensional tasks this issue can be mitigated by using more efficient techniques, such as active subspace selection (Hsieh and Olsen, 2014).", "startOffset": 197, "endOffset": 220}, {"referenceID": 2, "context": "Recently, non-linear techniques based on deep network has been showing impressive performance (Bengio, 2009; Watter et al., 2015).", "startOffset": 94, "endOffset": 129}, {"referenceID": 27, "context": "Recently, non-linear techniques based on deep network has been showing impressive performance (Bengio, 2009; Watter et al., 2015).", "startOffset": 94, "endOffset": 129}], "year": 2016, "abstractText": "Direct contextual policy search methods learn to improve policy parameters and simultaneously generalize these parameters to different context or task variables. However, learning from high-dimensional context variables, such as camera images, is still a prominent problem in many real-world tasks. A naive application of unsupervised dimensionality reduction methods to the context variables, such as principal component analysis, is insufficient as task-relevant input may be ignored. In this paper, we propose a contextual policy search method in the model-based relative entropy stochastic search framework with integrated dimensionality reduction. We learn a model of the reward that is locally quadratic in both the policy parameters and the context variables. Furthermore, we perform supervised linear dimensionality reduction on the context variables by nuclear norm regularization. The experimental results show that the proposed method outperforms naive dimensionality reduction via principal component analysis and a state-ofthe-art contextual policy search method.", "creator": "LaTeX with hyperref package"}}}