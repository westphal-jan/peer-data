{"id": "1206.4626", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "18-Jun-2012", "title": "On-Line Portfolio Selection with Moving Average Reversion", "abstract": "on - line forward portfolio behavior selection has attracted increasing interests encountered in machine learning and ai computing communities recently. empirical evidences show that stock's high and low prices are temporary and stock price relatives are likely to follow the above mean reversion phenomenon. while the existing mean event reversion strategies that are shown to achieve good / empirical performance on many real accounting datasets, they often make the single - period mean reversion assumption, which is not always satisfied in some real datasets, leading to poor performance when the assumption formula does not hold. to overcome the limitation, this article proposes suggesting a multiple - period mean reversion, or relatively so - commonly called moving average reversion ( mar ), concept and a new on - line portfolio selection strategy named \" accelerating on - line moving average reversion \" ( olmar ), which exploits structural mar by constantly applying different powerful online learning techniques. from our empirical results, we repeatedly found that olmar can overcome the drawback of existing mean reversion algorithms and simultaneously achieve significantly better results, especially on the datasets below where the existing mean reversion index algorithms failed. in addition to superior trading performance, olmar also runs extremely fast, therefore further supporting its practical applicability finding to a wide range of applications.", "histories": [["v1", "Mon, 18 Jun 2012 15:07:23 GMT  (182kb)", "http://arxiv.org/abs/1206.4626v1", "ICML2012"]], "COMMENTS": "ICML2012", "reviews": [], "SUBJECTS": "cs.CE cs.LG q-fin.PM", "authors": ["bin li", "steven c h hoi"], "accepted": true, "id": "1206.4626"}, "pdf": {"name": "1206.4626.pdf", "metadata": {"source": "CRF", "title": "On-Line Portfolio Selection with Moving Average Reversion", "authors": ["Bin Li", "Steven C. H. Hoi"], "emails": ["S080061@ntu.edu.sg", "chhoi@ntu.edu.sg"], "sections": [{"heading": "1. Introduction", "text": "Portfolio selection, which has been explored in both finance and quantitative fields, aims to obtain certain targets in the long run by sequentially allocating the wealth among a set of assets. Mean-variance theory (Markowitz, 1952), which trades off between the expected return (mean) and risk (variance) of a port-\nAppearing in Proceedings of the 29 th International Conference on Machine Learning, Edinburgh, Scotland, UK, 2012. Copyright 2012 by the author(s)/owner(s).\nfolio, is suitable for single period portfolio selection. Contrarily, Kelly investment (Kelly, 1956; Breiman, 1961; Finkelstein & Whitley, 1981), which maximizes the expected log return of a portfolio, aims for multiple periods portfolio selection. Due to the sequential nature, recent on-line portfolio selection techniques often design algorithms following the second approach.\nOne important property exploited by many existing studies (Borodin et al., 2004; Li et al., 2011b; 2012) is the mean reversion property, which assumes poor performing stocks will perform well in the subsequent periods and vice versa, may better fit the financial markets. Though some recent mean reversion algorithms (Li et al., 2011b; 2012) achieve the best results on many datasets, they perform extremely poor on certain datasets, such as DJA dataset (Borodin et al., 2004). Comparing with Borodin et al. (2004), which exploits multi-period correlation, we found that the assumption of single-period prediction may attribute to the performance degradation. On the other hand, as illustrated in existing studies (Li et al., 2011b; 2012), Borodin et al. (2004), which heuristically exploits mean reversion via correlation, cannot fully exploit the potential of (multi-period) mean reversion.\nTo address the above drawbacks, we present a new approach for on-line portfolio selection, named \u201cOn-Line Moving Average Reversion\u201d (OLMAR). The basic idea is to represent multi-period mean reversion as \u201cMoving Average Reversion\u201d (MAR), which explicitly predicts next price relatives using moving averages, and then learn portfolios by online learning techniques. To the best of our knowledge, OLMAR is the first algorithm that exploits moving average in the setting of on-line portfolio selection. Though simple in nature, OLMAR has a reasonable update and is empirically validated via extensive experiments on real markets. The experiments show that OLMAR can achieve better performance (in terms of cumulative wealth) than existing algorithms, and more importantly, can avoid the performance degradation in certain datasets, such as DJA dataset (Borodin et al., 2004; Li et al., 2012). Finally,\nOLMAR runs much faster than the state of the art, and thus is suitable for large-scale applications.\nThe rest of the paper is organized as follows. Section 2 formulates the on-line portfolio selection problem, and Section 3 reviews and analyzes related work. Section 4 presents the proposed OLMAR approach, and its effectiveness is validated by extensive empirical studies on real stock markets in Section 5. Section 6 summarizes the paper and provides directions for future work."}, {"heading": "2. Problem Setting", "text": "Consider an investment task over a financial market with m assets for n periods. On the tth period, the assets\u2019 prices are represented by a close price vector pt \u2208 Rm+ , and each element pt,i represents the close price of asset i. Their price changes are represented by a price relative vector xt \u2208 Rm+ , and xt,i =\npt,i pt\u22121,i . Thus, an investment in asset i on the\ntth period increases by a factor of xt,i. Let us denote xn = {x1, . . . ,xn} as the sequence of price relative vectors for n periods.\nAn investment on the tth period is specified by a portfolio vector bt = (bt,1, . . . , bt,m), where bt,i represents the proportion of wealth invested in asset i. Typically, we assume the portfolio is self-financed and no margin/short is allowed, therefore each entry of a portfolio is non-negative and adds up to one, that is, bt \u2208 \u2206m, where \u2206m = { bt : bt \u2208 Rm+ , \u2211m i=1 bt,i = 1 } . The investment procedure is represented by a portfolio strategy, that is, b1 = 1 m1 and following sequence of mappings bt : Rm(t\u22121)+ \u2192 \u2206m, t = 2, 3, . . ., where bt = bt ( xt\u22121 ) is the tth portfolio given past market sequence xt\u22121 = {x1, . . . ,xt\u22121}. We denote by bn = {b1, . . . ,bn} the strategy for n periods.\nOn the tth period, a portfolio bt produces a portfolio period return st, that is, the wealth increases by a factor of st = b \u22a4 t xt = \u2211m i=1 bt,ixt,i. Since we reinvest and adopt price relative, the portfolio wealth would multiplicatively grow. Thus, after n periods, a portfolio strategy bn produces a portfolio cumulative wealth of Sn, which increases the initial wealth by a factor of \u220fn t=1 b \u22a4 t xt, that is, Sn (b n,xn) = S0 \u220fn t=1 b \u22a4 t xt, where S0 is set to $1 for convenience.\nFinally, let us formulate the on-line portfolio selection problem. In this task, a portfolio manager is a decision maker, whose goal is to produce a portfolio strategy bn, aiming to maximize the cumulative wealth Sn. He/she computes the portfolios sequentially. On each period t, the manager has access to the sequence of previous price relative vectors xt\u22121. Then, he/she computes a new portfolio bt for next price relative\nvector xt, where the decision criterion varies among different managers. The portfolio bt is scored based on portfolio period return st. This procedure is repeated until the end, and the portfolio strategy is finally scored according to portfolio cumulative wealth Sn.\nNote that the above model in general assumes zero transaction cost/tax, perfect market liquidity, and zero impact cost. These assumptions are not trivial, and their effects and implications will be further analyzed and discussed in Section 5.3 and Section 5.5."}, {"heading": "3. Related Work", "text": "The research of on-line portfolio selection grounds on the principle of Kelly investment (Kelly, 1956; Breiman, 1961; Thorp, 1971; Finkelstein & Whitley, 1981), that is, to maximize the expected log return of a portfolio. One classical strategy is Constant Rebalanced Portfolios (CRP), which follows Kelly\u2019s idea of keeping a fixed fraction for each asset on all periods. The best possible CRP strategy in hindsight is often known as Best Constant Rebalanced Portfolios (BCRP), which is the optimal strategy if the market is i.i.d. (Cover & Thomas, 1991, Theorem 15.3.1). Cover (1991) initialized the research of on-line portfolio selection (Ordentlich & Cover, 1996) and proposed Universal Portfolios (UP) strategy, whose portfolio is historical performance weighted average of all CRPs.\nHelmbold et al. (1998) proposed Exponential Gradient (EG) strategy, which maximizes the expected log portfolio return estimated by last price relatives, and minimizes the deviation from last portfolio. Gaivoronski & Stella (2000) proposed Successive Constant Rebalanced Portfolios (SCRP), which maximizes the expected log cumulative wealth estimated using all historical price relative relatives1. Agarwal et al. (2006) proposed Online Newton Step (ONS), which extends the idea of SCRP by appending a regularization term to minimize the variation of next portfolio.\nBorodin et al. (2004) proposed Anti-correlation (Anticor), which bets on the consistency of positive lagged cross-correlation and negative auto-correlation. Li et al. (2012) proposed Passive Aggressive Mean Reversion (PAMR), which iteratively chooses portfolio minimizing the expected return based on last price relatives. Li et al. (2011b) proposed Confidence Weighted Mean Reversion (CWMR) strategy, which exploits the mean reversion property and the variance information of portfolio.\nGyo\u0308rfi et al. (2006) introduced the framework of nonparametric investment strategies, which searches over\n1This idea also appeared in Ordentlich (1996, Chap. 4).\n\u2211n\nhistorical market sequence and identify a sample set of vectors, whose previous market windows are similar to recent window, and obtains a BCRP portfolio based on the set. With this framework, Nonparametric Kernelbased moving window (BK) (Gyo\u0308rfi et al., 2006) measures the similarity using Euclidean distance. Further, Nonparametric Nearest Neighbor (BNN) (Gyo\u0308rfi et al., 2008) searches for \u2113 nearest neighbors to the recent market window. Recently, Li et al. (2011a) proposed Correlation-driven Nonparametric learning (CORN) to search for similar vectors via correlation."}, {"heading": "3.1. Analysis of Existing Work", "text": "Most existing formulations follow the basic routine of Kelly-based portfolio selection (Thorp, 1971). In particular, a portfolio manager first predicts x\u0303t+1 in terms of k possible values x\u03031t+1, . . . , x\u0303 k t+1 and their corresponding probabilities p1, . . . , pk. Note that each x\u0303 i t+1 denotes one possible combination vector of individual price relative prediction. Then he/she can figure out portfolio by maximizing the expected log return,\nbt+1 = argmax b\u2208\u2206m k\u2211 i=1 pi log ( b \u00b7 x\u0303it+1 ) .\nBased on methods of predicting x\u0303it+1 and pi, most existing algorithms can be classified into three categories. Their optimization formulations and underlying predictions are summarized in Table 1, and their details can be found on their respective studies. Note that we have transformed certain formulations, however, maintained their key ideas.\nNow let us focus on the first category, which consists of EG, PAMR and CWMR. Algorithms in this category assume a single prediction value with a probability of 100%, and maintains previous portfolio information via regularization techniques. In particular, EG assumes x\u03031t+1 = xt with p1 = 100%, while PAMR and CWMR assume x\u03031t+1 = 1 xt\nwith p1 = 100%, which is in essence mean reversion idea. Note that the formulations of PAMR and CWMR ignore the log utility due to the single-value prediction and the consideration of con-\nvexity and computation issue. Though all three algorithms assume that all information is fully reflected by xt, their performance diverges and supports that mean reversion fits the markets. On the one hand, even with a decent theoretical result, EG always performs far behind. On the other hand, though without theoretical guarantees, PAMR and CWMR always produce the best results in various real markets. However, PAMR and CWMR suffer from dramatic failures when such single-period mean reversion is not satisfied (Li et al., 2012), which motivates our approach."}, {"heading": "4. On-Line Moving Average Reversion", "text": ""}, {"heading": "4.1. Motivation", "text": "Empirical results (Li et al., 2011b; 2012) show that mean reversion, which assumes the poor stock may perform good in the subsequent periods, may better fit the markets. PAMR and CWMR can exploit the mean reversion property well and achieve good results on most datasets at the time, especially the NYSE benchmark dataset (Cover, 1991). However, they rely on a simple assumption that the predicted next price relative x\u0303t+1 will be inverse proportion to last price relative xt. In particular, they implicitly assume that next price p\u0303t+1 will revert to last price pt\u22121, as follows,\nx\u0303t+1 = 1 xt =\u21d2 p\u0303t+1 pt = pt\u22121 pt =\u21d2 p\u0303t+1 = pt\u22121.\nNote that x and p are all vectors and the above operations are element-wise.\nThough empirically effective on most datasets, PAMR and CWMR\u2019s single-period assumption causes two potential problems. Firstly, both algorithms suffer from the frequently fluctuating raw prices, as they often contain a lot of noises. Second, their assumption of single-period mean reversion may not be satisfied in the real world. Even two consecutive declining price relatives, which are common, can fail both algorithms. One real example (Li et al., 2012) is DJA dataset (Borodin et al., 2004), on which PAMR performs the worst among the state of the art. Thus,\ntraders are more likely to predict prices using the longterm mean. Also on the DJA dataset, Anticor, which exploits the multi-period statistical correlation, performs much better. However, as illustrated in Li et al. (2011b; 2012), due to its heuristical nature, Anticor can not fully exploit mean reversion. The two problems caused by single-period assumption and Anticor\u2019s inability to fully exploit mean reversion call for a more powerful approach to effectively exploit mean reversion, especially in terms of multi-period.\nNow let us see the classic example (Cover & Gluss, 1986; Li et al., 2012) to illustrate the drawbacks of single-period mean reversion, as shown in Table 2. The toy market consists of cash and one volatile stock, whose market sequence follows A. It is easy to prove that BCRP (b = ( 1 2 , 1 2 ) ) can grow by a fac-\ntor of ( 9 8 )n/2 , while PAMR/CWMR can grow by a better factor of 32 \u00d7 2 (n\u22121)/2. Note that this virtual sequence is essentially singe-period mean reversion, which perfectly fits with PAMR and CWMR\u2019s assumption. However, if market sequence does not satisfy this assumption, both PAMR and CWMR would fail badly. Let us extend the market sequence to a two-period reversion, that is, market sequence B. In such a market, BCRP can achieve the same growth as before. Contrarily, PAMR/CWMR can achieve a constant wealth 3 2 , which has no growth! More generally, if we further extend to k-period mean reversion, BCRP can still achieve the same growth, while PAMR/CWMR\nwill grow to 32\u00d7 ( 1 2 )(n\u22121)\u00d7( 12\u2212 1k ), which definitely approaches bankruptcy when k \u2265 3.\nTo better exploit the (multi-period) mean reversion property, we proposed a new type of algorithms, named On-Line Moving Average Reversion (OLMAR), for on-line portfolio selection. The essential idea is to exploit multi-period moving average (mean) reversion via power online machine learning. Rather than p\u0303t+1 = pt\u22121, OLMAR assumes that next price will revert to Moving Average (MA) at the end of tth period, that is, p\u0303t+1 = MAt (w) = 1 w \u2211i=t i=t\u2212w+1 pi, where MAt (w) denotes the Moving Average (MA) with a w-window. In time series analysis, MA is typi-\ncally used to smooth short-term price fluctuations and focus on long-term trends, thus can solve the two drawbacks of existing mean reversion algorithms. To this end, we propose a price relative vector following the idea of \u201cMoving Average Reversion\u201d (MAR),\nx\u0303t+1 (w) = MAt (w)\npt =\n1 w ( pt pt + pt\u22121 pt + \u00b7 \u00b7 \u00b7+ pt\u2212w+1 pt ) = 1\nw\n( 1 + 1\nxt + \u00b7 \u00b7 \u00b7+ 1\u2297w\u22122\ni=0 xt\u2212i\n) ,\n(1) where w is the window size and \u2297 denotes elementwise production. Without detailing the calculation, we list the growth of OLMAR in different toy markets in Table 2. Clearly, OLMAR performs much better in the scenarios of multi-period mean reversion, while performs poor in single-period reversion. Our further empirical analysis shows that the markets are more likely to follow multi-period reversion.\nBased on the expected price relative vector in Eq. (1), OLMAR further adopts the idea of an effective online learning algorithm, that is, Passive Aggressive (PA) (Crammer et al., 2006) learning, to exploit moving average reversion. Generally proposed for classification, PA passively keeps the previous solution if the classification is correct, while aggressively approaches a new solution if the classification is incorrect. After formulating the proposed OLMAR optimization, we solve its closed form update and design the proposed algorithm."}, {"heading": "4.2. Formulation", "text": "The proposed formulation, OLMAR, is to exploit moving average reversion via PA online learning. The basic idea is to maximize the expected return b \u00b7 x\u0303t+1, and keep the last portfolio information via regularization term. Thus, we follow the similar idea of PAMR (Li et al., 2012) and formulate an optimization, Optimization Problem: OLMAR\nbt+1 = argmin b\u2208\u2206m\n1 2 \u2225b\u2212 bt\u22252 s.t. b \u00b7 x\u0303t+1 \u2265 \u03f5.\nNote that we adopt expected return rather than expected log return. According to Helmbold et al.\nAlgorithm 1 Portfolio Selection with OLMAR.\n1: Input: \u03f5 > 1: Reversion threshold; w \u2265 3: Window size; xn1 : Market sequence; 2: Output: Sn: Cumulative wealth after n th periods 3: Procedure: 4: Initialization: b1 = 1 m1, S0 = 1; 5: for t = 1, 2, . . . , n do 6: Receive stock price relatives: xt 7: Calculate daily return and cumulative return: St = St\u22121 \u00d7 (bt \u00b7 xt) 8: Predict next price relative vector:\nx\u0303t+1 (w) = 1\nw\n( 1 + 1\nxt + \u00b7 \u00b7 \u00b7+ 1\u2297w\u22122\ni=0 xt\u2212i\n)\n9: Update the portfolio: bt+1 = OLMAR(\u03f5, w, x\u0303t+1,bt)\n10: end for\n(1998), to solve the optimization with expected log return, one can adopt the first-order Taylor expansion, which is essentially linear.\nThe above formulation explicitly reflects the basic idea of the proposed OLMAR. On the one hand, if the constraint is satisfied, that is, the expected return is higher than a threshold, then the resulting portfolio equals to the previous portfolio. On the other hand, if the constraint is not satisfied, then the formulation will figure out a new portfolio such that the expected return is higher than the threshold, while the new portfolio is not far from the last one.\nSince OLMAR follows the same learning principle as PAMR, their formulations are similar. However, the two solutions are essentially different. In particular, PAMR\u2019s core constraint, i.e., b \u00b7 xt \u2264 \u03f5, adopts the raw price relative and has a different inequality sign."}, {"heading": "4.3. Algorithm", "text": "The above formulation is thus convex and straightforward to solve via convex optimization (Boyd & Vandenberghe, 2004). We now derive the OLMAR solution as illustrated in Proposition 1.\nProposition 1. The solution of OLMAR without considering the non-negativity constraint is\nbt+1 = bt + \u03bbt+1 (x\u0303t+1 \u2212 x\u0304t+11) ,\nwhere x\u0304t+1 = 1 m (1 \u00b7 x\u0303t+1) denotes the average predicted price relative and \u03bbt+1 is the Lagrangian multiplier calculated as,\n\u03bbt+1 = max\n{ 0,\n\u03f5\u2212 bt \u00b7 x\u0303t+1 \u2225x\u0303t+1 \u2212 x\u0304t+11\u22252\n} .\nAlgorithm 2 OLMAR(\u03f5, w, x\u0303t+1,bt).\n1: Input: \u03f5 > 1: Reversion threshold; w \u2265 3: Window size; x\u0303t+1: Predicted price relatives; bt: Current portfolio; 2: Output: bt+1: Next portfolio; 3: Procedure: 4: Calculate the following variables:\nx\u0304t+1 = 1\u22a4x\u0303t+1\nm ,\u03bbt+1 = max\n{ 0,\n\u03f5\u2212 bt \u00b7 x\u0303t+1 \u2225x\u0303t+1 \u2212 x\u0304t+11\u22252\n}\n5: Update the portfolio:\nbt+1 = bt + \u03bbt+1(x\u0303t+1 \u2212 x\u0304t+11)\n6: Normalize bt+1:\nbt+1 = argmin b\u2208\u2206m\n\u2225b\u2212 bt+1\u22252\nIt is worth noting that in the derivation we do not consider the non-negativity constraint following Helmbold et al. (1998). Thus, it is possible that the resulting portfolio goes out the portfolio simplex domain. To maintain a proper portfolio, we finally project the portfolio calculated according to Proposition 1 to the simplex domain.\nTo this end, we can design the proposed algorithm based on the proposition. The on-line portfolio selection following the problem setting in Section 2 is illustrated in Algorithm 1, and the proposed OLMAR procedure is illustrated in Algorithm 2.\nEmpirical observations of the parameter sensitivity in Section 5.2 show that the final performance is sensitive to the parameter w. To smooth the final performance of the system, we propose to adopt the Buy and Hold (BAH) version (Borodin et al., 2004; Gyo\u0308rfi et al., 2006; Li et al., 2012), that is, for each period, we treat the individual OLMAR with a specified w \u2265 3 as an expert and combine multiple experts\u2019 portfolios weighted by their historical performance. We denote the the algorithm as BAHW (OLMAR) with a parameter W denoting the maximum window size, that is, BAHW (OLMAR) combines W\u22122 individual OLMAR experts with w = 3, . . . ,W ."}, {"heading": "4.4. Analysis", "text": "The update of OLMAR is straightforward, that is, bt+1 = bt+\u03bbt+1(x\u0303t+1 \u2212 x\u0304t+11). Basically, the update divides the assets into two groups by prediction average. For the assets in the group with higher predictions than average, OLMAR increases their proportions; for the others, OLMAR decreases their proportions. The transferred proportions are related to the surprise of\nthe predictions over their average and the positive Lagrangian multiplier, \u03bb. This is consistent with normal portfolio selection procedure, that is, to transfer the wealth to the assets with better prospect to grow.\nClearly, the OLMAR update costs linear time per period w.r.t. m, and the normalization step can also be implemented in linear time (Duchi et al., 2008). To the best of our knowledge, OLMAR\u2019s linear time is no worse than any existing algorithm."}, {"heading": "5. Experiments", "text": "We now evaluate the effectiveness of the proposed OLMAR algorithm by performing an extensive set of experiments on publicly available and diverse datasets from real stock markets.\nTable 3 details the four experimental datasets2. Among these, NYSE (O) is one benchmarks dataset evaluated by all existing methods, while NYSE (N) is a dataset collected by Li et al. (2011b) as a continuation of NYSE (O). The remaining two datasets (DJA and TSE) are collected by Borodin et al. (2004).\nIn this paper, we adopt the most common metric, cumulative wealth, to measure the investment performance. Results with other metrics, including riskadjusted return, will be included in the long version of this paper. We compare the proposed approach with all existing methods in Section 3, whose parameters are set according to their respective studies.\nIn our experiments, we implement the proposed OLMAR, and its BAH version BAH(OLMAR). In all cases, we empirically set the parameters, that is, \u03f5 = 10 and w = 5, which provide a consistent results for OLMAR in all cases. For BAH(OLMAR), we set their maximum window size W = 30, resulting in 28 OLMAR experts with w = 3 to 30. In addition to the empirical selection of parameters, we also evaluate the parameter scalability of the two possible parameters in Section 5.2. Finally, we also refer the best performance (in hindsight) among the underlying experts of the BAH version, named MAX(OLMAR)."}, {"heading": "5.1. Cumulative Wealth", "text": "Figure 1(a) illustrates the main results of this study, that is, the cumulative wealth achieved by various approaches. The results clearly show that OLMAR\n2All datasets, including the composites, are available on http://www.cais.ntu.edu.sg/~libin/portfolios/.\nachieves the top performance among all competitors. On the well-known benchmark NYSE (O) dataset, OLMAR significantly outperforms the state of the art; the similar observation is also found on the successive NYSE (N) dataset. Besides, though most existing algorithms except Anticor perform bad on the DJA dataset, OLMAR achieves the best performance. Moreover, the maximum performance show that it is possible to achieve better performance via effective expert combination. Finally, the t-test statistics (Grinold & Kahn, 1999) shown in Table 1(b) validate that the results achieved are not due to luck."}, {"heading": "5.2. Parameter Sensitivity", "text": "Now let us evaluate algorithm\u2019s sensitivity to its parameters, that is, \u03f5 and w. Figure 2 shows the sensitivity of \u03f5 with fixed w = 5 and Figure 3 show the sensitivity of w with fixed \u03f5 = 10. From the former, we can observe that in general the total wealth sharply increases when \u03f5 approaches 1 and flattens when \u03f5 crosses a threshold. From the latter, we can observe that as w increases, the performance initially increases, spikes with a data-dependant value, and then decreases. Anyway, its performance with most choices of \u03f5 and w have a much better performance than BCRP strategy and the market. Moreover, the latter figure also show that the Buy and Hold versions greatly smooth the performance with varying w of the underlying experts. All above observations also show that it is robust to the choices of parameters and is convenient to choose satisfying parameters."}, {"heading": "5.3. Transaction Cost Scalability", "text": "To evaluate the practical applicability, we evaluate the scalability of the proposed algorithms with respect to proportional transaction cost (Borodin et al., 2004). Figure 4 illustrates the cumulative wealth achieved by OLMAR with increasing transaction cost rate \u03b3, and also the results obtained by four representative algorithms (two benchmarks and two state of the arts in different categories). On the one hand, the results clearly show that OLMAR can withstand reasonable transaction cost rates, as it often has high break-even rates with respect to the market. On the other hand, OLMAR can outperform the benchmarks and state of the arts, under various transaction cost rates. In a word, OLMAR performs excellent when trading is not frictionless, supporting its practical applicability."}, {"heading": "5.4. Computational Time", "text": "Finally, we evaluate the computational time as shown in Table 1(c). Note that we only list the computational times of methods with comparable performance. Theoretically, as we analyzed in Section 4.4, OLMAR enjoys linear computational time complexity. Empiri-\ncally, as shown in the table, OLMAR algorithm takes the least times on all datasets. Note that with daily frequency, competitors\u2019 average times are acceptable, however, their times are not acceptable in the scenario of high frequency trading. Such time efficiency supports OLMAR\u2019s large-scale real applications."}, {"heading": "5.5. Discussion and Thread of Validity", "text": "Without theoretical guarantee, the empirical assumptions in Section 2 are worth inspecting, as done by all existing heuristic algorithms (Borodin et al., 2004; Li et al., 2011a;b; 2012). As evaluated in Section 5.3, OLMAR can withstand reasonable rates of transaction cost. All the datasets are composed of the largest index composite stocks, which have the best market liquidity. To limit market impact when portfolio is too big, one solution is to scale-down the portfolio, as done by several quantitative funds. Here, we emphasize again that even in such a \u201cperfect market\u201d, no algorithm has ever claimed such good performance.\nThere may also exist certain issues in the back tests. One possible issue is \u201csurvivorship bias\u201d. Since following existing works, the composition stocks never delisted from markets and survived for a long time, especially the two NYSE datasets. Another possible issue is \u201cdataset selection\u201d. In fact, OLMAR also performs quite well on the other two public datasets (Li et al., 2012), that is, SP500 and MSCI, whose results will be included in the long version of this paper."}, {"heading": "6. Conclusion", "text": "This paper proposes a novel online portfolio selection strategy named \u201cOn-Line Moving Average Reversion\u201d (OLMAR), which exploits \u201cMoving Average Reversion\u201d via on-line learning algorithms. The approach can solve the problems of the state of the art caused by the single-period mean reversion and achieve satisfying results in real markets. It also runs extremely fast and is suitable for large-scale real applications. In future, we will further explore the theoretical aspect of the mean reversion property."}, {"heading": "Acknowledgments", "text": "This work was fully supported by Singapore MOE tier 1 project (RG33/11)."}], "references": [{"title": "Algorithms for portfolio management based on the newton method", "author": ["A. Agarwal", "E. Hazan", "S. Kale", "R.E. Schapire"], "venue": "In ICML\u201906,", "citeRegEx": "Agarwal et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Agarwal et al\\.", "year": 2006}, {"title": "Can we learn to beat the best stock", "author": ["A. Borodin", "R. El-Yaniv", "V. Gogan"], "venue": "JAIR, 21:579\u2013594,", "citeRegEx": "Borodin et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Borodin et al\\.", "year": 2004}, {"title": "Convex optimization", "author": ["S. Boyd", "L. Vandenberghe"], "venue": null, "citeRegEx": "Boyd and Vandenberghe,? \\Q2004\\E", "shortCiteRegEx": "Boyd and Vandenberghe", "year": 2004}, {"title": "Optimal gambling systems for favorable games", "author": ["L. Breiman"], "venue": "Proceedings of the Berkeley Symposium on Mathematical Statistics and Probability,", "citeRegEx": "Breiman,? \\Q1961\\E", "shortCiteRegEx": "Breiman", "year": 1961}, {"title": "Empirical bayes stock market portfolios", "author": ["T.M. Cover", "D.H. Gluss"], "venue": "Adv. Appl. Math.,", "citeRegEx": "Cover and Gluss,? \\Q1986\\E", "shortCiteRegEx": "Cover and Gluss", "year": 1986}, {"title": "Efficient projections onto the l1-ball for learning in high dimensions", "author": ["J. Duchi", "S. Shalev-Shwartz", "Y. Singer", "T. Chandra"], "venue": "In ICML\u201908,", "citeRegEx": "Duchi et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Duchi et al\\.", "year": 2008}, {"title": "Optimal strategies for repeated games", "author": ["M. Finkelstein", "R. Whitley"], "venue": "Adv. Appl. Probab.,", "citeRegEx": "Finkelstein and Whitley,? \\Q1981\\E", "shortCiteRegEx": "Finkelstein and Whitley", "year": 1981}, {"title": "Stochastic nonstationary optimization for finding universal portfolios", "author": ["A.A. Gaivoronski", "F. Stella"], "venue": "Ann. Oper. Res.,", "citeRegEx": "Gaivoronski and Stella,? \\Q2000\\E", "shortCiteRegEx": "Gaivoronski and Stella", "year": 2000}, {"title": "Active Portfolio Management: A Quantitative Approach for Producing Superior Returns and Controlling Risk", "author": ["R. Grinold", "R. Kahn"], "venue": null, "citeRegEx": "Grinold and Kahn,? \\Q1999\\E", "shortCiteRegEx": "Grinold and Kahn", "year": 1999}, {"title": "Nonparametric kernel-based sequential investment strategies", "author": ["L. Gy\u00f6rfi", "G. Lugosi", "F. Udina"], "venue": "Math. Financ.,", "citeRegEx": "Gy\u00f6rfi et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Gy\u00f6rfi et al\\.", "year": 2006}, {"title": "Nonparametric nearest neighbor based empirical portfolio selection strategies", "author": ["L. Gy\u00f6rfi", "F. Udina", "H. Walk"], "venue": "Stat. Decis.,", "citeRegEx": "Gy\u00f6rfi et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Gy\u00f6rfi et al\\.", "year": 2008}, {"title": "On-line portfolio selection using multiplicative updates", "author": ["D.P. Helmbold", "R.E. Schapire", "Y. Singer", "M.K. andWarmuth"], "venue": "Math. Financ.,", "citeRegEx": "Helmbold et al\\.,? \\Q1998\\E", "shortCiteRegEx": "Helmbold et al\\.", "year": 1998}, {"title": "A new interpretation of information rate", "author": ["J. Kelly", "Jr."], "venue": "AT&T Tech. J.,", "citeRegEx": "Kelly and Jr.,? \\Q1956\\E", "shortCiteRegEx": "Kelly and Jr.", "year": 1956}, {"title": "correlation-driven nonparametric learning approach for portfolio selection", "author": ["B. Li", "S.C.H. Hoi", "Gopalkrishnan", "V. Corn"], "venue": "ACM TIST,", "citeRegEx": "Li et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Li et al\\.", "year": 2011}, {"title": "Confidence weighted mean reversion strategy for on-line portfolio selection", "author": ["B. Li", "S.C.H. Hoi", "P. Zhao", "V. Gopalkrishnan"], "venue": "In AISTATS\u201911,", "citeRegEx": "Li et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Li et al\\.", "year": 2011}, {"title": "Pamr: Passive aggressive mean reversion strategy for portfolio selection", "author": ["B. Li", "P. Zhao", "S.C.H. Hoi", "V. Gopalkrishnan"], "venue": "Mach. Learn.,", "citeRegEx": "Li et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Li et al\\.", "year": 2012}, {"title": "Universal investment and universal data compression", "author": ["E. Ordentlich"], "venue": "PhD thesis, Stanford University,", "citeRegEx": "Ordentlich,? \\Q1996\\E", "shortCiteRegEx": "Ordentlich", "year": 1996}, {"title": "On-line portfolio selection", "author": ["E. Ordentlich", "T.M. Cover"], "venue": "In COLT\u201996,", "citeRegEx": "Ordentlich and Cover,? \\Q1996\\E", "shortCiteRegEx": "Ordentlich and Cover", "year": 1996}, {"title": "Portfolio choice and the kelly criterion", "author": ["E.O. Thorp"], "venue": "In Business and Economics Section of the American Statistical Association,", "citeRegEx": "Thorp,? \\Q1971\\E", "shortCiteRegEx": "Thorp", "year": 1971}], "referenceMentions": [{"referenceID": 3, "context": "Contrarily, Kelly investment (Kelly, 1956; Breiman, 1961; Finkelstein & Whitley, 1981), which maximizes the expected log return of a portfolio, aims for multiple periods portfolio selection.", "startOffset": 29, "endOffset": 86}, {"referenceID": 1, "context": "One important property exploited by many existing studies (Borodin et al., 2004; Li et al., 2011b; 2012) is the mean reversion property, which assumes poor performing stocks will perform well in the subsequent periods and vice versa, may better fit the financial markets.", "startOffset": 58, "endOffset": 104}, {"referenceID": 1, "context": ", 2011b; 2012) achieve the best results on many datasets, they perform extremely poor on certain datasets, such as DJA dataset (Borodin et al., 2004).", "startOffset": 127, "endOffset": 149}, {"referenceID": 1, "context": "One important property exploited by many existing studies (Borodin et al., 2004; Li et al., 2011b; 2012) is the mean reversion property, which assumes poor performing stocks will perform well in the subsequent periods and vice versa, may better fit the financial markets. Though some recent mean reversion algorithms (Li et al., 2011b; 2012) achieve the best results on many datasets, they perform extremely poor on certain datasets, such as DJA dataset (Borodin et al., 2004). Comparing with Borodin et al. (2004), which exploits multi-period correlation, we found that the assumption of single-period prediction may attribute to the performance degradation.", "startOffset": 59, "endOffset": 515}, {"referenceID": 1, "context": "One important property exploited by many existing studies (Borodin et al., 2004; Li et al., 2011b; 2012) is the mean reversion property, which assumes poor performing stocks will perform well in the subsequent periods and vice versa, may better fit the financial markets. Though some recent mean reversion algorithms (Li et al., 2011b; 2012) achieve the best results on many datasets, they perform extremely poor on certain datasets, such as DJA dataset (Borodin et al., 2004). Comparing with Borodin et al. (2004), which exploits multi-period correlation, we found that the assumption of single-period prediction may attribute to the performance degradation. On the other hand, as illustrated in existing studies (Li et al., 2011b; 2012), Borodin et al. (2004), which heuristically exploits mean reversion via correlation, cannot fully exploit the potential of (multi-period) mean reversion.", "startOffset": 59, "endOffset": 762}, {"referenceID": 1, "context": "The experiments show that OLMAR can achieve better performance (in terms of cumulative wealth) than existing algorithms, and more importantly, can avoid the performance degradation in certain datasets, such as DJA dataset (Borodin et al., 2004; Li et al., 2012).", "startOffset": 222, "endOffset": 261}, {"referenceID": 15, "context": "The experiments show that OLMAR can achieve better performance (in terms of cumulative wealth) than existing algorithms, and more importantly, can avoid the performance degradation in certain datasets, such as DJA dataset (Borodin et al., 2004; Li et al., 2012).", "startOffset": 222, "endOffset": 261}, {"referenceID": 3, "context": "The research of on-line portfolio selection grounds on the principle of Kelly investment (Kelly, 1956; Breiman, 1961; Thorp, 1971; Finkelstein & Whitley, 1981), that is, to maximize the expected log return of a portfolio.", "startOffset": 89, "endOffset": 159}, {"referenceID": 18, "context": "The research of on-line portfolio selection grounds on the principle of Kelly investment (Kelly, 1956; Breiman, 1961; Thorp, 1971; Finkelstein & Whitley, 1981), that is, to maximize the expected log return of a portfolio.", "startOffset": 89, "endOffset": 159}, {"referenceID": 3, "context": "The research of on-line portfolio selection grounds on the principle of Kelly investment (Kelly, 1956; Breiman, 1961; Thorp, 1971; Finkelstein & Whitley, 1981), that is, to maximize the expected log return of a portfolio. One classical strategy is Constant Rebalanced Portfolios (CRP), which follows Kelly\u2019s idea of keeping a fixed fraction for each asset on all periods. The best possible CRP strategy in hindsight is often known as Best Constant Rebalanced Portfolios (BCRP), which is the optimal strategy if the market is i.i.d. (Cover & Thomas, 1991, Theorem 15.3.1). Cover (1991) initialized the research of on-line portfolio selection (Ordentlich & Cover, 1996) and proposed Universal Portfolios (UP) strategy, whose portfolio is historical performance weighted average of all CRPs.", "startOffset": 103, "endOffset": 585}, {"referenceID": 0, "context": "Agarwal et al. (2006) proposed Online Newton Step (ONS), which extends the idea of SCRP by appending a regularization term to minimize the variation of next portfolio.", "startOffset": 0, "endOffset": 22}, {"referenceID": 9, "context": "With this framework, Nonparametric Kernelbased moving window (B) (Gy\u00f6rfi et al., 2006) measures the similarity using Euclidean distance.", "startOffset": 65, "endOffset": 86}, {"referenceID": 10, "context": "Further, Nonparametric Nearest Neighbor (B) (Gy\u00f6rfi et al., 2008) searches for l nearest neighbors to the recent market window.", "startOffset": 44, "endOffset": 65}, {"referenceID": 9, "context": "With this framework, Nonparametric Kernelbased moving window (B) (Gy\u00f6rfi et al., 2006) measures the similarity using Euclidean distance. Further, Nonparametric Nearest Neighbor (B) (Gy\u00f6rfi et al., 2008) searches for l nearest neighbors to the recent market window. Recently, Li et al. (2011a) proposed Correlation-driven Nonparametric learning (CORN) to search for similar vectors via correlation.", "startOffset": 66, "endOffset": 293}, {"referenceID": 18, "context": "Most existing formulations follow the basic routine of Kelly-based portfolio selection (Thorp, 1971).", "startOffset": 87, "endOffset": 100}, {"referenceID": 15, "context": "However, PAMR and CWMR suffer from dramatic failures when such single-period mean reversion is not satisfied (Li et al., 2012), which motivates our approach.", "startOffset": 109, "endOffset": 126}, {"referenceID": 15, "context": "One real example (Li et al., 2012) is DJA dataset (Borodin et al.", "startOffset": 17, "endOffset": 34}, {"referenceID": 1, "context": ", 2012) is DJA dataset (Borodin et al., 2004), on which PAMR performs the worst among the state of the art.", "startOffset": 23, "endOffset": 45}, {"referenceID": 15, "context": "Now let us see the classic example (Cover & Gluss, 1986; Li et al., 2012) to illustrate the drawbacks of single-period mean reversion, as shown in Table 2.", "startOffset": 35, "endOffset": 73}, {"referenceID": 15, "context": "Thus, we follow the similar idea of PAMR (Li et al., 2012) and formulate an optimization, Optimization Problem: OLMAR", "startOffset": 41, "endOffset": 58}, {"referenceID": 11, "context": "It is worth noting that in the derivation we do not consider the non-negativity constraint following Helmbold et al. (1998). Thus, it is possible that the resulting portfolio goes out the portfolio simplex domain.", "startOffset": 101, "endOffset": 124}, {"referenceID": 1, "context": "To smooth the final performance of the system, we propose to adopt the Buy and Hold (BAH) version (Borodin et al., 2004; Gy\u00f6rfi et al., 2006; Li et al., 2012), that is, for each period, we treat the individual OLMAR with a specified w \u2265 3 as an expert and combine multiple experts\u2019 portfolios weighted by their historical performance.", "startOffset": 98, "endOffset": 158}, {"referenceID": 9, "context": "To smooth the final performance of the system, we propose to adopt the Buy and Hold (BAH) version (Borodin et al., 2004; Gy\u00f6rfi et al., 2006; Li et al., 2012), that is, for each period, we treat the individual OLMAR with a specified w \u2265 3 as an expert and combine multiple experts\u2019 portfolios weighted by their historical performance.", "startOffset": 98, "endOffset": 158}, {"referenceID": 15, "context": "To smooth the final performance of the system, we propose to adopt the Buy and Hold (BAH) version (Borodin et al., 2004; Gy\u00f6rfi et al., 2006; Li et al., 2012), that is, for each period, we treat the individual OLMAR with a specified w \u2265 3 as an expert and combine multiple experts\u2019 portfolios weighted by their historical performance.", "startOffset": 98, "endOffset": 158}, {"referenceID": 5, "context": "m, and the normalization step can also be implemented in linear time (Duchi et al., 2008).", "startOffset": 69, "endOffset": 89}, {"referenceID": 12, "context": "Among these, NYSE (O) is one benchmarks dataset evaluated by all existing methods, while NYSE (N) is a dataset collected by Li et al. (2011b) as a continuation of NYSE (O).", "startOffset": 124, "endOffset": 142}, {"referenceID": 1, "context": "The remaining two datasets (DJA and TSE) are collected by Borodin et al. (2004).", "startOffset": 58, "endOffset": 80}, {"referenceID": 1, "context": "To evaluate the practical applicability, we evaluate the scalability of the proposed algorithms with respect to proportional transaction cost (Borodin et al., 2004).", "startOffset": 142, "endOffset": 164}, {"referenceID": 1, "context": "Without theoretical guarantee, the empirical assumptions in Section 2 are worth inspecting, as done by all existing heuristic algorithms (Borodin et al., 2004; Li et al., 2011a;b; 2012).", "startOffset": 137, "endOffset": 185}, {"referenceID": 15, "context": "In fact, OLMAR also performs quite well on the other two public datasets (Li et al., 2012), that is, SP500 and MSCI, whose results will be included in the long version of this paper.", "startOffset": 73, "endOffset": 90}], "year": 2012, "abstractText": "On-line portfolio selection has attracted increasing interests in machine learning and AI communities recently. Empirical evidence show that stock\u2019s high and low prices are temporary and stock price relatives are likely to follow the mean reversion phenomenon. While the existing mean reversion strategies are shown to achieve good empirical performance on many real datasets, they often make the single-period mean reversion assumption, which is not always satisfied, leading to poor performance in some real datasets. To overcome the limitation, this article proposes a multiple-period mean reversion, or so-called \u201cMoving Average Reversion\u201d (MAR), and a new on-line portfolio selection strategy named \u201cOn-Line Moving Average Reversion\u201d (OLMAR), which exploits MAR by applying powerful online learning techniques. From our empirical results, we found that OLMAR can overcome the drawbacks of existing mean reversion algorithms and achieve significantly better results, especially on the datasets where existing mean reversion algorithms failed. In addition to superior performance, OLMAR also runs extremely fast, further supporting its practical applicability to a wide range of applications.", "creator": " TeX output 2012.05.14:2345"}}}