{"id": "1212.2262", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "11-Dec-2012", "title": "Bag-of-Words Representation for Biomedical Time Series Classification", "abstract": "automatic analysis of biomedical time series such as electroencephalogram ( eeg ) and cardiac electrocardiographic ( ecg ) sequencing signals has attracted great interest in the community of biomedical engineering due to its important applications in medicine. in this work, a simple yet effective bag - of - words representation that is able to capture both local and global structure similarity information is finally proposed for biomedical time series representation. significantly in particular, similar to the bag - of - words model models used in text document domain, the proposed method treats a business time series vector as a text document variable and extracts local segments from the time series as words. the biomedical time series is then represented as a histogram of codewords, each matrix entry entity of which is the count structure of a codeword appeared in the time series. although the temporal order of collecting the local segments is ignored, the bag - of - words reference representation is able to capture high - level structural information because that both local and global structural information are well in utilized. the performance factor of the original bag - of - air words model together is validated on three datasets extracted from real eeg and ecg signals. the experimental results demonstrate that integrating the proposed method is not only insensitive to parameters of combining the generalized bag - of - words model such models as local segment mesh length and codebook size, but also robust addition to noise.", "histories": [["v1", "Tue, 11 Dec 2012 00:49:27 GMT  (681kb,D)", "http://arxiv.org/abs/1212.2262v1", "10 pages, 7 figures. Submitted to IEEE Transaction on Biomedical Engineering"]], "COMMENTS": "10 pages, 7 figures. Submitted to IEEE Transaction on Biomedical Engineering", "reviews": [], "SUBJECTS": "cs.LG cs.AI", "authors": ["jin wang", "ping liu", "mary f h she", "saeid nahavandi", "and abbas kouzani"], "accepted": false, "id": "1212.2262"}, "pdf": {"name": "1212.2262.pdf", "metadata": {"source": "CRF", "title": "Bag-of-words Representation for Biomedical Time Series Classification", "authors": ["Jin Wang", "Ping Liu", "Mary F.H.She", "Saeid Nahavandi", "Abbas Kouzani"], "emails": ["jay.wangjin@gmail."], "sections": [{"heading": null, "text": "Index Terms\u2014bag of words, codebook construction, clustering, time series classification.\nI. INTRODUCTION\nW ITH the development of modern technology and reduc-tion of hardware cost, a large amount of biomedical signals such as electroencephalogram (EEG) and electrocardiographic (ECG) are collected every day. These biomedical signals are very useful for monitoring human\u2019s physical condition. It is however a challenging task to efficiently and effectively analyze these signals. Traditionally, these signals are manually analyzed by professional experts. However, there are several disadvantages of the manual analysis. Firstly, comparing to the large amount of biomedical signals, the number of professional experts, especially the ones with extensive experience is very limited. Secondly, inspection and monitoring of long-term biomedical signals such as EEG and ECG signals are always very time consuming. It is difficult to keep a high level of concentration during a lengthy inspection, giving rise to an increase in the false hit rate by the operator. Finally, it is frequently needed to find inter-reader variability in\nJin Wang and Mary F.H.She are with the Center for Intelligent Systems Research and the Institute for Frontier Material, Deakin University, Australia. e-mail: jay.wangjin@gmail.\nPing Liu is with Department of Computer Science and Engineering, University of South Carolina, USA.\nSaeid Nahavandi is with the Center for Intelligent Systems Research, Deakin University, Australia.\nAbbas Kouzani is with the School of Engineering, Deakin University, Australia.\nManuscript received **; revised **.\nthe manual inspection and monitoring by experts. Therefore, an automated system that can assist professional experts to analyze long-term biomedical signals is very valuable in realword applications.\nAutomatic analysis of biomedical time series such as EEG and ECG signals based on machine learning techniques has been applied to a variety of real-word applications. For instance, EEG signals are automatically analyzed for epileptic seizure detection [1] [2] [3], brain computer interaction [4] [5] [6], human mental fatigue detection [7] and emotion recognition [8]. ECG signals that provide useful information about heart rhythm are used to study heart arrhythmias [9] [10]. It is essential to extract meaningful features to represent individual time series in the aforementioned applications. Some methods [11] [12] directly describe time series in time domain while some others extract features from transformed domain [2] [13] [10]. For instance, Zadeh et al. [12] extracted morphological and timing-interval features from ECG segments to classify heartbeats. Guo et al. [2] extracted line length features based on Discrete Wavelet Transform (DWT) to detect epileptic EEG segments.\nMost of the previous representations extract local temporal or frequency information to characterize time series, which are very effective for short time series or time series with periodic waveforms. However, they may have limited ability to capture structural similarity of long time series which have repetitive but un-periodic waveforms, for instance, Electrocardiography (ECG) and Electroencephalography (EEG) signals. In order to capture the high-level structural information of time series, Lin [14] proposed a bag-of-patterns (BoP) representation by converting a time series to a words string using the Symbolic Aggregate approXimation (SAX). The temporal order of local segments, i.e., local patterns, in a time series is ignored and all the local segments in the time series are histogrammed to construct a bag-of-patterns representation. The bag-of-patterns representation is effective to capture the structural similarity of time series. However, one drawback of the bag-of-patterns representation is that its dimension may be very high, which limits its application for large datasets. For instance, when the size of the alphabet \u03c4 and the number of symbols w are 4 and 8, respectively, the dimension of the bag-of-patterns representation could reach \u03c4w = 65536.\nIn this work, motivated by the success of the bag-ofwords model in text document analysis [15] [16] and image analysis [17] [18], we propose a simple yet effective bag-ofwords representation whose dimension is much lower than the bag-of-patterns representation to characterize biomedical time series. The bag-of-words representation is able to capture high-\nar X\niv :1\n21 2.\n22 62\nv1 [\ncs .L\nG ]\n1 1\nD ec\n2 01\n2\nlevel structural information of time series due to the utilization of both local and global information. Moreover, it can be used to represent streaming data and time series with different lengths because it is incrementally constructed.\nThe bag-of-words model was originally developed for document representation. The basic idea is to define a codebook that contains a set of codewords and then represent a document as a histogram of the codewords, each entry of which is the count of a codeword occurred in the document. Although the order information of words is ignored, the bag-of-words model is still very effective to capture document information because the frequency information of codewords in documents are well explored. Recently, the bag-of-words model is extended to analyze images and videos in computer vision [17] [18]. Local patches extracted from images or videos are treated as words and the codebook is constructed by clustering all the local patches in the training data. Similar to the extension of the bagof-words representation in computer vision, we here extend the bag-of-words representation to characterize biomedical time series by regarding local segments extracted from time series as words and treat the time series as documents."}, {"heading": "A. Overview of the Proposed Approach", "text": "In the bag-of-words representation, a time series is treated as a text document and local segments extracted from the time series as words. The general flowchart of the proposed method is demonstrated in Fig. 1. Firstly, we continuously slide a window with a pre-defined length along the time series to extract a group of local segments. Then, we extract a feature vector from each of the local segments using DWT. Next, similar to the bag-of-visual-words model in images and videos analysis [17] [18], all local segments from the training time series are clustered by k-means clustering to create a codebook, i.e, the cluster centers are treated as codewords. Then, a local segment is assigned the codeword that has the minimum distance to the local segment, and the time series is represented as a histogram of the codewords. Finally, the bag-of-words representation is used as input for classification."}, {"heading": "B. Contribution and Organization", "text": "The main contribution of the paper is twofold: (i) a simple yet effective bag-of-words representation is proposed for analysis of biomedical time series; (ii) a series of experiments was conducted to investigate the effectiveness and robustness of the bag-of-words representation for classification of biomedical time series.\nThe structure of the paper is organized as follows. In Section II, the proposed method including the bag-of-words representation, distance measures and classification method is described. Section III describes the biomedical time series datasets used in the experiments. Experimental results are reported and analyzed in Section IV. Discussion and conclusion are given in Section V and Section VI, respectively."}, {"heading": "II. PROPOSED METHOD", "text": "In this section, we describe the bag-of-words representation for biomedical time series classification. The bag-of-words representation ignores the temporal order of local segments within a time series and represents the time series as a histogram of codewords i.e., local segments. Several distance measures are then introduced for the histograms comparison."}, {"heading": "A. Bag-of-words Representation", "text": "The procedure of generating the bag-of-words representation is illustrated in Fig. 2. We continuously slide a window with pre-defined length along a time series and extract a group of local segments from the time series. A feature vector is then extracted from each of the local segments using the DWT to characterize the local segment. All the local segments from the training data are clustered to construct a codebook that contains a set of codewords, i.e., the cluster centers. Then, a local segment is assigned the codeword that has minimum distance with the local segment. The bag-ofwords representation ignores the order of local segments in a time series and represent the time series as a histogram of codewords.\n1) Local Segments Extraction: A group of local segments are extracted from each time series by continuously sliding a window with pre-defined length along the time series. As local segments from different time series may be at different scales, all the local segments are normalized to zero mean and standard deviation. We transform a local segments into wavelet domain and use approximations wavelet coefficients of DWT as a feature vector to represent the local segment.\nThe wavelet transform that analyzes a signal at different frequency bands provides both accurate frequency information at low frequencies and time information at high frequencies, which are very important for biomedical signal analysis. The choice of wavelet function and the number of decomposition levels is of importance for the multiresolution decomposition. In this work, a single level DWT with order 3 Daubechies wavelet function (db3) is employed to decompose a local segment into approximations coefficients and detailed coefficients. Similar to the work in [13], we used the approximation coefficients as a feature vector to represent the local segment. We do not directly use the raw value of local segments as feature vectors due to the fact that features using the approximations coefficients not only are more robust to noise than features using raw segments but also have nearly half dimension of the local segments.\n2) Codebook Formulation: In the text document analysis, a codebook (vocabulary) is a set of pre-defined words, which are also called codewords. The bag-of-words method counts the number of each codeword that exists in a document and provides a document-level representation using a histogram of codewords. In image and video analysis, such codebook is\ngenerally created by performing clustering on a group of local patches from training data, i.e., the codewords are defined as the clustering centers. The codeword that is nearest to a local patch is then assigned to the local patch. The spatial and temporal order information of local patches (codewords) is ignored and an image or video is represented as a histogram of codewords in the image or video. The classical k-means clustering algorithm [17] [18] is commonly used to construct the codebook, although some other unsupervised and supervised methods are also developed such as mean-sift [19] and supervised Gaussian mixture models [20].\nSimilar to the codebook construction in image and video analysis, we cluster all the local segments from training time series using k-means clustering to construct the codebook. The clustering centers estimated by the k-means clustering are regarded as basis elements of the codebook, i.e., codewords. Suppose a group of local segments X = [x1,x2, \u00b7 \u00b7 \u00b7 ,xn], where xi \u2208 Rd, are extracted from taring time series, the codebook construction by k-means clustering is formulized as the optimization problem:\nmin B\u2208Rd\u00d7K ,V\u2208RK\u00d7n n\u2211 i=1 \u2016xi \u2212Bvi\u20162,\ns.t. card(vi) = 1, |vi| = 1,\u2200i,vi \u2265 0, (1)\nwhere B \u2208 Rd\u00d7K is the clustering centers and the vector vi is the clustering index of the local segment xi, which is a unitbasis vector that has only one component equal to one and all the other components are zero. The codebook B \u2208 Rd\u00d7K\nhas K codewords, each of which is a d-length vector, the same length as the local segments. It is worth noting that the codebook only needs to be learned once from training data and it is universal for both training and test data.\nThe codebook size K is of importance to the bag-of-words representation. A compact codebook with too few entries has a limited discriminative ability, while a large codebook is likely to introduce noise due to the sparsity of the codewords histogram. Therefore, the size of the codebook should well balance the trade-off between discrimination and noise.\n3) Codewords Assignment: Once the codebook is constructed, a local segment is assigned the codeword that has minimum distance with the local segment. Specifically, suppose that a codebook with K entries, B = {b1,b2, ...,bK}, is learned from the training data. A local segment xi is assigned the c th codeword that: c\u2217 = argminj d(bj ,xi), where d(\u00b7, \u00b7) is the Euclidean distance function.\nAfter each local segment is assigned a codeword, the temporal order of local segments is ignored and a time series is represented as a histogram of codewords in the time series, each entry of which specifies the count of a codeword occurred in the time series. Fig. 3 illustrates the bag-of-words representation of an example EEG time series. The figure in the first row is the example EEG time series. The three figures in the second to fourth rows (left) are three local segments with length of 160 extracted from the time series, and the three figures in the second to fourth rows (right) are the corresponding codewords assigned to the local segments from codebook, which consists of 1000 codewords. The three local segments are assigned the 432th, 118th, and 628th codewords, respectively. The figure in the last row is the bagof-words representation for the time series, each entry of which gives the count of a codeword occurred in the time series."}, {"heading": "B. Classifier", "text": "Some discriminative classifiers such as Artificial Neural Networks (ANN) [2], Support Vector Machine (SVM) [21], and Probabilistic Neural Networks (PNN) [13] are widely used for biomedical signal classification. Since our goal in this paper is to investigate the effectiveness of the bag-ofwords representation, here we use the simplest classifier, i.e., the 1-Nearest Neighbor (1-NN) classifier. Let t be a test time series and Ri represents the time series from the ith category. The test data is determined as the class C of the training sample that has minimal distance with the test data, i.e., C\u2217 = argminiD(t,Ri), where D(\u00b7, \u00b7) is the similarity measure that is defined in the following."}, {"heading": "C. Similarity Measure", "text": "Many similarity measures have been proposed for histograms comparison. In the following, we describe four commonly used similarity measures for distance measurement of two bag-of-words representations.\n1) Euclidean Distance: The Euclidean distance between histogram h and histogram k is defined as:\nDL2(h,k) = (\u2211 i |h(i)\u2212 k(i)|2 )1/2 , (2)\nwhere DL2(h,k) is the Euclidean distance, which is commonly used in pattern recognition.\n2) Chi-Squared Distance: The Euclidean distance subtracts the two histograms bin-by-bin and contributes each bin pairs equally to the distance. The problem is that some words such as \u201cthe\u201d, \u201cbut\u201d and \u201chowever\u201d occur more frequently in documents; therefore, they contribute more to the distance in the Euclidean Distance measure. But they may actually have less\ndiscriminative information than rarely happened codewords. This leads to the Chi-Squared distance (\u03c72 distance):\nD\u03c72(h,k) = \u2211 i |h(i)\u2212 k(i)|2 h(i) + k(i) + \u03b5 , (3)\nwhere \u03b5 is a small value to avoid dividing by zero. The \u03c72 distance introduces a normalization to emphasis the rarely happened codewords because common words are always shared between documents from different categories.\n3) Jensen-Shannon Distance: Each entry of the bag-ofwords represents can be interpreted as the frequency of a codeword occurred in a time series. Therefore, the histogram stands for a probabilistic distribution over discrete random variables. A simple measure to compare two distribution is the Kullback-Leibler divergence:\nDKL(h||k) = \u2211 i h(i) (log2h(i)\u2212 log2k(i)) . (4)\nIf and only if h and k are the same, the KL divergence becomes zero. In order to keep the distance symmetric, the Jensen-Shannon distance [22] is introduced as a symmetric extension:\nDJS = 1\n2 (DKL(h||k) +DKL(k||h)) . (5)\n4) Histogram Intersection based Distance: The histogram intersection which counts the total overlap between two histograms is able to address the problem of partial matches when the two histograms have different sum over all the bins. The distance based on the histogram intersection is defined as [23]:\nDHI(h||k) = 1\u2212 \u2211 i max (h(i), k(i)) , (6)\nwhere h and k are normalized histogram vectors. Two histograms that have larger overlap will obtain a smaller distance."}, {"heading": "D. Practical Implementation", "text": "A large number of local segments may be extracted from training data, especially for large datasets. Clustering a large number of local segments to construct the codebook is computationally expensive. In practice, instead of using all the local segments extracted from the training data, we performing the k-means clustering on a subset of local segments randomly selected from the training data to construct the codebook. This strategy is also employed in image and video analysis to reduce the computation of codebook construction [17], [18].\nWe continuously slide a window along a time series to extract local segments. However, when the time series contains too many data points, a large number of local segments will be extracted from the time series, which requires expensive computation. For instance, for a time series consisting of 2000 data points, about 1900 local segments will be extracted using a window with 100 length. In practice, we can slide the window with a step of n data points (n = 2, 4, 6 or 8) along the time series to reduce the number of local segments extracted from the time series.\nThe MATLAB code of the bag-of-words representation in this work was made publicly available at http://www.mathworks.com/matlabcentral/fileexchange/38050."}, {"heading": "III. EXPERIMENTAL DATASETS", "text": "In this study, three datasets constructed from EEG and ECG signals are used to evaluate the performance of the bag-ofwords representation. The first dataset is collected from EEG signals and it is widely used for automatic epileptic seizure detection. The other two datasets are extracted from long ECG signals (more than 1000000 points) that collected from different subjects with random start points. Each of the long ECG signals corresponds to a class, i.e., subjects\u2019 identity. In order to demonstrate that the bag-of-words representation can be for time series with different lengths, the third dataset is extracted with different lengths between 2048\u223c4096, while the first two datasets have the same length of 4096 and 2048, respectively.\nIt is worth noting that although the extracted ECG time series in the same class are obtained from the same long ECG signal, there exist substantial inter-class variations. The aim of the ECG signal classification in our experiment is to attribute each instance, i.e., extracted ECG time series, to their subjects\u2019 identity, which can be used for human identification from ECG signals in real application [24], [25]. This task may be not difficult by comparing features extracted based on heartbeat waveforms or fiducial points, for instance, cross-correlation among QRS complexes. However, the bagof-words representation does not need to detect or localize any heartbeat waveforms or fiducial points, which is always required in previous works [24], [25]."}, {"heading": "A. EEG Dataset", "text": "The EEG dataset described in [26] was used in our experiments. The complete EEG dataset consists of five classes (i.e., A, B, C, D, and E), each of which contains 100 singlechannel EEG sequences of the same length 4096. All the signals were recorded with the same 128-channel amplifier system and visual inspected for artifacts. Set A and set B are collected from surface EEG recordings of five healthy subjects with eye open and eye closed, respectively. The other three sets (C, D and E) are taken from intracranial EEG recording of five patients suffered from epileptic. Set C and set D are taken from the epileptogenic zone and the hippocampal formation of the opposite hemisphere of the brain, respectively. Set C and set D were recorded in seizure-free intervals, whereas set E only contains seizure activity. Fig. 4 shows example time series from each of the five classes."}, {"heading": "B. ECG-40 Dataset", "text": "The ECG-40 dataset was obtained from the Fantasia ECG database [27]. The database consists of twenty youth and\ntwenty old healthy subjects. Forty long ECG signals are collected from each of the forty subjects monitored for about two hours with a sampling rate of 250 Hz. All the signals contain more than 1000000 data points, which are very long. We extracted fifty time series of length 2048 from each of the forty long signals with random start points. Totally, the ECG40 dataset contains 2000 time series of length 2048, which are evenly distributed in the forty classes."}, {"heading": "C. ECG-15 Dataset", "text": "The ECG-15 dataset consists of 1500 time series extracted from fifteen long ECG signals in the BIDMC Congestive Heart Failure Database [27]. The fifteen long ECG signals were recorded from fifteen patients suffered from severe congestive heart failure. One hundred time series of length between 2048 and 4096 are extracted from each of the fifteen long ECG signals with random start points. Totally, the ECG-15 dataset consists of fifteen classes, each of which has 100 time series of length between 2048 and 4096.\nTable I summaries the three datasets used in the experiments. It should be noted that the lengths of the 1500 time series in the ECG-15 dataset are not the same, which vary between 2048 and 4096."}, {"heading": "IV. RESULTS", "text": "In this section, we report experimental results on the three datasets. Firstly, we investigated the impact of parameters by varying the length of local segments and the size of codebook K based on different distance measures. Then, we compared the proposed method with the Discrete Wavelet Transform (DWT) [13] representation, the Discrete Fourier Transform (DFT) [28] representation, the NN classifier based on Dynamic Time Warping (DTW) [29] distance and the bag-of-patterns representation (BoP) [14]. In addition, we compared the classification accuracies achieved by the proposed method with those achieved by other state-of-the-art methods on the EEG dataset. Finally, we investigated the robustness of the bag-ofwords representation to noise. In order to ensure an un-biased evaluation, a dataset is randomly partitioned into 10 subsets. Nine subsets are used for training while the remaining one\nis retained for test. The classification process is then repeated 10 times with each of the 10 subsets used exactly once as test data."}, {"heading": "A. Length of Local Segments", "text": "We varied the length of local segments between 8 and 256 in the experiments. The determination of such parameter ranges relies on the fact that the biomedical time series such as ECG and EEG signals are relatively flat. The classification accuracies on the EEG, ECG-40 and ECG-15 datasets with a codebook size of 1000 using the Chi-Squared distance is illustrated in Fig. 5(a), Fig. 5(b) and Fig. 5(c), respectively. From the experimental results, it can be seen that the performance is relatively stable with respect to the length of local segments when it is between 64 and 192. The classification accuracies decrease considerably with the length less than 16. This is mainly due to the fact that a local segment with too short or too long length can not capture local structure information within time series. In the following experiments, we empirically set the length of local segments as 128."}, {"heading": "B. Codebook Size", "text": "To show the performance of the bag-of-words representation with respect to the size of the codebook, we report the classification accuracies on the three datasets in Fig. 6, increasing the size of the codebook from 10 to 3500. We can see that the results become very stable when the size of the codebook is larger than 500. The classification accuracies reduce quickly if the size of the codebook is less than 100, which confirms that a compact codebook with too few entries has a limited discriminative ability. The optimal size of the codebook can be roughly identified as 1000\u223c3500."}, {"heading": "C. Distance Measurement", "text": "We compared the classification performance on the three datasets using the four similarity measures described in Section II-C. Fig. 7 demonstrates the classification accuracies based on the four distance measures with the codebook size of 10, 100, 1000 and 2000. We can see that the results are slightly different using various distance measures, indicating that the distance measures have limited impact on the performance of the bag-of-words representation. Overall, the Chi-Squared distance measure performs slightly better than the other measures for all the four sizes of the codebook."}, {"heading": "D. Comparison with Other Methods", "text": "We compared the performance of the proposed bag-ofwords representation with that of the DWT representation [13], the DFT representation [28], and the NN classifier based on the DTW distance [29]. In addition, we also compared the proposed bag-of-words representation with the bag-of-patterns representation [14], which is very similar to the proposed approach. \u2022 DWT that represents a signal in multiresolution is able to\ncapture both frequency and location information of time\nseries. Similar to the DWT based feature used in [13], we used the Daubechies wavelet (db2) and decomposed the time series into 4 levels. The detail wavelet coefficients of the four levels and the approximation wavelet coefficients of the fourth level are concatenated to form the final representation.\n\u2022 DFT is a widely used transformation technique to extract frequency information from time series. We transformed the original time series into the frequency domain and extracted the DFT coefficients as features.\n\u2022 DTW that uses dynamic programming technique to determine the best alignment of two sequences is able to\ndeal with temporal drift between time series. The distance matrix of each pair of the test time series and the training time series is calculated based on the unconstrained DTW. This distance matrix is used as input of the NN classifier.\n\u2022 The BoP representation that represents a time series as a histogram of local patterns is very similar to the proposed bag-of-words representation. The size of alphabet \u03c4 and the number of symbols w are empirically set to 4 and 6, respectively. We varied the length of local segments in the bag-of-patterns representation from 16 to 320 with a step of 16. The best accuracy is reported for comparison.\nSince the time series in the ECG-15 datasets have different lengths (2048\u223c4096), we resized all the time series to the same length of 4096 using bilinear interpolation so that the DWT and DFT based features have the same dimension. When calculating the DTW distance, we reduced all the time series in the three datasets to the length of 820 with a downsampling rate of about 5 because DTW is computationally expensive.\nTable II summarizes the best results achieved by the proposed approach and the other methods. It can be seen that the proposed approach achieves the highest accuracies (93.8% on the EEG dataset, 99.5% on the ECG-40 dataset, and 100% on the ECG-15 dataset, respectively), which illustrate the effectiveness of the bag-of-words representation. The BoP representation obtains comparable accuracies on the ECG-40 and the ECG-15 datasets with that by the bag-of-words representation. However, the proposed bag-of-words representation performs significantly better than the BoP representation on the EEG dataset. The DFT feature and DTW distance methods outperform the DWT based method. This is probably because that the DFT and DTW can better deal with temporal sift between sequences than the DWT.\nThe EEG dataset used in our experiment is a popular dataset for automatic epileptic seizure classification and localization. Table III provides a comparison of the classification accuracies between the proposed bag-of-words method and previous state-of-the-art approaches in the literature. It should be noticed that the comparison is not direct, since the aim of our method is to classify the time series at sequence level, while the other methods are to classify segments extracted from the time series. Some works used only several subsets of the whole EEG dataset to construct a 2-class dataset, while others used the whole EEG dataset with 5 classes. For the 2-class classification, the bag-of-words method outperforms most of the other methods. For the 5-class classification where the whole EEG dataset is used, the classification accuracies of support vector machine (SVM), probabilistic neural network (PNN) and multilayer perception neural network (MLPNN) with raw data are 75.60% 72.00% and 68.80% [21], respectively. When features extracted from DWT and lyapunov exponents are used, the corresponding accuracies increase to 99.28%, 98.05% and 93.63% [21], respectively. The result obtained by the proposed BoW representation with the simplest NN classifier is slightly lower than those achieved by SVM and PNN with features based on DWT and lyapunov exponents. However, it is slightly higher than the result obtained by MLPNN (93.63%) with features based on DWT and lyapunov exponents."}, {"heading": "E. Robustness to Noise", "text": "This experiment is designed to investigate the robustness of the bag-of-words representation to noise. All signals in the EEG, ECG-40 and ECG-15 datasets were corrupted by zero mean white Gaussian noise. The standard deviation of\nthe white Gaussian noise is varied so that the SNRs are between 10dB and 0dB. The training data and the test data are separated exactly the same as those in the previous experiments. Table IV summaries the classification accuracies on the three datasets contaminated by the white Gaussian noise with different SNRs. It can be seen that the bag-ofwords approach is relatively robust to noise. The accuracies decreased by less than 2 percents when the SNR is 10dB. Even for considerable noise contamination with the SNR 0dB, the accuracies reduced less than 10 percents for the EEG and ECG-40 datasets, and only less than 2 percents for the ECG-15 dataset."}, {"heading": "V. DISCUSSION", "text": "Although the bag-of-words representation ignores the temporal order of local segments, it is able to effectively capture high-level structural information due to the fact that the frequency of the codewords (local segments) occurred in a time series is well utilized. However, since the local segments are extracted by sliding a window along time series, a time series that is not reasonably long cannot provide enough local segments to capture local structures in the time series. Therefore, the bag-of-words representation may be ineffective to represent short time series, which is mainly due to the limitation that the bag-of-words representation cannot extract enough meaningful and discriminative local segments from short sequences.\nThe size of the codebook N is pre-defined and empirically determined in the method. A compact codebook with small size has a limited discriminative ability, while a codebook with large size is likely to introduce noise. How to adaptively set the optimal size of the codebook to make the codebook compact and yet discriminative is still an open question. Some criteria can be defined to merge entries of a codebook to construct an adaptive codebook. For instance, the method in [32] utilized Maximization of Mutual Information (MMI) principal to estimate the optimal N . Two entries of a codebook are merged by maximizing the mutual information in an unsupervised way. Creating a codebook with adaptive size will be investigated in our future work."}, {"heading": "VI. CONCLUSION", "text": "In this paper, we proposed a bag-of-words representation for biomedical time series analysis. The proposed method treats a time series as a document and local segments extracted\nfrom the time series as words. The time series is represented as a histogram of codewords. Although the temporal order information of the local segments is ignored, both local structure and global structure information of the time series are captured. Experimental results on three publicly available datasets demonstrate that the bag-of-words representation is effective for characterizing biomedical time series such as EEG and ECG signals. Furthermore, the bag-of-words representation is not only insensitive to the length of local segments and the size of codebook, but also robust to noise. The distance measures for comparison of histograms are also investigated in the experiments, showing that the Chi-Squared distance measure is more suitable for comparing histograms than the other distance measures. We compared the performance of the bag-of-words representation with several state-of-the-art approaches in the literature. Experimental results show that the bag-of-words representation with the simplest 1-Nearest Neighbor (1-NN) classifier achieves comparable or higher classification accuracies than those by the others."}], "references": [{"title": "Entropies for detection of epilepsy in EEG,", "author": ["N. Kannathal", "M.L. Choo", "U.R. Acharya", "P. Sadasivan"], "venue": "Compu. Meth. Prog. Bio.,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2005}, {"title": "Automatic epileptic seizure detection in EEGs based on line length feature and artificial neural networks,", "author": ["L. Guo", "D. Rivero", "J. Dorado", "J.R. Rabual", "A. Pazos"], "venue": "J. Neurosci Meth., vol. 191,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2010}, {"title": "Epileptic EEG classification based on extreme learning machine and nonlinear features,", "author": ["Q. Yuan", "W. Zhou", "S. Li", "D. Cai"], "venue": "Epilepsy Res.,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2011}, {"title": "Brain computer interfaces for communication and control,", "author": ["J.R. Wolpaw", "N. Birbaumer", "D.J. McFarland", "G. Pfurtscheller", "T.M. Vaughan"], "venue": "Clin. Neurophysiol.,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2002}, {"title": "Multiclass filters by a weighted pairwise criterion for EEG single-trial classification,", "author": ["H. Wang"], "venue": "IEEE Trans. Biomed. Eng.,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2011}, {"title": "A feature selection method for multilevel mental fatigue EEG classification,", "author": ["K.-Q. Shen", "C.-J. Ong", "X.-P. Li", "Z. Hui", "E. Wilder-Smith"], "venue": "IEEE Trans. Biomed. Eng., vol. 54,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2007}, {"title": "A generic and robust system for automated patient-specific classification of ECG signals,", "author": ["T. Ince", "S. Kiranyaz", "M. Gabbouj"], "venue": "IEEE Trans. Biomed. Eng.,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2009}, {"title": "Heartbeat time series classification with support vector machines,", "author": ["A. Kampouraki", "G. Manis", "C. Nikou"], "venue": "IEEE Trans. Inf. Technol. Biomed.,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2009}, {"title": "Recurrent neural networks for time series", "author": ["M. Huken", "P. Stagge"], "venue": "classification,\u201d Neurocomputing,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2003}, {"title": "Classification of the electrocardiogram signals using supervised classifiers and efficient features,", "author": ["A.E. Zadeh", "A. Khazaee", "V. Ranaee"], "venue": "Compu. Meth. Prog. Bio.,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2010}, {"title": "Rotation-invariant similarity in time series using bag-of-patterns representation,", "author": ["J. Lin", "R. Khade", "Y. Li"], "venue": "J. Intell. Inf. Syst,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2012}, {"title": "The locally weighted bag of words framework for document representation,", "author": ["G. Lebanon", "Y. Mao", "J. Dillon"], "venue": "J. Mach. Learn. Res.,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2007}, {"title": "Latent dirichlet allocation,", "author": ["D. Blei", "A. Ng", "M. Jordan"], "venue": "J. Mach. Learn. Res.,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2003}, {"title": "A bayesian hierarchical model for learning natural scene categories,", "author": ["L. Fei-Fei", "P. Perona"], "venue": "Proc. IEEE Int\u2019l Conf. Computer Vision and Pattern Recognition,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2005}, {"title": "Unsupervised learning of human action categories using spatial-temporal words,", "author": ["J.C. Niebles", "H. Wang", "L. Fei-Fei"], "venue": "Int. J. Comput. Vision.,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2008}, {"title": "Creating efficient codebooks for visual recognition,", "author": ["F. Jurie", "B. Triggs"], "venue": "Proc. IEEE Int\u2019l Conf. Computer Vision,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2005}, {"title": "Supervised learning of gaussian mixture models for visual vocabulary generation,", "author": ["B. Fernando", "E. Fromont", "D. Muselet", "M. Sebban"], "venue": "Pattern Recogn.,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2012}, {"title": "A new metric for probability distributions,", "author": ["D. Endres", "J. Schindelin"], "venue": "IEEE Trans. Inf. Theory,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2003}, {"title": "The pyramid match kernel: Efficient learning with sets of features,", "author": ["K. Grauman", "T. Darrell"], "venue": "J. Mach. Learn. Res.,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2007}, {"title": "ECG analysis: a new approach in human identification,", "author": ["L. Biel", "O. Pettersson", "L. Philipson", "P. Wide"], "venue": "IEEE Trans. Instrum. Meas., vol. 50,", "citeRegEx": "24", "shortCiteRegEx": "24", "year": 2001}, {"title": "Human identification by quantifying similarity and dissimilarity in electrocardiogram phase space,", "author": ["S.-C. Fang", "H.-L. Chan"], "venue": "Pattern Recogn.,", "citeRegEx": "25", "shortCiteRegEx": "25", "year": 2009}, {"title": "Indications of nonlinear deterministic and finite-dimensional structures in time series of brain electrical activity: dependence on recording region and brain state.", "author": ["R.G. Andrzejak", "K. Lehnertz", "F. Mormann", "C. Rieke", "P. David", "C.E. Elger"], "venue": "Phys. rev. E,", "citeRegEx": "26", "shortCiteRegEx": "26", "year": 2001}, {"title": "A review on time series data mining,", "author": ["T. chung Fu"], "venue": "Eng. Appl. Artif. Intel.,", "citeRegEx": "29", "shortCiteRegEx": "29", "year": 2011}, {"title": "Classification of epileptiform EEG using a hybrid system based on decision tree classifier and fast fourier transform,", "author": ["K. Polat", "S. G\u00fcnes"], "venue": "Appl. Math. Comput.,", "citeRegEx": "30", "shortCiteRegEx": "30", "year": 2007}, {"title": "Automatic detection of epileptic seizures in EEG using discrete wavelet transform and approximate entropy,", "author": ["H. Ocak"], "venue": "Expert Syst. Appl.,", "citeRegEx": "31", "shortCiteRegEx": "31", "year": 2009}], "referenceMentions": [{"referenceID": 0, "context": "For instance, EEG signals are automatically analyzed for epileptic seizure detection [1] [2] [3], brain computer interaction [4] [5] [6], human mental fatigue detection [7] and emotion recognition [8].", "startOffset": 85, "endOffset": 88}, {"referenceID": 1, "context": "For instance, EEG signals are automatically analyzed for epileptic seizure detection [1] [2] [3], brain computer interaction [4] [5] [6], human mental fatigue detection [7] and emotion recognition [8].", "startOffset": 89, "endOffset": 92}, {"referenceID": 2, "context": "For instance, EEG signals are automatically analyzed for epileptic seizure detection [1] [2] [3], brain computer interaction [4] [5] [6], human mental fatigue detection [7] and emotion recognition [8].", "startOffset": 93, "endOffset": 96}, {"referenceID": 3, "context": "For instance, EEG signals are automatically analyzed for epileptic seizure detection [1] [2] [3], brain computer interaction [4] [5] [6], human mental fatigue detection [7] and emotion recognition [8].", "startOffset": 125, "endOffset": 128}, {"referenceID": 4, "context": "For instance, EEG signals are automatically analyzed for epileptic seizure detection [1] [2] [3], brain computer interaction [4] [5] [6], human mental fatigue detection [7] and emotion recognition [8].", "startOffset": 133, "endOffset": 136}, {"referenceID": 5, "context": "For instance, EEG signals are automatically analyzed for epileptic seizure detection [1] [2] [3], brain computer interaction [4] [5] [6], human mental fatigue detection [7] and emotion recognition [8].", "startOffset": 169, "endOffset": 172}, {"referenceID": 6, "context": "ECG signals that provide useful information about heart rhythm are used to study heart arrhythmias [9] [10].", "startOffset": 99, "endOffset": 102}, {"referenceID": 7, "context": "ECG signals that provide useful information about heart rhythm are used to study heart arrhythmias [9] [10].", "startOffset": 103, "endOffset": 107}, {"referenceID": 8, "context": "Some methods [11] [12] directly describe time series in time domain while some others extract features from transformed domain [2] [13] [10].", "startOffset": 13, "endOffset": 17}, {"referenceID": 9, "context": "Some methods [11] [12] directly describe time series in time domain while some others extract features from transformed domain [2] [13] [10].", "startOffset": 18, "endOffset": 22}, {"referenceID": 1, "context": "Some methods [11] [12] directly describe time series in time domain while some others extract features from transformed domain [2] [13] [10].", "startOffset": 127, "endOffset": 130}, {"referenceID": 7, "context": "Some methods [11] [12] directly describe time series in time domain while some others extract features from transformed domain [2] [13] [10].", "startOffset": 136, "endOffset": 140}, {"referenceID": 9, "context": "[12] extracted morphological and timing-interval features from ECG segments to classify heartbeats.", "startOffset": 0, "endOffset": 4}, {"referenceID": 1, "context": "[2] extracted line length features based on Discrete Wavelet Transform (DWT) to detect epileptic EEG segments.", "startOffset": 0, "endOffset": 3}, {"referenceID": 10, "context": "In order to capture the high-level structural information of time series, Lin [14] proposed a bag-of-patterns (BoP) representation by converting a time series to a words string using the Symbolic", "startOffset": 78, "endOffset": 82}, {"referenceID": 11, "context": "In this work, motivated by the success of the bag-ofwords model in text document analysis [15] [16] and image analysis [17] [18], we propose a simple yet effective bag-ofwords representation whose dimension is much lower than the bag-of-patterns representation to characterize biomedical time series.", "startOffset": 90, "endOffset": 94}, {"referenceID": 12, "context": "In this work, motivated by the success of the bag-ofwords model in text document analysis [15] [16] and image analysis [17] [18], we propose a simple yet effective bag-ofwords representation whose dimension is much lower than the bag-of-patterns representation to characterize biomedical time series.", "startOffset": 95, "endOffset": 99}, {"referenceID": 13, "context": "In this work, motivated by the success of the bag-ofwords model in text document analysis [15] [16] and image analysis [17] [18], we propose a simple yet effective bag-ofwords representation whose dimension is much lower than the bag-of-patterns representation to characterize biomedical time series.", "startOffset": 119, "endOffset": 123}, {"referenceID": 14, "context": "In this work, motivated by the success of the bag-ofwords model in text document analysis [15] [16] and image analysis [17] [18], we propose a simple yet effective bag-ofwords representation whose dimension is much lower than the bag-of-patterns representation to characterize biomedical time series.", "startOffset": 124, "endOffset": 128}, {"referenceID": 13, "context": "Recently, the bag-of-words model is extended to analyze images and videos in computer vision [17] [18].", "startOffset": 93, "endOffset": 97}, {"referenceID": 14, "context": "Recently, the bag-of-words model is extended to analyze images and videos in computer vision [17] [18].", "startOffset": 98, "endOffset": 102}, {"referenceID": 13, "context": "Next, similar to the bag-of-visual-words model in images and videos analysis [17] [18], all local segments from the training time series are clustered by k-means clustering to create a codebook, i.", "startOffset": 77, "endOffset": 81}, {"referenceID": 14, "context": "Next, similar to the bag-of-visual-words model in images and videos analysis [17] [18], all local segments from the training time series are clustered by k-means clustering to create a codebook, i.", "startOffset": 82, "endOffset": 86}, {"referenceID": 13, "context": "The classical k-means clustering algorithm [17] [18] is commonly used to construct the codebook, although some other unsupervised and supervised methods are also developed such as mean-sift [19] and supervised Gaussian mixture models [20].", "startOffset": 43, "endOffset": 47}, {"referenceID": 14, "context": "The classical k-means clustering algorithm [17] [18] is commonly used to construct the codebook, although some other unsupervised and supervised methods are also developed such as mean-sift [19] and supervised Gaussian mixture models [20].", "startOffset": 48, "endOffset": 52}, {"referenceID": 15, "context": "The classical k-means clustering algorithm [17] [18] is commonly used to construct the codebook, although some other unsupervised and supervised methods are also developed such as mean-sift [19] and supervised Gaussian mixture models [20].", "startOffset": 190, "endOffset": 194}, {"referenceID": 16, "context": "The classical k-means clustering algorithm [17] [18] is commonly used to construct the codebook, although some other unsupervised and supervised methods are also developed such as mean-sift [19] and supervised Gaussian mixture models [20].", "startOffset": 234, "endOffset": 238}, {"referenceID": 1, "context": "Some discriminative classifiers such as Artificial Neural Networks (ANN) [2], Support Vector Machine (SVM) [21], and Probabilistic Neural Networks (PNN) [13] are widely used for biomedical signal classification.", "startOffset": 73, "endOffset": 76}, {"referenceID": 17, "context": "In order to keep the distance symmetric, the Jensen-Shannon distance [22] is introduced as a symmetric extension:", "startOffset": 69, "endOffset": 73}, {"referenceID": 18, "context": "The distance based on the histogram intersection is defined as [23]:", "startOffset": 63, "endOffset": 67}, {"referenceID": 13, "context": "This strategy is also employed in image and video analysis to reduce the computation of codebook construction [17], [18].", "startOffset": 110, "endOffset": 114}, {"referenceID": 14, "context": "This strategy is also employed in image and video analysis to reduce the computation of codebook construction [17], [18].", "startOffset": 116, "endOffset": 120}, {"referenceID": 19, "context": ", extracted ECG time series, to their subjects\u2019 identity, which can be used for human identification from ECG signals in real application [24], [25].", "startOffset": 138, "endOffset": 142}, {"referenceID": 20, "context": ", extracted ECG time series, to their subjects\u2019 identity, which can be used for human identification from ECG signals in real application [24], [25].", "startOffset": 144, "endOffset": 148}, {"referenceID": 19, "context": "However, the bagof-words representation does not need to detect or localize any heartbeat waveforms or fiducial points, which is always required in previous works [24], [25].", "startOffset": 163, "endOffset": 167}, {"referenceID": 20, "context": "However, the bagof-words representation does not need to detect or localize any heartbeat waveforms or fiducial points, which is always required in previous works [24], [25].", "startOffset": 169, "endOffset": 173}, {"referenceID": 21, "context": "The EEG dataset described in [26] was used in our experiments.", "startOffset": 29, "endOffset": 33}, {"referenceID": 22, "context": "Then, we compared the proposed method with the Discrete Wavelet Transform (DWT) [13] representation, the Discrete Fourier Transform (DFT) [28] representation, the NN classifier based on Dynamic Time Warping (DTW) [29] distance and the bag-of-patterns representation (BoP) [14].", "startOffset": 213, "endOffset": 217}, {"referenceID": 10, "context": "Then, we compared the proposed method with the Discrete Wavelet Transform (DWT) [13] representation, the Discrete Fourier Transform (DFT) [28] representation, the NN classifier based on Dynamic Time Warping (DTW) [29] distance and the bag-of-patterns representation (BoP) [14].", "startOffset": 272, "endOffset": 276}, {"referenceID": 22, "context": "We compared the performance of the proposed bag-ofwords representation with that of the DWT representation [13], the DFT representation [28], and the NN classifier based on the DTW distance [29].", "startOffset": 190, "endOffset": 194}, {"referenceID": 10, "context": "proposed bag-of-words representation with the bag-of-patterns representation [14], which is very similar to the proposed approach.", "startOffset": 77, "endOffset": 81}, {"referenceID": 10, "context": "BoP [14] 87.", "startOffset": 4, "endOffset": 8}, {"referenceID": 0, "context": "[1] A, E 2 Entropy+adaptive neuro-fuzzy inference system 95", "startOffset": 0, "endOffset": 3}, {"referenceID": 23, "context": "Polat and G\u00fcnes [30] A, E 2 FFT+decision tree 98.", "startOffset": 16, "endOffset": 20}, {"referenceID": 2, "context": "[3] D, E 2 Nonlinear features+extreme learning machine 96.", "startOffset": 0, "endOffset": 3}, {"referenceID": 24, "context": "Ocak [31] (A, C, D), E 2 DWT+approximate entropy 96.", "startOffset": 5, "endOffset": 9}, {"referenceID": 1, "context": "[2] A, E 2 Line length feature based on DWT+artificial neural networks 99.", "startOffset": 0, "endOffset": 3}], "year": 2012, "abstractText": "Automatic analysis of biomedical time series such as electroencephalogram (EEG) and electrocardiographic (ECG) signals has attracted great interest in the community of biomedical engineering due to its important applications in medicine. In this work, a simple yet effective bag-of-words representation that is able to capture both local and global structure similarity information is proposed for biomedical time series representation. In particular, similar to the bag-of-words model used in text document domain, the proposed method treats a time series as a text document and extracts local segments from the time series as words. The biomedical time series is then represented as a histogram of codewords, each entry of which is the count of a codeword appeared in the time series. Although the temporal order of the local segments is ignored, the bag-of-words representation is able to capture high-level structural information because both local and global structural information are well utilized. The performance of the bag-of-words model is validated on three datasets extracted from real EEG and ECG signals. The experimental results demonstrate that the proposed method is not only insensitive to parameters of the bag-of-words model such as local segment length and codebook size, but also robust to noise.", "creator": "LaTeX with hyperref package"}}}