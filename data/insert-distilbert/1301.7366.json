{"id": "1301.7366", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "30-Jan-2013", "title": "Marginalizing in Undirected Graph and Hypergraph Models", "abstract": "given an extended undirected graph g or hypergraph x model for handling a given set of variables v, we introduce two continuous marginalization operators for obtaining the undirected graph ga or hypergraph ha associated with a given subset a c containing v such that the probability marginal distribution of class a factorizes according to ga or ha, respectively. finally, we carefully illustrate the method by putting its application to some practical examples. with them models we show that hypergraph models allow defining a finer factorization or performing a more precise conditional independence plot analysis than undirected graph models.", "histories": [["v1", "Wed, 30 Jan 2013 15:02:59 GMT  (551kb)", "http://arxiv.org/abs/1301.7366v1", "Appears in Proceedings of the Fourteenth Conference on Uncertainty in Artificial Intelligence (UAI1998)"]], "COMMENTS": "Appears in Proceedings of the Fourteenth Conference on Uncertainty in Artificial Intelligence (UAI1998)", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["enrique f castillo", "juan ferr\\'andiz", "pilar sanmartin"], "accepted": false, "id": "1301.7366"}, "pdf": {"name": "1301.7366.pdf", "metadata": {"source": "CRF", "title": "Marginalizing in Undirected Graph and Hypergraph Models", "authors": ["Enrique F. Castillo", "Juan Ferrandiz", "Pilar Sanmartin"], "emails": ["castie@ccaix3.", "sanmarti@mat.", "Juan.Ferrandiz@uv.es"], "sections": [{"heading": null, "text": "1 INTRODUCTION\nIn many practical situations the structural relation ship among a set of variables V = { V1, . . . , Vn} can be represented as an undirected graph g = (V, E) , where E is the set of edges of g. If two variables are indepen dent, the corresponding nodes should not be connected by a path.\nSimilarly, if the independence between variables X and Y is indirect and mediated by a third variable Z (that is, if X and Y are conditionally independent given Z), we display Z as a node that intersects the path between X and Y, i. e. , Z is a cutset separating X and Y. This correspondence between conditional in dependence and cutset separation in undirected graphs forms the basis of the theory of Markov fields (Isham [5], Lauritzen [6], Wermuth and Lauritzen [10]) , and has been given axiomatic characterizations (Pearl and Paz [11] ) .\nHowever, in many practical cases we can be interested not in the whole set of variables V but in a subset A of them. In this case the initial graph model is not the most appropriate to work with and we are interested in the graph model induced by the initial graph in A.\nThe independence graph of marginal probability distri butions for a subset of the considered variables was un-\ndertaken in Frydenberg (1990), after Asmussen (1983). There, he stated the collapsibility condition for the corresponding subgraph to be the independence graph of the marginal probability distribution.\nUnfortunately, not all probabilistic models can be rep resented by undirected perfect maps. Pearl and Paz [11] characterize the dependency models represented by undirected perfect maps. The theorem refers not only to probabilistic but to general dependency mod els.\nSince the resulting independence graph reveals this lack of sensitivity to detect all independence properties and lack identification of missing n-th ( n > 2) order in teractions when second order interactions are present, as an alternative, we use hypergraph models (see Rose [12], Tarjan and Yannakakis [13] , Mellouli [9] , Studeny [16] and Shafer and Shenoy [15] for related problems) . In this paper, based on the factorization properties, we give an algorithm for obtaining the marginal indepen dence graph under general conditions. To illustrate these concepts, we use some examples in which this lack of sensitivity and the characteristic contribution of hypergraph models become apparent.\nIn Section 2 we introduce the main concepts to be used in the rest of the paper with a distinction between those required for the case of graphs and those for hy pergraphs. In particular, we introduce the hypergraph models based on Gibbs distributions. In Section 3 we introduce a marginalization operator for the case of undirected graphs that allows obtaining such a graph in the sense of the marginal model to satisfy the cor responding factorization properties. We also give an algorithm to implement this operator. In Section 4 we follow exactly the same process for the case of hyper graphs. In both sections we illustrate the methods by means of practical examples. Finally, we make some comparisons, and in Section 6 we give some conclu sions and recommendations.\n2 BACKGROUND\nWe divide this section in two parts. The first is devoted to undirected graphs, and the second to Gibbs distri-\n70 Castillo, Fernindiz, and Sanmartin\nbutions and hypergraphs. We assume that the range of every variable is a real set containing the zero.\n2.1 UNDIRECTED GRAPHS\nThe main theorem to be given in Section 3 requires several concepts of undirected graphs which are given below. We illustrate them with some examples.\nDefinition 1 (Path). Given a graph g a path of length n between nodes Vr and V8 is a sequence of nodes Vo, ... , Vn such that (Vi, Vi+ I); i = 0, . . . , n - 1 are edges of Q and Vo = Vr and Vn = Vs.\nDefinition 2 (Connected Nodes). Given a graph Q = (V, E), two nodes Vr, V8 E V are said to be con nected if there is a path from Vr to Vs. They are said to be directly connected iff the path is of length 1.\nDefinition 3 (Complete Set). Given a graph g = (V, E), a set A s:;;: V is said to be complete if all nodes in A are mutually and directly connected by edges in E .\nDefinition 4 (Clique). A maximal complete set of nodes is called a clique.\nDefinition 5 (Boundary). Given a graph g = (V, E) and a subset A c V the boundary bd(A) of A is the set of nodes Vr tf. A such that they are directly connected to an element of A, i. e. ,\nDefinition 6 (Connectivity Components). Given a graph g = (V, E) its set of nodes V can be partitioned in maximal subsets of nodes which are mu tually connected (see Lauritzen {1996}, page 6}. These sets are called connectivity components of g.\nExample 1 Consider the set of variables V {V1, V2, ... , V10} and the graph Q = (V, E) shown in Figure 1, where\nE = {(V1, V3), (V1, V4), (V1, V5), (V2, V4), (%, V4), (V3, V5), (V5, V4), (V6, V4), (V7, Vg), (V7, Vw), (Vs, Vw)}.\nSome illustrative examples of the above definitions are:\nPath: The sequence of nodes {V1, V4, V5, V3} is a path of length 3 between vl and v3, as it is the sequence {V1, V3}, which has length 1.\nConnected nodes: The nodes V8 and Vg are connected nodes because there is a path {Vs, Vw, V7, Vg} joining VB and Vg.\nDirectly connected nodes: Nodes V7 and Vw are di rectly connected nodes because the path {V7, V1o} join ing them has length l.\nComplete Sets: The only complete set of four elements in g is {V1, V3, V4, V5} (all pairs of nodes are directly connected). Obviously, all its subsets are also complete\nand it contains the only four complete sets of three elements. The remaining complete sets contain one or two elements.\nDefinition 7 (Completed Edge Set). Given a graph g = (V, E) and a subset A c V, the completed edge sets E* (A) of A is the set of all possible edges between nodes in A.\nDefinition 8 (Subgraph). Given a graph g = (V, E) and a subset A C V , the subgraph g A is the graph 9A = (A, EIA) , that is, the graph defined over A and containing the edges of E connecting nodes in A.\nDefinition 9 (Factorization Property). A prob ability distribution P on V, is said to factorize ac cording to an undirected graph g (U DC), if for all complete set, C , of vertices there exist non-negative functions '1/Jc such that\np(v) = IJ '1/Jc(c) CcV complete\nThe above factorization can be done using only cliques. However, this leads to a coarser factorization.\nExample 2 Consider again the graph in Example 1.\nCompleted edge set: The completed edge set of the set {V7, Vs, Vg} is {(V7, Vs), (V7, Vg), (Vs, Vg)}.\nSubgraph: The subgraph associated with the set {V2, V4, V5, V6} is\n{ {V2, V4, V5, V6} , {(V2, V4), (V4, V5), (V4, V6)}.\nFactorization: A possible factorization of p( v) is\np(v) '1/J(vl, v3, V4, v5)'lj;(v2, V4)'1jJ(v4, v6)'1jJ(v7, vg) 'lj;(v7, vw)'l/J(vs, vlo).\nMarginalizing in Undirected Graph and Hypergraph Models 71\n2.2 GIBBS DISTRIBUTIONS AND HYPERGRAPHS\nAs it is well known undirected graphs do not lead to the finest possible factorization in probabilistic mod els. This justifies the use of the Gibbs and hypergraph models to be given below.\nDefinition 10 (Gibbs Model). Given a graph 9 = (V, E), the set of random variables V is said to follow a Gibbs model according to the graph 9 if its associated probability density function (pdf) can be written in the form\np(v) = exp (- L Uc(c)) /K, CEC\n(1)\nwhere K is a normalizing constant and C is the class of all complete sets of V with respect to 9. The func tions U c are called interaction functions and some of them can be null. {In order to avoid trivial undeter minations we will assume hereafter u(/J ( -) = 0). The set U = {Uc(c)IC E C} in {1} is called a potential.\nNote that Expression (1) shows a characteristic factor ization property of the corresponding Gibbs model. In fact the density in ( 1) factorizes as\n1 1 p(v) = K II exp ( -Uc(c)) = K rr 7/Jc(c), (2) CEC CEC\nwhere the factors in {7/Jc(c)IC E C} are positive.\nThe above interpretation of the joint density in terms of the interaction functions is not unique. However, we are interested in the simplest possible representa tion, which is given by the normalized potential. In it an interaction function Uc(c) appears iff it cannot be written in terms of a sum of functions with less arguments.\nDefinition 11 (Normalized Potential). A poten tial U such that U c (c) = 0 whenever some component of c is null is called a normalized potential.\nIt can be shown that this potential is unique ( see Win kler (1995) ) . In addition, any given potential U0 can be normalized in the sense of leading to the same joint distribution for V , by means of Uc(c) = L ( -1)lC\\Blujj(b, OD\\B) (3) This last equation makes evident that the normalized potential produces a finer factorization (2) of the pdf, because for every non-null interaction function Uc(c) of the normalized potential there is at least one non null interaction function Ujj (d) involving a bigger set of variables.\nDefinition 12 (Potential Restricted to a Set). Given a potential U on the set V and a subset A c V the potential UIA restricted to A is the set\nUIA = {Uc I Uc E U and C c A}.\nExample 3 Consider the set of variables V {V1, V2, V3, V4, Vs, V6} and the graph 9 = (V, E ) , where\nE = {(1/1, V2), (V1, V3), (V2, V3), (V4, Vs), (Vs, V6)}\nGibbs Model: Let us assume the following density:\np(v) ex exp(-B12(1+vl)v2 - B13v1v3 -e23V2V3 - e45V4V5 - Bs6VsV6)'\nwith associated potential U0:\n(4)\n{6112(1 +vl)V2,813V1V3,823V2V3,845V4V5,856V5V6}\u00b7 where eij are constants.\nNormalized Potential: The corresponding normalized potential U becomes:\n{812V2,812V1V2,813V1V3,823V2V3,845V4V5,856V5V6}\u00b7 (5)\nPotential Restricted to a Set: Given the set A = {V1, V3, Vs}, the potential restricted to A is:\nUIA = {B13v1v3}.\nDefinition 13 (Hypergraph). Given a set V, an hypergraph is a subset of parts of V.\nDefinition 14 (Hypergraph associated with a family of potentials. Hypergraph Models). Given a parametric family of potentials, the hypergraph associated with its normalized potential ue is defined as the class of all sets of V with non-null interaction function ug for at least one element in the family, i. e.:\n1{ = {C c;;; vI ug :j. 0 for some B}. (6)\nThe corresponding model is called an interaction junc tions hypergraph or simply hypergraph model.\nNote that hypergraph models are more capable to dis tinguish models than undirected graph models. For example, the last models cannot distinguish between the hypergraph model with potential (5) and the hy pergraph model with potential\nU1 { 812V2, 812V1 V2, 813V1 V3, 8123V1 V2V3, 823V2V3, e45V4Vs, Bs6VsV6}\u00b7\n(7)\nEvery hypergraph H on V induces in V the graph 9(1-i) = (V, E), where\nE = {(Vn Vs) I {Vr, Vs} c;;; A E 7-i}.\nThe graph 9(1-i) associated with the hypergraph of a family of potentials verifies the factorization property with every probability distribution induced by these potentials.\nDefinition 15 (Hypergraph Partial Ordering). Given two hypergraphs 1i 1 and 1{2 on V, we say that 1i1 precedes H2 iff every element of 1i1 is contained in an element oj1i2, that is,\n1i1 ::5 1i2 q.I::/H1 E H1 3H2 E 1i2 with H1 c;;; H2\n72 Castillo, Ferrandiz, and Sanmartin\nComparing again the potentials in (5) and (7), we can say that the hypergraph associated with (5) precedes the hypergraph associated with (7) , but not conversely.\nNow we can state the property of normalized poten tials producing finer factorizations in the more pre cise terms of partial ordering of the associated hyper graphs. The hypergraph associated with the normal ized potential precedes the hypergraph associated with any other potential leading to the same probability dis tribution.\nDefinition 16 (Boundary Hypergraph). Let H be the hypergraph and A C V . The boundary hyper graph HA of V \\ A is the hypergraph of all subsets of A which are the boundary of some connectivity com ponent of 9v\\A in 9(1-l).\nExample 4 Consider again Example 3.\nHypergraph associated with a family of potentials: The hypergraph associated with the potential U is\nH { {V2}, {VI, V2}, {VI, %}, {V2, V3}, {V4, Vs}, {Vs, V6}} .\nGraph associated with a hypergrapll.\u00b7 The graph asso ciated with hypergraph H is\n( {VI, V2, V3, V4, Vs, v6}, {(VI, V2), (VI, %), (V2, V3), (V4, Vs), (Vs, V6)} ).\nBoundary Hypergraph: Given A= {VI, V3, Vs}, since the connectivity components of V \\ A are"}, {"heading": "7I = {Vz}, 72 = {l/4}, 73 = {Va},", "text": "the boundary hypergraph HA of V \\A is the hypergraph:\n{ {VI, V3}, {Vs} }."}, {"heading": "3 THE MARGINAL OPERATOR FOR UNDIRECTED GRAPHS", "text": "Theorem 1 (The marginalization theorem for undirected graphs). Let g be the undirected graph (V, E), and P the probability distribution over V. If A c V and P A is the marginal distribution associated with A, we have that if P factorizes according to the graph g, then, the marginal distribution P A factorizes according to the graph gAa = (A,EAa), where"}, {"heading": "EAa = EIA UrET E*(bd(7)),", "text": "and T is the set of connectivity components of 9v\\A\u00b7\nProof: The marginal distribution is obtained by integration over de range of Z = V \\ A, that is:\nPA(a) = j p(a, z)dz. (8) Replacing the value of p in terms of its factors and assuming that C varies in the class of all complete\nsets C, we get:\nj II 1/;c(c)dz c\nj II 1/Jc(c) II 1/Jc(c)dz C<;;;A C<t;A\nThus,\nwhere\nII 1/Jc(c) j II 1/Jc(c)dz. C<;;;A C<t;A\nPA(a) = 1/Jc0(co) II 1/Jc(c), C<;;;A\n1/Jc0(co) = j II 1/Jc(c)dz; Co= (Uc<t;AC)nA. (9) C<t;A\nLet T be the set of connectivity components of the subgraph 9v\\A\u00b7 Obviously, there are no elements inC with indices in more than one of these different compo nents. Thus, the integration over V\\A in (9) factorizes in integrals, each on a connectivity component, as:\nII J II 1/Jc(c)d7, rET Cnr=Fi/J\nwhere each factor is of the form:\n1/;bd(r)(bd(7)) = J II 1/Jc(c)dr , (10) Cnr=Fi/J\na function of the set of locations in A which are neigh bors of some location in the connectivity component r, that is, the set bd(r). Then, Co= UrET bd(7). We shall write (9) as:\nT\nConsequently, the marginal pdf can be written as:\nPA(a) = II 1/Jc(c) II 1/Jbd(r)(bd(r)) , (12) C<;;;A T\nwhere we can see that the distribution P A satisfies the factorization property with respect to gAa = (A, EAa), as was to be proven. \u2022 This operator reminds us, in a certain way, the moral ization of chain graphs, the difference being that this applies to chain graphs (with the existence of arrows) to obtain a directed graph, by \"marrying\" the parents of each chain component. This new operator applies to undirected graphs and what get married are the elements in the boundaries of the connectivity compo nents of the locations associated with variables disap pearing during the marginalization process.\nThe above theorem suggests the following algorithm for marginalization.\nMarginalizing in Undirected Graph and Hypergraph Models 73\nAlgorithm 1 Marginalization\nInput: A graph Q = (V, E) and a subset A C V. Output: A graph 9:4w = (A, E1,;:a) such that the A marginal of the graphical model associated with the graph Q factorizes according to 9:4w. Step 1: Obtain the set E IA (edges in QA)\u00b7 Step 2: Obtain the subgraph 9v\\A. Step 3: Obtain connectivity components T of QV\\A\u00b7 Step 4: Determine the set bd( r) in Q for each r E T. Step 5: Obtain the completed edge sets E*(bd(r)) for each rET.\nStep 6: Return the graph QA'a = (A,EA'a) where EA'a is the union of E I A and UTETE*(bd(r)). \u2022\nExample 5 Assume the graph Q = (V, E), where v = {VI, Vz, V3, V4, Vs, V6} E = {(VI, Vz), (Vz, V3), (V4, V5), (V5, V5)}\nand the set A= {VI, V3, V5}. If we apply the Algorithm 1, we obtain:\nStep 1: E IA = 0. Step 2: 9v\\A = { {Vz, V4, V5}, 0}.\nStep 3: T = { TI, rz, r3} = { {Vz}, {V4}, {VG} }.\nStep 4: bd(ri) = {VI, %}, bd(rz) = {V5}, bd(r3) = {V5}. Step 5: E*(bd(ri)) = {(VI, V3)}, E*(bd(rz)) = 0, E*(bd(r3)) = 0. Step 6: We return the graph QA' = (A, EA') = {{VI, V3, V5}, {(VI, V3)} }. Assume that now we add the edge (VI, V3) to E. If we apply the Algorithm 1, we obtain:\nStep 1: E IA = { {VI, V3}}. Step 2: 9v\\A = { {Vz, V4, V5}, 0}.\nStep 3: T = { TI, rz, r3} = { {Vz}, {V4}, {V5}}.\nStep 4: bd(ri) = {VI, V3}, bd(rz) = {V5}, bd(r3) = {V5}. Step 5: E*(bdh)) = {(VI, V3)}, E*(bd(rz)) = 0, E*(bd(r3)) = 0. Step 6: We return the graph QA' =(A, EA') = {{VI, V3, V5}, {(VI, V3)} }. \u2022 Note that in both cases we obtain the same marginal graph.\n4 THE MARGINAL OPERATOR\nFOR HYPERGRAPHS\nIn this section we analyze the marginalization problem in hypergraphs models.\nTo this aim we use the following theorem, where we state the potential U A corresponding to the family of marginal distributions P! in terms of the changes suf fered by the original potential U restricted to the set A. From the proof of theorem 1 we have seen the role of the connectivity components r of the subgraph 9v\\A. In fact, we could call their contributions to the marginal potential U A the innovations of the poten tial U. They can be computed for each B <;;;;A as the double sum\nVf(b) = L L ( -1)IB\\EIUJ)(e, OD\\E) (13) B\ufffdDE'H'' E\ufffdB if there is D in 'HA including B, (B =f. 0), and 0 oth erwise, where\nwith\nU})(d) = L ubd(TJ(d), (14) T:bd(T)=D\nubd(T)(d) = -ln(/ exp( - L Uc(c)))dvT. (15) C:CnT#0\nNow, we shall state without proof the following the orem (Sanmartin (1997)) for the parametric potential ue of a hypergraph model, where we add the e super script to all the functions derived from ue whenever we want to emphasize their parametric character.\nTheorem 2 (The marginalization theorem for interaction hypergraphs). Consider a parametric family of Gibbs models over V, with interaction func tions hypergraph 'H, and P! be the corresponding fam ily of marginal distributions over A. Then, the inter action function hypergraph 'HA of the family P! can be expressed as:\n(16)\nwhere\n1. 'HI A is the restriction of 'H to A, that is, the set of elements in 'H which are subsets of A.\n2. H1 is the family of subsets B <;;;; A not in 'HIA and such that 8Vf(b) is a non-null function for some e. (These are the new complete sets that will appear after marginalization).\n3. 'H\"A is the set of complete sets in 'HIA such that they are subsets of some set in 'HA and satisfy the equation:\n(17)\n(These are the complete sets that will disappear after marginalization).\nThe decomposition of 'HA above, exhibits the neces sary and sufficient conditions for graphical and para metric collapsibility. It becomes apparent from (16) that the graph Q('HA) associated with the marginal\n74 Castillo, Ferrandiz, and Sanmartin\nhypergraph coincides with the subgraph Q(H)A Q(HIA) iff H\ufffd \ufffd HIA and (HA. = 0 or HA. -< (HIA \\ HA.)). If, in addition, we require parametric collapsibility (UIA = UA), that is, the marginalizing operation not to change the interaction functions involving variables in A, the necessary and sufficient condition becomes that all innovations Vf(b) in (13) be null. This theorem suggests the algorithm below for marginalizing a hypergraph. In it we clarify the mean ing of the sets and functions appearing in Expressions (13) and (15) , which are not easy to understand. With the same purpose we also include a simple example.\nAlgorithm 2 Marginalization of Hypergraphs.\n\u2022 Input: A set V , a parametric family of normal ized potentials U8 over V , and a subset A c V.\n\u2022 Output: The A-marginal potential 8UA, to gether with its associated hypergraph HA and graph Q(HA)\u00b7 Step 1: Obtain the hypergraph H associated with the given potential U. Step 2: Obtain the graph Q(H) associated with the hypergraph.\nStep 3: Determine the connectivity components of the subgraph associated with V \\ A. Step 4: Obtain the boundary hypergraph HA, as the collection of the boundaries in Q(H) of the connectivity components of V \\ A. Step 5: For each element BE HA and each T verifying bd(r) =Bin (15) calculate the functions UJ3(b) . Step 6: For each element BE HA calculate the func tions U'B(b) (see (14) ) . Step 7 : Using (13) , calculate Vf(b) for each non-void subset B of the sets in HA. Step 8: Calculate the A-marginal potencial UA by adding V A to the initial potential U restricted to A. Step 9: Obtain the hypergraph HA associated with uA. Step 10: Obtain the graph Q(HA) associated with uA.\n\u2022\nExample 6 Assume the set\nv = {V1, Vz, V3, V4, V5, %}, of binary (0, 1) variables, the normalized potential\nwith\nand the V -subset A= {V1, V3, V5}. Step 1: The hypergraph H associated with the given potential U is\nH = { {Vz}, {V1, Vz}, {Vz, V3}, {V4, V5}, {V5, V6} }.\nStep 2: The graph associated with the hypergraph is given in Figure 2( a)\nStep 4: Since the boundaries of the connectivity com ponents are bd(r1) = {V1, V3}, bd(rz) = {V5} and bd(r3) = {V5}, the boundary hypergraph is HA = { {Vl, V3}, {V5}}, which is shown in Figure 2(b) (sets in dotted regions).\nStep 5: For the first element {V1, V3} (see (15)): UT' -{V,,V3}\nV2=l\n- ln( L exp{ -a12v1 vz - a12v2 - az3v2v3})\nand for the second {V5}: V4=l\nU{\ufffdd = - ln( L exp{ -a45V4V5} ),\nVG=l U{{r5} = -In( L exp{ -as6VsVG})\nVG=O\nStep 6: For the first element {V1, V3} we have (see (14):\nU* - UT' {V1,V3} {V,,Vg} V2=l\n= -ln( 2:: exp{ -a1zv1 Vz - a12vz - a23v2v3}) V2=0\nMarginalizing in Undirected Graph and Hypergraph Models 75\nand for the second:\nU* UT2 + UT3 {Vo} {Vs} {V5} v4= 1 -ln( 2::; exp{-c:t45V4v5})\n1!4=0 vs=l\n-ln( 2::: exp{ -CY56V5VG} ). 1!6=0\nStep 7: Since the non-void subset of the sets in HA = { {V1, V3}, {V5}} are\n{V1},{V3},{Vt,V3},{V5}, we have:\n\u2022 For {Vl}: V(vd(v1) is\n-ln( exp{ -c:t1zv1 - c:t12} + 1) + ln(exp( -Ctlz) + 1).\n\u2022 For {113}: V(v3}(v3) is\n-ln(exp{ -az3v3- c:t1z} + 1) + ln(exp{ -c:t12} + 1) .\n\u2022 For {V1, V3}: V{\u00b7t,v3}(Vt, v3) is\n-ln (exp{ -c:t12V1- c:tz3V3- c:t12} + 1) + ln ( exp{ -c:t1zv1 - c:t12} + 1) + ln ( exp{ -az3v3 - c:t12} + 1) -ln{ exp( -c:ttz) + 1 }.\n\u2022 For{V5}: V(\ufffdr5}(v5) is\n-ln (exp{ -c:t45v5} + 1) + ln 2 -ln (exp{ -c:t56v5} + 1) + ln2 .\nStep 8: Since the potential U restricted to A is void, the potential uA reduces to Vf(b). Due to the fact that we are interested in the non-null interaction functions we must check whether the can didate functions are non-null. How ever, the following equation:\nhas only the trivial solutions c:t12 = 0 or c:t23 = 0 that contradict the assumption (18). Thus, UA becomes:\n{V(t!} (vt), V{ta} ( V3), V{t,,v,} (vt, V3), V{t5} (v5)}.\nStep 9: The marginal hypergraph becomes:\n'HA = { {V1}, {113}, {V1, V3}, {V5} }.\nStep 10: Finally, the associated marginal graph is\nQ(7-{A) = ( {V1, V3, V5}, {(V1, V3)} ).\nStep 11: Return uA, 'HA and Q(HA)\u00b7\nNote that we have obtained the same solution as with the undirected graph algorithm (see Step 6 in Example 5 ) . However, if the potential U includes the interaction function c:t13V1 v3, as follows: U = { CY12V2, c:t12V1 Vz, CY13V1 V3, etz3V2V3, CY45V4V5, CY55V5V6}, the following steps above suffer changes:\nModified Step 1: The hypergraph 7-{ associated with the given potential U is\n{ {Vz}, {V1, Vz}, {V1, V3}, {Vz, 113}, {V4, V5}, {V5, V6} }.\nModified Step 2: The graph associated with the hy pergraph is given in Figure 3(a). Note that a new edge appears connecting vl and v3.\nFigure 3: (a) Graph associated with the hypergraph in Example 6 showing the connectivity components 7I, 72, 73 of the sub graph associated with V \\ A, and (b) boundary hypergraph 1-{A (sets in dotted regions).\nModified Step 8: Since we are interested in the non null interaction functions we must check whether the candidate functions are non-null.\nWe have the following cases:\nCase 1: The interaction function in v1 and v3 becomes null:\nV{t,,Va}(Vl, V3) + CY13V1V3 = -ln ( exp{ -c:ttzVt - c:t23V3 - c:t12} + 1)\n+ ln ( exp{ -a12v1 - c:t12} + 1) + ln ( exp{ -az3V3 - c:t12} + 1) -ln{ exp( -Cttz) + 1} + Ctt3Vt v3 = 0\nwhich implies\nc:t13 = ln (exp{-2c:tlz- Ctz3}+1) -ln (exp{ -2c:tlz} + 1) -In ( exp{ -Ctz3 - c:t12} + 1) +ln{ exp(-c:ttz) + 1}.\n(19)\nThus, Case 1 refers to the family of Gibbs models sat isfying (19).\nThen we have\nUA = {V{t,}(vt), V{ta}(v3), Vfts}(vs)}.\n76 Castillo, Femindiz, and Sanmartin\nCase 2: Otherwise, since the potential U restricted to A is { et13v1 V3}, the potential U A becomes\nUA = {V{td(vr), 1jt1}(v3), V({,-1.v1}(vl,v3) +cx13v1v3, V{v.,}(vs)}.\nModified Step 9: The marginal hypergmph becomes:\nCase 1: 'HA = {{VI}, {V3}, {V5} }. Case 2: 'HA = {{Vl},{V3},{V1, V:,},{1/5}}. Modified Step 10: Finally, the associated marginal gmph is\nCase 1: Q(HA) =({VI, V3, V5},0}).\nCase 2: Q(HA) = ({VI, V:,, Vs}, { (Vl, V3)} ) . \u2022\nLet 9'Aa and Q(HA) be the marginal graph (algorithm 1) , and the graph associated with the marginal hy pergraph (algorithm 2) , for the subset of variables A, respectively. Then, from Examples 5 and 6 we can conclude:\n1. In case the edge (V1, V3) is not in 9 = Q('H), then (VI, V3) is an edge of both 9'Aa and Q('HA)\u00b7 2. In case the edge (VI, V3) is in 9 = 9(H), then (V1, V3) is an edge of 9'Aa, but, if condition (19) applies, it is not and edge of 9(HA).\nThe absence of (VI, V3) as an edge of a graph over A = {Vr, V3, 115} implies the stochastic independence of both variables conditioned to V5. This independence statement is included in the model which has (VI, V3) as an edge of Q(H) and verifies (19) . This shows that, in this case, the undirected graph representation of the model is not able to capture this separating statement while the hypergraph model is.\n5 EXAMPLE OF APPLICATION\nIn this example, the objective is to assess the damage of reinforced concrete structures of buildings. This ex ample, which is taken from Liu and Li (1994) (see also Castillo, Gutierrez, and Hadi (1997) ) , is slightly mod ified for illustrative purposes. The goal variable (the damage of a reinforced concrete beam) is denoted by X I\u00b7 A civil engineer initially identifies 16 variables (Xg, . . . , X24) as the main variables influencing the damage of reinforced concrete structures. In addition, the engineer identifies seven intermediate unobservable variables (X2, \u2022 \u2022 . , X8) that define some partial states of the structure. Table 1 shows the list of variables and their definitions.\nIn our example, the engineer specifies the following cause-effect relationships, as depicted in Figure 4(a) . The goal variable X I, is related primarily to three fac tors: X9, the weakness of the beam available in the form of a damage factor; X10, the deflection of the beam; and X2, its cracking state. The cracking state,\nx2, is related to four variables: x3, the cracking state in the shear domain; X6, the evaluation of the shrink age cracking; X4, the evaluation of the steel corro sion; and X5, the cracking state in the flexure domain. Shrinkage cracking, XG, is related to shrinkage, x23, and the corrosion state, X8. Steel corrosion, X4, is related to X8, X24, and X5. The cracking state in the shear domain, X3, is related to four factors: Xu, the position of the worst shear crack; xl2, the breadth of the worst shear crack; X21, the number of shear cracks; and Xs. The cracking state in the flexure domain, X5 is affected by three variables: XI3> the position of the worst flexure crack; X22, the number of flexure cracks; and X7, the worst cracking state in the flexure domain. The variable X13 is influenced by X4. The variable X7 is a function of five variables: x14, the breadth of the worst flexure crack; X15, the length of the worst flex ure crack; X 16, the cover; X 17, the structure age; and Xs, the corrosion state. The variable X8 is related to three variables: X18, the humidity; XI9, the PH value in the air; and X2o, the content of chlorine in the air. A graphical representation of the damage problem is shown in Figure 4( a) .\nSuppose that we are interested in suppressing all the nodes related to the flexion of the beam and keep the remaining nodes (Set A), that is (see Figure 4(b) ) :\nv \\A= {Xs, X1, X13, X14, X1s, X15, X17, X22, X23}.\nMarginalizing in Undirected Graph and Hypergraph Models 77\nFigure 4: (a) Undirected graph representing the variable relations for the damage assessment of reinforced concrete structure, and (b) sets A, V \\A, and subgraphs associated with A and V \\A (continuous edges only).\n5.1 GRAPH APPROACH\nIn this case, to marginalize over A, we can apply Al gorithm 1.\nFigure 5: (a) Set V \\A with its conectivity components and their completed boundaries (doted regions), and (b) the resulting marginal graph 9A' on A.\nStep 1: The set E\\A, that is, the set of edges in the subgraph Q A is shown in Figure 4(b) (the continuous edges in the region A).\nStep 2: The subgraph 9v\\A appears in Figure 4(b) (region A with continuous edges) .\nStep 3: The connectivity components T of 9v\\A: T1 {X5, X7, X13, X14, X15, X16, X11, Xzz, }; Tz {Xz3},\nare shown in Figure 5(a) as white regions.\nStep 4: The boundaries of the two connectivity com ponents are bd(Tl) = {Xz, x4, Xs} and bd(Tz) = {X6}, as shown in Figure 5(a) where they have been shad owed with dots.\nStep 5: To complete the set bd( Tl) we need to add the edge (X2, X8) to the already two existing edges\n(Xz, X4) and (X4, Xs). Step 6: We return the graph in Figure 5(b) , which incorporates the edge (X2, X8) to the subgraph QA, thus, showing that the graph A is not collapsible with respect to A. I\n5.2 HYPERGRAPH APPROACH\nWhen applying algorithm 2, the differences with the preceding results could only appear in the bound aries of the connectivity components of V \\ A, that. is, bd(Tl) = {Xz, X4, Xs} and bd(Tz) = {XG}. The non-null innovations (13) could only arise for subsets of variables contained in these sets. As bd( Tz) has only one variable, our problem of exploring possible differ ences between QAw and Q('HA) reduce to those edges connecting variables in bd( T1). To illustrate, let us assume a Gaussian distribution with mean f1 and dispersion matrix 2: for the 24 vari ables in V . To express this distribution as a hypergraph model, it is easier to work with the precision matrix Y = 2:-1. In fact its pdf can be written as p(v) ex exp ( -\ufffd(v-f.I)'Y(v- !1)) ex exp ( .Z:::i vi ( \ufffd .z=j Yijf.Ij) - .z=i#j \ufffd Y ijViVj) (20)\ncorresponding to expression ( 1) with normalized po tential. Equation (20) shows the relationship between edges in Q and non null elements of the matrix Y. It is a well known fact. that the marginal distribution of a multivariate Gaussian model is again multivariate Gaussian, with precision matrix\nyA = YAA- YA,v\\A(Yv\\A,V\\A)-1Yv\\A,A, (21) where the subscripts of Y stand for the appropriate partition.\nEquation (21) shows the decomposition of the preci sion matrix yA related to the marginal normalized po tential UA in two components:\n(i) the matrix Y A,A corresponding to the restricted potential U\\A, and\n(ii) the matrix fA= Y A,V\\A(YV\\A,V\\A)1Yv\\A,A\ncorresponding to innovations V f (b) of ( 13). In particular, the innovation (13) for two variables Vi and Yj in A is\nV(tr,,v;}(vi,vj) i rv r,j rv s\n(22) where Prs stands for the rs-element of matrix (Yv\\A,V\\A)-1 and i rv r indicates that node i is di rectly connected to node r in the associated graph Q. Particularizing to our example, the only edges sub ject to change when applying Algorithm 2 are {(Xz,X4), (Xz, Xs), (X4, Xs)}.\n78 Castillo, Femindiz, and Sanmartin\nThe edge (X2, X8), which was not present in the orig inal graph Q, arises as a consequence of the innovation [\ufffd8 = P5.7 12,51 7.8, and it is null only if (J;,.7 vanishes. iviatrix 1, being a precision matrix, is definite posi tive, implying D = 1 V\\A. V\\A I > 0. After some alge bra, P5,7 can be written as 113,13114,14115.15116.16117,17122.2212,515,717,8/ D\nwhich cannot be null unless one or more of the pa rameteres 1 2,5, 15,7 and 17,8 vanish. But this would contradict the initial specification of Q. Then, the edge (X2, X8) will always be present in gAw and Q(1iA)\u00b7 Conditions for (X2, X4) and (X4, X8) to disappear in Q('HA) are 12,4 = f2.4 and 14.8 = f4.8 , respectively. They state functional relationships between the pa rameters 12,4, 14,8 and those in 1 V\\A, V\\A. These relationships are compatible with the initial graph Q. Thus, the marginal graphs QA'a and Q(HA) could dif fer in edges (X2, X4) and (X4, X8), according to these conditions.\nThus, the example illustrates clearly the advantages of hypergraph models over the usual graph models.\n6 CONCLUSIONS AND\nRECOMMENDATIONS\nHypergraph models have been shown to be a power ful alternative to undirected graph models. The main advantage consists of its capability to produce finer factorizations and to catch a more complete set of con ditional independence statements. Given a set of vari ables and an undirected graph or hypergraph model, two algorithms have been given for obtaining the cor responding marginal graph and hypergraph, such that the marginal distribution factorizes according to them. The examples have shown that in some cases the hy pergraph is able to capture conditional independence statements that the graph fails to detect. In addition, theorem 2 states a general framework to understand the necessary and sufficient conditions of graphical and parametric collapsibility.\nAcknowledgments\nThe authors are grateful to Iberdrola, the U niversi ties of Cantabria, Jaume I and Valencia, and the Di reccion General de Investigacion Cientifica y Tecnica (DGICYT) (projects TIC96-0580 and PB96-0776) for partial support of this research.\nReferences\n[1] Asmussen, S. and Edwards, D. , (1983) . Collapsi bility and response variables in contingency ta bles. Biometrika, 70, 567-578.\n[2] E. Castillo, J.M. Gutierrez, and A.S. Hadi, (1997) . Expert Systems and Pmbabilistic Network\nModels. Springer Verlag, New York.\n[3] Darroch, J. N. , Lauritzen, S. L. , and Speed, T. P. (1980) , Tvlarkov Fields and Log-linear Models for Contingency Tables. Annals of Statistics, 8: 522- 539.\n[4] Frydenberg, M. (1990) , Marginalization and col lapsibility in graphical interaction models Annals of Statistics, 18: 790-805.\n[5] Isham, B. (1981) , An Introduction to Spatial Point Processes and Markov Random Fields. In ternational Statistical Review, 49:21-43.\n[6] Lauritzen, S. L. (1989) , Lectures on Contingency Tables, 3rd edition. Aalborg University Press, Aalborg, Denmark.\n[7] Lauritzen, S.L. (1996) , Graphical Models. Oxford University Press, Oxford Statistical Science Se ries, Vol 17.\n[8] Liu, X. and Li, Z. (1994) , A Reasoning Method in Damage Assessment of Buildings. Micmcom puters in Civil Engineering, Special Issue on Un certainty in Expert Systems, 9: 329-334.\n[9] Mellouli, K. (1987) , On the Propagation of Belief Networks Using the Dempster-Shafer Theory of Evidence. Ph. D. Dissertation, School of Business, University of Kansas.\n[10] Wermuth, N. and Lauritzen, S. L. (1983) , Graphi cal and Recursive Models for Contingency Tables. Biometrika, 70: 537-552.\n[11] Pearl, J. and Paz, A. (1987) , Graphoids: A Graph-Based Logic for Reasoning about Rele vance Relations. In Boulay, B. D. , Hogg, D., and Steels, L. , editors, Advances in Artificial Intelligence-II. North Holland, Amsterdam, 357- 363.\n[12] Rose, D. J. (1970) , Triangulated Graphs and the Elimination Process. Journal of Math. Anal. Appl. 32, 597-609.\n[13] Tarjan, R. and Yannakakis, M. (1984) , Sim ple linear- time algorithms to test chordality of graphs, test acyclicity of hypergraphs, and selec tively reduce acyclic hypergraphs. SIAM Journal of Computing, 13(3) .\n[14] Sanmartin, P. (1997) , Agregacion Temporal en Modelos de Grafos Cadena. Ph. D. Thesis, Uni versity of Valencia.\n[15] Shafer, G. and Shenoy, P. (1990) , Probability Propagation. Annals of lVIathematics and Arti ficial Intelligence, 2: 327-352.\n[16] Studeny, IVI. (1994) , On Marginalization, Col lapsibility, and precollapsibility. In V . benes, J. Stepan eds.: Distributions with Given Marginals and Moment Problems, Kluwer, Dordrecht, 191- 198\n[17] Winkler, G. (1995) , Image Analysis, Random Fields and Dynamic Monte Carlo \u00b7Methods. A Matematical Introduction. Springer."}], "references": [{"title": "On the Propagation of Belief Networks Using the Dempster-Shafer Theory of Evidence", "author": ["K. Mellouli"], "venue": "School of Business,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 1987}, {"title": "On Marginalization, Col\u00ad lapsibility, and precollapsibility", "author": ["Studeny", "IVI"], "venue": "In V . benes, J. Stepan eds.: Distributions with Given Marginals and Moment Problems, Kluwer,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 1994}], "referenceMentions": [{"referenceID": 0, "context": "Since the resulting independence graph reveals this lack of sensitivity to detect all independence properties and lack identification of missing n-th ( n > 2) order in\u00ad teractions when second order interactions are present, as an alternative, we use hypergraph models (see Rose [12], Tarjan and Yannakakis [13] , Mellouli [9] , Studeny [16] and Shafer and Shenoy [15] for related problems) .", "startOffset": 322, "endOffset": 325}, {"referenceID": 1, "context": "Since the resulting independence graph reveals this lack of sensitivity to detect all independence properties and lack identification of missing n-th ( n > 2) order in\u00ad teractions when second order interactions are present, as an alternative, we use hypergraph models (see Rose [12], Tarjan and Yannakakis [13] , Mellouli [9] , Studeny [16] and Shafer and Shenoy [15] for related problems) .", "startOffset": 336, "endOffset": 340}], "year": 2011, "abstractText": "Given an undirected graph g or hypergraph 'H model for a given set of variables V , we introduce two marginalization operators for obtaining the undirected graph YA or hy\u00ad pergraph 'HA associated with a given subset A c V such that the marginal distribution of A factorizes according to YA or 'HA, respec\u00ad tively. Finally, we illustrate the method by its application to some practical examples. With them we show that hypergraph models allow defining a finer factorization or performing a more precise conditional independence anal\u00ad ysis than undirected graph models.", "creator": "pdftk 1.41 - www.pdftk.com"}}}