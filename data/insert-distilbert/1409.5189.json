{"id": "1409.5189", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "18-Sep-2014", "title": "Solving Graph Coloring Problems with Abstraction and Symmetry", "abstract": "this paper introduces a methodology that applies to solve graph edge - coloring problems and in particular to prove that the ramsey number $ r ( 4, 3, 3 ) = 30 $. the number $ r ( 4, 3, n 3 ) $ is often presented as the unknown ramsey number with undoubtedly the best chances of being found \" pretty soon \". yet, it has been sought after for more than 50 years. the largely proposed technique is based on two well - studied computing concepts, \\ emph { abstraction } and \\ emph { symmetry }. first, we immediately introduce an abstraction on graph colorings, \\ emph { finite degree matrices }, matrix that will specify the greatest degree of each vertex in each color. we compute, using a polynomial sat solver, an over - approximation of the set of opposite degree matrices of these all solutions of the graph coloring problem. then, for choosing each degree matrix in the over - approximation, we compute, sometimes again using a sat solver, the set of all solutions paired with identical matching degrees. breaking loop symmetries, on degree matrices in the first step evaluation and operations with respect given to graph isomorphism in the second, is cardinal to the success of the approach. we illustrate perhaps two applications : to prove that $ value r ( davenport 4, trees 3, 3 ) = 30 $ and to compute the, previously unknown joseph number, 78 {, } 892, of $ ( graphs 3, 3, 3 ; 13 ) $ ramsey colorings.", "histories": [["v1", "Thu, 18 Sep 2014 04:46:44 GMT  (22kb)", "http://arxiv.org/abs/1409.5189v1", null], ["v2", "Tue, 25 Nov 2014 04:55:43 GMT  (24kb,D)", "http://arxiv.org/abs/1409.5189v2", null], ["v3", "Thu, 26 Mar 2015 06:17:41 GMT  (24kb,D)", "http://arxiv.org/abs/1409.5189v3", null]], "reviews": [], "SUBJECTS": "cs.AI cs.DM", "authors": ["michael codish", "michael frank", "avraham itzhakov", "alice miller"], "accepted": false, "id": "1409.5189"}, "pdf": {"name": "1409.5189.pdf", "metadata": {"source": "CRF", "title": null, "authors": ["Avraham Itzhakov"], "emails": ["mcodish@cs.bgu.ac.il", "frankm@cs.bgu.ac.il", "itzhakoa@cs.bgu.ac.il"], "sections": [{"heading": null, "text": "ar X\niv :1\n40 9.\n51 89\nv1 [\ncs .A\nI] 1\n8 Se\np 20\n14"}, {"heading": "1 Introduction", "text": "This paper introduces a methodology that applies to provide a proof that the Ramsey number r(4, 3, 3) is equal to 30. This is the smallest number n such that any coloring of the edges of the complete graph Kn in three colors will either contain a K4 sub-graph in the first color, a K3 sub-graph in the second color, or a K3 sub-graph in the third color. The value of this number has been sought after for more that 50 years. Kalbfleisch (1966) proved that R(4, 3, 3) \u2265 30, Piwakowski (1997) proved that R(4, 3, 3) \u2264 32, and one year later Piwakowski and Radziszowski (1998) proved that R(4, 3, 3) \u2264 31. We also compute the number, 78,892, of Ramsey (3, 3, 3; 13) colorings. This is the number of colorings of the edges of the complete graph K13 in three colors such that there is no monochromatic K3 sub-graph. It is known that R(3, 3, 3) = 17 and the number of (3, 3, 3;n) for 14 \u2264 n \u2264 16 are known. The number of colorings for n = 13 was previously unknown (Radziszowski 1994).\nSolving hard search problems on graphs, and graph coloring problems in particular, is much about breaking sym-\n\u2217Supported by the Israel Science Foundation, grant 182/13. Computational resources provided by an IBM Shared University Award (Israel).\nmetries in the search space. When searching for a graph, the actual names of the vertices do not matter, and restricting the search modulo graph isomorphism is highly beneficial. When searching for a graph coloring, on top of graph isomorphism, solutions are typically closed under permutations of the colors: the actual names of the colors do not matter and the term often used is \u201cweak isomorphism\u201d (Piwakowski and Radziszowski 1998) (the equivalence relation is weaker because both node names and edge colors do not matter). When the problem is to compute the set of all solutions modulo (weak) isomorphism, or to count them, the task is even more challenging. Often times, one first attempts to compute all of the solutions, and to then apply one of the available tools, such as nauty (McKay 1990), to select the non-isomorphic graphs from within this set. This approach is doomed to fail when the number of (weak) isomorphic solutions is huge.\nIn the paper we present a two step methodology towards solving hard graph coloring problems. We apply this approach to compute the previously unknown set of Ramsey colorings R(3, 3, 3; 13), modulo weak isomorphism, of the complete graph K13. More important, we apply it to prove that the Ramsey number R(4, 3, 3) is equal to 30.\nIn the first step, we describe the solutions of a graph coloring problem in terms of an abstraction, which we call degree matrices, that focuses on the degrees of vertices in each color. We compute, using a SAT solver, an overapproximation, a super-set M, of the set of degree matrices of all solutions of the graph coloring problem. Already in this step we obtain new results for Ramsey coloring problems which are presented as Lemma 2 and 3.\nIn the second step, for each degree matrix M in the overapproximation M, we show how to compute the set of all solutions of the graph coloring problem which have a degree matrix matching M .\nSolving a graph coloring problem, using an overapproximation, M, of the degree matrices in its solutions, has three key advantages: (1) It breaks the coloring problem into a set of independent sub-problems, one sub-problem for each M \u2208 M. These sub-problems can then be solved in parallel. (2) It directs the search: solving the (graph coloring) problem given some properties (the degree matrix) of its solutions helps guide the solver through the search space. (3) It facilitates symmetry breaking: degree matri-\nces are isomorphic under renamings of colors and of graph vertices. And, already in the first step, we take advantage of this to break many of the symmetries in the coloring problem. Also, in the second step, seeking solutions given a degree matrix boosts symmetry breaking.\nThroughout the paper we express graph coloring problems in terms of constraints adopting a \u201cmathematical language\u201d to express these. Our implementation uses the BEE, finite-domain constraint compiler (Metodi, Codish, and Stuckey 2013), which solves constraints by encoding them to CNF and applying an underlying SAT solver. The solver can be applied to find a single (first) solution to a constraint, or to find all solutions for a constraint modulo a specified set X of variables. In the case for all solutions, the underlying SAT solver is incremental and this plays an important role. The solver iterates, finding the next solution (different in the values of the variables in X), and then adding a clause to specify that subsequent solutions must differ in their assignment to variables in X . In our configuration, instances are solved using CryptoMiniSAT (Soos 2010) as the underlying SAT solver. All computations were performed on a cluster with a total of 168 Intel E8400 cores clocked at 2 GHz each, able to run 336 parallel threads.\nGent and Smith (2000) building on the work of Puget (1993), study symmetries in graph coloring problems and recognize the importance of breaking symmetries during search. Meseguer and Torras (2001) present a framework for exploiting symmetries to heuristically guide a depth first search, and show promising results for (3, 3, 3;n) Ramsey colorings with 14 \u2264 n \u2264 17. Al-Jaam (2007) proposes a hybrid metaheuristic algorithm for Ramsey coloring problems, combining tabu search and simulated annealing. While all of these works report promising results, still, to the best of our knowledge, none of them have been successfully applied to solve open instances or improve the known bounds on classical Ramsey numbers. Our approach focuses on symmetries due to weak-isomorphism for graph coloring and models symmetry breaking in terms of constraints introduced as part of the problem formulation. This idea advocated by Crawford et al. (1996) has previously been explored in (Codish et al. 2013) (for graph isomorphism), and in (Puget 1993) (for graph coloring).\nGraph coloring has many applications in computer science and mathematics, such as scheduling, register allocation and synchronization, path coloring and sensor networks. Specifically, many finite domain CSP problems have a natural representation as graph coloring problems."}, {"heading": "2 Preliminaries", "text": "An (r1, . . . , rk;n) Ramsey coloring is an assignment of one of k colors to each edge in the complete graph Kn such that it does not contain a monochromatic complete sub-graph Kri in color i for 1 \u2264 i \u2264 k. The set of all such colorings is denoted R(r1, . . . , rk;n). The Ramsey number R(r1, . . . , rk) is the least n > 0 such that no (r1, . . . , rk;n) coloring exists. In the multicolor case (k > 2), prior to this paper, the only known value of a nontrivial Ramsey number is R(3, 3, 3) = 17. The value of R(4, 3, 3) was previously known to be equal either to 30 or to 31. The num-\nbers of (3, 3, 3;n) colorings are known for 14 \u2264 n \u2264 16 but prior to this paper the number of colorings for n = 13 was unknown. More information on recent results concerning Ramsey numbers can be found in the electronic dynamic survey by Radziszowski (1994).\nIn this paper, graphs are always simple graphs: undirected and with no self loops. Colors are associated with graph edges. For a natural number n denote [n] = {1, 2, . . . , n}. A graph coloring, in k colors, is a pair (G, \u03ba) consisting of a simple graph G = ([n], E) and a mapping \u03ba : E \u2192 [k]. When \u03ba is clear from the context we refer to G as the graph coloring. The sub-graph of G induced by the color c \u2208 [k] is the graph Gc = ([n], { e \u2208 E | \u03ba(e) = c }). We typically represent G as an n \u00d7 n adjacency matrix, A, defined such that\nAi,j =\n{\n\u03ba(i, j) if (i, j) \u2208 E 0 otherwise\nIf A is the adjacency matrix representing the graph G, then we denote the Boolean adjacency matrix corresponding to Gc as A[c]. We denote the ith row of a matrix A by Ai. The color-c degree of a node x in G is denoted degGc(x) and is equal to the degree of x in the induced sub-graph Gc. When clear from the context we write degc(x). Let G = ([n], E) and \u03c0 a permutation on [n]. Then \u03c0(G) = (V, { (\u03c0(x), \u03c0(y)) | (x, y) \u2208 E }). Permutations apply also to adjacency matrices in the natural way: If A is the adjacency matrix of a graph G, then \u03c0(A) is the adjacency matrix of \u03c0(G).\nA graph coloring problem is a formula \u03d5(A) where A is an n\u00d7n adjacency matrix of integer variables together with a set (conjunction) of constraints \u03d5 on these variables. A solution is an assignment of integer values to the variables in A which satisfy \u03d5 and determine both the graph edges and their colors. We often refer to a solution as an integer adjacency matrix and denote the set of solutions as sol(\u03d5(A)). Figure 1 illustrates the two graph coloring problems we fo-\ncus on in this paper: (3, 3, 3;n) and (4, 3, 3;n) Ramsey colorings. In Constraint (1), \u03d5n,kadj , states that the graph has n vertices, is k colored, and is simple (symmetric, and with no self loops). In Constraints (2) and (3), \u03d5n,cK3 and \u03d5 n,c K4\nstate that the n vertex graph has no embedded sub-graph K3 and respectively K4 in color c. In Constraints (4) and (5), the formulas state that a graph is an (3, 3, 3;n) and respectively a (4, 3, 3;n) Ramsey coloring.\nFor graph coloring problems, solutions are typically closed under permutations of vertices and of colors. Restricting the search space for a solution modulo such permutations is a crucial when trying to solve hard graph coloring problems. It is standard practice to formalize this in terms of graph (coloring) isomorphism.\nDefinition 1 ((weak) isomorphism of graph colorings). Let (G, \u03ba1) and (H,\u03ba2) be k-color graph colorings with G = ([n], E1) and H = ([n], E2). We say that (G, \u03ba1) and (H,\u03ba2) are weakly isomorphic, denoted (G, \u03ba1) \u2248 (H,\u03ba2) if there exist permutations \u03c0 : [n] \u2192 [n] and \u03c3 : [k] \u2192 [k] such that (u, v) \u2208 E1 \u21d0\u21d2 (\u03c0(u), \u03c0(v)) \u2208 E2 and \u03ba1(u, v) = \u03c3(\u03ba2(\u03c0(u), \u03c0(v))). When \u03c3 is the identity permutation, (i.e. \u03ba1(u, v) = \u03ba2(\u03c0(u), \u03c0(v))) we say that (G, \u03ba1) and (H,\u03ba2) are isomorphic.\nThe following lemma emphasizes the importance of weak graph isomorphism as it relates to Ramsey numbers. Many classic coloring problems exhibit the same property.\nLemma 1 (R(r1, r2, . . . , rk;n) is closed under \u2248). Let (G, \u03ba1) and (H,\u03ba2) be graph colorings in k colors such that (G, \u03ba) \u2248 (H, \u03b7). Then (G, \u03ba) \u2208 R(r1, r2, . . . , rk;n) \u21d0\u21d2 (H, \u03b7) \u2208 R(r1, r2, . . . , rk;n).\nProof. Assume that (G, \u03ba) \u2208 R(r1, r2, . . . , rk;n) and (G, \u03ba) \u2248 (H, \u03b7). Let \u03c0 : [n] \u2192 [n] and \u03c3 : [k] \u2192 [k] such that Definition 1 holds. Assume in contradiction that (H, \u03b7) /\u2208 R(r1, r2, . . . , rk;n) and denote R a monochromatic clique of size rs in H . Denote R\u22121 the inverse of R in G under \u03c0 and \u03c3. From Definition 1 we know that (u, v) \u2208 R \u21d0\u21d2 (\u03c0\u22121(u), \u03c0\u22121(v)) \u2208 R\u22121 and that \u03b7(u, v) = \u03c3\u22121(\u03ba(u, v)). Consequently R\u22121 is a monochromatic clique of size rs in (G, \u03ba) in contradiction to (G, \u03ba) \u2208 R(k1, k2, . . . , kr;n).\nCodish et al. introduce in (2013) an approach to break symmetries due to graph isomorphism (without colors) during the search for a solution. Their approach involves adding a symmetry breaking predicate sb\u2217\u2113 (A) on the variables of the adjacency matrix, A. All of their results hold also for graph coloring problems where the adjacency matrix consists of integer variables (the proofs are basically the same).\nDefinition 2. (Codish et al. 2013). Let A be an n \u00d7 n adjacency matrix. Then,\nsb\u2217\u2113 (A) = \u2227\ni<j\nAi {i,j} Aj\nwhere s {i,j} s\u2032 is the lexicographic order on s and s\u2032 after simultaneously omitting the elements at positions i and j.\nTable 1 illustrates the impact of the symmetry breaking technique introduced by Codish et al. in (2013) on the search for (3, 3, 3;n)Ramsey colorings. The column headed by \u201c#\\\u2248\u201d specifies the known number of colorings modulo weak isomorphism (Radziszowski 1994). The two columns headed by \u201csize\u201d indicate the number of CNF clauses encoding the coloring problem with and without the symmetry breaking constraint. The two columns headed by \u201ctime\u201d indicate the time (in seconds, on a single core of the cluster) to find all colorings iterating with a SAT solver. The timeout assumed here is 24 hours. The column headed by \u201c#\u201d specifies the number of colorings found when solving with the symmetry break. These include also colorings which are weakly isomorphic, but far less than the hundreds of thousands generated without the symmetry break (up till the timeout).\nTable 1 illustrates that the approach of Codish et al. does not apply to compute R(3, 3, 3; 13). Likewise, it does not apply to compute R(4, 3, 3). To prove that R(4, 3, 3) = 30 we make use of the following results from (Piwakowski and Radziszowski 1998).\nTheorem 1. 30 \u2264 R(4, 3, 3) \u2264 31 and, R(4, 3, 3) = 31 if and only if there exists a (4, 3, 3; 30) coloring \u03ba of K30 such that: (1) For every vertex v, 5 \u2264 deg1(v), deg2(v) \u2264 8, and 13 \u2264 deg3(v) \u2264 16. (2) Every edge in the third color has at least one endpoint v with deg3(v) = 13. (3) \u03ba has at least 25 vertices v such that deg1(v) = deg2(v) = 8 and deg3(v) = 13."}, {"heading": "3 Degree Matrices for Graph Colorings", "text": "We introduce an abstraction on graph colorings defined in terms of degree matrices and an equivalence relation on degree matrices. Our motivation is to solve graph coloring problems first focusing on an over approximation of their degree matrices. The equivalence relation on degree matrices enables us to break symmetries during search when solving graph coloring problems.\nDefinition 3 (abstraction, degree matrix). Let A be a graph coloring on n vertices with k colors. The degree matrix of A, denoted \u03b1(A) is an n \u00d7 k matrix, M such that Mi,j = degj(i) is the degree of vertex i in color j. For a set A of graph colorings we denote \u03b1(A) = { \u03b1(A) | A \u2208 A }.\nA degree matrix, M , represents the set of graphs, weaklyisomorphic to a graph with degrees as in M . We say that two\ndegree matrices are equivalent if they represent the same sets of graph colorings.\nDefinition 4 (concretization and equivalence). Let M and N be n \u00d7 k degree matrices. Then, the set of graph colorings represented by M is \u03b3(M) = { A | A \u2248 A\u2032, \u03b1(A\u2032) = M } and we say that M \u2261 N \u21d4 \u03b3(M) = \u03b3(N). For a set M of degree matrices we denote \u03b3(M) = \u222a{ \u03b3(M) | M \u2208 M }.\nDue to properties of weak-isomorphism we can exchange both rows and columns of a degree matrix without changing the set of graphs it represents. In our construction we will break symmetries only on rows because in a later phase we break symmetries on the colors. So, we require the rows of the degree matrix to be sorted.\nDefinition 5 (lex sorted degree matrix). For an n \u00d7 k degree matrix M we denote by lex(M) the matrix obtained by sorting the rows of M in the lexicographic order (nonincreasing).\nThe following states that for degree matrices we can assume without loss of generality that rows are lexicographically ordered.\nTheorem 2. If M , N are degree matrices then M \u2261 N if and only if there exists permutations \u03c0 : [n] \u2192 [n] and \u03c3 : [k] \u2192 [k] such that Mi,j = N\u03c0(i),\u03c3(j).\nProof. For a permutation \u03c3 : [k] \u2192 [k], denote by \u03c3(M) the matrix M \u2032i,j = Mi,\u03c3(j). Recall that M \u2261 N \u21d0\u21d2 \u03b3(M) = \u03b3(N), which holds if and only if \u2200G \u2248 H : G \u2208 \u03b3(M) \u21d0\u21d2 H \u2208 \u03b3(N). Let G \u2248 H and let \u03c0 : [n] \u2192 [n] and \u03c3 : [k] \u2192 [k] be the permutations such that Definition 1 holds. This gives that \u03b1(G)i,j = \u03b1(H)\u03c0(i),\u03c3(j). Specifically, if G \u2208 \u03b3(M) such that \u03b1(G) = M and H \u2208 \u03b3(N) such that \u03b1(H) = N then Mi,j = N\u03c0(i),\u03c3(j)\nCorollary 1. M \u2261 lex(M).\nProof. The result follows from Theorem 2 because M and lex(M) are related by a permutation of rows."}, {"heading": "4 Approximating the set of Degree Matrices", "text": "Let \u03d5(A) be a graph coloring problem in k colors on an n\u00d7n adjacency matrix, A, and let A = sol(\u03d5(A)) be the set of its solutions. Our goal is to compute a set M of (sorted) degree matrices such that \u03b3(M) \u2287 A and to then use M to facilitate the search for A. Typically, we compute M as an over-approximation of \u03b1(A). The following constraint specifies the relation between an n\u00d7 n adjacency matrix, A and its corresponding degree matrix, M .\n\u03d5n,kdm(A,M) = \u2227\n1 \u2264 i \u2264 n\n1 \u2264 c \u2264 k\n(\nMi,c =\nn \u2211\nj=1\n(Ai,j = c)\n)\n(6)\nInstead of solving \u03d5(A) for all possible values of A (solutions of the graph coloring problem), we are going to solve \u03d5(A) \u2227 \u03d5n,kdm(A,M) for all possible values of M (degree matrices of solutions of the graph coloring problem). We\nfurther break symmetries in M and in A requiring the rows of M to be sorted and also impose an order on the rows of A.\nsb\u2217\u2113 (A,M) = \u2227\ni<j\n(\n(Mi lex Mj) \u2227 (\nMi = Mj \u21d2 Ai {i,j} Aj )\n)\n(7)\nNote that sb\u2217\u2113 (A,M) is similar to the (partitioned lexicographic symmetry break predicate introduced by Codish et al. in (2013) for Boolean adjacency matrices.\nTo justify that Equation (7) specifies a correct symmetry breaking predicate we must show that whenever it excludes a solution then there is another weakly isomorphic solution that is not excluded. To this end, we introduce a definition and then a theorem.\nDefinition 6. [degree matrix preserving permutation] let A be an adjacency matrix and M a lexicographically ordered degree matrix such that \u03b1(A) = M . We say that permutation \u03c0 is degree-matrix preserving for M and A if \u03b1(\u03c0(A)) = M .\nTheorem 3. [correctness of sb\u2217\u2113 (A,M)] let A be an adjacency matrix and M a lexicographically ordered degree matrix such that \u03b1(A) = M . Then, there exists a degree matrix preserving permutation \u03c0 such that \u03b1(\u03c0(A)) = M and sb\u2217\u2113 (\u03c0(A),M) holds.\nProof. By Corollary 1 we can assume that M is sorted (nonincreasing in the lexicographic order). If the rows of M are distinct, then the theorem holds with \u03c0 the identity permutation. Assume that some rows of M are equal. Denote by P the set of degree matrix preserving permutations for M and A. Assume the premise and in contradiction that no \u03c0 \u2208 P satisfies sb\u2217\u2113 (\u03c0(A),M). Let \u03c0 \u2208 P be such that \u03c0(A) = min { \u03c0\u2032(A) \u2208 P | \u03c0\u2032 \u2208 P } (in the lexicographical order viewing matrices as strings). From the assumption, there exist i < j such that Mi = Mj and \u03c0(A)i 6 {i,j} \u03c0(A)j . Hence there exists a minimal index k /\u2208 {i, j} such that \u03c0(A)i,k > \u03c0(A)j,k . Let A\u2032 be the matrix obtained by permuting nodes i and j in \u03c0(A). Since Mi = Mj it follows that \u03b1(A\u2032) = M thus there is a \u03c0\u2032 \u2208 P such that \u03c0\u2032(A) = A\u2032. If k < i : For 1 \u2264 l < k we have \u03c0(A)l = A\u2032l. Thus k is the first row for which A\u2032 and \u03c0(A) differ. Permuting nodes i and j changes row k by simply swapping elements \u03c0(A)k,i and \u03c0(A)k,j . Since \u03c0(A)k,i > \u03c0(A)k,j , we get that A\u2032k \u227a \u03c0(A)k hence A\n\u2032 \u227a \u03c0(A) in contradiction. Similarly if k > i the same argument applies to show that i is the first row for which A\u2032 and \u03c0(A) differ, thus obtaining the same contradiction for row i.\nCorollary 2. Let A be a graph coloring and M = \u03b1(A). Then there exists an isomorphic graph coloring, A\u2032, such that \u03b1(A\u2032) = M and sb\u2217\u2113 (A \u2032,M) holds.\nThe set of degree matrices for a corresponding graph coloring problem \u03d5(A) is the set of instances of M for which there is a solution to the following constraint.\n\u03d5(A) \u2227 \u03d5n,kdm(A,M) \u2227 sb \u2217 \u2113 (A,M) (8)\nIn the rest of this section, we focus on how to compute an approximationM of the set of degree matrices M for which Constraint (8) is satisfied. This is done in two steps.\nThe first step is about finding (a super-set of) all of the degree sequences in the first color in all solutions of \u03d5(A). Recall that, in graph theory, the degree sequence of a simple graph is the non-increasing sequence of the degrees of its vertices. These are all possible first columns of the degree matrices for solutions of \u03d5(A). We consider two scenarios: (1) where the complexity of \u03d5(A) derives from the large number of solutions, each of which is easy to find; and (2) where the complexity of \u03d5(A) derives from that of finding even a single solution.\nThe first scenario. In case there are many solutions to \u03d5(A), perhaps too many to actually enumerate using existing solvers, then still it is often times feasible to enumerate all possible first columns of the corresponding degree matrices. So, we apply an incremental SAT solver to obtain all different first columns of the degree matrix M which satisfy Constraint (8). For example, computing the set of all (3, 3, 3; 13) Ramsey colorings is difficult due to the very large number of solutions of the corresponding constraints (Piwakowski and Radziszowski 1998). To obtain the set of degree sequences (in the first color) of all solutions we apply this strategy taking \u03d5(A) = \u03d5(3,3,3;13)(A) from Constraint (4). This results in a set of 95 degree sequences and provides a proof for the following lemma. This is a new characterization of the set of Ramsey (3, 3, 3; 13) colorings.\nLemma 2. If G is a Ramsey (3, 3, 3; 13) coloring of K13 then, the degrees of the vertices in the first color correspond to one of the 95 degree sequences depicted in Figure 2.\nThe second scenario. Often times, the graph coloring problem is too hard and incrementally solving Constraint (8) is not feasible. In this case, we can relax the constraint, possibly introducing more solutions. Iterating with an incre-\nmental solver given the relaxed constraint we obtain a superset of the corresponding degree sequences, for the first color, that would have be obtained with the original Constraint (8). For example, the search for a Ramsey (4, 3, 3; 30) coloring is notoriously difficult (Piwakowski and Radziszowski 1998) and we do not expect to succeed to accurately characterize the degree sequences for its solutions (in any of the colors). So, we consider Constraint (8) where \u03d5(A) is a relaxation of \u03d5(4,3,3;30)(A), Constraint (5), in which we impose constraint \u03d530,3K3 in the third color only on 20 of the 30 vertices in the graph (we select the first 10 and the last 10). Clearly any solution of \u03d5(4,3,3;30)(A) is also a solution of \u03d5(A). Iterating to obtain all of the degree sequences in the first column of the degree matrix which satisfy Constraint (8) now results in a set of 28 degree sequences and provides a proof for the following lemma. This is a new characterization of the set of Ramsey (4, 3, 3; 30) colorings.\nLemma 3. If G is a Ramsey (4, 3, 3; 30) coloring of K30 then, the degrees of the vertices in the first color correspond to one of the 28 degree sequences depicted in Figure 3.\nThe second step is about using the set of degree sequences from the first step to compute (a super-set of) all of the degree matrices in any solution of the corresponding graph coloring problem \u03d5(A) on n vertices and in k colors. We compute the set M\u2032 of all n \u00d7 k matrices which have as first column one of the given degree sequences. We consider here only constraints on degrees, completely ignoring the original coloring problem \u03d5(A). These include: (1) We apply the Erdo\u030bs-Gallai theorem (Erdo\u0308s and Gallai 1960; Choudum 1986) to ensure that the columns of a degree matrix contain graphical sequences: sequences of numbers which correspond to the degrees of some graph. (2) The rows of the degree matrix are sorted (non-increasing lexicographic order). (3) When coloring a complete graph Kn, the sum of each row in a degree matrix equals n\u2212 1. (4) Theo-\nrem 1 applies for (4, 3, 3; 30) Ramsey colorings. The computation of the degree matrix approximations for all (4, 3, 3; 30) and (3, 3, 3; 13) Ramsey colorings is described in more detail in Section 6."}, {"heading": "5 Solving with Degree Matrices", "text": "Let \u03d5(A) be a coloring problem on n vertices in k colors and let M be a set of degree matrices such that for any solution A \u2208 sol(\u03d5(A)) it is the case that \u03b1(A) \u2208 M. We compute the solutions of \u03d5(A) per corresponding M \u2208 M:\nsol(\u03d5(A)) = \u22c3\nM\u2208M\nsolM (\u03d5(A))\nwhere\nsolM (\u03d5(A)) = { A \u2032 \u2208 sol(\u03d5(A)) | \u03b1(A\u2032) = M }\nTo compute for a given M \u2208 M the set solM (\u03d5(A)) we basically come back to solve once again Constraint (8), we take the constraints \u03d5(A) of the original graph problem (instead of its relaxed version). But, this time, M is given and this time we iterate to find all graphs A (instead of all degree matrices M ). We are solving the same constraint that we could not solve before M was determined and the fact that M is now given eases the search process for three reasons: (1) It breaks the problem into a set of independent sub-problems: computing solM (\u03d5(A)), for each M \u2208 M. These sub-problems can be solved in parallel. In our applications for Ramsey colorings The set M contains on the order of 100,000 such independent instances which are run in parallel. (2) It directs the search. And, (3) It facilitates symmetry breaking. Degree matrices are isomorphic under renaming of colors and of graph vertices. Already in the first step, we take advantage of this to break many of the symmetries in the coloring problem. Also, in the second step, seeking solutions when given a degree matrix boosts symmetry breaking in the adjacency matrix."}, {"heading": "6 Computing Ramsey Colorings", "text": "We describe here the details regarding the computations when solving the constraints described above to determine the values of |R(3, 3, 3; 13)| and of R(4, 3, 3). Recall the details of our constraint language and computational resources described in Section 1. Most important, recall that we are using a SAT solver to determine the existence of colorings for (4, 3, 3; 30) and to find all colorings for (3, 3, 3; 13).\n|R(3,3,3;13)| = 78,892: Table 2 summarizes some statistics on the computation of R(3, 3, 3; 13), step by step:\n1. We compute the 95 degree sequences, as stated in Lemma 2. This is performed on a single core and requires just under one hour of computation.\n2. The degree sequences from the first step are extended to sorted degree matrices such that the rows sum to 12 and the columns are graphical. This results in 84,184 degree matrices generated in under five minutes.\n3. For each degree matrix we solve to find all corresponding (3,3,3;13) colorings. This involves 84,184 SAT instances. and results in 827,964 colorings. The largest number of graphs generated by a single instance is 10,311. The hardest instance requires 7 hrs of SAT solving time. The SAT instances are very small consisting in 6000\u20137200 CNF clauses each.\n4. The graphs are reduced eliminating weak isomorphisms using nauty1 (McKay 1990). This requires less than five minutes and results in a set with 78,892 graphs.\nR(3,3,4;30) = 30: Theorem 1 states that if there is no (4, 3, 3; 30) Ramsey coloring then R(4, 3, 3) = 30 and otherwiseR(4, 3, 3) = 31. We show that there is no (4, 3, 3; 30) Ramsey coloring hence proving that R(4, 3, 3) = 30.\nTable 2 summarizes some statistics regarding the proof that there are no (4, 3, 3; 30) colorings, step by step. There are two differences in this process in comparison to the steps described for the computation of R(3, 3, 3; 13): (1) In the first step, Constraint (8) is solved with respect to a relaxation of the constraints; and (2) All instances were found to be unsatisfiable implying that there are no colorings. So, we do not need to apply the forth step. We comment that the CNF instances consist in 95,000 \u2013 100,000 clauses."}, {"heading": "7 Conclusion", "text": "In this paper we have proposed a methodology for solving hard graph coloring problems by combining ideas related to abstraction and to breaking symmetry during search. We report on the successful application of this approach to solve two open problems in the area of finite Ramsey theory. We expect that the proposed combination of abstraction and symmetry will influence many other hard combinatorial search problems.\n1Note that nauty does not handle edge colored graphs and weak isomorphism directly. We applied an approach called k-layering described at https: //computationalcombinatorics.wordpress.com/ 2012/09/20/canonical-labelings-with-nauty."}], "references": [{"title": "Experiments of intelligent algorithms on ramsey graphs", "author": ["J.M. Al-Jaam"], "venue": "Int. Arab J. Inf. Technol. 4(2):161\u2013167.", "citeRegEx": "Al.Jaam,? 2007", "shortCiteRegEx": "Al.Jaam", "year": 2007}, {"title": "A simple proof of the Erd\u0151sGallai theorem on graph sequences", "author": ["S.A. Choudum"], "venue": "Bull. Austral. Math. Soc. 33(1):67\u201370.", "citeRegEx": "Choudum,? 1986", "shortCiteRegEx": "Choudum", "year": 1986}, {"title": "Breaking symmetries in graph representation", "author": ["M. Codish", "A. Miller", "P. Prosser", "P.J. Stuckey"], "venue": "Rossi, F., ed., IJCAI 2013, Proceedings of the 23rd International Joint Conference on Artificial Intelligence, Beijing, China, August 3-9, 2013. IJCAI/AAAI.", "citeRegEx": "Codish et al\\.,? 2013", "shortCiteRegEx": "Codish et al\\.", "year": 2013}, {"title": "Symmetry-breaking predicates for search problems", "author": ["J.M. Crawford", "M.L. Ginsberg", "E.M. Luks", "A. Roy"], "venue": "Aiello, L. C.; Doyle, J.; and Shapiro, S. C., eds., KR, 148\u2013159. Morgan Kaufmann.", "citeRegEx": "Crawford et al\\.,? 1996", "shortCiteRegEx": "Crawford et al\\.", "year": 1996}, {"title": "Graphs with prescribed degrees of vertices (in Hungarian)", "author": ["P. Erd\u00f6s", "T. Gallai"], "venue": "Mat. Lapok 264\u2013274. Available from http://www.renyi.hu/ \u0303p_erdos/ 1961-05.pdf.", "citeRegEx": "Erd\u00f6s and Gallai,? 1960", "shortCiteRegEx": "Erd\u00f6s and Gallai", "year": 1960}, {"title": "Symmetry breaking in constraint programming", "author": ["I.P. Gent", "B.M. Smith"], "venue": "Horn, W., ed., ECAI 2000, Proceedings of the 14th European Conference on Artificial Intelligence, Berlin, Germany, August 20-25, 2000, 599\u2013603. IOS Press.", "citeRegEx": "Gent and Smith,? 2000", "shortCiteRegEx": "Gent and Smith", "year": 2000}, {"title": "Chromatic Graphs and Ramsey\u2019s Theorem", "author": ["J.G. Kalbfleisch"], "venue": "Ph.D. Dissertation, University of Waterloo.", "citeRegEx": "Kalbfleisch,? 1966", "shortCiteRegEx": "Kalbfleisch", "year": 1966}, {"title": "nauty user\u2019s guide (version 1.5)", "author": ["B. McKay"], "venue": "Technical Report TR-CS-90-02,", "citeRegEx": "McKay,? \\Q1990\\E", "shortCiteRegEx": "McKay", "year": 1990}, {"title": "Exploiting symmetries within constraint satisfaction search", "author": ["P. Meseguer", "C. Torras"], "venue": "Artif. Intell. 129(12):133\u2013163.", "citeRegEx": "Meseguer and Torras,? 2001", "shortCiteRegEx": "Meseguer and Torras", "year": 2001}, {"title": "Boolean equi-propagation for concise and efficient SAT encodings of combinatorial problems", "author": ["A. Metodi", "M. Codish", "P.J. Stuckey"], "venue": "J. Artif. Intell. Res. (JAIR) 46:303\u2013 341.", "citeRegEx": "Metodi et al\\.,? 2013", "shortCiteRegEx": "Metodi et al\\.", "year": 2013}, {"title": "30 \u2264 r(3, 3, 4) \u2264 31", "author": ["K. Piwakowski", "S.P. Radziszowski"], "venue": "Journal of Combinatorial Mathematics and Combinatorial Computing 27:135\u2013141.", "citeRegEx": "Piwakowski and Radziszowski,? 1998", "shortCiteRegEx": "Piwakowski and Radziszowski", "year": 1998}, {"title": "On ramsey number r(4, 3, 3) and triangle-free edge-chromatic graphs in three colors", "author": ["K. Piwakowski"], "venue": "Discrete Mathematics 164(1-3):243\u2013249.", "citeRegEx": "Piwakowski,? 1997", "shortCiteRegEx": "Piwakowski", "year": 1997}, {"title": "On the satisfiability of symmetrical constrained satisfaction problems", "author": ["J. Puget"], "venue": "Komorowski, H. J., and Ras, Z. W., eds., Methodologies for Intelligent Systems, 7th International Symposium, ISMIS \u201993, Trondheim, Norway, June 15-18, 1993, Proceedings, volume 689 of Lecture", "citeRegEx": "Puget,? 1993", "shortCiteRegEx": "Puget", "year": 1993}, {"title": "Small ramsey numbers", "author": ["S.P. Radziszowski"], "venue": "Electronic Journal of Combinatorics. Revision #14: January, 2014.", "citeRegEx": "Radziszowski,? 1994", "shortCiteRegEx": "Radziszowski", "year": 1994}, {"title": "CryptoMiniSAT, v2.5.1", "author": ["M. Soos"], "venue": "http://www. msoos.org/cryptominisat2", "citeRegEx": "Soos,? \\Q2010\\E", "shortCiteRegEx": "Soos", "year": 2010}], "referenceMentions": [{"referenceID": 13, "context": "The number of colorings for n = 13 was previously unknown (Radziszowski 1994).", "startOffset": 58, "endOffset": 77}, {"referenceID": 6, "context": "Kalbfleisch (1966) proved that R(4, 3, 3) \u2265 30, Piwakowski (1997) proved that R(4, 3, 3) \u2264 32, and one year later Piwakowski and Radziszowski (1998) proved that R(4, 3, 3) \u2264 31.", "startOffset": 0, "endOffset": 19}, {"referenceID": 6, "context": "Kalbfleisch (1966) proved that R(4, 3, 3) \u2265 30, Piwakowski (1997) proved that R(4, 3, 3) \u2264 32, and one year later Piwakowski and Radziszowski (1998) proved that R(4, 3, 3) \u2264 31.", "startOffset": 0, "endOffset": 66}, {"referenceID": 6, "context": "Kalbfleisch (1966) proved that R(4, 3, 3) \u2265 30, Piwakowski (1997) proved that R(4, 3, 3) \u2264 32, and one year later Piwakowski and Radziszowski (1998) proved that R(4, 3, 3) \u2264 31.", "startOffset": 0, "endOffset": 149}, {"referenceID": 10, "context": "When searching for a graph coloring, on top of graph isomorphism, solutions are typically closed under permutations of the colors: the actual names of the colors do not matter and the term often used is \u201cweak isomorphism\u201d (Piwakowski and Radziszowski 1998) (the equivalence relation is weaker because both node names and edge colors do not matter).", "startOffset": 222, "endOffset": 256}, {"referenceID": 7, "context": "Often times, one first attempts to compute all of the solutions, and to then apply one of the available tools, such as nauty (McKay 1990), to select the non-isomorphic graphs from within this set.", "startOffset": 125, "endOffset": 137}, {"referenceID": 14, "context": "In our configuration, instances are solved using CryptoMiniSAT (Soos 2010) as the underlying SAT solver.", "startOffset": 63, "endOffset": 74}, {"referenceID": 2, "context": "(1996) has previously been explored in (Codish et al. 2013) (for graph isomorphism), and in (Puget 1993) (for graph coloring).", "startOffset": 39, "endOffset": 59}, {"referenceID": 12, "context": "2013) (for graph isomorphism), and in (Puget 1993) (for graph coloring).", "startOffset": 38, "endOffset": 50}, {"referenceID": 2, "context": "Gent and Smith (2000) building on the work of Puget (1993), study symmetries in graph coloring problems and recognize the importance of breaking symmetries during search.", "startOffset": 0, "endOffset": 22}, {"referenceID": 2, "context": "Gent and Smith (2000) building on the work of Puget (1993), study symmetries in graph coloring problems and recognize the importance of breaking symmetries during search.", "startOffset": 0, "endOffset": 59}, {"referenceID": 2, "context": "Gent and Smith (2000) building on the work of Puget (1993), study symmetries in graph coloring problems and recognize the importance of breaking symmetries during search. Meseguer and Torras (2001) present a framework for exploiting symmetries to heuristically guide a depth first search, and show promising results for (3, 3, 3;n) Ramsey colorings with 14 \u2264 n \u2264 17.", "startOffset": 0, "endOffset": 198}, {"referenceID": 0, "context": "Al-Jaam (2007) proposes a hybrid metaheuristic algorithm for Ramsey coloring problems, combining tabu search and simulated annealing.", "startOffset": 0, "endOffset": 15}, {"referenceID": 0, "context": "Al-Jaam (2007) proposes a hybrid metaheuristic algorithm for Ramsey coloring problems, combining tabu search and simulated annealing. While all of these works report promising results, still, to the best of our knowledge, none of them have been successfully applied to solve open instances or improve the known bounds on classical Ramsey numbers. Our approach focuses on symmetries due to weak-isomorphism for graph coloring and models symmetry breaking in terms of constraints introduced as part of the problem formulation. This idea advocated by Crawford et al. (1996) has previously been explored in (Codish et al.", "startOffset": 0, "endOffset": 571}, {"referenceID": 13, "context": "More information on recent results concerning Ramsey numbers can be found in the electronic dynamic survey by Radziszowski (1994). In this paper, graphs are always simple graphs: undirected and with no self loops.", "startOffset": 110, "endOffset": 130}, {"referenceID": 2, "context": "(Codish et al. 2013).", "startOffset": 0, "endOffset": 20}, {"referenceID": 2, "context": "Table 1: The search for (3, 3, 3;n) Ramsey colorings with and without the symmetry break defined in (Codish et al. 2013) (time in seconds with 24 hr.", "startOffset": 100, "endOffset": 120}, {"referenceID": 13, "context": "The column headed by \u201c#\\\u2248\u201d specifies the known number of colorings modulo weak isomorphism (Radziszowski 1994).", "startOffset": 91, "endOffset": 110}, {"referenceID": 10, "context": "To prove that R(4, 3, 3) = 30 we make use of the following results from (Piwakowski and Radziszowski 1998).", "startOffset": 72, "endOffset": 106}, {"referenceID": 2, "context": "Table 1 illustrates the impact of the symmetry breaking technique introduced by Codish et al. in (2013) on the search for (3, 3, 3;n)Ramsey colorings.", "startOffset": 80, "endOffset": 104}, {"referenceID": 2, "context": "Note that sb\u2217l (A,M) is similar to the (partitioned lexicographic symmetry break predicate introduced by Codish et al. in (2013) for Boolean adjacency matrices.", "startOffset": 105, "endOffset": 129}, {"referenceID": 10, "context": "For example, computing the set of all (3, 3, 3; 13) Ramsey colorings is difficult due to the very large number of solutions of the corresponding constraints (Piwakowski and Radziszowski 1998).", "startOffset": 157, "endOffset": 191}, {"referenceID": 10, "context": "For example, the search for a Ramsey (4, 3, 3; 30) coloring is notoriously difficult (Piwakowski and Radziszowski 1998) and we do not expect to succeed to accurately characterize the degree sequences for its solutions (in any of the colors).", "startOffset": 85, "endOffset": 119}, {"referenceID": 4, "context": "These include: (1) We apply the Erd\u0151s-Gallai theorem (Erd\u00f6s and Gallai 1960; Choudum 1986) to ensure that the columns of a degree matrix contain graphical sequences: sequences of numbers which correspond to the degrees of some graph.", "startOffset": 53, "endOffset": 90}, {"referenceID": 1, "context": "These include: (1) We apply the Erd\u0151s-Gallai theorem (Erd\u00f6s and Gallai 1960; Choudum 1986) to ensure that the columns of a degree matrix contain graphical sequences: sequences of numbers which correspond to the degrees of some graph.", "startOffset": 53, "endOffset": 90}, {"referenceID": 7, "context": "The graphs are reduced eliminating weak isomorphisms using nauty1 (McKay 1990).", "startOffset": 66, "endOffset": 78}], "year": 2017, "abstractText": "This paper introduces a methodology that applies to solve graph edge-coloring problems and in particular to prove that the Ramsey number R(4, 3, 3) = 30. The number R(4, 3, 3) is often presented as the unknown Ramsey number with the best chances of being found \u201csoon\u201d. Yet, it has been sought after for more than 50 years. The proposed technique is based on two well-studied concepts, abstraction and symmetry. First, we introduce an abstraction on graph colorings, degree matrices, that specify the degree of each vertex in each color. We compute, using a SAT solver, an overapproximation of the set of degree matrices of all solutions of the graph coloring problem. Then, for each degree matrix in the over-approximation, we compute, again using a SAT solver, the set of all solutions with matching degrees. Breaking symmetries, on degree matrices in the first step and with respect to graph isomorphism in the second, is cardinal to the success of the approach. We illustrate two applications: to prove that R(4, 3, 3) = 30 and to compute the, previously unknown number, 78,892, of (3, 3, 3; 13) Ramsey colorings.", "creator": "dvips(k) 5.991 Copyright 2011 Radical Eye Software"}}}