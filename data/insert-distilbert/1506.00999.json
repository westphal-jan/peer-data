{"id": "1506.00999", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "2-Jun-2015", "title": "Combining Two And Three-Way Embeddings Models for Link Prediction in Knowledge Bases", "abstract": "this paper tackles the problem of endogenous cross link diagram prediction for knowledge base completion. knowledge bases paths can be represented as directed graphs whose nodes correspond to entities and edges close to relationships. previous attempts either consist of powerful systems with high capacity to model complex connectivity patterns, which unfortunately usually end up overfitting on rare linked relationships, or in approaches that trade capacity for simplicity in order to then fairly model all relationships, frequent or arguably not. in this paper, we propose tatec a desirable happy medium obtained first by complementing a high - capacity model graph with either a theoretically simpler one, both pre - trained separately and then combined. we present us several variants of this model each with different kinds of regularization and combination strategies and show that this approach outperforms existing methods on different particular types of relationships by achieving state - of - the - art results on four biggest benchmarks of the literature.", "histories": [["v1", "Tue, 2 Jun 2015 19:34:19 GMT  (398kb)", "http://arxiv.org/abs/1506.00999v1", "26 pages"]], "COMMENTS": "26 pages", "reviews": [], "SUBJECTS": "cs.AI cs.CL cs.LG", "authors": ["alberto garcia-duran", "antoine bordes", "nicolas usunier", "yves grandvalet"], "accepted": false, "id": "1506.00999"}, "pdf": {"name": "1506.00999.pdf", "metadata": {"source": "CRF", "title": "Combining Two And Three-Way Embeddings Models for Link Prediction in Knowledge Bases", "authors": ["Alberto Gar\u0107\u0131a-Dur\u00e1n", "Nicolas Usunier", "Yves Grandvalet"], "emails": ["alberto.garcia-duran@utc.fr", "abordes@fb.com", "usunier@fb.com", "yves.grandvalet@utc.fr"], "sections": [{"heading": null, "text": "ar X\niv :1\n50 6.\n00 99\n9v 1\n[ cs"}, {"heading": "1. Introduction", "text": "Knowledge bases (KBs) are crucial tools to deal with the rise of data, since they provide ways to organize, manage and retrieve all digital knowledge. These repositories can cover any kind of area, from specific domains like biological processes (e.g. in GeneOntology1), to very generic purposes. Freebase2, a huge collaborative KB which belongs to the Google Knowledge Graph, is an example of the latter kind which provides expert/common-level knowledge and capabilities to its users. An example of knowledge engine is WolframAlpha3, an engine which answers to any natural language question, like how far is saturn from the sun?, with human-readable answers (1,492 \u00d7109 km) using an internal KB.\n\u2217. Part of this work was done while Nicolas Usunier was with Sorbonne universite\u0301s, Universite\u0301 de technologie de Compie\u0300gne, CNRS, Heudiasyc UMR 7253. 1. http://geneontology.org 2. http://www.freebase.com 3. http://www.wolframalpha.com\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\nSuch KBs can be used for question answering, but also for other natural language processing tasks like word-sense disambiguation (Navigli & Velardi, 2005), co-reference resolution (Ponzetto & Strube, 2006) or even machine translation (Knight & Luk, 1994).\nKBs can be formalized as directed multi-relational graphs, whose nodes correspond to entities connected with edges encoding various kinds of relationship. Hence, one can also refer to them as multi-relational data. In the following we denote connections among entities via triples or facts (head, label, tail), where the entities head and tail are connected by the relationship label. Any information of the KB can be represented via a triple or a concatenation of several ones. Note that multi-relational data are not only present in KBs but also in recommender systems, where the nodes would correspond to users and products and edges to different relationships between them, or in social networks for instance.\nA main issue with KBs is that they are far from being complete. Freebase currently contains thousands of relationships and more than 80 millions of entities, leading to billions of facts, but this remains only a very small portion out of all the human knowledge, obviously. And since question answering engines based on KBs like WolframAlpha are not capable of generalizing over their acquired knowledge to fill in for missing facts, they are de facto limited: they search for matches with a question/query in their internal KB and if this information is missing they can not provide a correct answer, even if they correctly interpreted the question. Consequently, huge efforts are devoted nowadays towards KBs construction or completion, via manual or automatic processes, or a mix of both. This is mainly divided in two tasks: entity creation or extraction, which consists in adding new entities to the KB and link prediction, which attempts to add connections between entities. This paper focuses on the latter case. Performing link prediction can be formalized as filling in incomplete triples like (head, label, ?) or (?, label, tail), by predicting the missing argument of the triple when such triple does not exist in the KB, yet. For instance, given the small example KB of Figure 1, made of 6 entities and 2 different relationships, and containing facts like (Jared Leto, influenced by, Bono) or (Michael Buble, profession, singer), we would like to able to predict new links such as (Frank Sinatra, profession, singer), by using the fact that he influenced the singer Michael Buble for instance.\nLink prediction in KBs is complex due to several issues. The entities are not homogeneously connected: some of them will have a lot of links with other entities, whereas others will be rarely connected. To illustrate the diverse characteristics present in the relationships we can take a look at FB15k, a subset of Freebase introduced in (Bordes, Usunier, Garc\u0301\u0131a-Dura\u0301n, Weston, & Yakhnenko, 2013b). In this data set of \u223c14k entities and 1k types of relationships, entities have a mean number of triples of \u223c400, but a median of 21 indicating that a large number of them appear in very few triples. Besides, roughly 25% of connections are of type 1-to-1, that is, a head is connected to at most one tail, and around 25% are of type Many-to-Many, that is, multiple heads can be linked to a tail and vice versa. As a result, diverse problems coexist in the same database. Another property of relationships that can have a big impact on the performance is the typing of their arguments. On FB15k, some relationships are very strongly typed like /sports/sports team/location, where one always expects a football team as head and a location as tail, and some are far less precise such as /common/webpage/category where one expects only web page adresses as tail but pretty much everything else as head. A link prediction algorithm should be able to adapt to these different settings.\n2"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "Though there exists (pseudo-) symbolic approaches for link prediction based on Markovlogic networks (Kok & Domingos, 2007) or random walks (Lao, Mitchell, & Cohen, 2011), learning latent features representations of KBs constituents - the so-called embedding methods - have recently proved to be more efficient for performing link prediction in KBs, e.g. in (Bordes et al., 2013b; Wang, Zhang, Feng, & Chen, 2014b; Lin, Liu, Sun, Liu, & Zhu, 2015; Chang, Yih, Yang, & Meek, 2014; Wang, Zhang, Feng, & Chen, 2014a; Zhang, Salwen, Glass, & Gliozzo, 2014; Yang, Duan, Zhou, & Rim, 2014b). In all these works, entities are represented by low-dimensional vectors - the embeddings - and relationships act as operators on them: both embeddings and operators define a scoring function that is learned so that triples observed in the KBs have higher scores than unobserved ones. The embeddings are meant to capture underlying features that should eventually allow to create new links successfully. The scoring function is used to predict new links: the higher the score, the more likely a triple is to be true. Representations of relationships are usually specific (except in LFM (Jenatton, Le Roux, Bordes, & Obozinski, 2012) where there is a sharing of parameters across relationships), but embeddings of entities are shared for all relationships and allow to transfer information across them. The learning process can be considered as multi-task, where one task concerns each relationship, and entities are shared across tasks.\nEmbedding models can be classified according to the interactions that they use to encode the validity of a triple in their scoring function. If the joint interaction between the head, the label and the tail is used then we are dealing with a 3-way model; but when the binary interactions between the head and the tail, the head and the label, and the label and the tail are the core of the model, then it is a 2-way model. Both kinds of models represent the entities as vectors, but they differ in the way they model the relationships: 3-way models generally use matrices, whereas 2-way models use vectors. This difference in the capacity leads to a difference in the expressiveness of the models. The larger capacity of 3-way models (due to the large number of free parameters in matrices) is beneficial for the relationships appearing in a lot of triples, but detrimental for rare ones even if regularization is applied. Capacity is not the only difference between 2- and 3-way models, the information encoded\n3\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\nby these two models is also different: we show in Sections 3 and 5.3.2 that both kinds of models assess the validity of the triple using different data patterns.\nIn this paper we introduce Tatec that encompass previous works by combining wellcontrolled 2-way interactions with high-capacity 3-way ones. We aim at capturing data patterns of both approaches by separately pre-training the embeddings of 2-way and 3-way models and using different embedding spaces for each of the two of them. We demonstrate in the following that otherwise \u2013 with no pre-training and/or no use of different embedding spaces \u2013 some features cannot be conveniently captured by the embeddings. Eventually, these pre-trained weights are combined in a second stage, leading to a combination model which outperforms most previous works in all conditions on four benchmarks from the literature, UMLS, Kinships, FB15k and SVO. Tatec is also carefully regularized since we systematically compared two different regularization schemes: adding penalty terms to the loss function or hard-normalizing the embedding vectors by constraining their norms.\nThis paper is an extension of (Garc\u0301\u0131a-Dura\u0301n, Bordes, & Usunier, 2014): we added a much more thorough study on regularization and on combination strategies for Tatec. Besides we propose experiments on several new benchmarks and a more complete comparison of our proposed method w.r.t. the state-of-the-art. We also give examples of predictions and projections in 2D of the obtained embeddings to provide some insights into the behavior of Tatec. The paper is organized as follows. Section 2 discusses previous works. Section 3 presents our model and justifies its choices. Detailed explanations of both the training procedure and the regularization schemes are given in Section 4. Finally, we present our experimental results on four benchmarks in Section 5."}, {"heading": "2. Related work", "text": "In this section, we discuss the state-of-the-art of modeling large multi-relational databases, with a particular focus on embedding methods for knowledge base completion.\nOne of the simplest and most successful 2-way models is TransE (Bordes et al., 2013b). In that model, relationships are represented as translations in the embedding space: if (h, \u2113, t) holds, then the embedding of the tail t should be close to the embedding of head h plus some vector that depends on the label \u2113. This is a natural approach to model hierarchical and asymmetric relationships, which are common in knowledge bases such as Freebase. Several modifications to TransE have been proposed recently, TransH (Wang et al., 2014b) and TransR (Lin et al., 2015). In TransH, the embeddings of the entities are projected onto a hyperplane that depends on \u2113 before the translation. The second algorithm, TransR, follows the same idea, except that the projection operator is a matrix that is more general than an orthogonal projection to a hyperplane. As we shall see in the next section, TransE corresponds to our Bigrams model with additional constraints on the parameters.\nWhile 2-way models were shown to have very good performances on some KB datasets, they have limited expressiveness and they can fail dramatically on harder datasets. In contrast, 3-way models perform some form of low-rank tensor factorization, and in that respect can have extremely high expressiveness depending on the rank constraints. In the context of link prediction for multi-relational data, RESCAL (Nickel, Tresp, & Kriegel, 2011) follows natural modeling assumptions. Similarly to TransE, RESCAL learns one\n4"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "low-dimensional embedding for each entity. However, relationships are represented as a bilinear operator in the embedding space, i.e. each relationship corresponds to a matrix. The training objective of RESCAL is the Frobenius norm between the original data tensor and its low-rank reconstruction, whereas Tatec uses the margin ranking criterion of TransE. Another related 3-way model is SME(bilinear) (Bordes, Glorot, Weston, & Bengio, 2013a). The parameterization of SME(bilinear) is a constrained version of RESCAL, and also uses a ranking criterion as training objective.\nThe Latent Factor Model (LFM) (Jenatton et al., 2012) and the Neural Tensor Networks (NTN) (Socher, Chen, Manning, & Ng, 2013) use combinations of a 3-way model with a more constrained 2-way model, and in that sense are closer to our algorithm Tatec. There are important differences between these algorithms and Tatec, though. First, both LFM and NTN share the entity embeddings in the 2-way and the 3-way models, while we learn different entity embeddings. The use of different embeddings for the 2-way and the 3-way models does not increase the model expressivity, because it is equivalent to a combination with shared embeddings in a higher dimensional embedding space, with additional constrains on the relation parameters. As we show in the experiments however, these additional constraints lead to very significant improvements. The second main difference between our approach and LFM is that some parameters of the relationships between the 2-way and the 3-way interaction terms are also shared, which is not the case in Tatec. Indeed, such joint parameterization might reduce the expressiveness of the 2-way interaction terms which, as we argue in Section 3.3, should be left with maximum degrees of freedom. The NTN has a more general parameterization than LFM, but still uses the same entity embeddings for the 2-way and 3-way interaction terms. Also, NTN has two layers and a non-linearity after the first layer, while our model does not add any nonlinearity after the embedding step. In order to have a more precise overview of the differences between the approaches, we give in Section 3 (Table 1) the formulas of the scoring functions of these related works.\nWhile there has been a lot of focus recently on algorithms purely based on learning embeddings for entities and/or relationships, many earlier alternatives had been proposed. We discuss works carried ou in the Bayesian clustering framework, as well as approaches that explicitly use the graph structure of the data. The Infinite Relational Model of (Kemp, Tenenbaum, Griffiths, Yamada, & Ueda, 2006), which is a nonparametric extension of the Stochastic Blockmodel (Wang & Wong, 1987), is a Bayesian clustering approach that learns clusters of entities of the same kind, i.e. groups of entities that can have similar relationships with other entities. This work was followed by (Sutskever, Salakhutdinov, & Tenenbaum, 2009), a 3-way tensor factorization model based on Bayesian clustering in which entities within a cluster share the same distribution of embeddings.\nThe last line of work we discuss here are the approaches that use the structure of the graph in a symbolic way. In that line of work, the Path Ranking Algorithm (PRA) (Lao et al., 2011) estimates the probability of an unobserved fact as a function of the different paths that go from the subject to the object in the multi-relational graph; learning consists in finding, for each relationship, a weight associated to a kind of path (represented as a sequence of relationships) linking two entities. The PRA is used in the Knowledge Vault project (Dong, Gabrilovich, Heitz, Horn, Lao, Murphy, Strohmann, Sun, & Zhang, 2014) in conjunction with an embedding approach. Thus, even though we do not consider these symbolic approaches here, they could also be combined with our embedding model if desired.\n5\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet"}, {"heading": "3. TATEC", "text": "We now describe our model and the motivations underlying our parameterization."}, {"heading": "3.1 Scoring function", "text": "The data S is a set of relations between entities in a fixed set of entities in E = {e1, ..., eE}. Relations are represented as triples (h, \u2113, t) where the head h and the tail t are indexes of entities (i.e. h, t \u2208 [[E]] = {1, ..., E}), and the label \u2113 is the index of a relationship in L = {l1, ..., lL}, which defines the type of the relation between the entities eh and et. Our goal is to learn a discriminant scoring function on the set of all possible triples E \u00d7 L \u00d7 E so that the triples which represent likely relations receive higher scores than triples that represent unlikely ones. Our proposed model, Tatec, learns embeddings of entities in a low dimensional vector space, say Rd, and parameters of operators on Rd \u00d7 Rd, most of these operators being associated to a single relationship. More precisely, the score given by Tatec to a triple (h, \u2113, t), denoted by s(h, \u2113, t), is defined as:\ns(h, \u2113, t) = s1(h, \u2113, t) + s2(h, \u2113, t) (1)\nwhere s1 and s2 have the following form:\n(B) Bigram or the 2-way interaction term:\ns1(h, \u2113, t) = \u2329 r\u21131 \u2223 \u2223eh1 \u232a + \u2329 r\u21132 \u2223 \u2223et1 \u232a + \u2329 eh1 \u2223 \u2223D \u2223 \u2223et1 \u232a ,\nwhere eh1 , e t 1 are embeddings in R d1 of the head and tail entities of (h, \u2113, t) respectively, r\u21131 and r \u2113 2 are vectors in R\nd1 that depend on the relationship \u2113, and D is a diagonal matrix that does not depend on the input triple. As a general notation throughout this section, \u2329 . \u2223 \u2223. \u232a\nis the canonical dot product, and \u2329\nx \u2223 \u2223A \u2223 \u2223y \u232a = \u2329 x \u2223 \u2223Ay \u232a\nwhere x and y are two vectors in the same space and A is a square matrix of appropriate dimensions.\n(T) Trigram or the 3-way interaction term:\ns2(h, \u2113, t) = \u2329 eh2 \u2223 \u2223R\u2113 \u2223 \u2223et2 \u232a ,\nwhere R\u2113 is a matrix of dimensions (d2, d2), and e h 2 and e t 2 are embeddings in R d2 of the head and tail entities respectively. The embeddings of the entities for this term are not the same as for the 2-way term; they can even have different dimensions.\nThe embedding dimensions d1 and d2 are hyperparameters of our model. All other vectors and matrices are learned without any additional parameter sharing.\nThe 2-way interaction term of the model is similar to that of (Bordes et al., 2013a), but slightly more general because it does not contain any constraint between the relationdependent vectors r\u21131 and r \u2113 2. It can also be seen as a relaxation of the translation model of (Bordes et al., 2013b), which is the special case where r\u21131 = \u2212r\u21132, D is the identity matrix, and the entity embeddings are constrained to lie on the unit sphere.\nThe 3-way term corresponds exactly to the model used by the collective factorization method RESCAL (Nickel et al., 2011), and we chose it for its high expressiveness on\n6"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "complex relationships. Indeed, as we said earlier in the introduction, 3-way models can basically represent any kind of interaction among entities. The combination of 2- and 3- way terms has already been used in (Jenatton et al., 2012; Socher et al., 2013), but, besides a different parameterization, Tatec contrasts with them by the additional freedom brought by using different embeddings in the two interaction terms. In LFM (Jenatton et al., 2012), constraints were imposed on the relation-dependent matrix of the 3-way terms (low rank in a limited basis of rank-one matrices), the relation vectors r\u21131 and r \u2113 2 were constrained to be in the image of the matrix (D = 0 in their work). These global constraints severely limited the expressiveness of the 3-way model, and act as a stringent regularization that reduces the expressiveness of the 2-way model, which, as we explain in Section 3.3, should be left with maximum degrees of freedom. We are similar to NTN (Socher et al., 2013) in the respect that we do not share any parameter between relations. Our overall scoring function is similar to this model with a single layer, with the fundamental difference that we use different embedding spaces and do not use any non-linear transfer function, which results in a facilitated training (for instance, the gradients have a larger magnitude)."}, {"heading": "3.2 Term combination", "text": "We study two strategies for combining the bigram and trigram scores as indicated in Equation (1). In both cases, both s1 and s2 are first trained separately as we detail in Section 4 and then combined. The difference between our two strategies depends on whether we jointly update (or fine-tune) the parameters of s1 and s2 in a second phase or not.\nFine tuning This first strategy, denoted Tatec-ft, simply consists in summing both scores following Equation (1).\nsFT (h, \u2113, t) = \u2329 r\u21131 \u2223 \u2223eh1 \u232a + \u2329 r\u21132 \u2223 \u2223et1 \u232a + \u2329 eh1 \u2223 \u2223D \u2223 \u2223et1 \u232a + \u2329 eh2 \u2223 \u2223R\u2113 \u2223 \u2223et2 \u232a\nAll parameters of s1 and s2 (and hence of s) are then fine-tuned in a second training phase to accommodate for their combination. This version could be trained directly without pre-training s1 and s2 separately but we show in our experiments that this is detrimental.\nLinear combination The second strategy combines the bigram and trigram terms using a linear combination, without jointly fine-tuning their parameters that remain unchanged after their pre-training. The score s is hence defined as follows:\nsLC(h, \u2113, t) = \u03b4 \u2113 1\n\u2329 r\u21131 \u2223 \u2223eh1 \u232a + \u03b4\u21132 \u2329 r\u21132 \u2223 \u2223et1 \u232a + \u03b4\u21133 \u2329 eh1 \u2223 \u2223D \u2223 \u2223et1 \u232a + \u03b4\u21134 \u2329 eh2 \u2223 \u2223R\u2113 \u2223 \u2223et2 \u232a\nThe combination weights \u03b4\u2113i depend on the relationship and are learned by optimizing the ranking loss (defined later in (4)) using L-BFGS, with an additional quadratic penalization term, \u2211\n\u2113\n||\u03b4\u2113||2 2\n\u03c3\u2113+\u01eb , where \u03b4\u2113 contains the combination weights for relation \u2113, and \u03c3 are con-\nstrained to \u2211\n\u2113 \u03c3\u2113 = \u03b1 (\u03b1 is a hyperparameter). This version of Tatec is denoted Tatec-lc in the following."}, {"heading": "3.3 Interpretation and motivation of the model", "text": "This section discusses the motivations underlying the parameterization of Tatec, and in particular our choice of 2-way model to complement the 3-way term.\n7\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\n3.3.1 2-way interactions as one fiber biases\nIt is common in regression, classification or collaborative filtering to add biases (also called offsets or intercepts) to the model. For instance, a critical step of the best-performing techniques of the Netflix prize was to add user and item biases, i.e. to approximate a user-rating Rui according to (see e.g. (Koren, Bell, & Volinsky, 2009)):\nRui \u2248 \u2329 Pu \u2223 \u2223Qi \u232a + \u03b1u + \u03b2i + \u00b5 (2)\nwhere P \u2208 RU\u00d7k, with each row Pu containing the k-dimensional embedding of the user (U is the number of users), Q \u2208 RI\u00d7k containing the embeddings of the I items, \u03b1u \u2208 R a bias only depending on a user and \u03b2i \u2208 R a bias only depending on an item (\u00b5 is a constant that we do not consider further on).\nThe 2-way + 3-way interaction model we propose can be seen as the 3-mode tensor version of this \u201cbiased\u201d version of matrix factorization: the trigram term (T) is the collective matrix factorization parameterization of the RESCAL algorithm (Nickel et al., 2011) and plays a role analogous to the term \u2329 Pu \u2223 \u2223Qi \u232a\nof the matrix factorization model for collaborative filtering (2). The bigram term (B) then plays the role of biases for each fiber of the tensor,4 i.e.\ns1(h, \u2113, t) \u2248 B1l,h +B2l,t +B3h,t (3)\nand thus is the analogue for tensors to the term \u03b1u + \u03b2i in the matrix factorization model (2). The exact form of s1(h, \u2113, t) given in (B) corresponds to a specific form of collective factorization of the fiber-wise bias matrices B1 = [\nB1l,h\n]\nl\u2208[[L]],h\u2208[[E]] , B2 and B3 of Equation\n(3). We do not exactly learn one bias by fiber because many such fibers have very little data, while, as we argue in the following, the specific form of collective factorization we propose in (B) should allow to share relevant information between different biases."}, {"heading": "3.3.2 The need for multiple embeddings", "text": "A key feature of Tatec is to use different embedding spaces for the 2-way and 3-way terms, while existing approaches that have both types of interactions use the same embedding space (Jenatton et al., 2012; Socher et al., 2013). We motivate this choice in this section.\nIt is important to notice that biases in the matrix factorization model (2), or the bigram term in the overall scoring function (1) do not affect the model expressiveness, and in particular do not affect the main modeling assumptions that embeddings should have low rank. The user/item-biases in (2) only boil down to adding two rank-1 matrices \u03b11T and 1\u03b2T to the factorization model. Since the rank of the matrix is a hyperparameter, one may simply add 2 to this hyperparameter and get a slightly larger expressiveness than before, with reasonably little impact since the increase in rank would remain small compared to its original value (which is usually 50 or 100 for large collaborative filtering data sets). The critical feature of these biases in collaborative filtering is how they interfere with capacity control terms other than the rank, namely the 2-norm regularization: in (Koren et al., 2009) for instance, all terms of (2) are trained using a squared error as a measure of\n4. Fibers are the higher order analogue of matrix rows and columns for tensors and are defined by fixing every index but one.\n8"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "approximation and regularized by \u03bb ( \u2016 Pu \u201622 + \u2016 Qi \u201622 + \u03b12u + \u03b22i ) , where \u03bb > 0 is the regularization factor. This kind of regularization is a weighted trace norm regularization (Salakhutdinov & Srebro, 2010) on PQT . Leaving aside the \u201cweighted\u201d part, the idea is that at convergence, the quantity \u03bb ( \u2211\nu \u2016 Pu \u201622 + \u2211 i \u2016 Qi \u201622 ) is equal to 2\u03bb times the sum\nof the singular values of the matrix PQT . However, \u03bb\u2016 \u03b1 \u201622, which is the regularization applied to user biases, is not 2\u03bb times the singular value of the rank-one matrix \u03b11T , which is equal to \u221a I\u2016 \u03b1 \u20162, and can be much larger than \u2016 \u03b1 \u201622. Thus, if the pattern user+item biases exists in the data, but very weakly because it is hidden by stronger factors, it will be less regularized than others and the model should be able to capture it. Biases, which are allowed to fit the data more than other factors, offer the opportunity of relaxing the control of capacity on some parts of the model but this translates into gains if the patterns that they capture are indeed useful patterns for generalization. Otherwise, this ends up relaxing the capacity to lead to more overfitting.\nOur bigram terms are closely related to the trigram term: the terms \u2329 r\u21131 \u2223 \u2223eh1 \u232a and \u2329 r\u21132 \u2223 \u2223et1 \u232a can be added to the trigram term by adding constant features in the entities\u2019 embeddings, and \u2329\neh1 \u2223 \u2223D \u2223 \u2223et1 \u232a\nis directly in an appropriate quadratic form. Thus, the only way to gain from the addition of bigram terms is to ensure that they can capture useful patterns, but also that capacity control on these terms is less strict than on the trigram terms. In tensor factorization models, and especially 3-way interaction models with parameterizations such as (T), capacity control through the regularization of individual parameters is still not well understood, and sometimes turns out to be more detrimental than effective in experiments. The only effective parameter is the admissible rank of the embeddings, which leads to the conclusion that the bigram term can be really useful in addition to the trigram term if higher-dimensional embeddings are used. Hence, in absence of clear and concrete way of effectively controlling the capacity of the trigram term, we believe that different embedding spaces should be used.\n3.3.3 2-way interactions as entity types+similarity\nHaving a part of the model that is less expressive, but less regularized (see Subsection 4.2) than the other part is only useful if the patterns it can learn are meaningful for the prediction task at hand. In this section, we give the motivation for our 2-way interaction term for the task of modeling multi-relational data.\nMost relationships in multi-relational data, and in knowledge bases like FB15k in particular, are strongly typed, in the sense that only well-defined and specific subsets of entities can be either heads or tails of selected relationships. For instance, a relationship like capital of expects a (big) city as head and a country as tail for any valid relation. Large knowledge bases have huge amounts of entities, but those belong to many different types. Identifying the expected types of head and tail entities of relationships, with an appropriate granularity of types (e.g. person or artist or writer), is likely to filter out 95% of the entity set during prediction. The exact form of the first two terms \u2329\nr\u21131 \u2223 \u2223eh1 \u232a + \u2329 r\u21132 \u2223 \u2223et1 \u232a\nof the 2-way interaction model (B), which corresponds to a low-rank factorization of the per bias matrices (head, label) and (tail, label) in which head and tail entities have the same embeddings, is based on the assumption that the types of entities can be predicted based on few (learned) features, and these features are the same for predicting head-types as for\n9\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\npredicting tail-types. As such, it is natural to share the entities embeddings in the first two terms of (B).\nThe last term, \u2329 eh1 \u2223 \u2223D \u2223 \u2223et1 \u232a\n, is intended to account for a global similarity between entities. For instance, the capital of France can easily be predicted by looking for the city with strongest overall connections with France in the knowledge base. A country and a city may be strongly linked through their geographical positions, independent of their respective types. The diagonal matrix D allows to re-weight features of the embedding space to account for the fact that the features used to describe types may not be the same as those that can describe the similarity between objects of different types. The use of a diagonal matrix is strictly equivalent to using a general symmetric matrix in place of D.5 The reason for using a symmetric matrix comes from the intuition that the direction of many relationships is arbitrary (i.e. the choice between having triples \u201cParis is capital of France\u201d rather than \u201cFrance has capital Paris\u201d), and the model should be invariant under arbitrary inversions of the directions of the relationships (in the case of an inversion of direction, the relations vectors r\u21131 and r \u2113 2 are swapped, but all other parameters are unaffected). For tasks in which such invariance is not desirable, the diagonal matrix could be replaced by an arbitrary matrix."}, {"heading": "4. Training", "text": ""}, {"heading": "4.1 Ranking objective", "text": "Training Tatec is carried out using stochastic gradient descent over a ranking objective function, which is designed to give higher scores to positive triples (facts that express true and verified information from the KB) than to negative ones (facts that are supposed to express false information). These negative triples can be provided by the KB, but often they are not, so we need a process to turn positive triples into corrupted ones to carry out our discriminative training. A simple approach consists in creating negative examples by replacing one argument of a positive triple by a random element. This way is simple and efficient in practice but may introduce noise by creating wrong negatives.\n5. We can see the equivalence by taking the eigenvalue decomposition of a symmetric D: apply the change of basis to the embeddings to keep only the diagonal part of D in the term \u2329 e h\n1\n\u2223 \u2223D \u2223 \u2223e t\n1\n\u232a\n, and apply the\nreverse transformation to the vectors r\u21131 and r \u2113 2. Note that since rotations preserve Euclidean distances, the equivalence still holds under 2-norm regularization of the embeddings.\n10"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "Let S be the set of positive triples provided by the KB, we optimize the following ranking loss function:\n\u2211\n(h,\u2113,t)\u2208S\n\u2211\n(h\u2032,\u2113\u2032,t\u2032)\u2208C(h,\u2113,t)\n[ \u03b3 \u2212 s(h, \u2113, t) + s(h\u2032, \u2113\u2032, t\u2032) ]\n+ (4)\nwhere [z]+ = max(z, 0) and C(h, \u2113, t) is the set of corrupted triples. Depending on the application, this set can be defined in 3 different ways:\n1. C(h, \u2113, t) = {(h\u2032, \u2113\u2032, t\u2032) \u2208 [[E]] \u00d7L\u00d7 [[E]]|h\u2032 6= h and \u2113\u2032 6= \u2113 and t\u2032 6= t}\n2. C(h, \u2113, t) = {(h\u2032, \u2113, t\u2032) \u2208 [[E]]\u00d7 L\u00d7 [[E]]|h\u2032 6= h or t\u2032 6= t}\n3. C(h, \u2113, t) = {(h, \u2113\u2032, t) \u2208 [[E]]\u00d7 L\u00d7 [[E]]|\u2113\u2032 6= \u2113}\nThe margin \u03b3 is an hyperparameter that defines the minimum gap between the score of a positive triple and its negative one\u2019s. The stochastic gradient descent is performed in a minibatch setting. At each epoch the data set is shuffled and split into disjoint minibatches of m triples and 1 or 2 (see next section) negative triples are created for every positive one. We use two different learning rates \u03bb1 and \u03bb2, one for the Bigrams and one the Trigram model; they are kept fixed during the whole training.\nWe are interested in both Bigrams and Trigram terms of Tatec to capture different data patterns, and using a random initialization of all weights can not necessarily lead to such a solution. Hence, we first pre-train separately s1(h, \u2113, t) and s2(h, \u2113, t), and then we use these learned weights to initialize that of the full model. Training of Tatec is hence carried out in two phases: a (disjoint) pre-training and either a (joint) fine-tuning for Tatec-ft or a learning of the combination weights for Tatec-lc. Both pre-training and fine-tuning are stopped using early stopping on a validation set, and follow the training procedure that is summarized in Algorithm 1, for the unregularized case. Training of the linear combination weights of Tatec-lc is stopped at convergence of L-BFGS."}, {"heading": "4.2 Regularization", "text": "Previous work on embedding models have used two different regularization strategies: either by constraining the entity embeddings to have, at most, a 2-norm of value \u03c1e (Garc\u0301\u0131a-Dura\u0301n et al., 2014) or by adding a 2-norm penalty on the weights (Wang et al., 2014b; Lin et al., 2015) to the objective function (4). In the former, which we denote as hard regularization, regularization is performed by projecting the entity embeddings after each minibatch onto the 2-norm ball of radius \u03c1e. In the latter, which we denote as soft regularization, a penalization term of the form [||e||22\u2212\u03c12e]+ for the entity embeddings e is added. The soft scheme allows the 2-norm of the embeddings to grow further than \u03c1e, with a penalty.\nTo control the large capacity of the relation matrices in the Trigram model, we have adapted the two regularization schemes: in the hard scheme, we force the relation matrices to have, at most, a Frobenius norm of value \u03c1l, and in the soft one, we include a penalization term of the form [||R||2F \u2212 \u03c12l ]+ to the loss function (4) . As a result, in the soft scheme the following regularization term is added to the loss function (4): C1[||e1||22\u2212\u03c12e]++C2 (\n[||e2||22\u2212 \u03c12e]++[||R||2F \u2212\u03c12l ]+ )\n, where C1 and C2 are hyperparameters that weight the importance of each soft constraint. In terms of practicality, the bigger flexibility of the soft version comes with one more hyperparameter. In the following, the suffixes soft and hard are used to refer\n11\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\nAlgorithm 1 Learning unregularized Tatec. input Training set S = {(h, l, t)}, margin \u03b3, learning rates \u03bb1 and \u03bb2 1: initialization 2: - for Bigrams: e1 \u2190 uniform(\u2212 6\u221ad1 , 6\u221a d1 ) for each entity e\n3: r1, r2 \u2190 uniform(\u2212 6\u221ad1 , 6\u221a d1 ) for each \u2113 4: D \u2190 uniform(\u2212 6\u221a d1 , 6\u221a d1 ) 5: - for Trigram: e2 \u2190 uniform(\u2212 6\u221ad2 , 6\u221a d2 ) for each entity e 6: R \u2190 uniform(\u2212 6\u221a d2 , 6\u221a d2 ) for each \u2113 7: - for Tatec-ft: pre-trained weights of Bigrams and Trigram 8: All the embeddings are normalized to have a 2- or Frobenius-norm equal to 1. 9: loop\n10: Sbatch \u2190 sample(S,m) // sample a training minibatch of size m 11: Tbatch \u2190 \u2205 // initialize a set of pairs of examples 12: for (h, \u2113, t) \u2208 Sbatch do 13: (h\u2032, \u2113\u2032, t\u2032) \u2190 sample a negative triple according to the selected strategy C(h, \u2113, t) 14: Tbatch \u2190 Tbatch \u222a {( (h, \u2113, t), (h\u2032, \u2113\u2032, t\u2032) )}\n// record the pairs of examples 15: end for 16: Update parameters using gradients \u2211\n( (h,\u2113,t),(h\u2032,\u2113\u2032,t\u2032) )\n\u2208Tbatch\n\u2207 [ \u03b3 \u2212 s(h, \u2113, t) + s(h\u2032, \u2113\u2032, t\u2032) ]\n+ :\n17: - for Bigrams: s = s1 18: - for Trigram: s = s2 19: - for Tatec-ft: s = s1 + s2 20: end loop\nto either of those regularization scheme. Tatec has also an other implicit regularization factor since it is using the same entity representation for an entity regardless of its role as head or tail.\nTo sum up, in the hard regularization case, the optimization problem for Tatec-ft is:\nmin \u2211\n(h,\u2113,t)\u2208S\n\u2211\n(h\u2032,\u2113\u2032,t\u2032)\u2208C(h,\u2113,t)\n[ \u03b3 \u2212 s(h, \u2113, t) + s(h\u2032, \u2113\u2032, t\u2032) ]\n+\ns.t. ||ei1||2 \u2264 \u03c1e \u2200i \u2208 [[E]] ||ei2||2 \u2264 \u03c1e \u2200i \u2208 [[E]] ||R\u2113||F \u2264 \u03c1l \u2200\u2113 \u2208 [[L]]\nAnd in the soft regularization case it is:\nmin \u2211\n(h,\u2113,t)\u2208S\n\u2211\n(h\u2032,\u2113\u2032,t\u2032)\u2208C(h,\u2113,t)\n[\u03b3 \u2212 s(h, \u2113, t) + s(h\u2032, \u2113\u2032, t\u2032)]+ + C1 \u2211\ni\u2208[[E]]\n[||ei1||22 \u2212 \u03c12e]+\n+ C2 (\n\u2211\ni\u2208[[E]]\n[||ei2||22 \u2212 \u03c12e]+ + \u2211\n\u2113\u2208[[L]]\n[||R\u2113||2F \u2212 \u03c12l ]+ )\nwhere s(h, \u2113, t) = \u2329 r\u21131 \u2223 \u2223eh1 \u232a + \u2329 r\u21132 \u2223 \u2223et1 \u232a + \u2329 eh1 \u2223 \u2223D \u2223 \u2223et1 \u232a + \u2329 eh2 \u2223 \u2223R\u2113 \u2223 \u2223et2 \u232a in both cases.\n12"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": ""}, {"heading": "5. Experiments", "text": "This section presents various experiments to illustrate how competitive Tatec is with respect to several state-of-the-art models on 4 benchmarks from the literature: UMLS, Kinships, FB15k and SVO. The statistics of these data sets are given in Table 2. All versions of Tatec and of its components Bigrams and Trigram are compared with the state-ofthe-art models for each database."}, {"heading": "5.1 Experimental setting", "text": "This section details the protocols used in our various experiments."}, {"heading": "5.1.1 Datasets and metrics", "text": "Our experimental settings and evaluation metrics are borrowed from previous works, so as to allow for result comparisons.\nUMLS/Kinships Kinships (Denham, 1973) is a KB expressing the relational structure of the kinship system of the Australian tribe Alyawarra, and UMLS (McCray, 2003) is a KB of biomedical high-level concepts like diseases or symptoms connected by verbs like complicates, affects or causes. For these data sets, the whole set of possible triples, positive or negative, is observed. We used the area under the precision-recall curve as metric. The dataset was split in 10-folds for cross-validation: 8 for training, 1 for validation and the last one for test. Since the number of available negative triples is much bigger than the number of positive triples, the positive ones of each fold are replicated to match the number of negative ones. These negative triples correspond to the first setting of negative examples of Section 4.1. The number of training epochs was fixed to 100. Bigrams, Trigram and Tatec models were validated every 10 epochs using the AUC under the precision-recall curve as validation criterion over 1,000 randomly chosen validation triples - keeping the same proportion of negative and positive triples. For TransE, which we ran as baseline, we validated every 10 epochs as well.\nFB15k Introduced in (Bordes et al., 2013b), this data set is a subset of Freebase, a very large database of generic facts gathering more than 1.2 billion triples and 80 million entities. For evaluation on it, we used a ranking metric. The head of each test triple is replaced by each of the entities of the dictionary in turn, and the score is computed for each of them. These scores are sorted in descending order and the rank of the correct entity is stored. The same procedure is repeated when removing the tail instead of the head.\n13\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\nThe mean of these ranks is the mean rank, and the proportion of correct entities ranked in the top 10 is the hits@10. This is called the raw setting. In this setting correct positive triples can be ranked higher than the target one and hence be counted as errors. Following (Garc\u0301\u0131a-Dura\u0301n et al., 2014), in order to reduce this noise in the measure, and thus granting a clearer view on ranking performance, we remove all the positive triples that can be found in either the training, validation or testing set, except the target one, from the ranking. This setting is called filtered.\nSince FB15k is made up only of positive triples, the negative ones have to be generated. To do that, in each epoch we generate two negative triples per positive by replacing a single unit of the positive triple by a random entity (once the head and once the tail). This corruption approach implements the prior knowledge that unobserved triples are likely to be invalid, and has been widely used in previous work when learning embeddings of knowledge bases or words in the context of language models. These negative triples correspond to the second setting of negative examples of Section 4.1. We ran 500 training epochs for both TransE, Bigrams, Trigram and Tatec, and using the final filtered mean rank as validation criterion. If several models statistically have similar filtered mean ranks, we take the hits@10 as secondary validation criterion.6 Since for this dataset, training, validation and test sets are fixed, to give a confidence interval to our results, we randomly split the test set into 4 subsets before computing the evaluation metrics. We do this 5 times, and finally we compute the mean and the standard deviation over these 20 values for mean rank and hits@10.\nSVO SVO is a database of nouns connected by verbs through subject-verb-direct object relations and extracted from Wikipedia articles. It has been introduced in (Jenatton et al., 2012). For this database we perform a verb prediction task, where one has to assign the correct verb given two nouns acting as subject and direct object; in other words, we present results of ranking label given head and tail. As for FB15k, two ranking metrics are computed, the mean rank and the hits@5%, which is the proportion of predictions for which the correct verb is ranked in the top 5% of the total number of verbs, that is within the top 5% of 4,547 \u2248 227. We use the raw setting for SVO. Due to the different kind of task (predicting label instead of predicting head/tail), the negative triples have been generated by replacing the label by a random verb. These negative triples correspond to the third setting of negative examples of Section 4.1. For TransE, Bigrams and Trigram the number of epochs has been fixed to 500 and they were validated every 10 epochs. For Tatec we ran only 10 epochs, and validated for each. The mean rank has been chosen as validation criterion over 1,000 random validation triples."}, {"heading": "5.1.2 Implementation", "text": "To pre-train our Bigrams and Trigram models we validated the learning rate for the stochastic gradient descent among {0.1, 0.01, 0.001, 0.0001} and the margin among {0.1, 0.25, 0.5, 1}. The radius \u03c1e determining the value from which the L2-norm of the entity embeddings are penalized has been fixed to 1, but the radius \u03c1l of the Trigram model has\n6. Results on both FB15k and SVO with TransE and Tatec are provided in (Garc\u0301\u0131a-Dura\u0301n et al., 2014), however in these works the hyperparameters were validated on a smaller validation set, that led to suboptimal results.\n14"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "been validated among {0, 1, 5, 10, 20}. Due to the different size of these KBs, the embedding dimension d has been validated in different ranges. For SVO it has been selected among {25, 50}, among {50, 75, 100} for FB15k and among {10, 20, 40} for UMLS and Kinships. When the soft regularization is applied, the regularization parameter has been validated among {0, 0.0001, 0.001, 0.01, 0.1, 1, 10, 100}. For fine-tuning Tatec, the learning rates were selected among the same values for learning the Bigrams and Trigram models in isolation, independent of the values chosen for pre-training, and so are the margin and for the penalization terms C1 and C2 if the soft regularization is used. The configurations of the model selected using their performance on the validation set are given in Appendix A.\nTraining of the combination weights of Tatec-lc is carried out in an iterative way, by alternating optimization of \u03b4 parameters via L-BFGS, and update of \u03c3 parameters using \u03c3\u2217\u2113 = \u03b1||\u03b4\u2113||2\u2211 k ||\u03b4k||2 , until some stopping criterion is reached. The \u03b4 parameters are initialized to 1 and the \u03b1 value is validated among {0.1, 1, 10, 50, 100, 200, 500, 1000}."}, {"heading": "5.1.3 Baselines", "text": "Variants We performed breakdown experiments with 2 different versions of Tatec to assess the impact of its various aspects. These variants are:\n\u2022 Tatec-ft-no-pretrain: Tatec-ft without pre-training s1(h, l, t) and s2(h, l, t).\n\u2022 Tatec-ft-shared: Tatec-ft but sharing the entities embeddings between s1(h, l, t) and s2(h, l, t) and without pre-training.\nThe experiments with these 3 versions of Tatec have been performed in the soft regularization setting. Their hyperparameters were chosen using the same grid as above.\nPrevious models We retrained TransE ourselves with the same hyperparameter grid as for Tatec and used it as a running baseline on all datasets, using either soft or hard regularization. In addition, we display the results of the best performing methods of the literature on each dataset, with values extracted from the original papers.\nOnUMLS andKinships, we also report the performance of the 3-way modelsRESCAL, LFM and the 2-way SME(linear). On FB15k, recent variants of TransE, such as TransH, TransR and cTransR (Lin et al., 2015) have been chosen as main baselines. Both in TransH and TransR/cTransR, the optimal values of the hyperparameters as the dimension, the margin or the learning rate have been selected within similar ranges as those for Tatec. On SVO, we compare Tatec with three different approaches: Counts, the 2-way model SME(linear) and the 3-way LFM. Counts is based on the direct estimation of probabilities of triples (head, label, tail) by using the number of occurrences of pairs (head, label) and (label, tail) in the training set. The results for these models have been extracted from (Jenatton et al., 2012), and we followed their experimental setting. Since the results in this paper are only available in the raw setting, we restricted our experiments to this configuration on SVO as well."}, {"heading": "5.2 Results", "text": "We recall that the suffixes soft or hard refer to the regularization scheme used, and the suffixes ft and lc to the combination strategy of Tatec.\n15\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet"}, {"heading": "5.2.1 UMLS and Kinships", "text": "The results for these two knowledge bases are provided in Table 3. In UMLS, most models are performing well. The combination of the Bigrams and Trigram models is slightly better than the Trigram alone but it is not significant. It seems that the constituents\n16"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "of Tatec, Bigrams and Trigram, do not encode very complementary information and their combination does not bring much improvement. Basically, on this dataset, many methods are somewhat as efficient as the best one, LFM. The difference between TransE and Bigrams on this dataset illustrates the potential impact of the diagonal matrix D, which does not constrain embeddings of both head and tail entities of a triple to be similar.\nRegarding Kinships, there is a big gap between 2-way models like TransE and 3- way models like RESCAL. The cause of this deterioration comes from a peculiarity of the positive triples of this KB: each entity appears 104 times \u2013 the number of entities in this KB \u2013 as head and it is connected to the 104 entities \u2013 even itself \u2013 only once. In other words, the conditional probabilities P (head|tail) and P (tail|head) are totally uninformative. This has a very important consequence for the 2-way models since they highly rely on such information: forKinships, the interaction head-tail is, at best, irrelevant, though in practice this interaction may even introduce noise.\nDue to the poor performance of the Bigrams model, when it is combined with the Trigram model this combination can turn out to be detrimental w.r.t. to the performance of Trigram in isolation: 2-way models are quite noisy for this KB and we cannot take advantage of them. On the other side the Trigram model logically reaches a very similar performance to RESCAL, and similar to LFM as well. Performance of Tatec versions based on fine-tuning of the parameters (Tatec-ft) are worse than that of Trigram because Bigrams degrades the model. Tatec-lc, using a \u2013 potentially sparse \u2013 linear combination of the models, does not have this drawback since it can completely cancel out the influence of bigram model. As a conclusion from the experiments in this KB, when one of the components of Tatec is quite noisy, we should directly remove it and Tatec-lc can do it automatically. The soft regularization setting seems to be slightly better also."}, {"heading": "5.2.2 FB15k", "text": "Table 4 (left) displays results on FB15k. Unlike for Kinships, here the 2-way models outperform the 3-way models in both mean rank and hits@10. The simplicity of the 2-way models seems to be an advantage in FB15k: this is something that was already observed in cite (Yang, Yih, He, Gao, & Deng, 2014a). The combination of the Bigrams and Trigram models into Tatec leads to an impressive improvement of the performance, which means that for this KB the information encoded by these 2 models are complementary. Tatec outperforms all the existing methods \u2013 except TransE in mean rank \u2013 with a wide margin in hits@10. Bigrams-soft performs roughly like cTransR, and better than its counterpart Bigrams-hard. Though Trigram-soft is better than Trigram-hard as well, Tatec-ft-soft and Tatec-ft-hard converge to very similar performances. Fine-tuning the parameters is this time better than simply using a linear combination even if Tatec-lc is still performing well.\nTatec-ft outperforms both variants Tatec-shared and Tatec-no-pretrain by a wide margin, which confirms that both pre-training and the use of different embeddings spaces are essential to properly collect the different data patterns of the Bigrams and Trigram models: by sharing the embeddings we constrain too much the model, and without pre-training Tatec is not able to encode the complementary information of its constituents. The performance of Tatec in these cases is in-between the performances of the soft version\n17\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\nof the Bigrams and Trigram models, which indicates that they converge to a solution that is not even able to reach the best performance of their constituent models.\nWe also broke down the results by type of relation, classifying each relationship according to the cardinality of their head and tail arguments. A relationship is considered as 1-to-1, 1-to-M, M-to-1 or M-M regarding the variety of arguments head given a tail and vice versa. If the average number of different heads for the whole set of unique pairs (label, tail) given a relationship is below 1.5 we have considered it as 1, and the same in the other way around. The number of relations classified as 1-to-1, 1-to-M, M-to-1 and M-M is 353, 305, 380 and 307, respectively. The results are displayed in the Table 5. Bigrams and Trigram models cooperate in a constructive way for all the types of relationship when predicting both the head and tail. Tatec-ft is remarkably better for M-to-M relationships."}, {"heading": "5.2.3 SVO", "text": "Tatec achieves also a very good performance on this task since it outperforms all previous methods on both metrics. As before, both regularization strategies lead to very similar performances, but the soft setting is slightly better. In terms of hits@5%, Tatec outperforms its constituents, however in terms of mean rank the Bigrams model is considerably worse than Trigram and Tatec. The performance of LFM is in between the Trigram and Bigrams models, which confirms the fact that sharing the embeddings in the 2- and 3-way terms can actually prevent to make the best use of both types of interaction.\nAs for Kinships, since here the performance of Bigrams is much worse than that of Trigram, Tatec-lc is very competitive. It seems that when Bigrams and Trigram perform well for different types of relationships (such as in FB15k), then combining them via fine-tuning (i.e. Tatec-ft) allows to get the best of both; however, if one of them is consistently performing worse on most relationships as it seems to happen for Kinships and SVO, then Tatec-lc is a good choice since it can cancel out any influence of the bad model. However, Table 6, depicting training times of various models on FB15k, shows that training Tatec-lc is around twice as slow as training Tatec-ft."}, {"heading": "5.3 Illustrative experiments", "text": "This last experimental section provides some illustrations and insights on the performance of Tatec and TransE.\n18"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": ""}, {"heading": "5.3.1 TransE and symmetrical relationships", "text": "TransE has a peculiar behavior: it performs very well on FB15k but quite poorly on all the other datasets. Looking in detail at FB15k, we noticed that this database is made up of a lot of pairs of symmetrical relationships such as /film/film/subjects and /film/film subject/films, or /music/album/genre and /music/genre/albums. The simplicity of the translation model of TransE works well when, for predicting the validity of an unknown triple, the model can make use of its symmetrical counterpart if it was present in the training set. Specifically, 45,817 out of 59,071 test triples of FB15k have a symmetrical triple in the training set. If we split the test triples into two subsets, one containing the test triples for which a symmetrical triple has been used in the learning stage and the other containing those ones for which a symmetrical triple does not exist in the training set, the overall mean rank of TransE of 50.7 is decomposed into a mean rank of 17.5 and 165.7, and the overall hits@10 of 71.5 is decomposed into 76.6 and 53.7, respectively. TransE makes a very adequate use of this particular feature. In the original TransE paper (Bordes et al., 2013b), the algorithm is shown to perform well on FB15k and on a dataset extracted from the KB WordNet (Miller, 1995): we suspect that the WordNet dataset also contains symmetrical counterparts of test triples in the training set (such as hyperonym vs hyponym, meronym vs holonym).\nTatec can also make use of this information and is, as expected, much better on relations with symmetrical counterparts in train: on FB15k, the mean rank of Tatec-ft-soft is of 17.5 for relations with symmetrical counterparts 197.4 instead and hits@10 is of 84.4% instead of 50%. Yet, as results on other datasets show, Tatec is also able to generalize when more complex information needs to be taken into account.\n19\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet"}, {"heading": "5.3.2 Anecdotal examples", "text": "Some examples of predictions by Tatec on FB15k are displayed in Table 7. In the first row, we want to know the answer to the question What is the location of the polish national football team?; among the possible answers we find not only locations, but more specifically countries, which makes sense for a national team. For the question What is the topic of the film \u2019Remember the titans\u2019? the top-10 candidates may be potential film topics. Same for the answers to the question Which religion does Noam Chomsky belong to? that can all be typed as religions. In these examples, both sides of the relationship are clearly typed: a certain type of entity is expected in head or tail (country, religion, person, movie, etc.). The operators of Tatec may then operate on specific regions of the embedding space. On the contrary, the relationship /webpage/category is an example of non-typed relationship. This one, which could actually be seen as an attribute rather than a relationship, indicates if the entity head has a topic website or an official website. Since many types of entities can have a webpage and there is little to no correlation among relationships, predicting the left-hand side argument is nearly impossible.\nFigures 2a and 2b show 2D projections of embeddings of selected entities for the Trigram and Bigrams models trained on FB15k, respectively, obtained by projecting them using t-SNE (Van der Maaten & Hinton, 2008). This projection has been carried out only for Freebase entities whose profession is either singer or attorney in the USA. We can observe in Figure 2a that all attorneys are clustered and separated from the singers, except one, which corresponds to the multifaceted Fred Thompson7. However, embeddings of the singers are not clearly clustered: since singers can appear in a multitude of triples, their layout is the result of a compendium of (sometimes heterogeneous) categories. To illustrate graphically the different data patterns to which Bigrams and Trigram respond, we focus on the small cluster made up of Japanese singers that can be seen in Figure 2a (Trigram). In Figure 2b (Bigrams) however, these same entities are more diluted in the whole set of singers. Looking at the neighboring embeddings of these Japanese singers entities in Figure 2b, we find entities highly connected to japan like yoko ono \u2013 born in Japan, vic mignogna,\n7. Apart from being an attorney, he is an actor, a radio personality, a lawyer and a politician\n20"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "greg ayres, chris patton or laura bailey \u2013 all of them worked in the dubbing industry of Japanese anime movies and television series. This shows the impact of the interaction between heads and tails in the Bigrams model: it tends to push together entities connected in triples whatever the relation. In this case, this forms a Japanese cluster.\nTable 8 shows examples of predictions on SVO. In the first example, though run is the target verb for the pair (bus, service), other verbs like provide or offer are good matches as well. Similarly, non-target verbs like establish or join, and lead, participate or attend are good matches for the second and third examples ((emigrant, country) and (minister, protest)) respectively. The fourth and fifth instances show an example of very heterogeneous performance for a same relationship (the target verb is transport in both cases) which can be easily explained from a semantic point of view: transport is a very good fit given the pair (vessel, coal), whereas a TV channel transports video is not a very natural way to express that one can watch videos in a TV channel, and hence this leads to a very poor performance \u2013 the target verb is ranked #696. The sixth example is particularly interesting, since even if the target verb, colonize, is ranked very far in the list (#344), good candidates for the pair (Great Britain, North America) can be found in the top-10. Some of them have a similar representation as colonize, because they are almost synonyms, but they are ranked much higher. This is an effect of the verb frequency.\nAs illustrated in Figure 3a, the more frequent a relationship is, the higher its Frobenius norm is; hence, verbs with similar meanings but unbalanced frequencies can be ranked differently, which explains that a rare verb, such as colonize, can be ranked much worse than other semantically similar words. A consequence of this relation between the Frobenius norm and the appearance frequency is that usual verbs tend to be highly ranked even though sometimes they are not good matches, due to the influence of the norm in the score. In that figure, we can see that the Frobenius norm of the relation matrices are larger in the regularized (soft) case than in the unregularized case. This happens because we fixed a very large value for both C2 and \u03c1l in the regularized case (\u03c1e is fixed to 1). It imposes a strong constraint on the norm of the entities but not on the relationship matrices and makes the Frobenius norm of these matrices absorb the whole impact of the norm of the score, and, thus, the impact of the verb frequency. We could down-weight the importance of the verb frequency by tuning the parameters \u03c1l and C2 to enforce a stronger constraint.\n21\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\nTable 9: Examples of predictions on SVO for a regularized and an unregularized Trigram. In bold is the expected correct answer.\nTriple Top-10 predictions\nUnregularized Regularized (soft)\n(bus, ? , service) use, operate, offer, call, build, provide, use, have, include, make,\ninclude, have, know, make, create offer, take, carry, serve, run\n(emigrant, ? , country) use, represent, save, flee, visit, flee, become, come, enter, found, come, make, leave, create, know include, form, make, leave, join (minister, ? , protest) bring, lead, reach, have, become, lead, organize, conduct, participate, join say, include, help, leave, appoint make, involve, support, suppress, raise\n(vessel, ? , coal) take, use, have, carry, make, use, transport, make, carry, deliver,\nhold, move, become, fill, serve send, contain, supply, leave, provide\n(tv channel, ?, video) make, include, write, know, have, release, make, feature, produce, have,\nproduce, use, play, give, become include, use, take, show, base\n(great britain, ?, north america) have, use, include, make, leave, include, found, become, run,name,\nbecome, know, take, call, build move, annex, form, establish, dominate\nFigure 9 shows the effect of the verb frequency in these two models when predicting the same missing verb as in Table 8.\nBreaking down the performance by relationship, this is translated into a strong relation between the performance of a relationship and its frequency (see Figure 3b). However, the same relation between the 2-norm of the entities embeddings and their frequency is not observed, which can be explained given that an entity can appear in the left and right argument in an unbalanced way."}, {"heading": "6. Conclusion", "text": "This paper presents Tatec, a tensor factorization method that satisfactorily combines 2- and 3-way interaction terms to obtain a performance better than the best of either constituent. Different data patterns are properly encoded thanks to the use of different embedding spaces and of a two-phase training (pre-training and fine-tuning/linear-combination). Experiments on four benchmarks for different tasks and with different quality measures prove the strength and versatility of this model, which could actually be seen as a generalization of a lot of existing works. Our experiments also allow us to draw some conclusions\n22"}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "about the two usual regularization schemes used so far in these embedding-based models: they both achieve similar performances, even if soft regularization appears slightly more efficient but with one extra-hyperparameter."}, {"heading": "Acknowledgments", "text": "This work was carried out in the framework of the Labex MS2T (ANR-11-IDEX-0004-02), and was funded by the French National Agency for Research (EVEREST-12-JS02-005-01)."}, {"heading": "Appendices", "text": ""}, {"heading": "Appendix A. Optimal hyperparameters", "text": "The optimal configurations for UMLS are: - TransE-soft: d = 40, \u03bb = 0.01, \u03b3 = 0.5, C = 0; - Bigrams-soft: d1 = 40, \u03bb1 = 0.01, \u03b3 = 0.5, C = 0.1; - Trigram-soft: d2 = 40, \u03bb2 = 0.01, \u03b3 = 1, C = 0.1, \u03c1l = 5; - Tatec-soft: d1 = 40, d2 = 40, \u03bb1 = \u03bb2 = 0.001, \u03b3 = 1, C1 = C2 = 0.01, \u03c1l = 5; - TransE-hard: d = 40, \u03bb = 0.01, \u03b3 = 0.1; - Bigrams-hard: d1 = 40, \u03bb1 = 0.01, \u03b3 = 0.5; - Trigram-hard: d2 = 40, \u03bb2 = 0.01, \u03b3 = 1, \u03c1l = 10; - Tatec-hard: d1 = 40, d2 = 40, \u03bb1 = \u03bb2 = 0.001, \u03b3 = 1, \u03c1l = 10. - Tatec-linear-comb: d1 = 40, d2 = 40, \u03b3 = 0.5, \u03b1 = 50.\nThe optimal configurations for Kinships are: - TransE-soft: d = 40, \u03bb = 0.01, \u03b3 = 1, C = 0; - Bigrams-soft: d1 = 40, \u03bb1 = 0.01, \u03b3 = 1, C = 1; - Trigram-soft: d2 = 40, \u03bb2 = 0.01, \u03b3 = 0.5, C = 0.1, \u03c1l = 5; - Tatec-soft: d1 = 40, d2 = 40, \u03bb1 = \u03bb2 = 0.001, \u03b3 = 1, C1 = 100, C2 = 0.0001, \u03c1l = 10; - TransE-hard: d = 40, \u03bb = 0.01, \u03b3 = 1; - Bigrams-hard: d1 = 40, \u03bb1 = 0.01, \u03b3 = 1; - Trigram-hard: d2 = 40, \u03bb2 = 0.01, \u03b3 = 0.5, \u03c1l = 10; - Tatec-hard d1 = 40, d2 = 40, \u03bb1 = \u03bb2 = 0.001, \u03b3 = 1, \u03c1l = 10. - Tatec-linear-comb: d1 = 40, d2 = 40, \u03b3 = 1, \u03b1 = 10.\nThe optimal configurations for FB15k are: - TransE-soft: d = 100, \u03bb = 0.01, \u03b3 = 0.25, C = 0.1; - Bigrams-soft: d1 = 100, \u03bb1 = 0.01, \u03b3 = 1, C = 0; - Trigram-soft: d2 = 50, \u03bb2 = 0.01, \u03b3 = 0.25, C = 0.001, \u03c1l = 1; - Tatec-soft: d1 = 100, d2 = 50, \u03bb1 = \u03bb2 = 0.001, \u03b3 = 0.5, C1 = C2 = 0; - TransE-hard: d = 100, \u03bb = 0.01, \u03b3 = 0.25; - Bigrams-hard: d1 = 100, \u03bb1 = 0.01, \u03b3 = 0.25; - Trigram-hard: d2 = 50, \u03bb2 = 0.01, \u03b3 = 0.25, \u03c1l = 5;\n23\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\n- Tatec-hard: d1 = 100, d2 = 50, \u03bb1 = \u03bb2 = 0.001, \u03b3 = 0.25, \u03c1l = 5; - Tatec-no-pret: d1 = 100, d2 = 50, \u03bb1 = \u03bb2 = 0.01, \u03b3 = 0.25, C1 = 0, C2 = 0.001, \u03c1l = 1; - Tatec-shared: d1 = d2 = 75, \u03bb1 = \u03bb2 = 0.01, \u03b3 = 0.25, C1 = C2 = 0.001, \u03c1l = 5; - Tatec-linear-comb: d1 = 100, d2 = 50, \u03b3 = 0.25, \u03b1 = 200.\nThe optimal configurations for SVO are: - TransE-soft: d = 50, \u03bb = 0.01, \u03b3 = 0.5, C = 1; - Bigrams-soft: d1 = 50, \u03bb1 = 0.01, \u03b3 = 1, C = 0.1; - Trigram-soft: d2 = 50, \u03bb2 = 0.01, \u03b3 = 1, , C = 10, \u03c1l = 20; - Tatec-soft: d1 = 50, d2 = 50, \u03bb1 = \u03bb2 = 0.0001, \u03b3 = 1, C1 = 0.1, C2 = 1, \u03c1l = 20; - TransE-hard: d = 50, \u03bb = 0.01, \u03b3 = 0.5; - Bigrams-hard: d1 = 50, \u03bb1 = 0.01, \u03b3 = 1; - Trigram-hard: d2 = 50, \u03bb2 = 0.01, \u03b3 = 1, \u03c1l = 20; - Tatec-hard: d1 = 50, d2 = 50, \u03bb1 = \u03bb2 = 0.0001, \u03b3 = 1, \u03c1l = 20. - Tatec-linear-comb: d1 = 50, d2 = 50, \u03b3 = 1, \u03b1 = 50."}, {"heading": "Embeddings Models for Link Prediction in KBs", "text": "Kok, S., & Domingos, P. (2007). Statistical predicate invention. In Proceedings of the 24th international conference on Machine learning, ICML \u201907, pp. 433\u2013440.\nKoren, Y., Bell, R., & Volinsky, C. (2009). Matrix factorization techniques for recommender systems. Computer, 42 (8), 30\u201337.\nLao, N., Mitchell, T., & Cohen, W. W. (2011). Random walk inference and learning in a large scale knowledge base. In Proceedings of the Conference on Empirical Methods in Natural Language Processing, pp. 529\u2013539. Association for Computational Linguistics.\nLin, Y., Liu, Z., Sun, M., Liu, Y., & Zhu, X. (2015). Learning entity and relation embeddings for knowledge graph completion. In Proceedings of AAAI\u201915.\nMcCray, A. T. (2003). An upper level ontology for the biomedical domain. Comparative and Functional Genomics, 4, 80\u201388.\nMiller, G. (1995). WordNet: a Lexical Database for English. Communications of the ACM, 38 (11), 39\u201341.\nNavigli, R., & Velardi, P. (2005). Structural semantic interconnections: a knowledge-based approach to word sense disambiguation. Pattern Analysis and Machine Intelligence, IEEE Transactions on, 27 (7), 1075\u20131086.\nNickel, M., Tresp, V., & Kriegel, H.-P. (2011). A three-way model for collective learning on multi-relational data. In Proceedings of the 28th International Conference on Machine Learning (ICML-11), pp. 809\u2013816.\nPonzetto, S. P., & Strube, M. (2006). Exploiting semantic role labeling, wordnet and wikipedia for coreference resolution. In Proceedings of the main conference on Human Language Technology Conference of the North American Chapter of the Association of Computational Linguistics, pp. 192\u2013199. Association for Computational Linguistics.\nSalakhutdinov, R., & Srebro, N. (2010). Collaborative filtering in a non-uniform world: Learning with the weighted trace norm. tc (X), 10, 2.\nSocher, R., Chen, D., Manning, C. D., & Ng, A. Y. (2013). Reasoning With Neural Tensor Networks For Knowledge Base Completion. In Advances in Neural Information Processing Systems 26.\nSutskever, I., Salakhutdinov, R., & Tenenbaum, J. (2009). Modelling relational data using bayesian clustered tensor factorization. In Adv. in Neur. Inf. Proc. Syst. 22.\nVan der Maaten, L., & Hinton, G. (2008). Visualizing data using t-sne. Journal of Machine Learning Research, 9 (2579-2605), 85.\nWang, Y. J., & Wong, G. Y. (1987). Stochastic blockmodels for directed graphs. Journal of the American Statistical Association, 82 (397).\nWang, Z., Zhang, J., Feng, J., & Chen, Z. (2014a). Knowledge graph and text jointly embedding. In Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP).\nWang, Z., Zhang, J., Feng, J., & Chen, Z. (2014b). Knowledge graph embedding by translating on hyperplanes. In Proceedings of the Twenty-Eighth AAAI Conference on Artificial Intelligence, pp. 1112\u20131119.\n25\nGarc\u0301\u0131a-Dura\u0301n, Bordes, Usunier & Grandvalet\nYang, B., Yih, W.-t., He, X., Gao, J., & Deng, L. (2014a). Learning multi-relational semantics using neural-embedding models. CoRR, abs/1411.4072.\nYang, M.-C., Duan, N., Zhou, M., & Rim, H.-C. (2014b). Joint relational embeddings for knowledge-based question answering. In Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP), pp. 645\u2013650.\nZhang, J., Salwen, J., Glass, M., & Gliozzo, A. (2014). Word semantic representations using bayesian probabilistic tensor factorization. In Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP).\n26\n\u221240 \u221230 \u221220 \u221210 0 10 20 30 40 50\nSingers\nJapanese singers\nAttorneys in the USA\n\u221260 \u221240 \u221220 0 20 40\nSingers\nJapanese singers\nAttorneys in the USA"}], "references": [{"title": "A semantic matching energy function for learning with multi-relational data", "author": ["A. Bordes", "X. Glorot", "J. Weston", "Y. Bengio"], "venue": "Machine Learning,", "citeRegEx": "Bordes et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Bordes et al\\.", "year": 2013}, {"title": "Translating embeddings for modeling multi-relational data", "author": ["A. Bordes", "N. Usunier", "A. Gar\u0107\u0131a-Dur\u00e1n", "J. Weston", "O. Yakhnenko"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "Bordes et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Bordes et al\\.", "year": 2013}, {"title": "Typed tensor decomposition of knowledge bases for relation extraction", "author": ["Chang", "K.-W", "Yih", "W.-t", "B. Yang", "C. Meek"], "venue": "In Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP),", "citeRegEx": "Chang et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Chang et al\\.", "year": 2014}, {"title": "The detection of patterns in Alyawarra nonverbal behavior", "author": ["W. Denham"], "venue": "Ph.D. thesis,", "citeRegEx": "Denham,? \\Q1973\\E", "shortCiteRegEx": "Denham", "year": 1973}, {"title": "Knowledge vault: A web-scale approach to probabilistic knowledge fusion", "author": ["X. Dong", "E. Gabrilovich", "G. Heitz", "W. Horn", "N. Lao", "K. Murphy", "T. Strohmann", "S. Sun", "W. Zhang"], "venue": "In Proceedings of the 20th ACM SIGKDD international conference on Knowledge discovery and data mining,", "citeRegEx": "Dong et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Dong et al\\.", "year": 2014}, {"title": "Effective blending of two and threeway interactions for modeling multi-relational data", "author": ["A. Gar\u0107\u0131a-Dur\u00e1n", "A. Bordes", "N. Usunier"], "venue": "In ECML PKDD", "citeRegEx": "Gar\u0107\u0131a.Dur\u00e1n et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Gar\u0107\u0131a.Dur\u00e1n et al\\.", "year": 2014}, {"title": "A latent factor model for highly multi-relational data", "author": ["R. Jenatton", "N. Le Roux", "A. Bordes", "G. Obozinski"], "venue": null, "citeRegEx": "Jenatton et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Jenatton et al\\.", "year": 2012}, {"title": "Learning systems of concepts with an infinite relational model", "author": ["C. Kemp", "J.B. Tenenbaum", "T.L. Griffiths", "T. Yamada", "N. Ueda"], "venue": "In Proc. of the 21st national conf. on Artif. Intel. (AAAI),", "citeRegEx": "Kemp et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Kemp et al\\.", "year": 2006}, {"title": "Building a large-scale knowledge base for machine translation", "author": ["K. Knight", "S.K. Luk"], "venue": "In AAAI,", "citeRegEx": "Knight and Luk,? \\Q1994\\E", "shortCiteRegEx": "Knight and Luk", "year": 1994}, {"title": "Statistical predicate invention", "author": ["S. Kok", "P. Domingos"], "venue": "In Proceedings of the 24th international conference on Machine learning,", "citeRegEx": "Kok and Domingos,? \\Q2007\\E", "shortCiteRegEx": "Kok and Domingos", "year": 2007}, {"title": "Matrix factorization techniques for recommender", "author": ["Y. Koren", "R. Bell", "C. Volinsky"], "venue": "systems. Computer,", "citeRegEx": "Koren et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Koren et al\\.", "year": 2009}, {"title": "Random walk inference and learning in a large scale knowledge base", "author": ["N. Lao", "T. Mitchell", "W.W. Cohen"], "venue": "In Proceedings of the Conference on Empirical Methods in Natural Language Processing,", "citeRegEx": "Lao et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Lao et al\\.", "year": 2011}, {"title": "Learning entity and relation embeddings for knowledge graph completion", "author": ["Y. Lin", "Z. Liu", "M. Sun", "Y. Liu", "X. Zhu"], "venue": "In Proceedings of AAAI\u201915", "citeRegEx": "Lin et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Lin et al\\.", "year": 2015}, {"title": "An upper level ontology for the biomedical domain", "author": ["A.T. McCray"], "venue": "Comparative and Functional Genomics,", "citeRegEx": "McCray,? \\Q2003\\E", "shortCiteRegEx": "McCray", "year": 2003}, {"title": "WordNet: a Lexical Database for English", "author": ["G. Miller"], "venue": "Communications of the ACM,", "citeRegEx": "Miller,? \\Q1995\\E", "shortCiteRegEx": "Miller", "year": 1995}, {"title": "Structural semantic interconnections: a knowledge-based approach to word sense disambiguation", "author": ["R. Navigli", "P. Velardi"], "venue": "Pattern Analysis and Machine Intelligence, IEEE Transactions on,", "citeRegEx": "Navigli and Velardi,? \\Q2005\\E", "shortCiteRegEx": "Navigli and Velardi", "year": 2005}, {"title": "A three-way model for collective learning on multi-relational data", "author": ["M. Nickel", "V. Tresp", "Kriegel", "H.-P"], "venue": "In Proceedings of the 28th International Conference on Machine Learning", "citeRegEx": "Nickel et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Nickel et al\\.", "year": 2011}, {"title": "Exploiting semantic role labeling, wordnet and wikipedia for coreference resolution", "author": ["S.P. Ponzetto", "M. Strube"], "venue": "In Proceedings of the main conference on Human Language Technology Conference of the North American Chapter of the Association of Computational Linguistics,", "citeRegEx": "Ponzetto and Strube,? \\Q2006\\E", "shortCiteRegEx": "Ponzetto and Strube", "year": 2006}, {"title": "Collaborative filtering in a non-uniform world: Learning with the weighted trace norm", "author": ["R. Salakhutdinov", "N. Srebro"], "venue": null, "citeRegEx": "Salakhutdinov and Srebro,? \\Q2010\\E", "shortCiteRegEx": "Salakhutdinov and Srebro", "year": 2010}, {"title": "Reasoning With Neural Tensor Networks For Knowledge Base Completion", "author": ["R. Socher", "D. Chen", "C.D. Manning", "A.Y. Ng"], "venue": "In Advances in Neural Information Processing Systems", "citeRegEx": "Socher et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Socher et al\\.", "year": 2013}, {"title": "Modelling relational data using bayesian clustered tensor factorization", "author": ["I. Sutskever", "R. Salakhutdinov", "J. Tenenbaum"], "venue": "In Adv. in Neur. Inf. Proc. Syst", "citeRegEx": "Sutskever et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Sutskever et al\\.", "year": 2009}, {"title": "Visualizing data using t-sne", "author": ["L. Van der Maaten", "G. Hinton"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "Maaten and Hinton,? \\Q2008\\E", "shortCiteRegEx": "Maaten and Hinton", "year": 2008}, {"title": "Stochastic blockmodels for directed graphs", "author": ["Y.J. Wang", "G.Y. Wong"], "venue": "Journal of the American Statistical Association,", "citeRegEx": "Wang and Wong,? \\Q1987\\E", "shortCiteRegEx": "Wang and Wong", "year": 1987}, {"title": "Knowledge graph and text jointly embedding", "author": ["Z. Wang", "J. Zhang", "J. Feng", "Z. Chen"], "venue": "In Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP)", "citeRegEx": "Wang et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Wang et al\\.", "year": 2014}, {"title": "Knowledge graph embedding by translating on hyperplanes", "author": ["Z. Wang", "J. Zhang", "J. Feng", "Z. Chen"], "venue": "In Proceedings of the Twenty-Eighth AAAI Conference on Artificial Intelligence,", "citeRegEx": "Wang et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Wang et al\\.", "year": 2014}, {"title": "Learning multi-relational semantics using neural-embedding models. CoRR, abs/1411.4072", "author": ["B. Yang", "Yih", "W.-t", "X. He", "J. Gao", "L. Deng"], "venue": null, "citeRegEx": "Yang et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Yang et al\\.", "year": 2014}, {"title": "Joint relational embeddings for knowledge-based question answering", "author": ["Yang", "M.-C", "N. Duan", "M. Zhou", "Rim", "H.-C"], "venue": "In Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP),", "citeRegEx": "Yang et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Yang et al\\.", "year": 2014}, {"title": "Word semantic representations using bayesian probabilistic tensor factorization", "author": ["J. Zhang", "J. Salwen", "M. Glass", "A. Gliozzo"], "venue": "In Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP)", "citeRegEx": "Zhang et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Zhang et al\\.", "year": 2014}], "referenceMentions": [{"referenceID": 12, "context": ", 2014b) and TransR (Lin et al., 2015).", "startOffset": 20, "endOffset": 38}, {"referenceID": 6, "context": "The Latent Factor Model (LFM) (Jenatton et al., 2012) and the Neural Tensor Networks (NTN) (Socher, Chen, Manning, & Ng, 2013) use combinations of a 3-way model with a more constrained 2-way model, and in that sense are closer to our algorithm Tatec.", "startOffset": 30, "endOffset": 53}, {"referenceID": 11, "context": "In that line of work, the Path Ranking Algorithm (PRA) (Lao et al., 2011) estimates the probability of an unobserved fact as a function of the different paths that go from the subject to the object in the multi-relational graph; learning consists in finding, for each relationship, a weight associated to a kind of path (represented as a sequence of relationships) linking two entities.", "startOffset": 55, "endOffset": 73}, {"referenceID": 16, "context": "The 3-way term corresponds exactly to the model used by the collective factorization method RESCAL (Nickel et al., 2011), and we chose it for its high expressiveness on", "startOffset": 99, "endOffset": 120}, {"referenceID": 6, "context": "The combination of 2- and 3way terms has already been used in (Jenatton et al., 2012; Socher et al., 2013), but, besides a different parameterization, Tatec contrasts with them by the additional freedom brought by using different embeddings in the two interaction terms.", "startOffset": 62, "endOffset": 106}, {"referenceID": 19, "context": "The combination of 2- and 3way terms has already been used in (Jenatton et al., 2012; Socher et al., 2013), but, besides a different parameterization, Tatec contrasts with them by the additional freedom brought by using different embeddings in the two interaction terms.", "startOffset": 62, "endOffset": 106}, {"referenceID": 6, "context": "In LFM (Jenatton et al., 2012), constraints were imposed on the relation-dependent matrix of the 3-way terms (low rank in a limited basis of rank-one matrices), the relation vectors r1 and r l 2 were constrained to be in the image of the matrix (D = 0 in their work).", "startOffset": 7, "endOffset": 30}, {"referenceID": 19, "context": "We are similar to NTN (Socher et al., 2013) in the respect that we do not share any parameter between relations.", "startOffset": 22, "endOffset": 43}, {"referenceID": 16, "context": "The 2-way + 3-way interaction model we propose can be seen as the 3-mode tensor version of this \u201cbiased\u201d version of matrix factorization: the trigram term (T) is the collective matrix factorization parameterization of the RESCAL algorithm (Nickel et al., 2011) and plays a role analogous to the term \u3008", "startOffset": 239, "endOffset": 260}, {"referenceID": 6, "context": "2 The need for multiple embeddings A key feature of Tatec is to use different embedding spaces for the 2-way and 3-way terms, while existing approaches that have both types of interactions use the same embedding space (Jenatton et al., 2012; Socher et al., 2013).", "startOffset": 218, "endOffset": 262}, {"referenceID": 19, "context": "2 The need for multiple embeddings A key feature of Tatec is to use different embedding spaces for the 2-way and 3-way terms, while existing approaches that have both types of interactions use the same embedding space (Jenatton et al., 2012; Socher et al., 2013).", "startOffset": 218, "endOffset": 262}, {"referenceID": 10, "context": "The critical feature of these biases in collaborative filtering is how they interfere with capacity control terms other than the rank, namely the 2-norm regularization: in (Koren et al., 2009) for instance, all terms of (2) are trained using a squared error as a measure of", "startOffset": 172, "endOffset": 192}, {"referenceID": 5, "context": "2 Regularization Previous work on embedding models have used two different regularization strategies: either by constraining the entity embeddings to have, at most, a 2-norm of value \u03c1e (Gar\u0107\u0131a-Dur\u00e1n et al., 2014) or by adding a 2-norm penalty on the weights (Wang et al.", "startOffset": 186, "endOffset": 213}, {"referenceID": 12, "context": ", 2014) or by adding a 2-norm penalty on the weights (Wang et al., 2014b; Lin et al., 2015) to the objective function (4).", "startOffset": 53, "endOffset": 91}, {"referenceID": 3, "context": "UMLS/Kinships Kinships (Denham, 1973) is a KB expressing the relational structure of the kinship system of the Australian tribe Alyawarra, and UMLS (McCray, 2003) is a KB of biomedical high-level concepts like diseases or symptoms connected by verbs like complicates, affects or causes.", "startOffset": 23, "endOffset": 37}, {"referenceID": 13, "context": "UMLS/Kinships Kinships (Denham, 1973) is a KB expressing the relational structure of the kinship system of the Australian tribe Alyawarra, and UMLS (McCray, 2003) is a KB of biomedical high-level concepts like diseases or symptoms connected by verbs like complicates, affects or causes.", "startOffset": 148, "endOffset": 162}, {"referenceID": 5, "context": "Following (Gar\u0107\u0131a-Dur\u00e1n et al., 2014), in order to reduce this noise in the measure, and thus granting a clearer view on ranking performance, we remove all the positive triples that can be found in either the training, validation or testing set, except the target one, from the ranking.", "startOffset": 10, "endOffset": 37}, {"referenceID": 6, "context": "It has been introduced in (Jenatton et al., 2012).", "startOffset": 26, "endOffset": 49}, {"referenceID": 5, "context": "Results on both FB15k and SVO with TransE and Tatec are provided in (Gar\u0107\u0131a-Dur\u00e1n et al., 2014), however in these works the hyperparameters were validated on a smaller validation set, that led to suboptimal results.", "startOffset": 68, "endOffset": 95}, {"referenceID": 12, "context": "On FB15k, recent variants of TransE, such as TransH, TransR and cTransR (Lin et al., 2015) have been chosen as main baselines.", "startOffset": 72, "endOffset": 90}, {"referenceID": 6, "context": "The results for these models have been extracted from (Jenatton et al., 2012), and we followed their experimental setting.", "startOffset": 54, "endOffset": 77}, {"referenceID": 14, "context": ", 2013b), the algorithm is shown to perform well on FB15k and on a dataset extracted from the KB WordNet (Miller, 1995): we suspect that the WordNet dataset also contains symmetrical counterparts of test triples in the training set (such as hyperonym vs hyponym, meronym vs holonym).", "startOffset": 105, "endOffset": 119}], "year": 2015, "abstractText": "This paper tackles the problem of endogenous link prediction for Knowledge Base completion. Knowledge Bases can be represented as directed graphs whose nodes correspond to entities and edges to relationships. Previous attempts either consist of powerful systems with high capacity to model complex connectivity patterns, which unfortunately usually end up overfitting on rare relationships, or in approaches that trade capacity for simplicity in order to fairly model all relationships, frequent or not. In this paper, we propose Tatec a happy medium obtained by complementing a high-capacity model with a simpler one, both pre-trained separately and then combined. We present several variants of this model with different kinds of regularization and combination strategies and show that this approach outperforms existing methods on different types of relationships by achieving state-of-the-art results on four benchmarks of the literature.", "creator": null}}}