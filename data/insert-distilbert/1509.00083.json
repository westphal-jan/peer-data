{"id": "1509.00083", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "31-Aug-2015", "title": "Metastatic liver tumour segmentation from discriminant Grassmannian manifolds", "abstract": "the early detection, diagnosis and monitoring of liver cancer progression can efficiently be achieved with the precise delineation of metastatic tumours. importantly however, accurate automated segmentation remains challenging and due to the presence of diagnostic noise, inhomogeneity and the high appearance variability of malignant tissue. in this paper, we propose an unsupervised metastatic liver tumour segmentation framework using a machine learning approach based on pure discriminant grassmannian manifolds coding which learns the appearance of tumours with respect to normal tissue. using first, the framework learns within - class tolerance and between - class similarity distributions from a training set of images to helping discover the optimal manifold discrimination correlation between normal and pathological tissue in the liver. second, a conditional optimisation scheme computes nonlocal pairwise as well as pattern - based clique projection potentials modeled from the manifold type subspace to recognise regions with closely similar labelings and to incorporate global consistency in the segmentation process. the proposed baseline framework was validated on a clinical database of 43 % ct images from patients with transient metastatic liver cancer. compared to new state - of - the - art analysis methods, finally our method achieves a technically better performance on two separate datasets of metastatic liver tumours from different clinical sites, yielding an overall mean dice texture similarity coefficient of 90. 7 + / - magnitude 2. 4 in over fifty 50 suspected tumours with an intrinsic average volume of currently 27. 3, mm3.", "histories": [["v1", "Mon, 31 Aug 2015 21:45:40 GMT  (3569kb,D)", "http://arxiv.org/abs/1509.00083v1", null]], "reviews": [], "SUBJECTS": "cs.LG cs.CV", "authors": ["samuel kadoury", "eugene vorontsov", "an tang"], "accepted": false, "id": "1509.00083"}, "pdf": {"name": "1509.00083.pdf", "metadata": {"source": "CRF", "title": "Metastatic Liver Tumor Segmentation from Discriminant Grassmannian Manifolds", "authors": ["Samuel Kadourya", "Eugene Vorontsov", "An Tang"], "emails": ["samuel.kadoury@polymtl.ca", "eugene.vorontsov@polymtl.ca", "duotango@gmail.com"], "sections": [{"heading": null, "text": "Early detection, diagnosis and monitoring of liver cancer progression can be achieved with precise delineation of metastatic tumors. However accurate automated segmentation remains challenging due to presence of noise, inhomogeneity and high appearance variability of malignant tissue. In this paper, we propose an unsupervised metastatic liver tumor segmentation framework using a machine learning approach based discriminant Grassmannian manifolds which learns the appearance of tumors with respect to normal tissue. First, the framework learns within-class and between-class similarity distributions from a training set of images to discover the optimal manifold discrimination between normal and pathological tissue in the liver. Second, a conditional optimization scheme computes non-local pairwise as well as pattern-based clique potentials from the manifold subspace to recognize regions with similar labelings and incorporate global consistency in the segmentation process. The proposed framework was validated on clinical database of 43 CT images from patients with metastatic liver cancer. Compared to stateof-the-art methods, our method achieves better performance on two separate datasets of metastatic liver tumors from different clinical sites, yielding an overall mean Dice similarity coefficient of 90.7\u00b1 2.4 in over 50 tumors with an average volume of 27.3mm3.\nKeywords: Liver tumors, Image segmentation, Manifold learning,\n\u2217Corresponding author. Prof. Samuel Kadoury, Ph.D., P.O. Box 3079, Succ. CentreVille, Montre\u0301al, Que\u0301bec, Canada, H3C3A7.\nEmail addresses: samuel.kadoury@polymtl.ca (Samuel Kadoury), eugene.vorontsov@polymtl.ca (Eugene Vorontsov), duotango@gmail.com (An Tang)\nPreprint submitted to Phys. Med. Biol. September 2, 2015\nar X\niv :1\n50 9.\n00 08\n3v 1\n[ cs\n.L G\n] 3\n1 A\nDiscriminant manifolds, Grassmannian kernels, Optimization"}, {"heading": "1. Introduction", "text": "The delineation of primary tumors or metastases from diagnostic imaging is a crucial but challenging problem in any clinical applications, such as tumor detection, diagnosis, treatment planning for radiofrequency ablation or surgical interventions, and monitoring of treatment response which is done with predefined criterions. Segmentation of tumors in 3D is a pre-requisite for precise clinical measurements that are done during clinical examinations. One example of such an application in liver oncology is the Response Evaluation Criteria in Solid Tumors (RECIST) that measures the size of solid tumors as the maximum diameter [1]. Ideally, this metric would be made in a volumetric fashion in 3D, instead of repeating the delimitation on each axial plane. However manual segmentation is not applicable in clinical routine as it takes too much time and lacks reproducibility across raters [2]. Furthermore, to precisely follow the progression of a tumor throughout longitudinal scans, it remains difficult to identify the accurate boundaries of the tumors to quantify the difference in volume. For these reasons, automated tumor segmentation would represent an ideal alternative if it was efficient, reproducible, and permitted accurate delineation of tumor boundaries and tumor volumetry. Further, clinical utility of automated tumor segmentation would be enhanced if it permitted longitudinal comparison of tumor volumetry in subsequent visits.\nDifferent methods were previously presented to achieve semi-automated or automated segmentation of metastases in different organs and pathologies, such as in prostate, lung or for neurological disorders. Approaches using discrete Markov Random Fields (MRFs; [3]) and Conditional Random Fields (CRFs; [4]) were used to model complex dependencies within sample distributions, offering improved segmentation accuracy compared to independent and identically distributed (i.i.d.) classifiers such as Support Vector Machines (SVM). Other works by Li et al. [5] located tumor boundaries uses machine learning to classify regions, while Freiman et al. [6] used a Bayesian classifier to segment various organs with medical images and subsequently applied morphological operators to correct for segmentation discrepancies. Furthermore, a study comparing three semi-automated methods was presented in [7] using contrast-enhanced CT. In the study by Smeets et al. [8], a\nsupervised statistical pixel classification method was trained from a dataset of liver tumors. The technique then applied a level-set adaptation approach to isolate the region of interest. In [9], a hierarchical probabilistic Gabor filter was used in combination with an MRF segmentation framework to delineate brain tumors in MRI volumes, where a Bayesian framework provides a coarse probabilistic texture-based segmentation of active and edema regions. But despite significant intra- and inter-rater variabilities and prolonged time for manual segmentation, very few of these automated approaches are currently used in clinical practice. Completely automated methods may be prone to suboptimal precision and not be as robust as semi-supervised approaches. Furthermore, they often require high computational requirements.\nState-of-the-art tumor segmentation frequently combines efficient classification techniques with low level segmentation methods. From such perspective, tumor detection is addressed as a classification problem where one aims at separating normal from diseased tissues at the voxel level, while imposing smoothness criterions in the process. In [10], SVM classification using multispectral intensities and textures is combined with hierarchical CRFs to segment brain tumors in MR images. In [11], a semi-automated lesion segmentation method is presented using Markov Random Fields and non-parametric distributions which are defined locally to estimate the tumor shape. Alternatively, the use of fully-connected pairwise models can improve the performance over traditional MRF models that are based on a finite number of links. Still, pairwise models remain limited to depict higher-order relationships, which could produce results of limited accuracy when modelling the global appearance of an object. On the other hand, higher-order relationships can incorporate a reliable labelling output within inhomogeneous regions, as shown in [12], while prior information modelled as co-occurrences between various classes has demonstrated significant promise for segmentation [13]. This idea has been applied for the classification of pathology using discrete hidden MRFs [14].\nA major drawback from these methods is that conditional probabilities are obtained directly from the high-dimensional image space, which is not ideal as they fail to express the underlying representation of the dataset and assimilates all measures to Euclidean distances [15]. They also assume linear discrimination (SVMs) when in most cases, sets are not linearly separable in the image space. In contrast, manifold learning techniques intrinsically con-\nsider the nonlinear distribution of the data, and enable important evaluation of test cases in a learned population by using a mapping distance. Recently, various approaches have used manifolds to discriminate the presence of white matter brain lesions [16] or track organ motion or discover regional variations within images [17]. In [18], manifold learning techniques were used to capture the non-linear variability of brain development from a dataset of MR images. However, techniques such as Laplacian eigenmaps are sensitive to outliers and unable to cope with pathological or abnormal tissues [19]. To the best of our knowledge, prior information captured by a discriminant embedding has yet to be exploited in a fully automated graphical model segmentation framework. Preliminary results demonstrated promise but was validated on a limited dataset and could not properly capture inter-tumor inhomogeneities [20].\nIn this paper, we propose a segmentation approach for tumors using discriminant manifold embeddings, where the low-dimensional representation are integrated in a graphical model used for segmentation. The contributions are two-fold. First, a discriminant graph-embedding with Grassmannian kernels is generated from prior data to learn the nonlinear intensity distributions of normal liver tissue and pathological regions. Second, we suggest to employ a recently proposed mean-field CRF inference approach where potentials are computed directly from the low-dimensional embedding, capturing the underlying structure. Unary and pairwise potentials assess the proximity to manifold regions and the dissimilarity between pairs of segments, respectively. Higher-order potentials ensure regional consistency to efficiently discriminate tumors from normal tissue. These potentials are integrated in an existing higher-order conditional random field [21]. We validated the manifold constrained segmentation method on metastatic liver tumors in CT images, from two separate clinical datasets which included diagnositic images of patients which were subsequently treated by radio frequency ablation.\nWe now describe the proposed framework, with the outline illustrated in Fig. 1. The first phase consists of creating a non-linear, low-dimensional embedding from patches extracted from training datasets of annotated tumor images and liver organ tissue, surrounding the tumor region. These patches are embedded in a Grassmannian manifold, where within and between similarity graphs are created from the manifold points in order to incorporate\na discriminatory measure in the learning process. Once the learning phase is completed, a new patient image can be processed using an integrated and interconnected CRF graph to perform the unsupervised segmentation of tumor regions. This graph involves costs related to manifold support, prior geometrical dependencies and cliques described in the discriminant manifold domain, within regions of interest of the tumor. Pairwise potentials measures the similarity between connected voxels in manifold space, while high-order cliques evaluates the variance of data points within manifold space. The energy function is minimized with primal-dual optimization procedure. A careful selection of the intrinsic dimensionality and parameter settings is performed to properly model the non-linear space.\nThe paper is structured as follows. The developed method, including the training and segmentation steps is presented in Section 2. The experimental results are reported in Section 3, and Section 4 concludes the paper with a discussion."}, {"heading": "2. Materials and Methods", "text": "In this section, we present the imaging data used in this study and the overall framework of the metastatic liver tumor segmentation. First, the training phase learns the discriminant Grassmannian manifolds using databases of labelled tumor and normal liver tissue in order to determine the mapping function for unseen cases. Then, the segmentation process of a new CT examination uses the manifold potentials in a conditional random field segmentation process to delineate the region of interest."}, {"heading": "2.1. Imaging data", "text": "To train and test the proposed tumor segmentation framework, two distinct CT imaging datasets were used. The first clinical dataset was the public dataset from the 2008 MICCAI segmentation challenge, which was used by several other groups for tumor segmentation [22]. The database includes 4 training CT datasets, which have 10 ground-truth tumor segmentations. The testing database has 13 CT datasets, totalling 20 tumors with ground-truth segmentations.\nThe second clinical dataset was composed of a total of 30 images provided by radiology departments from two separate clinical institutions, totalling 40\ntumors. The first subset included 12 contrast-enhanced CT examinations, totalling 15 tumors as two patients had multiples tumors. The images were acquired with a 64-slice CT scanner with axial dimensions of 512 by 512, 1mm slice thickness, in-plane resolution of 0.6mm and the number of slices ranging between 112 and 330. Cases were referred for follow-up or for subsequent treatment such as for chemo-embolization or radio frequency ablation (RFA). The second subset included 18 contrast-enhanced CT examinations acquired also with a 64-slice CT scanner (in-plane resolution of 512 by 512), with a slice thickness varying between 0.9 and 1.2mm, in-plane resolution of 0.8mm and the number of slices ranging between 87 and 274. In this database subset, tumors were limited to liver metastases from colorectal cancer. Tumors sizes varied between 2 and 7 cm in maximum diameter in this database and were manually segmented by an experimented radiologist. Every patient had a single tumor, except 5 patients, who had 3 tumors (2 patients) and 2 tumors (3 patients). The total number of metastatic tumors was 25 tumors. The second dataset was randomly separated into 10 training and 30 testing cases."}, {"heading": "2.2. Learning Discriminant Grassmannian Manifolds", "text": "Manifold learning algorithms are based on the premise that data are often of artificially high dimension and can be embedded in a lower dimensional space. However the presence of outliers and multi-class information can on the other hand affect the discrimination and/or generalization ability of the manifold. We present here the mechanism to learn the optimal separation between normal and pathological tissue by using a discriminant graph-embedding based on Grassmannian manifolds proposed by [23], where it is adapted to the segmentation process. Here, we describe the Grassmannian kernels applied to the input data points, which in turn are embedded into a discriminant manifold domain that incorporates within and between similarity graphs."}, {"heading": "2.2.1. Grassmannian kernels", "text": "In the framework, each sample point xi (representing an image patch) in a Grassmannian manifold is described by the set of m-dimensional domains in RD , described by a orthonormal matrix of D\u00d7m. It is then possible to see if two Grassmannian manifold points are similar, by mapping one to another using the m\u00d7m orthogonal matrix. In this work, the similarity between two\nmanifold points (xi, xj) is measured as a combination of two Grassmannian kernels Ki,j defined in the Hilbert Space such that:\nKi,j = \u03b11k[proj]i,j (xi, xj) + \u03b12k [CC] i,j (xi, xj) (1)\nwith \u03b11, \u03b12 \u2265 0. The projection kernel defined as k[proj]i,j = \u2016xTi xj\u20162F determines the largest correlation based on the cosine measure between principal vectors of two sets. The second denotes canonical correlation Grassmanian kernel:\nk [CC] i,j = max\nap\u2208span(xi) max bq\u2208span(xj) aTp bq (2)\nsubject to aTp ap = b T p bp = 1 and a T p aq = b T p bq = 0, p 6= q. This kernel is positive definite since zTKz > 0 such that \u2200z \u2208 Rn as shown in [23], and welldefined since singular values of xT1 x2 are equal to R T 1 x T 1 x2R2, with R1,R2 \u2208 Q(o), indicating orthonormal matrices of order o. This makes the kernel invariant to various representation of the subspaces. While the projection kernel based on principal angles is able to identify the predominant differences from a pair of image sets, the canonical correlation kernel acts as a similarity metric to identify features which offer the best correlation between two sets of images. This later kernel is also invariant to various representations of the subspaces. With each kernel representing different components of the image distributions, the combined kernel Ki,j is able to cover a wider range of features to efficiently characterize tumors with respect to typical features apparent in normal liver tissue, and identify the discriminant features to separate both classes."}, {"heading": "2.2.2. Graph architecture", "text": "In order to effectively discover the low-dimensional embedding, it is necessary to maintain the local structure of the data in the new embedding. The structure G = (V ,W ) is an undirected similarity graph, using a collection of nodes V connected by edges, and a matrix W with symmetric values describing relationships between the nodes. The relationship between the diagonal D and the Laplacian L matrices is modelled by as L = D \u2212W . Here, each element of D describes the sum of the weight matrix W . By representing an architecture as a set nodes and edges, the goal of discriminant graph embedding is to increase the discriminatory power of embedded data by mapping the high-dimensional distribution data to another low-dimensional space. In the context of embedding, similarities between pairs of vertices\nremain the same in either space by solving a general eigen-analysis problem [24].\nHere, N labelled points X = {(xi, ci)}Ni=1 are generated from the underlying manifold M, where ci denotes the label (tumor or normal). The task at hand is to maximize the discrimination between tumor and normal liver tissue by mapping the underlying data xi into a vector space yi, while preserving similarities between data points in the high-dimensional space. Discriminant graph-embedding based on locally linear embedding (LLE) [15] uses graphpreserving criterions to maintain these similarities, which are included in a sparse and symmetric N \u00d7 N matrix, denoted as M . The embedding cost function is minimized using the following formulation:\u2211\ni \u2016yi \u2212 \u2211 j M(i, j)yj\u20162 = yT (I \u2212M)T (I \u2212M)y (3)\n= argmin Y TT=1\nyT (D \u2212W )y.\nwith I as identity. Therefore, the LLE algorithm is described as a direct graph embedding problem."}, {"heading": "2.2.3. Within and between similarity graphs", "text": "In our work, the manifold embeddingM is constructed with a within-class graph W w, describing the similarity of regions with the same type (tumor and normal liver tissue), and a between-class penalty graph W b, used to discriminate normal and tumor tissue. When constructing the discriminant LLE graph, elements are partitioned between these two classes. The intrinsic graph G is first created by assigning edges only to vertices of the same class (tumor or normal). The local reconstruction coefficient matrix M(i, j) is obtained by minimizing:\nmin M \u2211 j\u2208Nw(i) \u2016xi \u2212M(i, j)xj\u20162 \u2211 j\u2208Nw(i) M(i, j) = 1 \u2200i (4)\nwith Nw(i) as the neighborhood of size k1, within the same region as point i (e.g. tumor region). Each sample is therefore reconstructed only from images\nof the same region. The local reconstruction coefficients are incorporated in the within-class similarity graph, such that the matrix W w is defined as:\nWw(i, j) = { (M +MT \u2212MTM)ij, if xi \u2208 Nw(xj) or xj \u2208 Nw(xi) 0, otherwise. (5)\nConversely, the between-class similarity matrix W b depicts the statistical properties which are used to maximize the distance between classes and used as a high-order constraint. Distances between normal and pathological samples are computed as:\nWb(i, j) = { 1/k2, if xi \u2208 Nb(xj) or xj \u2208 Nb(xi) 0, otherwise\n(6)\nwith Nb containing k2 neighbors having different class labels from the ith sample. The objective is to transform points to a new manifoldM of dimensionality d, i.e. xi \u2192 yi, by mapping connected tumor or normal samples in W w as close as possible to the class cluster, while moving tumor and normal areas of W b as far away from one another. This results in optimizing the following minimization and maximization objective functions:\nf1 = min 1\n2 \u2211 i,j (yi \u2212 yj)2Ww(i, j) (7)\nf2 = max 1\n2 \u2211 i,j (yi \u2212 yj)2Wb(i, j). (8)\nHere, Eq.(7) is used to penalize neighbouring points belonging to the same type if they are mapped far away within M. Conversely, Eq.(8) penalizes embedded points of distinct classes, in the case where these are mapped close to each other within M, as shown in Fig. 2. Using the structure, it can be shown that an implicit representation of manifold points can be obtained by finding the similarity between points using the Grassmannian kernel Ki,j, an appropriate mapping function can be obtained using a supervised manifold learning approach, which will be described in the following section."}, {"heading": "2.2.4. Supervised manifold learning", "text": "The optimal projection matrix, mapping new points to the manifold created in the training phase, is obtained by simultaneously maximizing class\nseparability and preserving interclass manifold property, as described by the objective functions in Eqs.(7)-(8). Assuming points on the manifold are known as similarity measures given by the Grassmannian kernel Ki,j defined in Eq.(1), a linear solution can be defined, i.e., yi = (\u3008\u03b11, xi\u3009, . . . , \u3008\u03b1r, xi\u3009)T for the r largest eigenvectors with \u03b1i = \u2211N j=1 aijxj. Defining the coefficient Al = (al1, . . . , alN) T and kernel K i = (ki1, . . . , kiN)\nT vectors, the output can be described as yi = \u3008\u03b1l, xi\u3009 = ATl K i. By replacing the linear solution in the minimization and maximization of the between- and within-class graphs, the optimal projection matrix A is acquired from the optimization of the function as proposed by Harandi [23]. The algorithm generates implicitly a mapping A using the points on the Grassmannian manifold. The discriminant mapping A will enable the conservation of the global geometrical structure of the inherent distribution. The minimization of Eq.(7) becomes:\nf1 = \u2211 i ATi K iK T i A T i Ww(i, i)\u2212 \u2211 i,j ATi K jK T i A T i Ww(i, j)\n=ATKDwKTA\u2212 ATKW wKTA (9) =ATKLwKTA\ngiven Eq. (3). Here, A = [A1|A2| . . . |Ar] and K = [K 1|K 2| . . . |KN ]. Similarly, the maximization of the between-class graph is defined as f2 = ATKLbKTA, with Lb = Db \u2212W b. By combining f1 and f2, the optimal\nprojection matrix A\u2217 is acquired from the optimization of the function:\nA\u2217 = argmax A ATKLbKTA\u2212 hATKLwKTA (10)\nwhich is obtained by the eigenvalue decomposition method and h is a Lagrangian multiplier that regularizes the final mapping function. Hence for any test point xq, a manifold representation vq = ATK q is obtained using the kernel function based on xq and mapping A."}, {"heading": "2.3. Fully-Connected Graph Segmentation", "text": "Once the Grassmannian manifolds are obtained from the training phase, the segmentation problem is performed using a higher-order CRF model where clique potentials are inferred from the low-dimensional embeddings. In this sub-section, we describe the segmentation framework with the minimization of the energy term used in the process, as well as the definition of the energy terms defined in the manifold space.\nWe use higher-order conditional random fields [21, 10], where instead of using direct voxel intensities which is a highly dimensional problem, clique potentials are derived from the trained discriminant embeddings in order to perform an unsupervised tumor segmentation. Potentials describing smoothness terms restrain traditional techniques in segmenting small structures in specific regions of interest, such as hyper-vascular tumors and irregularly shaped metastases. In fact in previous works, models generated using regular CRFs based on pairwise potentials yield very smooth results which do not follow the actual region of interest. Instead of using direct pixel intensities, we propose to employ potential measures obtained from the learned models to incorporate regional consistency in the segmentation process. A voting scheme will help to drive the delineation step as a smooth constraint.\nWe propose to incorporate manifold potentials defined in the discriminative high-dimensional feature space into the typical CRF model. The well known Gibbs formulation of this higher order CRF is adapted for this purpose and defined as:\nM(C|X ) = \u2211 vi\u2208X \u03c8(ci|vi) + \u2211 (vi,vj)\u2208E \u03c6(ci, cj|vi, vj) + \u2211 s\u2208S \u03bes(cs|vs). (11)\nThe random variables X denotes whether labels belong to the object of interest (tumor or not) in label space C, E denotes edges connecting pairs of nodes and S denotes the set of segments, composed of multiple embedded patches. The CRF model defines the energy function based on the sum of unary \u03c8 and pairwise potentials \u03c6, as well as higher-order functions \u03be, which will be described in the following section, where vi denotes the manifold projection of data point xi and ci is the label (tumor or normal) of node vi. The nodes in the CRF model corresponds to the manifold embedded segments of xi. Here, image segments xi are obtained from superpixels on each 2D slice, which consists of a normalized-cut segmentation method, followed by an iterative k-means clustering to create an image parcelled in equal-sized patches (average size of 12 pixels) that do not overlap [25]. Then, segments are mapped using the projection matrix such that vi = ATK i . Features are selected implicitly by the manifold from the low-dimensional space to obtain the best discrimination between the classes. Here, we utilize a fullyconnected CRF model using a mean-field approximation of the original CRF such that the distribution is composed of a set of independent marginals minimizing KL-divergence."}, {"heading": "2.3.1. Manifold-based potentials", "text": "Here, we describe the three potentials that constitute the objective function of the CRF defined in Eq.(11).\nUnary potentials in the CRF model, represented by the term \u03c8(vi) of the energy function, represents the likelihood to assign a patch i with a specific label. Typically, the unary potential is determined by the grayscale value of the voxel and the appearance model for each region of interest. However, intensity alone is not sufficient to discriminate between similar groups and often produces erroneous tumor delineations. Instead, we propose to utilize elaborate potential functions based on manifold representations of the classifier \u03c8(ci|vi) = \u2212 log(P (ci|vi)), which evaluates the likelihood that the extracted patch belongs to the region of interest based on its embedded location within the Grassmannian manifold. The likelihood is calculated based on the negative value of the log function.\nPairwise potentials are expressed as non-parametric manifold dissimilarities, extending the Gaussian kernel formulation in feature space which uses meanfield approximations of fully-connected CRF models [26]. Instead of forcing\nEuclidean features to fulfill this task, pairwise potentials are conditioned on the input data such that \u03c6(vi, vj) = \u00b5(vi, vj) exp(\u2212d(i, i,X ,M)), where \u00b5 describes how compatible labels are assigned between nodes vi and vj. The distance between points i and j, under label l, is the conditional distribution of the label l, with:\nexp(\u2212d(i, i,X ,M)) = P (vj = l|vi = l,X ,M). (12)\nAssuming the Frobenius distance in manifold space can offer a nonparametric estimation of the dissimilarity measure, the pairwise potential can be defined by imposing a range \u03c3f over which valuable information can be inferred when applying a Gaussian window:\n\u03c6(ci, cj|vi, vj) = w exp\n( \u2016vi \u2212 vj\u20162F\n2\u03c32f\n) (13)\nwith the parameter w weighting the pairwise relations.\nHigher-order potentials are quality sensitive functions that define the label inconsistency in regions (different labels are assigned to a set of neighboring segments), by adding edges between nodes that are not immediate neighbours. We use the strategy in [13] where for a given clique vs grouping t segments, t different embeddings are generated with the manifold projection matrix A. The variance of the embedded coordinates of vs for all t data points is the used as a quality measure Q(s) : s\u2192 R for all consistent segments in vs. The higher-order potential is defined as \u03bes(vs) = C(vs) 1 T \u03bbq when C(vs), which counts the number of segments in vs not taking the dominant label s, is lower than a threshold T . In the case the count is over T , then \u03bes(vs) = \u03bbq, where \u03bbq produces a penalizing term using Q(s), which defines the flexibility of the clique potential. This term will favour joining similar segments together, while penalizing other segments which are less likely to constitute a single region. As proposed by [21], the penalty term \u03bbq measures how the output unary potential varies on all voxels of a segment in order to assess the reliability of the potential. Here, the model parameters which are assigned to the potentials are obtained using cross-validation on the training data."}, {"heading": "2.3.2. Energy minimization", "text": "We minimize the higher order CRF defined earlier in Eq.(11) by decomposing the problem into sub-modular terms. Kohli et al. [21] showed that ro-\nbust higher order functions can be found by expanding or replacing the clique function using auxiliary binary terms. Optimal displacements are calculated for these algorithms in order to minimize the clique potentials. Therefore, the high-order displacement terms are transformed into sub-modular quadratic functions, and are optimized based on graph cuts. The minima of the energy function represents the solution for the tumor segmentation based on a labelling process which assigns a class at voxel of the image, generating tumor and normal tissue segmentations.\nFinally we apply a Primal-Dual algorithm called FastPD [27] which can efficiently solve the problem in a discrete domain by formulating the duality theory in linear programming. Compared to other methods which do not provide optimal solutions or require long computational times to approximate the global minimum, the advantage of FastPD lies in its generality and efficient computational speed. It also guarantees that the generated solution will be the best approximation of the true global optimum without the condition of linearity."}, {"heading": "2.4. Validation methodology", "text": "To evaluate the performance of the algorithm in a controlled setting and help determine parameter values for the proposed framework, a dataset created from synthetic phantoms using uniform agar gel (8% agar w/v) as shown in Fig. 3(a), were used for an initial evaluation. Phantoms provide a medium to generate artificial data in a controlled settings, therefore providing goldstandard segmentation for reference. While they do not yield images similar to real patient images, it was shown in previous studies to provide significant information on the behavior of image processing algorithms [28]. A total of nine phantoms were created, where each model included a tumor region composed of diluted dye agent in the middle of the phantom model. The size of the tumor (between 1 and 5cm), as well as the contrast of the tumor varied in each synthetic model. A CT image for each phantom was obtained with a 512 by 512 resolution and 1mm slice thickness. Gaussian noise with a s.d. of 1.5 was added to the images, simulating point granularity during image acquisition. This way, nine tumors were artificially simulated at different levels of contrast (8, 13 and 20 Hounsfield units) (Fig. 3(b)), with three different tumor diameters (1, 3 and 5 cm).\nFor the first clinical dataset, experienced radiologists generated ground-truth segmentations for the test data, and the evaluation was conducted by comparing the automated segmentations to the interobserver variations obtained by ground-truth segmentations. Measures such as (1) volumetric overlap error (%), (2) the average symmetric surface distance (mm), (3) the root mean square (RMS) symmetric surface distance (mm), (4) the relative absolute volume difference (%), and (5) the maximum symmetry surface distance (mm) were computed for each segmentation based on the 2008 MICCAI liver tumor segmentation challenge [22]. A score between 0 and 100 was assigned to each measure based on the scoring system designed for the tumor segmentation challenge to compute an overall score based on human segmentation. For a perfect segmentation, a metric will get a score of 100 when the value is an exact match (error=0). A reference point with a score 90 for each metric is determined from the segmentation performed by independent users. It represents the score a human observer can get by manual segmentation. The values of the five metrics for the reference point are as follows: (1) volumetric overlap error = 12.94 %, (2) relative absolute volume difference = 9.64%, (3) average surface distance = 0.40mm, (4) RMS distance = 0.72 mm, (5) maximum symmetry surface distance = 4.0 mm. The score of each metric for a segmentation is then obtained using linear interpolation or extrapolation between the two points specified above (exact match and reference point).\nTo set similar conditions to the experiments from the MICCAI challenge, the operator could identify a coarse region of interest (120x120) around the tumor area in a single 2D axial slice, in order to allow a more narrow search region that surrounds the target tumor. The modified search area provides the method with a better sample tissue representation, which can help the discrimination process between normal and pathological tissue. The final segmentation obtained with the selected search region was used for comparison to the ground-truth segmentation.\nFor the second clinical dataset, the same five quantitative measurements defined previously were obtained by comparing the automated segmentations with the ground-truth manual segmentations, which were obtained by two independent experienced radiologists. No user interaction was required as the datasets were already processed to segment the liver from CT images [29]. The manifold learning and segmentation algorithm were programmed in C++, running on a 3.4 GHz Intel Core i7 CPU with 32 GB of RAM. The average training time took approximately 6h, which included the patch extraction and learning the manifolds offline."}, {"heading": "3. Results", "text": "In this section, we present the experiments performed on both synthetic and clinical datasets of CT images with liver tumors. Results obtained from both qualitative and quantitative measures were compared to manual groundtruth segmentations, and confronted to state-of-the-art tumor segmentation approaches."}, {"heading": "3.1. Artificial data", "text": "The Grassmannian manifold was trained with ground-truth datasets and the optimal neighborhood size was found at k1 = 10 for within-class similarity graphs (Nw), and k2 = 5 for between-class neighborhoods (Nb). The optimal manifold dimensionality was set at d = 6, when the trend of the nonlinear residual reconstruction error curve stabilized for the entire training set. Fig. 4a shows the ROC curves when using different types of kernels (k[CC], k[proj], k[CC+proj]), illustrating the increased accuracy using the combined kernel (\u03b11 = 1, \u03b12 = 5, h = 1), which suggests each are extracting complementary features from the training data. A 3D embedding of the\ncomputed manifold is represented in Fig. 4b, showing the group of training image patches provided by the tumor and normal liver patches embedded in a single continuous manifold structure.\nSegmentation accuracy results where then obtained for all the synthetic datasets using a leave-one-out cross validation, studying the effect of contrast and tumor size from the segmentations of nine tumors. The results from this evaluation are presented in Table 1. Unsurprisingly, these show that the method\u2019s performance in segmentation accuracy increases as the contrast level of the tumor increases as well. The accuracy with a contrast level of 8 Hounsfield units (HU) yields the lowest scores, while a contrast level of 20 HU generated the highest accuracy in segmentation. Typical levels of contrast for tumors in patients treated with RFA is of 10 HU. Results presented here can be used as a reliability indicator of the segmentation result of real tumors. Another factor which was evaluated in this experiment was the effect of the tumor size on the segmentation results. As the tumor tends to be larger, it provides the algorithm with increased contextual information that can be integrated within the higher-order clique potentials. On the other hand, these artificial tumors are constituted of primarily homogenous regions, while real patient data often presents heterogeneous portions, which is typically more challenging."}, {"heading": "3.2. Challenge dataset", "text": "Table 2 presents the evaluation results from all 20 test cases provided by the tumor segmentation challenge dataset, while the distribution of scores compared to human raters is shown in the box-plots diagram in Fig. 6. In the evaluation, the training data was not included. The average time for segmenting a tumor was 53sec, given an input ROI. Segmentations were compared to an active contours approach with local Gaussian distributions [30] and to a texture classification method [10]. The average and RMS surface distances (1.4 \u00b1 0.3 and 1.6 \u00b1 0.4mm) of the proposed method were significantly lower (p \u2264 0.05) than distances generated by [30] and [10]. Typical results of metastatic liver tumors segmented on CT images are shown in Fig. 5. As it was observed in a previous study, the gallbladder represents an important cause of wrong classification of perihepatic metastasis detection\nsince it exhibits similar intensity levels to many metastases, while being close to the location of the liver. The gallbladder can generate a convex-shaped indentation in the liver capsule, changing the morphology of the liver capsule.\nThe average score (using the challenge scoring system) for overlap error between automated and manual segmentation was 77.3\u00b1 12.5. Boxplots show the proposed method performs similarly to interobserver variability in all quantitative measurements. As demonstrated in [11], segmentation results were not as accurate for larger tumors compared to smaller sized tumors. By analyzing results for tumors with higher volumes, the average score of 59.1 was obtained, while the overlap error and volume error were similar to average results. On the other hand, surface distance errors were higher, with a average distance of 3.06mm. This can be explained by the less-uniform appearance of larger tumors, which may include hyper-vascular or necrotic regions. Furthermore, larger tumors are often located close to the liver edges, causing misclassification with surrounding organs as well."}, {"heading": "3.3. Clinical dataset", "text": "Table 3 shows the performance of the method with 10 training and 30 test cases from the clinical dataset. The average segmentation time per tu-\nLGD [30] 33.1\u00b1 2.9 23.6\u00b1 4.5 2.3\u00b1 0.5 2.6\u00b1 0.8 8.9\u00b1 2.0 SVM+CRF [10] 31.5\u00b1 2.7 22.2\u00b1 4.3 2.0\u00b1 0.5 2.3\u00b1 0.6 8.3\u00b1 1.8 Proposed \u03c8 + \u03c6 (n=20) 27.9 \u00b1 2.1 19.5 \u00b1 3.6 1.7 \u00b1 0.6 2.0 \u00b1 0.5 7.2 \u00b1 1.9 Proposed \u03c8 + \u03c6+ \u03be (n=20) 25.2 \u00b11.7 14.3 \u00b1 2.8 1.4 \u00b1 0.3 1.6 \u00b1 0.4 6.9 \u00b1 1.8\nmor was of 1min 42sec, since the automatic process included the entire liver region. Results were also compared to an active contours approach with local Gaussian distributions [30] and to a texture classification method [10]. The average and RMS surface distances (0.7 \u00b1 0.4 and 1.4 \u00b1 0.2mm) of the proposed method were significantly lower (p \u2264 0.05) to distance measures generated by [30] and [10]. In terms of overlap error, the proposed approach reduces this error by 10% compared to the top ranking texture classification.\nTypical problems occurred in the periphery of the tumors and in cases of rim-enhancing liver metastases. These cases offer a density which was not observed in the training set, but could be compensated with additional data in the manifold. Fig. 7 shows sample segmentation results.\nBy assessing the gain in accuracy when adding the higher-order terms in the energy formulation, the overlap error is reduced by 2.2%, which is a statistically significant difference (p \u2264 0.05) to the second-order MRF model. In order to evaluate the robustness of the method, we performed additional experiments by measuring segmentation accuracy with 4 different levels of Gaussian noise added to the input images. Fig. 8 demonstrates that the proposed methodology possesses increased tolerance to noise compared to the other methods. Furthermore, the inclusion of the higher-order term improves the robustness to standard pairwise CRFs. Finally, segmentation accuracy was assessed by computing the amount of voxels classified in the wrong group within the zones surrounding the tumor contours, instead of the entire volume. A comparison between different segmentation methods is shown in Fig. 9. Hence, the evolution of the voxelwise classification errors decreases as the\nsize of the evaluated patches around the tumor increases. The patch sizes did not affect computation times."}, {"heading": "4. Discussion", "text": "We proposed a new, accurate and adaptable method for liver tumor segmentation. This was achieved through a higher-order fully-connected graphical model that was optimized using potential functions defined in a discriminant Grassmannian manifold. This increased the ability to isolate diseased\nliver regions from normal tissue as compared to state of the art CRF or SVM techniques. A thorough validation on subjects with metastatic liver tumors was undertaken to evaluate the performance of the method, leading to promising results. Based on the comparative measurements to groundtruth delineations, the resulting segmentations showed to be accurate for metastatic liver tumors, while yielding similar results to interobserver variability. The method\u2019s performance was tested on two distinct collections of tumors. For the clinical dataset provided by two hospitals, the proposed\nframework achieved slightly better results than other methods used for liver tumor segmentation. The average overlap error was improved compared to recently published method using local Gaussian distribution fitting. The evaluation with the challenge dataset illustrated the fact the approach yielded encouraging results, even on images with little contrast, noisy data or in cases where the tumor boundaries were not as clear.\nThe boundaries of the tumors represent the greatest source of discrepancy between manual and automated methods, as it remains difficult to set hard limits for the segmentation area. In some case, undersegmentation was present when the transition in voxel intensities between tumor and normal liver tissue deviates significantly from the learned manifold. In this case, the discriminant framework would classify these points as normal since the projection matrix tends to map unknown sample points closer to the physiological normal class. On the other hand, in the experiments presented in this paper, the manifolds were representative of the data distribution in order to model intensity variations that were present in the testing dataset. While we did not\nexperiment testing the method on the clinical dataset using a model trained on the challenge dataset, it is not expected to penalize the performance of the segmentation algorithm as both datasets are similar in tumor type and imaging modality. However testing on non-enhanced CT images using manifold embeddings trained on contrast-enhanced CT is a current limitation. The method was also able to handle various shapes of liver tumors, such as ellipsoid or elongated shapes. Another source of possible difference is the distinction between necrotic and active tumor regions, which produces a greater level variability among raters in the challenge dataset.\nThe method relies on a set of parameters which may affect the performance of the algorithm, such as the intrinsic dimension of the discriminant manifold. A careful choice for this parameter can significantly optimize the performance of the method. Our experiments chose this parameter carefully by selecting the dimension yielding the lowest residual variance in reconstruction error. The within and in-between similarity graphs also relies on the size of their respective neighbourhoods, which affects the compactness or spread of the points on the manifold. Another set of important parameters are the weights applied to combined kernel functions, which controls the importance of both the projection and canonical correlation kernels. These kernels are often application specific and can be determined once during the training phase. A limitation of the method is the relatively high computational cost for learning the discriminant manifold embeddings during the learning process, which can take a few hours of computation. However this process is performed offline and can potentially be parallelized.\nIn the datasets used in this study, liver metastases were a result of primary colorectal cancer. The results for lesions mainly caused by other types of cancer might differ. The evaluation on the multiple raters segmenting the data has shown that, overall, the proposed method significantly reduces both inter- and intra-observer variability of volumetric measurements. This introduces a certain level coherence in the delineation of liver metastases, and can be of significant value for the application of the RECIST criterion, in order to obtain repeatable results through multiple patient scans. For liver metastases, a limitation of the evaluation is that the intra-observer variability for the delineation of the tumor between raters can be higher to the difference between unsupervised and manual approaches. Another observation was that as the lesion increases in size, the variability between the segmentations is re-\nduced, mainly because smaller differences in the segmentations have a lower relative influence.\nAn improvement of the approach will be to perform a series of experiments to determine the accuracy of the resulting model when providing a more localized initialization by automatically detect position of potential metastases with the segmented liver shape and limiting the number of potential false-positives generated by the algorithm. Furthermore, the model can be improved to enable the extraction of multiple sub-regions within the tumor (necrotic, active tumor), as well as include the capability of adaptation to unconventional tumor configurations, such as H-shaped tumors and more diffuse or infiltrating metastases. Integration of advanced graphical models in the local mesh adaptation process can potentially increase the delineation of detailed tumor boundaries. Translating the algorithm to other modalities, such as MRI and 3D ultrasound for interventional use, is also envisioned for interventional guidance of RFA procedures. Finally, a multi-site evaluation of this technique would be beneficial towards wide-spread clinical adoption.\nThe proposed framework based on discriminant manifolds is general, and can be extended to other applications in vision (segmentation) and medical imaging (Alzheimer\u2019s diagnosis, clinical decision support systems), to accommodate for modelling object tissue variations of similar shape and size, where disease detection can be of significant clinical value. The proposed method promises to facilitate and accelerate quantitative image analysis for clinical diagnosis with MRI or CT. Encoding prior knowledge relating to shape representation is a natural extension of the proposed formulation which can allow to ensure consistency in the final shape segmentation. Finally, the approach can also be extended to other pathologies such as glioblastoma multiforme by segmenting high-grade gliomas in MRI. In this case, the manifold potentials could be trained to characterize different necrotic, active and edema regions in the tumor from multi-parametric MRI, and help to automatically discriminate between normal and diseased brain tissue. Indeed, the framework easily allows to add multiple classes in the discriminant learning process, not only a two-class problem.\nAcknowledgments The authors would like to acknowledge Dr. Nadine Abi-Jaoudeh from the National Institutes of Health for providing liver CT images. Research funding was supported in part by the Canada Research\nChairs and the NSERC Discovery grant program and the Fonds ed recherch du Quebec - Sante\u0301 (Cancer Award 26993)."}], "references": [{"title": "J", "author": ["E.A. Eisenhauer", "P. Therasse", "J. Bogaerts", "L. Schwartz", "D. Sargent", "R. Ford", "J. Dancey", "S. Arbuck", "S. Gwyther", "M. Mooney", "L. Rubinstein", "L. Shankar", "L. Dodd", "R. Kaplan", "D. Lacombe"], "venue": "Verweij, New response evaluation criteria in solid tumours: Revised recist guideline (version 1.1), Eur. J. Cancer 45 ", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2009}, {"title": "Spectrum of diagnostic errors in radiology", "author": ["A. Pinto", "L. Brunese"], "venue": "World journal of radiology 2 (10) ", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2010}, {"title": "Markov Random Field Modeling in Image Analysis", "author": ["S.Z. Li"], "venue": "Springer", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2009}, {"title": "Conditional random fields: Probabilistic models for segmenting and labeling sequence data", "author": ["J. Lafferty", "F. Pereira", "A. McCallum"], "venue": "in: ICML", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2001}, {"title": "A machine learning approach for locating boundaries of liver tumors in CT images", "author": ["Y. Li", "S. Hara", "K. Shimura"], "venue": "in: ICPR", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2006}, {"title": "A bayesian approach for liver analysis: algorithm and validation study", "author": ["M. Freiman", "O. Eliassaf", "Y. Taieb", "L. Joskowicz", "J. Sosna"], "venue": "in: MIC- CAI", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2008}, {"title": "Liver tumour segmentation using contrast-enhanced multi-detector CT data: performance benchmarking of three semiautomated methods", "author": ["J. Zhou", "D. Wong", "F. Ding", "S. Venkatesh", "Q. Tian", "Y. Qi", "W. Xiong", "J. Liu", "W. Leow"], "venue": "European Radiology ", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2010}, {"title": "Semi-automatic level set segmentation of liver tumors combining a spiral-scanning technique with supervised fuzzy pixel classification", "author": ["D. Smeets", "D. Loeckx", "B. Stijnen", "B.D. Dobbelaer", "D. Vandermeulen", "P. Suetens"], "venue": "Med. Image Anal. 14 ", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2010}, {"title": "Hierarchical probabilistic Gabor and MRF segmentation of brain tumours in MRI volumes", "author": ["N. Subbanna", "D. Precup", "L. Collins", "T. Arbel"], "venue": "in: MICCAI", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2013}, {"title": "Fully Automatic Segmentation of Brain Tumor Images Using Support Vector Machine Classification in Combination with Hierarchical Conditional Random Field Regularization", "author": ["S. Bauer", "L. Nolte", "M. Reyes"], "venue": "in: MICCAI", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2011}, {"title": "Semi-automatic liver tumor segmentation with HMM field model and non-parametric distribution estimation", "author": ["Y. Hame", "M. Pollari"], "venue": "Med. I. Ana. 16 ", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2012}, {"title": "K", "author": ["M. Sabuncu", "B. Yeo"], "venue": "Leemput, et al., A Generative Model for Image Segmentation Based on Label Fusion, IEEE Trans. Med. Imag. 29 ", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2010}, {"title": "P", "author": ["V. Vineet", "J. Warrell"], "venue": "H. S. Torr, Filter-based mean-field inference for random fields with higher-order terms and product label-spaces., in: ECCV", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2012}, {"title": "Classification method for disease risk mapping based on discrete hidden Markov random fields", "author": ["M. Charras-Garrido", "D. Abrial", "J. Goer", "S. Dachian", "N. Peyrard"], "venue": "Biostatistics 13 ", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2012}, {"title": "Nonlinear dimensionality reduction by locally linear embedding", "author": ["S. Roweis", "L. Saul"], "venue": "Science 290 ", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2000}, {"title": "Manifold-constrained embeddings for the detection of white matter lesions in brain MRI", "author": ["S. Kadoury", "G. Erus", "E. Zacharaki", "N. Paragios", "C. Davatzikos"], "venue": "in: ISBI", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2012}, {"title": "Hierarchical manifold learning", "author": ["K.K. Bhatia", "A. Rao", "A.N. Price", "R. Wolz", "J. Hajnal", "D. Rueckert"], "venue": "in: Proc. MICCAI", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2012}, {"title": "Manifold modeling for brain population analysis", "author": ["S. Gerber", "T. Tasdizen", "P. Fletcher", "S. Joshi", "R. Whitaker"], "venue": "Med. Image Anal. 14 ", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2010}, {"title": "Higher-Order CRF Tumor Segmentation with Discriminant Manifold Potentials", "author": ["S. Kadoury", "N. Abi-Jaoudeh", "P. Valdes"], "venue": "in: MICCAI", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2013}, {"title": "Robust higher order potentials for enforcing label consistency", "author": ["P. Kohli", "L. Ladicky", "P. Torr"], "venue": "IJCV 82 ", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2009}, {"title": "A Grand Challenge II Liver Tumor Segmentation", "author": ["X. Deng", "G. Du"], "venue": "in: MICCAI Workshop Proceedings of 3D Segmentation in the Clinic", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2008}, {"title": "C", "author": ["M. Harandi"], "venue": "Sanderson, et al., Graph embedding discriminant analysis on grassmannian manifolds for improved image set matching, in: CVPR", "citeRegEx": "23", "shortCiteRegEx": null, "year": 2011}, {"title": "S", "author": ["S. Yan", "D. Xu", "B. Zhang", "H.-J. Zhang", "Q. Yang"], "venue": "Lin., Graph embedding and extensions: A general framework for dimensionality reduction, IEEE Trans. Pattern Anal. Mach. Intell. 29 ", "citeRegEx": "24", "shortCiteRegEx": null, "year": 2007}, {"title": "Guiding model search using segmentation", "author": ["G. Mori"], "venue": "in: ICCV", "citeRegEx": "25", "shortCiteRegEx": null, "year": 2005}, {"title": "Efficient Inference in Fully Connected CRFs with Gaussian Edge Potentials", "author": ["P. Kr\u00e4henb\u00fchl", "V. Koltun"], "venue": "in: NIPS 24", "citeRegEx": "26", "shortCiteRegEx": null, "year": 2011}, {"title": "MRF Energy Minimization and Beyond via Dual Decomposition", "author": ["N. Komodakis", "N. Paragios", "G. Tziritas"], "venue": "IEEE Trans. PAMI 33 (3) ", "citeRegEx": "27", "shortCiteRegEx": null, "year": 2011}, {"title": "Towards cone-beam ct thermometry", "author": ["M. Li", "N. Abi-Jaoudeh", "A. Kapoor", "S. Kadoury", "S. Xu", "N. Noordhoek", "A. Radaelli", "B. Carelsen", "B.J. Wood"], "venue": "in: SPIE Medical Imaging, International Society for Optics and Photonics", "citeRegEx": "28", "shortCiteRegEx": null, "year": 2013}, {"title": "Automatic liver segmentation using a statistical shape model with optimal surface detection", "author": ["X. Zhang", "J. Tian", "K. Deng", "Y. Wu", "X. Li"], "venue": "Biomedical Engineering, IEEE Transactions on 57 (10) ", "citeRegEx": "29", "shortCiteRegEx": null, "year": 2010}, {"title": "Active contours driven by local gaussian distribution fitting energy", "author": ["L. Wang", "L. He", "A. Mishra", "C. Li"], "venue": "Signal Process. 89 ", "citeRegEx": "30", "shortCiteRegEx": null, "year": 2009}], "referenceMentions": [{"referenceID": 0, "context": "One example of such an application in liver oncology is the Response Evaluation Criteria in Solid Tumors (RECIST) that measures the size of solid tumors as the maximum diameter [1].", "startOffset": 177, "endOffset": 180}, {"referenceID": 1, "context": "However manual segmentation is not applicable in clinical routine as it takes too much time and lacks reproducibility across raters [2].", "startOffset": 132, "endOffset": 135}, {"referenceID": 2, "context": "Approaches using discrete Markov Random Fields (MRFs; [3]) and Conditional Random Fields (CRFs; [4]) were used to model complex dependencies within sample distributions, offering improved segmentation accuracy compared to independent and identically distributed (i.", "startOffset": 54, "endOffset": 57}, {"referenceID": 3, "context": "Approaches using discrete Markov Random Fields (MRFs; [3]) and Conditional Random Fields (CRFs; [4]) were used to model complex dependencies within sample distributions, offering improved segmentation accuracy compared to independent and identically distributed (i.", "startOffset": 96, "endOffset": 99}, {"referenceID": 4, "context": "[5] located tumor boundaries uses machine learning to classify regions, while Freiman et al.", "startOffset": 0, "endOffset": 3}, {"referenceID": 5, "context": "[6] used a Bayesian classifier to segment various organs with medical images and subsequently applied morphological operators to correct for segmentation discrepancies.", "startOffset": 0, "endOffset": 3}, {"referenceID": 6, "context": "Furthermore, a study comparing three semi-automated methods was presented in [7] using contrast-enhanced CT.", "startOffset": 77, "endOffset": 80}, {"referenceID": 7, "context": "[8], a", "startOffset": 0, "endOffset": 3}, {"referenceID": 8, "context": "In [9], a hierarchical probabilistic Gabor filter was used in combination with an MRF segmentation framework to delineate brain tumors in MRI volumes, where a Bayesian framework provides a coarse probabilistic texture-based segmentation of active and edema regions.", "startOffset": 3, "endOffset": 6}, {"referenceID": 9, "context": "In [10], SVM classification using multispectral intensities and textures is combined with hierarchical CRFs to segment brain tumors in MR images.", "startOffset": 3, "endOffset": 7}, {"referenceID": 10, "context": "In [11], a semi-automated lesion segmentation method is presented using Markov Random Fields and non-parametric distributions which are defined locally to estimate the tumor shape.", "startOffset": 3, "endOffset": 7}, {"referenceID": 11, "context": "On the other hand, higher-order relationships can incorporate a reliable labelling output within inhomogeneous regions, as shown in [12], while prior information modelled as co-occurrences between various classes has demonstrated significant promise for segmentation [13].", "startOffset": 132, "endOffset": 136}, {"referenceID": 12, "context": "On the other hand, higher-order relationships can incorporate a reliable labelling output within inhomogeneous regions, as shown in [12], while prior information modelled as co-occurrences between various classes has demonstrated significant promise for segmentation [13].", "startOffset": 267, "endOffset": 271}, {"referenceID": 13, "context": "This idea has been applied for the classification of pathology using discrete hidden MRFs [14].", "startOffset": 90, "endOffset": 94}, {"referenceID": 14, "context": "A major drawback from these methods is that conditional probabilities are obtained directly from the high-dimensional image space, which is not ideal as they fail to express the underlying representation of the dataset and assimilates all measures to Euclidean distances [15].", "startOffset": 271, "endOffset": 275}, {"referenceID": 15, "context": "Recently, various approaches have used manifolds to discriminate the presence of white matter brain lesions [16] or track organ motion or discover regional variations within images [17].", "startOffset": 108, "endOffset": 112}, {"referenceID": 16, "context": "Recently, various approaches have used manifolds to discriminate the presence of white matter brain lesions [16] or track organ motion or discover regional variations within images [17].", "startOffset": 181, "endOffset": 185}, {"referenceID": 17, "context": "In [18], manifold learning techniques were used to capture the non-linear variability of brain development from a dataset of MR images.", "startOffset": 3, "endOffset": 7}, {"referenceID": 18, "context": "Preliminary results demonstrated promise but was validated on a limited dataset and could not properly capture inter-tumor inhomogeneities [20].", "startOffset": 139, "endOffset": 143}, {"referenceID": 19, "context": "These potentials are integrated in an existing higher-order conditional random field [21].", "startOffset": 85, "endOffset": 89}, {"referenceID": 20, "context": "The first clinical dataset was the public dataset from the 2008 MICCAI segmentation challenge, which was used by several other groups for tumor segmentation [22].", "startOffset": 157, "endOffset": 161}, {"referenceID": 21, "context": "We present here the mechanism to learn the optimal separation between normal and pathological tissue by using a discriminant graph-embedding based on Grassmannian manifolds proposed by [23], where it is adapted to the segmentation process.", "startOffset": 185, "endOffset": 189}, {"referenceID": 21, "context": "This kernel is positive definite since zKz > 0 such that \u2200z \u2208 R as shown in [23], and welldefined since singular values of x1 x2 are equal to R T 1 x T 1 x2R2, with R1,R2 \u2208 Q(o), indicating orthonormal matrices of order o.", "startOffset": 76, "endOffset": 80}, {"referenceID": 22, "context": "remain the same in either space by solving a general eigen-analysis problem [24].", "startOffset": 76, "endOffset": 80}, {"referenceID": 14, "context": "Discriminant graph-embedding based on locally linear embedding (LLE) [15] uses graphpreserving criterions to maintain these similarities, which are included in a sparse and symmetric N \u00d7 N matrix, denoted as M .", "startOffset": 69, "endOffset": 73}, {"referenceID": 21, "context": "By replacing the linear solution in the minimization and maximization of the between- and within-class graphs, the optimal projection matrix A is acquired from the optimization of the function as proposed by Harandi [23].", "startOffset": 216, "endOffset": 220}, {"referenceID": 19, "context": "We use higher-order conditional random fields [21, 10], where instead of using direct voxel intensities which is a highly dimensional problem, clique potentials are derived from the trained discriminant embeddings in order to perform an unsupervised tumor segmentation.", "startOffset": 46, "endOffset": 54}, {"referenceID": 9, "context": "We use higher-order conditional random fields [21, 10], where instead of using direct voxel intensities which is a highly dimensional problem, clique potentials are derived from the trained discriminant embeddings in order to perform an unsupervised tumor segmentation.", "startOffset": 46, "endOffset": 54}, {"referenceID": 23, "context": "Here, image segments xi are obtained from superpixels on each 2D slice, which consists of a normalized-cut segmentation method, followed by an iterative k-means clustering to create an image parcelled in equal-sized patches (average size of 12 pixels) that do not overlap [25].", "startOffset": 272, "endOffset": 276}, {"referenceID": 24, "context": "Pairwise potentials are expressed as non-parametric manifold dissimilarities, extending the Gaussian kernel formulation in feature space which uses meanfield approximations of fully-connected CRF models [26].", "startOffset": 203, "endOffset": 207}, {"referenceID": 12, "context": "We use the strategy in [13] where for a given clique vs grouping t segments, t different embeddings are generated with the manifold projection matrix A.", "startOffset": 23, "endOffset": 27}, {"referenceID": 19, "context": "As proposed by [21], the penalty term \u03bbq measures how the output unary potential varies on all voxels of a segment in order to assess the reliability of the potential.", "startOffset": 15, "endOffset": 19}, {"referenceID": 19, "context": "[21] showed that ro-", "startOffset": 0, "endOffset": 4}, {"referenceID": 25, "context": "Finally we apply a Primal-Dual algorithm called FastPD [27] which can efficiently solve the problem in a discrete domain by formulating the duality theory in linear programming.", "startOffset": 55, "endOffset": 59}, {"referenceID": 26, "context": "While they do not yield images similar to real patient images, it was shown in previous studies to provide significant information on the behavior of image processing algorithms [28].", "startOffset": 178, "endOffset": 182}, {"referenceID": 20, "context": "Measures such as (1) volumetric overlap error (%), (2) the average symmetric surface distance (mm), (3) the root mean square (RMS) symmetric surface distance (mm), (4) the relative absolute volume difference (%), and (5) the maximum symmetry surface distance (mm) were computed for each segmentation based on the 2008 MICCAI liver tumor segmentation challenge [22].", "startOffset": 360, "endOffset": 364}, {"referenceID": 27, "context": "No user interaction was required as the datasets were already processed to segment the liver from CT images [29].", "startOffset": 108, "endOffset": 112}, {"referenceID": 28, "context": "Segmentations were compared to an active contours approach with local Gaussian distributions [30] and to a texture classification method [10].", "startOffset": 93, "endOffset": 97}, {"referenceID": 9, "context": "Segmentations were compared to an active contours approach with local Gaussian distributions [30] and to a texture classification method [10].", "startOffset": 137, "endOffset": 141}, {"referenceID": 28, "context": "05) than distances generated by [30] and [10].", "startOffset": 32, "endOffset": 36}, {"referenceID": 9, "context": "05) than distances generated by [30] and [10].", "startOffset": 41, "endOffset": 45}, {"referenceID": 10, "context": "As demonstrated in [11], segmentation results were not as accurate for larger tumors compared to smaller sized tumors.", "startOffset": 19, "endOffset": 23}, {"referenceID": 28, "context": "LGD [30] 33.", "startOffset": 4, "endOffset": 8}, {"referenceID": 9, "context": "SVM+CRF [10] 31.", "startOffset": 8, "endOffset": 12}, {"referenceID": 28, "context": "Results were also compared to an active contours approach with local Gaussian distributions [30] and to a texture classification method [10].", "startOffset": 92, "endOffset": 96}, {"referenceID": 9, "context": "Results were also compared to an active contours approach with local Gaussian distributions [30] and to a texture classification method [10].", "startOffset": 136, "endOffset": 140}, {"referenceID": 28, "context": "05) to distance measures generated by [30] and [10].", "startOffset": 38, "endOffset": 42}, {"referenceID": 9, "context": "05) to distance measures generated by [30] and [10].", "startOffset": 47, "endOffset": 51}, {"referenceID": 28, "context": "First column shows ground-truth delineation verified by a radiologist, the second column presents results obtained with the proposed segmentation approach, the third using Gaussian distributions [30] and the last column with texture classification with SVM\u2019s.", "startOffset": 195, "endOffset": 199}, {"referenceID": 28, "context": "LGD [30] 28.", "startOffset": 4, "endOffset": 8}, {"referenceID": 9, "context": "SVM+CRF [10] 26.", "startOffset": 8, "endOffset": 12}], "year": 2015, "abstractText": "Early detection, diagnosis and monitoring of liver cancer progression can be achieved with precise delineation of metastatic tumors. However accurate automated segmentation remains challenging due to presence of noise, inhomogeneity and high appearance variability of malignant tissue. In this paper, we propose an unsupervised metastatic liver tumor segmentation framework using a machine learning approach based discriminant Grassmannian manifolds which learns the appearance of tumors with respect to normal tissue. First, the framework learns within-class and between-class similarity distributions from a training set of images to discover the optimal manifold discrimination between normal and pathological tissue in the liver. Second, a conditional optimization scheme computes non-local pairwise as well as pattern-based clique potentials from the manifold subspace to recognize regions with similar labelings and incorporate global consistency in the segmentation process. The proposed framework was validated on clinical database of 43 CT images from patients with metastatic liver cancer. Compared to stateof-the-art methods, our method achieves better performance on two separate datasets of metastatic liver tumors from different clinical sites, yielding an overall mean Dice similarity coefficient of 90.7\u00b1 2.4 in over 50 tumors with an average volume of 27.3mm.", "creator": "LaTeX with hyperref package"}}}