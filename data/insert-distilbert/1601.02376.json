{"id": "1601.02376", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "11-Jan-2016", "title": "Deep Learning over Multi-field Categorical Data: A Case Study on User Response Prediction", "abstract": "predicting particular user responses, such as both click - through rate and conversion rate, are critical domains in many specific web applications previously including web search, personalised recommendation, and online advertising. different entirely from any continuous raw features that we usually found in the image and audio domains, the input features provided in web space are always cases of multi - field and are mostly discrete and categorical while their dependencies nowadays are little known. major user response prediction prediction models have to either limit only themselves to linear models or require manually building up high - order combination features. the former loses the selective ability of exploring feature interactions, while the latter results in a heavy computation gap in the large feature space. partly to tackle the issue, we propose two novel models using deep neural networks ( dnns ) to automatically learn detailed effective patterns from categorical feature interactions and make predictions of users'meaningful ad clicks. to get our dnns efficiently work, we propose to leverage three traditional feature transformation methods, i. s e., factorisation machines ( fms ), dynamic restricted boltzmann machines ( rbms ) and generalized denoising auto - encoders ( daes ). this paper presents the structure of our models and their efficient training algorithms. the large - scale experiments with real - world data demonstrate that our calculation methods just work relatively better than major state - of - the - it art models.", "histories": [["v1", "Mon, 11 Jan 2016 10:04:40 GMT  (3075kb)", "http://arxiv.org/abs/1601.02376v1", null]], "reviews": [], "SUBJECTS": "cs.LG cs.IR", "authors": ["weinan zhang", "tianming du", "jun wang"], "accepted": false, "id": "1601.02376"}, "pdf": {"name": "1601.02376.pdf", "metadata": {"source": "CRF", "title": null, "authors": ["Weinan Zhang", "Tianming Du", "Jun Wang"], "emails": ["w.zhang@cs.ucl.ac.uk,", "j.wang@cs.ucl.ac.uk,", "dutianming@quicloud.cn"], "sections": [{"heading": null, "text": "ar X\niv :1\n60 1.\n02 37\n6v 1\n[ cs\n.L G\n] 1\n1 Ja\nn 20"}, {"heading": "1 Introduction", "text": "User response (e.g., click-through or conversion) prediction plays a critical part in many web applications including web search, recommender systems, sponsored search, and display advertising. In online advertising, for instance, the ability of targeting individual users is the key advantage compared to traditional offline advertising. All these targeting techniques, essentially, rely on the system function of predicting whether a specific user will think the potential ad is \u201crelevant\u201d, i.e., the probability that the user in a certain context will click a given ad [6]. Sponsored search, contextual advertising, and the recently emerged realtime bidding (RTB) display advertising all heavily rely on the ability of learned models to predict ad click-through rates (CTR) [32,41]. The applied CTR estimation models today are mostly linear, ranging from logistic regression [32] and naive Bayes [14] to FTRL logistic regression [28] and Bayesian probit regression [12], all of which are based on a huge number of sparse features with one-hot encoding [1]. Linear models have advantages of easy implementation, efficient learning but relative low performance because of the failure of learning the nontrivial patterns to catch the interactions between the assumed (conditionally)\nindependent raw features [12]. Non-linear models, on the other hand, are able to utilise different feature combinations and thus could potentially improve estimation performance. For example, factorisation machines (FMs) [29] map the user and item binary features into a low dimensional continuous space. And the feature interaction is automatically explored via vector inner product. Gradient boosting trees [38] automatically learn feature combinations while growing each decision/regression tree. However, these models cannot make use of all possible combinations of different features [20]. In addition, many models require feature engineering that manually designs what the inputs should be. Another problem of the mainstream ad CTR estimation models is that most prediction models have shallow structures and have limited expression to model the underlying patterns from complex and massive data [15]. As a result, their data modelling and generalisation ability is still restricted.\nDeep learning [25] has become successful in computer vision [22], speech recognition [13], and natural language processing (NLP) [19,33] during recent five years. As visual, aural, and textual signals are known to be spatially and/or temporally correlated, the newly introduced unsupervised training on deep structures [18] would be able to explore such local dependency and establish a dense representation of the feature space, making neural network models effective in learning high-order features directly from the raw feature input. With such learning ability, deep learning would be a good candidate to estimate online user response rate such as ad CTR. However, most input features in CTR estimation are of multi-field and are discrete categorical features, e.g., the user location city (London, Paris), device type (PC, Mobile), ad category (Sports, Electronics) etc., and their local dependencies (thus the sparsity in the feature space) are unknown. Therefore, it is of great interest to see how deep learning improves the CTR estimation via learning feature representation on such large-scale multifield discrete categorical features. To our best knowledge, there is no previous literature of ad CTR estimation using deep learning methods thus far1. In addition, training deep neural networks (DNNs) on a large input feature space requires tuning a huge number of parameters, which is computationally expensive. For instance, unlike image and audio cases, we have about 1 million binary input features and 100 hidden units in the first layer; then it requires 100 million links to build the first layer neural network.\nIn this paper, we take ad CTR estimation as a working example to study deep learning over a large multi-field categorical feature space by using embedding methods in both supervised and unsupervised fashions. We introduce two types of deep learning models, called Factorisation Machine supported Neural Network (FNN) and Sampling-based Neural Network (SNN). Specifically, FNN with a supervised-learning embedding layer using factorisation machines [31] is proposed to efficiently reduce the dimension from sparse features to dense continuous features. The second model SNN is a deep neural network powered by a sampling-based restricted Boltzmann machine (SNN-RBM) or a samplingbased denoising auto-encoder (SNN-DAE) with a proposed negative sampling method. Based on the embedding layer, we build multiple layers neural nets\n1 Although the leverage of deep learning models on ad CTR estimation has been claimed in industry (e.g., [42]), there is no detail of the models or implementation.\nwith full connections to explore non-trivial data patterns. Our experiments on multiple real-world advertisers\u2019 ad click data have demonstrated the consistent improvement of CTR estimation from our proposed models over the state-ofthe-art ones."}, {"heading": "2 Related Work", "text": "Click-through rate, defined as the probability of the ad click from a specific user on a displayed ad, is essential in online advertising [39]. In order to maximise revenue and user satisfaction, online advertising platforms must predict the expected user behaviour for each displayed ad and maximise the expectation that users will click. The majority of current models use logistic regression based on a set of sparse binary features converted from the original categorical features via one-hot encoding [26,32]. Heavy engineering efforts are needed to design features such as locations, top unigrams, combination features, etc. [15].\nEmbedding very large feature vector into low-dimensional vector spaces is useful for prediction task as it reduces the data and model complexity and improves both the effectiveness and the efficiency of the training and prediction. Various methods of embedding architectures have been proposed [37,23]. Factorisation machine (FM) [31], originally proposed for collaborative filtering recommendation, is regarded as one of the most successful embedding models. FM naturally has the capability of estimating interactions between any two features via mapping them into vectors in a low-rank latent space.\nDeep Learning [2] is a branch of artificial intelligence research that attempts to develop the techniques that will allow computers to handle complex tasks such as recognition and prediction at high performance. Deep neural networks (DNNs) are able to extract the hidden structures and intrinsic patterns at different levels of abstractions from training data. DNNs have been successfully applied in computer vision [40], speech recognition [8] and natural language processing (NLP) [7,19,33]. Furthermore, with the help of unsupervised pre-training, we can get good feature representation which guides the learning towards basins of attraction of minima that support better generalisation from the training data [10]. Usually, these deep models have two stages in learning [18]: the first stage performs model initialisation via unsupervised learning (i.e., the restricted Boltzmann machine or stacked denoising auto-encoders) to make the model catch the input data distribution; the second stage involves a fine tuning of the initialised model via supervised learning with back-propagation. The novelty of our deep learning models lies in the first layer initialisation, where the input raw features are high dimensional and sparse binary features converted from the raw categorical features, which makes it hard to train traditional DNNs in large scale. Compared with the word-embedding techniques used in NLP [19,33], our models deal with more general multi-field categorical features without any assumed data structures such as word alignment and letter-n-gram etc."}, {"heading": "3 DNNs for CTR Estimation given Categorical Features", "text": "In this section, we discuss the two proposed DNN architectures in detail, namely Factorisation-machine supported Neural Networks (FNN) and Sampling-based\nNeural Networks (SNN). The input categorical features are field-wise one-hot encoded. For each field, e.g., city, there are multiple units, each of which represents a specific value of this field, e.g., city=London, and there is only one positive (1) unit, while all others are negative (0). The encoded features, denoted as x, are the input of many CTR estimation models [32,26] as well as our DNN models, as depicted at the bottom layer of Figure 1."}, {"heading": "3.1 Factorisation-machine supported Neural Networks (FNN)", "text": "Our first model FNN is based on the factorisation machine as the bottom layer. The network structure is shown in Figure 1. With a top-down description, the output unit is a real number y\u0302 \u2208 (0, 1) as predicted CTR, i.e., the probability of a specific user clicking a given ad in a certain context:\ny\u0302 = sigmoid(W 3l2 + b3), (1)\nwhere sigmoid(x) = 1/(1 + e\u2212x) is the logistic activation function, W 3 \u2208 R 1\u00d7L, b3 \u2208 R and l2 \u2208 R L as input for this layer. The calculation of l2 is\nl2 = tanh(W 2l1 + b2), (2)\nwhere tanh(x) = (1 \u2212 e\u22122x)/(1 + e\u22122x), W 2 \u2208 R L\u00d7M , b2 \u2208 R L and l1 \u2208 R M . We choose tanh(\u00b7) as it has optimal empirical learning performance than other activation functions, as will be discussed in Section 4.3. Similarly,\nl1 = tanh(W 1z + b1), (3)\nwhere W 1 \u2208 R M\u00d7J , b1 \u2208 R M and z \u2208 RJ .\nz = (w0, z1, z2, ...zi, ..., zn), (4)\nwhere w0 \u2208 R is a global scalar parameter and n is the number of fields in total. zi \u2208 R K+1 is a parameter vectors for the i-th field in factorisation machines:\nzi = W i 0 \u00b7 x[starti : endi] = (wi, v 1 i , v 2 i , . . . , v K i ), (5)\nwhere starti and endi are starting and ending feature indexes of the i-th field, W\ni 0 \u2208 R (K+1)\u00d7(endi\u2212starti+1) and x is the input vector as described at beginning. All weights W i0 are initialised with the bias term wi and vector vi respectively (e.g., W i0[0] is initialised by wi, W i 0[1] is initialised by v 1 i , W i 0[2] is initialised by v2i , etc.). In this way, z vector of the first layer is initialised as shown in Figure 1 via training a factorisation machine (FM) [31]:\nyFM(x) := sigmoid ( w0 +\nN \u2211\ni=1\nwixi +\nN \u2211\ni=1\nN \u2211\nj=i+1\n\u3008vi,vj\u3009xixj\n)\n, (6)\nwhere each feature i is assigned with a bias weight wi and aK-dimensional vector vi and the feature interaction is modelled as their vectors\u2019 inner product \u3008vi,vj\u3009. In this way, the above neural nets can learn more efficiently from factorisation machine representation so that the computational complexity problem of the high-dimensional binary inputs has been naturally bypassed. Different hidden layers can be regarded as different internal functions capturing different forms of representations of the data instance. For this reason, this model has more abilities of catching intrinsic data patterns and leads to better performance.\nThe idea using FM in the bottom layer is ignited by Convolutional Neural Networks (CNNs) [11], which exploit spatially local correlation by enforcing a local connectivity pattern between neurons of adjacent layers. Similarly, the inputs of hidden layer 1 are connected to the input units of a specific field. Also, the bottom layer is not fully connected as FM performs a field-wise training for one-hot sparse encoded input, allowing local sparsity, illustrated as the dash lines in Figure 1. FM learns good structural data representation in the latent space, helpful for any further model to build on. A subtle difference, though, appears between the product rule of FM and the sum rule of DNN for combination. However, according to [21], if the observational discriminatory information is highly ambiguous (which is true in our case for ad click behaviour), the posterior weights (from DNN) will not deviate dramatically from the prior (FM).\nFurthermore, the weights in hidden layers (except the FM layer) are initialised by layer-wise RBM pre-training [3] using contrastive divergence [17], which effectively preserves the information in input dataset as detailed in [18,16]. The initial weights for FMs are trained by stochastic gradient descent (SGD), as detailed in [31]. Note that we only need to update weights which connect to the positive input units, which largely reduces the computational complexity. After pre-training of the FM and upper layers, supervised fine-tuning (back propagation) is applied to minimise loss function of cross entropy:\nL(y, y\u0302) = \u2212y log y\u0302 \u2212 (1\u2212 y) log(1\u2212 y\u0302), (7)\nwhere y\u0302 is the predicted CTR in Eq. (1) and y is the binary click ground-truth label. Using the chain rule of back propagation, the FNN weights including FM\nweights can be efficiently updated. For example, we update FM layer weights via\n\u2202L(y, y\u0302)\n\u2202W i0 =\n\u2202L(y, y\u0302)\n\u2202zi\n\u2202zi\n\u2202W i0 =\n\u2202L(y, y\u0302)\n\u2202zi x[starti : endi] (8)\nW i 0 \u2190 W i 0 \u2212 \u03b7 \u00b7\n\u2202L(y, y\u0302)\n\u2202zi x[starti : endi]. (9)\nDue to the fact that the majority entries of x[starti : endi] are 0, we can accelerate fine-tuning by updating weights linking to positive units only."}, {"heading": "3.2 Sampling-based Neural Networks (SNN)", "text": "The structure of the second model SNN is shown in Figure 2(a). The difference between SNN and FNN lies in the structure and training method in the bottom layer. SNN\u2019s bottom layer is fully connected with sigmoid activation function:\nz = sigmoid(W 0x+ b0). (10)\nTo initialise the weights of the bottom layer, we tried both restricted Boltzmann machine (RBM) [16] and denoising auto-encoder (DAE) [4] in the pretraining stage. In order to deal with the computational problem of training large sparse one-hot encoding data, we propose a sampling-based RBM (Figure 2(b), denoted as SNN-RBM) and a sampling-based DAE in (Figure 2(c), denoted as SNN-DAE) to efficiently calculate the initial weights of the bottom layer.\nInstead of modelling the whole feature set for each training instance set, for each feature field, e.g., city, there is only one positive value feature for each training instance, e.g., city=London, we sample m negative units, e.g., city=Paris when m = 1, randomly with value 0. Black units in Figure 2(b) and 2(c) are unsampled and thus ignored when pre-training the data instance. With the sampled units, we can train an RBM via contrastive divergence [17] and a DAE via SGD with unsupervised approaches to largely reduce the data\ndimension with high recovery performance. The real-value dense vector is used as the input of the further layers in SNN.\nIn this way, computational complexity can be dramatically reduced and, in turn, initial weights can be calculated quickly and back-propagation is then performed to fine-tune SNN model."}, {"heading": "3.3 Regularisation", "text": "To prevent overfitting, the widely used L2 regularisation term is added to the loss function. For example, the L2 regularisation for FNN in Figure 1 is\n\u2126(w) = ||W 0|| 2 2 +\n3 \u2211\nl=1\n(\n||W l|| 2 2 + ||bl|| 2 2\n)\n. (11)\nOn the other hand, dropout [35] is a technique which becomes a popular and effective regularisation technique for deep learning during the recent years. We also implement this regularisation and compare them in our experiment."}, {"heading": "4 Experiment", "text": ""}, {"heading": "4.1 Experiment Setup", "text": "Data. We evaluate our models based on iPinYou dataset [27], a public realworld display ad dataset with each ad display information and corresponding user click feedback. The data logs are organised by different advertisers and in a row-per-record format. There are 19.50M data instances with 14.79K positive label (click) in total. The features for each data instance are all categorical. Feature examples in the ad log data are user agent, partially masked IP, region, city, ad exchange, domain, URL, ad slot ID, ad slot visibility, ad slot size, ad slot format, creative ID, user tags, etc. After one-hot encoding, the number of binary features is 937.67K in the whole dataset. We feed each compared model with these binary-feature data instances and the user click (1) and non-click (0) feedback as the ground-truth labels. In our experiments, we use training data from advertiser 1458, 2259, 2261, 2997, 3386 and the whole dataset, respectively. Models. We compare the performance of the following CTR estimation models:\nLR: Logistic Regression [32] is a linear model with simple implementation and fast training speed, which is widely used in online advertising estimation.\nFM: Factorisation Machine [31] is a non-linear model able to estimate feature interactions even in problems with huge sparsity.\nFNN: Factorisation-machine supported Neural Network is our proposed model as described in Section 3.1.\nSNN: Sampling-based Neural Network is also our proposed model with samplingbased RBM and DAE pre-training methods for the first layer in Section 3.2, denoted as SNN-RBM and SNN-DAE respectively.\nOur experiment code2 of both FNN and SNN is implemented with Theano3. Metric. To measure the CTR estimation performance of each model, we employ the area under ROC curve (AUC)4. The AUC [12] metric is a widely used measure for evaluating the CTR performance."}, {"heading": "4.2 Performance Comparison", "text": "Table 1 shows the results that compare LR, FM, FNN and SNN with RBM and DAE on 5 different advertisers and the whole dataset. We observe that FM is not significantly better than LR, which means 2-order combination features might not be good enough to catch the underlying data patterns. The AUC performance of the proposed FNN and SNN is better than the performance of LR and FM on all tested datasets. Based on the latent structure learned by FM, FNN further learns effective patterns between these latent features and provides a consistent improvement over FM. The performance of SNN-DAE and SNN-RBM is generally consistent, i.e., the relative order of the results of the SNN are almost the same."}, {"heading": "4.3 Hyperparameter Tuning", "text": "Due to the fact that deep neural networks involve many implementation details and need to tune a fairly large number of hyper-parameters, following details show how we implement our models and tune hyperparameters in the models.\nWe use stochastic gradient descent to learn most of our parameters for all proposed models. Regarding selecting the number of training epochs, we use early stopping [30], i.e., the training stops when the validation error increases. We try different learning rate from 1, 0.1, 0.01, 0.001 to 0.0001 and choose the one with optimal performance on the validation dataset.\nFor negative unit sampling of SNN-RBM and SNN-DAE, we try the negative sample number m = 1, 2 and 4 per field as described in Section 3.2, and find m = 2 produces the best results in most situations. For the activation functions in both models on the hidden layers (as Eqs. (3) and (2)), we try linear function, sigmoid function and tanh function, and find the result of tanh function is optimal. This might be because the hyperbolic tangent often converges faster than the sigmoid function.\n2 The source code with demo data: https://github.com/wnzhang/deep-ctr 3 Theano: http://deeplearning.net/software/theano/ 4 Besides AUC, root mean square error (RMSE) is also tested. However, positive/negative examples are largly unbalanced in ad click scenario, and the empirically best regression model usually provides the predicted CTR close to 0, which results in very small RMSE values and thus the improvement is not well captured."}, {"heading": "4.4 Architecture Selection", "text": "In our models, we investigate architectures with 3, 4 and 5 hidden layers by fixing all layer sizes and find the architecture with 3 hidden layers (i.e., 5 layers in total) is the best in terms of AUC performance. However, the range of choosing their layer sizes is exponential in the number of hidden layers. Suppose there is a deep neural network with L hidden layers and each of the hidden layers is trained with a range of hidden units from 100 to 500 with increments of 100, thus there are 5L models in total to compare.\nInstead of trying all combinations of hidden units, in our experiment we use another strategy by starting tuning the different hidden layer sizes with the same number of hidden units in all three hidden layers5 since the architecture with equal-size hidden layers is empirically better than the architecture with increasing width or decreasing width in [24]. For this reason, we start tuning layer sizes with equal hidden layer sizes. In fact, apart from increasing, constant, decreasing layer sizes, there is a more effective structure, which is the diamond shape of neural networks, as shown in Figure 3(a). We compare our diamond shape network with other three shapes of networks and tune the total number of total hidden units on two different datasets shown in Figures 3(b) and 3(c). The diamond shape architecture outperforms others in almost all layer size settings. The reason why this diamond shape works might be because this special shape of neural network has certain constraint to the capacity of the neural network, which provides better generalisation on test sets. On the other hand, the performance of diamond architecture picks at the total hidden unit size of 600, i.e., the combination of (200, 300, 100). This depends on the training data observation numbers. Too many hidden units against a limited dataset could cause overfitting."}, {"heading": "4.5 Regularisation Comparison", "text": "Neural network training algorithms are very sensitive to the overfitting problem since deep networks have multiple non-linear layers, which makes them very expressive models that can learn very complicated functions. For DNN models, we compared L2 regularisation (Eq. (11)) and dropout [35] for preventing complex co-adaptations on the training data. The dropout rate implemented in this experiment refers to the probability of each unit being active.\n5 Some advanced Bayesian methods for hyperparameter tuning [34] are not considered in this paper and may be investigated in the future work.\nFigure 4(a) shows the compared AUC performance of SNN-RBM regularised by L2 norm and dropout. It is obvious that dropout outperforms L2 in all compared settings. The reason why dropout is more effective is that when feeding each training case, each hidden unit is stochastically excluded from the network with a probability of dropout rate, i.e., each training case can be regarded as a new model and these models are averaged as a special case of bagging [5], which effectively improves the generalisation ability of DNN models."}, {"heading": "4.6 Analysis of Parameters", "text": "As a summary of Sections 4.4 and 4.5, for both FNN and SNN, there are two important parameters which should be tuned to make the model more effective: (i) the parameters of layer size decide the architecture of the neural network and (ii) the parameter of dropout rate changes generalisation ability on all datasets compared to neural networks just with L2 regularisation.\nFigures 4(b) and 4(c) show how the AUC performance changes with the increasing of dropout in both FNN and SNN. We can find that there is an upward trend of performance in both models at the beginning and then drop sharply with continuous decreasing of dropout rate. The distinction between two models is the different sensitivities of the dropout. From Figure 4(c), we can see the model SNN is sensitive to the dropout rate. This might be caused by the connectivities in the bottom layer. The bottom layer of the SNN is fully connected with the input vector while the bottom layer for FNN is partially connected and thus the FNN is more robust when some hidden units are dropped out. Furthermore, the sigmoid activation function tend to more effective than the linear activation function in terms of dropout. Therefore, the dropout rates at the best performance of FNN and SNN are quite different. For FNN the optimal dropout rate is around 0.8 while for SNN is about 0.99."}, {"heading": "5 Conclusion", "text": "In this paper, we investigated the potential of training deep neural networks (DNNs) to predict users\u2019 ad click response based on multi-field categorical features. To deal with the computational complexity problem of high-dimensional discrete categorical features, we proposed two DNN models: field-wise feature embedding with supervised factorisation machine pre-training, and fully connected DNN with field-wise sampling-based RBM and DAE unsupervised pretraining. These architectures and pre-training algorithms make our DNNs trained\nvery efficiently. Comprehensive experiments on a public real-world dataset verifies that the proposed DNN models successfully learn the underlying data patterns and provide superior CTR estimation performance than other compared models. The proposed models are very general and could enable a wide range of future works. For example, the model performance can be improved by momentum methods in that it suffices for handling the curvature problems in DNN training objectives without using complex second-order methods [36]. In addition, the partial connection in the bottom layer could be extended to higher hidden layers as partial connectivities have many advantages such as lower complexity, higher generalisation ability and more similar to human brain [9]."}], "references": [{"title": "High-level student modeling with machine learning", "author": ["J.E. Beck", "B.P. Woolf"], "venue": "Intelligent tutoring systems. pp. 584\u2013593. Springer", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2000}, {"title": "Learning deep architectures for ai", "author": ["Y. Bengio"], "venue": "Foundations and trends R  \u00a9 in Machine Learning 2(1), 1\u2013127", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2009}, {"title": "Greedy layer-wise training of deep networks", "author": ["Y. Bengio", "P. Lamblin", "D. Popovici", "H Larochelle"], "venue": "NIPS 19, 153", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2007}, {"title": "Generalized denoising auto-encoders as generative models", "author": ["Y. Bengio", "L. Yao", "G. Alain", "P. Vincent"], "venue": "NIPS. pp. 899\u2013907", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2013}, {"title": "Bagging predictors", "author": ["L. Breiman"], "venue": "Machine learning 24(2), 123\u2013140", "citeRegEx": "5", "shortCiteRegEx": null, "year": 1996}, {"title": "Computational advertising", "author": ["A.Z. Broder"], "venue": "SODA. vol. 8, pp. 992\u2013992", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2008}, {"title": "Natural language processing (almost) from scratch", "author": ["R. Collobert", "J. Weston", "L. Bottou", "M. Karlen", "K. Kavukcuoglu", "P. Kuksa"], "venue": "JMLR 12, 2493\u20132537", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2011}, {"title": "A deep convolutional neural network using heterogeneous pooling for trading acoustic invariance with phonetic confusion", "author": ["L. Deng", "O. Abdel-Hamid", "D. Yu"], "venue": "ICASSP. pp. 6669\u20136673. IEEE", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2013}, {"title": "A survey of partially connected neural networks", "author": ["D. Elizondo", "E. Fiesler"], "venue": "International journal of neural systems 8(05n06), 535\u2013558", "citeRegEx": "9", "shortCiteRegEx": null, "year": 1997}, {"title": "Why does unsupervised pre-training help deep learning", "author": ["D. Erhan", "Y. Bengio", "A. Courville", "P.A. Manzagol", "P. Vincent", "S. Bengio"], "venue": null, "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2010}, {"title": "Neocognitron: A self-organizing neural network model for a mechanism of pattern recognition unaffected by shift in position", "author": ["K. Fukushima"], "venue": "Biological cybernetics 36(4), 193\u2013202", "citeRegEx": "11", "shortCiteRegEx": null, "year": 1980}, {"title": "Web-scale bayesian clickthrough rate prediction for sponsored search advertising in microsoft\u2019s bing search engine", "author": ["T. Graepel", "J.Q. Candela", "T. Borchert", "R. Herbrich"], "venue": "ICML. pp. 13\u201320", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2010}, {"title": "Speech recognition with deep recurrent neural networks", "author": ["A. Graves", "Mohamed", "A.r.", "G. Hinton"], "venue": "ICASSP. pp. 6645\u20136649. IEEE", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2013}, {"title": "Idiot\u2019s bayesnot so stupid after all? International statistical review", "author": ["D.J. Hand", "K. Yu"], "venue": null, "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2001}, {"title": "Practical lessons from predicting clicks on ads at facebook", "author": ["X. He", "J. Pan", "O. Jin", "T. Xu", "B. Liu", "T. Xu", "Y. Shi", "A. Atallah", "R. Herbrich", "S Bowers"], "venue": "ADKDD. pp. 1\u20139. ACM", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2014}, {"title": "A practical guide to training restricted boltzmann machines", "author": ["G. Hinton"], "venue": "Momentum 9(1), 926", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2010}, {"title": "Training products of experts by minimizing contrastive divergence", "author": ["G.E. Hinton"], "venue": "Neural computation 14(8), 1771\u20131800", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2002}, {"title": "Reducing the dimensionality of data with neural networks", "author": ["G.E. Hinton", "R.R. Salakhutdinov"], "venue": "Science 313(5786), 504\u2013507", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2006}, {"title": "Learning deep structured semantic models for web search using clickthrough data", "author": ["P.S. Huang", "X. He", "J. Gao", "L. Deng", "A. Acero", "L. Heck"], "venue": "CIKM. pp. 2333\u20132338", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2013}, {"title": "3 idiots approach for display advertising challenge", "author": ["Y.C. Juan", "Y. Zhuang", "W.S. Chin"], "venue": "Internet and Network Economics, pp. 254\u2013265. Springer", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2011}, {"title": "On combining classifiers", "author": ["J. Kittler", "M. Hatef", "R.P. Duin", "J. Matas"], "venue": "PAMI 20(3), 226\u2013239", "citeRegEx": "21", "shortCiteRegEx": null, "year": 1998}, {"title": "Imagenet classification with deep convolutional neural networks", "author": ["A. Krizhevsky", "I. Sutskever", "G.E. Hinton"], "venue": "NIPS", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2012}, {"title": "Probabilistic latent network visualization: inferring and embedding diffusion networks", "author": ["T. Kurashima", "T. Iwata", "N. Takaya", "H. Sawada"], "venue": "KDD. pp. 1236\u20131245. ACM", "citeRegEx": "23", "shortCiteRegEx": null, "year": 2014}, {"title": "Exploring strategies for training deep neural networks", "author": ["H. Larochelle", "Y. Bengio", "J. Louradour", "P. Lamblin"], "venue": "JMLR 10, 1\u201340", "citeRegEx": "24", "shortCiteRegEx": null, "year": 2009}, {"title": "Deep learning", "author": ["Y. LeCun", "Y. Bengio", "G. Hinton"], "venue": "Nature 521(7553)", "citeRegEx": "25", "shortCiteRegEx": null, "year": 2015}, {"title": "Estimating conversion rate in display advertising from past performance data", "author": ["Lee", "K.c.", "B. Orten", "A. Dasdan", "W. Li"], "venue": "KDD. pp. 768\u2013776. ACM", "citeRegEx": "26", "shortCiteRegEx": null, "year": 2012}, {"title": "ipinyou global rtb bidding algorithm competition dataset", "author": ["H. Liao", "L. Peng", "Z. Liu", "X. Shen"], "venue": "ADKDD. pp. 1\u20136. ACM", "citeRegEx": "27", "shortCiteRegEx": null, "year": 2014}, {"title": "Ad click prediction: a view from the trenches", "author": ["H.B. McMahan", "G. Holt", "D. Sculley", "M. Young", "D. Ebner", "J. Grady", "L. Nie", "T. Phillips", "E. Davydov", "D Golovin"], "venue": "KDD. pp. 1222\u20131230. ACM", "citeRegEx": "28", "shortCiteRegEx": null, "year": 2013}, {"title": "Predicting response in mobile advertising with hierarchical importance-aware factorization machine", "author": ["R.J. Oentaryo", "E.P. Lim", "D.J.W. Low", "D. Lo", "M. Finegold"], "venue": "WSDM", "citeRegEx": "29", "shortCiteRegEx": null, "year": 2014}, {"title": "Automatic early stopping using cross validation: quantifying the criteria", "author": ["L. Prechelt"], "venue": "Neural Networks 11(4), 761\u2013767", "citeRegEx": "30", "shortCiteRegEx": null, "year": 1998}, {"title": "Factorization machines with libfm", "author": ["S. Rendle"], "venue": "ACM TIST 3(3), 57", "citeRegEx": "31", "shortCiteRegEx": null, "year": 2012}, {"title": "Predicting clicks: estimating the clickthrough rate for new ads", "author": ["M. Richardson", "E. Dominowska", "R. Ragno"], "venue": "WWW. pp. 521\u2013530. ACM", "citeRegEx": "32", "shortCiteRegEx": null, "year": 2007}, {"title": "A latent semantic model with convolutional-pooling structure for information retrieval", "author": ["Y. Shen", "X. He", "J. Gao", "L. Deng", "G. Mesnil"], "venue": "CIKM", "citeRegEx": "33", "shortCiteRegEx": null, "year": 2014}, {"title": "Practical bayesian optimization of machine learning algorithms", "author": ["J. Snoek", "H. Larochelle", "R.P. Adams"], "venue": "NIPS. pp. 2951\u20132959", "citeRegEx": "34", "shortCiteRegEx": null, "year": 2012}, {"title": "Dropout: A simple way to prevent neural networks from overfitting", "author": ["N. Srivastava", "G. Hinton", "A. Krizhevsky", "I. Sutskever", "R. Salakhutdinov"], "venue": "JMLR 15(1), 1929\u20131958", "citeRegEx": "35", "shortCiteRegEx": null, "year": 2014}, {"title": "On the importance of initialization and momentum in deep learning", "author": ["I. Sutskever", "J. Martens", "G. Dahl", "G. Hinton"], "venue": "ICML. pp. 1139\u20131147", "citeRegEx": "36", "shortCiteRegEx": null, "year": 2013}, {"title": "Line: Large-scale information network embedding", "author": ["J. Tang", "M. Qu", "M. Wang", "M. Zhang", "J. Yan", "Q. Mei"], "venue": "WWW. pp. 1067\u20131077", "citeRegEx": "37", "shortCiteRegEx": null, "year": 2015}, {"title": "Using boosted trees for click-through rate prediction for sponsored search", "author": ["I. Trofimov", "A. Kornetova", "V. Topinskiy"], "venue": "WINE. p. 2. ACM", "citeRegEx": "38", "shortCiteRegEx": null, "year": 2012}, {"title": "Click-through rate estimation for rare events in online advertising", "author": ["X. Wang", "W. Li", "Y. Cui", "R. Zhang", "J. Mao"], "venue": "Online Multimedia Advertising: Techniques and Technologies pp. 1\u201312", "citeRegEx": "39", "shortCiteRegEx": null, "year": 2010}, {"title": "Adaptive deconvolutional networks for mid and high level feature learning", "author": ["M.D. Zeiler", "G.W. Taylor", "R. Fergus"], "venue": "ICCV. pp. 2018\u20132025. IEEE", "citeRegEx": "40", "shortCiteRegEx": null, "year": 2011}, {"title": "Optimal real-time bidding for display advertising", "author": ["W. Zhang", "S. Yuan", "J. Wang"], "venue": "KDD. pp. 1077\u20131086. ACM", "citeRegEx": "41", "shortCiteRegEx": null, "year": 2014}, {"title": "Mariana: Tencent deep learning platform and its applications", "author": ["Y. Zou", "X. Jin", "Y. Li", "Z. Guo", "E. Wang", "B. Xiao"], "venue": "VLDB 7(13), 1772\u20131777", "citeRegEx": "42", "shortCiteRegEx": null, "year": 2014}], "referenceMentions": [{"referenceID": 5, "context": ", the probability that the user in a certain context will click a given ad [6].", "startOffset": 75, "endOffset": 78}, {"referenceID": 31, "context": "Sponsored search, contextual advertising, and the recently emerged realtime bidding (RTB) display advertising all heavily rely on the ability of learned models to predict ad click-through rates (CTR) [32,41].", "startOffset": 200, "endOffset": 207}, {"referenceID": 40, "context": "Sponsored search, contextual advertising, and the recently emerged realtime bidding (RTB) display advertising all heavily rely on the ability of learned models to predict ad click-through rates (CTR) [32,41].", "startOffset": 200, "endOffset": 207}, {"referenceID": 31, "context": "The applied CTR estimation models today are mostly linear, ranging from logistic regression [32] and naive Bayes [14] to FTRL logistic regression [28] and Bayesian probit regression [12], all of which are based on a huge number of sparse features with one-hot encoding [1].", "startOffset": 92, "endOffset": 96}, {"referenceID": 13, "context": "The applied CTR estimation models today are mostly linear, ranging from logistic regression [32] and naive Bayes [14] to FTRL logistic regression [28] and Bayesian probit regression [12], all of which are based on a huge number of sparse features with one-hot encoding [1].", "startOffset": 113, "endOffset": 117}, {"referenceID": 27, "context": "The applied CTR estimation models today are mostly linear, ranging from logistic regression [32] and naive Bayes [14] to FTRL logistic regression [28] and Bayesian probit regression [12], all of which are based on a huge number of sparse features with one-hot encoding [1].", "startOffset": 146, "endOffset": 150}, {"referenceID": 11, "context": "The applied CTR estimation models today are mostly linear, ranging from logistic regression [32] and naive Bayes [14] to FTRL logistic regression [28] and Bayesian probit regression [12], all of which are based on a huge number of sparse features with one-hot encoding [1].", "startOffset": 182, "endOffset": 186}, {"referenceID": 0, "context": "The applied CTR estimation models today are mostly linear, ranging from logistic regression [32] and naive Bayes [14] to FTRL logistic regression [28] and Bayesian probit regression [12], all of which are based on a huge number of sparse features with one-hot encoding [1].", "startOffset": 269, "endOffset": 272}, {"referenceID": 11, "context": "independent raw features [12].", "startOffset": 25, "endOffset": 29}, {"referenceID": 28, "context": "For example, factorisation machines (FMs) [29] map the user and item binary features into a low dimensional continuous space.", "startOffset": 42, "endOffset": 46}, {"referenceID": 37, "context": "Gradient boosting trees [38] automatically learn feature combinations while growing each decision/regression tree.", "startOffset": 24, "endOffset": 28}, {"referenceID": 19, "context": "However, these models cannot make use of all possible combinations of different features [20].", "startOffset": 89, "endOffset": 93}, {"referenceID": 14, "context": "Another problem of the mainstream ad CTR estimation models is that most prediction models have shallow structures and have limited expression to model the underlying patterns from complex and massive data [15].", "startOffset": 205, "endOffset": 209}, {"referenceID": 24, "context": "Deep learning [25] has become successful in computer vision [22], speech recognition [13], and natural language processing (NLP) [19,33] during recent five years.", "startOffset": 14, "endOffset": 18}, {"referenceID": 21, "context": "Deep learning [25] has become successful in computer vision [22], speech recognition [13], and natural language processing (NLP) [19,33] during recent five years.", "startOffset": 60, "endOffset": 64}, {"referenceID": 12, "context": "Deep learning [25] has become successful in computer vision [22], speech recognition [13], and natural language processing (NLP) [19,33] during recent five years.", "startOffset": 85, "endOffset": 89}, {"referenceID": 18, "context": "Deep learning [25] has become successful in computer vision [22], speech recognition [13], and natural language processing (NLP) [19,33] during recent five years.", "startOffset": 129, "endOffset": 136}, {"referenceID": 32, "context": "Deep learning [25] has become successful in computer vision [22], speech recognition [13], and natural language processing (NLP) [19,33] during recent five years.", "startOffset": 129, "endOffset": 136}, {"referenceID": 17, "context": "As visual, aural, and textual signals are known to be spatially and/or temporally correlated, the newly introduced unsupervised training on deep structures [18] would be able to explore such local dependency and establish a dense representation of the feature space, making neural network models effective in learning high-order features directly from the raw feature input.", "startOffset": 156, "endOffset": 160}, {"referenceID": 30, "context": "Specifically, FNN with a supervised-learning embedding layer using factorisation machines [31] is proposed to efficiently reduce the dimension from sparse features to dense continuous features.", "startOffset": 90, "endOffset": 94}, {"referenceID": 41, "context": ", [42]), there is no detail of the models or implementation.", "startOffset": 2, "endOffset": 6}, {"referenceID": 38, "context": "Click-through rate, defined as the probability of the ad click from a specific user on a displayed ad, is essential in online advertising [39].", "startOffset": 138, "endOffset": 142}, {"referenceID": 25, "context": "The majority of current models use logistic regression based on a set of sparse binary features converted from the original categorical features via one-hot encoding [26,32].", "startOffset": 166, "endOffset": 173}, {"referenceID": 31, "context": "The majority of current models use logistic regression based on a set of sparse binary features converted from the original categorical features via one-hot encoding [26,32].", "startOffset": 166, "endOffset": 173}, {"referenceID": 14, "context": "[15].", "startOffset": 0, "endOffset": 4}, {"referenceID": 36, "context": "Various methods of embedding architectures have been proposed [37,23].", "startOffset": 62, "endOffset": 69}, {"referenceID": 22, "context": "Various methods of embedding architectures have been proposed [37,23].", "startOffset": 62, "endOffset": 69}, {"referenceID": 30, "context": "Factorisation machine (FM) [31], originally proposed for collaborative filtering recommendation, is regarded as one of the most successful embedding models.", "startOffset": 27, "endOffset": 31}, {"referenceID": 1, "context": "Deep Learning [2] is a branch of artificial intelligence research that attempts to develop the techniques that will allow computers to handle complex tasks such as recognition and prediction at high performance.", "startOffset": 14, "endOffset": 17}, {"referenceID": 39, "context": "DNNs have been successfully applied in computer vision [40], speech recognition [8] and natural language processing (NLP) [7,19,33].", "startOffset": 55, "endOffset": 59}, {"referenceID": 7, "context": "DNNs have been successfully applied in computer vision [40], speech recognition [8] and natural language processing (NLP) [7,19,33].", "startOffset": 80, "endOffset": 83}, {"referenceID": 6, "context": "DNNs have been successfully applied in computer vision [40], speech recognition [8] and natural language processing (NLP) [7,19,33].", "startOffset": 122, "endOffset": 131}, {"referenceID": 18, "context": "DNNs have been successfully applied in computer vision [40], speech recognition [8] and natural language processing (NLP) [7,19,33].", "startOffset": 122, "endOffset": 131}, {"referenceID": 32, "context": "DNNs have been successfully applied in computer vision [40], speech recognition [8] and natural language processing (NLP) [7,19,33].", "startOffset": 122, "endOffset": 131}, {"referenceID": 9, "context": "Furthermore, with the help of unsupervised pre-training, we can get good feature representation which guides the learning towards basins of attraction of minima that support better generalisation from the training data [10].", "startOffset": 219, "endOffset": 223}, {"referenceID": 17, "context": "Usually, these deep models have two stages in learning [18]: the first stage performs model initialisation via unsupervised learning (i.", "startOffset": 55, "endOffset": 59}, {"referenceID": 18, "context": "Compared with the word-embedding techniques used in NLP [19,33], our models deal with more general multi-field categorical features without any assumed data structures such as word alignment and letter-n-gram etc.", "startOffset": 56, "endOffset": 63}, {"referenceID": 32, "context": "Compared with the word-embedding techniques used in NLP [19,33], our models deal with more general multi-field categorical features without any assumed data structures such as word alignment and letter-n-gram etc.", "startOffset": 56, "endOffset": 63}, {"referenceID": 31, "context": "The encoded features, denoted as x, are the input of many CTR estimation models [32,26] as well as our DNN models, as depicted at the bottom layer of Figure 1.", "startOffset": 80, "endOffset": 87}, {"referenceID": 25, "context": "The encoded features, denoted as x, are the input of many CTR estimation models [32,26] as well as our DNN models, as depicted at the bottom layer of Figure 1.", "startOffset": 80, "endOffset": 87}, {"referenceID": 0, "context": ", W i0[0] is initialised by wi, W i 0[1] is initialised by v 1 i , W i 0[2] is initialised by v i , etc.", "startOffset": 37, "endOffset": 40}, {"referenceID": 1, "context": ", W i0[0] is initialised by wi, W i 0[1] is initialised by v 1 i , W i 0[2] is initialised by v i , etc.", "startOffset": 72, "endOffset": 75}, {"referenceID": 30, "context": "In this way, z vector of the first layer is initialised as shown in Figure 1 via training a factorisation machine (FM) [31]:", "startOffset": 119, "endOffset": 123}, {"referenceID": 10, "context": "The idea using FM in the bottom layer is ignited by Convolutional Neural Networks (CNNs) [11], which exploit spatially local correlation by enforcing a local connectivity pattern between neurons of adjacent layers.", "startOffset": 89, "endOffset": 93}, {"referenceID": 20, "context": "However, according to [21], if the observational discriminatory information is highly ambiguous (which is true in our case for ad click behaviour), the posterior weights (from DNN) will not deviate dramatically from the prior (FM).", "startOffset": 22, "endOffset": 26}, {"referenceID": 2, "context": "Furthermore, the weights in hidden layers (except the FM layer) are initialised by layer-wise RBM pre-training [3] using contrastive divergence [17], which effectively preserves the information in input dataset as detailed in [18,16].", "startOffset": 111, "endOffset": 114}, {"referenceID": 16, "context": "Furthermore, the weights in hidden layers (except the FM layer) are initialised by layer-wise RBM pre-training [3] using contrastive divergence [17], which effectively preserves the information in input dataset as detailed in [18,16].", "startOffset": 144, "endOffset": 148}, {"referenceID": 17, "context": "Furthermore, the weights in hidden layers (except the FM layer) are initialised by layer-wise RBM pre-training [3] using contrastive divergence [17], which effectively preserves the information in input dataset as detailed in [18,16].", "startOffset": 226, "endOffset": 233}, {"referenceID": 15, "context": "Furthermore, the weights in hidden layers (except the FM layer) are initialised by layer-wise RBM pre-training [3] using contrastive divergence [17], which effectively preserves the information in input dataset as detailed in [18,16].", "startOffset": 226, "endOffset": 233}, {"referenceID": 30, "context": "The initial weights for FMs are trained by stochastic gradient descent (SGD), as detailed in [31].", "startOffset": 93, "endOffset": 97}, {"referenceID": 15, "context": "To initialise the weights of the bottom layer, we tried both restricted Boltzmann machine (RBM) [16] and denoising auto-encoder (DAE) [4] in the pretraining stage.", "startOffset": 96, "endOffset": 100}, {"referenceID": 3, "context": "To initialise the weights of the bottom layer, we tried both restricted Boltzmann machine (RBM) [16] and denoising auto-encoder (DAE) [4] in the pretraining stage.", "startOffset": 134, "endOffset": 137}, {"referenceID": 16, "context": "With the sampled units, we can train an RBM via contrastive divergence [17] and a DAE via SGD with unsupervised approaches to largely reduce the data", "startOffset": 71, "endOffset": 75}, {"referenceID": 34, "context": "On the other hand, dropout [35] is a technique which becomes a popular and effective regularisation technique for deep learning during the recent years.", "startOffset": 27, "endOffset": 31}, {"referenceID": 26, "context": "We evaluate our models based on iPinYou dataset [27], a public realworld display ad dataset with each ad display information and corresponding user click feedback.", "startOffset": 48, "endOffset": 52}, {"referenceID": 31, "context": "LR: Logistic Regression [32] is a linear model with simple implementation and fast training speed, which is widely used in online advertising estimation.", "startOffset": 24, "endOffset": 28}, {"referenceID": 30, "context": "FM: Factorisation Machine [31] is a non-linear model able to estimate feature interactions even in problems with huge sparsity.", "startOffset": 26, "endOffset": 30}, {"referenceID": 11, "context": "The AUC [12] metric is a widely used measure for evaluating the CTR performance.", "startOffset": 8, "endOffset": 12}, {"referenceID": 29, "context": "Regarding selecting the number of training epochs, we use early stopping [30], i.", "startOffset": 73, "endOffset": 77}, {"referenceID": 23, "context": "Instead of trying all combinations of hidden units, in our experiment we use another strategy by starting tuning the different hidden layer sizes with the same number of hidden units in all three hidden layers since the architecture with equal-size hidden layers is empirically better than the architecture with increasing width or decreasing width in [24].", "startOffset": 352, "endOffset": 356}, {"referenceID": 34, "context": "(11)) and dropout [35] for preventing complex co-adaptations on the training data.", "startOffset": 18, "endOffset": 22}, {"referenceID": 33, "context": "5 Some advanced Bayesian methods for hyperparameter tuning [34] are not considered in this paper and may be investigated in the future work.", "startOffset": 59, "endOffset": 63}, {"referenceID": 4, "context": ", each training case can be regarded as a new model and these models are averaged as a special case of bagging [5], which effectively improves the generalisation ability of DNN models.", "startOffset": 111, "endOffset": 114}, {"referenceID": 35, "context": "For example, the model performance can be improved by momentum methods in that it suffices for handling the curvature problems in DNN training objectives without using complex second-order methods [36].", "startOffset": 197, "endOffset": 201}, {"referenceID": 8, "context": "In addition, the partial connection in the bottom layer could be extended to higher hidden layers as partial connectivities have many advantages such as lower complexity, higher generalisation ability and more similar to human brain [9].", "startOffset": 233, "endOffset": 236}], "year": 2016, "abstractText": "Predicting user responses, such as click-through rate and conversion rate, are critical in many web applications including web search, personalised recommendation, and online advertising. Different from continuous raw features that we usually found in the image and audio domains, the input features in web space are always of multi-field and are mostly discrete and categorical while their dependencies are little known. Major user response prediction models have to either limit themselves to linear models or require manually building up high-order combination features. The former loses the ability of exploring feature interactions, while the latter results in a heavy computation in the large feature space. To tackle the issue, we propose two novel models using deep neural networks (DNNs) to automatically learn effective patterns from categorical feature interactions and make predictions of users\u2019 ad clicks. To get our DNNs efficiently work, we propose to leverage three feature transformation methods, i.e., factorisation machines (FMs), restricted Boltzmann machines (RBMs) and denoising auto-encoders (DAEs). This paper presents the structure of our models and their efficient training algorithms. The large-scale experiments with real-world data demonstrate that our methods work better than major state-of-the-art models.", "creator": "LaTeX with hyperref package"}}}