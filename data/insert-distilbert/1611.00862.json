{"id": "1611.00862", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "3-Nov-2016", "title": "Quantile Reinforcement Learning", "abstract": "in reinforcement learned learning, since the standard criterion to evaluate policies in a state is the expectation of ( discounted ) sum of rewards. however, this criterion may not since always be suitable, we consider seeking an alternative criterion based indirectly on the notion of gibbs quantiles. additionally in the case of episodic reinforcement learning problems, traditionally we propose an algorithm based on stochastic approximation with two timescales. we evaluate our proposition on a simple model of the tv travel show, who wants to be a millionaire.", "histories": [["v1", "Thu, 3 Nov 2016 02:28:53 GMT  (252kb,D)", "http://arxiv.org/abs/1611.00862v1", "AWRL 2016"]], "COMMENTS": "AWRL 2016", "reviews": [], "SUBJECTS": "cs.LG cs.AI", "authors": ["hugo gilbert", "paul weng"], "accepted": false, "id": "1611.00862"}, "pdf": {"name": "1611.00862.pdf", "metadata": {"source": "CRF", "title": "Quantile Reinforcement Learning", "authors": ["Hugo Gilbert", "Paul Weng", "Gilbert Weng"], "emails": ["hugo.gilbert@lip6.fr", "paweng@cmu.edu"], "sections": [{"heading": null, "text": "Keywords: Reinforcement learning, Quantile, Ordinal Decision Model, Two-Timescale Stochastic Approximation"}, {"heading": "1. Introduction", "text": "Markov decision process and reinforcement learning are powerful frameworks for building autonomous agents (physical or virtual), which are systems that make decisions without human supervision in order to perform a given task. Examples of such systems abound: expert backgammon player (Tesauro, 1995), dialogue systems (Zhang et al., 2001), acrobatic helicopter flight (Abbeel et al., 2010) or human-level video game player (Mnih et al., 2015). However, the standard framework assumes that rewards are numeric, scalar and additive and that policies are evaluated with the expectation criterion. In practice, it may happen that such numerical rewards are not available, for instance, when the agent interacts with a human who generally gives ordinal feedback (e.g., \u201cexcellent\u201d, \u201cgood\u201d, \u201cbad\u201d and so on). Besides, even when this numerical information is available, one may want to optimize a criterion different than the expectation, for instance in one-shot decision-making.\nSeveral works considered the case where preferences are qualitative. Markov decision processes with ordinal reward have been investigated (Weng, 2012, 2011) and different ordinal decision criteria have been proposed in that context. More generally, preferencebased reinforcement learning (Akrour et al., 2012; Fu\u0308rnkranz et al., 2012; Busa-Fekete et al., 2013, 2014) has been proposed to tackle situations where the only available preferential information concerns pairwise comparisons of histories.\nc\u00a9 2016 H. Gilbert & P. Weng.\nar X\niv :1\n61 1.\n00 86\n2v 1\n[ cs\n.L G\n] 3\nIn this paper, we propose to search for a policy that optimizes a quantile instead of the expectation. Intuitively, the \u03c4 -quantile of a distribution is the value q such that the probability of getting a value lower than q is \u03c4 (and therefore the probability of getting a value greater than q is 1 \u2212 \u03c4). The median is an example of quantile where \u03c4 = 0.5. Interestingly, in order to use this criterion only an order over valuations is needed.\nThe quantile criterion is extensively used as a decision criterion in many domains. In finance, it is a risk measure and is known as Value-at-Risk (Jorion, 2006). For its cloud computing services, Amazon reports (DeCandia et al., 2007) that they optimize the 99.9%- quantile1. In fact, decisions in the web industry are often made based on quantiles (Wolski and Brevik, 2014; DeCandia et al., 2007). More generally, in the service industry, because of skewed distributions (Benoit and Van den Poel, 2009), one generally does not want that customers are satisfied on average, but rather that most customers (e.g., 99% of them) to be as satisfied as possible.\nThe use of the quantile criterion can be explained by the nice properties it enjoys:\n\u2022 preferences and uncertainty can be valued on scales that are not commensurable,\n\u2022 preferences over actions or trajectories can be expressed on a purely ordinal scale,\n\u2022 preferences over policies are more robust than with the standard criterion of maximizing the expectation of cumulated rewards.\nThe contributions of this paper are as follows. To the best of our knowledge, we are the first to propose an RL algorithm to learn a policy optimal for the quantile criterion. This algorithm is based on stochastic approximation with two timescales. We present an empirical evaluation of our proposition on a version of Who wants to be a millionaire.\nThe paper is organized as follows. Section 2 presents the related work. Section 3 recalls the necessary background for presenting our approach. Section 4 states the problem we solve and introduce our algorithm, Quantile Q-learning. Section 5 presents some experimental results. Finally, we conclude in Section 6."}, {"heading": "2. Related Work", "text": "A great deal of research on MDPs (Boussard et al., 2010) considered decision criteria different to the standard ones (i.e., expected discounted sum of rewards, expected total rewards or expected average rewards). For instance, in the operations research community, White (1987) notably considered different cases where preferences over policies only depend on sums of rewards: Expected Utility (EU), probabilistic constraints and mean-variance formulations. In this context, he showed the sufficiency of working in a state space augmented with the sum of rewards obtained so far. Filar et al. (1989) investigated decision criteria that are variance-penalized versions of the standard ones. They formulated the obtained optimization problem as a non-linear program. Yu et al. (1998) optimized the probability that the total reward becomes higher than a certain threshold.\nAdditionally, in the artificial intelligence community, Liu and Koenig (2005, 2006) also investigated the use of EU as a decision criterion in MDPs. To optimize it, they proposed a\n1. Or 0.01%-quantile, depending on whether the problem is expressed in terms of costs or rewards.\nfunctional variation of Value Iteration. In the continuation of this work, Gilbert et al. (2015) investigated the use of Skew-Symmetric Bilinear (SSB) utility (Fishburn, 1981) functions \u2014 a generalization of EU that enables intransitive behaviors and violation of the independence axiom \u2014 as decision criteria in finite-horizon MDPs. Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; Fu\u0308rnkranz et al., 2012; Busa-Fekete et al., 2013, 2014).\nIn theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruye\u0300re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value. This work has also been extended to the multiobjective setting (Randour et al., 2014).\nRecent work in Markov decision process and reinforcement learning considered conditional Value-at-risk (CVaR), a criterion related to quantile, as a risk measure. Ba\u0308uerle and Ott (2011) proved the existence of deterministic wealth-Markovian policies optimal with respect to CVaR. Chow and Ghavamzadeh (2014) proposed gradient-based algorithms for CVaR optimization. In contrast, Borkar and Jain (2014) used CVaR in constraints instead of as objective function.\nCloser to our work, several quantile-based decision models have been investigated in different contexts. In uncertain MDPs where the parameters of the transition and reward functions are imprecisely known, Delage and Mannor (2007) presented and investigated a quantile-like criterion to capture the trade-off between optimistic and pessimistic viewpoints on an uncertain MDP. The quantile criterion they use is different to ours as it takes into account the uncertainty present in the parameters of the MDP.\nIn MDPs with ordinal rewards (Weng, 2011, 2012; Filar, 1983), quantile-based decision models were proposed to compute policies that maximize a quantile using linear programming. While quantiles in those works are defined on distributions over ordinal rewards, quantiles in this paper are defined on distributions over histories.\nMore recently, in the machine learning community, quantile-based criteria have been proposed in the multi-armed bandit (MAB) setting, a special case of reinforcement learning. Yu and Nikolova (2013) proposed an algorithm in the pure exploration setting for different risk measures, including Value-at-Risk. Carpentier and Valko (2014) studied the problem of identifying arms with extreme payoffs, a particular case of quantiles. Finally, Szo\u0308re\u0301nyi et al. (2015) investigated MAB problems where a quantile is optimized instead of the mean.\nThe algorithm we propose is based on stochastic approximation with two timescales, a technique proposed by Borkar (1997, 2008). This method has recently been exploited in achievability problems (Blackwell, 1956) in the context of multiobjective MDPs (Kalathil et al., 2014) and for learning SSB-optimal policies (Gilbert et al., 2016)."}, {"heading": "3. Background", "text": "We provide in this section the background information necessary to present our algorithm to learn a policy optimal for the quantile criterion."}, {"heading": "3.1. Markov Decision Process", "text": "Markov Decision Processes (MDPs) offer a powerful formalism to model and solve sequential decision-making problems (Puterman, 1994). A finite horizon MDP is formally defined as a tuple MT = (S,A,P,R, s0) where:\n\u2022 T is a finite horizon,\n\u2022 S is a finite set of states,\n\u2022 A is a finite set of actions,\n\u2022 P : S \u00d7 A \u00d7 S \u2192 R is a transition function with P(s, a, s\u2032) being the probability of reaching state s\u2032 when action a is performed in state s,\n\u2022 R : S \u00d7A\u2192 R is a bounded reward function and\n\u2022 s0 \u2208 S is an initial state.\nIn this model, starting from initial state s0, an agent chooses at every time step t an action at to perform in her current state st, which she can observe. This action results in a new state st+1 \u2208 S according to probability distribution P(st, at, .), and a reward signal R(st, at), which penalizes or reinforces the choice of this action.\nWe will call t-history ht a succession of t state-action pairs starting from state s0 (e.g., ht = (s0, a1, s1, . . . , st\u22121, at\u22121, st)). The action choices of the agent is guided by a policy. More formally, a policy \u03c0 at an horizon T is a sequence of T decision rules (\u03b4T , . . . , \u03b41). Decision rules prescribe which action the agent should perform at a given time step. They can be Markovian if they only depend on the current state. Besides, a decision rule is either deterministic if it always selects the same action in a given situation or randomized if it prescribes a probability distribution over possible actions. Consequently, a policy can be Markovian, deterministic or randomized according to the type of its decision rules. Lastly, a policy is stationary if it applies the same decision rule at every time step, i.e., \u03c0 = (\u03b4, \u03b4, . . .).\nPolicies can be compared with respect to different decision criteria. The usual criterion is the expected (discounted) sum of rewards, for which an optimal deterministic Markovian policy is known to exist for any horizon T . This criterion is defined as follows. First, the value of a history ht = (s0, a1, s1, . . . , st\u22121, at, st) is described as the (possibly discounted) sum of rewards obtained along it, i.e.,\nr(ht) = t\u2211 i=1 \u03b3i\u22121R(si\u22121, ai)\nwhere \u03b3 \u2208 [0, 1] is a discount factor. Then, the value of a policy \u03c0 = (\u03b4T , . . . , \u03b41) in a state s is set to be the expected value of the histories that can be generated by \u03c0 from s. This value, given by the value function v\u03c0T : S \u2192 R can be computed iteratively as follows:\nv\u03c00 (s) = 0 v\u03c0t (s) = R(s, \u03b4t(s)) + \u03b3 \u2211 s\u2032\u2208S P(s, \u03b4t(s), s \u2032)v\u03c0t\u22121(s \u2032) (1)\nThe value v\u03c0t (s) is the expectation of cumulated rewards obtained by the agent if she performs action \u03b4t(s) in state s at time-step t and continues to follow policy \u03c0 thereafter. The higher the values of v\u03c0t (s) are, the better. Therefore, value functions induce a preference relation %\u03c0 over policies in the following way:\n\u03c0 %\u03c0 \u03c0 \u2032 \u21d4 \u2200s \u2208 S, v\u03c0T (s) \u2265 v\u03c0 \u2032 T (s)\nA solution to an MDP is a policy, called optimal policy, that ranks the highest with respect to %\u03c0. Such a policy can be found by solving the following equations, which yields the value function of an optimal policy:\nv\u22170(s) = 0 v\u2217t (s) = max a\u2208A R(s, a) + \u03b3 \u2211 s\u2032\u2208S P(s, a, s\u2032)v\u2217t\u22121(s \u2032)"}, {"heading": "3.2. Reinforcement Learning", "text": "In the reinforcement learning (RL) setting, the assumption of the knowledge of the environment is relaxed: both dynamics through the transition function and preferences via the reward function are not known anymore. While interacting with its environment, an RL agent tries to learn a good policy by trial and error.\nTo make finite horizon MDPs learnable, we assume the decision process is repeated infinitely many times. That is, when horizon T is reached, we assume that the agent automatically returns to the initial state and the problem starts over.\nA simple algorithm to solve such an RL problem is the Q-learning algorithm (see Algorithm 1), which estimates the Q-function:\nQt(s, a) = R(s, a) + \u03b3 \u2211 s\u2032\u2208S P(s, a, s\u2032)Vt\u22121(s \u2032)\nAnd obviously, we have: Vt(s) = max a\u2208A Qt(s, a).\nIn Algorithm 1, Line 1 generally depends on the Qt\u22121(s, \u00b7) and possibly on iteration n. A simple strategy to perform this choice is called \u03b5-greedy where the best action dictated by Qt\u22121(s, \u00b7) is chosen with probability 1 \u2212 \u03b5 (with \u03b5 a small positive value) or a random action is chosen otherwise. A schedule can be defined so that parameter \u03b5 tends to zero as n tends to infinity. Besides, \u03b1n(s, a) \u2208 (0, 1) on Line 2 is a learning rate. In the general case, it depends on iteration n, state s and action a, although in practice it is often chosen as a constant."}, {"heading": "3.3. Limits of standard criteria", "text": "The standard decision criteria used in MDPs, which are based on expectation, may not be reasonable in some situations. Firstly, unfortunately, in many cases, the reward function R is not known. In those cases, one can try to recover the reward function from a human expert (Ng and Russell, 2000; Regan and Boutilier, 2009; Weng and Zanuttini, 2013). However, even for an expert user, the elicitation of the reward function can reveal burdensome. In inverse reinforcement learning (Ng and Russell, 2000), the expert is assumed to know an\nData: MT = (S,A,G,P,R, s0) MDP Result: Q begin\nQ0(s, a)\u2190\u2212 0,\u2200(s, a) \u2208 S \u00d7A s\u2190\u2212 s0 t\u2190\u2212 1 for n = 1 to N do\n1 a\u2190\u2212 choose action r, s\u2032 \u2190\u2212 perform action a in state s\n2 Qt(s, a)\u2190\u2212 Qt(s, a) + \u03b1n(s, a) ( r + \u03b3maxa\u2032\u2208AQt\u22121(s \u2032, a\u2032)\u2212Qt(s, a) ) 3 if t = T then s\u2190\u2212 s0 t\u2190\u2212 1\nelse s\u2190\u2212 s\u2032 t\u2190\u2212 t+ 1 end\nend\nend Algorithm 1: Q-learning\noptimal policy, which is rarely true in practice. In interactive settings (Regan and Boutilier, 2009; Weng and Zanuttini, 2013), this elicitation process can be cognitively very complex as it requires to balance several criteria in a complex manner and as it can imply a large number of parameters. In this paper, we address this problem by only assuming that a strict weak ordering over histories is known.\nSecondly, for numerous applications, the expectation of cumulated reward, as used in Equation 1, may not be the most appropriate criterion (even when a numeric reward function is defined). For instance, in case of high variance or when a policy is known to be only applied a few times, the solution given by this criterion may not be satisfying for risk-averse agent. Moreover, in some domains (e.g., web industry or more generally service industry), decisions about performance are often based on the minimal quality of 99% of the possible outcomes. Therefore, in this article we aim at using a quantile (defined in Section 3.5) as a decision criterion to solve an MDP."}, {"heading": "3.4. MDP with End States", "text": "In this paper, we work with episodic MDPs with end states. Such an MDP is formally defined as a tupleMT = (S,A,G,P, s0) where S, A, P, s0 are defined as previously, G \u2286 S is a finite set of end states and T is a finite maximal horizon (i.e., an end state is attained after at most T time steps.). We call episode a history starting from s0 and ending in a final state of G.\nWe assume that a preference relation is defined over end states: We write g\u2032 \u227a g if end state g is preferred to end state g\u2032. Without loss of generality, we assume that G = {g1, . . . , gn} and end states are ordered with increasing preference, i.e., g1 \u227a g2 \u227a . . . \u227a gn. The weak relation of \u227a is denoted .\nNote that a finite horizon MDP can be reformulated as an MDP with end states by state augmentation. Although the resulting MDP may have a large-sized state space, the two models are formally equivalent. We focus on episodic MDPs with end states to simplify the presentation of our approach."}, {"heading": "3.5. Quantile Criterion", "text": "We define quantiles of distributions over end states of G, which are ordered by . Let \u03c4 \u2208 [0, 1] be a fixed parameter. Intuitively, the \u03c4 -quantile of a distribution of end states, is the value q \u2208 G such that the probability of getting an end state equal or lower than q is \u03c4 and that of getting an end state equal or greater than q is 1 \u2212 \u03c4 . The 0.5-quantile, also known as median, can be seen as the ordinal counterpart of the mean. The 0-quantile (resp. 1-quantile) is the minimum (resp. maximum) of a distribution. More generally, quantiles, which have been axiomatically characterized by Rostek (2010), define decision criteria that have the nice property of not requiring numeric valuations, but only an order.\nThe formal definition of quantiles can be stated as follows. Let p\u03c0 denote the probability distribution over end states induced by a policy \u03c0 from initial state s0, the cumulative distribution induced by p\u03c0 is then defined as F \u03c0 where F \u03c0(g) = \u2211 g\u2032 g p\n\u03c0(g\u2032) is the probability of getting an end state not preferred to g when applying policy \u03c0. Similarly, the decumulative distribution induced by p\u03c0 is defined as G\u03c0(g) = \u2211 g g\u2032 p\n\u03c0(g\u2032) is the probability of getting an end state not lower than g.\nThese two notions of cumulative and decumulative enable us to define two kinds of criteria. First, given a policy \u03c0, we define the lower \u03c4 -quantile for \u03c4 \u2208 (0, 1] as:\nq\u03c0 \u03c4 = min{g \u2208 G |F \u03c0(g) \u2265 \u03c4} (2)\nwhere the min operator is with respect to . Then, given a policy \u03c0, we define the upper \u03c4 -quantile for \u03c4 \u2208 [0, 1) as:\nq\u03c0\u03c4 = max{g \u2208 G |G\u03c0(g) \u2265 1\u2212 \u03c4} (3)\nwhere the max operator is with respect to . If \u03c4 = 0 or \u03c4 = 1 only one of q\u03c0\n\u03c4 or q\u03c0\u03c4 is defined and we define the \u03c4 -quantile q \u03c0 \u03c4 as that\nvalue. When both are defined, by construction, we have q\u03c0 \u03c4 q\u03c0\u03c4 . If those two values are equal, q\u03c0\u03c4 is defined as equal to them. For instance, this is always the case in continuous settings for continuous distributions. However, in our discrete setting, it could happen that those values differ, as shown by Example 1.\nExample 1 Consider an MDP where G = {g1 \u227a g2 \u227a g3}. Let \u03c0 be a policy that attains each end state with probabilities 0.5, 0.2 and 0.3 respectively. It is easy to check that q\u03c0\n0.5 = g1\nwhereas q\u03c00.5 = g2.\nWhen the lower and the upper quantiles differ, one may define the quantile as a function of the lower and upper quantiles (Weng, 2012). For simplicity, in this paper, we focus on optimizing directly the lower and the upper quantiles.\nThe quantile criterion is difficult to optimize, even when a numerical reward function is given and the quality of an episode is defined as the cumulative of rewards received along the episode. This difficulty comes notably from two related sources:\n\u2022 The quantile criterion is non-linear: for instance, the \u03c4 -quantile q\u03c0\u0303\u03c4 of the mixed policy \u03c0\u0303 that generates an episode using policy \u03c0 with probability p and \u03c0\u2032 with probability 1\u2212 p is not equal to pq\u03c0\u03c4 + (1\u2212 p)q\u03c0 \u2032 \u03c4 .\n\u2022 The quantile criterion is non-dynamically consistent: A sub-policy at time step t of an optimal policy for horizon T may not be optimal for horizon T \u2212 t.\nIn decision theory (McClennen, 1990), three approaches have been considered for such kinds of decision criteria:\n1. Consequentialist approach: at each time step t, follow an optimal policy for the problem with horizon T \u2212 t and initial state st even if the resulting policy is not optimal at horizon T ;\n2. Resolute choice approach: at time step t = 0, apply an optimal policy for the problem with horizon T and initial state s0 and do not deviate from it;\n3. Sophisticated resolute choice approach (Jaffray, 1998; Fargier et al., 2011): apply a policy \u03c0 (chosen at the beginning) that trades off between how much \u03c0 is optimal for all horizons T, T \u2212 1, . . . , 1.\nWith non-dynamically consistent preferences, it is debatable to adopt a consequentialist approach, as the sequence of decisions may lead to dominated results. In this paper, we adopt a resolute choice point of view. We leave the third approach for future work."}, {"heading": "4. Quantile-based Reinforcement Learning", "text": "In this section, we first state the problem solved in this paper and some useful properties. Then, we present our algorithm called Quantile Q-learning (or QQ-learning for short), which is an extension of Q-learning and exploits a two-timescale stochastic approximation technique."}, {"heading": "4.1. Problem Statement", "text": "In this paper, we aim at learning a policy that is optimal for the quantile criterion from a fixed initial state. We assume that the underlying MDP is an episodic MDP with end states. Let \u03c4 \u2208 (0, 1) be a fixed parameter. Formally, the problem of determining a policy optimal for the lower/upper \u03c4 -quantile can be stated as follows:\n\u03c0\u2217 = arg max \u03c0 q\u03c0 \u03c4\nor \u03c0\u2217 = arg max \u03c0 q\u03c0\u03c4 (4)\nWe focus on learning a policy that is deterministic and Markovian. The optimal lower/upper quantiles satisfy the following lemmas:\nLemma 1 The optimal lower \u03c4 -quantile q\u2217 \u03c4 satisfies:\nq\u2217 \u03c4 = min{g : F \u2217(g) \u2265 \u03c4} (5) F \u2217(g) = min\n\u03c0 F \u03c0(g) \u2200g \u2208 G (6)\nand the optimal upper \u03c4 -quantile q\u2217\u03c4 satisfies:\nq\u2217\u03c4 = max{g : G\u2217(g) \u2265 1\u2212 \u03c4} (7) G\u2217(g) = max\n\u03c0 G\u03c0(g) \u2200g \u2208 G (8)\nThen, if the optimal lower quantile (q\u2217 \u03c4 ) or upper quantile (q\u2217\u03c4 ) were known, the problem would be relatively easy to solve. By Lemma 1, an optimal policy for the lower quantile could be obtained as follows:\n\u03c0\u2217 = arg min \u03c0 F \u03c0(q\u2212 \u03c4 ) (9)\nwhere q\u2212 \u03c4 = g1 if q \u2217 \u03c4 = g1 and q \u2212 \u03c4 = gi if q \u2217 \u03c4 = gi+1. The reason one needs to use q \u2212 \u03c4 instead of the optimal lower quantile is that otherwise it may happen that the cumulative distribution of a non-optimal policy \u03c0 is smaller than or equal to that of an optimal policy at the lower quantile q\u2217\n\u03c4 (but greater below q\u2217 \u03c4 as \u03c0 is not optimal). In that case, the lower\nquantile of \u03c0 might not be q\u2217 \u03c4 . Such a thing cannot happen for the upper quantile. In that sense, determining an optimal policy for the upper quantile is easier. By Lemma 1, it is simply given by:\n\u03c0\u2217 = arg max \u03c0 G\u03c0(q\u2217\u03c4 ) (10)\nIn practice, if the lower/upper quantiles were known, those policies could be computed by solving a standard MDP with the following reward functions:\nR\u03b8(s) =  0 \u2200s 6\u2208 G 0 \u2200s = gi \u2208 G, \u03b8 \u2265 i 1 \u2200s = gi \u2208 G, \u03b8 \u2264 i\u2212 1\nfor the lower quantile with \u03b8 = k if q\u2212 \u03c4 = gk and\nR\u03b8(s) =  0 \u2200s 6\u2208 G 1 \u2200s = gi \u2208 G, \u03b8 \u2264 i 0 \u2200s = gi \u2208 G, \u03b8 \u2265 i+ 1\nfor the upper quantile with \u03b8 = k if q\u2217\u03c4 = gk. Note that R\u03b8 can be rewritten to depend on the optimal lower quantile:\nR\u03b8(s) =  0 \u2200s 6\u2208 G 0 \u2200s = gi \u2208 G, \u03b8 \u2265 i+ 1 1 \u2200s = gi \u2208 G, \u03b8 \u2264 i\nwith \u03b8 = k if q\u2217 \u03c4\n= gk. Solving an MDP with R\u03b8 amounts to minimizing the probability of ending in a final state strictly less preferred than q\u2217 \u03c4 , which solves Equation 9. Similarly, solving an MDP with R\u03b8 amounts to maximizing the probability of ending in a final state at least as preferred as q\u2217\u03c4 , which solves Equation 10.\nNow, the issue here is that the lower and upper quantiles are not known. We show in the next subsection that this problem can be overcome with a two-timescale stochastic approximation technique.\nData: MT = (S,A,G,P, s0) begin\nInitialize \u03b8 to a random value for n = 1, 2, . . . do\n4 Solve MDP MT with reward function R\u03b8 if V \u2217\u03b8 (s0) < 1\u2212 \u03c4 then\n\u03b8 \u2190\u2212 \u03b8 \u2212 1/n else\n\u03b8 \u2190\u2212 \u03b8 + 1/n end\nend\nend Algorithm 2: Simple strategy for finding the optimal upper quantile"}, {"heading": "4.2. QQ-learning", "text": "As the lower and upper quantiles are not known, we let parameter \u03b8 vary in R+ during the learning steps and we refine the definition of the previous reward functions to make sure they are both well-defined for all \u03b8 \u2208 R+ and smooth in \u03b8:\nR\u03b8(s) =  0 \u2200s 6\u2208 G \u22121 \u2200s = gi \u2208 G, \u03b8 \u2265 i+ 1 0 \u2200s = gi \u2208 G, \u03b8 \u2264 i i\u2212 \u03b8 else\nR\u03b8(s) =  0 \u2200s 6\u2208 G 1 \u2200s = gi \u2208 G, \u03b8 \u2264 i 0 \u2200s = gi \u2208 G, \u03b8 \u2265 i+ 1 i+ 1\u2212 \u03b8 else\nIn the remaining of the paper, we present how to solve for the upper quantile. A similar approach can be developed for the lower quantile. In order to find the optimal upper quantile, one could use the strategy described in Algorithm 2. Value V \u2217\u03b8 (s0) approximates the probability of reaching an end state whose index is at least as high as \u03b8. If that value is smaller than 1 \u2212 \u03c4 , it means \u03b8 is too high and should be decreased. Otherwise \u03b8 is too small and should be increased. Parameter \u03b8 will then converge to the index of the optimal upper quantile, which is the maximal value for \u03b8 such that V \u2217\u03b8 (s0) \u2265 1 \u2212 \u03c4 . The optimal policy for V \u2217\u03b8 is an optimal policy for the upper \u03c4 -quantile.\nIn a reinforcement learning setting, the solve MDP part (line 4 in Algorithm 2) could be replaced by an RL algorithm such as Q-learning. The problem is that such algorithm is only guaranteed to converge to the solution when n\u2192\u221e. It would be therefore difficult to integrate Q-learning in Algorithm 2. Instead, a good policy can be learned while searching for the correct value of \u03b8. To that aim, we use a two-timescale technique (Borkar, 1997, 2008) in which Q-learning and the update of parameter \u03b8 are run concurrently but at different speeds (i.e., at two different timescales). For this to work, parameter \u03b8 needs to be seen as\nData: MT = (S,A,G,P, s0) with P unknown Result: Q begin\nQ(s, a)\u2190\u2212 0,\u2200(s, a) \u2208 S \u00d7A s\u2190\u2212 s0 t\u2190\u2212 1 for n = 1 to N do\na\u2190\u2212 choose action r, s\u2032 \u2190\u2212 perform action a in state s Qt(s, a)\u2190\u2212 Qt(s, a) + \u03b1n(s, a) ( r + \u03b3maxa\u2032\u2208AQt\u22121(s \u2032, a\u2032)\u2212Qt(s, a) ) if V \u2217\u03b8 (s0) < 1\u2212 \u03c4 then \u03b8 \u2190\u2212 \u03b8 \u2212 1/n else \u03b8 \u2190\u2212 \u03b8 + 1/n end if s\u2032 \u2208 G then\ns\u2190\u2212 s0 t\u2190\u2212 1\nelse s\u2190\u2212 s\u2032 t\u2190\u2212 t+ 1 end\nend\nend Algorithm 3: QQ-learning for the upper-quantile\nquasi-static for the Q-learning algorithm. This is possible if the ratio of the learning rate of Q-learning and that of the update of \u03b8 satisfies:\nlim n\u2192\u221e \u03b2n \u03b1n = 0 (11)\nwhere \u03b2n = 1/n is the learning rate for parameter \u03b8 and \u03b1n is the learning rate in the Qlearning algorithm. Equation 11 implies that parameter \u03b8 is changing at a slower timescale than the Q function."}, {"heading": "5. Experimental Results", "text": "To demonstrate the soundness of our approach, we evaluate our algorithm on the domain, Who wants to be a millionaire. We present the experimental results below."}, {"heading": "5.1. Domain", "text": "In this popular television game show, a contestant needs to answer a maximum of 15 multiple-choice questions (with four possible answers) of increasing difficulty, for increasingly large sums, roughly doubling the pot at each question. At each time step, the contestant may decide to walk away with the money currently won. If she answers incorrectly, then all winnings are lost except what has been earned at a \u201cguarantee point\u201d (questions\n5 and 10). The player is allowed 3 lifelines (50:50, which removes two choices, ask the audience and call a friend for suggestions); each can only be used once. We used the first model of the Spanish 2003 version of the game presented by Perea and Puerto (2007). The probability of answering correctly is a function of the question\u2019s number and increased by the lifelines used (if any)."}, {"heading": "5.2. Results", "text": "We plot the results (see Figure 1) obtained for two different learning runs, one with 1 million learning steps and the other with 10 million learning steps. The \u03b8-updates were interleaved with a Q-learning phase using an \u03b5-greedy exploration strategy with \u03b5 = 0.01 and with learning rate \u03b1(n) = 1/(n + 1)11/20. One can check that Equation 11 is satisfied. We optimize the upper quantile with \u03c4 = 0.3. During the learning process we maintain a vector f of frequencies with which each final state has been attained. We define the quantity score as the cross product between f and the vector of rewards obtained when attaining each final state given the current value of \u03b8. Put another way, score is the value of the non-stationary policy that has been played since the beginning of the learning process. Moreover, at each iteration we compute V \u2217\u03b8 (s0), the optimal value in s0 given the current value of \u03b8.\nOn Figures 1(a) and 1(b) we observe the evolution of V \u2217\u03b8 (s0) as the number of iterations increases. We observe that V \u2217\u03b8 (s0) converges towards 1\u2212\u03c4 = 0.7 as the number of iterations increases with oscillations of decreasing amplitude that are due to the ever changing \u03b8 value. Figures 1(c) and 1(d) show the evolution of the score as the number of iterations increases. Score converges towards a value of 0.7 but inferior. This is due to the exploration of the Q-learning algorithm. Lastly, 1(e) and 1(f ) plot the evolution of \u03b8 as the number of iteration increases. The value of \u03b8 converges towards a value of 4 which the one for which V \u2217\u03b8 (s0) = 1\u2212 \u03c4 = 0.7."}, {"heading": "6. Conclusion", "text": "We have presented an algorithm for learning a policy optimal for the quantile criterion in the reinforcement learning setting, when the MDP has a special structure, which corresponds to repeated episodic decision-making problems. It is based on stochastic approximation with two timescales (Borkar, 2008). Our proposition is experimentally validated on the domain, Who wants to be millionaire.\nAs future work, it would be interesting to investigate how to choose the learning rate \u03b1n in order to ensure a fast convergence. Moreover, our approach could be extended to other settings than episodic MDPs. Besides, it would also be interesting to explore whether gradient-based algorithms could be developed for the optimization of quantiles, based on the fact that a quantile is solution of an optimization problem where the objective function is piecewise linear (Koenker, 2005)."}], "references": [{"title": "Autonomous helicopter aerobatics through apprenticeship learning", "author": ["Pieter Abbeel", "Adam Coates", "Andrew Y. Ng"], "venue": "International Journal of Robotics Research,", "citeRegEx": "Abbeel et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Abbeel et al\\.", "year": 2010}, {"title": "S\u00e9bag. April: Active preference-learning based reinforcement learning", "author": ["R. Akrour", "M. Schoenauer"], "venue": "In ECML PKDD, Lecture Notes in Computer Science,", "citeRegEx": "Akrour et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Akrour et al\\.", "year": 2012}, {"title": "Markov decision processes with average value-at-risk criteria", "author": ["Nicole B\u00e4uerle", "Jonathan Ott"], "venue": "Mathematical Methods of Operations Research,", "citeRegEx": "B\u00e4uerle and Ott.,? \\Q2011\\E", "shortCiteRegEx": "B\u00e4uerle and Ott.", "year": 2011}, {"title": "Benefits of quantile regression for the analysis of customer lifetime value in a contractual setting: An application in financial services", "author": ["D.F. Benoit", "D. Van den Poel"], "venue": "Expert Systems with Applications,", "citeRegEx": "Benoit and Poel.,? \\Q2009\\E", "shortCiteRegEx": "Benoit and Poel.", "year": 2009}, {"title": "An analog of the minimax theorem for vector payoffs", "author": ["D. Blackwell"], "venue": "Pacific Journal of Mathematics,", "citeRegEx": "Blackwell.,? \\Q1956\\E", "shortCiteRegEx": "Blackwell.", "year": 1956}, {"title": "Risk-constrained Markov decision processes", "author": ["V. Borkar", "Rahul Jain"], "venue": "IEEE Transactions on Automatic Control,", "citeRegEx": "Borkar and Jain.,? \\Q2014\\E", "shortCiteRegEx": "Borkar and Jain.", "year": 2014}, {"title": "Stochastic approximation : a dynamical systems viewpoint. Cambridge university press New Delhi, Cambridge, 2008. ISBN 978-0-521-51592-4", "author": ["Vivek S. Borkar"], "venue": "URL http://opac.inria.fr/ record=b1132816", "citeRegEx": "Borkar.,? \\Q2008\\E", "shortCiteRegEx": "Borkar.", "year": 2008}, {"title": "Stochastic approximation with time scales", "author": ["V.S. Borkar"], "venue": "Systems & Control Letters,", "citeRegEx": "Borkar.,? \\Q1997\\E", "shortCiteRegEx": "Borkar.", "year": 1997}, {"title": "Markov Decision Processes in Artificial Intelligence, chapter Non-Standard Criteria", "author": ["M. Boussard", "M. Bouzid", "A.I. Mouaddib", "R. Sabbadin", "P. Weng"], "venue": null, "citeRegEx": "Boussard et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Boussard et al\\.", "year": 2010}, {"title": "Meet your expectations with guarantees: beyond worst-case synthesis in quantitative games", "author": ["V\u00e9ronique Bruy\u00e8re", "Emmanuel Filiot", "Mickael Randour", "Jean-Fran\u00e7ois Raskin"], "venue": "In STACS,", "citeRegEx": "Bruy\u00e8re et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Bruy\u00e8re et al\\.", "year": 2014}, {"title": "Preference-based reinforcement learning", "author": ["R. Busa-Fekete", "B. Sz\u00f6renyi", "P. Weng", "W. Cheng", "E. H\u00fcllermeier"], "venue": "In European Workshop on Reinforcement Learning, Dagstuhl Seminar,", "citeRegEx": "Busa.Fekete et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Busa.Fekete et al\\.", "year": 2013}, {"title": "Preferencebased Reinforcement Learning: Evolutionary Direct Policy Search using a Preference-based Racing Algorithm", "author": ["Robert Busa-Fekete", "Balazs Szorenyi", "Paul Weng", "Weiwei Cheng", "Eyke H\u00fcllermeier"], "venue": "Machine Learning,", "citeRegEx": "Busa.Fekete et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Busa.Fekete et al\\.", "year": 2014}, {"title": "Algorithms for cvar optimization in MDPs", "author": ["Yinlam Chow", "Mohammad Ghavamzadeh"], "venue": "In NIPS,", "citeRegEx": "Chow and Ghavamzadeh.,? \\Q2014\\E", "shortCiteRegEx": "Chow and Ghavamzadeh.", "year": 2014}, {"title": "Dynamo: amazon\u2019s highly available key-value store", "author": ["G. DeCandia", "D. Hastorun", "M. Jampani", "G. Kakulapati", "A. Lakshman", "A. Pilchin", "S. Sivasubramanian", "P. Vosshall", "W. Vogels"], "venue": "ACM SIGOPS Operating Systems Review,", "citeRegEx": "DeCandia et al\\.,? \\Q2007\\E", "shortCiteRegEx": "DeCandia et al\\.", "year": 2007}, {"title": "Percentile optimization in uncertain Markov decision processes with application to efficient exploration", "author": ["E. Delage", "S. Mannor"], "venue": "In ICML,", "citeRegEx": "Delage and Mannor.,? \\Q2007\\E", "shortCiteRegEx": "Delage and Mannor.", "year": 2007}, {"title": "Resolute choice in sequential decision problems with multiple priors", "author": ["H\u00e9l\u00e8ne Fargier", "Gildas Jeantet", "Olivier Spanjaard"], "venue": "In IJCAI,", "citeRegEx": "Fargier et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Fargier et al\\.", "year": 2011}, {"title": "Percentiles and Markovian decision processes", "author": ["Jerzy A. Filar"], "venue": "Operations Research Letters,", "citeRegEx": "Filar.,? \\Q1983\\E", "shortCiteRegEx": "Filar.", "year": 1983}, {"title": "Variance-penalized Markov decision processes", "author": ["Jerzy A. Filar", "L.C.M. Kallenberg", "Huey-Miin Lee"], "venue": "Mathematics of Operations Research,", "citeRegEx": "Filar et al\\.,? \\Q1989\\E", "shortCiteRegEx": "Filar et al\\.", "year": 1989}, {"title": "An axiomatic characterization of skew-symmetric bilinear functionals, with applications to utility theory", "author": ["P.C. Fishburn"], "venue": "Economics Letters,", "citeRegEx": "Fishburn.,? \\Q1981\\E", "shortCiteRegEx": "Fishburn.", "year": 1981}, {"title": "Preference-based reinforcement learning: A formal framework and a policy iteration algorithm", "author": ["J. F\u00fcrnkranz", "E. H\u00fcllermeier", "W. Cheng", "S.H. Park"], "venue": "Machine Learning,", "citeRegEx": "F\u00fcrnkranz et al\\.,? \\Q2012\\E", "shortCiteRegEx": "F\u00fcrnkranz et al\\.", "year": 2012}, {"title": "Solving MDPs with skew symmetric bilinear utility functions", "author": ["Hugo Gilbert", "Olivier Spanjaard", "Paolo Viappiani", "Paul Weng"], "venue": null, "citeRegEx": "Gilbert et al\\.,? \\Q1989\\E", "shortCiteRegEx": "Gilbert et al\\.", "year": 1989}, {"title": "Model-free reinforcement learning with skew-symmetric bilinear utilities", "author": ["Hugo Gilbert", "Bruno Zanuttini", "Paolo Viappiani", "Paul Weng", "Esther Nicart"], "venue": "In International Conference on Uncertainty in Artificial Intelligence (UAI),", "citeRegEx": "Gilbert et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Gilbert et al\\.", "year": 2016}, {"title": "Pure stationary optimal strategies in Markov decision processes", "author": ["Hugo Gimbert"], "venue": "In STACS,", "citeRegEx": "Gimbert.,? \\Q2007\\E", "shortCiteRegEx": "Gimbert.", "year": 2007}, {"title": "Implementing resolute choice under uncertainty", "author": ["Jean-Yves Jaffray"], "venue": "In UAI,", "citeRegEx": "Jaffray.,? \\Q1998\\E", "shortCiteRegEx": "Jaffray.", "year": 1998}, {"title": "Value-at-Risk: The New Benchmark for Managing", "author": ["Philippe Jorion"], "venue": "Financial Risk. McGraw-Hill,", "citeRegEx": "Jorion.,? \\Q2006\\E", "shortCiteRegEx": "Jorion.", "year": 2006}, {"title": "A learning scheme for blackwell\u2019s approachability in mdps and stackelberg stochastic games", "author": ["D. Kalathil", "V.S. Borkar", "R. Jain"], "venue": "Arxiv,", "citeRegEx": "Kalathil et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Kalathil et al\\.", "year": 2014}, {"title": "Quantile Regression", "author": ["R. Koenker"], "venue": "Cambridge university press,", "citeRegEx": "Koenker.,? \\Q2005\\E", "shortCiteRegEx": "Koenker.", "year": 2005}, {"title": "Risk-sensitive planning with one-switch utility functions: Value iteration", "author": ["Y. Liu", "S. Koenig"], "venue": "In AAAI,", "citeRegEx": "Liu and Koenig.,? \\Q2005\\E", "shortCiteRegEx": "Liu and Koenig.", "year": 2005}, {"title": "Functional value iteration for decision-theoretic planning with general utility functions", "author": ["Y. Liu", "S. Koenig"], "venue": "In AAAI,", "citeRegEx": "Liu and Koenig.,? \\Q2006\\E", "shortCiteRegEx": "Liu and Koenig.", "year": 2006}, {"title": "Rationality and dynamic choice: Foundational explorations", "author": ["E. McClennen"], "venue": "Cambridge university press,", "citeRegEx": "McClennen.,? \\Q1990\\E", "shortCiteRegEx": "McClennen.", "year": 1990}, {"title": "Human-level control through deep reinforcement learning", "author": ["Volodymyr Mnih", "Koray Kavukcuoglu", "David Silver", "Andrei A. Rusu", "Joel Veness", "Marc G. Bellemare", "Alex Graves", "Martin Riedmiller", "Andreas K. Fidjeland", "Georg Ostrovski", "Stig Petersen", "Charles Beattie", "Amir Sadik", "Ioannis Antonoglou", "Helen King", "Dharshan Kumaran", "Daan Wierstra", "Shane Legg", "Demis Hassabis"], "venue": "Nature, 518:529\u2013533,", "citeRegEx": "Mnih et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Mnih et al\\.", "year": 2015}, {"title": "Algorithms for inverse reinforcement learning", "author": ["A.Y. Ng", "S. Russell"], "venue": null, "citeRegEx": "Ng and Russell.,? \\Q2000\\E", "shortCiteRegEx": "Ng and Russell.", "year": 2000}, {"title": "Dynamic programming analysis of the TV game who wants to be a millionaire", "author": ["F. Perea", "J. Puerto"], "venue": "European Journal of Operational Research,", "citeRegEx": "Perea and Puerto.,? \\Q2007\\E", "shortCiteRegEx": "Perea and Puerto.", "year": 2007}, {"title": "Markov decision processes: discrete stochastic dynamic programming", "author": ["M.L. Puterman"], "venue": null, "citeRegEx": "Puterman.,? \\Q1994\\E", "shortCiteRegEx": "Puterman.", "year": 1994}, {"title": "Percentile queries in multi-dimensional Markov decision processes", "author": ["Mickael Randour", "Jean-Fran\u00e7ois Raskin", "Ocan Sankur"], "venue": "CoRR, abs/1410.4801,", "citeRegEx": "Randour et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Randour et al\\.", "year": 2014}, {"title": "Regret based reward elicitation for Markov decision processes. In UAI, pages 444\u2013451", "author": ["K. Regan", "C. Boutilier"], "venue": null, "citeRegEx": "Regan and Boutilier.,? \\Q2009\\E", "shortCiteRegEx": "Regan and Boutilier.", "year": 2009}, {"title": "Quantile maximization in decision theory", "author": ["M.J. Rostek"], "venue": "Review of Economic Studies,", "citeRegEx": "Rostek.,? \\Q2010\\E", "shortCiteRegEx": "Rostek.", "year": 2010}, {"title": "Qualitative multi-armed bandits: A quantile-based approach", "author": ["Bal\u00e1zs Sz\u00f6r\u00e9nyi", "R\u00f3bert Busa-Fekete", "Paul Weng", "Eyke H\u00fcllermeier"], "venue": "In ICML,", "citeRegEx": "Sz\u00f6r\u00e9nyi et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Sz\u00f6r\u00e9nyi et al\\.", "year": 2015}, {"title": "Temporal difference learning and td-gammon", "author": ["Gerald Tesauro"], "venue": "Communications of the ACM,", "citeRegEx": "Tesauro.,? \\Q1995\\E", "shortCiteRegEx": "Tesauro.", "year": 1995}, {"title": "Markov decision processes with ordinal rewards: Reference point-based preferences", "author": ["P. Weng"], "venue": "In ICAPS,", "citeRegEx": "Weng.,? \\Q2011\\E", "shortCiteRegEx": "Weng.", "year": 2011}, {"title": "Ordinal decision models for Markov decision processes", "author": ["P. Weng"], "venue": "In ECAI,", "citeRegEx": "Weng.,? \\Q2012\\E", "shortCiteRegEx": "Weng.", "year": 2012}, {"title": "Interactive value iteration for Markov decision processes with unknown rewards", "author": ["P. Weng", "B. Zanuttini"], "venue": "In IJCAI,", "citeRegEx": "Weng and Zanuttini.,? \\Q2013\\E", "shortCiteRegEx": "Weng and Zanuttini.", "year": 2013}, {"title": "Utility, probabilistic constraints, mean and variance of discounted rewards in Markov decision processes", "author": ["D.J. White"], "venue": "OR Spektrum,", "citeRegEx": "White.,? \\Q1987\\E", "shortCiteRegEx": "White.", "year": 1987}, {"title": "QPRED: Using quantile predictions to improve power usage for private clouds", "author": ["R. Wolski", "J. Brevik"], "venue": "Technical report,", "citeRegEx": "Wolski and Brevik.,? \\Q2014\\E", "shortCiteRegEx": "Wolski and Brevik.", "year": 2014}, {"title": "Sample complexity of risk-averse bandit-arm selection", "author": ["Jia Yuan Yu", "Evdokia Nikolova"], "venue": "In IJCAI,", "citeRegEx": "Yu and Nikolova.,? \\Q2013\\E", "shortCiteRegEx": "Yu and Nikolova.", "year": 2013}, {"title": "Optimization models for the first arrival target distribution function in discrete time", "author": ["Stella X. Yu", "Yuanlie Lin", "Pingfan Yan"], "venue": "Journal of mathematical analysis and applications,", "citeRegEx": "Yu et al\\.,? \\Q1998\\E", "shortCiteRegEx": "Yu et al\\.", "year": 1998}, {"title": "Spoken dialogue management as planning and acting under uncertainty", "author": ["B. Zhang", "Q. Cai", "J. Mao", "E Chang", "B. Guo"], "venue": "In 7th European Conference on Speech Communication and Technology,", "citeRegEx": "Zhang et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Zhang et al\\.", "year": 2001}], "referenceMentions": [{"referenceID": 38, "context": "Examples of such systems abound: expert backgammon player (Tesauro, 1995), dialogue systems (Zhang et al.", "startOffset": 58, "endOffset": 73}, {"referenceID": 46, "context": "Examples of such systems abound: expert backgammon player (Tesauro, 1995), dialogue systems (Zhang et al., 2001), acrobatic helicopter flight (Abbeel et al.", "startOffset": 92, "endOffset": 112}, {"referenceID": 0, "context": ", 2001), acrobatic helicopter flight (Abbeel et al., 2010) or human-level video game player (Mnih et al.", "startOffset": 37, "endOffset": 58}, {"referenceID": 30, "context": ", 2010) or human-level video game player (Mnih et al., 2015).", "startOffset": 41, "endOffset": 60}, {"referenceID": 1, "context": "More generally, preferencebased reinforcement learning (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014) has been proposed to tackle situations where the only available preferential information concerns pairwise comparisons of histories.", "startOffset": 55, "endOffset": 132}, {"referenceID": 19, "context": "More generally, preferencebased reinforcement learning (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014) has been proposed to tackle situations where the only available preferential information concerns pairwise comparisons of histories.", "startOffset": 55, "endOffset": 132}, {"referenceID": 24, "context": "In finance, it is a risk measure and is known as Value-at-Risk (Jorion, 2006).", "startOffset": 63, "endOffset": 77}, {"referenceID": 13, "context": "For its cloud computing services, Amazon reports (DeCandia et al., 2007) that they optimize the 99.", "startOffset": 49, "endOffset": 72}, {"referenceID": 43, "context": "In fact, decisions in the web industry are often made based on quantiles (Wolski and Brevik, 2014; DeCandia et al., 2007).", "startOffset": 73, "endOffset": 121}, {"referenceID": 13, "context": "In fact, decisions in the web industry are often made based on quantiles (Wolski and Brevik, 2014; DeCandia et al., 2007).", "startOffset": 73, "endOffset": 121}, {"referenceID": 8, "context": "A great deal of research on MDPs (Boussard et al., 2010) considered decision criteria different to the standard ones (i.", "startOffset": 33, "endOffset": 56}, {"referenceID": 8, "context": "A great deal of research on MDPs (Boussard et al., 2010) considered decision criteria different to the standard ones (i.e., expected discounted sum of rewards, expected total rewards or expected average rewards). For instance, in the operations research community, White (1987) notably considered different cases where preferences over policies only depend on sums of rewards: Expected Utility (EU), probabilistic constraints and mean-variance formulations.", "startOffset": 34, "endOffset": 278}, {"referenceID": 8, "context": "A great deal of research on MDPs (Boussard et al., 2010) considered decision criteria different to the standard ones (i.e., expected discounted sum of rewards, expected total rewards or expected average rewards). For instance, in the operations research community, White (1987) notably considered different cases where preferences over policies only depend on sums of rewards: Expected Utility (EU), probabilistic constraints and mean-variance formulations. In this context, he showed the sufficiency of working in a state space augmented with the sum of rewards obtained so far. Filar et al. (1989) investigated decision criteria that are variance-penalized versions of the standard ones.", "startOffset": 34, "endOffset": 600}, {"referenceID": 8, "context": "A great deal of research on MDPs (Boussard et al., 2010) considered decision criteria different to the standard ones (i.e., expected discounted sum of rewards, expected total rewards or expected average rewards). For instance, in the operations research community, White (1987) notably considered different cases where preferences over policies only depend on sums of rewards: Expected Utility (EU), probabilistic constraints and mean-variance formulations. In this context, he showed the sufficiency of working in a state space augmented with the sum of rewards obtained so far. Filar et al. (1989) investigated decision criteria that are variance-penalized versions of the standard ones. They formulated the obtained optimization problem as a non-linear program. Yu et al. (1998) optimized the probability that the total reward becomes higher than a certain threshold.", "startOffset": 34, "endOffset": 782}, {"referenceID": 18, "context": "(2015) investigated the use of Skew-Symmetric Bilinear (SSB) utility (Fishburn, 1981) functions \u2014 a generalization of EU that enables intransitive behaviors and violation of the independence axiom \u2014 as decision criteria in finite-horizon MDPs.", "startOffset": 69, "endOffset": 85}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014).", "startOffset": 146, "endOffset": 223}, {"referenceID": 19, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014).", "startOffset": 146, "endOffset": 223}, {"referenceID": 34, "context": "This work has also been extended to the multiobjective setting (Randour et al., 2014).", "startOffset": 63, "endOffset": 85}, {"referenceID": 16, "context": "In MDPs with ordinal rewards (Weng, 2011, 2012; Filar, 1983), quantile-based decision models were proposed to compute policies that maximize a quantile using linear programming.", "startOffset": 29, "endOffset": 60}, {"referenceID": 4, "context": "This method has recently been exploited in achievability problems (Blackwell, 1956) in the context of multiobjective MDPs (Kalathil et al.", "startOffset": 66, "endOffset": 83}, {"referenceID": 25, "context": "This method has recently been exploited in achievability problems (Blackwell, 1956) in the context of multiobjective MDPs (Kalathil et al., 2014) and for learning SSB-optimal policies (Gilbert et al.", "startOffset": 122, "endOffset": 145}, {"referenceID": 21, "context": ", 2014) and for learning SSB-optimal policies (Gilbert et al., 2016).", "startOffset": 46, "endOffset": 68}, {"referenceID": 6, "context": "In the continuation of this work, Gilbert et al. (2015) investigated the use of Skew-Symmetric Bilinear (SSB) utility (Fishburn, 1981) functions \u2014 a generalization of EU that enables intransitive behaviors and violation of the independence axiom \u2014 as decision criteria in finite-horizon MDPs.", "startOffset": 34, "endOffset": 56}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity.", "startOffset": 147, "endOffset": 351}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruy\u00e8re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value.", "startOffset": 147, "endOffset": 512}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruy\u00e8re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value. This work has also been extended to the multiobjective setting (Randour et al., 2014). Recent work in Markov decision process and reinforcement learning considered conditional Value-at-risk (CVaR), a criterion related to quantile, as a risk measure. B\u00e4uerle and Ott (2011) proved the existence of deterministic wealth-Markovian policies optimal with respect to CVaR.", "startOffset": 147, "endOffset": 1024}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruy\u00e8re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value. This work has also been extended to the multiobjective setting (Randour et al., 2014). Recent work in Markov decision process and reinforcement learning considered conditional Value-at-risk (CVaR), a criterion related to quantile, as a risk measure. B\u00e4uerle and Ott (2011) proved the existence of deterministic wealth-Markovian policies optimal with respect to CVaR. Chow and Ghavamzadeh (2014) proposed gradient-based algorithms for CVaR optimization.", "startOffset": 147, "endOffset": 1146}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruy\u00e8re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value. This work has also been extended to the multiobjective setting (Randour et al., 2014). Recent work in Markov decision process and reinforcement learning considered conditional Value-at-risk (CVaR), a criterion related to quantile, as a risk measure. B\u00e4uerle and Ott (2011) proved the existence of deterministic wealth-Markovian policies optimal with respect to CVaR. Chow and Ghavamzadeh (2014) proposed gradient-based algorithms for CVaR optimization. In contrast, Borkar and Jain (2014) used CVaR in constraints instead of as objective function.", "startOffset": 147, "endOffset": 1240}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruy\u00e8re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value. This work has also been extended to the multiobjective setting (Randour et al., 2014). Recent work in Markov decision process and reinforcement learning considered conditional Value-at-risk (CVaR), a criterion related to quantile, as a risk measure. B\u00e4uerle and Ott (2011) proved the existence of deterministic wealth-Markovian policies optimal with respect to CVaR. Chow and Ghavamzadeh (2014) proposed gradient-based algorithms for CVaR optimization. In contrast, Borkar and Jain (2014) used CVaR in constraints instead of as objective function. Closer to our work, several quantile-based decision models have been investigated in different contexts. In uncertain MDPs where the parameters of the transition and reward functions are imprecisely known, Delage and Mannor (2007) presented and investigated a quantile-like criterion to capture the trade-off between optimistic and pessimistic viewpoints on an uncertain MDP.", "startOffset": 147, "endOffset": 1530}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruy\u00e8re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value. This work has also been extended to the multiobjective setting (Randour et al., 2014). Recent work in Markov decision process and reinforcement learning considered conditional Value-at-risk (CVaR), a criterion related to quantile, as a risk measure. B\u00e4uerle and Ott (2011) proved the existence of deterministic wealth-Markovian policies optimal with respect to CVaR. Chow and Ghavamzadeh (2014) proposed gradient-based algorithms for CVaR optimization. In contrast, Borkar and Jain (2014) used CVaR in constraints instead of as objective function. Closer to our work, several quantile-based decision models have been investigated in different contexts. In uncertain MDPs where the parameters of the transition and reward functions are imprecisely known, Delage and Mannor (2007) presented and investigated a quantile-like criterion to capture the trade-off between optimistic and pessimistic viewpoints on an uncertain MDP. The quantile criterion they use is different to ours as it takes into account the uncertainty present in the parameters of the MDP. In MDPs with ordinal rewards (Weng, 2011, 2012; Filar, 1983), quantile-based decision models were proposed to compute policies that maximize a quantile using linear programming. While quantiles in those works are defined on distributions over ordinal rewards, quantiles in this paper are defined on distributions over histories. More recently, in the machine learning community, quantile-based criteria have been proposed in the multi-armed bandit (MAB) setting, a special case of reinforcement learning. Yu and Nikolova (2013) proposed an algorithm in the pure exploration setting for different risk measures, including Value-at-Risk.", "startOffset": 147, "endOffset": 2335}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruy\u00e8re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value. This work has also been extended to the multiobjective setting (Randour et al., 2014). Recent work in Markov decision process and reinforcement learning considered conditional Value-at-risk (CVaR), a criterion related to quantile, as a risk measure. B\u00e4uerle and Ott (2011) proved the existence of deterministic wealth-Markovian policies optimal with respect to CVaR. Chow and Ghavamzadeh (2014) proposed gradient-based algorithms for CVaR optimization. In contrast, Borkar and Jain (2014) used CVaR in constraints instead of as objective function. Closer to our work, several quantile-based decision models have been investigated in different contexts. In uncertain MDPs where the parameters of the transition and reward functions are imprecisely known, Delage and Mannor (2007) presented and investigated a quantile-like criterion to capture the trade-off between optimistic and pessimistic viewpoints on an uncertain MDP. The quantile criterion they use is different to ours as it takes into account the uncertainty present in the parameters of the MDP. In MDPs with ordinal rewards (Weng, 2011, 2012; Filar, 1983), quantile-based decision models were proposed to compute policies that maximize a quantile using linear programming. While quantiles in those works are defined on distributions over ordinal rewards, quantiles in this paper are defined on distributions over histories. More recently, in the machine learning community, quantile-based criteria have been proposed in the multi-armed bandit (MAB) setting, a special case of reinforcement learning. Yu and Nikolova (2013) proposed an algorithm in the pure exploration setting for different risk measures, including Value-at-Risk. Carpentier and Valko (2014) studied the problem of identifying arms with extreme payoffs, a particular case of quantiles.", "startOffset": 147, "endOffset": 2471}, {"referenceID": 1, "context": "Interestingly, SSB also encompasses probabilistic dominance, a decision criterion that is employed in preference-based sequential decision-making (Akrour et al., 2012; F\u00fcrnkranz et al., 2012; Busa-Fekete et al., 2013, 2014). In theoretical computer science, sophisticated decision criteria have also been studied in MDPs. For instance, Gimbert (2007) proved that many decision criteria based on expectation (of limsup, parity... of rewards) admit a stationary deterministic optimal policy. Bruy\u00e8re et al. (2014) considered sophisticated preferences over policies, which amounts to searching for policies that maximize the standard criterion while ensuring an expected sum of rewards higher than a threshold with probability higher than a fixed value. This work has also been extended to the multiobjective setting (Randour et al., 2014). Recent work in Markov decision process and reinforcement learning considered conditional Value-at-risk (CVaR), a criterion related to quantile, as a risk measure. B\u00e4uerle and Ott (2011) proved the existence of deterministic wealth-Markovian policies optimal with respect to CVaR. Chow and Ghavamzadeh (2014) proposed gradient-based algorithms for CVaR optimization. In contrast, Borkar and Jain (2014) used CVaR in constraints instead of as objective function. Closer to our work, several quantile-based decision models have been investigated in different contexts. In uncertain MDPs where the parameters of the transition and reward functions are imprecisely known, Delage and Mannor (2007) presented and investigated a quantile-like criterion to capture the trade-off between optimistic and pessimistic viewpoints on an uncertain MDP. The quantile criterion they use is different to ours as it takes into account the uncertainty present in the parameters of the MDP. In MDPs with ordinal rewards (Weng, 2011, 2012; Filar, 1983), quantile-based decision models were proposed to compute policies that maximize a quantile using linear programming. While quantiles in those works are defined on distributions over ordinal rewards, quantiles in this paper are defined on distributions over histories. More recently, in the machine learning community, quantile-based criteria have been proposed in the multi-armed bandit (MAB) setting, a special case of reinforcement learning. Yu and Nikolova (2013) proposed an algorithm in the pure exploration setting for different risk measures, including Value-at-Risk. Carpentier and Valko (2014) studied the problem of identifying arms with extreme payoffs, a particular case of quantiles. Finally, Sz\u00f6r\u00e9nyi et al. (2015) investigated MAB problems where a quantile is optimized instead of the mean.", "startOffset": 147, "endOffset": 2597}, {"referenceID": 33, "context": "Markov Decision Process Markov Decision Processes (MDPs) offer a powerful formalism to model and solve sequential decision-making problems (Puterman, 1994).", "startOffset": 139, "endOffset": 155}, {"referenceID": 31, "context": "In those cases, one can try to recover the reward function from a human expert (Ng and Russell, 2000; Regan and Boutilier, 2009; Weng and Zanuttini, 2013).", "startOffset": 79, "endOffset": 154}, {"referenceID": 35, "context": "In those cases, one can try to recover the reward function from a human expert (Ng and Russell, 2000; Regan and Boutilier, 2009; Weng and Zanuttini, 2013).", "startOffset": 79, "endOffset": 154}, {"referenceID": 41, "context": "In those cases, one can try to recover the reward function from a human expert (Ng and Russell, 2000; Regan and Boutilier, 2009; Weng and Zanuttini, 2013).", "startOffset": 79, "endOffset": 154}, {"referenceID": 31, "context": "In inverse reinforcement learning (Ng and Russell, 2000), the expert is assumed to know an", "startOffset": 34, "endOffset": 56}, {"referenceID": 35, "context": "In interactive settings (Regan and Boutilier, 2009; Weng and Zanuttini, 2013), this elicitation process can be cognitively very complex as it requires to balance several criteria in a complex manner and as it can imply a large number of parameters.", "startOffset": 24, "endOffset": 77}, {"referenceID": 41, "context": "In interactive settings (Regan and Boutilier, 2009; Weng and Zanuttini, 2013), this elicitation process can be cognitively very complex as it requires to balance several criteria in a complex manner and as it can imply a large number of parameters.", "startOffset": 24, "endOffset": 77}, {"referenceID": 36, "context": "More generally, quantiles, which have been axiomatically characterized by Rostek (2010), define decision criteria that have the nice property of not requiring numeric valuations, but only an order.", "startOffset": 74, "endOffset": 88}, {"referenceID": 40, "context": "When the lower and the upper quantiles differ, one may define the quantile as a function of the lower and upper quantiles (Weng, 2012).", "startOffset": 122, "endOffset": 134}, {"referenceID": 29, "context": "In decision theory (McClennen, 1990), three approaches have been considered for such kinds of decision criteria:", "startOffset": 19, "endOffset": 36}, {"referenceID": 23, "context": "Sophisticated resolute choice approach (Jaffray, 1998; Fargier et al., 2011): apply a policy \u03c0 (chosen at the beginning) that trades off between how much \u03c0 is optimal for all horizons T, T \u2212 1, .", "startOffset": 39, "endOffset": 76}, {"referenceID": 15, "context": "Sophisticated resolute choice approach (Jaffray, 1998; Fargier et al., 2011): apply a policy \u03c0 (chosen at the beginning) that trades off between how much \u03c0 is optimal for all horizons T, T \u2212 1, .", "startOffset": 39, "endOffset": 76}, {"referenceID": 32, "context": "We used the first model of the Spanish 2003 version of the game presented by Perea and Puerto (2007). The probability of answering correctly is a function of the question\u2019s number and increased by the lifelines used (if any).", "startOffset": 77, "endOffset": 101}, {"referenceID": 6, "context": "It is based on stochastic approximation with two timescales (Borkar, 2008).", "startOffset": 60, "endOffset": 74}, {"referenceID": 26, "context": "Besides, it would also be interesting to explore whether gradient-based algorithms could be developed for the optimization of quantiles, based on the fact that a quantile is solution of an optimization problem where the objective function is piecewise linear (Koenker, 2005).", "startOffset": 259, "endOffset": 274}], "year": 2016, "abstractText": "In reinforcement learning, the standard criterion to evaluate policies in a state is the expectation of (discounted) sum of rewards. However, this criterion may not always be suitable, we consider an alternative criterion based on the notion of quantiles. In the case of episodic reinforcement learning problems, we propose an algorithm based on stochastic approximation with two timescales. We evaluate our proposition on a simple model of the TV show, Who wants to be a millionaire.", "creator": "LaTeX with hyperref package"}}}