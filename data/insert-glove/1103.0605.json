{"id": "1103.0605", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "3-Mar-2011", "title": "Loopy Belief Propagation, Bethe Free Energy and Graph Zeta Function", "abstract": "gurney We propose khalilzad a reconsidering new entremed approach cartledge to guillem the theoretical analysis 31,000-square of auxois Loopy .160 Belief buenaventura Propagation (steegmans LBP) fiddly and the 11-on-11 Bethe free energy (borgman BFE) umayyads by mittelstaedt establishing moodley a suphamongkhon formula l'h\u00e9ritier to mandai connect acanthamoeba LBP and BFE with haidong a zemurray graph higinbotham zeta stroot function. The proposed approach is upgradeable applicable utm to m-45 a wide class zelophehad of models mudavadi including multinomial grapefruit and Gaussian xtra types. The 11.25 connection pin-point derives a number of new nsis theoretical proscriptions results lousewies on hinckley LBP nozzle and sdx BFE. lefferts This paper focuses 50.34 two 155 of such topics. One is the p-61 analysis of sanai the region mahv where the Hessian mm2 of waived/injured the bogs Bethe free energy is chrysostomos positive definite, which derives nord-tr\u00f8ndelag the longbenton non - floccari convexity falstaffian of eight-minute BFE yigong for graphs klasnic with multiple cycles, gardist and murinus a condition of violette convexity on a restricted goodworks set. scott This brundage analysis also gives piloti a new strehler condition 101st for the tary uniqueness of the LBP fixed point. gpac The petersdorf other result is harmonicas to clarify radack the relation between schrenk the holaus local stability of tindill a anti-shipping fixed point montenero of 2009-2011 LBP and steed local siderman minima of drinkable the BFE, which kaho implies, kake for example, that a simpering locally betul stable fixed 124.26 point ndegeocello of the Gaussian coombe LBP holdman is djing a local flic minimum of market-place the sleaford Gaussian quipped Bethe free romgaz energy.", "histories": [["v1", "Thu, 3 Mar 2011 04:40:19 GMT  (476kb)", "http://arxiv.org/abs/1103.0605v1", null]], "reviews": [], "SUBJECTS": "cs.AI cs.DM", "authors": ["yusuke watanabe", "kenji fukumizu"], "accepted": false, "id": "1103.0605"}, "pdf": {"name": "1103.0605.pdf", "metadata": {"source": "CRF", "title": null, "authors": ["Yusuke Watanabe", "Kenji Fukumizu"], "emails": ["watay@ism.ac.jp", "fukumizu@ism.ac.jp"], "sections": [{"heading": null, "text": "ar X\niv :1\n10 3.\n06 05\nv1 [\ncs .A\nI] 3\nKeywords: loopy belief propagation, graphical models, Bethe free energy, graph zeta function, Ihara-Bass formula"}, {"heading": "1. Introduction", "text": "Probability density functions that have \u201clocal\u201d factorization structures, called graphical models, constitute fundamentals in many fields. In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998). Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002). Typically, such probability distributions are derived from random variables that only have local interactions/constraints. This factorization structure is clearly visualized by a graph, called factor graph.\nSince the inference problems on graphical models, such as computation of marginal/conditional density functions and partition functions, are in general intractable for large graphs, Loopy Belief Propagation (LBP) has been proposed as an efficient approximation method applicable to any graph-structured density functions. Originally, Belief Propagation (BP) algorithm was proposed by Pearl (1988) to compute exactly the marginals for tree-structured graphical\nc\u00a92011 Yusuke Watanabe and Kenji Fukumizu.\nmodels. This algorithm passes \u201cmessages\u201d between vertices of the graph until all information of the graphical model is distributed throughout the graph. Some researchers have found that LBP, an extended use of BP for graphs with cycles, shows good approximation with high potential applicability (Murphy et al., 1999; McEliece et al., 1998). After the proposal, many extensions and variants have been studied (Yedidia et al., 2001; Sudderth et al., 2002; Wainwright et al., 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al., 2005; Baron et al., 2010).\nOn the theoretical side, a significant number of studies have been carried out by many authors in this decade. One theoretical challenge of LBP is that the algorithm may have many fixed points; the uniqueness is generally guaranteed only for trees and one-cycle graphs (Weiss, 2000). The LBP fixed points are the solutions of a nonlinear equation associated with the graph, and the structure of the equation is more complicated as the number of cycle is larger. Regarding this problem, a notable result is the variational interpretation of LBP; it shows that the LBP fixed points are the local minima of the Bethe free energy (Yedidia et al., 2001, 2005). This suggests that the behavior of LBP is more complex with non-convexity of the Bethe free energy. Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree.\nThe purpose of this paper is to provide a novel discrete geometric approach to analysis of the LBP algorithm. The starting point of our study is a question: \u201cHow are the behaviors of the LBP algorithm affected by the geometry of the graph?\u201d If the graph is a tree (L)BP works nicely; it terminates in a finite step at the unique fixed point and gives the exact marginals. If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000). Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002). Existence of multiple cycles, however, breaks down these nice properties. There have not been many researches that elucidate the effects of cycles on LBP in detail beyond \u201ctree or non-tree\u201d classification. While a notable exception is the walk-sum analysis by Johnson et al. (2006) and Malioutov et al. (2006), it is limited to the Gaussian case.\nThis paper proposes a method based on a new connection between LBP, Bethe free energy, and a graph zeta function. Graph zeta functions, originally introduced by Ihara (1966), are popular graph characteristics defined by the products over the prime cycles. We capture the effects of cycles on LBP and Bethe free energy by establishing a novel formula, called Bethe-zeta formula, which connects the Hessian of the Bethe free energy with the graph zeta function. To derive the formula, we extend the definition of existing graph zeta functions and related Ihara-Bass formula (Stark and Terras, 1996; Bass, 1992).\nOur discovery of the connection, including the Bethe-zeta formula, derives new ways of analyzing LBP and the Bethe free energy function taking the graph geometry into account. It is applicable to a wide class of graphical models defined by \u201cmarginally closed\u201d\nexponential families, which include multinomial and Gaussian models. This paper discusses two examples of such analysis: one is the positive definiteness of Hessian for the Bethe free energy, and the other is local stability of the LBP dynamics.\nFirst, based on the connection, we derive conditions that the Hessian of Bethe free energy function is positive definite. As already discussed, analysis of the Bethe free energy is important for theoretical understanding of the complex behavior of LBP. As the fundamentals, we consider the local properties of the Bethe free energy by elucidating the positive definiteness of its Hessian, while there are many studies on modifications and convexifications of the Bethe free energy function (Wiegerinck and Heskes, 2003; Wainwright et al., 2003b; Weiss et al., 2007). The direct consequence of our analysis is a sufficient condition of the uniqueness of the LBP fixed point, which is derived by giving a condition of global convexity. In discussing the positive definiteness, we consider two defining domains of the Bethe free energy: one is given by the locally consistent pseudomarginals, and the other is a more restricted set conditioned by the compatibility functions of given graphical model. The beliefs given by LBP always lie in the latter domain. We show that, when considered in the former domain, the necessary and sufficient condition for the Hessian to be positive definite is that the underlying factor graph has no more than one cycle. We also give a sufficient condition of the convexity of Bethe free energy on the latter domain, which implies the uniqueness of the LBP fixed point. By numerical examples, we demonstrate that our new uniqueness condition covers a wider region than the one given by Mooij and Kappen (2007) for the examples.\nIn the second application, we clarify a relation between the local structure of the Bethe free energy function and the local stability of a LBP fixed point. Such a relation is not necessarily obvious, since LBP is not derived as the gradient descent of the Bethe free energy. In this line of studies, for multinomial models Heskes (2002) shows that a locally stable fixed point of LBP is a local minimum of the Bethe free energy. We give conditions of the local stability of LBP and the positive definiteness of the Bethe free energy in terms of the eigenvalues of a matrix that appears in the graph zeta function. As a consequence, the result by Heskes is extended to a wider class including Gaussian distributions.\nThis paper is organized as follows. In section 2, we introduce graphical models, LBP and the Bethe free energy as preliminaries. We formulate the setting in terms of exponential families. Section 3 includes the definition of a new class of graph zeta function, the extension of Ihara-Bass formula, and related results. Using these results, Section 4 shows the fundamental results of this paper, Bethe-zeta formula and positive definiteness condition, in Theorems 11 and 14. Section 5 derives a positive-definite region of the Bethe free energy function, and discusses convexity. In section 6, we elucidate the relations between the stability of LBP and the local structure of the Bethe free energy at LBP fixed points. Section 7 includes discussion and concluding remarks. Proofs omitted from the main body of the paper are given in the appendices."}, {"heading": "2. Preliminaries", "text": "In this section we summarize a background of graphical models and LBP. In Subsection 2.1 we introduce graphical models in terms of hypergraphs. Subsection 2.2 introduces LBP\nalgorithm. The Bethe free energy, which provides alternative language for formulating LBP algorithm, is discussed in Subsection 2.3."}, {"heading": "2.1 Graphical models", "text": "We begin with basic definitions of hypergraphs because the associated structures with graphical models are, precisely speaking, hypergraphs.\nAn ordinary graph G = (V,E) consists of the vertex set V joined by edges of E. Generalizing the notion of graphs, hypergraphs are defined as follows. A hypergraph H = (V, F ) consists of a set of vertices V and a set of hyperedges F . A hyperedge is a non-empty subset of V . For any vertex i \u2208 V , the neighbors of i is defined by Ni := {\u03b1 \u2208 F |i \u2208 \u03b1}. Similarly, for any hyperedge \u03b1 \u2208 F , the neighbors of \u03b1 is defined by N\u03b1 := {i \u2208 V |i \u2208 \u03b1} = \u03b1. The degrees of i and \u03b1 are given by di := |Ni| and d\u03b1 := |N\u03b1| = |\u03b1|, respectively. If all the degrees of hyperedges are two, then the hypergraph is naturally identified with an ordinary graph.\nIn order to describe the message passing algorithm in Subsection 2.2.2, it is convenient to identify a relation i \u2208 \u03b1 with a directed edge \u03b1 \u2192 i. For example, let H = ({1, 2, 3, 4}, {\u03b11 , \u03b12, \u03b13}), where \u03b11 = {1, 2}, \u03b12 = {1, 2, 3, 4} and \u03b13 = {4}; this hypergraph is shown as a directed graph in Fig. 1. Explicitly writing the set of directed edges ~E, a hypergraph H is also denoted by H = (V \u222a F, ~E). Note that, forgetting the edge directions, H is also represented as a bipartite graph (Fig. 2).\nWe define basic notions of hypergraphs via its corresponding bipartite graphs. A hypergraph H is connected (resp. tree) if the corresponding bipartite graph is connected (resp. tree). In the same way, the number of connected components (resp. nullity) of H is defined and denoted by k(H) (resp. n(H)). Therefore, n(H) := |V |+ |F | \u2212 | ~E| and a hypergraph H is a tree if and only if n(H) = 0 and k(H) = 1.\nOur primary interest is probability density functions that have factorization structures represented by hypergraphs. In such situations, a hypergraph is often referred to as a factor graph and a hyperedge as a factor.\nDefinition 1 Let H = (V, F ) be a hypergraph. For each i \u2208 V , let xi be a variable that takes values in a set Xi. A probability density function p on x = (xi)i\u2208V is said to be graphically factorized with respect to H if it has the following factorized form\np(x) = 1\nZ\n\u220f\n\u03b1\u2208F\n\u03a8\u03b1(x\u03b1), (1)\nwhere x\u03b1 = (xi)i\u2208\u03b1, Z is the normalization constant and \u03a8\u03b1 are positive valued functions called compatibility functions. A set of compatibility functions, giving a graphically factorized density function, is called a graphical model. The associated hypergraph H is called the factor graph of the graphical model.\nFactor graphs are introduced by Kschischang et al. (2001). Any probability density function on X = \u220fi\u2208V Xi is trivially graphically factorized with respect to the \u201cone-factor hypergraph\u201d, where the unique factor includes all vertices. It is more informative if the factorization involves factors of small size. Our implicit assumption throughout this paper is that for all factors \u03b1, X\u03b1 = \u220f\niXi are small enough, in the sense of cardinality or dimension, to be handled efficiently by computers."}, {"heading": "2.2 Loopy Belief Propagation algorithm", "text": "Given a graphical model, our task is to solve inference problem such as computation of marginal/conditional density functions and the partition function. Belief Propagation (BP) efficiently computes the exact marginals of a joint distribution that is factorized according to a tree-structured factor graph; Loopy Belief Propagation (LBP) is a heuristic application of the algorithm for factor graphs with cycles, showing successful performance in various problems.\nFirst, in Subsection 2.2.1, we introduce a collection of exponential families called inference family to formulate the LBP algorithm. In order to perform inferences using LBP, we have to fix an inference family that \u201cincludes\u201d the given graphical model. Our formulation is a variant of the approach by Wainwright et al. (2003a), where over-complete sufficient statistics are exploited. The detail of the LBP algorithm is described in Subsections 2.2.2."}, {"heading": "2.2.1 Exponential families and Inference family", "text": "To clarify notations, here we summarize basic facts on exponential families. Let (X ,B, \u03bd) be a measure space. For given n real valued functions (sufficient statistics) \u03c6(x) = (\u03c61(x), . . . , \u03c6n(x)), an exponential family is given by\np(x; \u03b8) = exp\n(\nN \u2211\ni=1\n\u03b8i\u03c6i(x)\u2212 \u03c8(\u03b8) ) , \u03c8(\u03b8) := log \u222b exp ( N \u2211\ni=1\n\u03b8i\u03c6i(x)\n)\nd\u03bd(x).\nThe natural parameter, \u03b8, ranges over the set \u0398 := int{\u03b8 \u2208 RN ;\u03c8(\u03b8) < \u221e}, where int denotes the interior of the set. The function \u03c8(\u03b8) is called the log partition function. We always assume that the Hessian of this function (i.e. the covariance matrix) is invertible. The derivative of the log partition function gives a bijective map\n\u039b : \u0398 \u220b \u03b8 7\u2212\u2192 \u2202\u03c8 \u2202\u03b8 (\u03b8) = Ep\u03b8 [\u03c6] \u2208 Y := \u039b(\u0398)\nand this alternative parameter \u03b7 = \u2202\u03c8\u2202\u03b8 (\u03b8) is called expectation parameter. The inverse of this map is given by the derivative of the Legendre transform \u03d5(\u03b7) = sup\u03b8\u2208\u0398( \u2211\ni \u03b8i\u03b7i\u2212\u03c8(\u03b8)) = Ep\u039b\u22121(\u03b7) [log p\u039b\u22121(\u03b7)].\nExample 1 [Multinomial distributions] Let X = {0, . . . , N \u2212 1} be a finite set with the uniform base measure. One way of taking sufficient statistics is\n\u03c6k(x) =\n{\n1 if x = k 0 otherwise (2)\nfor k = 0, . . . , N \u2212 2. Then the given exponential family is called multinomial distributions and coincide with the all probability density functions on X that has positive probabilities for all elements of X . The region of natural parameters is \u0398 = RN\u22121 and the of expectation parameters is the interior of the probability simplex. That is, Y = {(y1, . . . , yN ); \u2211N k=1 yk = 1, yk > 0}.\nExample 2 [Gaussian distributions] Let X = Rn with the Lebesgue measure and The exponential family given by the sufficient statistics \u03c6(x) = (xi, xjxk)1\u2264i\u2264n,1\u2264j\u2264k\u2264n, is called Gaussian distributions, consists of probability density functions of the form\np(x; \u03b8) = exp (\n\u2211\ni\u2264j\n\u03b8ijxixj + \u2211\ni\n\u03b8ixi \u2212 \u03c8(\u03b8) ) .\nExample 3 [Fixed-mean Gaussian distributions] For a given mean vector \u00b5 = (\u00b5i), the fixed-mean Gaussian distributions is the exponential family obtained by the sufficient statistics \u03c6(x) = {(xi \u2212 \u00b5i)(xj \u2212 \u00b5j)}1\u2264i\u2264j\u2264n.\nHere and below, we construct a set of exponential families. In order to perform inferences using LBP for a given graphical model, we have to fix a \u201cfamily\u201d that includes the given probability density function.\nLet H = (V, F ) be a hypergraph. First, for each vertex i, we consider an exponential family Ei with a sufficient statistic \u03c6i and a base measure \u03bdi on Xi. A natural parameter, expectation parameter, the log partition function and its Legendre transform are denoted by \u03b8i, \u03b7i, \u03c8i and \u03d5i respectively. Secondly, for each factor \u03b1 = {i1, . . . , id\u03b1}, we give an exponential family E\u03b1 on X\u03b1 = \u220f i\u2208\u03b1 Xi with the base measure \u03bd\u03b1 = \u220f\ni\u2208\u03b1 \u03bdi and a sufficient statistic \u03c6\u03b1 of the form\n\u03c6\u03b1(x\u03b1) = (\u03c6\u3008\u03b1\u3009(x\u03b1), \u03c6i1(xi1), . . . , \u03c6id\u03b1 (xid\u03b1 )). (3)\nAn important point is that \u03c6\u03b1 includes the sufficient statistics for i \u2208 \u03b1 as its components in addition to \u03c6\u3008\u03b1\u3009 indexed by \u03b1 \u2208 F . The natural parameter, expectation parameter, log partition function and its Legendre transform are denoted by\n\u03b8\u03b1 = (\u03b8\u3008\u03b1\u3009, \u03b8\u03b1:i1 , . . . , \u03b8\u03b1:id\u03b1 ) \u2208 \u0398\u03b1, \u03b7\u03b1 = (\u03b7\u3008\u03b1\u3009, \u03b7\u03b1:i1 , . . . , \u03b7\u03b1:id\u03b1 ) \u2208 Y\u03b1, \u03c8\u03b1 and \u03d5\u03b1. (4)\nThe following assumption is indispensable to our analysis:\nAssumption 1 For all i \u2208 V and \u03b1 \u2208 F , we assume that the Hessian of the log partition functions , \u03c8i and \u03c8\u03b1, (i.e. the covariance matrix) are invertible in the parameter spaces.\nIn order to use these exponential families E\u03b1 and Ei for LBP, we need another assumption: the family is \u201cclosed\u201d under marginalization operation. This type of condition on exponential families is also considered in other litterateurs (Mardia et al., 2009).\nAssumption 2 (Marginally closed assumption) For all pair of i \u2208 \u03b1, \u222b\np(x\u03b1)d\u03bd\u03b1ri(x\u03b1ri) \u2208 Ei for all p \u2208 E\u03b1. (5)\nDefinition 2 If a collection of the exponential families I := {E\u03b1, Ei} given by sufficient statistics (\u03c6\u3008\u03b1\u3009(x\u03b1), \u03c6i(xi))\u03b1\u2208F,i\u2208V as above satisfies Assumptions 1 and 2, it is called an inference family associated with a hypergraph H. An inference family is called pairwise if the associated hypergraph is a graph.\nAn inference family has a parameter set \u0398 = \u220f \u03b1\u0398\u03b1 \u00d7 \u220f\ni\u0398i, which is bijectively mapped to the dual parameter set Y = \u220f\n\u03b1 Y\u03b1 \u00d7 \u220f\ni Yi by the maps of respective components. An inference family naturally defines an exponential family on X = \u220fi Xi of the sufficient statistic (\u03c6\u3008\u03b1\u3009(x\u03b1), \u03c6i(xi))\u03b1\u2208F,i\u2208V . We denote it by E(I).\nExample 4 [Binary pairwise inference family] Consider the case that a graph G = (V,E) is the factor graph. For each i \u2208 V , we define an exponential family Ei on Xi = {0, 1} defined by \u03c6i(xi) = xi. For each {i, j} \u2208 E, we also define multinomial exponential family E{i,j} on {0, 1}2 by \u03c6{i,j}(xi, xj) = (xi, xj , xixj), where \u03c6\u3008i,j\u3009(xi) = xixj. Then these exponential family gives an inference family since Assumption 2 is trivially satisfied.\nExample 5 [Multinomial inference family] Let Ei be an exponential family of multinomial distributions. Choosing functions \u03c6\u3008\u03b1\u3009(x\u03b1), we can make the E\u03b1 being multinomial distributions on X\u03b1; more precisely, we choose \u03c6\u3008\u03b1\u3009(x\u03b1) so that the components of \u03c6\u03b1(x\u03b1), which are regarded as \u220f\ni |Xi| dimensional vectors, are linearly independent. Then we obtain an inference family called a multinomial inference family.\nExample 6 [Gaussian inference family] We consider the case1 that Xi = R . For Gaussian case, given a factor graph H = (V, F ), the sufficient statistics are given by\n\u03c6i(xi) = (xi, x 2 i ), \u03c6\u3008\u03b1\u3009(x\u03b1) = (xixj)i,j\u2208\u03b1,i 6=j.\nThen the inference family is called Gaussian inference family. Assumption 2 is satisfied because a marginal of a Gaussian density function is a Gaussian density function. Fixedmean inference family is analogously defined by \u03c6i(xi) = (xi \u2212 \u00b5i)2 and \u03c6\u3008\u03b1\u3009(x\u03b1) = ((xi \u2212 \u00b5i)(xj\u2212\u00b5j))i,j\u2208\u03b1,i 6=j. Usually, for Gaussian cases, the factor graph H is a graph rather than hypergraphs; thus, we only consider Gaussian inference families on graphs. 2"}, {"heading": "2.2.2 LBP algorithm", "text": "The LBP algorithm calculates the approximate marginals of a given graphical model \u03a8 = {\u03a8\u03b1} using the inference family inference family I. We always assume that the inference family includes the given probability density function:\nAssumption 3 For every factor \u03b1 \u2208 F , there exists \u03b8\u0304\u03b1 s.t.\n\u03a8\u03b1(x\u03b1) = exp ( \u3008\u03b8\u0304\u03b1, \u03c6\u03b1(x\u03b1)\u3009 ) . (6)\n1. Extensions to high dimensional case, i.e. Xi = R ri , is straight forward. 2. Extensions to the cases of hypergraphs are also straightforward.\nThis is equivalent to the assumption\np(x) = 1\nZ\n\u220f\n\u03b1\n\u03a8\u03b1(x\u03b1) \u2208 E(I) (7)\nup to trivial re-scaling of \u03a8\u03b1, which does not affect LBP algorithm. The procedures of the LBP algorithm is as follows (Kschischang et al., 2001). For each pair of a vertex i \u2208 V and a factor \u03b1 \u2208 F satisfying i \u2208 \u03b1, an initialized message is given in the form of m0\u03b1\u2192i(xi) = exp(\u3008\u00b50\u03b1\u2192i, \u03c6i(xi)\u3009), (8) where the choice of \u00b50\u03b1\u2192i is arbitrary. The set {m0\u03b1\u2192i} or {\u00b50\u03b1\u2192i} is called an initialization of the LBP algorithm. At each time t, the messages are updated by the following rule:\nmt+1\u03b1\u2192i(xi) = \u03c9\n\u222b\n\u03a8\u03b1(x\u03b1) \u220f\nj\u2208\u03b1,j 6=i\n\u220f\n\u03b2\u220bj,\u03b2 6=\u03b1\nmt\u03b2\u2192j(xj) d\u03bd\u03b1ri(x\u03b1ri) (t \u2265 0), (9)\nwhere \u03c9 is a certain scaling constant.3 See Fig 3 for the illustration of this message update scheme. From Assumptions 2 and 3, the messages keep the form of Eq. (8).\nSince this update rule simultaneously generates all messages of time t + 1 by those of time t, it is called a parallel update. Another possibility of the update is a sequential update, where, at each time step, one message is chosen according to some prescribed or random order of directed edges. In this paper, we mainly discuss the parallel update.\nWe repeat the update Eq. (9) until the messages converge to a fixed point, though this procedure is not guaranteed to converge. Indeed, it sometimes exhibits oscillatory behaviors. The set of LBP fixed points does not depend on the choices of the update rule, but converging behavior, or dynamics, does depend on the choices.\nIf the algorithm converges, we obtain the fixed point messages {m\u2217\u03b1\u2192i} and beliefs that are defined by\nbi(xi) := \u03c9 \u220f\n\u03b1\u220bi\nm\u2217\u03b1\u2192i(xi) (10)\nb\u03b1(x\u03b1) := \u03c9\u03a8\u03b1(x\u03b1) \u220f\nj\u2208\u03b1\n\u220f\n\u03b2\u220bj,\u03b2 6=\u03b1\nm\u2217\u03b2\u2192j(xj), (11)\n3. Here and below, we do not care about the integrability problem. For multinomial and Gaussian cases, there are no problems.\nwhere \u03c9 denotes (not necessarily the same) normalization constants that require \u222b\nbi(xi)d\u03bdi = 1 and\n\u222b\nb\u03b1(x\u03b1)d\u03bd\u03b1 = 1. (12)\nNote that beliefs automatically satisfy the conditions b\u03b1(x\u03b1) > 0 and \u222b\nb\u03b1(x\u03b1)d\u03bd\u03b1ri(x\u03b1ri) = bi(xi). (13)\nThe beliefs are used for approximation of the true marginal density functions. If H is a tree, the LBP algorithm stops at most | ~E| updates and the computed beliefs are equal to the exact marginals of the given density function."}, {"heading": "2.3 Bethe free energy and characterization of LBP fixed points", "text": "The Bethe approximation was initiated by Bethe (1935) and was found to be essentially equivalent to LBP by Yedidia et al. (2001). The modern formulation for presenting the approximation is a variational problem of the Bethe free energy (An, 1988). In this subsection, we summarize these facts in our settings.\nFirst, we should introduce the Gibbs free energy function because the Bethe free energy function is a computationally tractable approximation of the Gibbs free energy function. For given graphical model \u03a8 = {\u03a8\u03b1}, the Gibbs free energy FGibbs is a convex function over the set of probability distributions p\u0302 on x = (xi)i\u2208V defined by\nFGibbs(p\u0302) =\n\u222b\np\u0302(x) log\n(\np\u0302(x) \u220f\n\u03b1\u03a8\u03b1(x\u03b1)\n)\nd\u03bd(x), (14)\nwhere \u03bd = \u220f i\u2208V \u03bdi is the base measure on X = \u220f i\u2208V Xi. Using Kullback-Leibler divergence D(q||p) = \u222b\np\u0302 log(q/p), Eq. (14) comes to FGibbs(p\u0302) = D(p\u0302||p)\u2212 logZ. Therefore, the exact density function Eq. (1) is characterized by a variational problem\np(x) = argmin p\u0302 FGibbs(p\u0302), (15)\nwhere the minimum is taken over all probability distributions on x. As suggested from the name of \u201cfree energy\u201d, the minimum value of this function is equal to \u2212 logZ.\nIn many cases including discrete variables, computing values of the Gibbs free energy function is intractable in general because the integral in Eq. (14) is indeed a sum over |X | = \u220fi |Xi| states. We introduce functions called Bethe free energy that does not include such an exponential number of state sum.\nDefinition 3 The Bethe free energy (BFE) function is a function of expectation parameters. For a given inference family I, define L(I) := {\u03b7 = {\u03b7\u03b1, \u03b7i} \u2208 Y |\u03b7\u03b1:i = \u03b7i \u2200(i \u2208 \u03b1)} 4. On this set, the Bethe free energy function is defined by\nF (\u03b7) := \u2212 \u2211\n\u03b1\u2208F\n\u3008\u03b8\u0304\u03b1, \u03b7\u03b1\u3009+ \u2211\n\u03b1\u2208F\n\u03d5\u03b1(\u03b7\u03b1) + \u2211\ni\u2208V\n(1\u2212 di)\u03d5i(\u03b7i), (16)\nwhere \u03b8\u0304\u03b1 is the natural parameter of \u03a8\u03b1 in Eq. (6).\n4. We often write L(I) as L when I is obvious from the context. Since Y = \u220f \u03b1 Y\u03b1 \u00d7 \u220f\ni Yi is convex, L is a convex set. If the inference family is multinomial, the closure of this set is called local polytope (Wainwright and Jordan, 2008, 2003).\nAn expectation parameter specifies a probability density function in the exponential family. Thus, \u03b7 \u2208 Y specifies {b\u03b1(x\u03b1), bi(xi)}\u03b1\u2208F,i\u2208V , where b\u03b1(x\u03b1) \u2208 E\u03b1 and bi(xi) \u2208 Ei. The constraint \u03b7\u03b1:i = \u03b7i means that\n\u222b\n\u03c6i(xi)b\u03b1(x\u03b1)d\u03bd\u03b1 =\n\u222b\n\u03c6i(xi)bi(xi)\u03bdi.\nUnder Assumption 3, this condition is equivalent to \u222b\nb\u03b1(x\u03b1)d\u03bd\u03b1ri = bi(xi) because a probability density function in Ei is specified by the expectation of \u03c6i(xi). An element of L is called a set of pseudomarginals. Therefore, we have the following identification\nL = { {b\u03b1(x\u03b1), bi(xi)}\u03b1\u2208F,i\u2208V | b\u03b1(x\u03b1) \u2208 E\u03b1, bi(xi) \u2208 Ei and \u222b b\u03b1(x\u03b1)d\u03bd\u03b1ri = bi(xi) } .\nThe second condition is called local consistency. Under this identification, the Bethe free energy function is\nF ({b\u03b1(x\u03b1), bi(xi)}) = \u2212 \u2211\n\u03b1\u2208F\n\u222b\nb\u03b1(x\u03b1) log \u03a8\u03b1(x\u03b1)d\u03bd\u03b1 + \u2211\n\u03b1\u2208F\n\u222b\nb\u03b1(x\u03b1) log b\u03b1(x\u03b1)d\u03bd\u03b1\n+ \u2211\ni\u2208V\n(1\u2212 di) \u222b bi(xi) log bi(xi)d\u03bdi.\nIf H is a tree, the variational problem of the Bethe free energy over L is equivalent to that of the Gibbs free energy in the following sense. See Wainwright and Jordan (2008) for more details. First, it can be shown that, for any {b\u03b1(x\u03b1), bi(xi)} \u2208 L,\n\u03a0({b\u03b1(x\u03b1), bi(xi)}) := \u220f\n\u03b1\nb\u03b1(x\u03b1) \u220f\ni\nbi(xi) 1\u2212di (17)\nis a probability density function because it is summed up to one. For these type of density functions, we can see that the Gibbs free energy function is equal to the Bethe free energy function: F = FGibbs \u25e6 \u03a0. Secondly, it is also known that the true density function p for a tree has the factorization of the form Eq. (17). Therefore, the variational problem Eq. (15) reduces to that of the Bethe free energy function over L.\nFor general factor graphs, the Bethe variational problem approximates the Gibbs variational problem and a minimizer of the Bethe problem can be used to approximate the marginal density function. As shown by Pakzad and Anantharam (2002), the Bethe free energy function is convex if the factor graph has at most one cycle. Therefore, the minimization of the Bethe free energy is easy for these cases. In general, however, the convexity of F is broken as the nullity of the underlying factor graph becomes large, yielding multiple minima. Though the functions \u03d5\u03b1 and \u03d5i are convex, the negative coefficients (1\u2212di) makes the function F complex. The positive-definiteness of the Hessian of the Bethe free energy will be analyzed in Section 4 and 5.\nThe Bethe free energy function gives an alternative description of the LBP fixed points. The following fact is shown by Yedidia et al. (2001); LBP finds a stationary point of the Bethe free energy function, which is a necessary condition of the minimality. We give the proof in our term in Appendix A.2.\nTheorem 4 Let I be an inference family and \u03a8 = {\u03a8\u03b1} be a graphical model. The following sets are naturally identified each other.\n1. The set of fixed points of loopy belief propagation.\n2. The set of stationary points of F over L(I)."}, {"heading": "3. Graph zeta function", "text": "The aim of this section is to introduce the graph zeta function and develop some results, which are used in the later sections.\nIhara\u2019s graph zeta function was originally introduced by Y. Ihara (1966) for a certain algebraic object, and was abstracted and extended to be defined on arbitrary finite graphs by J. P. Serre (1980), Sunada (1986) and Bass (1992). The edge zeta function is a multivariable generalization of Ihara\u2019s graph zeta function, allowing arbitrary scalar weight for each directed edge (Stark and Terras, 1996). Extending those graph zeta functions, we introduce a graph zeta function defined on hypergraphs with matrix weights.\nThe central result of this section is the Ihara-Bass type determinant formula in Subsection 3.2. This formula plays an important role in deriving the positive definiteness condition in Subsection 3.4. These results are utilized to establish the relations between this zeta function and the LBP algorithm in the next section."}, {"heading": "3.1 Definition of the graph zeta function", "text": "In the first part of this subsection, we further introduce basic definitions and notations of hypergraphs required for the definition of our graph zeta function.\nLet H = (V, F ) be a hypergraph. As noted before, it can be regarded as a directed graph H = (V \u222a F, ~E). For each edge e = (\u03b1 \u2192 i) \u2208 ~E, s(e) = \u03b1 \u2208 F is the starting hyperedge of e and t(e) = i \u2208 V is the terminus vertex of e. If two edges e, e\u2032 \u2208 ~E satisfy conditions t(e) \u2208 s(e\u2032) and t(e) 6= t(e\u2032), this pair is denoted by e \u21c0 e\u2032. (See Figure 4.) A sequence of directed edges (e1, . . . , ek) is said to be a closed geodesic if el \u21c0 el+1 for l \u2208 Z/kZ. For a closed geodesic c, we may form the m-multiple cm by repeating c m-times. If c is not a multiple of strictly shorter closed geodesic, c is said to be prime. For example, a closed geodesic c = (e1, e2, e3, e1, e2, e3) is not prime because c = (e1, e2, e3)\n2. A closed geodesic c = (e1, e2, e3, e4, e1, e2, e3) is prime because it is not c 6= c\u2032m for any c\u2032 and m(\u2265 2). Two closed geodesics are said to be equivalent if one is obtained by cyclic permutation of the other. For example, closed geodesics (e1, e2, e3), (e2, e3, e1) and (e3, e1, e2) are equivalent. An equivalence class of a prime closed geodesic is called a prime cycle. The set of prime cycles of H is denoted by PH .\nIfH is a graph (i.e. d\u03b1 = 2 for all \u03b1 \u2208 F ), these definitions reduce to standard definitions (Kotani and Sunada, 2000). (We will explicitly give them in Subsection 3.3.) In this case, a factor \u03b1 = {i, j} is identified with an undirected edge ij and (\u03b1 \u2192 i) is identified with a directed edge (i \u2192 j).\nUsually, in graph theory, Ihara\u2019s graph zeta function is a uni-variate function and associated with a graph. Our graph zeta function is much more involved: it is defined on a hypergraph having weights of matrices. To define matrix weights, we have to prescribe its sizes; we associate a positive integer re with each edge e \u2208 ~E.\nHere are additional notations used in the following definition. The set of functions 5 on ~E that take values on Cre for each e \u2208 ~E is denoted by X( ~E). The set of n1 \u00d7 n2 complex matrices is denoted by M(n1, n2).\nDefinition 5 Assume that for each e\u2032 \u21c0 e, a matrix weight ue\u2032\u21c0e \u2208 M(re, re\u2032) is associated. For this matrix weights u = {ue\u2032\u21c0e}, the graph zeta function of H is defined by\n\u03b6H(u) := \u220f\np\u2208PH\n1\ndet ( I \u2212 \u03c0(p) ) ,\nwhere \u03c0(p) := uek\u21c0e1 . . . ue2\u21c0e3ue1\u21c0e2 for p = (e1, . . . , ek).\nSince det(In \u2212AB) = det(Im \u2212BA) for n\u00d7m and m\u00d7 n matrices A and B, det(I \u2212 \u03c0(p)) is well defined for an equivalence class p. The definition is an analogue of the Euler product formula of the Riemann zeta function which is represented by the product over all the prime numbers.\nIf H is a graph and re = 1 for all e \u2208 ~E, this zeta function reduces to the edge zeta function by Stark and Terras (1996). If in addition all these scalar weights are set to be equal, i.e. ue\u2032\u21c0e = u, the zeta function reduces to the Ihara zeta function. These reductions will be discussed in Subsection 3.3. Moreover, for general hypergraphs, we obtain the onevariable hypergraph zeta function by setting all matrix weights to be the same scalar u (Storm, 2006).\nExample 7 \u03b6H(u) = 1 if H is a tree. For 1-cycle graph CN of length N , the prime cycles are (e1, e2, . . . , eN ) and (e\u0304N , e\u0304N\u22121, . . . , e\u03041). (See Figure 5.) The zeta function is\n\u03b6CN (u) = det(Ire1 \u2212 ueN\u21c0e1 . . . ue2\u21c0e3ue1\u21c0e2 ) \u22121 det(Ire\u0304N \u2212 ue\u03041\u21c0e\u0304N . . . ue\u0304N\u22121\u21c0e\u0304N\u22122ue\u0304N\u21c0e\u0304N\u22121) \u22121.\nExcept for the above two types of hypergraphs, the number of prime cycles is infinite. Therefore, rigorously speaking, we have to care about the convergence of the product and restrict the definition for sufficiently small matrix weights u. However, as we will see below, the zeta function has a determinant formula and is well defined on the whole space of matrix weights. The proof is given in Appendix A.2.\n5. In mathematical usage, this is not a \u201cfunction\u201d because it takes a value on a different set for each argument e \u2208 ~E. However, we do not stick this point.\nTheorem 6 (The first determinant formula of zeta function) We define a linear operator M(u) : X( ~E) \u2192 X( ~E) by\nM(u)f(e) = \u2211\ne\u2032:e\u2032\u21c0e\nue\u2032\u21c0ef(e \u2032) f \u2208 X( ~E).\nThen, the following formula holds\n\u03b6G(u) \u22121 = det(I \u2212M(u)).\nThis type of determinant formula is well known in the context of graph zeta functions; in fact this theorem is a straightforward generalization of Theorem 3 of Stark and Terras (1996). In the next section we derive a new determinant formula of the zeta function by manipulating the matrix M(u) in the above determinant.\nNote that the matrix representation of the operator M(u) is\nM(u)e,e\u2032 = { ue\u2032\u21c0e if e \u2032 \u21c0 e\n0 otherwise.\nThe simplification of this matrix obtained by setting re = 1 and u = 1 is called directed edge matrix and denoted by M (Stark and Terras, 1996). Kotani and Sunada (2000) call this matrix a Perron-Frobenius operator. A noteworthy difference, in our and their definitions, is that directions of edges are opposite, because we choose the directions to be consistent with illustrations of the LBP algorithm."}, {"heading": "3.2 Determinant formula of Ihara-Bass type", "text": "In the previous subsection, we have shown that the zeta function is expressed as a determinant of size \u2211\ne\u2208 ~E re. In this subsection, we show another determinant expression with additional assumptions on the matrix weights. The formula is called Ihara-Bass type determinant formula and plays a key role in proofs of Theorem 10 and Theorem 11.\nIn the rest of this subsection, we fix a set of positive integers {ri}i\u2208V associated with vertices. Let {u\u03b1i\u2192j}\u03b1\u2208F,i,j\u2208\u03b1 be a set of matrices u\u03b1i\u2192j \u2208 M(rj , ri,). Our additional assumption on the set of matrix weights, which is the argument of the zeta function, is that\nre := rt(e) and ue\u2032\u21c0e := u s(e) t(e\u2032)\u2192t(e).\nThen the graph zeta function can be seen as a function of u = {u\u03b1i\u2192j}. With slight abuse of notation, it is also denoted by \u03b6H(u). Later in Section 4, ri corresponds to the dimension of the sufficient statistic \u03c6i, and u \u03b1 i\u2192j to a matrix Varbj [\u03c6j ] \u22121Covb\u03b1 [\u03c6j, \u03c6i].\nTo state the Ihara-Bass type determinant formula, we introduce a linear operator \u03b9(u) : X( ~E) \u2192 X( ~E) defined by\n(\u03b9(u)f)(e) := \u2211\ne\u2032: s(e \u2032)=s(e)\nt(e\u2032) 6=t(e)\nu s(e) t(e\u2032)\u2192t(e)f(e \u2032) f \u2208 X( ~E).\nThe matrix representation of \u03b9(u) is a block diagonal matrix because it acts on each factor separately. Therefore I + \u03b9(u) is also a block diagonal matrix. Each block is indexed by \u03b1 \u2208 F and denoted by U\u03b1. Thus, for \u03b1 = {i1, . . . , id\u03b1},\nU\u03b1 =\n\n    \nIri1 u \u03b1 i2\u2192i1 \u00b7 \u00b7 \u00b7 u\u03b1id\u03b1\u2192i1 u\u03b1i1\u2192i2 Iri2 \u00b7 \u00b7 \u00b7 u\u03b1id\u03b1\u2192i2\n... ...\n. . . ...\nu\u03b1id1\u2192id\u03b1 u\u03b1id2\u2192id\u03b1 \u00b7 \u00b7 \u00b7 Iri d\u03b1\n\n     . (18)\nWe also define w\u03b1i\u2192j by the elements of W\u03b1 = U \u22121 \u03b1 :\nW\u03b1 =\n\n    \nw\u03b1i1\u2192i1 w \u03b1 i2\u2192i1 \u00b7 \u00b7 \u00b7 w\u03b1id\u03b1\u2192i1 w\u03b1i1\u2192i2 w \u03b1 i2\u2192i2\n\u00b7 \u00b7 \u00b7 w\u03b1id\u03b1\u2192i2 ... ... . . .\n... w\u03b1id1\u2192id\u03b1 w\u03b1id2\u2192id\u03b1 \u00b7 \u00b7 \u00b7 w\u03b1id\u03b1\u2192id\u03b1\n\n     . (19)\nSimilar to the definition of X( ~E) in Subsection 3.1, we define X(V ) as the set of functions on V that takes value on Cri for each i \u2208 V .\nTheorem 7 (Determinant formula of Ihara-Bass type) Let D be W are linear transforms on X(V ) defined by\n(Dg)(i) := dig(i), (Wg)(i) := \u2211\ne,e\u2032\u2208~E t(e)=i,s(e)=s(e\u2032)\nw s(e) t(e\u2032)\u2192ig(t(e \u2032)). (20)\nThen, we have the following formula\n\u03b6G(u) \u22121 = det\n( IrV \u2212D +W )\n\u220f\n\u03b1\u2208F\ndetU\u03b1,\nwhere rV := \u2211 i\u2208V ri\nThe proof is given in Appendix A.2"}, {"heading": "3.3 Ihara-Bass type determinant formula on ordinary graphs", "text": "In this subsection, we explicitly write definitions and the above formula for better understanding. A hypergraph H = (V, F ), which has only hyperedges of degrees two, is naturally identified with an (undirected) graph GH = (V,E). In the next section, we see that this case corresponds to the pairwise inference family.\nFirst, we define the zeta function ZG of a graph G = (V,E). For each undirected edge, we make a pair of oppositely directed edges, which form a set of directed edges ~E. Thus | ~E| = 2|E|. For each directed edge e \u2208 ~E, o(e) \u2208 V is the origin of e and t(e) \u2208 V is the terminus of e. For e \u2208 ~E, the inverse edge is denoted by e\u0304, and the corresponding undirected edge by [e] = [e\u0304] \u2208 E.\nA closed geodesic in G is a sequence (e1, . . . , ek) of directed edges such that t(ei) = o(ei+1), ei 6= e\u0304i+1 for i \u2208 Z/kZ. Prime cycles are defined in the same manner to that of hypergraphs. The set of prime cycles is denoted by PG.\nDefinition 8 Let G = (V,E) a graph. For given positive integers {ri}i\u2208V and matrix weights u = {ue}e\u2208 ~E with ue \u2208 M(rt(e), ro(e)),\nZG(u) := \u220f\np\u2208PG\ndet(1\u2212 \u03c0(p))\u22121, \u03c0(p) := ue1 \u00b7 \u00b7 \u00b7 uek for p = (e1, . . . , ek).\nSince PGH is naturally identified with PH , ZGH = \u03b6H holds. This zeta function is the matrix weight extension of the edge zeta function analyzed by Stark and Terras (1996).\nSince the degree of every hyperedge is equal to two for a graph, the matrix W\u03b1 defined in Eq. (19) has explicit expressions. Using this fact, we obtain the following simplification of Theorem 7.\nCorollary 9 For a graph G = (V,E),\nZG(u) \u22121 = det(I + D\u0302(u)\u2212 A\u0302(u))\n\u220f\n[e]\u2208E\ndet(I \u2212 ueue\u0304), (21)\nwhere D\u0302 and A\u0302 are defined by\n(D\u0302(u)g)(i) := ( \u2211\ne:t(e)=i\n(Iri \u2212 ueue\u0304)\u22121ueue\u0304 ) g(i), (22)\n(A\u0302(u)g)(i) := \u2211\ne:t(e)=i\n(Iri \u2212 ueue\u0304)\u22121ueg(o(e)). (23)\nProof For e = (i \u2192 j), the U[e] block is given by\nU[e] =\n[\nIri ue ue\u0304 Irj\n]\nTherefore detU[e] = det(Iri \u2212 ueue\u0304) and the inverse W[e] is\nW[e] =\n[\n(Iri \u2212 ueue\u0304)\u22121 0 0 (Irj \u2212 ue\u0304ue)\u22121\n] [\nIri \u2212ue \u2212ue\u0304 Irj\n]\n.\nPlugging these equations into Theorem 7, we obtain the assertion.\nMizuno and Sato (2004); Horton et al. (2008) have derived a weighted graph version of Ihara-Bass type determinant formula under assumption that the scalar weights {ue} satisfy conditions ueue\u0304 = u\n2. In this case, the factors (1\u2212ueue\u0304)\u22121 in Eqs. (22,23) do not depend on e and Eq. (21) is further simplified. Corollary 9 gives the extension of the result to graphs with arbitrary weights. A direct proof of Corollary 9, without discussing hypergraphs, is found in the supplementary material of Watanabe and Fukumizu (2009).\nIf all the weights are set to u, the result reduces to the following formula known as Ihara-Bass formula:\nZG(u) \u22121 = (1\u2212 u2)|E|\u2212|V | det(I \u2212 uA+ u2(D \u2212 I)),\nwhere D is the degree matrix defined by Di,j = di\u03b4i,j, and A is the adjacency matrix by\nAi,j = { 1 if {i, j} \u2208 E 0 otherwise.\nMany authors have discussed the proof of the Ihara-Bass formula. The first proof was given by Bass (1992). See Kotani and Sunada (2000); Stark and Terras (1996) for others. A combinatorial proof is given by Foata and Zeilberger (1999)."}, {"heading": "3.4 Positive definiteness condition", "text": "The Ihara-Bass type determinant formula relates the matrices M(u) and (IrV \u2212 D +W). In the later sections, we see that M(u) corresponds to the derivative of the LBP update and (IrV \u2212D +W) is closely related to the Hessian of the Bethe free energy function.\nThe following theorem is fundamental to prove Theorem 14.\nTheorem 10 Assume that u = {u\u03b1i\u2192j}\u03b1\u2208F,i,j\u2208\u03b1 satisfies u\u03b1i\u2192j = u\u03b1j\u2192i and \u2016u\u03b1i\u2192j\u2016 < 1, where \u2016 \u00b7 \u2016 is an arbitrary operator norm. If Spec(M(u)) \u2282 C r R\u22651, where Spec(\u00b7) denotes the set of eigenvalues, then (IrV \u2212D +W) is a positive definite matrix. Proof From the assumption of symmetry, W\u03b1 in Eq. (19) is a symmetric matrix. Therefore, W, defined in Eq. (20), is also symmetric. To prove the positive definiteness, we define u\u03b1i\u2192j(t) := tu \u03b1 i\u2192j (t \u2208 [0, 1]), which implies M(u(t)) = tM(u). From the assumption, U\u03b1(t) is invertible and thus W\u03b1(t) is well defined for all t. If t = 0, W\u03b1(0) = D and I \u2212 D + W(0) = I is obviously positive definite. Since the eigenvalues of a symmetric matrix are real and continuous with respect to its entries, it is enough to prove that det(I \u2212 D + W(t)) 6= 0 on the interval [0, 1]. Under the condition on the eigenvalues of M(u), det(I \u2212M(u(t))) 6= 0 holds for t \u2208 [0, 1]. Therefore, Theorem 7 implies the claim."}, {"heading": "4. Main theoretical results", "text": "In this section, we establish the connection between the graph zeta function and the Bethe free energy function. These results form a basis of the analyses in later sections.\nIn Subsection 4.1, we prove a formula using the Ihara-Bass type determinant formula proved in the previous section. The formula shows a concrete relation between the Bethe free energy function and the graph zeta function. In Subsection 4.2, we give a condition that the Hessian of the Bethe free energy function is positive-definite."}, {"heading": "4.1 Bethe-zeta formula", "text": "In this subsection, we show that the determinant of the Hessian of the Bethe free energy function is essentially equal to the reciprocal of the graph zeta function6.\nIn order to make the assertion clear, we first recall the definitions and notations. Let H = (V, F ) be a hypergraph and let I = {E\u03b1, Ei} be an inference family on H. Exponential families Ei and E\u03b1 are given by sufficient statistics \u03c6i and \u03c6\u03b1 as discussed in Subsection 2.2.1. Furthermore, as discussed in Subsection 2.3, a point \u03b7 = {\u03b7\u3008\u03b1\u3009, \u03b7i} \u2208 L is identified with a set of pseudomarginals {b\u03b1(x\u03b1), bi(xi)}\u03b1\u2208F,i\u2208V .\nTheorem 11 At any point of \u03b7 = {\u03b7\u3008\u03b1\u3009, \u03b7i} \u2208 L the following equality holds.\n\u03b6H(u) \u22121= det(I \u2212M(u)) = det(\u22072F )\n\u220f\n\u03b1\u2208F\ndet(Varb\u03b1 [\u03c6\u03b1]) \u220f\ni\u2208V\ndet(Varbi [\u03c6i]) 1\u2212di ,\nwhere u\u03b1i\u2192j := Varbj [\u03c6j ] \u22121Covb\u03b1 [\u03c6j , \u03c6i] (24)\nis an rj\u00d7ri matrix, and \u22072F is the Hessian matrix with respect to the coordinate {\u03b7\u3008\u03b1\u3009, \u03b7i}.\nNote that he Hessian \u22072F does not depend on the given compatibility functions \u03a8\u03b1 because those only affect linear terms in F , and thus the formula is a property of inference family I. Note also that the determinants of variances in the formula are always positive, because we assume all the local exponential families E\u03b1 and Ei have positive definite covariance matrices.\nThe proof is based on the Ihara-Bass type determinant formula; we check that the Hessian \u22072F is related to the matrix (I \u2212D+W) if weights has the form of Eq. (24). The key condition satisfied on the set L is Varb\u03b1 [\u03c6i] = Varbi [\u03c6i]. Proof From the definition of the Bethe free energy function Eq. (16), the (V,V)- block of \u22072F is given by\n\u22022F\n\u2202\u03b7i\u2202\u03b7i =\n\u2211\n\u03b1\u220bi\n\u22022\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7i + (1\u2212 di) \u22022\u03d5i \u2202\u03b7i\u2202\u03b7i , \u22022F \u2202\u03b7i\u2202\u03b7j = \u2211\n\u03b1\u2283{i,j}\n\u22022\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7j (i 6= j).\nThe (V,F)-block and (F,F)-block are given by\n\u22022F\n\u2202\u03b7i\u2202\u03b7\u3008\u03b1\u3009 = \u22022\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7\u3008\u03b1\u3009 , \u22022F \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b2\u3009 = \u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b2\u3009 \u03b4\u03b1,\u03b2 .\nUsing the diagonal blocks of (F,F)-block, we erase (V,F)-block and (F,V)-block of the Hessian by Gaussian elimination. In other words, we choose a square matrix X such that\n6. An intuitive understanding of this result, based on the Legendre duality of two types of the Bethe free energy functions is discussed by Watanabe (2010)\ndetX = 1 and\nXT (\u22072F )X = [ Y 0\n0 ( \u22022F \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b2\u3009 )\n]\n,\nin which\nYi,i = \u2211\n\u03b1\u220bi\n{\n\u22022\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7i \u2212 \u2202 2\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7\u3008\u03b1\u3009\n(\n\u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b1\u3009 )\u22121 \u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7i\n}\n+ (1\u2212 di) \u22022\u03d5i \u2202\u03b7i\u2202\u03b7i , (25)\nYi,j = \u2211\n\u03b1\u2283{i,j}\n{\n\u22022\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7j \u2212 \u2202 2\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7\u3008\u03b1\u3009\n(\n\u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b1\u3009 )\u22121 \u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7j\n}\n. (26)\nOn the other hand, since u\u03b1i\u2192j := Varbj [\u03c6j ] \u22121 Covb\u03b1 [\u03c6j , \u03c6i], the matrix U\u03b1 defined in Eq. (18) is\nU\u03b1 = diag(Var[\u03c6i] \u22121|i \u2208 \u03b1) Varb\u03b1 [(\u03c6i)i\u2208\u03b1]. (27)\nSince the matrix Varb\u03b1 [(\u03c6i)i\u2208\u03b1] is a submatrix of Varb\u03b1 [\u03c6\u03b1], its inverse can be expressed by submatrices of Varb\u03b1 [\u03c6\u03b1] \u22121 = \u2202 2\u03d5\u03b1 \u2202\u03b7\u03b1\u2202\u03b7\u03b1 using the Schur complement formula, which shows that the elements of W\u03b1 = U \u22121 \u03b1 is given by\nw\u03b1j\u2192i =\n{\n\u22022\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7j \u2212 \u2202 2\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7\u3008\u03b1\u3009\n(\n\u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b1\u3009 )\u22121 \u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7j\n}\nVar[\u03c6j ]. (28)\nIt follows from Eq. (25),(26) and (28) that\nY diag (Var[\u03c6i]|i \u2208 V ) = I \u2212D +W,\nwhere D and W are defined in Eq. (20). Accordingly, we obtain\n\u03b6H(u) \u22121 = det(I \u2212D +W)\n\u220f\n\u03b1\u2208F\ndetU\u03b1\n= detY \u220f\ni\u2208V\ndet(Var[\u03c6i]) \u220f\n\u03b1\u2208F\ndet (Varb\u03b1 [(\u03c6i)i\u2208\u03b1]) \u220f\nj\u2208\u03b1 det (Var[\u03c6j ])\n= det ( \u22072F )\n\u220f\ni\u2208V\ndet(Var[\u03c6i]) 1\u2212di\n\u220f\n\u03b1\u2208F\ndet (Varb\u03b1 [(\u03c6i)i\u2208\u03b1])\ndet ( \u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b1\u3009 )\n= det ( \u22072F )\n\u220f\n\u03b1\u2208F\ndet(Varb\u03b1 [\u03c6\u03b1]) \u220f\ni\u2208V\ndet(Varbi [\u03c6i]) 1\u2212di ,\nwhere det (Varb\u03b1 [(\u03c6i)i\u2208\u03b1]) det ( \u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b1\u3009 )\u22121 = det (Var[\u03c6\u03b1]) is used.\nIn the rest of this subsection, we rewrite the Bethe-zeta formula in some specific cases. Especially, we give explicit expressions of the determinants of the variance matrices.\nCase 1: Multinomial inference family\nFirst, we consider the multinomial case. If we take the sufficient statistics of multinomial exponential family as in Example 1, the determinant of the variance is\ndet (Varp[\u03c6]) = N \u220f\nk=1\np(k).\nTherefore, the theorem reduces to the following form 7.\nCorollary 12 (Bethe-zeta formula for multinomial inference family) For any {b\u03b1(x\u03b1), bi(xi)} \u2208 L the following equality holds.\n\u03b6G(u) \u22121= det(\u22072F )\n\u220f\n\u03b1\u2208F\n\u220f\nx\u03b1\nb\u03b1(x\u03b1) \u220f\ni\u2208V\n\u220f\nxi\nbi(xi) 1\u2212di ,\nwhere u\u03b1i\u2192j := Varbj [\u03c6j ] \u22121 Covb\u03b1 [\u03c6j , \u03c6i] is an (Nj \u2212 1)\u00d7 (Ni \u2212 1) matrix.\nFor binary and pairwise case, this formula is first shown by Watanabe and Fukumizu (2009).\nCase 2: Fixed-mean Gaussian inference family\nLet G = (V,E) be a graph. We consider the fixed-mean Gaussian inference family on G. For a given vector \u00b5 = (\u00b5i)i\u2208V , the inference family is constructed from sufficient statistics \u03c6i(xi) = (xi\u2212\u00b5i)2 and \u03c6\u3008i,j\u3009(xi, xj) = (xi\u2212\u00b5i)(xj \u2212\u00b5j). Their expectation parameters are denoted by \u03b7ii and \u03b7ij , respectively. The variances and covariances are\nVar[\u03c6i] = 2\u03b7 2 ii, Var[\u03c6{i,j}] =\n\n\n2\u03b72ii 2\u03b7 2 ij 2\u03b7ii\u03b7ij 2\u03b72ij 2\u03b7 2\njj 2\u03b7jj\u03b7ij 2\u03b7ii\u03b7ij 2\u03b7jj\u03b7ij \u03b7 2 ij + \u03b7ii\u03b7jj\n\n ,\nwhere \u03c6{i,j}(xi, xj) = ( (xi \u2212 \u00b5i)2, (xj \u2212 \u00b5j)2, (xi \u2212 \u00b5i)(xj \u2212 \u00b5j) )\n. Therefore, det(Var[\u03c6{i,j}]) = 4(\u03b7ii\u03b7jj \u2212 \u03b72ij)3.\nCorollary 13 [Bethe-zeta formula for fixed-mean Gaussian inference family ] For any {\u03b7ii, \u03b7ij} \u2208 L the following equality holds.\nZG(u) \u22121= det(\u22072F )\n\u220f\ni\u2208V\n\u03b7 2(1\u2212di) ii\n\u220f\nij\u2208E\n(\u03b7ii\u03b7jj \u2212 \u03b72ij)3 2|V |,\nwhere ui\u2192j := \u03b7 2 ij\u03b7 \u22122 jj is a scalar value.\nOne interesting point of this case is that the edge weights ui\u2192j are always positive.\n7. Here, we ignore minor constant factors which come from the choices of sufficient statistics"}, {"heading": "4.2 Positive definiteness condition", "text": "In this section, we derive a condition that guarantees the positive-definiteness of the Hessian of the Bethe free energy function. It is based on Theorem 10, which gives a condition that the matrix (I \u2212D +W) is positive definite in terms of the matrix M(u). As we have seen in the proof of the previous theorem, \u22072F and (I\u2212D+W) are essentially the same. Thus, we obtain the following theorem.\nTheorem 14 Let u be given by \u03b7 \u2208 L using Eq. (24). Then,\nSpec(M(u)) \u2282 Cr R\u22651 =\u21d2 \u22072F (\u03b7) is a positive definite matrix.\nBefore the proof of the theorem, we remark the following fact. It implies that we can change the matrix weight to the correlation coefficient matrices.\nLemma 15 Let \u03b7 be a point in L, u\u03b1i\u2192j be given by Eq. (24), and\nc\u03b1i\u2192j := Corb\u03b1 [\u03c6j , \u03c6i] = Varb\u03b1 [\u03c6j ] \u22121/2Covb\u03b1 [\u03c6j , \u03c6i]Varb\u03b1 [\u03c6i] \u22121/2\nbe the correlation coefficient matrix, where b\u03b1 corresponds to \u03b7. Then\nSpec(M(u)) = Spec(M(c)). (29)\nProof Define Z by (Z)e,e\u2032 := \u03b4e,e\u2032Var[\u03c6t(e)]1/2. Then\n(ZM(u)Z\u22121)e,e\u2032 = Var[\u03c6t(e)]1/2M(u)e,e\u2032Var[\u03c6t(e\u2032)]\u22121/2 = M(c)e,e\u2032 .\nProof [Theorem 14] By definition, c\u03b1i\u2192j = c \u03b1 j\u2192i holds. We choose the operator norm induced by the inner product of the vector spaces. In other words, \u2016X\u2016 is equal to the maximum singular value of X. In this case, it is well known that the norm of a correlation coefficient matrix is smaller than 1. From Theorem 10, the matrix (I \u2212 D + W) for the weights c = {c\u03b1i\u2192j} is positive definite.\nNext, we compute the matrix (I \u2212 D + W) for the weight c. Similar to Eq. (28), we obtain\nw\u03b1j\u2192i = Var[\u03c6i] 1/2\n{\n\u22022\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7j \u2212 \u2202 2\u03d5\u03b1 \u2202\u03b7i\u2202\u03b7\u3008\u03b1\u3009\n(\n\u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7\u3008\u03b1\u3009 )\u22121 \u22022\u03d5\u03b1 \u2202\u03b7\u3008\u03b1\u3009\u2202\u03b7j\n}\nVar[\u03c6j ] 1/2.\nTherefore, using the same notations as in the proof of Theorem 11, we have\ndiag (Var[\u03c6i]|i \u2208 V )1/2 Y diag (Var[\u03c6i]|i \u2208 V )1/2 = (I \u2212D +W).\nThis equation implies that Y and \u22072F (\u03b7) are positive definite.\nTo check the condition of Theorem 14, we need to analyze the extent of the eigenvalues. An easy way for narrowing down the possible region is to bound the spectral radius. For a given square matrix X, the spectral radius of X is the maximum of the modulus of the eigenvalues; it is denoted by \u03c1(X). The following proposition provides a useful bound. The proof is given in Appendix A.2.\nProposition 16 Let u = {u\u03b1i\u2192j} be arbitrary matrix weights and let \u2016u\u2016 = {\u2016u\u03b1i\u2192j\u2016} be the scalar weights obtained by an arbitrary operator norm. Then,\n\u03c1(M(u)) \u2264 \u03c1( M(\u2016u\u2016) ) \u2264 max \u2016u\u03b1i\u2192j\u2016 \u03c1(M)"}, {"heading": "5. Analysis of positive definiteness and convexity of BFE", "text": "The Bethe free energy function is not necessarily convex though it is an approximation of the Gibbs free energy function, which is convex. Non-convexity of the Bethe free energy can lead to multiple fixed points. Pakzad and Anantharam (2002) and Heskes (2004) have derived sufficient conditions of the convexity and shown that the Bethe free energy is convex for trees and graphs with one cycle. In this section, not only such a global structure, we shall focus on the local structure of the Bethe free energy function, i.e. the Hessian. Our approach derives the region where the positive definiteness is broken. All the results are based on the techniques developed in the previous section.\nIn Subsection 5.1, as an application of the positive definite condition, we analyze the region where the Hessian of Bethe free energy function is positive definite. The Hessian does not depend on the given compatibility function, \u03a8, because it appears in the linear part of the Bethe free energy function. In Subsection 5.2, we deal with the compatibility functions by restricting the Bethe free energy function on a subset S(\u03a8) of L. This set consists of the pseudomarginals that has natural parameters {\u03b8\u0304\u3008\u03b1\u3009} and thus includes all the fixed point beliefs. We will see that the problem of the uniqueness of the LBP fixed points is reduced to the following problem: is the subset S(\u03a8) included in the positive definite region of the original Bethe free energy function?"}, {"heading": "5.1 Region of positive definite and convexity condition", "text": "In this subsection, we simplify Theorem 14 and explicitly see that if the correlation coefficient matrices of the pseudomarginals are sufficiently small, then the Hessian is positive definite. This \u201csmallness\u201d criteria depends on graph geometry.\nIn the following, we choose the operator norm that is equal to the maximum singular value. It is well known that the norm of a correlation coefficient matrix is smaller than 1 under the assumption that the variance-covariance matrix is non-degenerate.\nCorollary 17 (Positive definite region) Let \u03ba be the Perron-Frobenius eigenvalue of M, and define\nL\u03ba\u22121(I) := { {b\u03b1(x\u03b1), bi(xi)} \u2208 L(I) | \u2200\u03b1 \u2208 F, \u2200i, j \u2208 \u03b1, \u2016Corb\u03b1 [\u03c6i, \u03c6j ]\u2016 < \u03ba\u22121 } .\nThen, the Hessian \u22072F is positive definite on L\u03ba\u22121(I).\nProof From Proposition 16 and max \u2016c\u03b1i\u2192j\u2016 \u03ba < 1, Spec(M(c)) \u2282 {\u03bb \u2208 C| |\u03bb| < 1}. Therefore, from Theorem 14, the Hessian is positive definite at the point.\nA bound of the Perron-Frobenius eigenvalue of M is given in Subsection A.1. Roughly speaking, as the degrees of factors and vertices increase, \u03ba also increases and thus L\u03ba\u22121\nshrinks. The Perron-Frobenius eigenvalue is equal to 0 (resp. 1) if the hypergraph is a tree (resp. has a unique cycle). This result suggests that LBP works better for graphs of low degree.\nThe convexity of F depends solely on the given inference family and the underlying hypergraph, because the Hessian\u22072F does not depend on the given compatibility functions, \u03a8 = {\u03a8\u03b1}. For multinomial case, Pakzad and Anantharam (2002) have shown that the Bethe free energy function is convex if the hypergraph has at most one cycle. The following theorem extends the result. To show the direction of (i) we have only to analyze the Bethe free energy function on trees and one-cycle hypergraphs. To show (ii), however, we need to capture the effect of cycles on arbitrary hypergraphs.\nTheorem 18 Let H be a connected hypergraph. (i) If n(H) = 0 or 1, then F is convex on L. (ii) Assuming the inference family is either a multinomial, Gaussian or fixed-mean Gaussian, then the converse of (i) holds.\nProof (i) As we have mentioned above, the Perron-Frobenius eigenvalue \u03b1 of M is equal to 1 if n(H) = 0 and 0 if n(H) = 1. Using Corollary 17, we obtain L\u03b1\u22121 = L. Therefore, the Bethe free energy function is convex over the domain L. (ii) Here we show the proof only in the case of fixed-mean Gaussian. (Other cases are proved by a similar way in Appendix A.2.) Let G = (V,E) be a graph. For t \u2208 [0, 1), define \u03b7ii(t) := 1 and \u03b7ij(t) := t. Accordingly, u ij i\u2192j = t\n2 and \u03b7(t) \u2208 L. As t \u0580 1, \u03b7(t) approaches to a boundary point of L. From Theorem 27 in Appendix A.1,\ndet(\u22072F (t))(1 \u2212 t2)2|E|+|V |\u22121 = 2\u2212|V |ZG(t2)\u22121(1\u2212 t2)\u2212|E|+|V |\u22121\n\u2212\u2192 \u22122|E|\u22122|V |+1(|E| \u2212 |V |)\u03ba(G) (t \u2192 1).\nIf n(G) = |E| \u2212 |V | + 1 > 1, the limit value is negative. Therefore, in a neighborhood of the limit point, \u22072F is not positive definite."}, {"heading": "5.2 Convexity of restricted Bethe free energy function", "text": "Our analysis so far has not involved the given compatibility function, because it disappears in the second derivatives. Not only graph structure, however, but also the compatibility functions affect the properties of LBP and the Bethe free energy.\nIn this section, we show a method for dealing with the compatibility functions. We see that the understanding of the positive definite region helps us to deduce a uniqueness condition of LBP."}, {"heading": "5.2.1 Restricted Bethe free energy function", "text": "First, we make simple observations. Since beliefs are given by Eq. (10,11), they must satisfy the following condition: for each factor \u03b1, there exists {\u03b8\u2032\u03b1i }i\u2208\u03b1 such that\nb\u03b1(x\u03b1) \u221d exp(\u3008\u03b8\u0304\u03b1, \u03c6\u03b1\u3009+ \u2211\ni\u2208\u03b1\n\u3008\u03b8\u2032\u03b1i , \u03c6i(xi)\u3009),\nwhere \u03b8\u0304\u03b1 is the natural parameter of \u03a8\u03b1. (See Eq. (6).) In other words, we can say that all the beliefs are always in the following subset of L:\nS(\u03a8) := { {\u03b7\u03b1, \u03b7i} \u2208 L | \u2200\u03b1 \u2208 F, \u039b\u22121\u03b1 (\u03b7\u03b1)\u3008\u03b1\u3009 = \u03b8\u0304\u3008\u03b1\u3009 } .\nWe can take a coordinate {\u03b7i}i\u2208V of S(\u03a8) because \u03b7\u03b1 is determined by {\u03b7i}i\u2208\u03b1. We obtain a function by restricting F on the set and taking \u03b7\u03b1 as arguments. The function is called restricted Bethe free energy function and denoted by F\u0302 . The following proposition says that the stationary points of F\u0302 also correspond to the LBP fixed points. (This fact can be also stated as \u201cthe fixed points of LBP are the stationary points of the Bethe free energy function.\u201d)\nProposition 19\n\u2202F\u0302 ({\u03b7i}) \u2202\u03b7j = 0 \u2200j \u2208 V \u21d0\u21d2 {\u03b7i} \u2208 S(\u03a8) is an LBP fixed point.\nProof Using the chain rule of derivatives, we have\n\u2202F\u0302 \u2202\u03b7j = \u2202F \u2202\u03b7j + \u2211\n\u03b1\u220bi\n\u2202F\n\u2202\u03b7\u3008\u03b1\u3009\n\u2202\u03b7\u3008\u03b1\u3009\n\u2202\u03b7j .\nFrom the definition of F and S(\u03a8), we have \u2202F\u2202\u03b7\u3008\u03b1\u3009 = 0 on the set S(\u03a8). Therefore, all the derivatives of F are equal to zero if and only if those of F\u0302 are zero."}, {"heading": "5.2.2 Convexity condition and uniqueness", "text": "In the following, we analyze the (strict) convexity of the restricted Bethe free energy function. Our focus is multinomial models. As a result, we provide a new condition that guarantee the uniqueness. From Proposition 19, the LBP fixed point is unique if F\u0302 is strictly convex.\nFrom the viewpoint of approximate inference, the uniqueness of LBP fixed point is a preferable property. Since LBP algorithm is interpreted as the variational problem of the Bethe free energy function, an LBP fixed point that correspond to the global minimum is believed to be the best one. If we find the unique fixed point of the LBP algorithm, it is guaranteed to be the global minimum of F .\nTo understand the convexity of F\u0302 , we analyze the Hessian. It turns out that the positive definiteness of the Hessian of this function is equivalent to the Hessian of F . Note that the Hessian of F\u0302 is of size \u201cV \u201d while that of F is of size \u201cV + F\u201d.\nProposition 20 At any points in the set S(\u03a8),\n\u22072F\u0302 is positive definite \u21d0\u21d2 \u22072F is positive definite.\nProof By taking the derivative of the equation \u2202F\u2202\u03b7\u3008\u03b1\u3009 = 0 on the set S(\u03a8), we obtain\n\u22022F\n\u2202\u03b7i\u2202\u03b7\u3008\u03b1\u3009 +\n\u2211\n\u03b2\n\u2202\u03b7\u3008\u03b2\u3009\n\u2202\u03b7i\n\u22022F\n\u2202\u03b7\u3008\u03b2\u3009\u2202\u03b7\u3008\u03b1\u3009 = 0.\nThis equation can be written as ( \u2202\u03b7\u3008\u03b2\u3009 \u2202\u03b7i ) = \u2212X\u22121F,FXF,V using a notation\n\u22072F = [\nXV,V XV,F XF,V XF,F\n]\n.\nA straightforward computation of the derivatives of F\u0302 gives \u22072F\u0302 = XV,V \u2212XV,FX\u22121F,FXF,V , where we used the above equation. Since the block XF,F is always positive definite, the statement is obvious.\nIf we can verify that the set S(\u03a8) is in the region where \u22072F is positive definite, we can show that F\u0302 is convex. Using Theorem 14, we obtain the following.\nTheorem 21 Define\nW\u03b1i,j(\u03a8) := sup { \u2016Corb\u03b1 [\u03c6i, \u03c6j ]\u2016 | b\u03b1(x\u03b1) \u221d \u03a8\u03b1(x\u03b1) \u220f\ni\u2208\u03b1\nfi(xi), fi are positive functions of xi\n}\n."}, {"heading": "If \u03c1(M(W )) < 1 then F\u0302 is strictly convex. Therefore, LBP has the unique fixed point.", "text": "Proof Let \u03b7 be any point in S(\u03a8). By definition, \u2016Corb\u03b1 [\u03c6i, \u03c6j ]\u2016 is smaller than W\u03b1i,j. From Theorem 14 and Proposition 16, \u22072F\u0302 is positive definite at the point.\nIn principle, we can compute the weights, W , given the compatibility functions. However, it requires optimizations with respect to f ; we can use standard numerical maximization techniques (Venkataraman, 2009). We leave developing efficient methods for computing the values for future works. For binary pairwise case, we have a useful formulaW {i,j} i,j (\u03a8i,j) = tanh(|Jij |), where \u03a8i,j(xi, xj) \u221d eJijxixj+hixi+hjxj (Watanabe and Fukumizu, 2009). Theorem 21 holds for an arbitrary LBP. However, for Gaussian cases we obtain W\n{i,j} i,j =\n1, yielding no meaningful implications. Therefore, in the rest of this section, we focus on multinomial cases."}, {"heading": "5.2.3 Comparison to Mooij\u2019s condition", "text": "For multinomial models, there are several works that give sufficient conditions for the uniqueness property. Heskes (2004) analyzed the uniqueness problem by considering an equivalent min-max problem. Other authors analyzed the convergence property rather than the uniqueness. LBP algorithm is said to be convergent if the messages converge to the unique fixed point irrespective of the initial messages. By definition, this property is stronger than the uniqueness. Tatikonda and Jordan (2002) utilized the theory of Gibbs measure, and showed that the uniqueness of the Gibbs measure implies the convergence of LBP algorithm. Therefore, known sufficient conditions of the uniqueness of\nthe Gibbs measure are that of the convergence of LBP algorithm. Ihler et al. (2006) and Mooij and Kappen (2007) derived sufficient conditions for the convergence by investigating conditions that make the LBP update a contraction; for pairwise case, their conditions are essentially the same.\nWe compare our condition with Mooij\u2019s condition. One reason is that this condition is directly applicable to factor graph models, while Ihler\u2019s and Tatikonda\u2019s conditions are for written for pairwise models. Another reason is that numerical experiments by Mooij and Kappen (2007) suggests that Mooij\u2019s condition is far superior to the condition of Heskes. (See numerical experiments in (Mooij and Kappen, 2007).)\nThe Mooij\u2019s condition is stated as follows.\nTheorem 22 (Mooij and Kappen (2007)) Define\nNij(\u03a8\u03b1) := sup xi 6=x\u2032i sup xj 6=x\u2032j sup x\u03b1ij 6=x \u2032 \u03b1ij\ntanh (1\n4 log\n\u03a8\u03b1(xi, xj , x\u03b1ij ) \u03a8\u03b1(x\u2032i, x \u2032 j , x \u2032 \u03b1ij )\n\u03a8(x\u2032i, xj , x\u03b1ij ) \u03a8(xi, x\u2032j , x \u2032 \u03b1ij ) ) , \u03b1ij = \u03b1\\{i, j}."}, {"heading": "If \u03c1(M(N )) < 1, then LBP is convergent. Therefore, LBP has a unique fixed point.", "text": "Interestingly, this condition looks similar to our Theorem 21; both of them are stated in terms of the spectral radius of the directed edge matrix, M, with weights. Comparison of these condition is reduced to that of Wij(\u03a8\u03b1) and Nij(\u03a8\u03b1). (Recall that for positive matrices X and Y , \u03c1(X) \u2264 \u03c1(Y ) if Xij \u2264 Yij. ) For binary pairwise case, the conditions coincide; it is not hard to check that Wij = Nij = tanh(|Jij |).\nBy numerical computation, we conjecture that Wij(\u03a8\u03b1) \u2264 Nij(\u03a8\u03b1) always holds. In Figure 7, we show a plot for the case of \u03a8(x1, x2, x3) = exp(Kx1x2x3 + 0.3 \u2211\nxixj), where xi \u2208 {\u00b11}. We observe that W and N coincides for large |K|, but W is strictly smaller than N for small |K|.\nNext, we compare conditions of Theorem 21, 22 and the actual LBP convergence region. We run the LBP algorithm on the 3 \u00d7 3 square grid of cyclic boundary condition, where the factors correspond to the vertices of the grid and variables are on the edges. Thus, the degree of factors is four and that of vertices is two. The variables are binary (xi \u2208 {\u00b11}) and compatibility functions are given in the form of \u03a8(x1, x2, x3, x4) = exp(K \u2211\ni<j<k xixjxk + J \u2211\ni<j xixj); we changed the parameters K and J . All the messages are initialized to constant functions and updated in parallel by Eq. (9). The result is plotted in Figure 7. We judge LBP is convergent if message change is smaller than 10\u22123 after 30 iterations. We observe that there is a triangle region where uniqueness is guaranteed but LBP does not converge."}, {"heading": "6. Analysis of stability of LBP", "text": "In this section, we analyze relations between the local stability of LBP and the local structure of the Bethe free energy around an LBP fixed point. Since LBP is not the gradient descent of the Bethe free energy function, such a relation is not necessarily obvious. From the view point of the variational formulation, we hope to find the minima. In the celebrated paper by Yedidia et al. (2001), they empirically found that locally stable LBP fixed points\nare local minima of the Bethe free energy function; Heskes (2002) have shown the fact for multinomial case.\nIn the following, we extend the result to two directions. First, we derive the conditions of the local stability and local minimality in terms of the eigenvalues of the matrixM(u), which immediately implies the above fact. Secondly, the result is extended to LBPs formulated by inference family including both multinomial and Gaussian cases. This is possible, since our analysis is based on the techniques developed in Section 4."}, {"heading": "6.1 LBP as a dynamical system", "text": "First, we regard the LBP update as a dynamical system. At each time t, the state of the algorithm is specified by the set of messages {mt\u03b1\u2192i}, which is identified with its natural parameters \u00b5t = {\u00b5t\u03b1\u2192i} \u2208 R\n~E. In terms of the parameters, the update rule Eq. (9) is written as follows.\n\u00b5t+1\u03b1\u2192i = \u039b \u22121 i\n(\n\u039b\u03b1(\u03b8\u0304\u03b1, \u03b8\u0304 \u03b1 i1 +\n\u2211\n\u03b2\u2208Ni1r\u03b1\n\u00b5t\u03b2\u2192i1 , . . . , \u03b8\u0304 \u03b1 ik +\n\u2211\n\u03b2\u2208Nikr\u03b1\n\u00b5t\u03b2\u2192ik)i\n)\n\u2212 \u2211\n\u03b3\u2208Nir\u03b1\n\u00b5t\u03b3\u2192i,\nwhere \u03b1 = {i1, . . . , id\u03b1}, d\u03b1 = k and \u039b\u03b1(\u00b7 \u00b7 \u00b7 )i is the i-th component (i \u2208 \u03b1). To obtain this equation, after multiply Eq. (9) by\n\u220f\n\u03b3\u2208Nir\u03b1\nmt\u03b3\u2192i(xi),\nnormalize it to be a probability density function, and then take the expectation of \u03c6i.\nFormally, this update rule can be viewed as a transform T on the set of natural parameters of messages M :\nT : M \u2212\u2192 M, \u00b5t = T (\u00b5t\u22121).\nLBP algorithm can be formulated as repeated applications of this map. In this formulation, the fixed points of LBP are {\u00b5\u2217 \u2208 M |\u00b5\u2217 = T (\u00b5\u2217)}.\nHere we compute the differentiation of the update map T around an LBP fixed point. This expression derived by Ikeda et al. (2004) for the cases of turbo and LDPC codes.\nTheorem 23 (Differentiation of the LBP update) At an LBP fixed point, the differentiation (linearization) of the LBP update is\n\u2202T (\u00b5)\u03b1\u2192i \u2202\u00b5\u03b2\u2192j =\n{\nVarbi [\u03c6i] \u22121Covb\u03b1 [\u03c6i, \u03c6j ] if j \u2208 N\u03b1 r i and \u03b2 \u2208 Nj r \u03b1, 0 otherwise."}, {"heading": "In other words, at an LBP fixed point \u03b7 \u2208 L, the differentiation of T is", "text": "T \u2032 = M(u),\nwhere u = {u\u03b1i\u2192j} is given by Eq. (24).\nProof First, consider the case that j \u2208 N\u03b1 r i and \u03b2 \u2208 Nj r\u03b1. The derivative is equal to\n\u2202\u039b\u22121i \u2202\u03b7i \u2202(\u039b\u03b1)i \u2202\u03b8\u03b1:j = Varbi [\u03c6i] \u22121Covb\u03b1 [\u03c6i, \u03c6j ].\nAnother case is i = j and \u03b1, \u03b2 \u2208 Ni (\u03b1 6= \u03b2). Then, the derivative is\n\u2202\u039b\u22121i \u2202\u03b7i \u2202(\u039b\u03b1)i \u2202\u03b8\u03b1:i \u2212 I = 0\nbecause Varbi [\u03c6i] = Varb\u03b1 [\u03c6i] from Eq. (13). In other cases, the derivative is trivially zero.\nThe relation j \u2208 N\u03b1 r i and \u03b2 \u2208 Nj r \u03b1 will be written as (\u03b2 \u2192 j) \u21c0 (\u03b1 \u2192 i) in Subsection 3.1. It is noteworthy that the elements of the linearization matrix is explicitly expressed by the fixed point beliefs."}, {"heading": "6.2 Spectral conditions", "text": "Let T be the LBP update map. A fixed point \u00b5\u2217 is called locally stable8 if LBP starting with a point sufficiently close to \u00b5\u2217 converges to \u00b5\u2217. To suppress oscillatory behaviors of LBP, damping of update T\u01eb := (1 \u2212 \u01eb)T + \u01ebI is sometimes useful, where 0 \u2264 \u01eb < 1 is a damping strength and I is the identity matrix.\nAs we will summarize in the following theorem, the local stability is determined by the linearization T \u2032 at the fixed point. Since T \u2032 is nothing but M(u) at an LBP fixed point, Theorem 14 implies relations between the local stability and the Hessian of the Bethe free energy function.\nTheorem 24 Let \u00b5\u2217 be an LBP fixed point and assume that T \u2032(\u00b5\u2217) has no eigenvalues of unit modulus for simplicity. Then the following statements hold.\n8. This property is often referred to as asymptotically stable Guckenheimer and Holmes (1990).\n1. Spec(T \u2032(\u00b5\u2217)) \u2282 {\u03bb \u2208 C||\u03bb| < 1} \u21d0\u21d2 LBP is locally stable at \u00b5\u2217.\n2. Spec(T \u2032(\u00b5\u2217)) \u2282 {\u03bb \u2208 C|Re\u03bb < 1} \u21d0\u21d2 LBP is locally stable at \u00b5\u2217 with some damping.\n3. Spec(T \u2032(\u00b5\u2217)) \u2282 CrR\u22651 \u21d2 \u00b5\u2217 is a local minimum of the Bethe free energy function.\nProof 1. : This is a standard result. (See Guckenheimer and Holmes (1990) for example.) 2. : There is an \u01eb \u2208 [0, 1) that satisfy Spec(T \u2032\u01eb(\u00b5\u2217)) \u2282 {\u03bb \u2208 C||\u03bb| < 1} if and only if Spec(T \u2032(\u00b5\u2217)) \u2282 {\u03bb \u2208 C|Re\u03bb < 1}. 3. : This assertion is a direct consequence of Theorem 14 and 23.\nThis theorem immediately implies that a locally stable LBP fixed point is a local minimum of the Bethe free energy. The theorem applies to both the multinomial and Gaussian cases.\nIt is interesting to ask under which condition a local minimum of the Bethe free energy function is a locally stable fixed point of (damped) LBP. An implicit reason for the empirical success of the LBP algorithm is that LBP finds a \u201cgood\u201d local minimum rather than a local minimum nearby the initial point. The theorem gives a new insight to the question, i.e., the difference between the stable local minima and the unstable local minima in terms of the spectrum of T \u2032(\u00b5\u2217)."}, {"heading": "6.3 Special cases: gaps between stability and local minimality", "text": "Here we focus on two special cases: binary pairwise attractive models and pairwise fixedmean Gaussian models. Note that a binary pairwise graphical model \u03a8 = {\u03a8ij,\u03a8i} is called attractive if Jij \u2265 0, where \u03a8i(xi) = exp(hixi) and \u03a8ij(xi, xj) = exp(Jijxixj) (xi, xj \u2208 {\u00b11}). In these cases, the stable fixed points of LBP and the local minima of Bethe free energy function are less different.\nConsider the following situation: we have continuously parametrized compatibility functions {\u03a8ij(t),\u03a8i(t)}t\u22650, which are constants at t = 0 (e.g. t is a inverse temperature: \u03a8ij(t) = exp(tJijxixj) and \u03a8i(t) = exp(thixi)). Starting from t = 0, we run LBP algorithm for t, find a stable fixed point and use it as initial messages of LBP for t + \u03b4t, where \u03b4t is a sufficiently small positive number. Then we obtain a trajectory of a stable fixed point beliefs: we call it a belief trajectory. It first continuously follow the local minima and then it may jump to another stable fixed point belief at t = t0. The following theorem implies that the stable fixed point becomes unstable by continuous changes of the compatibility functions exactly when the corresponding local minimum becomes a saddle.\nTheorem 25 Suppose that we have a continuously parametrized compatibility functions of attractive binary pairwise model or fixed-mean Gaussian model as above. If the LBP fixed point becomes unstable across t = t0 for the first time following the belief trajectory, then the corresponding local minimum of the Bethe free energy becomes a saddle point across t = t0.\nProof First consider the case of attractive binary pairwise models. From Eq. (11), we see that bij(xi, xj) \u221d exp(Jijxixj + \u03b8ixi + \u03b8jxj) for some \u03b8i and \u03b8j. From Jij \u2265 0, we have Covbij [xi, xj ] \u2265 0, and thus ui\u2192j \u2265 0. When the LBP fixed point becomes unstable,\nthe Perron-Frobenius eigenvalue of M(u) goes over 1, which means det(I \u2212M(u)) crosses 0. From Theorem 11, we see that det(\u22072F ) becomes positive to negative at t = t0. The Gaussian case can be proved analogously. Recall that the weight ui\u2192j are always positive scalars as shown in Corollary 13.\nTheorem 25 extends Theorem 2 of Mooij and Kappen (2005), which discusses only the case of binary pairwise models with vanishing local fields hi = 0 and the trivial fixed point (i.e. Ebi [xi] = 0)."}, {"heading": "7. Summary and discussions", "text": "We have established a connection between graph zeta function, Bethe free energy and loopy belief propagation. We have shown that this connection provides powerful tools for the analysis of Bethe free energy and LBP; key theorems are given in Section 4. In Section 5, based on the theorems, we analyzed the (non) convexity of the Bethe free energy function. Roughly speaking, the positive definite region of Bethe free energy functions shrinks as the Perron-Frobenius eigenvalue of the directed edge matrix becomes large, or equivalently, as the pole of the Ihara zeta function closest to the origin approaches to zero. We have shown that such knowledge can be used to derive the uniqueness property of LBP. In Section 6, we have shown that the local stability of LBP implies local minimality of Bethe free energy as long as LBP is well defined within a class of exponential families. A key observation is that the matrix M(u) is equal to the linearization of the LBP update at LBP fixed points.\nThe Bethe-zeta formula shows that the Bethe free energy function contains information on the graph geometry, especially on the prime cycles. The formula helps extract graph information from the Bethe free energy function. For example we observed that the number of the spanning trees are derived from a limit of the Bethe free energy function. In a sense, the connection between those three objects seems to be natural as all of them becomes \u201ctrivial\u201d if the associated graph structure is a tree. If the associated hypergraph is a tree, zeta function is equal to 1, Bethe free energy function is equal to the Gibbs free energy function and LBP reduces to the original BP, which computes exact marginals in finite steps."}, {"heading": "7.1 Path forward", "text": "In this subsection, we list a few directions of future researches going beyond the results of this paper.\nIn a sequel paper (Watanabe and Fukumizu, 2011), we further exploit the connection between LBP, Bethe free energy and graph zeta function to analyze the LBP fixed point equation, focusing on binary pairwise models. We characterize the class of signed graph on which uniqueness of the LBP fixed point is guaranteed. Note that the signs on the edges represents those of the interactions (i.e. sgn Jij). The condition is contrast to the those of the past researches and the result in Section 5, where the strength of interactions (i.e. |Jij |) are bounded.\nIn Subsection 5.2, we have derived a condition for the convexity for the restricted Bethe free energy function. Unfortunately, the expression of the weight W involves sup operator\nand does not easy to compute directly. We need further consideration to find a way of compute it more easily. The proof of the conjecture W \u2264 N is also an interesting problem.\nThe connection between graph zeta, Bethe free energy and LBP can be extended to a more general class of free energies including fractional and tree-reweighted types (Wiegerinck and Heskes, 2003; Wainwright et al., 2003b). These free energies are obtained by modifying the coefficients in the definition of the Bethe free energy function. The corresponding graph zeta function then becomes the Bartholdi type, which allows cycles with backtracking (Bartholdi, 1999; Iwao, 2006). The relation may be useful to analyze such class of free energies."}, {"heading": "Acknowledgments", "text": "This work was supported in part by Grant-in-Aid for JSPS Fellows 20-993 and Grant-in-Aid for Scientific Research (C) 22300098."}, {"heading": "Appendix A.", "text": "A.1 Miscellaneous properties of one-variable hypergraph zeta function\nThis subsection provides miscellaneous facts related to the one-variable hypergraph zeta functions. In the analyses of this paper, we sometimes reduce the multivariate zeta to the one-variable zeta. Therefore, it is important to understand the one-variable hypergraph zeta \u03b6H(u) and the directed edge matrix M.\nRecall that \u03c1(X) denotes the spectral radius of X. We have the following bounds on the spectral radius of M.\nProposition 26 For e \u2208 ~E, let ke := |{e\u2032 \u2208 ~E; e\u2032 \u21c0 e}|, km = min ke and kM = max ke. Then\nkm \u2264 \u03c1(M) \u2264 kM .\nTherefore, if H is a graph,\nmin i\u2208V di \u2212 1 \u2264 \u03c1(M) \u2264 max i\u2208V di \u2212 1. (30)\nProof Since ke = \u2211 e\u2032 Me,e\u2032 , the bound is trivial from the easy bound on the spectral radius of non-negative matrices. See Theorem 8.1.22 of Horn and Johnson (1990).\nSince the directed matrix M is non-negative, the spectral radius is equal to the PerronFrobenius eigenvalue. The pole of \u03b6H closest to the origin is u = \u03c1(M)\u22121 \u2265 k\u22121M . For the case of Ihara\u2019s zeta function, a bound on the modulus of imaginary poles as well as Eq. (30) are given by Kotani and Sunada (2000).\nFor arbitrary hypergraph, \u03b6H(u) has a pole at u = 1 because det(I \u2212 M) = 0. The following theorem gives the multiplicity of the pole. The original version of this theorem is proved by Hashimoto (1989, 1990).\nTheorem 27 (Hypergraph Hashimoto\u2019s theorem (Hashimoto, 1989; Storm, 2006)) Let \u03c7(H) := |V |+ |F | \u2212 | ~E| be the Euler number of H.\nlim u\u21920\n\u03b6H(u) \u22121(1\u2212 u)\u2212\u03c7(H)+1 = \u03c7(H)\u03ba(BH ),\nwhere \u03ba(BH) is the number of spanning trees of the bipartite graph BH . (BH is the bipartite graph representation of the hypergraph H.)\nProof For a graph G = (V,E), Hashimoto (1989, 1990) proved that\nlim u\u21921\nZG(u) \u22121(1\u2212 u)\u2212|E|+|V |\u22121 = \u22122|E|\u2212|V |+1(|E| \u2212 |V |)\u03ba(G),\nwhere \u03ba(G) is the number of spanning tree of G. A simple proof is given by Northshield (1998). Since there is a one-to-one correspondence between PH and PBH , we have \u03b6H(u) = ZBH ( \u221a u). Then the assertion is proved from the above formula.\nA.2 Detailed Proofs\nProof of Theorem 4 The conditions for stationary points of the Bethe free energy function are \u03b8\u0304\u3008\u03b1\u3009 = \u03b8\u3008\u03b1\u3009 and \u2211\n\u03b1\u220bi(\u2212\u03b8\u0304\u03b1:i + \u03b8\u03b1:i) + (1\u2212 di)\u03b8i = 0. (1. \u21d2 2.) The correspondence from the fixed point message to the stationary point is given by Eqs. (10,11). From this construction, we see that\n\u220f\n\u03b1\u2208F\n\u03a8\u03b1(x\u03b1) \u221d \u220f\n\u03b1\nb\u03b1(x\u03b1) \u220f\ni\nbi(xi) 1\u2212di .\nThis implies the above stationary point conditions. (2. \u21d2 1.) The converse correspondence is given by m\u03b1\u2192i(xi) = exp(\u3008\u03b8i + \u03b8\u0304\u03b1:i \u2212 \u03b8\u03b1:i, \u03c6i\u3009), where {\u03b8\u03b1, \u03b8i} are the natural parameters of the stationary point pseudomarginals {b\u03b1(x\u03b1), bi(xi)}. From this construction and the stationary point conditions, we have\n\u220f\n\u03b2\u2208Ni\nm\u03b2\u2192i(xi) = exp(\u3008\u03b8i, \u03c6i(xi)\u3009) \u221d bi(xi),\n\u03a8\u03b1(x\u03b1) \u220f\ni\u2208\u03b1\n\u220f\n\u03b2\u2208Nir\u03b1\nm\u03b2\u2192i(xi) = exp(\u3008\u03b8\u3008\u03b1\u3009, \u03c6\u3008\u03b1\u3009(x\u03b1)\u3009+ \u2211\ni\u2208N\u03b1\n\u3008\u03b8\u03b1:i, \u03c6i\u3009) \u221d b\u03b1(x\u03b1).\nTherefore, the local consistency condition Eq. (13) implies that\n\u220f\n\u03b2\u2208Ni\nm\u03b2\u2192i(xi) \u221d \u222b \u03a8\u03b1 \u220f\nj\u2208\u03b1\n\u220f\n\u03b2\u2208Njr\u03b1\nm\u03b2\u2192j(xj)d\u03bd\u03b1ri.\nThis is equivalent to the LBP fixed point equation.\nProof of Theorem 6 The following proof proceeds in an analogous manner with Theorem 3 in Stark and Terras (1996). First define a differential operator\nH := \u2211\ne\u2032\u21c0e\n\u2211\nae,ae\u2032\n(ue\u2032\u21c0e)ae,ae\u2032 \u2202\n\u2202(ue\u2032\u21c0e)ae,ae\u2032\nwhere (ue\u2032\u21c0e)ae,ae\u2032 denotes the (ae, ae\u2032) element of the matrix ue\u2032\u21c0e. If we apply this operator to a k product of u terms, it is multiplied by k. Since log \u03b6H(0) = 0 and log det(I\u2212 M(0))\u22121 = 0, it is enough to prove that H log \u03b6H(u) = H log det(I \u2212 M(u))\u22121. Using equations log detX = tr logX and \u2212 log(1\u2212 x) = \u2211\nk\u22651 1 kx k, we have\nH log \u03b6H(u) = H \u2211\np\u2208PH\n\u2212 log det(I \u2212 \u03c0(p))\n= H \u2211\np\u2208PH\n\u2211\nk\u22651\n1 k tr(\u03c0(p)k) (31)\n= \u2211\np\u2208PH\n\u2211\nk\u22651\n|p|tr(\u03c0(p)k) (32)\n= \u2211\nC:closed geodesic\ntr(\u03c0(C)) = \u2211\nk\u22651\ntr(M(u)k).\nFrom Eq. (31) to Eq. (32), notice that H acts as a multiplication of k|p| for each summand. This is because the summand is a sum of degree k|p| terms counting each (ue\u2032\u21c0e)ae,ae\u2032 degree one.\nOn the other hand, one easily observes that\nH log det(I \u2212M(u))\u22121 = H \u2211\nk\u22651\n1 k tr(M(u)k)\n= \u2211\nk\u22651\ntr(M(u)k).\nThus, the proof is completed.\nProof of Theorem 7 The proof is based on the decomposition in the following lemma and determinant manipulations. We define a linear operator by\nT : X(V ) \u2192 X( ~E), (T g)(e) := g(t(e))\nThe vector spaces X( ~E) and X(V ) have inner products naturally. We can think of the adjoint of T which is given by\nT \u2217 : X( ~E) \u2192 X(V ), (T \u2217f)(i) := \u2211\ne:t(e)=i\nf(e).\nThese linear operators have the following relation. Lemma M(u) = \u03b9(u)T T \u2217 \u2212 \u03b9(u) Proof [Proof of Lemma] Let f \u2208 X(V ). (\n\u03b9(u)T T \u2217 \u2212 \u03b9(u) ) f(e) = \u2211\ne\u2032: s(e\u2032)=s(e)\nt(e\u2032) 6=t(e)\nu s(e) t(e\u2032)\u2192t(e)\n\u2211\ne\u2032\u2032:t(e\u2032\u2032)=t(e\u2032)\nf(e\u2032\u2032)\u2212 \u2211\ne\u2032\u2032: s(e\u2032\u2032)=s(e)\nt(e\u2032\u2032) 6=t(e)\nu s(e) t(e\u2032\u2032)\u2192t(e)f(e \u2032\u2032)\n= \u2211\ne\u2032: s(e\u2032)=s(e)\nt(e\u2032) 6=t(e)\nu s(e) t(e\u2032)\u2192t(e)\n\u2211\ne\u2032\u2032: t(e\u2032\u2032)=t(e\u2032)\ne\u2032\u2032 6=e\u2032\nf(e\u2032\u2032)\n= (M(u)f)(e).\nUsing this lemma, we have\n\u03b6G(u) \u22121 = det(I \u2212M(u))\n= det(I \u2212 \u03b9(u)T T \u2217 + \u03b9(u)) = det(I \u2212 \u03b9(u)T T \u2217(I + \u03b9(u))\u22121) det((I + \u03b9(u))) = det(IrV \u2212 T \u2217(I + \u03b9(u))\u22121\u03b9(u)T ) \u220f\n\u03b1\u2208F\ndet(U\u03b1)\nIt is easy to see that IrV \u2212T \u2217(I + \u03b9(u))\u22121\u03b9(u)T = IrV \u2212T \u2217T + T \u2217(I + \u03b9(u))\u22121T . We also see that\n(T \u2217T g)(i) = \u2211\ne:t(e)=i\ng(t(e)) = dig(i)\nand (T \u2217(I + \u03b9(u))\u22121T g)(i) = \u2211\ne:t(e)=i\n((I + \u03b9(u))\u22121T g)(e) = (Wg)(i).\nProof of Proposition 16 The right inequality is obvious. We prove the left inequality. Let C = \u03c1(M(\u2016u\u2016)). It is enough to prove that det(I \u2212 zM(u)) has no root in {\u03bb \u2208 C| |\u03bb| < C\u22121}. Accordingly, we show that \u03b6H(zu) has no pole in the set. Let p be a prime cycle and let \u03bb1, . . . , \u03bbr be the eigenvalues of \u03c0(p;u). Then we obtain max |\u03bbl| \u2264 \u03c0(p; \u2016u\u2016). Therefore, if |z| < \u03c0(p; \u2016u\u2016)\u22121, we have\n\u2223 \u2223 \u2223 det(I \u2212 z|p|\u03c0(p;u)) \u2223 \u2223 \u2223 =\n\u2223 \u2223 \u2223 \u2223 \u2223 \u220f\nl\n(1\u2212 z|p|\u03bbl) \u2223 \u2223 \u2223 \u2223\n\u2223\n\u2265 ( 1\u2212 |z||p|\u03c0(p; \u2016u\u2016) )r .\nIt is not difficult to see that, for arbitrary prime cycle p, an inequality C\u22121 \u2264 \u03c0(p; \u2016u\u2016)\u22121 holds. Therefore, if |z| < C\u22121,\n|\u03b6H(zu)| =\n\u2223 \u2223 \u2223 \u2223 \u2223 \u2223 \u220f\np\u2208P\ndet(I \u2212 z|p|\u03c0(p;u))\u22121 \u2223 \u2223 \u2223 \u2223\n\u2223 \u2223\n\u2264 \u220f\np\u2208P\n( 1\u2212 |z||p|\u03c0(p; \u2016u\u2016) )\u2212r = \u03b6H(|z|\u2016u\u2016)r < \u221e.\nProof of Theorem 18 (ii) : Multinomial case First, we consider binary case, i.e. \u03c6i(xi) = xi \u2208 {\u00b11}. For t \u2208 [0, 1], let us define \u03b7ij(t) = Eb\u03b1 [xixj] = t and \u03b7i(t) = 0. Accordingly, u\u03b1i\u2192j = t and \u03b7(t) \u2208 L. As t \u0580 1, \u03b7(t) approaches to a boundary point of L. Using Theorem 27, analogous to the fixed-mean Gaussian case, we see that det(\u22072F (t)) becomes negative as t \u2192 1 if n(H) > 1. Therefore, F is not convex on L.\nFor general multinomial inference families, the non convexity of F is deduced from the binary case. There is a face of (the closure of) L that is identified with the set of pseudomarginals of the binary inference family on the same hypergraph. Since 0 log 0 = 0, we see that the restriction of F on the face is the Bethe free energy function of the binary inference family. Since this restriction is not convex, F is not convex."}], "references": [{"title": "A note on the cluster variation method", "author": ["G. An"], "venue": "Journal of Statistical Physics,", "citeRegEx": "An.,? \\Q1988\\E", "shortCiteRegEx": "An.", "year": 1988}, {"title": "Bayesian compressive sensing via belief propagation", "author": ["D. Baron", "S. Sarvotham", "R.G. Baraniuk"], "venue": "Signal Processing, IEEE Transactions on,", "citeRegEx": "Baron et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Baron et al\\.", "year": 2010}, {"title": "Zeta functions of finite graphs and representations of p-adic groups", "author": ["K. Hashimoto"], "venue": null, "citeRegEx": "Hashimoto.,? \\Q1990\\E", "shortCiteRegEx": "Hashimoto.", "year": 1990}, {"title": "Learning in graphical models", "author": ["M.I. Jordan"], "venue": "Kluwer Academic Publishers,", "citeRegEx": "Jordan.,? \\Q1998\\E", "shortCiteRegEx": "Jordan.", "year": 1998}, {"title": "Zeta functions of finite graphs", "author": ["M. Kotani", "T. Sunada"], "venue": "Journal of Mathematical Sciences. The University of Tokyo,", "citeRegEx": "Kotani and Sunada.,? \\Q2000\\E", "shortCiteRegEx": "Kotani and Sunada.", "year": 2000}, {"title": "Factor graphs and the sum-product algorithm", "author": ["F.R. Kschischang", "B.J. Frey", "H.A. Loeliger"], "venue": "IEEE Transactions on information theory,", "citeRegEx": "Kschischang et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Kschischang et al\\.", "year": 2001}, {"title": "Walk-sums and belief propagation in Gaussian graphical models", "author": ["D.M. Malioutov", "J.K. Johnson", "A.S. Willsky"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "Malioutov et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Malioutov et al\\.", "year": 2006}, {"title": "Maximum likelihood estimation using composite likelihoods for closed exponential families", "author": ["K.V. Mardia", "J.T. Kent", "G. Hughes", "C.C. Taylor"], "venue": null, "citeRegEx": "Mardia et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Mardia et al\\.", "year": 2009}, {"title": "Turbo decoding as an instance of Pearl\u2019s \u201dbelief propagation", "author": ["R.J. McEliece", "D.J.C. MacKay", "J.F. Cheng"], "venue": "algorithm. IEEE J. Sel. Areas Commun.,", "citeRegEx": "McEliece et al\\.,? \\Q1998\\E", "shortCiteRegEx": "McEliece et al\\.", "year": 1998}, {"title": "Analytic and algorithmic solution of random satisfiability problems", "author": ["M. Mezard", "G. Parisi", "R. Zecchina"], "venue": null, "citeRegEx": "Mezard et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Mezard et al\\.", "year": 2002}, {"title": "Weighted zeta functions of graphs", "author": ["H. Mizuno", "I. Sato"], "venue": "Journal of Combinatorial Theory, Series B,", "citeRegEx": "Mizuno and Sato.,? \\Q2004\\E", "shortCiteRegEx": "Mizuno and Sato.", "year": 2004}, {"title": "On the properties of the Bethe approximation and loopy belief propagation on binary networks", "author": ["J.M. Mooij", "H.J. Kappen"], "venue": "Journal of Statistical Mechanics: Theory and Experiment,", "citeRegEx": "Mooij and Kappen.,? \\Q2005\\E", "shortCiteRegEx": "Mooij and Kappen.", "year": 2005}, {"title": "Sufficient conditions for convergence of the sum-product algorithm", "author": ["J.M. Mooij", "H.J. Kappen"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Mooij and Kappen.,? \\Q2007\\E", "shortCiteRegEx": "Mooij and Kappen.", "year": 2007}, {"title": "Loopy belief propagation for approximate inference: An empirical study", "author": ["K. Murphy", "Y. Weiss", "M.I. Jordan"], "venue": "Proc. of Uncertainty in AI,", "citeRegEx": "Murphy et al\\.,? \\Q1999\\E", "shortCiteRegEx": "Murphy et al\\.", "year": 1999}, {"title": "A note on the zeta function of a graph", "author": ["S. Northshield"], "venue": "Journal of Combinatorial Theory, Series B,", "citeRegEx": "Northshield.,? \\Q1998\\E", "shortCiteRegEx": "Northshield.", "year": 1998}, {"title": "Belief propagation and statistical physics", "author": ["P. Pakzad", "V. Anantharam"], "venue": "Conference on Information Sciences and Systems,", "citeRegEx": "Pakzad and Anantharam.,? \\Q2002\\E", "shortCiteRegEx": "Pakzad and Anantharam.", "year": 2002}, {"title": "Probabilistic Reasoning in Intelligent Systems: Networks of Plausible Inference", "author": ["J. Pearl"], "venue": null, "citeRegEx": "Pearl.,? \\Q1988\\E", "shortCiteRegEx": "Pearl.", "year": 1988}, {"title": "Cluster variation method in statistical physics and probabilistic graphical models", "author": ["A. Pelizzola"], "venue": "Journal of Physics A: Mathematical General,", "citeRegEx": "Pelizzola.,? \\Q2005\\E", "shortCiteRegEx": "Pelizzola.", "year": 2005}, {"title": "Zeta functions of finite graphs and coverings", "author": ["H.M. Stark", "A.A. Terras"], "venue": "Advances in Mathematics,", "citeRegEx": "Stark and Terras.,? \\Q1996\\E", "shortCiteRegEx": "Stark and Terras.", "year": 1996}, {"title": "The zeta function of a hypergraph", "author": ["C.K. Storm"], "venue": "The Electronic Journal of Combinatorics,", "citeRegEx": "Storm.,? \\Q2006\\E", "shortCiteRegEx": "Storm.", "year": 2006}, {"title": "Nonparametric belief propagation and facial appearance estimation", "author": ["E.B. Sudderth", "A.T. Ihler", "W.T. Freeman", "A.S. Willsky"], "venue": "In IEEE International Conference on Computer Vision and Pattern Recognition,", "citeRegEx": "Sudderth et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Sudderth et al\\.", "year": 2002}, {"title": "L-functions in geometry and some applications", "author": ["T. Sunada"], "venue": "Lecture Notes in Math,", "citeRegEx": "Sunada.,? \\Q1986\\E", "shortCiteRegEx": "Sunada.", "year": 1986}, {"title": "Loopy belief propagation and Gibbs measures", "author": ["S. Tatikonda", "M.I. Jordan"], "venue": "Uncertainty in AI,", "citeRegEx": "Tatikonda and Jordan.,? \\Q2002\\E", "shortCiteRegEx": "Tatikonda and Jordan.", "year": 2002}, {"title": "Applied optimization with MATLAB programming", "author": ["P. Venkataraman"], "venue": null, "citeRegEx": "Venkataraman.,? \\Q2009\\E", "shortCiteRegEx": "Venkataraman.", "year": 2009}, {"title": "Tree-based reparameterization framework for analysis of sum-product and related algorithms", "author": ["M.J. Wainwright", "T.S. Jaakkola", "A.S. Willsky"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Wainwright et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Wainwright et al\\.", "year": 2003}, {"title": "Tree-reweighted belief propagation algorithms and approximate ML estimation by pseudomoment matching", "author": ["M.J. Wainwright", "T.S. Jaakkola", "A.S. Willsky"], "venue": "In Workshop on Artificial Intelligence and Statistics,", "citeRegEx": "Wainwright et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Wainwright et al\\.", "year": 2003}, {"title": "MAP estimation via agreement on trees: message-passing and linear programming", "author": ["M.J. Wainwright", "T.S. Jaakkola", "A.S. Willsky"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Wainwright et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Wainwright et al\\.", "year": 2005}, {"title": "Variational inference in graphical models: The view from the marginal polytope", "author": ["M.J. Wainwright", "M.I. Jordan"], "venue": "In proceedings of the annual Allerton Conference on Communication, Control, and Computing,", "citeRegEx": "Wainwright and Jordan.,? \\Q2003\\E", "shortCiteRegEx": "Wainwright and Jordan.", "year": 2003}, {"title": "Graphical models, exponential families, and variational inference", "author": ["M.J. Wainwright", "M.I. Jordan"], "venue": "Foundations and Trends in Machine Learning,", "citeRegEx": "Wainwright and Jordan.,? \\Q2008\\E", "shortCiteRegEx": "Wainwright and Jordan.", "year": 2008}, {"title": "On the uniquness of the solution of belief propagation equation", "author": ["W. Watanabe", "K. Fukumizu"], "venue": "in preparation,", "citeRegEx": "Watanabe and Fukumizu.,? \\Q2011\\E", "shortCiteRegEx": "Watanabe and Fukumizu.", "year": 2011}, {"title": "Discrete geometric analysis of message passing algorithm on graphs", "author": ["Y Watanabe"], "venue": "Ph.D thesis,", "citeRegEx": "Watanabe.,? \\Q2010\\E", "shortCiteRegEx": "Watanabe.", "year": 2010}, {"title": "Graph zeta function in the Bethe free energy and loopy belief propagation", "author": ["Y. Watanabe", "K. Fukumizu"], "venue": "Advances in Neural Information Processing Systems,", "citeRegEx": "Watanabe and Fukumizu.,? \\Q2009\\E", "shortCiteRegEx": "Watanabe and Fukumizu.", "year": 2009}, {"title": "Correctness of local probability propagation in graphical models with loops", "author": ["Y. Weiss"], "venue": "Neural Computation,", "citeRegEx": "Weiss.,? \\Q2000\\E", "shortCiteRegEx": "Weiss.", "year": 2000}, {"title": "MAP estimation, linear programming and belief propagation with convex free energies", "author": ["Y. Weiss", "C. Yanover", "T. Meltzer"], "venue": "Uncertainty in Artificial Intelligence,", "citeRegEx": "Weiss et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Weiss et al\\.", "year": 2007}, {"title": "Graphical models in applied multivariate statistics", "author": ["J. Whittaker"], "venue": "Wiley Publishing,", "citeRegEx": "Whittaker.,? \\Q2009\\E", "shortCiteRegEx": "Whittaker.", "year": 2009}, {"title": "Fractional belief propagation", "author": ["W. Wiegerinck", "T. Heskes"], "venue": "Advances in Neural Information Processing Systems,", "citeRegEx": "Wiegerinck and Heskes.,? \\Q2003\\E", "shortCiteRegEx": "Wiegerinck and Heskes.", "year": 2003}, {"title": "Generalized belief propagation", "author": ["J.S. Yedidia", "W.T. Freeman", "Y. Weiss"], "venue": "Advances in Neural Information Processing Systems,", "citeRegEx": "Yedidia et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Yedidia et al\\.", "year": 2001}, {"title": "Constructing free-energy approximations and generalized belief propagation algorithms", "author": ["J.S. Yedidia", "W.T. Freeman", "Y. Weiss"], "venue": "IEEE Transactions on Information Theory,", "citeRegEx": "Yedidia et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Yedidia et al\\.", "year": 2005}], "referenceMentions": [{"referenceID": 34, "context": "In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998).", "startOffset": 212, "endOffset": 256}, {"referenceID": 16, "context": "In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998).", "startOffset": 212, "endOffset": 256}, {"referenceID": 3, "context": "In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998).", "startOffset": 212, "endOffset": 256}, {"referenceID": 17, "context": "Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002).", "startOffset": 96, "endOffset": 157}, {"referenceID": 8, "context": "Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002).", "startOffset": 96, "endOffset": 157}, {"referenceID": 9, "context": "Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002).", "startOffset": 96, "endOffset": 157}, {"referenceID": 3, "context": "In the fields of statistics, artificial intelligence and machine learning, for example, graphical modeling has been a powerful tool for representing our prior knowledge and modeling hidden structures of problems (Whittaker, 2009; Pearl, 1988; Jordan, 1998). Other examples are found in statistical physics, coding theory, and combinatorial optimizations (Pelizzola, 2005; McEliece et al., 1998; Mezard et al., 2002). Typically, such probability distributions are derived from random variables that only have local interactions/constraints. This factorization structure is clearly visualized by a graph, called factor graph. Since the inference problems on graphical models, such as computation of marginal/conditional density functions and partition functions, are in general intractable for large graphs, Loopy Belief Propagation (LBP) has been proposed as an efficient approximation method applicable to any graph-structured density functions. Originally, Belief Propagation (BP) algorithm was proposed by Pearl (1988) to compute exactly the marginals for tree-structured graphical", "startOffset": 243, "endOffset": 1021}, {"referenceID": 13, "context": "Some researchers have found that LBP, an extended use of BP for graphs with cycles, shows good approximation with high potential applicability (Murphy et al., 1999; McEliece et al., 1998).", "startOffset": 143, "endOffset": 187}, {"referenceID": 8, "context": "Some researchers have found that LBP, an extended use of BP for graphs with cycles, shows good approximation with high potential applicability (Murphy et al., 1999; McEliece et al., 1998).", "startOffset": 143, "endOffset": 187}, {"referenceID": 36, "context": "After the proposal, many extensions and variants have been studied (Yedidia et al., 2001; Sudderth et al., 2002; Wainwright et al., 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al.", "startOffset": 67, "endOffset": 137}, {"referenceID": 20, "context": "After the proposal, many extensions and variants have been studied (Yedidia et al., 2001; Sudderth et al., 2002; Wainwright et al., 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al.", "startOffset": 67, "endOffset": 137}, {"referenceID": 26, "context": "After the proposal, many extensions and variants have been studied (Yedidia et al., 2001; Sudderth et al., 2002; Wainwright et al., 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al.", "startOffset": 67, "endOffset": 137}, {"referenceID": 1, "context": ", 2005) and have been applied successfully to many problems, including coding theory, image processing, sensor network localization and compressive sensing (Ihler et al., 2005; Baron et al., 2010).", "startOffset": 156, "endOffset": 196}, {"referenceID": 32, "context": "One theoretical challenge of LBP is that the algorithm may have many fixed points; the uniqueness is generally guaranteed only for trees and one-cycle graphs (Weiss, 2000).", "startOffset": 158, "endOffset": 171}, {"referenceID": 32, "context": "If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000).", "startOffset": 194, "endOffset": 207}, {"referenceID": 15, "context": "Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002).", "startOffset": 70, "endOffset": 99}, {"referenceID": 18, "context": "To derive the formula, we extend the definition of existing graph zeta functions and related Ihara-Bass formula (Stark and Terras, 1996; Bass, 1992).", "startOffset": 112, "endOffset": 148}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al.", "startOffset": 0, "endOffset": 219}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph.", "startOffset": 0, "endOffset": 243}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree.", "startOffset": 0, "endOffset": 392}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree. The purpose of this paper is to provide a novel discrete geometric approach to analysis of the LBP algorithm. The starting point of our study is a question: \u201cHow are the behaviors of the LBP algorithm affected by the geometry of the graph?\u201d If the graph is a tree (L)BP works nicely; it terminates in a finite step at the unique fixed point and gives the exact marginals. If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000). Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002). Existence of multiple cycles, however, breaks down these nice properties. There have not been many researches that elucidate the effects of cycles on LBP in detail beyond \u201ctree or non-tree\u201d classification. While a notable exception is the walk-sum analysis by Johnson et al. (2006) and Malioutov et al.", "startOffset": 0, "endOffset": 1508}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree. The purpose of this paper is to provide a novel discrete geometric approach to analysis of the LBP algorithm. The starting point of our study is a question: \u201cHow are the behaviors of the LBP algorithm affected by the geometry of the graph?\u201d If the graph is a tree (L)BP works nicely; it terminates in a finite step at the unique fixed point and gives the exact marginals. If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000). Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002). Existence of multiple cycles, however, breaks down these nice properties. There have not been many researches that elucidate the effects of cycles on LBP in detail beyond \u201ctree or non-tree\u201d classification. While a notable exception is the walk-sum analysis by Johnson et al. (2006) and Malioutov et al. (2006), it is limited to the Gaussian case.", "startOffset": 0, "endOffset": 1536}, {"referenceID": 0, "context": "Another difficulty of LBP is that the algorithm does not necessarily converge and sometimes shows oscillatory behaviors. Concerning the multinomial model (also known as discrete variable model), Mooij and Kappen (2007) and Ihler et al. (2006) give sufficient conditions for the convergence in terms of the spectral radius of a certain matrix related to the graph. Tatikonda and Jordan (2002) also derive a sufficient condition for convergence, interpreting the convergence as the uniqueness of the Gibbs measure on the universal covering tree. The purpose of this paper is to provide a novel discrete geometric approach to analysis of the LBP algorithm. The starting point of our study is a question: \u201cHow are the behaviors of the LBP algorithm affected by the geometry of the graph?\u201d If the graph is a tree (L)BP works nicely; it terminates in a finite step at the unique fixed point and gives the exact marginals. If the graph has only one cycle it also works appropriately; the algorithm converges to the unique fixed point and finds the MPM (Maximum Posterior Marginal) assignment in binary variable cases (Weiss, 2000). Additionally, the Bethe free energy function is convex in these cases (Pakzad and Anantharam, 2002). Existence of multiple cycles, however, breaks down these nice properties. There have not been many researches that elucidate the effects of cycles on LBP in detail beyond \u201ctree or non-tree\u201d classification. While a notable exception is the walk-sum analysis by Johnson et al. (2006) and Malioutov et al. (2006), it is limited to the Gaussian case. This paper proposes a method based on a new connection between LBP, Bethe free energy, and a graph zeta function. Graph zeta functions, originally introduced by Ihara (1966), are popular graph characteristics defined by the products over the prime cycles.", "startOffset": 0, "endOffset": 1747}, {"referenceID": 35, "context": "As the fundamentals, we consider the local properties of the Bethe free energy by elucidating the positive definiteness of its Hessian, while there are many studies on modifications and convexifications of the Bethe free energy function (Wiegerinck and Heskes, 2003; Wainwright et al., 2003b; Weiss et al., 2007).", "startOffset": 237, "endOffset": 312}, {"referenceID": 33, "context": "As the fundamentals, we consider the local properties of the Bethe free energy by elucidating the positive definiteness of its Hessian, while there are many studies on modifications and convexifications of the Bethe free energy function (Wiegerinck and Heskes, 2003; Wainwright et al., 2003b; Weiss et al., 2007).", "startOffset": 237, "endOffset": 312}, {"referenceID": 11, "context": "By numerical examples, we demonstrate that our new uniqueness condition covers a wider region than the one given by Mooij and Kappen (2007) for the examples.", "startOffset": 116, "endOffset": 140}, {"referenceID": 11, "context": "By numerical examples, we demonstrate that our new uniqueness condition covers a wider region than the one given by Mooij and Kappen (2007) for the examples. In the second application, we clarify a relation between the local structure of the Bethe free energy function and the local stability of a LBP fixed point. Such a relation is not necessarily obvious, since LBP is not derived as the gradient descent of the Bethe free energy. In this line of studies, for multinomial models Heskes (2002) shows that a locally stable fixed point of LBP is a local minimum of the Bethe free energy.", "startOffset": 116, "endOffset": 496}, {"referenceID": 4, "context": "Factor graphs are introduced by Kschischang et al. (2001). Any probability density function on X = \u220fi\u2208V Xi is trivially graphically factorized with respect to the \u201cone-factor hypergraph\u201d, where the unique factor includes all vertices.", "startOffset": 32, "endOffset": 58}, {"referenceID": 0, "context": "Any probability density function on X = \u220fi\u2208V Xi is trivially graphically factorized with respect to the \u201cone-factor hypergraph\u201d, where the unique factor includes all vertices. It is more informative if the factorization involves factors of small size. Our implicit assumption throughout this paper is that for all factors \u03b1, X\u03b1 = \u220f iXi are small enough, in the sense of cardinality or dimension, to be handled efficiently by computers. 2.2 Loopy Belief Propagation algorithm Given a graphical model, our task is to solve inference problem such as computation of marginal/conditional density functions and the partition function. Belief Propagation (BP) efficiently computes the exact marginals of a joint distribution that is factorized according to a tree-structured factor graph; Loopy Belief Propagation (LBP) is a heuristic application of the algorithm for factor graphs with cycles, showing successful performance in various problems. First, in Subsection 2.2.1, we introduce a collection of exponential families called inference family to formulate the LBP algorithm. In order to perform inferences using LBP, we have to fix an inference family that \u201cincludes\u201d the given graphical model. Our formulation is a variant of the approach by Wainwright et al. (2003a), where over-complete sufficient statistics are exploited.", "startOffset": 0, "endOffset": 1268}, {"referenceID": 7, "context": "This type of condition on exponential families is also considered in other litterateurs (Mardia et al., 2009).", "startOffset": 88, "endOffset": 109}, {"referenceID": 5, "context": "The procedures of the LBP algorithm is as follows (Kschischang et al., 2001).", "startOffset": 50, "endOffset": 76}, {"referenceID": 0, "context": "The modern formulation for presenting the approximation is a variational problem of the Bethe free energy (An, 1988).", "startOffset": 106, "endOffset": 116}, {"referenceID": 35, "context": "3 Bethe free energy and characterization of LBP fixed points The Bethe approximation was initiated by Bethe (1935) and was found to be essentially equivalent to LBP by Yedidia et al. (2001). The modern formulation for presenting the approximation is a variational problem of the Bethe free energy (An, 1988).", "startOffset": 168, "endOffset": 190}, {"referenceID": 3, "context": "See Wainwright and Jordan (2008) for more details.", "startOffset": 19, "endOffset": 33}, {"referenceID": 0, "context": "As shown by Pakzad and Anantharam (2002), the Bethe free energy function is convex if the factor graph has at most one cycle.", "startOffset": 23, "endOffset": 41}, {"referenceID": 0, "context": "As shown by Pakzad and Anantharam (2002), the Bethe free energy function is convex if the factor graph has at most one cycle. Therefore, the minimization of the Bethe free energy is easy for these cases. In general, however, the convexity of F is broken as the nullity of the underlying factor graph becomes large, yielding multiple minima. Though the functions \u03c6\u03b1 and \u03c6i are convex, the negative coefficients (1\u2212di) makes the function F complex. The positive-definiteness of the Hessian of the Bethe free energy will be analyzed in Section 4 and 5. The Bethe free energy function gives an alternative description of the LBP fixed points. The following fact is shown by Yedidia et al. (2001); LBP finds a stationary point of the Bethe free energy function, which is a necessary condition of the minimality.", "startOffset": 23, "endOffset": 692}, {"referenceID": 18, "context": "The edge zeta function is a multivariable generalization of Ihara\u2019s graph zeta function, allowing arbitrary scalar weight for each directed edge (Stark and Terras, 1996).", "startOffset": 145, "endOffset": 169}, {"referenceID": 4, "context": "d\u03b1 = 2 for all \u03b1 \u2208 F ), these definitions reduce to standard definitions (Kotani and Sunada, 2000).", "startOffset": 73, "endOffset": 98}, {"referenceID": 18, "context": "Serre (1980), Sunada (1986) and Bass (1992).", "startOffset": 14, "endOffset": 28}, {"referenceID": 18, "context": "Serre (1980), Sunada (1986) and Bass (1992). The edge zeta function is a multivariable generalization of Ihara\u2019s graph zeta function, allowing arbitrary scalar weight for each directed edge (Stark and Terras, 1996).", "startOffset": 14, "endOffset": 44}, {"referenceID": 19, "context": "Moreover, for general hypergraphs, we obtain the onevariable hypergraph zeta function by setting all matrix weights to be the same scalar u (Storm, 2006).", "startOffset": 140, "endOffset": 153}, {"referenceID": 18, "context": "If H is a graph and re = 1 for all e \u2208 ~ E, this zeta function reduces to the edge zeta function by Stark and Terras (1996). If in addition all these scalar weights are set to be equal, i.", "startOffset": 100, "endOffset": 124}, {"referenceID": 18, "context": "This type of determinant formula is well known in the context of graph zeta functions; in fact this theorem is a straightforward generalization of Theorem 3 of Stark and Terras (1996). In the next section we derive a new determinant formula of the zeta function by manipulating the matrix M(u) in the above determinant.", "startOffset": 160, "endOffset": 184}, {"referenceID": 18, "context": "The simplification of this matrix obtained by setting re = 1 and u = 1 is called directed edge matrix and denoted by M (Stark and Terras, 1996).", "startOffset": 119, "endOffset": 143}, {"referenceID": 4, "context": "Kotani and Sunada (2000) call this matrix a Perron-Frobenius operator.", "startOffset": 0, "endOffset": 25}, {"referenceID": 18, "context": "This zeta function is the matrix weight extension of the edge zeta function analyzed by Stark and Terras (1996). Since the degree of every hyperedge is equal to two for a graph, the matrix W\u03b1 defined in Eq.", "startOffset": 88, "endOffset": 112}, {"referenceID": 4, "context": "See Kotani and Sunada (2000); Stark and Terras (1996) for others.", "startOffset": 4, "endOffset": 29}, {"referenceID": 4, "context": "See Kotani and Sunada (2000); Stark and Terras (1996) for others.", "startOffset": 4, "endOffset": 54}, {"referenceID": 4, "context": "See Kotani and Sunada (2000); Stark and Terras (1996) for others. A combinatorial proof is given by Foata and Zeilberger (1999). 3.", "startOffset": 4, "endOffset": 128}, {"referenceID": 0, "context": "An intuitive understanding of this result, based on the Legendre duality of two types of the Bethe free energy functions is discussed by Watanabe (2010)", "startOffset": 0, "endOffset": 153}, {"referenceID": 29, "context": "For binary and pairwise case, this formula is first shown by Watanabe and Fukumizu (2009). Case 2: Fixed-mean Gaussian inference family Let G = (V,E) be a graph.", "startOffset": 61, "endOffset": 90}, {"referenceID": 0, "context": "Analysis of positive definiteness and convexity of BFE The Bethe free energy function is not necessarily convex though it is an approximation of the Gibbs free energy function, which is convex. Non-convexity of the Bethe free energy can lead to multiple fixed points. Pakzad and Anantharam (2002) and Heskes (2004) have derived sufficient conditions of the convexity and shown that the Bethe free energy is convex for trees and graphs with one cycle.", "startOffset": 0, "endOffset": 297}, {"referenceID": 0, "context": "Analysis of positive definiteness and convexity of BFE The Bethe free energy function is not necessarily convex though it is an approximation of the Gibbs free energy function, which is convex. Non-convexity of the Bethe free energy can lead to multiple fixed points. Pakzad and Anantharam (2002) and Heskes (2004) have derived sufficient conditions of the convexity and shown that the Bethe free energy is convex for trees and graphs with one cycle.", "startOffset": 0, "endOffset": 315}, {"referenceID": 0, "context": "For multinomial case, Pakzad and Anantharam (2002) have shown that the Bethe free energy function is convex if the hypergraph has at most one cycle.", "startOffset": 33, "endOffset": 51}, {"referenceID": 23, "context": "However, it requires optimizations with respect to f ; we can use standard numerical maximization techniques (Venkataraman, 2009).", "startOffset": 109, "endOffset": 129}, {"referenceID": 31, "context": "For binary pairwise case, we have a useful formulaW {i,j} i,j (\u03a8i,j) = tanh(|Jij |), where \u03a8i,j(xi, xj) \u221d eJijxixj+hixi+hjxj (Watanabe and Fukumizu, 2009).", "startOffset": 125, "endOffset": 154}, {"referenceID": 21, "context": "However, it requires optimizations with respect to f ; we can use standard numerical maximization techniques (Venkataraman, 2009). We leave developing efficient methods for computing the values for future works. For binary pairwise case, we have a useful formulaW {i,j} i,j (\u03a8i,j) = tanh(|Jij |), where \u03a8i,j(xi, xj) \u221d eJijxixj+hixi+hjxj (Watanabe and Fukumizu, 2009). Theorem 21 holds for an arbitrary LBP. However, for Gaussian cases we obtain W {i,j} i,j = 1, yielding no meaningful implications. Therefore, in the rest of this section, we focus on multinomial cases. 5.2.3 Comparison to Mooij\u2019s condition For multinomial models, there are several works that give sufficient conditions for the uniqueness property. Heskes (2004) analyzed the uniqueness problem by considering an equivalent min-max problem.", "startOffset": 110, "endOffset": 731}, {"referenceID": 3, "context": "Tatikonda and Jordan (2002) utilized the theory of Gibbs measure, and showed that the uniqueness of the Gibbs measure implies the convergence of LBP algorithm.", "startOffset": 14, "endOffset": 28}, {"referenceID": 12, "context": "(See numerical experiments in (Mooij and Kappen, 2007).", "startOffset": 30, "endOffset": 54}, {"referenceID": 10, "context": "(2006) and Mooij and Kappen (2007) derived sufficient conditions for the convergence by investigating conditions that make the LBP update a contraction; for pairwise case, their conditions are essentially the same.", "startOffset": 11, "endOffset": 35}, {"referenceID": 0, "context": "Another reason is that numerical experiments by Mooij and Kappen (2007) suggests that Mooij\u2019s condition is far superior to the condition of Heskes.", "startOffset": 0, "endOffset": 72}, {"referenceID": 0, "context": "Another reason is that numerical experiments by Mooij and Kappen (2007) suggests that Mooij\u2019s condition is far superior to the condition of Heskes. (See numerical experiments in (Mooij and Kappen, 2007).) The Mooij\u2019s condition is stated as follows. Theorem 22 (Mooij and Kappen (2007)) Define", "startOffset": 0, "endOffset": 285}, {"referenceID": 0, "context": "Analysis of stability of LBP In this section, we analyze relations between the local stability of LBP and the local structure of the Bethe free energy around an LBP fixed point. Since LBP is not the gradient descent of the Bethe free energy function, such a relation is not necessarily obvious. From the view point of the variational formulation, we hope to find the minima. In the celebrated paper by Yedidia et al. (2001), they empirically found that locally stable LBP fixed points 25", "startOffset": 0, "endOffset": 424}, {"referenceID": 0, "context": "Another case is i = j and \u03b1, \u03b2 \u2208 Ni (\u03b1 6= \u03b2). Then, the derivative is \u2202\u039b i \u2202\u03b7i \u2202(\u039b\u03b1)i \u2202\u03b8\u03b1:i \u2212 I = 0 because Varbi [\u03c6i] = Varb\u03b1 [\u03c6i] from Eq. (13). In other cases, the derivative is trivially zero. The relation j \u2208 N\u03b1 r i and \u03b2 \u2208 Nj r \u03b1 will be written as (\u03b2 \u2192 j) \u21c0 (\u03b1 \u2192 i) in Subsection 3.1. It is noteworthy that the elements of the linearization matrix is explicitly expressed by the fixed point beliefs. 6.2 Spectral conditions Let T be the LBP update map. A fixed point \u03bc\u2217 is called locally stable8 if LBP starting with a point sufficiently close to \u03bc\u2217 converges to \u03bc\u2217. To suppress oscillatory behaviors of LBP, damping of update T\u01eb := (1 \u2212 \u01eb)T + \u01ebI is sometimes useful, where 0 \u2264 \u01eb < 1 is a damping strength and I is the identity matrix. As we will summarize in the following theorem, the local stability is determined by the linearization T \u2032 at the fixed point. Since T \u2032 is nothing but M(u) at an LBP fixed point, Theorem 14 implies relations between the local stability and the Hessian of the Bethe free energy function. Theorem 24 Let \u03bc\u2217 be an LBP fixed point and assume that T \u2032(\u03bc\u2217) has no eigenvalues of unit modulus for simplicity. Then the following statements hold. 8. This property is often referred to as asymptotically stable Guckenheimer and Holmes (1990).", "startOffset": 0, "endOffset": 1275}, {"referenceID": 29, "context": "In a sequel paper (Watanabe and Fukumizu, 2011), we further exploit the connection between LBP, Bethe free energy and graph zeta function to analyze the LBP fixed point equation, focusing on binary pairwise models.", "startOffset": 18, "endOffset": 47}, {"referenceID": 11, "context": "Theorem 25 extends Theorem 2 of Mooij and Kappen (2005), which discusses only the case of binary pairwise models with vanishing local fields hi = 0 and the trivial fixed point (i.", "startOffset": 32, "endOffset": 56}, {"referenceID": 35, "context": "The connection between graph zeta, Bethe free energy and LBP can be extended to a more general class of free energies including fractional and tree-reweighted types (Wiegerinck and Heskes, 2003; Wainwright et al., 2003b).", "startOffset": 165, "endOffset": 220}, {"referenceID": 19, "context": "Theorem 27 (Hypergraph Hashimoto\u2019s theorem (Hashimoto, 1989; Storm, 2006)) Let \u03c7(H) := |V |+ |F | \u2212 | ~ E| be the Euler number of H.", "startOffset": 43, "endOffset": 73}, {"referenceID": 3, "context": "(30) are given by Kotani and Sunada (2000). For arbitrary hypergraph, \u03b6H(u) has a pole at u = 1 because det(I \u2212 M) = 0.", "startOffset": 18, "endOffset": 43}, {"referenceID": 2, "context": "The original version of this theorem is proved by Hashimoto (1989, 1990). Theorem 27 (Hypergraph Hashimoto\u2019s theorem (Hashimoto, 1989; Storm, 2006)) Let \u03c7(H) := |V |+ |F | \u2212 | ~ E| be the Euler number of H. lim u\u21920 \u03b6H(u) (1\u2212 u) = \u03c7(H)\u03ba(BH ), where \u03ba(BH) is the number of spanning trees of the bipartite graph BH . (BH is the bipartite graph representation of the hypergraph H.) Proof For a graph G = (V,E), Hashimoto (1989, 1990) proved that lim u\u21921 ZG(u) (1\u2212 u) |\u22121 = \u22122 (|E| \u2212 |V |)\u03ba(G), where \u03ba(G) is the number of spanning tree of G. A simple proof is given by Northshield (1998). Since there is a one-to-one correspondence between PH and PBH , we have \u03b6H(u) = ZBH ( \u221a u).", "startOffset": 50, "endOffset": 584}, {"referenceID": 18, "context": "Proof of Theorem 6 The following proof proceeds in an analogous manner with Theorem 3 in Stark and Terras (1996). First define a differential operator H := \u2211", "startOffset": 89, "endOffset": 113}], "year": 2011, "abstractText": "We propose a new approach to the theoretical analysis of Loopy Belief Propagation (LBP) and the Bethe free energy (BFE) by establishing a formula to connect LBP and BFE with a graph zeta function. The proposed approach is applicable to a wide class of models including multinomial and Gaussian types. The connection derives a number of new theoretical results on LBP and BFE. This paper focuses two of such topics. One is the analysis of the region where the Hessian of the Bethe free energy is positive definite, which derives the non-convexity of BFE for graphs with multiple cycles, and a condition of convexity on a restricted set. This analysis also gives a new condition for the uniqueness of the LBP fixed point. The other result is to clarify the relation between the local stability of a fixed point of LBP and local minima of the BFE, which implies, for example, that a locally stable fixed point of the Gaussian LBP is a local minimum of the Gaussian Bethe free energy.", "creator": "LaTeX with hyperref package"}}}