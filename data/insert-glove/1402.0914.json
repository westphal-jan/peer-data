{"id": "1402.0914", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "4-Feb-2014", "title": "Discovering Latent Network Structure in Point Process Data", "abstract": "tempestt Networks play geras a bettencourt central sarafiya role in modern data analysis, enabling us to reason virtuosos about comically systems sainz by warszawie studying the koothu relationships between churchwarden their parts. maharashtrian Most often sundman in 64.82 network analysis, the edges are sogang given. However, in many preconception systems redemptorists it metzer is i.r.s. difficult karnei or impossible to measure the network multiscreen directly. Examples rewardingly of aquatint latent maiya networks bohdan include demona economic bouzouki interactions fingall linking mismatch financial waif instruments and 2128 patterns frondizi of bektasevic reciprocity blenkinsop in mantellidae gang refreshers violence. 810,000 In kinkor these cases, chkalov we cybersmith are limited sacks to messrs. noisy anthus observations of events lemons associated lagnado with each bas-relief node. stayaways To unobtrusive enable analysis fakey of 1184 these dialpad implicit six-part networks, rediker we \u00a8 develop vasilii a probabilistic telef\u00eds model that combines three-track mutually - mohanad exciting 164.4 point kimock processes tretchikoff with mujic random graph models. We aberg show how the Poisson stoudemire superposition principle enables an elegant c.y. auxiliary variable formulation jock and hohenbergia a fully - Bayesian, parallel inference algorithm. We evaluate jira this pargluva new model 26,042 empirically 10021 on embroider several maketa datasets.", "histories": [["v1", "Tue, 4 Feb 2014 23:48:23 GMT  (950kb,D)", "http://arxiv.org/abs/1402.0914v1", null]], "reviews": [], "SUBJECTS": "stat.ML cs.LG", "authors": ["scott w linderman", "ryan p adams"], "accepted": true, "id": "1402.0914"}, "pdf": {"name": "1402.0914.pdf", "metadata": {"source": "CRF", "title": "DISCOVERING LATENT NETWORK STRUCTURE IN POINT PROCESS DATA", "authors": ["Scott W. Linderman", "Ryan P. Adams"], "emails": [], "sections": [{"heading": null, "text": "DISCOVERING LATENT NETWORK STRUCTURE IN POINT PROCESS DATA"}, {"heading": "By Scott W. Linderman and Ryan P. Adams", "text": "Harvard University\nNetworks play a central role in modern data analysis, enabling us to reason about systems by studying the relationships between their parts. Most often in network analysis, the edges are given. However, in many systems it is difficult or impossible to measure the network directly. Examples of latent networks include economic interactions linking financial instruments and patterns of reciprocity in gang violence. In these cases, we are limited to noisy observations of events associated with each node. To enable analysis of these implicit networks, we develop a probabilistic model that combines mutuallyexciting point processes with random graph models. We show how the Poisson superposition principle enables an elegant auxiliary variable formulation and a fully-Bayesian, parallel inference algorithm. We evaluate this new model empirically on several datasets.\n1. Introduction. Many types of modern data are characterized via relationships on a network. Social network analysis is the most commonly considered example, where the properties of individuals (vertices) can be inferred from \u201cfriendship\u201d type connections (edges). Such analyses are also critical to understanding regulatory biological pathways, trade relationships between nations, and propagation of disease. The tasks associated with such data may be unsupervised (e.g., identifying low-dimensional representations of edges or vertices) or supervised (e.g., predicting unobserved links in the graph). Traditionally, network analysis has focused on explicit network problems in which the graph itself is considered to be the observed data. That is, the vertices are considered known and the data are the entries in the associated adjacency matrix. A rich literature has arisen in recent years for applying statistical machine learning models to this type of problem, e.g., Liben-Nowell & Kleinberg (2007); Hoff (2008); Goldenberg et al. (2010).\nIn this paper we are concerned with implicit networks that cannot be observed directly, but about which we wish to perform analysis. In an implicit network, the vertices or edges of the graph may not be directly observed, but the graph structure may be inferred from noisy emissions. These noisy observations are assumed to have been generated according to underlying dynamics that respect the latent network structure.\nFor example, trades on financial stock markets are executed thousands of times per second. Trades of one stock are likely to cause subsequent activity on stocks in related industries. How can we infer such interactions and disentangle them from market-wide fluctuations that occur throughout the day? Discovering latent structure underlying financial markets not only reveals interpretable patterns of interaction, but also provides insight into the stability of the market. In Section 4 we will analyze the stability of mutually-excitatory systems, and in Section 6 we will explore how stock similarity may be inferred from trading activity.\nAs another example, both the edges and vertices may be latent. In Section 7, we examine patterns of violence in Chicago, which can often be attributed to social structures in the form of gangs. We would expect that attacks from one gang onto another might induce cascades of violence, but the vertices (gang identity of both perpetrator and victim) are unobserved. As with the financial data, it should be possible to exploit dynamics to infer these social structures. In this case spatial\n1\nar X\niv :1\n40 2.\n09 14\nv1 [\nst at\n.M L\n] 4\nF eb\n2 01\n4\ninformation is available as well, which can help inform latent vertex identities. In both of these examples, the noisy emissions have the form of events in time, or \u201cspikes,\u201d and our intuition is that a spike at a vertex will induce activity at adjacent vertices. In this paper, we formalize this idea into a probabilistic model based on mutually-interacting point processes. Specifically, we combine the Hawkes process (Hawkes, 1971) with recently developed exchangeable random graph priors. This combination allows us to reason about latent networks in terms of the way that they regulate interaction in the Hawkes process. Inference in the resulting model can be done with Markov chain Monte Carlo, and an elegant data augmentation scheme results in efficient parallelism."}, {"heading": "2. Preliminaries.", "text": "2.1. Poisson Processes. Point processes are fundamental statistical objects that yield random finite sets of events {sn}Nn=1 \u2282 S, where S is a compact subset of RD, for example, space or time. The Poisson process is the canonical example. It is governed by a nonnegative \u201crate\u201d or \u201cintensity\u201d function, \u03bb(s) : S \u2192 R+. The number of events in a subset S \u2032 \u2282 S follows a Poisson distribution with mean \u222b S\u2032 \u03bb(s)ds. Moreover, the number of events in disjoint subsets are independent.\nWe use the notation {sn}Nn=1 \u223c PP(\u03bb(s)) to indicate that a set of events {sn}Nn=1 is drawn from a Poisson process with rate \u03bb(s). The likelihood is given by\np({sn}Nn=1|\u03bb(s)) = exp { \u2212 \u222b S \u03bb(s)ds } N\u220f n=1 \u03bb(sn).(1)\nIn this work we will make use of a special property of Poisson processes, the Poisson superposition theorem, which states that {sn} \u223c PP(\u03bb1(s) + . . .+ \u03bbK(s)) can be decomposed intoK independent Poisson processes. Letting zn denote the origin of the n-th event, we perform the decomposition by independently sampling each zn from Pr(zn = k) \u221d \u03bbk(sn), for k \u2208 {1 . . .K} (Daley & Vere-Jones, 1988).\n2.2. Hawkes Processes. Though Poisson processes have many nice properties, they cannot capture interactions between events. For this we turn to a more general model known as Hawkes processes. A Hawkes process consists of K point processes and gives rise to sets of marked events {sn, cn}Nn=1, where cn \u2208 {1, . . . ,K} specifies the process on which the n-th event occurred. For now, we assume the events are points in time, i.e., sn \u2208 [0, T ]. Each of the K processes is a conditionally Poisson process with a rate \u03bbk(t | {sn : sn < t}) that depends on the history of events up to time t.\nHawkes processes have additive interactions. Each process has a \u201cbackground rate\u201d \u03bb0,k(t), and each event sn on process k adds a nonnegative impulse response hk,k\u2032(t \u2212 sn) to the intensity of other processes k\u2032. Causality and locality of influence are enforced by requiring hk,k\u2032(\u2206t) to be zero for \u2206t /\u2208 [0,\u2206tmax].\nBy the superposition theorem for Poisson processes, these additive components can be considered independent processes, each giving rise to their own events. We augment our data with a latent random variable zn \u2208 {0, . . . , n\u2212 1} to indicate the cause of the n-th event (0 if the event is due to the background rate and 1 . . . n\u2212 1 if it was caused by a preceding event).\nLet Cn,k\u2032 denote the set of events on process k\u2032 that were parented by event n. Formally,\nCn,k\u2032 \u2261 {sn\u2032 : cn\u2032 = k\u2032 \u2227 zn\u2032 = n}.\nLet C0,k be the set of events attributed to the background rate of process k. The augmented Hawkes likelihood is the product of likelihoods of each Poisson process:\np({(sn, cn, zn)}Nn=1 | {\u03bb0,k(t)},{{hk,k\u2032(\u2206t)}}) =[ K\u220f k=1 p(C0,k |\u03bb0,k(t)) ] \u00d7 [ N\u220f n=1 K\u220f k=1 p(Cn,k |hcn,k(t\u2212 sn)) ] ,(2)\nwhere the densities in the product are given by Equation 1. Figure 1 illustrates a causal cascades of events for a simple network of three processes (I-III). The first event is caused by the background rate (z1 = 0), and it induces impulse responses on processes II and III. Event 2 is spawned by the impulse on the third process (z2 = 1), and feeds back onto processes I and II. In some cases a single parent event induces multiple children, e.g., event 4 spawns events 5a-c. In this simple example, processes excite one another, but do not excite themselves. Next we will introduce more sophisticated models for such interaction networks.\n2.3. Random Graph Models. Graphs of K nodes correspond to K \u00d7K matrices. Unweighted graphs are binary adjacency matrices A where Ak,k\u2032 = 1 indicates a directed edge from node k to node k\u2032. Weighted directed graphs can be represented by a real matrixW whose entries indicate the weights of the edges. Random graph models reflect the probability of different network structures through distributions over these matrices.\nRecently, many random graph models have been unified under an elegant theoretical framework due to Aldous and Hoover (Aldous, 1981; Hoover, 1979). See Lloyd et al. (2012) for an overview. Conceptually, the Aldous-Hoover representation characterizes the class of exchangeable random graphs, that is, graph models for which the joint probability is invariant under permutations of the node labels. Just as de Finetti\u2019s theorem equates exchangeable sequences (Xn)n\u2208N to independent draws from a random probability measure \u0398, the Aldous-Hoover theorem relates random exchangeable graphs to the following generative model:\nu1, u2, . . . \u223ci.i.d Uniform[0, 1], Ak,k\u2032 \u223c Bernoulli(\u0398(uk, uk\u2032)),\nfor some random function \u0398 : [0, 1]2 \u2192 [0, 1].\nEmpty graph models (Ak,k\u2032 \u2261 0) and complete models (Ak,k\u2032 \u2261 1) are trivial examples, but much more structure may be encoded. For example, consider a model in which nodes are endowed with a location in space, xk \u2208 RD. This could be an abstract feature space or a real location like the center of a gang territory. The probability of connection between two notes decreases with distance between them as Ak,k\u2032 \u223c Bern(\u03c1e\u2212||xk\u2212xk\u2032 ||/\u03c4 ), where \u03c1 is the overall sparsity and \u03c4 is the characteristic distance scale. This simple model can be converted to the Aldous-Hoover representation by transforming uk into xk via the inverse CDF.\nMany models can be constructed in this manner. Stochastic block models, latent eigenmodels, and their nonparametric extensions all fall under this class (Lloyd et al., 2012). We will leverage the generality of the Aldous-Hoover formalism to build a flexible model and inference algorithm for Hawkes processes with structured interaction networks.\n3. The Network Hawkes Model. In order to combine Hawkes processes and random network models, we decompose the Hawkes impulse response hk,k\u2032(\u2206t) as follows:\nhk,k\u2032(\u2206t) = Ak,k\u2032Wk,k\u2032g\u03b8k,k\u2032 (\u2206t).(3)\nHere,A \u2208 {0, 1}K\u00d7K is a binary adjacency matrix andW \u2208 RK\u00d7K+ is a non-negative weight matrix. Together these specify the sparsity structure and strength of the interaction network, respectively. The non-negative function g\u03b8k,k\u2032 (\u2206t) captures the temporal aspect of the interaction. It is parameterized by \u03b8k,k\u2032 and satisfies two properties: a) it has bounded support for \u2206t \u2208 [0,\u2206tmax], and b) it integrates to one. In other words, g is a probability density with compact support.\nDecomposing h as in Equation 3 has many advantages. It allows us to express our separate beliefs about the sparsity structure of the interaction network and the strength of the interactions through a spike-and-slab prior on A and W (Mohamed et al., 2012). The empty graph model recovers independent background processes, and the complete graph recovers the standard Hawkes process. Making g a probability density endows W with units of \u201cexpected number of events\u201d and allows us to compare the relative strength of interactions. The form suggests an intuitive generative model: for each impulse response draw m \u223c Poisson(Wk,k\u2032) number of induced events and draw the m child event times i.i.d. from g, enabling computationally tractable conjugate priors.\nIntuitively, the background rates, \u03bb0,k(t), explain events that cannot be attributed to preceding events. In the simplest case the background rate is constant. However, there are often fluctuations in overall intensity that are shared among the processes, and not reflective of process-to-process interaction, as we will see in the daily variations in trading volume on the S&P100 and the seasonal trends in homicide. To capture these shared background fluctuations, we use a sparse Log Gaussian Cox process (M\u00f8ller et al., 1998) to model the background rate:\n\u03bb0,k(t) = \u00b5k + \u03b1k exp{y(t)}, y(t) \u223c GP(0,K(t, t\u2032)).\nThe kernel K(t, t\u2032) describes the covariance structure of the background rate that is shared by all processes. For example, a periodic kernel may capture seasonal or daily fluctuations. The offset \u00b5k accounts for varying background intensities among processes, and the scaling factor \u03b1k governs how sensitive process k is to these background fluctuations (when \u03b1k = 0 we recover the constant background rate).\nFinally, in some cases the process identities, cn, must also be inferred. With gang incidents in Chicago we may have only a location, xn \u2208 R2. In this case, we may place a spatial Gaussian mixture model over the cn\u2019s, as in Cho et al. (2013). Alternatively, we may be given the label of the community in which the incident occurred, but we suspect that interactions occur between clusters of communities. In this case we can use a simple clustering model or a nonparametric model like that of Blundell et al. (2012).\n3.1. Inference with Gibbs Sampling. We present a Gibbs sampling procedure for inferring the model parameters, W , A, {{\u03b8k,k\u2032}},{\u03bb0,k(t)}, and, if necessary, {cn}. In order to simplify our Gibbs updates, we will also sample a set of parent assignments for each event {zn}. Incorporating these parent variables enables conjugate prior distributions for W , \u03b8k,k\u2032 , and, in the case of constant background rates, \u03bb0,k.\nSampling weights W .. A gamma prior on the weights, Wk,k\u2032 \u223c Gamma(\u03b10W , \u03b20W ), results in the conditional distribution,\nWk,k\u2032 | {sn, cn, zn}Nn=1, \u03b8k,k\u2032 \u223c Gamma(\u03b1k,k\u2032 , \u03b2k,k\u2032),\n\u03b1k,k\u2032 = \u03b1 0 W + N\u2211 n=1 N\u2211 n\u2032=1 \u03b4cn,k\u03b4cn\u2032 ,k\u2032\u03b4zn\u2032,n\n\u03b2k,k\u2032 = \u03b2 0 W + N\u2211 n=1 \u03b4cn,k.\nThis is a minor approximation valid for \u2206tmax T . Here and elsewhere, \u03b4i,j is the Kronecker delta function. We use the inverse-scale parameterization of the gamma distribution, i.e.,\nGamma(x |\u03b1, \u03b2) = \u03b2 \u03b1\n\u0393(\u03b1) x\u03b1\u22121 exp{\u2212\u03b2 x}.\nSampling impulse response parameters \u03b8k,k\u2032.. We let gk,k\u2032(\u2206t) be the logistic-normal density with parameters \u03b8k,k\u2032 = {\u00b5, \u03c4}:\ngk,k\u2032(\u2206t |\u00b5, \u03c4) = 1\nZ exp { \u2212\u03c4 2 ( \u03c3\u22121 ( \u2206t\n\u2206tmax\n) \u2212 \u00b5 )2} \u03c3\u22121(x) = ln(x/(1\u2212 x))\nZ = \u2206t(\u2206tmax \u2212\u2206t)\n\u2206tmax\n( \u03c4 2\u03c0 )\u2212 1 2 .\nThe normal-gamma prior\n\u00b5, \u03c4 \u223c NG(\u00b5, \u03c4 |\u00b50\u00b5, \u03ba0\u00b5, \u03b10\u03c4 , \u03b20\u03c4 )\nyields the standard conditional distribution (see Murphy, 2012) with the following sufficient statistics:\nxn,n\u2032 = ln(sn\u2032 \u2212 sn)\u2212 ln(tmax \u2212 (sn\u2032 \u2212 sn)),\nm = N\u2211 n=1 N\u2211 n\u2032=1 \u03b4cn,k\u03b4cn\u2032 ,k\u2032\u03b4zn\u2032 ,n,\nx\u0304 = 1\nm N\u2211 n=1 N\u2211 n\u2032=1 \u03b4cn,k\u03b4cn\u2032 ,k\u2032\u03b4zn\u2032 ,nxn,n\u2032 .\nSampling background rates \u03bb0,k.. For background rates \u03bb0,k(t) \u2261 \u03bb0,k, the prior \u03bb0,k \u223c Gamma(\u03b10\u03bb, \u03b20\u03bb) is conjugate with the likelihood and yield the conditional distribution\n\u03bb0,k | {sn, cn, zn}Nn=1,\u223c Gamma(\u03b1\u03bb, \u03b2\u03bb),\n\u03b1\u03bb = \u03b1 0 \u03bb + \u2211 n \u03b4cn,k\u03b4zn,0 \u03b2\u03bb = \u03b2 0 \u03bb + T\nThis conjugacy no longer holds for Gaussian process background rates, but conditioned upon the parent variables, we must simply fit a Gaussian process for those events for which zn = 0. We use elliptical slice sampling (Murray et al., 2010) for this purpose.\nCollapsed Gibbs sampling A and zn.. With Aldous-Hoover graph priors, the entries in the binary adjacency matrix A are conditionally independent given the parameters of the prior. The likelihood introduces dependencies between the rows of A, but each column can be sampled in parallel. Gibbs updates are complicated by strong dependencies between the graph and the parent variables, zn. Specifically, if zn\u2032 = n, then we must have Acn,cn\u2032 = 1. To improve the mixing of our sampling algorithm, first we update A | {sn, cn},W , \u03b8k,k\u2032 by marginalizing the parent variables. The posterior is determined by the likelihood of the conditionally Poisson process \u03bbk\u2032(t | {sn : sn < t}) (Equation 1) with and without interaction Ak,k\u2032 and the prior comes from the Aldous-Hoover graph model. Then we update zn | {sn, cn},A,W , \u03b8k,k\u2032 by sampling from the discrete conditional distribution. Though there are N parent variables, they are conditionally independent and may be sampled in parallel. We have implemented our inference algorithm on GPUs to capitalize on this parallelism.\nSampling process identities cn.. As with the adjacency matrix, we use a collapsed Gibbs sampler to marginalize out the parent variables when sampling the process identities. Unfortunately, the cn\u2019s are not conditionally independent and hence must be sampled sequentially. This limits the size of the datasets we can handle when the process identities are unknown, but our GPU implementation is still able to achieve upwards of 4 iterations (sampling all variables) per second on datasets with thousands of events.\n4. Stability of Network Hawkes Processes. Due to their recurrent nature, Hawkes processes must be constrained to ensure their positive feedback does not lead to infinite numbers of events. A stable system must satisfy1\n\u03bbmax = max | eig(A W ) | < 1\n(see Daley & Vere-Jones, 1988). When we are conditioning on finite datasets we do not have to worry about this. We simply place weak priors on the network parameters, e.g., a beta prior on\n1In this context \u03bbmax refers to an eigenvalue rather than a rate, and denotes the Hadamard product.\nthe sparsity \u03c1 of an Erdo\u030bs-Renyi graph, and a Jeffreys prior on the scale of the gamma weight distribution. For the generative model, however, we would like to set our hyperparameters such that the prior distribution places little mass on unstable networks. In order to do so, we use tools from random matrix theory.\nThe celebrated circular law describes the asymptotic eigenvalue distribution for K \u00d7K random matrices with entries that are i.i.d. with zero mean and variance \u03c32. As K grows, the eigenvalues are uniformly distributed over a disk in the complex plane centered at the origin and with radius \u03c3 \u221a K. In our case, however, the mean of the entries, E[Ak,k\u2032Wk,k\u2032 ] = \u00b5, is not zero. Silverstein (1994) has shown that we can analyze noncentral random matrices by considering them to be perturbations about the mean. Consider A W = V +U , where V = \u00b5KeKeTK is a deterministic rank-one matrix with every entry equal to \u00b5, eK \u2208 RK is a column vector with all entries equal to K\u22121/2, and U is a random matrix with i.i.d. zero-mean entries. Then, as K approaches infinity, the largest eigenvalue will come from V and will be distributed as \u03bbmax \u223c N (\u00b5K, \u03c32), and the remaining eigenvalues will be uniformly distributed over the complex disc.\nIn the simple case of Wk,k\u2032 \u223c Gamma(\u03b1, \u03b2) and Ak,k\u2032 \u223c Bern(\u03c1), we have \u00b5 = \u03c1\u03b1/\u03b2 and \u03c3 = \u221a \u03c1((1\u2212 \u03c1)\u03b12 + \u03b1)/\u03b2. For a given K, \u03b1 and \u03b2, we can tune the sparsity parameter \u03c1 to achieve stability with high probability. We simply set \u03c1 such that the minimum of \u03c3 \u221a K and, say, \u00b5K + 3\u03c3, equals one. Figures 2a and 2b show a variety of weight distributions and the maximum stable \u03c1. Increasing the network size, the mean, or the variance will require a concomitant increase in sparsity.\nThis approach relies on asymptotic eigenvalue distributions, and it is unclear how quickly the spectra of random matrices will converge to this distribution. To test this, we computed the empirical eigenvalue distribution for random matrices of various size, mean, and variance. We generated 104 random matrices for each weight distribution in Figure 2a with sizes K = 4, 64, and 1024, and \u03c1 set to the theoretical maximum indicated by dots in Figure 2b. The theoretical and empirical distributions of the maximum eigenvalue are shown in Figures 2c and 2d. We find that for small mean and variance weights, for example Gamma(1, 5) in the Figure 2c, the empirical results closely match the theory. As the weights grow larger, as in Gamma(8, 12) in 2d, the empirical eigenvalue distributions have increased variance and lead to a greater than expected probability of unstable matrices for the range of network sizes tested here. We conclude that networks with strong weights should be counterbalanced by strong sparsity limits, or additional structure in the adjacency matrix that prohibits excitatory feedback loops.\n5. Synthetic Results. Our inference algorithm is first tested on synthetic data generated from the network Hawkes model. We perform two tests: a) a link prediction task where the process identities are given and the goal is to simply infer whether or not an interaction exists, and b) an event prediction task where we measure the probability of held-out event sequences.\nThe network Hawkes model can be used for link prediction by considering the posterior probability of interactions P (Ak,k\u2032 | {sn, cn}). By thresholding at varying probabilities we compute a ROC curve. A standard Hawkes process assumes a complete set of interactions (Ak,k\u2032 \u2261 1), but we can similarly threshold its inferred weight matrix to perform link prediction.\nCross correlation provides a simple alternative measure of interaction. By summing the crosscorrelation over offsets \u2206t \u2208 [0,\u2206tmax), we get a measure of directed interaction. A probabilistic alternative is offered by the generalized linear model for point processes (GLM), a popular model for spiking dynamics in computational neuroscience (Paninski, 2004). The GLM allows for constant background rates and both excitatory and inhibitory interactions. Impulse responses are modeled with linear basis functions. Area under the impulse response provides a measure of directed excitatory interaction that we use to compute a ROC curve. See the supplementary material for a detailed description of this model.\nWe sampled ten network Hawkes processes of 30 nodes each with Erdo\u030bs-Renyi graph models, constant background rates, and the priors described in Section 3. The Hawkes processes were simulated for T = 1000 seconds. We used the models above to predict the presence or absence of interactions. The results of this experiment are shown in the ROC curves of Figure 3a. The network Hawkes model accurately identifies the sparse interactions, outperforming all other models.\nWith the Hawkes process and the GLM we can evaluate the log likelihood of held-out test data. On this task, the network Hawkes outperforms the competitors for 9 out 10 networks. On average, the network Hawkes model achieves 2.2 \u00b1 .1 bits/spike improvement in predictive log likelihood over a homogeneous Poisson process. Figure 3b shows that on average the standard Hawkes and the GLM provide only 60% and 72%, respectively, of this predictive power. See the supplementary material for further analysis.\n6. Trades on the S&P 100. As an example of how Hawkes processes may discover interpretable latent structure in real-world data, we study the trades on the S&P 100 index collected at 1s intervals during the week of Sep. 28 through Oct. 2, 2009. Every time a stock price changes by \u00b10.1% of its current price an event is logged on the stock\u2019s process, yielding a total of K = 100 processes and N=182,037 events.\nTrading volume varies substantially over the course of the day, with peaks at the opening and\nclosing of the market. This daily variation is incorporated into the background rate via a Log Gaussian Cox Process (LGCP) with a periodic kernel (see supplementary material). We look for short-term interactions on top of this background rate with time scales of \u2206tmax = 60s.\nIn Figure 4 we compare the predictive performance of independent LGCPs, a standard Hawkes process with LGCP background rates, and the network Hawkes model with LGCP background rates under two graph priors. The models are trained on four days of data and tested on the fifth. Though the network Hawkes is slightly outperformed by the standard Hawkes, the difference is small relative to the performance improvement from considering interactions, and the inferred network parameters provide interpretable insight into the market structure.\nIn the latent distance model for A, each stock has a latent embedding xk \u2208 R2 such that nearby stocks are more likely to interact, as described in Section 2.3. Figure 5 shows a sample from the posterior distribution over embeddings in R2 for \u03c1 = 0.2 and \u03c4 = 1. We have plotted stocks in the six largest sectors, as listed on Bloomberg.com. Some sectors, notably energy and financials, tend to cluster together, indicating an increased probability of interaction between stocks in the same sector. Other sectors, such as consumer goods, are broadly distributed, suggesting that these stocks are less influenced by others in their sector. For the consumer industry, which is driven by slowly varying factors like inventory, this may not be surprising.\nThe Hinton diagram in the bottom panel of Figure 5 shows the top 4 eigenvectors of the interaction network. All eigenvalues are less than 1, indicating that the system is stable. The top row corresponds to first eigenvector (\u03bbmax = 0.74). Apple (AAPL), J.P. Morgan (JPM), and Exxon Mobil (XOM) have notably large entries in the eigenvector, suggesting that their activity will spawn cascades of self-excitation. The fourth eigenvector (\u03bb4 = 0.34) is dominated by Walgreens (WAG) and CVS (CVS), suggesting bursts of activity in these drug stores, perhaps due to encouraging quarterly reports during flu season (Associated Press, 2012).\n7. Gangs of Chicago. In our final example, we study spatiotemporal patterns of gang-related homicide in Chicago. Sociologists have suggested that gang-related homicide is mediated by underlying social networks and occurs in mutually-exciting, retaliatory patterns (Papachristos, 2009). This is consistent with a spatiotemporal Hawkes process in which processes correspond to gang territories and homicides incite further homicides in rival territories.\nWe study gang-related homicides between 1980 and 1995 (Block et al., 2005). Homicides are labeled by the community in which they occurred. Over this time-frame there were N = 1637 gang-related homicides in the 77 communities of Chicago.\nWe evaluate our model with an event-prediction task, training on 1980-1993 and testing on 1994-1995. We use a Log Gaussian Cox Process (LGCP) temporal background rate in all model variations. Our baseline is a single process with a uniform spatial rate for the city. We test two process identity models: a) the \u201ccommunity\u201d model, which considers each community a separate process, and b) the \u201ccluster\u201d model, which groups communities into processes. The number of\nclusters is chosen by cross-validation (see supplementary material). For each process identity model, we compare four graph models: a) independent LGCPs (empty), b) a standard Hawkes process with all possible interactions (complete), c) a network Hawkes model with a sparsity-inducing Erdo\u030bsRenyi graph prior, and d) a network Hawkes model with a latent distance model that prefers short-range interactions.\nThe community process identity model improves predictive performance by accounting for higher rates in South and West Chicago where gangs are deeply entrenched. Allowing for interactions between community areas, however, results in a decrease in predictive power due to overfitting (there is insufficient data to fit all 772 potential interactions). Interestingly, sparse graph priors do not help. They bias the model toward sparser but stronger interactions which are not supported by the test data. These results are shown in the \u201ccommunities\u201d group of Figure 6a. Clustering the\ncommunities improves predictive performance for all graph models, as seen in the \u201cclusters\u201d group. Moreover, the clustered models benefit from the inclusion of excitatory interactions, with the highest predictive log likelihoods coming from a four-cluster Erdo\u030bs-Renyi graph model with interactions shown in Figure 6b. Distance-dependent graph priors do not improve predictive performance on this dataset, suggesting that either interactions do not occur over short distances, or that local rivalries are not substantial enough to be discovered in our dataset. More data is necessary to conclusively say which.\nLooking into the inferred clusters in Figure 6c and their rates in 6d, we can interpret the clusters as \u201csafe suburbs\u201d in gold, \u201cbuffer neighborhoods\u201d in green, and \u201cgang territories\u201d in red and blue. Self-excitation in the blue cluster (Figure 6b) suggests that these regions are prone to bursts of activity, as one might expect during a turf-war. This interpretation is supported by reports of \u201ca burst of street-gang violence in 1990 and 1991\u201d in West Englewood (41.77\u25e6N, \u221287.67\u25e6W) (Block & Block, 1993).\nFigure 6d also shows a significant increase in the homicide rate between 1989 and 1995, consistent with reports of escalating gang warfare (Block & Block, 1993). In addition to this long-term trend, homicide rates show a pronounced seasonal effect, peaking in the summer and tapering in the winter. A LGCP with a quadratic kernel point-wise added to a periodic kernel captures both effects.\n8. Related Work. Multivariate point processes are of great interest to the machine learning community as they are intuitive models for a variety of natural phenomena. We have leveraged\nprevious work on Poisson processes with Gaussian process intensities in our background rate models (Cunningham et al., 2007). An expectation-maximization inference algorithm for Hawkes processes was put forth by Simma & Jordan (2010) and applied to very large social network datasets. We have adapted their latent variable formulation in our fully-Bayesian inference algorithm and introduced a framework for prior distributions over the latent network.\nOthers have considered special cases of the model we have proposed. Blundell et al. (2012) combine Hawkes processes and the Infinite Relational Model (a specific exchangeable graph model with an Aldous-Hoover representation) to cluster processes and discover interactions. Cho et al. (2013) applied Hawkes processes to gang incidents in Los Angeles. They developed a spatial Gaussian mixture model (GMM) for process identities, but did not explore structured network priors. We experimented with this process identity model but found that it suffers in predictive log likelihood tests (see supplementary material).\nRecently, Iwata et al. (2013) developed a stochastic EM algorithm for Hawkes processes, leveraging similar conjugacy properties, but without network priors. Zhou et al. (2013) have developed a promising optimization-based approach to discovering low-rank networks in Hawkes processes, similar to some of the network models we explored.\nPerhaps the most closely related work is that of Perry & Wolfe (2013). They provide a partial likelihood inference algorithm for Hawkes processes with a similar emphasis on structural patterns in the network of interactions. They provide an estimator capable of discovering homophily (the tendency for similar processes to interact) and other network effects. Our fully-Bayesian approach generalizes this method to capitalize on recent developments in random network models (Lloyd et al., 2012) and allows for nonparametric background rates.\nFinally, generalized linear models (GLMs) are widely used in computational neuroscience (Paninski, 2004). GLMs allow for both excitatory and inhibitory interactions, but, as we have shown, when the data consists of purely excitatory interactions, Hawkes processes outperform GLMs in link- and event-prediction tests.\n9. Conclusion. We developed a framework for discovering latent network structure from spiking data. Our auxiliary variable formulation of the multivariate Hawkes process supported arbitrary Aldous-Hoover graph priors, Log Gaussian Cox Process background rates, and models of unobserved process identities. Our parallel MCMC algorithm allowed us to reason about uncertainty in the latent network in a fully-Bayesian manner, taking into account noisy observations and prior beliefs. We leveraged results from random matrix theory to analyze the conditions under which random network models will be stable, and our applications uncovered interpretable latent networks in a variety of synthetic and real-world problems. Generalizing beyond the Hawkes observation model is a promising avenue for future work.\nAcknowledgements. The authors wish to thank Leslie Valiant for many valuable discussions. SWL is supported by a National Defense Science and Engineering Graduate Fellowship.\nReferences.\nAldous, David J. Representations for partially exchangeable arrays of random variables. Journal of Multivariate Analysis, 11(4):581\u2013598, 1981. Associated Press. Walgreen beats expectations on higher pharmacy sales. The New York Times, September 2012. Block, Carolyn R and Block, Richard. Street gang crime in Chicago. US Department of Justice, Office of Justice\nPrograms, National Institute of Justice, 1993. Block, Carolyn R, Block, Richard, and Authority, Illinois Criminal Justice Information. Homicides in Chicago, 1965-\n1995. ICPSR06399-v5. Ann Arbor, MI: Inter-university Consortium for Political and Social Research [distributor], July 2005. Blundell, Charles, Heller, Katherine, and Beck, Jeffrey. Modelling reciprocating relationships with Hawkes processes. Advances in Neural Information Processing Systems, 2012. Cho, Yoon Sik, Galstyan, Aram, Brantingham, Jeff, and Tita, George. Latent point process models for spatialtemporal networks. arXiv:1302.2671, 2013. Cunningham, John P, Yu, Byron M, Sahani, Maneesh, and Shenoy, Krishna V. Inferring neural firing rates from spike trains using Gaussian processes. In Advances in Neural Information Processing Systems, pp. 329\u2013336, 2007. Daley, Daryl J and Vere-Jones, David. An introduction to the theory of point processes. 1988, 1988. Goldenberg, Anna, Zheng, Alice X, Fienberg, Stephen E, and Airoldi, Edoardo M. A survey of statistical network\nmodels. Foundations and Trends in Machine Learning, 2(2):129\u2013233, 2010. Hawkes, Alan G. Spectra of some self-exciting and mutually exciting point processes. Biometrika, 58(1):83, 1971. Hoff, Peter D. Modeling homophily and stochastic equivalence in symmetric relational data. Advances in Neural\nInformation Processing Systems 20, 20:1\u20138, 2008. Hoover, Douglas N. Relations on probability spaces and arrays of random variables. Technical report, Institute for\nAdvanced Study, Princeton, 1979. Iwata, Tomoharu, Shah, Amar, and Ghahramani, Zoubin. Discovering latent influence in online social activities\nvia shared cascade Poisson processes. In Proceedings of the 19th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pp. 266\u2013274. ACM, 2013. Liben-Nowell, David and Kleinberg, Jon. The link-prediction problem for social networks. Journal of the American society for information science and technology, 58(7):1019\u20131031, 2007. Lloyd, James Robert, Orbanz, Peter, Ghahramani, Zoubin, and Roy, Daniel M. Random function priors for exchangeable arrays with applications to graphs and relational data. Advances in Neural Information Processing Systems, 2012. Mohamed, Shakir, Ghahramani, Zoubin, and Heller, Katherine A. Bayesian and L1 approaches for sparse unsupervised learning. In Proceedings of the 29th International Conference on Machine Learning, pp. 751\u2013758, 2012. M\u00f8ller, Jesper, Syversveen, Anne Randi, and Waagepetersen, Rasmus Plenge. Log gaussian cox processes. Scandinavian Journal of Statistics, 25(3):451\u2013482, 1998. Murphy, Kevin P. Machine learning: a probabilistic perspective. The MIT Press, 2012. Murray, Iain, Adams, Ryan P., and MacKay, David J.C. Elliptical slice sampling. Journal of Machine Learning\nResearch: Workshop and Conference Proceedings (AISTATS), 9:541\u2013548, 2010. Paninski, Liam. Maximum likelihood estimation of cascade point-process neural encoding models. Network: Compu-\ntation in Neural Systems, 15(4):243\u2013262, January 2004. Papachristos, Andrew V. Murder by structure: Dominance relations and the social structure of gang homicide.\nAmerican Journal of Sociology, 115(1):74\u2013128, 2009. Perry, Patrick O and Wolfe, Patrick J. Point process modelling for directed interaction networks. Journal of the\nRoyal Statistical Society: Series B (Statistical Methodology), 2013. Silverstein, Jack W. The spectral radii and norms of large dimensional non-central random matrices. Stochastic\nModels, 10(3):525\u2013532, 1994. Simma, Aleksandr and Jordan, Michael I. Modeling events with cascades of Poisson processes. Proceedings of the\n26th Conference on Uncertainty in Artificial Intelligence (UAI), 2010. Zhou, Ke, Zha, Hongyuan, and Song, Le. Learning social infectivity in sparse low-rank networks using multi-\ndimensional Hawkes processes. In Proceedings of the International Conference on Artificial Intelligence and Statistics, volume 16, 2013."}, {"heading": "APPENDIX A: INFERENCE DETAILS", "text": "A.1. Derivation of conjugate prior updates. By combining Equations 1 and 2 of the main text, we can write the joint likelihood, with the auxiliary parent variables, as,\np({sn, cn, zn}Nn=1, | {\u03bb0,k(t)}Kk=1, {hk,k\u2032(\u2206t)}k,k\u2032) = K\u220f k=1 [ exp { \u2212 \u222b T 0 \u03bb0,k(\u03c4)d\u03c4 } N\u220f n=1 \u03bb0,k(sn) \u03b4cn,k\u03b4zn,0 ]\n\u00d7 N\u220f n=1 K\u220f k\u2032=1 [ exp { \u2212 \u222b T sn hcn,k\u2032(\u03c4 \u2212 sn)d\u03c4 } N\u220f n\u2032=1 hcn,cn\u2032 (sn\u2032 \u2212 sn) \u03b4cn\u2032 ,k \u2032\u03b4zn\u2032 ,n ] .\nThe first line corresponds to the likelihood of the background processes; the second and third correspond to the likelihood of the induced processes triggered by each spike.\nTo derive the updates for weights, recall from Equation 3 of the main text that Wk,k\u2032 only appears in the impulse responses for which cn = k and cn\u2032 = k \u2032. so we have,\np(Wk,k\u2032 | {sn, cn, zn}Nn=1, . . .)\n\u221d N\u220f n=1\n[ exp { \u2212 \u222b T sn hk,k\u2032(\u03c4 \u2212 sn)d\u03c4 } N\u220f n\u2032=1 hk,k\u2032(sn\u2032 \u2212 sn) \u03b4cn\u2032 ,k \u2032\u03b4zn\u2032 ,n ]\u03b4cn,k \u00d7 p(Wk,k\u2032)\n= N\u220f n=1 [ exp { \u2212 \u222b T sn Ak,k\u2032Wk,k\u2032gk,k\u2032(\u03c4 \u2212 sn)d\u03c4 }\nN\u220f n\u2032=1 ( Ak,k\u2032Wk,k\u2032gk,k\u2032(sn\u2032 \u2212 sn) )\u03b4cn\u2032 ,k\u2032\u03b4zn\u2032 ,n]\u03b4cn,k \u00d7 p(Wk,k\u2032). If Ak,k\u2032 = 1 and we ignore spikes after T \u2212\u2206tmax, this is approximately proportional to\nexp { \u2212Wk,k\u2032Nk } W Nk,k\u2032 k,k\u2032 p(Wk,k\u2032),\nwhere\nNk = N\u2211 n=1 \u03b4cn,k, and Nk,k\u2032 = N\u2211 n=1 N\u2211 n\u2032=1 \u03b4cn,k\u03b4cn\u2032 ,k\u2032\u03b4zn\u2032 ,n.\nWhen p(Wk,k\u2032) is a gamma distribution, the conditional distribution is also gamma. If Ak,k\u2032 = 0, the conditional distribution reduces to the prior, as expected.\nSimilar conjugate updates can be derived for constant background rates and the impulse response parameters, as stated in the main text.\nA.2. Log Gaussian Cox Process background rates. In the Trades on the S&P100 and the Gangs of Chicago datasets, it was crucial to model the background fluctuations that were shared among all processes. However, if the background rate is allowed to vary at time scales shorter than \u2206tmax then it may obscure interactions between processes. To prevent this, we sample the Log Gaussian Cox Process (LGCP) at a sparse grid of M + 1 equally spaced points and linearly interpolate to evaluate the background rate at the exact time of each event. We have,\ny = { y\u0302 ( mT\nM )}M m=0 \u223c GP(0,K(t, t\u2032)).\nThen,\n{ \u03bb\u03020,k ( mT\nM )}M m=0 = \u00b5k + \u03b1k exp { y\u0302 ( mT M )} ,\nand \u03bb0,k(sn) is linearly interpolated between the rate at surrounding grid points. The equally spaced grid allows us to calculate the integral using the trapezoid quadrature rule. We use Elliptical Slice Sampling (Murray et al., 2010) to sample the conditional distribution of the vector y.\nKernel parameters are set empirically or with prior knowledge. For example, the period of the kernel is set to one day for the S&P100 dataset and one year for the Gangs of Chicago dataset since these are well-known trends. The scale and offset parameters have log Normal priors set such that the maximum and minimum homogeneous event counts in the training data are within two standard deviations of the expected value under the LGCP background rate. That is, the background rate should be able to explain all of the data without any observations if there is no evidence for interactions.\nA.3. Priors on hyperparameters. When possible, we sample the parameters of the prior distributions. For example, in the Erdo\u030bs-Renyi graph model we place a Beta(1, 1) prior on the sparsity \u03c1. For the latent distance model, we place a log normal prior on the characteristic length scale \u03c4 and sample it using Hamiltonian Monte Carlo.\nFor all of the results in this paper, we fixed the prior on the interaction kernel, g(\u2206t) to a weak Normal-Gamma distribution with parameters \u00b50\u00b5 = \u22121.0, \u03ba0\u00b5 = 10, \u03b10\u03c4 = 10, and \u03b20\u03c4 = 1.\nScale of gamma prior on weights.. For real data, we place an uninformative prior on the weight distribution. The gamma distribution is parameterized by a shape \u03b10W and an inverse scale or rate \u03b20W . The shape parameter \u03b1 0 W is chosen by hand (typically we use \u03b1 0 W = 2), but the inverse scale parameter \u03b20W is sampled. We may not know a proper scale a priori, however we can use a scaleinvariant Jeffrey\u2019s prior to infer this parameter as well. Jeffrey\u2019s prior is proportional to the square root of the Fisher information, which for the gamma distribution is\nPr(\u03b20W ) \u221d \u221a I(\u03b20W ) =\n\u221a \u03b10W\n\u03b20W .\nHence the posterior is\nPr(\u03b20W | {{Wk,k\u2032}}) \u221d\n\u221a \u03b10W\n\u03b20W K\u220f k=1 K\u220f k\u2032=1 (\u03b20W ) \u03b10W \u0393(\u03b10W ) W \u03b10W\u22121 k,k\u2032 e \u2212\u03b20WWk,k\u2032\n\u221d (\u03b20W )K 2\u03b10W\u22121 exp { \u2212\u03b20W K\u2211 k=1 K\u2211 k\u2032=1 Wk,k\u2032 } .\nThis is a gamma distribution with parameters,\n\u03b20W \u223c Gamma(K2\u03b10W , K\u2211 k=1 K\u2211 k\u2032=1 Wk,k\u2032)."}, {"heading": "APPENDIX B: SYNTHETIC TEST DETAILS", "text": "We generated T = 1000s of events for each synthetic network. The average number of spikes was 25,732 \u00b1 9,425. Network 6, the only network for which the GLM outperformed the network Hawkes model in the event-prediction test, was an outlier with 44,973 events. For event prediction, we trained on the first 900 seconds and tested on the last 100 seconds of the data. We ran our Markov chain for 2500 iterations and computed the posterior probabilities of A and W using the last 500 samples.\nA simple alternative to the Hawkes model is to look at cross-correlation between the event times. First, the event times are binned into an array s\u0302k of length M . Let (s\u0302k ? s\u0302k\u2032)[m] be the\ncross-correlation between s\u0302k and s\u0302k\u2032 at discrete time lag m. Then, Wk,k\u2032 = \u2211\u2206tmaxM/T\nm=0 (s\u0302k ? s\u0302k\u2032)[m] provides a simple measure of directed, excitatory interaction that can be thresholded to perform link prediction.\nAdditionally, we compare the network Hawkes process to the generalized linear model for point processes, a popular model in computational neuroscience (Paninski, 2004). Here, the event counts are modeled as s\u0302k,m \u223c Poisson(\u03bbk,m). The mean depends on external covariates and other events according to\n\u03bbk,m = exp { \u03b1Tk ym + K\u2211 k\u2032=1 B\u2211 b=1 \u03b2k,k\u2032,b(gb \u2217 s\u0302k\u2032)[m] } ,\nwhere ym is an external covariate at time m, {gb(\u2206m)}Bb=1 are a set of basis functions that model impulse responses, and \u03b1 and \u03b2 are parameters to be inferred. Under this formulation the loglikelihood of the events is concave function of the parameters and is easily maximized. Unlike the Hawkes process, however, this model allows for inhibitory interactions.\nFor link prediction, \u2211\nb \u03b2k,k\u2032,b provides a measure of directed excitatory interaction that can be used to compute an ROC curve. In our comparisons, we used ym \u2261 1 to allow for time-homogeneous background activity and set {gb(\u2206m)} to the top B = 6 principal components of a set of logistic normal impulse responses randomly sampled from the Hawkes prior.\nWe used an L1 penalty to promote sparsity in the parameters of the GLM, and chosen the penalty using cross validation on the last 100 seconds of the training data.\nFigure 3b of the main text shows the predictive log likelihoods for the Hawkes model with the correct Erdo\u0308s-Renyi prior, the standard Hawkes model with a complete graph of interactions, and a GLM. On all but network 6, the network Hawkes model outperforms the competing models in terms of predictive log likelihood. Table 7 shows the average predictive performance across sample nextworks. The standard Hawkes and the GLM provide only 59.2% and 71.6%, respectively, of this predictive power."}, {"heading": "APPENDIX C: TRADES ON THE S&P100 MODEL DETAILS", "text": "We study the trades on the S&P 100 index collected at 1s intervals during the week of Sep. 28 through Oct. 2, 2009. We group both positive and negative changes in price into the same process in order to measure overall activity. Another alternative would be to generate an \u201cuptick\u201d and a \u201cdowntick\u201d process for each stock. We ignored trades outside regular trading hours because they tend to be outliers with widely varying prices. Since we are interested in short term interactions, we chose \u2206tmax = 60s. This also limits the number of potential event parents. If we were interested in interactions over longer durations, we would have to threshold the price changes at a higher level. We precluded self-excitation for this dataset since upticks are often followed by downticks and vice-versa. We are seeking to explain these brief price jumps using the activity of other stocks.\nWe run our Markov chain for 2000 iterations and compute predictive log likelihoods and the eigenvalues of the expected interaction matrix, E[A W ], using the last 400 iterations of the chain. The posterior sample illustrated in the main text is the last sample of the chain.\nTrading volume varies substantially over the course of the day, with peaks at the opening and closing of the market. This daily variation is incorporated into the background rate via a Log Gaussian Cox Process with a periodic kernel. We set the period to one day. Figure 8 shows the posterior distribution over the background rate.\nThough it is not discussed in the main text, we also considered stochastic block model (SBM) priors as well (Hoff, 2008), in hopes of recovering latent sector affiliations based on patterns of interaction between sectors. For example, stocks in the financial sector may have 90% probability of interacting with one another, and 30% probability of interacting with stocks in the energy sector. Rather than trying to interpret this from the embedding of a latent distance model, we can capture this belief explicitly with a stochastic block model prior on connectivity. We suppose there are J sectors, and the probability of belonging to a given sector is \u03b1 \u2208 [0, 1]J \u223c Dirichlet(\u03b10). The latent sector assignments are represented by the vector b \u2208 [1, J ]K , where bk \u223c Cat(\u03b1). The probability of a directed interaction is Pr(Ak,k\u2032 = 1) = Bbk,bk\u2032 , where B is a J \u00d7 J matrix of Bernoulli probabilities. We place a beta prior on the entries of B.\nOur experiments with the SBM prior yield comparable predictive performance to the latent distance prior, as shown in Figure 9. The inferred clusters (not shown) are correlated with the clusters identified by Bloomberg.com, but more analysis is needed. It would also be interesting to study the difference in inferred interactions under the various graph models; this is left for future work."}, {"heading": "APPENDIX D: GANGS OF CHICAGO MODEL DETAILS", "text": "The first 12 years are used for training, 1993 is reserved for cross-validation, and the remaining two years are used to test the predictive power of the models. We also considered the crime dataset from www.data.cityofchicago.org, but this does not identify gang-related incidents.\nWe run our Markov chain for 700 iterations and use the last 200 iterations to compute predictive likelihoods and expectations. The posterior sample illustrated in the figure in main text is the last sample of the chain. Since this is a spatiotemporal dataset, our intensities are functions of both spatial location and time. For simplicity we factorize the intensity into \u03bbk,x(x)\u03bbk,t(t), where \u03bbk,t(t) is a Gaussian process as described above, and \u03bbk,x(x) is uniformly distributed over the spatial region associated with process k and is normalized such that it integrates to 1.\nIn the case of the latent distance model with the community process model, each community\u2019s location is fixed to its center of mass. With the cluster process model, we introduce a latent location for each cluster and use a Gaussian distribution for the prior probability that a community belongs to a cluster. This encourages spatially localized clusters.\nFigure 10 shows the cross validation results used to select the number of clusters, K, in the clustered process identity model and each of the four graph models. For the empty, complete, and Erdo\u0308s-Renyi graph priors, we discover K = 15, 4, and 4 clusters respectively. The latent distance model, with its prior for spatially localized clusters, has its best performance for K = 5 clusters.\nThe spatial GMM process ID model from Cho et al. (2013) fails on this dataset because it assigns its spatial intensity over all of R2, whereas the clustering model concentrates the rate on only the communities in which the data resides. Figure 11 shows the results of this spatial process ID model on the prediction task. We did not test a latent distance model with the spatial GMM, but it would likely suffer in the same way as the empty, complete, and Erdo\u030bs-Renyi graph priors."}], "references": [{"title": "Representations for partially exchangeable arrays of random variables", "author": ["Aldous", "David J"], "venue": "Journal of Multivariate Analysis,", "citeRegEx": "Aldous and J.,? \\Q1981\\E", "shortCiteRegEx": "Aldous and J.", "year": 1981}, {"title": "Street gang crime in Chicago. US Department of Justice, Office of Justice Programs", "author": ["Block", "Carolyn R", "Richard"], "venue": "National Institute of Justice,", "citeRegEx": "Block et al\\.,? \\Q1993\\E", "shortCiteRegEx": "Block et al\\.", "year": 1993}, {"title": "Modelling reciprocating relationships with Hawkes processes", "author": ["Blundell", "Charles", "Heller", "Katherine", "Beck", "Jeffrey"], "venue": "Advances in Neural Information Processing Systems,", "citeRegEx": "Blundell et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Blundell et al\\.", "year": 2012}, {"title": "Latent point process models for spatialtemporal networks", "author": ["Cho", "Yoon Sik", "Galstyan", "Aram", "Brantingham", "Jeff", "Tita", "George"], "venue": null, "citeRegEx": "Cho et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Cho et al\\.", "year": 2013}, {"title": "Inferring neural firing rates from spike trains using Gaussian processes", "author": ["Cunningham", "John P", "Yu", "Byron M", "Sahani", "Maneesh", "Shenoy", "Krishna V"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "Cunningham et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Cunningham et al\\.", "year": 2007}, {"title": "An introduction to the theory of point processes", "author": ["Daley", "Daryl J", "Vere-Jones", "David"], "venue": null, "citeRegEx": "Daley et al\\.,? \\Q1988\\E", "shortCiteRegEx": "Daley et al\\.", "year": 1988}, {"title": "A survey of statistical network models", "author": ["Goldenberg", "Anna", "Zheng", "Alice X", "Fienberg", "Stephen E", "Airoldi", "Edoardo M"], "venue": "Foundations and Trends in Machine Learning,", "citeRegEx": "Goldenberg et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Goldenberg et al\\.", "year": 2010}, {"title": "Spectra of some self-exciting and mutually exciting point processes", "author": ["Hawkes", "Alan G"], "venue": null, "citeRegEx": "Hawkes and G.,? \\Q1971\\E", "shortCiteRegEx": "Hawkes and G.", "year": 1971}, {"title": "Modeling homophily and stochastic equivalence in symmetric relational data", "author": ["Hoff", "Peter D"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Hoff and D.,? \\Q2008\\E", "shortCiteRegEx": "Hoff and D.", "year": 2008}, {"title": "Relations on probability spaces and arrays of random variables", "author": ["Hoover", "Douglas N"], "venue": "Technical report, Institute for Advanced Study, Princeton,", "citeRegEx": "Hoover and N.,? \\Q1979\\E", "shortCiteRegEx": "Hoover and N.", "year": 1979}, {"title": "Discovering latent influence in online social activities via shared cascade Poisson processes", "author": ["Iwata", "Tomoharu", "Shah", "Amar", "Ghahramani", "Zoubin"], "venue": "In Proceedings of the 19th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining,", "citeRegEx": "Iwata et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Iwata et al\\.", "year": 2013}, {"title": "The link-prediction problem for social networks", "author": ["Liben-Nowell", "David", "Kleinberg", "Jon"], "venue": "Journal of the American society for information science and technology,", "citeRegEx": "Liben.Nowell et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Liben.Nowell et al\\.", "year": 2007}, {"title": "Random function priors for exchangeable arrays with applications to graphs and relational data", "author": ["Lloyd", "James Robert", "Orbanz", "Peter", "Ghahramani", "Zoubin", "Roy", "Daniel M"], "venue": "Advances in Neural Information Processing Systems,", "citeRegEx": "Lloyd et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Lloyd et al\\.", "year": 2012}, {"title": "Bayesian and L1 approaches for sparse unsupervised learning", "author": ["Mohamed", "Shakir", "Ghahramani", "Zoubin", "Heller", "Katherine A"], "venue": "In Proceedings of the 29th International Conference on Machine Learning,", "citeRegEx": "Mohamed et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Mohamed et al\\.", "year": 2012}, {"title": "Log gaussian cox processes", "author": ["M\u00f8ller", "Jesper", "Syversveen", "Anne Randi", "Waagepetersen", "Rasmus Plenge"], "venue": "Scandinavian Journal of Statistics,", "citeRegEx": "M\u00f8ller et al\\.,? \\Q1998\\E", "shortCiteRegEx": "M\u00f8ller et al\\.", "year": 1998}, {"title": "Machine learning: a probabilistic perspective", "author": ["Murphy", "Kevin P"], "venue": null, "citeRegEx": "Murphy and P.,? \\Q2012\\E", "shortCiteRegEx": "Murphy and P.", "year": 2012}, {"title": "Elliptical slice sampling", "author": ["Murray", "Iain", "Adams", "Ryan P", "MacKay", "David J.C"], "venue": "Journal of Machine Learning Research: Workshop and Conference Proceedings (AISTATS),", "citeRegEx": "Murray et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Murray et al\\.", "year": 2010}, {"title": "Maximum likelihood estimation of cascade point-process neural encoding models", "author": ["Paninski", "Liam"], "venue": "Network: Computation in Neural Systems,", "citeRegEx": "Paninski and Liam.,? \\Q2004\\E", "shortCiteRegEx": "Paninski and Liam.", "year": 2004}, {"title": "Murder by structure: Dominance relations and the social structure of gang homicide", "author": ["Papachristos", "Andrew V"], "venue": "American Journal of Sociology,", "citeRegEx": "Papachristos and V.,? \\Q2009\\E", "shortCiteRegEx": "Papachristos and V.", "year": 2009}, {"title": "Point process modelling for directed interaction networks", "author": ["Perry", "Patrick O", "Wolfe", "Patrick J"], "venue": "Journal of the Royal Statistical Society: Series B (Statistical Methodology),", "citeRegEx": "Perry et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Perry et al\\.", "year": 2013}, {"title": "The spectral radii and norms of large dimensional non-central random matrices", "author": ["Silverstein", "Jack W"], "venue": "Stochastic Models,", "citeRegEx": "Silverstein and W.,? \\Q1994\\E", "shortCiteRegEx": "Silverstein and W.", "year": 1994}, {"title": "Modeling events with cascades of Poisson processes", "author": ["Simma", "Aleksandr", "Jordan", "Michael I"], "venue": "Proceedings of the 26th Conference on Uncertainty in Artificial Intelligence (UAI),", "citeRegEx": "Simma et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Simma et al\\.", "year": 2010}, {"title": "Learning social infectivity in sparse low-rank networks using multidimensional Hawkes processes", "author": ["Zhou", "Ke", "Zha", "Hongyuan", "Song", "Le"], "venue": "In Proceedings of the International Conference on Artificial Intelligence and Statistics,", "citeRegEx": "Zhou et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Zhou et al\\.", "year": 2013}], "referenceMentions": [{"referenceID": 6, "context": ", Liben-Nowell & Kleinberg (2007); Hoff (2008); Goldenberg et al. (2010). In this paper we are concerned with implicit networks that cannot be observed directly, but about which we wish to perform analysis.", "startOffset": 48, "endOffset": 73}, {"referenceID": 12, "context": "See Lloyd et al. (2012) for an overview.", "startOffset": 4, "endOffset": 24}, {"referenceID": 12, "context": "Stochastic block models, latent eigenmodels, and their nonparametric extensions all fall under this class (Lloyd et al., 2012).", "startOffset": 106, "endOffset": 126}, {"referenceID": 13, "context": "It allows us to express our separate beliefs about the sparsity structure of the interaction network and the strength of the interactions through a spike-and-slab prior on A and W (Mohamed et al., 2012).", "startOffset": 180, "endOffset": 202}, {"referenceID": 14, "context": "To capture these shared background fluctuations, we use a sparse Log Gaussian Cox process (M\u00f8ller et al., 1998) to model the background rate: \u03bb0,k(t) = \u03bck + \u03b1k exp{y(t)}, y(t) \u223c GP(0,K(t, t\u2032)).", "startOffset": 90, "endOffset": 111}, {"referenceID": 2, "context": "In this case, we may place a spatial Gaussian mixture model over the cn\u2019s, as in Cho et al. (2013). Alternatively, we may be given the label of the community in which the incident occurred, but we suspect that interactions occur between clusters of communities.", "startOffset": 81, "endOffset": 99}, {"referenceID": 2, "context": "In this case we can use a simple clustering model or a nonparametric model like that of Blundell et al. (2012).", "startOffset": 88, "endOffset": 111}, {"referenceID": 16, "context": "We use elliptical slice sampling (Murray et al., 2010) for this purpose.", "startOffset": 33, "endOffset": 54}, {"referenceID": 4, "context": "previous work on Poisson processes with Gaussian process intensities in our background rate models (Cunningham et al., 2007).", "startOffset": 99, "endOffset": 124}, {"referenceID": 12, "context": "Our fully-Bayesian approach generalizes this method to capitalize on recent developments in random network models (Lloyd et al., 2012) and allows for nonparametric background rates.", "startOffset": 114, "endOffset": 134}, {"referenceID": 2, "context": "previous work on Poisson processes with Gaussian process intensities in our background rate models (Cunningham et al., 2007). An expectation-maximization inference algorithm for Hawkes processes was put forth by Simma & Jordan (2010) and applied to very large social network datasets.", "startOffset": 100, "endOffset": 234}, {"referenceID": 2, "context": "Blundell et al. (2012) combine Hawkes processes and the Infinite Relational Model (a specific exchangeable graph model with an Aldous-Hoover representation) to cluster processes and discover interactions.", "startOffset": 0, "endOffset": 23}, {"referenceID": 2, "context": "Blundell et al. (2012) combine Hawkes processes and the Infinite Relational Model (a specific exchangeable graph model with an Aldous-Hoover representation) to cluster processes and discover interactions. Cho et al. (2013) applied Hawkes processes to gang incidents in Los Angeles.", "startOffset": 0, "endOffset": 223}, {"referenceID": 2, "context": "Blundell et al. (2012) combine Hawkes processes and the Infinite Relational Model (a specific exchangeable graph model with an Aldous-Hoover representation) to cluster processes and discover interactions. Cho et al. (2013) applied Hawkes processes to gang incidents in Los Angeles. They developed a spatial Gaussian mixture model (GMM) for process identities, but did not explore structured network priors. We experimented with this process identity model but found that it suffers in predictive log likelihood tests (see supplementary material). Recently, Iwata et al. (2013) developed a stochastic EM algorithm for Hawkes processes, leveraging similar conjugacy properties, but without network priors.", "startOffset": 0, "endOffset": 577}, {"referenceID": 2, "context": "Blundell et al. (2012) combine Hawkes processes and the Infinite Relational Model (a specific exchangeable graph model with an Aldous-Hoover representation) to cluster processes and discover interactions. Cho et al. (2013) applied Hawkes processes to gang incidents in Los Angeles. They developed a spatial Gaussian mixture model (GMM) for process identities, but did not explore structured network priors. We experimented with this process identity model but found that it suffers in predictive log likelihood tests (see supplementary material). Recently, Iwata et al. (2013) developed a stochastic EM algorithm for Hawkes processes, leveraging similar conjugacy properties, but without network priors. Zhou et al. (2013) have developed a promising optimization-based approach to discovering low-rank networks in Hawkes processes, similar to some of the network models we explored.", "startOffset": 0, "endOffset": 723}, {"referenceID": 2, "context": "Blundell et al. (2012) combine Hawkes processes and the Infinite Relational Model (a specific exchangeable graph model with an Aldous-Hoover representation) to cluster processes and discover interactions. Cho et al. (2013) applied Hawkes processes to gang incidents in Los Angeles. They developed a spatial Gaussian mixture model (GMM) for process identities, but did not explore structured network priors. We experimented with this process identity model but found that it suffers in predictive log likelihood tests (see supplementary material). Recently, Iwata et al. (2013) developed a stochastic EM algorithm for Hawkes processes, leveraging similar conjugacy properties, but without network priors. Zhou et al. (2013) have developed a promising optimization-based approach to discovering low-rank networks in Hawkes processes, similar to some of the network models we explored. Perhaps the most closely related work is that of Perry & Wolfe (2013). They provide a partial likelihood inference algorithm for Hawkes processes with a similar emphasis on structural patterns in the network of interactions.", "startOffset": 0, "endOffset": 953}, {"referenceID": 16, "context": "We use Elliptical Slice Sampling (Murray et al., 2010) to sample the conditional distribution of the vector y.", "startOffset": 33, "endOffset": 54}, {"referenceID": 3, "context": "The spatial GMM process ID model from Cho et al. (2013) fails on this dataset because it assigns its spatial intensity over all of R2, whereas the clustering model concentrates the rate on only the communities in which the data resides.", "startOffset": 38, "endOffset": 56}], "year": 2014, "abstractText": "Networks play a central role in modern data analysis, enabling us to reason about systems by studying the relationships between their parts. Most often in network analysis, the edges are given. However, in many systems it is difficult or impossible to measure the network directly. Examples of latent networks include economic interactions linking financial instruments and patterns of reciprocity in gang violence. In these cases, we are limited to noisy observations of events associated with each node. To enable analysis of these implicit networks, we develop a probabilistic model that combines mutuallyexciting point processes with random graph models. We show how the Poisson superposition principle enables an elegant auxiliary variable formulation and a fully-Bayesian, parallel inference algorithm. We evaluate this new model empirically on several datasets.", "creator": "LaTeX with hyperref package"}}}