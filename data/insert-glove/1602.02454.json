{"id": "1602.02454", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "8-Feb-2016", "title": "Efficient Algorithms for Adversarial Contextual Learning", "abstract": "We clubb provide pyay the 81.75 first 13:49 oracle cuadernos efficient altaic sublinear regret algorithms career-spanning for 340s adversarial motherships versions of atcha the epicene contextual bandit scions problem. thirumal In wdiv-tv this landschaft problem, the learner folbre repeatedly makes mcgrigor an 186,000 action a-fella on the claycourter basis 32.82 of a medog context and receives reward caidic for ebbesen the santander chosen matile action, itzamnaaj with groupon the dragostea goal anvil of achieving reward competitive inputted with vojska a large class 100-point of fun policies. We analyze muqur two settings: i) robeck in muska the neac transductive lampropeltis setting blatas the learner dmch knows non-bailable the allergan set damelin of centrebus contexts m\u00e9tropolitaine a mid-tempo priori, ii) in the small fifty-eight separator lubumbashi setting, there exists javanese a kanya small alkiza set of pressurizing contexts vidin such that excitedly any two unitus policies edman behave differently branes in one senry\u016b of mcmonagle the shirou contexts petite in the hurewitz set. Our algorithms toehold fall into zarb the n17 follow donisthorpe the perturbed fredo leader family \\ italian cite {uppercut Kalai2005} lingkaran and morlaix achieve regret $ O (marinera T ^ {kalynychenko 3 / 4} \\ toscana sqrt {liga K \\ log (charring N) }) $ in the transductive savviness setting kdam and $ tennes O (vore T ^ {vigne 2 / 51.98 3} larrionda d ^ {pechiney 3 / 4} cabildo K \\ amarapura sqrt {\\ pipra log (N) }) $ rrw in hijinks the szadek separator setting, reaches where $ K $ mualla is cannes the ffo number of actions, $ rancher N $ grinberg is 4,252 the number ddr-oberliga of complying baseline policies, zhuoru and $ filmmaking d $ is clasen the arnon size glaudini of co-directing the dunshaughlin separator. lebrock We fumarolic actually two-and-a-half-year solve beitun the highland more brane general robocall adversarial contextual semi - bandit linear yune optimization w-league problem, valedictory whilst 28.02 in earthrise the ober full information setting seifert we elvy address tetbury the shah even mona more igbe general korangi contextual combinatorial optimization. kuklinski We yet-to-be provide interloper several extensions historic-cultural and deylam implications of ahmadis our algorithms, brakeforce such as switching regret and efficient learning with predictable contractures sequences.", "histories": [["v1", "Mon, 8 Feb 2016 03:11:39 GMT  (74kb)", "http://arxiv.org/abs/1602.02454v1", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["vasilis syrgkanis", "akshay krishnamurthy", "robert e schapire"], "accepted": true, "id": "1602.02454"}, "pdf": {"name": "1602.02454.pdf", "metadata": {"source": "META", "title": "Efficient Algorithms for Adversarial Contextual Learning", "authors": ["Vasilis Syrgkanis", "Akshay Krishnamurthy", "Robert E. Schapire"], "emails": ["VASY@MICROSOFT.COM", "AKSHAYKR@CS.CMU.EDU", "SCHAPIRE@MICROSOFT.COM"], "sections": [{"heading": null, "text": "ar X\niv :1\n60 2.\n02 45\n4v 1\n[ cs\n.L G\n] 8\nF eb\n\u221a\nK log(N)) in the transductive setting and O(T 2/3d3/4K \u221a\nlog(N)) in the separator setting, where K is the number of actions, N is the number of baseline policies, and d is the size of the separator. We actually solve the more general adversarial contextual semi-bandit linear optimization problem, whilst in the full information setting we address the even more general contextual combinatorial optimization. We provide several extensions and implications of our algorithms, such as switching regret and efficient learning with predictable sequences."}, {"heading": "1. Introduction", "text": "We study contextual online learning, a powerful framework that encompasses a wide range of sequential decision making problems. Here, on every round, the learner receives\ncontextual information which can be used as an aid in selecting an action. In the full-information version of the problem, the learner then observes the loss that would have been suffered for each of the possible actions, while in the much more challenging bandit version, only the loss that was actually incurred for the chosen action is observed. The contextual bandit problem is of particular practical relevance, with applications to personalized recommendations, clinical trials, and targeted advertising.\nAlgorithms for contextual learning, such as Hedge (Freund & Schapire, 1997; Cesa-Bianchi et al., 1997) and Exp4 (Auer et al., 1995), are well-known to have remarkable theoretical properties, being effective even in adversarial, non-stochastic environments, and capable of performing almost as well as the best among an exponentially large family of policies, or rules for choosing actions at each step. However, the space requirements and running time of these algorithms are generally linear in the number of policies, which is far too expensive for a great many applications which call for an extremely large policy space. In this paper, we address this gap between the statistical promise and computational challenge of algorithms for contextual online learning in an adversarial setting.\nAs an approach to solving online learning problems, we posit that the corresponding batch version is solvable. In other words, we assume access to a certain optimization oracle for solving an associated batch-learning problem. Concrete instances of such an oracle include empirical risk minimization procedures for supervised learning, algorithms for the shortest paths problem, and dynamic programming.\nSuch an oracle is central to the Follow-the-PerturbedLeader algorithms of Kalai & Vempala (2005), although these algorithms are not generally efficient since they require separately \u201cperturbing\u201d each policy in the entire\nspace. Oracles of this kind have also been used in designing efficient contextual bandit algorithms (Agarwal et al., 2014; Langford & Zhang, 2008; Dud\u0131\u0301k et al., 2011); however, these require a much more benign setting in which contexts and losses are chosen randomly and independently rather than by an adversary.\nIn this paper, for a wide range of problems, we present computationally efficient algorithms for contextual online learning in an adversarial setting, assuming oracle access. We give results for both the full-information and bandit settings. To the best of our knowledge, these results are the first of their kind at this level of generality.\nOverview of results. We begin by proposing and analyzing in Section 2 a new and general Follow-the-PerturbedLeader algorithm in the style of Kalai & Vempala (2005). This algorithm only accesses the policy class using the optimization oracle.\nWe then apply these results in Section 3 to two settings. The first is a transductive setting (Ben-David et al., 1997) in which the learner knows the set of arriving contexts a priori, or, less stringently, knows only the set, but not necessarily the actual sequence or multiplicity with which each context arrives. In the second, small-separator setting, we assume that the policy space admits the existence of a small set of contexts, called a separator, such that any two policies differ on at least one context from the set. The size of the smallest separator for a particular policy class can be viewed as a new measure of complexity, different from the VC dimension, and potentially of independent interest.\nWe study these for a generalized online learning problem called online combinatorial optimization, which includes as special cases transductive contextual experts, online shortest-path routing, online linear optimization (Kalai & Vempala, 2005), and online submodular minimization (Hazan & Kale, 2012).\nIn Section 4, we extend our results to the bandit setting, or in fact, to the more general semi-bandit setting, using a technique of Neu & Barto\u0301k (2013). Among our main results, we obtain regret bounds for the adversarial contextual bandit problem of O(T 3/4 \u221a\nK log(N)) in the transductive setting, and O(T 2/3d3/4K \u221a\nlog(N)) in the smallseparator setting, where T is the number of time steps, K the number of actions, N the size of the policy space, and d the size of the separator. Being sublinear in T , these bounds imply the learner\u2019s performance will eventually be almost as good as the best policy, although they are worse than the generally optimal dependence on T of O( \u221a T ), obtained by many of the algorithms mentioned above. On the other hand, these preceding algorithms are computationally intractable when the policy space is gigantic, while ours runs in polynomial time, assuming access to an optimization or-\nacle. Improving these bounds without sacrificing computational efficiency remains an open problem.\nIn Section 5, we give an efficient algorithm when regret is measured in comparison to a competitor that is allowed to switch from one policy to another a bounded number of times. Here, we show that the optimization oracle can be efficiently implemented given an oracle for the original policy class. Specifically, this leads to a fully efficient algorithm for the online switching shortest path problem in directed acyclic graphs.\nFinally, Section 6 shows how \u201cpath length\u201d regret bounds can be derived in the style of Rakhlin & Sridharan (2013b). Such bounds have various applications, for instance, in obtaining better bounds for playing repeated games (Rakhlin & Sridharan, 2013a; Syrgkanis et al., 2015).\nOther related work. Contextual, transductive online learning using an optimization oracle was previously studied by Kakade & Kalai (2005), whose work was later extended and improved by Cesa-Bianchi & Shamir (2011) using a generalization of a technique from Cesa-Bianchi et al. (1997). However, these previous results are for binary classification or other convex losses defined on one-dimensional predictions and outcomes; as such, they are special cases of the much more general setting we consider in the present paper.\nAwerbuch & Kleinberg (2008) present an efficient algorithm for the online shortest paths problem. This can be viewed as solving an adversarial bandit problem with a very particular optimization oracle over an exponentially large but highly structured space of \u201cpolicies\u201d corresponding to paths in a graph. However, their setting is clearly far more restrictive and structured than ours is."}, {"heading": "2. Online Learning with Oracles", "text": "We start by analyzing the family of Follow the Perturbed Leader algorithms in a very general online learning setting. Parts of this generic formulation follow the recent formulation of Daskalakis & Syrgkanis (2015), but we present a more refined analysis which is essential for our contextual learning result in the next sections. The main theorem of this section is essentially a generalization of Theorem 1.1 of Kalai & Vempala (2005).\nConsider an online learning problem where at each timestep an adversary picks an outcome yt \u2208 Y and the algorithm picks a policy \u03c0t \u2208 \u03a0 from some policy space \u03a0.1 The algorithm receives a loss: \u2113(\u03c0t, yt), which could be\n1We refer to the choice of the learner as a policy, for uniformity of notation with subsequent sections, where the learner will choose some policy that maps contexts to actions.\npositive or negative. At the end of each iteration the algorithm observes the realized outcome yt. We will denote with y1:t a sequence of outcomes {y1, y2, . . . , yt}. Moreover, we denote with:\nL(\u03c0, y1:t) = t \u2211\n\u03c4=1\n\u2113(\u03c0, y\u03c4 ), (1)\nthe cumulative utility of a fixed policy \u03c0 \u2208 \u03a0 for a sequence of choices y1:t of the adversary. The goal of the learning algorithm is to achieve loss that is competitive with the best fixed policy in hindsight. As the algorithms we consider will be randomized, we will analyze the expected regret,\nREGRET = sup \u03c0\u22c6\u2208\u03a0 E\n[\nT \u2211\nt=1\n\u2113(\u03c0t, yt)\u2212 T \u2211\nt=1\n\u2113(\u03c0\u22c6, yt)\n]\n, (2)\nwhich is the worst case difference between the cumulative loss of the learner and the loss of any fixed policy \u03c0 \u2208 \u03a0. We consider adversaries that are adaptive, which means that they can choose the outcome yt at time t, using knowledge of the entire history of interaction. The only knowledge not available to an adaptive adversary is any randomness used by the learning algorithm at time t. In contrast, an oblivious adversary is one that picks the sequence of outcomes y1:T before the start of the learning process.\nTo develop computationally efficient algorithms that compete with large sets of policies \u03a0, we assume that we are given oracle access to the following optimization problem.\nDefinition 1 (Optimization oracle). Given outcomes y1:t compute the fixed optimal policy for this sequence:\nM ( y1:t ) = argmin\u03c0\u2208\u03a0L(\u03c0, y1:t). (3)\nWe will also assume that the oracle performs consistent deterministic tie-breaking: i.e. whenever two policies are tied, then it always outputs the same policy.\nIn this generic setting, we define a new family of FollowThe-Perturbed-Leader (FTPL) algorithms where the perturbation takes the form of extra samples of outcomes (see Algorithm 1). In each round, the learning algorithm draws a random sequence of outcomes independently, and appends this sequence to the outcomes experienced during the learning process. The algorithm invokes the oracle on this augmented outcome sequence, and plays the resulting policy.\nPerturbed Leader Regret Analysis. We give a general theorem on the regret of a perturbed leader algorithm with sample perturbations. In the sections that follow we will give instances of this analysis in specific settings.\nAlgorithm 1 Follow the perturbed leader with fake sample perturbations - FTPL.\nfor each time step t do Draw a random sequence of outcomes {z} = (z1, . . . , . . . , zk) independently, based on some timeindependent distribution over sequences. Both the length of the sequence and the outcome zi \u2208 Y at each iteration of the sequence can be random Denote with {z} \u222a y1:t\u22121 the augmented sequence where we append the extra outcome samples {z} at the beginning of sequence y1:t\u22121\nInvoke oracle M and play policy:\n\u03c0t = M ( {z} \u222a y1:t\u22121 ) . (4)\nend for\nTheorem 1. For a distribution over sample sequences {z} and a sequence of adversarially and adaptively chosen outcomes y1:T , define:\nSTABILITY = T \u2211\nt=1\nE{z} [ \u2113(\u03c0t, yt)\u2212 \u2113(\u03c0t+1, yt) ]\nERROR = E{z}\n\nmax \u03c0\u2208\u03a0\n\u2211\nz\u03c4\u2208{z} \u2113(\u03c0, z\u03c4 )\n\n\n\u2212 E{z}\n\nmin \u03c0\u2208\u03a0\n\u2211\nz\u03c4\u2208{z} \u2113(\u03c0, z\u03c4)\n\n ,\nwhere \u03c0t is defined in Equation (4). Then the expected regret of Algorithm 1 is upper bounded by,\nREGRET \u2264 STABILITY + ERROR. (5)\nThis theorem shows that any FTPL-variant where the perturbation can be described as a random sequence of outcomes has regret bounded by the two terms STABILITY and ERROR. Below we will instantiate this theorem to obtain concrete regret bounds for several problems.\nThe proof of the theorem is based on a well-known \u201cbethe-leader\u201d argument. We first show that if we included the tth loss vector in the oracle call at round t, we would have regret bounded by ERROR, and then we show that the difference between our algorithm and this foreseeing one is bounded by STABILITY. See Appendix A for the proof."}, {"heading": "3. Adversarial Contextual Learning", "text": "Our first specialization of the general setting is to contextual online combinatorial optimization. In this learning setting, at each iteration, the learning algorithm picks a binary\nAlgorithm 2 Contextual Follow the Perturbed Leader Algorithm - CONTEXT-FTPL(X, \u01eb).\nInput: parameter \u01eb, set of contexts X , policies \u03a0. for each time step t do\nDraw a sequence {z} = (z1, . . . , zd) of d fake samples. The context associated with sample zx is equal to x and each coordinate of the loss vector \u2113x is drawn i.i.d. from a Laplace(\u01eb) Pick and play according to policy\n\u03c0t = M({z} \u222a y1:t\u22121) (6)\nend for\naction vector at \u2208 A \u2286 {0, 1}K , from some feasibility set A. We will interchangeably use at both as a vector and as the set {j \u2208 [K] : at(j) = 1}. The adversary picks a outcome yt = (xt, f t) where xt belongs to some context space X and f t : A \u2192 R is a cost function that maps each feasible action vector a \u2208 A to a cost f t(a). The goal of the learning algorithm is to achieve low regret relative to a set of policies \u03a0 \u2282 (X \u2192 A) that map contexts to feasible action vectors. At each iteration the algorithm picks a policy \u03c0t and incurs a cost \u2113(\u03c0t, yt) = f t(\u03c0t(xt)). In this section, we consider the full-information problem, where after each round, the entire loss function f t is revealed to the learner. Online versions of a number of important learning tasks, including cost-sensitive classification, multi-label prediction, online linear optimization (Kalai & Vempala, 2005) and online submodular minimization (Hazan & Kale, 2012) are all special cases of the contextual online combinatorial optimization problem, as we will see below.\nContextual Follow the Perturbed Leader. We will analyze the performance of an instantiation of the FTPL algorithm in this setting. To specialize the algorithm, we need only specify the distribution from which the sequence of fake outcomes {z} is drawn at each time-step. This distribution is parameterized by a subset of contexts X \u2286 X , with |X | = d and a noise parameter \u01eb. We draw the sequence {z} as follows: for each context x \u2208 X , we add the fake sample zx = (x, fx) where fx is a linear loss function based on a loss vector \u2113x \u2208 RK , meaning that fx(a) = \u3008a, \u2113x\u3009. Each coordinate of the loss vector \u2113x is drawn from a independent Laplace distribution with parameter \u01eb, i.e. for each coordinate j \u2208 [K] the density of \u2113x(j) at q is f(q) = \u01eb2 exp{\u2212\u01eb|q|}. The latter distribution has mean 0 and variance 2\u01eb2 . Using this distribution for fake samples gives an instantiation of Algorithm 1, which we refer to as CONTEXT-FTPL(X, \u01eb) (see Algorithm 2).\nWe analyze CONTEXT-FTPL(X, \u01eb) in two settings: the transductive setting and the small separator setting.\nDefinition 2. In the transductive setting, at the beginning of the learning process, the adversary reveals to the learner the set of contexts that will arrive, although the ordering and multiplicity need not be revealed.\nDefinition 3. In the small separator setting, there exists a set X \u2282 X such that for any two distinct policies \u03c0, \u03c0\u2032 \u2208 \u03a0, there exists x \u2208 X such that \u03c0(x) 6= \u03c0\u2032(x).\nIn the transductive setting, the set X that we use in CONTEXT-FTPL(X, \u01eb) is precisely this set of contexts that will arrive, which by assumption is available to the learning algorithm. In this small separator setting, the set X used by CONTEXT-FTPL is the separating set. This enables nontransductive learning, but one must be able to compute a small separator prior to learning. Below we will see examples where this is possible.\nWe now turn to bounding the regret of CONTEXT-FTPL(X, \u01eb). Let d = |X | be the number of contexts that are used in the definition of the noise distribution, let N = |\u03a0| \u2264 dK , and let m denote the maximum number of non-zero coordinates that any policy can choose on any context, i.e. m = maxa\u2208A \u2016a\u20161. Even though at times we might constrain the sequence of loss functions that the adversary can pick (e.g. linear non-negative losses), we will assume that the oracle M can handle at least linear loss functions with both positive and negative coordinates. Our main result is:\nTheorem 2 (Complete Information Regret). CONTEXT-FTPL(X, \u01eb) achieves regret against any adaptively and adversarially chosen sequence of contexts and loss functions:\n1. In the transductive setting:\nREGRET \u2264 4\u01ebK \u00b7 T \u2211\nt=1\nE [ \u2016f t\u20162\u2217 ]\n+ 10\n\u01eb\n\u221a dm log(N)\n2. In the transductive setting, when loss functions are linear and non-negative, i.e. f t(a) = \u3008a, \u2113t\u3009 with \u2113t \u2208 RK\u22650:\nREGRET \u2264 \u01eb \u00b7 T \u2211\nt=1\nE [ \u3008\u03c0t(xt), \u2113t\u30092 ] + 10\n\u01eb\n\u221a dm log(N)\n3. In the small separator setting:\nREGRET \u2264 4\u01ebKd \u00b7 T \u2211\nt=1\nE [ \u2016f t\u20162\u2217 ]\n+ 10\n\u01eb\n\u221a dm log(N)\nwhere \u2016f t\u2016\u2217 = maxa\u2208A |f t(a)|.\nWhen \u01eb is set optimally, loss functions are in [0, 1], and loss vectors are in [0, 1]K , these give regret:2 O ( (dm)1/4 \u221a KT log(N) ) in the first set-\nting, O ( d1/4m5/4 \u221a T log(N) ) in the second and\nO ( m1/4d3/4 \u221a KT log(N) ) in the third.\nTo prove the theorem we separately upper bound the STABILITY and the ERROR terms and then Theorem 2 follows from Theorem 1. One key step is a refined ERROR analysis that leverages the symmetry of the Laplace distribution to obtain a bound with dependence \u221a d rather than d. This is possible only if the perturbation is centered about zero, and therefore does not apply to other FPTL variants that use non-negative distributions such as exponential or uniform (Kalai & Vempala, 2005). Due to lack of space we defer proof details to Appendix B.\nThis general theorem has implications for many specific settings that have been extensively studied in the literature. We turn now to some examples.\nExample 1. (Transductive Contextual Experts) The contextual experts problem is the online version of costsensitive multiclass classification, and the full-information version of the widely-studied contextual bandit problem. The setting is as above, but A corresponds to sets with cardinality 1, meaning that m = 1 in our formulation. As a result, CONTEXT-FTPL can be applied as is, and the second claim in Theorem 2 shows that the algorithm has regret at most O ( d1/4 \u221a T log(N) ) if at most d contexts\narrive. In the worst case this bound is O(T 3/4 \u221a\nlog(N)), since the adversary can choose at most T contexts. To our knowledge, this is the first fully oracle-efficient algorithm for online adversarial cost-sensitive multiclass classification, albeit in the transductive setting.\nThis result can easily be lifted to infinite policy classes that have small Natarajan Dimension (a multi-class analog of VC-dimension), since such classes behave like finite ones once the set of contexts is fixed. Thus, in the transductive setting, Theorem 2 can be applied along with the analog of the Sauer-Shelah lemma, leading to a sublinear regret bound for classes with finite Natarajan dimension. On the other hand, in the non-transductive case it is possible to construct examples where achieving sublinear regret against a VC class is information-theoretically hard, demonstrating a significant difference between the two settings. See Corollary 15 and Theorem 16 in the Appendix E for details on these arguments.\nExample 2. (Non-contextual Shortest Path Routing and Linear Optimization) For the case when the linear op-\n2Observe that when loss vectors are in [0, 1]K , then the linear loss function is actually in [0, m] not in [0, 1].\ntimization corresponds to computing the shortest (s, t)path in a DAG, then K and m equal to the number of edges and the problem can be solved in poly-time even when edge costs are negative. More generally, CONTEXT-FTPL can also be applied to non-contextual problems, which is a special case where d = 1. In such a case, CONTEXT-FTPL reduces to the classical FTPL algorithm with Laplace instead of Exponential noise, and Theorem 2 matches existing results for online linear optimization (Kalai & Vempala, 2005). In particular, for problems without context, CONTEXT-FTPL has regret that scales with \u221a T .\nExample 3. (Online sub-modular minimization) A special case of our setting is the online-submodular minimization problem studied in previous work (Hazan & Kale, 2012; Jegelka & Bilmes, 2011). As above, this is a non-contextual online combinatorial optimization problem, where the loss function f t presented at each round is submodular. Here, CONTEXT-FTPL reduces to the strongly polynomial algorithm of Hazan & Kale (2012), although our noise follows a Laplace instead of Uniform distribution. A straightforward application of the first claim of Theorem 2 shows that CONTEXT-FTPL achieves regret at most O(KH \u221a\nT log(K)) if the losses are bounded in [\u2212H,H ], and a slightly refined analysis of the error terms gives O(KH \u221a T ) regret. This matches the FTPL analysis of Hazan & Kale (2012), although they also develop an algorithm based on online convex optimization that achieves O(H \u221a KT ) regret.\nExample 4. (Contextual Experts with linear policy classes) The third clause of Theorem 2 gives strong guarantees for the non-transductive contextual experts problem, provided one can construct a small separating set of contexts. Often this is possible, and we provide some examples here.\n1. For binary classification where the policies are boolean disjunctions (conjunctions) over n binary variables, the set of 1-sparse (n \u2212 1-sparse) boolean vectors form a separator of size n. This is easy to see as two disjunctions must disagree on at least one variable, so they will make different predictions on the vector that is non-zero only in that component. Note that the size of the small separator is independent of the time horizon T and logarithmic in the number of policies. Thus, Theorem 2 shows that CONTEXT-FTPL suffers at most O( \u221a T log(N)) re-\ngret since d = log(N),m = 1 and K = 2.\n2. For binary classification in n dimensions, consider a discretization of linear classifiers defined as follows, the separating hyperplane of each classifier is defined by choosing the intercept with each axis from one of\nO(1/\u03c4) values (possibly including something denoting no intercept). Then a small separator includes, for each axis, one point between each pair in the discretization, for a total of O(n/\u03c4) points. This follows since any two distinct classifiers have different intercepts for at least one axis, and our small separator has one point between these two different intercepts, leading to different predictions. Note that the number of classifiers in the discretization is O(\u03c4\u2212n). Here Theorem 2 shows that CONTEXT-FTPL suffers at most O(n \u221a T\n\u03c43/4 (log( 1\u03c4 )) 1/4) regret since N = O(\u03c4\u2212n), d = n \u03c4 ,m = 1 and K = 2. This bound has a undesireable polynomial dependence on the discretization resolution \u03c4 but avoids exponential dimension dependence.\nThus we believe that the smallest separator size for a policy class can be viewed as a new complexity measure, which may be of independent interest."}, {"heading": "4. Linear Losses and Semi-Bandit Feedback", "text": "In this section, we consider contextual learning with semibandit feedback and linear non-negative losses. At each round t of this learning problem, the adversary chooses a non-negative vector \u2113t \u2208 RK\u22650 and sets the loss function to f t(a) = \u3008a, \u2113t\u3009. The learner chooses an action at \u2208 A \u2282 {0, 1}K accumulates loss f t(at) and observes \u2113t(j) for each j \u2208 at. In other words, the learner observes the coefficients for only the elements in the set that he picked. Notice that if A is the one-sparse vectors, then this setting is equivalent to the well-studied contextual bandit problem (Langford & Zhang, 2008).\nSemi-bandit algorithm. Our semi-bandit algorithm proceeds as follows: At each iteration it makes a call to CONTEXT-FTPL(\u01eb), which returns a policy \u03c0t and implies a chosen action at = \u03c0t(xt). The algorithm plays the action at, observes the coordinates of the loss {\u2113t(j)}j\u2208at and proceeds to construct an proxy loss vector \u2113\u0302t, which it passes to the instance of CONTEXT-FTPL, before proceeding to the next round.\nTo describe the construction of \u2113\u0302t, let pt(\u03c0) = Pr[\u03c0t = \u03c0|Ht\u22121] denote the probability that CONTEXT-FTPL returns policy \u03c0 at time-step t conditioned on the past history (observed losses and contexts, chosen actions, current iteration\u2019s context, internal randomness etc., which we denote with Ht\u22121). For any element j \u2208 [K], let:\nqt(j) = \u2211\n\u03c0\u2208\u03a0:j\u2208\u03c0(xt) pt(\u03c0) (7)\ndenote the probability that element j is included in the action chosen by CONTEXT-FTPL(X, \u01eb) at time-step t.\nTypical semi-bandit algorithms aim to construct proxy loss vectors by dividing the observed coordinates of the loss by the probabilities qt(j) and setting other coordinates to zero, which is the well-known inverse propensity scoring mechanism (Horvitz & Thompson, 1952). Unfortunately, in our case, the probabilities qt(j) stem from randomness fed into the oracle, so that they are implicit maintained and therefore must be approximated.\nWe therefore construct \u2113\u0302t through a geometric sampling scheme due to Neu & Barto\u0301k (2013). For each j \u2208 \u03c0t(xt), we repeatedly invoke the current execution of the CONTEXT-FTPL algorithm with fresh noise, until it returns a policy that includes j in its action for context xt. The process is repeated at most L times for each j \u2208 \u03c0t(xt) and the number of invocations is denoted J t(j). The vector \u2113\u0302t that is returned to the full feedback algorithm is zero for all j /\u2208 \u03c0t(xt), and for each j \u2208 \u03c0t(xt) it is \u2113\u0302t(j) = J t(j) \u00b7 \u2113t(j). By Lemma 1 of Neu & Barto\u0301k (2013), this process yields a proxy loss vector \u2113\u0302t that satisfies,\nE\n[ \u2113\u0302t(j) | Ht\u22121 ] = ( 1\u2212 ( 1\u2212 qt(j) )L ) \u2113t(j). (8)\nThe semi-bandit algorithm feeds this proxy loss vector to the CONTEXT-FTPL instance and proceeds to the next round.\nThe formal description of the complete bandit algorithm is given in Algorithm 3 and we refer to it as CONTEXT-SEMI-BANDIT-FTPL(X, \u01eb, L). We bound its regret in the transductive and small separator setting.\nTheorem 3. The expected regret of CONTEXT-SEMI-BANDIT-FTPL(X, \u01eb, L) in the semibandit setting against any adaptively and adversarially chosen sequence of contexts and linear non-negative losses, with \u2016\u2113t\u2016\u2217 \u2264 1, is at most:\n\u2022 In the transductive setting:\nREGRET \u2264 2\u01ebmKT + 10 \u01eb\n\u221a dm log(N) + KT\neL\n\u2022 In the small separator setting:\nREGRET \u2264 8\u01ebK2dLmT+10 \u01eb\n\u221a dm log(N)+ KT\neL\nFor L = \u221a KT and optimal \u01eb, the regret is O ( d1/4m3/4 \u221a KT log(N) ) in the first setting.\nFor L = T 1/3 and optimal \u01eb, the regret is O ( (md)3/4KT 2/3 \u221a log(N) ) in the second setting.\nMoreover, each iteration of the algorithm requires mL oracle calls and otherwise runs in polynomial time in d,K .\nAlgorithm 3 Contextual Semi-Bandit Algorithm - CONTEXT-SEMI-BANDIT-FTPL(X, \u01eb, L).\nInput: parameter \u01eb,M , set of contexts X , policies \u03a0. Let D denote a distribution over a sequence of d samples, {z} = (z1, . . . , zd), where the context associated with sample zx is equal to x and each coordinate of the loss vector \u2113x is drawn i.i.d. from a Laplace(\u01eb) for each time-step t do\nDraw a sequence {z}t from distribution D. Pick and play according to policy\n\u03c0t = M({z} \u222a (x1:t\u22121, \u2113\u03021:t\u22121)) (9)\nObserve loss \u2113t(j) for each j \u2208 \u03c0t(xt) Set \u2113\u0302t(j) = 0 for any j /\u2208 \u03c0t(xt) Set \u2113\u0302t(j) = J t(j) \u00b7 \u2113t(j), for each j \u2208 \u03c0t(xt), where J t(j) is computed by the following geometric sampling process: for each element j \u2208 \u03c0t(xt) do\nfor each iteration i = 1, . . . , L do Draw a sequence {y}i from distribution D. Compute \u03c0i = M({y}i \u222a (x1:t\u22121, \u2113\u03021:t\u22121)) If j \u2208 \u03c0i(xt) then stop and return J t(j) = i\nend for end for If process finished without setting J t(j), then set J t(j) = L\nend for\nThis is our main result for adversarial variants of the contextual bandit problem. In the most well-studied setting, i.e. contextual bandits, we have m = 1, so our regret bound is O(d1/4 \u221a\nKT log(N)) in the transductive setting and O(d3/4KT 2/3 \u221a\nlog(N)) in the small separator setting. Since for the transductive case d \u2264 T and for the small-separator case d can be independent of T (see discussion above), this implies sublinear regret for adversarial contextual bandits in either setting. To our knowledge this is the first oracle-efficient sublinear regret algorithm for variants of the contextual bandit problem. However, as we mentioned before, neither regret bound matches the optimal O( \u221a\nKT log(N)) rate for this problem, which can be achieved by computationally intractable algorithms. An interesting open question is to develop computationally efficient, statistically optimal contextual bandit algorithms."}, {"heading": "5. Switching Policy Regret", "text": "In this section we analyze switching regret for the contextual linear optimization setting, i.e. regret that compares to the best sequence of policies that switches at most k times. Such a notion of regret was first analyzed by Herbster & Warmuth (1998) and several algo-\nrithms, that are not computationally efficient for large policy spaces, have been designed since then (e.g. (Luo & Schapire, 2015)). Our results provide the first computationally efficient switching regret algorithms assuming offline oracle access.\nFor this setting we will assume that the learner knows the exact sequence x1:T of contexts ahead of time and not only the set of potential contexts. The extension stems from the realization that we can simply think of time t as part of the context at time-step t. Thus now the contexts are of the form x\u0303t = (t, xt). Moreover, policies in the augmented context space are now of the form: \u03c0\u0303(x\u0303t) = \u03c0I(t)(xt), where I(t) is a selector which maps a time-step t to a policy \u03c0 \u2208 \u03a0, with the constraint that the number of time-steps such that I(t) 6= I(t \u2212 1) is at most k. If the original policy space \u03a0 was of size N , the new policy space, denoted \u03a0\u0303, is of size N\u0303 at most T kNk, since there are at most T k partitions of time into k consequetive intervals and each of the k intervals can be occupied by N possible policies. Moreover, in this augmented context space, the number of possible contexts, denoted X\u0303 is equal to d\u0303 = T .\nThus if we run CONTEXT-FTPL(X, \u01eb) on this augmented context and policy space, Theorem 2, bounds the regret against all policies in the augmented policy space \u03a0\u0303. Since, regret against the augmented policy space, corresponds to switching regret against the original set of policies, the following corollary is immediate:\nCorollary 4 (Contextual Switching Regret). In the transductive complete information setting, CONTEXT-FTPL(X\u0303, \u01eb) applied to the augmented policy space \u03a0\u0303, achieves k-switching regret against any adaptively and adversarially chosen sequence of contexts and losses at most: O ( m1/4 \u221a Kk log(TN)T 3/4 ) for general\nloss functions in [0, 1] and O ( \u221a k log(TN)m5/4T 3/4 )\nfor linear losses with loss vectors in [0, 1]K .\nIt remains to show is that we can efficiently solve the offline optimization problem for the new policy space \u03a0\u0303, if we have access to an optimization oracle for the original policy space \u03a0. Then we can claim that CONTEXT-FTPL(X\u0303, \u01eb) in the augmented context and policy space is also an efficient algorithm. We show that the latter is true via a dynamic programming approach. The approach generalizes beyond contextual linear optimization settings.\nLemma 5. The oracle M\u0303 in the augmented space,\nM\u0303(y\u03031:T ) = arginf\u03c0\u0303\u2208\u03a0\u0303\nT \u2211\n\u03c4=1\n\u3008\u03c0\u0303(\u03c4, x\u03c4 ), \u2113\u03c4 \u3009 (10)\nis computable in O(Tk) time, with O(T 2) calls to the oracle over the original space, M . This process can be amor-\ntized so that solving a sequence of T problems in the augmented space requires O(T 2) calls to M in total.\nProof. Oracle M\u0303 must compute the best sequence of policies \u03c01, . . . , \u03c0T , such that \u03c0t 6= \u03c0t\u22121 at most k times. Let R(t, q) denote the loss of the optimal sequence of policies up to time-step t and with at most q switches. Then it is easy to see that:\nR(t, q) = min \u03c4\u2264t\nR(\u03c4, q\u22121)+L ( M(y\u03c4+1:t), y\u03c4+1:t ) , (11)\ni.e. compute the best sequence of policies up till some time step \u03c4 \u2264 t with at most q\u2212 1 switches and then augment it with the optimal fixed policy for the period (\u03c4 +1, t). Then take the best over possible times \u03c4 \u2264 t. This can be implemented by first invoking oracle M for every possible period [\u03c41, \u03c42]. Then filling up iteratively all the entries R(t, q). For q = 0, the problem R(t, 0) corresponds to exactly the original oracle problem M , hence for each t, we can solve the problem R(t, 0). Computing all values of R(t, q) then takes time Tk in total.\nExample 5. (Efficient switching regret for non-contextual problems) When the original space has no contexts, our result above implies the first efficient sub-linear switching regret algorithm for online linear optimization. In this case, the transductivity assumption is trivially satisfied as there is no contextual information, and our the instance of CONTEXT-FTPL runs on a sequence of contexts that just encode time. One concrete example where linear optimization with both positive and negative weights is polynomially solvable is the online shortest path problem on a directed acyclic graph. Our result implies a fully efficient, sublinear switching regret algorithm for the online shortest-path problem on a DAG, and our algorithm performs t shortest-path computations at the tth iteration. The result also covers other examples, such as online matroid optimization."}, {"heading": "6. Efficient Path Length Regret Bounds", "text": "In this section we examine a variant of our CONTEXT-FTPL(\u01eb) algorithm that is efficient and achieves regret that is upper bounded by structural properties of the utility sequence. Our algorithm is framed in terms of a generic predictor that the learner has access to and the regret is upper bounded by the deviation of the true loss vector from the predictor. For specific instances of the predictor this leads to path length bounds (Chiang et al., 2012) or variance based bounds (Hazan & Kale, 2010). Our approach is general enough to allow for generalizations of variance and path length that can incorportate contextual information and can be viewed as an efficient version and a generalization of\nthe results of Rakhlin & Sridharan (2013b) on learning with predictable sequences. Such results have also found applications in learning in game theoretic environments (Rakhlin & Sridharan, 2013a; Syrgkanis et al., 2015).\nThe algorithm is identical to CONTEXT-FTPL(\u01eb) with the exception that now the policy that is used at time-step t is:\n\u03c0t = M({z} \u222a y1:t\u22121 \u222a (xt, Qt)) (12)\nwhere Qt \u2208 {0, 1}K \u2192 RK is an arbitrary loss function predictor, which can depend on the observed history up to time t. This predictor can be interpreted as partial side information that the learner has about the loss function that will arrive at time-step t. Given such a predictor we can define the error between the predictor and the actual sequence:\nEt = E [ \u2016f t \u2212Qt\u20162\u2217 ]\n(13)\nTheorem 6 (Predictor based regret bounds). The regret of CONTEXT-FTPL(X, \u01eb) with predictors and complete information,\n1. In the transductive setting is upper bounded by:\nREGRET \u2264 4\u01ebK T \u2211\nt=1\nEt + 10 \u221a dm log(N)\n\u01eb\n2. In the small separator setting is upper bounded by:\nREGRET \u2264 4\u01ebKd T \u2211\nt=1\nEt + 10 \u221a dm log(N)\n\u01eb\nPicking \u01eb optimally gives regret\nO\n(\n(dm)1/4 \u221a K log(N) \u2211T t=1 Et ) in the first set-\nting and O\n(\nm1/4d3/4 \u221a K log(N) \u2211T t=1 Et ) in the\nsecond.\nEven without contexts, our result is the first efficient path length regret algorithm for online combinatorial optimization. For instance, for the case of non-contextual, online combinatorial optimization an instantiation of our al-\ngorithm achieves regret O\n(\nm1/4 \u221a K log(K) \u2211T t=1 Et )\nagainst adaptive adversaries. For learning with expert, m = 1 and K is number of experts, the results of Rakhlin & Sridharan (2013b) provide a non-efficient\nO\n(\n\u221a\nlog(K) \u2211T t=1 Et ) . Thus our bound incurs an extra\ncost of \u221a K in comparison. Removing this extra factor of\u221a\nK in an efficient manner is an interesting open question."}, {"heading": "7. Discussion", "text": "In this work we give fully oracle efficient algorithms for adversarial online learning problems including contextual\nexperts, contextual bandits, and problems involving linear optimization or switching experts. Our main algorithmic contribution is a new Follow-The-Perturbed-Leader style algorithm that adds perturbed low-dimensional statistics. We give a refined analysis for this algorithm that guarantees sublinear regret for all of these problems. All of our results hold against adaptive adversaries, both with full and partial feedback.\nWhile our algorithms achieve sublinear regret in all problems we consider, we do not always match the regret bounds attainable by inefficient alternatives. An interesting direction for future work is whether fully oracle-based algorithms can achieve optimal regret bounds in the settings we consider. Another interesting direction focuses on a deeper understanding of the small-separator condition and whether it enables efficient non-transductive learning in other settings. We look forward to studying these questions in future work."}, {"heading": "A. Omitted Proofs from Section 2", "text": ""}, {"heading": "A.1. Proof of Theorem 1", "text": "We prove the theorem by analyzing a slightly modified algorithm, that only draws the perturbation once at the beginning of the learning process but is otherwise identical. The bulk of the proof is devoted to bounding this modified algorithm\u2019s regret against oblivious adversaries, i.e. an adversary that chooses the outcomes y1:T before the learning process begins. We use this regret bound along with a reduction due to Hutter and Poland (Hutter & Poland, 2005) (see their Lemma 12) to obtain a regret bound for Algorithm 1 against adaptive adversaries. We provide a proof of this reduction in Appendix A.2 and proceed here with the analysis of the modified algorithm.\nTo bound the regret of the modified algorithm, consider letting the algorithm observe yt ahead of time, so that at each time step t, the algorithm plays \u03c0t+1 = M ( {z} \u222a y1:t ) . Notice trivially that the regret of the modified algorithm is,\nREGRET = T \u2211\nt=1\n\u2113(\u03c0t, yt)\u2212min \u03c0\u2208\u03a0\n\u2113(\u03c0\u2217, yt) = T \u2211\nt=1\n\u2113(\u03c0t, yt)\u2212 \u2113(\u03c0t+1, yt) + T \u2211\nt=1\n\u2113(\u03c0t+1, yt)\u2212min \u03c0\u2208\u03a0 \u2113(\u03c0\u2217, yt)\nThe first sum here is precisely the STABILITY term in the bound, so we must show that the second sum is bounded by ERROR. This is proved by induction in the following lemma.\nLemma 7 (Be-the-leader with fixed sample perturbations). For any realization of the sample sequence {z} and for any policy \u03c0\u2217:\nT \u2211\nt=1\n( \u2113(\u03c0t+1, yt)\u2212 \u2113(\u03c0\u2217, yt) ) \u2264 max \u03c0\u2208\u03a0\n\u2211\nz\u03c4\u2208{z} \u2113(\u03c0, z\u03c4 )\u2212min \u03c0\u2208\u03a0\n\u2211\nz\u03c4\u2208{z} \u2113(\u03c0, z\u03c4 ) (14)\nProof. Denote with k the length of sequence {z}. Consider the sequence {z} \u222a y1:T and let a1 = M({z}). We will show that for any policy \u03c0\u2217:\nk \u2211\n\u03c4=1\n\u2113(\u03c01, z\u03c4 ) +\nT \u2211\nt=1\n\u2113(\u03c0t+1, yt) \u2264 k \u2211\n\u03c4=1\n\u2113(\u03c0\u2217, z\u03c4 ) + T \u2211\nt=1\n\u2113(\u03c0\u2217, yt) (15)\nFor T = 0, the latter trivially holds by the definition of a1. Suppose it holds for some T , we will show that it holds for T + 1. Since the induction hypothesis holds for any \u03c0\u2217, applying it for aT+2, i.e.,:\nk \u2211\n\u03c4=1\n\u2113(\u03c01, z\u03c4 ) +\nT+1 \u2211\nt=1\n\u2113(\u03c0t+1, yt) \u2264 k \u2211\n\u03c4=1\n\u2113(\u03c0T+2, z\u03c4 ) +\nT \u2211\nt=1\n\u2113(\u03c0T+2, yt) + \u2113(\u03c0T+2, yT+1)\n=\nk \u2211\n\u03c4=1\n\u2113(\u03c0T+2, z\u03c4 ) +\nT+1 \u2211\nt=1\n\u2113(\u03c0T+2, yt)\nBy definition of aT+2 the latter is at most: \u2211k \u03c4=1 \u2113(\u03c0 \u2217, z\u03c4 ) + \u2211T+1 t=1 \u2113(\u03c0 \u2217, yt) for any \u03c0\u2217. Which proves the induction step. Thus, by re-arranging Equation (15) we get:\nT \u2211\nt=1\n( \u2113(\u03c0t+1, yt)\u2212 \u2113(\u03c0\u2217, yt) ) \u2264 k \u2211\n\u03c4=1\n( \u2113(\u03c0\u2217, z\u03c4)\u2212 \u2113(\u03c01, z\u03c4) ) \u2264 max \u03c0\u2208\u03a0\nk \u2211\n\u03c4=1\n\u2113(\u03c0, z\u03c4 )\u2212min \u03c0\u2208\u03a0\nk \u2211\n\u03c4=1\n\u2113(\u03c0, z\u03c4 )\nThus the regret of the modified algorithm against an oblivious adversary is bounded by STABILITY+ERROR. By applying the reduction of Hutter and Poland (Hutter & Poland, 2005) (see Appendix A.2 for a proof sketch), the regret of Algorithm 1 is bounded is bounded in the same way.\nA.2. From adaptive to oblivious adversaries\nWe will utilize a generic reduction provided in Lemma 12 of (Hutter & Poland, 2005), which states that given that in Algorithm 1 we draw independent randomization at each iteration, it suffices to provide a regret bound only for oblivious adversaries, i.e., the adversary picks a fixed sequence y1:T ahead of time without observing the policies of the player. Moreover, for any such fixed sequence of an oblivious adversary, the expected utility of the algorithm can be easily shown to be equal to the expected utility if we draw a single random sequence {z} ahead of time and use the same random vector all the time.\nThe proof is as follows: by linearity of expectation and the fact that each sequence {z}t drawn at each time-step t is identically distributed:\nE{z}1,...,{z}t\n[\nT \u2211\nt=1\nu(M({z}t \u222a y1:t\u22121), yt) ] = T \u2211\nt=1\nE{z}t [ u(M({z}t \u222a y1:t\u22121), yt) ]\n=\nT \u2211\nt=1\nE{z}1 [ u(M({z}1 \u222a y1:t\u22121), yt) ]\n=E{z}1\n[\nT \u2211\nt=1\nu(M({z}1 \u222a y1:t\u22121), yt) ]\nThe latter is equivalent to the expected reward if we draw a single random sequence {z} ahead of time and use the same random vector all the time. Thus it is sufficient to upper bound the regret of this modified algorithm, which draws randomness only once.\nThus it is sufficient to upper bound the regret of this modified algorithm, which draws randomness only once."}, {"heading": "B. Omitted Proofs from Section 3", "text": ""}, {"heading": "B.1. Bounding the Laplacian Error", "text": "The upper bound on the ERROR term is identical in all settings, since it only depends on the input noise distribution, which is the same for all variants and for which it does not matter whether X is the set of contexts that will arrive or a separator. In subsequent sections we will upper bound the stability of the algorithm in each setting.\nLemma 8 (Laplacian Error Bound). Let {z} denote a sample from the random sequence of fake samples used by CONTEXT-FTPL(X, \u01eb). Then:\nERROR = E{z}\n[\nmax \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n\u2212 E{z}\n[\nmin \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n\u2264 10 \u01eb\n\u221a dm log(N) (16)\nProof. First we start by observing that each random variable \u2113x(j) is distributed i.i.d. according to a Laplace(\u01eb) distribution. Since a Laplace distribution is symmetric around 0, we get that \u2113x(j) and \u2212\u2113x(j) are distributed identically. Thus we can write:\nE{z}\n[\nmin \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n= E{z}\n[\nmin \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x),\u2212\u2113x\u3009\n]\n= \u2212E{z}\n[\nmax \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\nHence we get:\nERROR = 2 \u00b7 E{z}\n[\nmax \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n(17)\nWe now bound the latter expectation via a moment generating function approach. For any \u03bb \u2265 0:\nE{z}\n[\nmax \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n= 1\n\u03bb E{z}\n[\nmax \u03c0\u2208\u03a0\n\u03bb \u2211\nx\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n= 1\n\u03bb log\n{\nexp\n{\nE{z}\n[\nmax \u03c0\u2208\u03a0\n\u03bb \u2211\nx\u2208X \u3008\u03c0(x), \u2113x\u3009\n]}}\nBy convexity and monotonicity of the exponential function:\nE{z}\n[\nmax \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n\u2264 1 \u03bb log\n{\nE{z}\n[\nmax \u03c0\u2208\u03a0 exp\n{\n\u03bb \u2211\nx\u2208X \u3008\u03c0(x), \u2113x\u3009\n}]}\n\u2264 1 \u03bb log\n{\n\u2211 \u03c0\u2208\u03a0 E{z}\n[\nexp\n{\n\u03bb \u2211\nx\u2208X \u3008\u03c0(x), \u2113x\u3009\n}]}\n\u2264 1 \u03bb log\n{\n\u2211\n\u03c0\u2208\u03a0\n\u220f\nx\u2208X E [exp {\u03bb\u3008\u03c0(x), \u2113x\u3009}]\n}\n= 1\n\u03bb log\n\n\n\n\u2211\n\u03c0\u2208\u03a0\n\u220f\nx\u2208X E\n\nexp\n\n\n\n\u03bb \u2211\nj:\u03c0(x)(j)=1\n\u2113x(j)\n\n\n\n\n\n\n\n\n= 1\n\u03bb log\n\n\n\n\u2211\n\u03c0\u2208\u03a0\n\u220f\nx\u2208X\n\u220f\nj:\u03c0(x)(j)=1\nE [exp {\u03bb\u2113x(j)}]\n\n\n\nFor any j \u2208 [K] and x \u2208 X , \u2113x(j) is a Laplace(\u01eb) random variable. Hence, the quantity E [exp{\u03bb\u2113x(j)}] is the moment generating function of the Laplacian distribution evaluated at \u03bb, which is equal to 1\n1\u2212\u03bb2 \u01eb2\nprovided that \u03bb < \u01eb. Since\nsupx,\u03c0 |{j \u2208 [K] : \u03c0(x)(j)}| \u2264 m, we get:\nE{z}\n[\nmax \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n\u2264 1 \u03bb log\n\n\n\nN\n(\n1\n1\u2212 \u03bb2\u01eb2\n)dm \n\n\n= 1\n\u03bb log(N) +\ndm\n\u03bb log\n(\n1\n1\u2212 \u03bb2\u01eb2\n)\nBy simple calculus, it is easy to derive that 11\u2212x \u2264 e2x for any x \u2264 14 .3 Thus as long as we pick \u03bb \u2264 \u01eb2 , we get:\nE{z}\n[\nmax \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n]\n\u2264 1 \u03bb log(N) + dm \u03bb log\n(\nexp\n{\n\u03bb2\n\u01eb2\n})\n= 1\n\u03bb log(N) +\n2dm\u03bb\n\u01eb2\nPicking \u03bb = \u01eb 2 \u221a dm and since N \u2265 2:\nE{z}\n[\nmax \u03c0\u2208\u03a0\n\u2211 x\u2208X \u3008\u03c0(x), \u2113x\u3009\n] \u2264 2 \u221a dm log(N)\n\u01eb +\n\u221a 2dm\n\u01eb \u2264 5\n\u221a dm log(N)\n\u01eb"}, {"heading": "B.2. Bounding Stability: Transductive Setting", "text": "We now turn to bounding the stability in the transductive combinatorial optimization setting. Combining the following lemma with the error bound in Lemma 8 and applying Theorem 1 proves the first claim of Theorem 2.\n3 Consider the function f(x) = (1\u2212 x)e2x \u2212 1. Then f(0) = 0 and f \u2032(x) = e2x(1\u2212 2x), which is \u2265 0 for 0 \u2264 x \u2264 1/2.\nLemma 9 (Transductive Stability). For all t \u2208 [T ] and for any sequence y1:t of contexts x1:t and loss functions f1:t with f i : {0, 1}K \u2192 RK , the stability of CONTEXT-FTPL(X, \u01eb) is upper bounded by:\nE{z} [ f t(\u03c0t(xt))\u2212 f t(\u03c0t+1(xt)) ] \u2264 4\u01ebK \u00b7 \u2016f t\u20162\u2217\nProof. By the definition of \u2016f t\u2016\u2217:\nE{z} [ f t(\u03c0t(xt))\u2212 f t(\u03c0t+1(xt)) ] \u2264 2\u2016f t\u2016\u2217 Pr [ \u03c0t(xt) 6= \u03c0t+1(xt) ]\nNow observe that:\nPr [ \u03c0t(xt) 6= \u03c0t+1(xt) ] \u2264 \u2211\nj\u2208K\n( Pr[j \u2208 \u03c0t(xt), j /\u2208 \u03c0t+1(xt)] + Pr[j /\u2208 \u03c0t(xt), j \u2208 \u03c0t(xt)] )\nWe bound the probability Pr[j \u2208 \u03c0t(xt), j /\u2208 \u03c0t+1(xt)]. We condition on all random variables of {z} except for the random variable \u2113xt(j), i.e. the random loss placed at coordinate j on the sample associated with context xt. Denote the event corresponding to an assignment of all these other random variables as E\u2212xtj . Let \u2113xtj denote a loss vector which is \u2113xt(j) on the j-th coordinate and zero otherwise. Also let:\n\u03a6(\u03c0) =\nt\u22121 \u2211\n\u03c4=1\nf \u03c4 (\u03c0(x\u03c4 )) + \u2211\nx\u2208X\u2212{xt} \u3008\u03c0(x), \u2113x\u3009+ \u3008\u03c0(xt), \u2113xt \u2212 \u2113xtj\u3009 (18)\nLet \u03c0\u2217 = argmin\u03c0\u2208\u03a0:j\u2208\u03c0(xt)\u03a6(\u03c0) and \u03c0\u0303 = min\u03c0\u2208\u03a0:j /\u2208\u03c0(xt) \u03a6(\u03c0). The event that {j \u2208 \u03c0t(xt)} happens only if:\n\u03a6(\u03c0\u2217) + \u2113xt(j) \u2264 \u03a6(\u03c0\u0303) (19)\nLet and \u03bd = \u03a6(\u03c0\u0303)\u2212 \u03a6(\u03c0\u2217). Thus j \u2208 \u03c0t(xt) only if:\n\u2113xt(j) \u2264 \u03bd (20)\nNow if: \u2113xt(j) < \u03bd \u2212 2\u2016f t\u2016\u2217 (21)\nthen it is easy to see that {j \u2208 \u03c0t+1(xt)}, since an extra loss of f t(a) \u2208 [0, 1] cannot push j out of the optimal solution. More elaborately, for any other policy \u03c0 \u2208 \u03a0, such that j /\u2208 \u03c0(xt), the loss of \u03c0\u2217 including time-step t is bounded as:\n\u03a6(\u03c0\u2217) + \u2113xt(j) + f t(\u03c0\u2217(xt)) < \u03a6(\u03c0)\u2212 2\u2016f t\u2016\u2217 + f t(\u03c0\u2217(xt))\n< \u03a6(\u03c0)\u2212 \u2016f t\u2016\u2217 < \u03a6(\u03c0) + f t(\u03c0(xt))\nThus any policy \u03c0, such that j /\u2208 \u03c0(xt) is suboptimal after seeing the loss at time-step t. Thus\nPr[j \u2208 \u03c0t(xt), j /\u2208 \u03c0t+1(xt) | E\u2212xtj ] \u2264 Pr[\u2113xt(j) \u2208 [\u03bd \u2212 2\u2016f t\u2016\u2217, \u03bd] | E\u2212xtj ]\nSince all other random variables are independent of \u2113xt(j) and \u2113xt(j) is a Laplacian with parameter \u01eb:\nPr[\u2113xt(j) \u2208 [\u03bd \u2212 2\u2016f t\u2016\u2217, \u03bd] | E\u2212xtj ] = Pr[\u2113xt(j) \u2208 [\u03bd \u2212 2\u2016f t\u2016\u2217, \u03bd]]\n= \u01eb\n2\n\u222b \u03bd\n\u03bd\u22122\u2016ft\u2016\u2217 e\u2212\u01eb|z|dz \u2264 \u01eb 2\n\u222b \u03bd\n\u03bd\u22122\u2016ft\u2016\u2217 dz \u2264 \u01eb\u2016f t\u2016\u2217\nSimilarly it follows that that: Pr[j /\u2208 \u03c0t(xt) and j \u2208 \u03c0t+1(xt)] \u2264 \u01eb\u2016f t\u2016\u2217. To sum we get that:\nE{z} [ f t(\u03c0t(xt))\u2212 f t(\u03c0t+1(xt)) ] \u2264 2\u2016f t\u2016\u2217 Pr [ \u03c0t(xt) 6= \u03c0t+1(xt) ] \u2264 4\u01ebK\u2016f t\u20162\u2217"}, {"heading": "B.3. Bounding Stability: Transductive Setting with Linear Losses", "text": "In the transductive setting with linear losses, we provide a significantly more refined stability bound, which enables applications to partial information or bandit settings. As before, combining this stability bound with the error bound in Lemma 8 and applying Theorem 1 gives the second claim of Theorem 2. Lemma 10 (Multiplicative Stability). For any sequence y1:T for all t \u2208 [T ] of contexts and non-negative linear loss functions, the stability of CONTEXT-FTPL(X, \u01eb) in the transductive setting, is upper bounded by:\nE{z} [ \u3008\u03c0t(xt), \u2113t\u3009 \u2212 \u3008\u03c0t+1(xt), \u2113t\u3009 ] \u2264 \u01eb \u00b7 E [ \u3008\u03c0t(xt), \u2113t\u30092 ]\nProof. To prove the result we first must introduce some additional terminology. For a sequence of parameters y1:t, let \u03c6t \u2208 RdK be a vector with \u03c6tx,j = \u2211 \u03c4\u2264t:x\u03c4=x \u2113 \u03c4 (j). The component of this vector corresponding to context x \u2208 X and coordinate j \u2208 [K] is the cumulative loss associated with that coordinate on the subset of time points when context x appeared. Note that this vector \u03c6t is a sufficient statistic, since for any fixed policy \u03c0:\nt \u2211\n\u03c4=1\n\u2113(\u03c0, y\u03c4 ) = \u2211\nx\u2208X\n\u2211\n\u03c4\u2264t:x\u03c4=x \u3008\u03c0(x), \u2113\u03c4 \u3009 =\n\u2211 x\u2208X \u3008\u03c0(x), \u03c6tx\u3009 (22)\nwhere \u03c6tx = \u2211 \u03c4\u2264t:x\u03c4=x \u2113 \u03c4 .\nWe denote with z \u2208 RdK the sufficient statistic that corresponds to the fake sample sequence {z} and with \u03c6t the sufficient statistics for the parameter sequence y1:t. Observe that the sufficient statistic for the augmented sequence {z} \u222a y1:t is simply z + \u03c6t. For any sequence of parameters y1:T we will be denoting with \u03c61:T the sequence of d \u00b7 K dimensional cumulative loss vectors. We will also overload notation and denote with M(\u03c6t) = M(y1:t) the best policy on a sequence y1:t with statistics \u03c6t.\nConsider a specific sequence y1:T and a specific time step t. Define, for each \u03c0 \u2208 \u03a0, a sparse tuple yt\u03c0 = (xt, \u2113t\u03c0) where \u2113t\u03c0(j) = \u2113\nt(j) if \u03c0(xt)(j) = 1 and zero otherwise, i.e. we zero out coordinates of the true loss vector that were not picked by the policy \u03c0. Moreover, define with \u03c6t\u03c0 the sufficient statistic of the sequence \u03c6(y\n1:t\u22121 \u222a yt\u03c0) for each \u03c0. We define 1 + |\u03a0| distributions over |\u03a0|, via their probability density functions, as follows:\npt(\u03c0) = Pr[M(z + \u03c6t\u22121) = \u03c0]\n\u2200\u03c0\u2217 \u2208 \u03a0 : pt+1\u03c0\u2217 (\u03c0) = Pr [ M(z + \u03c6t\u03c0\u2217) = \u03c0 ]\nAt the end of this proof, we will show that pt+1\u03c0 (\u03c0) \u2264 pt+1(\u03c0). Moreover, we denote for convenience: FTPL t = Ez [\u3008\u03c0t(xt), \u2113t\u3009] = E\u03c0\u223cpt [ \u3008\u03c0(xt), \u2113t\u3009 ]\nBTPL t = Ez [\u3008\u03c0t+1(xt), \u2113t\u3009] = E\u03c0\u223cpt+1\n[ \u3008\u03c0(xt), \u2113t\u3009 ]\nWe will construct a mapping \u00b5\u03c0 : RdK \u2192 RdK such that for any z \u2208 RdK , M(z + \u03c6t\u03c0) = M(\u00b5\u03c0(z) + \u03c6 t\u22121) Notice that \u00b5\u03c0(z) = z + \u03c6t\u03c0 \u2212 \u03c6t\u22121. Now,\npt(\u03c0) =\n\u222b\nz\n1[\u03c0 = M(z + \u03c6t\u22121)]f(z)dz\n=\n\u222b\nz\n1[\u03c0 = M(\u00b5\u03c0(z) + \u03c6 t\u22121)]f(\u00b5\u03c0(z))dz\n=\n\u222b\nz\n1[\u03c0 = M(z + \u03c6t\u03c0)]f(\u00b5\u03c0(z))dz\nNow observe that for any z \u2208 RdK : f(\u00b5\u03c0(z)) = exp{\u2212\u01eb ( \u2016z + \u03c6t\u03c0 \u2212 \u03c6t\u22121\u20161 \u2212 \u2016z\u20161 )\n}f(z) \u2264 exp{\u2212\u01eb (\n\u2016z + \u03c6t\u03c0 \u2212 \u03c6t\u22121\u20161 \u2212 \u2016z + \u03c6t\u03c0 \u2212 \u03c6t\u22121\u20161 \u2212 \u2016\u03c6t\u22121 \u2212 \u03c6t\u03c0\u20161 ) }f(z) \u2264 exp{\u01eb\u2016\u03c6t\u03c0 \u2212 \u03c6t\u22121\u20161}f(z) = exp{\u01eb\u3008\u03c0(xt), \u2113t\u3009}f(z)\nSubstituting in this bound, we have,\npt(\u03c0) \u2264 exp{\u01eb\u3008\u03c0(xt), \u2113t\u3009} \u00b7 pt+1\u03c0 (\u03c0) \u2264 exp{\u01eb\u3008\u03c0(xt), \u2113t\u3009} \u00b7 pt+1(\u03c0)\nRe-arranging and lower bounding exp{\u2212x} \u2265 (1\u2212 x):\npt+1(\u03c0) \u2265 exp{\u2212\u01eb\u3008\u03c0(xt), \u2113t\u3009} \u00b7 pt(\u03c0) \u2265 (1\u2212 \u01eb\u3008\u03c0(xt), \u2113t\u3009) \u00b7 pt(\u03c0) (23)\nUsing the definition of FTPLt and BTPLt, this gives,\nBTPL t =\n\u2211\n\u03c0\npt+1(\u03c0)\u3008\u03c0(xt), \u2113t\u3009 \u2265 \u2211\n\u03c0\n(1 \u2212 \u01eb\u3008\u03c0(xt), \u2113t\u3009)pt(\u03c0)\u3008\u03c0(xt), \u2113t\u3009\n= FTPLt \u2212 \u01eb \u2211\n\u03c0\npt(\u03c0)\u3008\u03c0(xt), \u2113t\u30092\n= FTPLt \u2212 \u01ebE [ \u3008\u03c0(xt), \u2113t\u30092 ]\nWe will finish the proof by showing that pt+1\u03c0 (\u03c0) \u2264 pt+1(\u03c0) for all \u03c0 \u2208 \u03a0. For succinctness we drop the dependence on t. Notice that for any other policy \u03c0\u2032 6= \u03c0\nL(\u03c0, z + \u03c6t\u03c0) \u2264 L(\u03c0\u2032, z + \u03c6t\u03c0) \u21d2 L(\u03c0, z + \u03c6t) \u2264 L(\u03c0\u2032, z + \u03c6t).\nAnd similarly for strict inequalities. This follows since the loss of \u03c0 remains unchanged, but the loss of \u03c0\u2032 can only go up, since \u2113t\u03c0(j) \u2264 \u2113t(j) (as losses are non-negative). For simplicity assume that \u03c0 always wins in case of ties, though the argument goes through if we assume a deterministic tie-breaking rule based on some global ordering of policies. Thus,\npt+1(\u03c0) = P\n[\n\u22c2\n\u03c0\u2032\nL(\u03c0, z + \u03c6t) \u2264 L(\u03c0\u2032, z + \u03c6t) ] \u2264 P [ \u22c2\n\u03c0\u2032\nL(\u03c0, z + \u03c6t\u03c0) \u2264 L(\u03c0\u2032, z + \u03c6t\u03c0) ] = pt+1\u03c0 (\u03c0)\nas claimed."}, {"heading": "B.4. Bounding Stability: Small Separator Setting", "text": "Finally, we prove the third claim in Theorem 2. This involves a new stability bound for the small separator setting.\nLemma 11 (Stability for small separator). For any t \u2208 [T ] and any sequence y1:t of contexts x1:t and losses f1:t with f i : {0, 1}K \u2192 RK , the stability of CONTEXT-FTPL(\u01eb), when X is a separator, is upper bounded by:\nE{z} [ f t(\u03c0t(xt))\u2212 f t(\u03c0t+1(xt)) ] \u2264 4\u01ebKd \u00b7 \u2016f t\u20162\u2217\nProof. By the definition of \u2016f t\u2016\u2217:\nE{z} [ f t(\u03c0t(xt))\u2212 f t(\u03c0t+1(xt)) ] \u2264 2\u2016f t\u2016\u2217 Pr [ \u03c0t(xt) 6= \u03c0t+1(xt) ] \u2264 2\u2016f t\u2016\u2217 Pr[\u03c0t 6= \u03c0t+1]\nSince X is a separator, \u03c0t 6= \u03c0t+1 if and only if there exists a context x \u2208 X , such that \u03c0t(x) 6= \u03c0t+1(x). Otherwise the two policies are identical. Thus we have by two applications of the union bound:\nPr[\u03c0t 6= \u03c0t+1] \u2264 \u2211\nx\u2208X Pr[\u03c0t(x) 6= \u03c0t+1(x)]\n\u2264 \u2211\nx\u2208X\n\u2211\nj\u2208K\n( Pr[j \u2208 \u03c0t(x), j /\u2208 \u03c0t+1(x)] + Pr[j /\u2208 \u03c0t(x), j \u2208 \u03c0t+1(x)] )\nWe bound the probability Pr[j \u2208 \u03c0t(x), j /\u2208 \u03c0t+1(x)]. We condition on all random variables of {z} except for the random variable \u2113x(j), i.e. the random loss placed at coordinate j on the sample associated with context x. Denote the event corresponding to an assignment of all these other random variables as E\u2212xj . Let \u2113xj denote a loss vector which is \u2113x(j) on the j-th coordinate and zero otherwise. Also let:\n\u03a6(\u03c0) =\nt\u22121 \u2211\n\u03c4=1\nf \u03c4 (\u03c0(x\u03c4 )) + \u2211 x\u2032 6=x \u3008\u03c0(x\u2032), \u2113x\u2032\u3009+ \u3008\u03c0(x), \u2113x \u2212 \u2113xj\u3009 (24)\nLet \u03c0\u2217 = argmin\u03c0\u2208\u03a0:j\u2208\u03c0(x)\u03a6(\u03c0) and \u03c0\u0303 = min\u03c0\u2208\u03a0:j /\u2208\u03c0(x)\u03a6(\u03c0). The event that {j \u2208 \u03c0t(x)} happens only if:\n\u03a6(\u03c0\u2217) + \u2113x(j) \u2264 \u03a6(\u03c0\u0303) (25)\nLet and \u03bd = \u03a6(\u03c0\u0303)\u2212 \u03a6(\u03c0\u2217). Thus j \u2208 \u03c0t(x) only if:\n\u2113x(j) \u2264 \u03bd (26)\nNow if: \u2113x(j) < \u03bd \u2212 2\u2016f t\u2016\u2217 (27)\nthen it is easy to see that {j \u2208 \u03c0t+1(x)}, since an extra loss of f t(a) \u2264 \u2016f t\u2016\u2217 cannot push j out of the optimal solution. More elaborately, for any other policy \u03c0 \u2208 \u03a0, such that j /\u2208 \u03c0(x), the loss of \u03c0\u2217 including time-step t is bounded as:\n\u03a6(\u03c0\u2217) + \u2113x(j) + f t(\u03c0\u2217(xt)) < \u03a6(\u03c0)\u2212 2\u2016f t\u2016\u2217 + f t(\u03c0\u2217(xt))\n< \u03a6(\u03c0)\u2212 \u2016f t\u2016\u2217 < \u03a6(\u03c0) + f t(\u03c0(xt))\nThus any policy \u03c0, such that j /\u2208 \u03c0(x) is suboptimal after seeing the loss at time-step t. Thus\nPr[j \u2208 \u03c0t(x), j /\u2208 \u03c0t+1(x) | E\u2212xj] \u2264 Pr[\u2113x(j) \u2208 [\u03bd \u2212 2\u2016f t\u2016\u2217, \u03bd] | E\u2212xj ]\nSince all other random variables are independent of \u2113x(j) and \u2113x(j) is a Laplacian with parameter \u01eb:\nPr[\u2113x(j) \u2208 [\u03bd \u2212 2\u2016f t\u2016\u2217, \u03bd] | E\u2212xj ] = Pr[\u2113x(j) \u2208 [\u03bd \u2212 2\u2016f t\u2016\u2217, \u03bd]]\n= \u01eb\n2\n\u222b \u03bd\n\u03bd\u22122\u2016ft\u2016\u2217 e\u2212\u01eb|z|dz \u2264 \u01eb 2\n\u222b \u03bd\n\u03bd\u22122\u2016ft\u2016\u2217 dz \u2264 \u01eb\u2016f t\u2016\u2217\nSimilarly it follows that that: Pr[j /\u2208 \u03c0t(x), j \u2208 \u03c0t+1(x)] \u2264 \u01eb\u2016f t\u2016\u2217. To sum we get that:\nE{z} [ f t(\u03c0t(xt))\u2212 f t(\u03c0t+1(xt)) ] \u2264 2\u2016f t\u2016\u2217 Pr [ \u03c0t 6= \u03c0t+1 ] \u2264 4\u01ebKd \u00b7 \u2016f t\u20162\u2217"}, {"heading": "C. Omitted Proofs from Section 4", "text": ""}, {"heading": "C.1. Proof of Theorem 3: Transductive Setting", "text": "Consider the expected loss of the bandit algorithm at time-step t, conditional on Ht\u22121:\nE[\u3008\u03c0t(xt), \u2113t\u3009 | Ht\u22121] = K \u2211\nj=1\nqt(j) \u00b7 \u2113t(j) \u2264 K \u2211\nj=1\nqt(j) \u00b7 E [ \u2113\u0302t(j) | Ht\u22121 ] +\nK \u2211\nj=1\n\u2113t(j)qt(j) \u00b7 (1 \u2212 qt(j))L (28)\nAs was observed by (Neu & Barto\u0301k, 2013), the second quantity can be upper bounded by KeL\u2016\u2113t\u2016\u2217, since q(1 \u2212 q)L \u2264 qe\u2212Lq \u2264 1eL .\nNow observe that: \u2211 j\u2208K q t(j) \u00b7 E\n[ \u2113\u0302t(j) | Ht\u22121 ] is the expected loss of the full feedback algorithm on the sequence of\nlosses it observed and conditional on the history of play. By the regret bound of CONTEXT-FTPL(X, \u01eb), given in case 2 of Theorem 2, we have that for any policy \u03c0\u2217:\nE\n\n\nT \u2211\nt=1\nK \u2211\nj=1\nqt(j) \u00b7 \u2113\u0302t(j)\n  \u2264 E [ T \u2211\nt=1\n\u3008\u03c0\u2217(xt), \u2113\u0302t\u3009 ] + \u01ebE [ T \u2211\nt=1\n\u2211 \u03c0\u2208\u03a0 pt(\u03c0)\u3008\u03c0(xt), \u2113\u0302t\u30092\n]\n+ 10\n\u01eb\n\u221a dm log(N)\nUsing the fact that expected estimates \u2113\u0302 are upper bounded by true losses:\nE\n\n\nT \u2211\nt=1\nK \u2211\nj=1\nqt(j)\u2113\u0302t(j)\n\n \u2264 min \u03c0\u2217\u2208\u03a0 E\n[\nT \u2211\nt=1\n\u3008\u03c0\u2217(xt), \u2113\u0302t\u3009 ] + \u01ebE [ T \u2211\nt=1\n\u2211 \u03c0\u2208\u03a0 pt(\u03c0)\u3008\u03c0(xt), \u2113\u0302t\u30092\n]\n+ 10\n\u01eb\n\u221a dm log(N)\nCombining the two upper bounds, we get that the expected regret of the bandit algorithm is upper bounded by:\nREGRET \u2264 \u01ebE [ T \u2211\nt=1\n\u2211 \u03c0\u2208\u03a0 pt(\u03c0)\u3008\u03c0(xt), \u2113\u0302t\u30092\n]\n+ 10\n\u01eb\n\u221a dm log(N) + K\neL\nT \u2211\nt=1\nE [ \u2016\u2113t\u2016\u2217 ]\nNow observe that, by a simple norm inequality and re-grouping:\n\u2211 \u03c0\u2208\u03a0 pt(\u03c0)\u3008\u03c0(xt), \u2113\u0302t\u30092 = \u2211 \u03c0\u2208\u03a0 pt(\u03c0)\n\n\n\u2211\nj\u2208\u03c0(xt) \u2113\u0302t(j)\n\n\n2\n\u2264 m \u2211\n\u03c0\u2208\u03a0 pt(\u03c0)\n\u2211\nj\u2208\u03c0(xt) \u2113\u0302t(j)2 = m\n\u2211\nj\u2208[K] qt(j)\u2113\u0302t(j)2\nThus we get:\nREGRET \u2264 \u01ebm T \u2211\nt=1\nE\n\n\n\u2211\nj\u2208[K] qt(j)\u2113\u0302t(j)2\n\n+ 10\n\u01eb\n\u221a dm log(N) + K\neL\nT \u2211\nt=1\nE [ \u2016\u2113t\u2016\u2217 ]\nNow we bound each of the terms in the first summation, conditional on any history of play: \u2211\nj\u2208[K] qt(j)E\n[ \u2113\u0302t(j)2 | Ht\u22121 ] = \u2211\nj\u2208[K] qt(j)qt(j)\u2113t(j)2E\n[ J t(j)2 | Ht\u22121, j \u2208 \u03c0t(xt) ]\nEach J t(j) conditional on Ht\u22121 and j \u2208 \u03c0t(xt) is distributed according to a geometric distribution with mean qt(j) truncated at L. Hence, it is stochastically dominated by a geometric distribution with mean qt(j). By known properties, if X is a geometrically distributed random variable with mean q, then E[X2] = V ar(X)+(E[X ])2 = 1\u2212qq2 + 1 q2 = 2\u2212q q2 \u2264 2q2 . Thus we have:\n\u2211\nj\u2208[K] qt(j)E\n[ \u2113\u0302t(j)2 | Ht\u22121 ] \u2264 \u2211\nj\u2208[K] qt(j)2\u2113t(j)2\n2\nqt(j)2 = 2\nK \u2211\nj=1\n\u2113t(j)2 \u2264 2K\u2016\u2113t\u20162\u221e\nCombining all the above we get the theorem."}, {"heading": "C.2. Proof of Theorem 3: Small Separator Setting", "text": "Consider the expected loss of the bandit algorithm at time-step t, conditional on Ht\u22121:\nE[\u3008\u03c0t(xt), \u2113t\u3009 | Ht\u22121] = K \u2211\nj=1\nqt(j) \u00b7 \u2113t(j) \u2264 K \u2211\nj=1\nqt(j) \u00b7 E [ \u2113\u0302t(j) | Ht\u22121 ] +\nK \u2211\nj=1\n\u2113t(j)qt(j) \u00b7 (1 \u2212 qt(j))L (29)\nAs was observed by (Neu & Barto\u0301k, 2013), the second quantity can be upper bounded by KeL\u2016\u2113t\u2016\u2217, since q(1 \u2212 q)L \u2264 qe\u2212Lq \u2264 1eL .\nNow observe that: \u2211 j\u2208K q t(j) \u00b7 E\n[ \u2113\u0302t(j) | Ht\u22121 ] is the expected loss of the full feedback algorithm on the sequence of\nlosses it observed and conditional on the history of play. By the regret bound of CONTEXT-FTPL(X, \u01eb), given in case 3 of Theorem 2, we have that for any policy \u03c0\u2217:\nE\n\n\nT \u2211\nt=1\nK \u2211\nj=1\nqt(j) \u00b7 \u2113\u0302t(j)\n  \u2264 E [ T \u2211\nt=1\n\u3008\u03c0\u2217(xt), \u2113\u0302t\u3009 ] + 4\u01ebKd \u00b7 T \u2211\nt=1\nE\n[ \u2016f\u0302 t\u20162\u2217 ] + 10\n\u01eb\n\u221a dm log(N)\n\u2264 T \u2211\nt=1\n\u3008\u03c0\u2217(xt), \u2113\u0302t\u3009+ 4\u01ebKd \u00b7 T \u2211\nt=1\nE\n[ \u2016\u2113\u0302t\u201621 ] + 10\n\u01eb\n\u221a dm log(N)\nUsing the fact that expected estimates \u2113\u0302 are upper bounded by true losses:\nE\n\n\nT \u2211\nt=1\nK \u2211\nj=1\nqt(j)\u2113\u0302t(j)\n\n \u2264 min \u03c0\u2217\u2208\u03a0 E\n[\nT \u2211\nt=1\n\u3008\u03c0\u2217(xt), \u2113\u0302t\u3009 ] + 4\u01ebKd \u00b7 T \u2211\nt=1\nE\n[ \u2016\u2113\u0302t\u201621 ] + 10\n\u01eb\n\u221a dm log(N)\nCombining the two upper bounds, we get that the expected regret of the semi-bandit algorithm is upper bounded by:\nREGRET \u2264 4\u01ebKd \u00b7 T \u2211\nt=1\nE\n[ \u2016\u2113\u0302t\u201621 ] + 10\n\u01eb\n\u221a dm log(N) + K\neL\nT \u2211\nt=1\nE [ \u2016\u2113t\u2016\u2217 ]\nNow we bound each of the terms in the first summation, conditional on any history of play:\nE\n[ \u2016\u2113\u0302t\u201621 | Ht\u22121 ] \u2264 mE [ \u2016\u2113\u0302t\u201622 ] = m \u2211\nj\u2208[K] E\n[ \u2113\u0302t(j)2 ] = m \u2211\nj\u2208[K] qt(j)\u2113t(j)2E\n[ J t(j)2 | Ht\u22121, j \u2208 \u03c0t(xt) ]\nEach J t(j) conditional on Ht\u22121 and j \u2208 \u03c0t(xt) is distributed according to a geometric distribution with mean qt(j) truncated at L. Hence, it is stochastically dominated by a geometric distribution with mean qt(j). By known properties, if X is a geometrically distributed random variable with mean q, then E[X2] = V ar(X)+(E[X ])2 = 1\u2212qq2 + 1 q2 = 2\u2212q q2 \u2264 2q2 . Moreover, trivially E[X2] \u2264 L2, since X is truncated at L. Thus we have:\nE\n[ \u2016\u2113\u0302t\u201621 | Ht\u22121 ] \u2264 m \u2211\nj\u2208[K] qt(j)\u2113t(j)2 min\n{\n2\nqt(j)2 , L2\n}\n\u2264 m\u2016\u2113t\u20162\u2217 \u2211\nj\u2208[K] min\n{\n2\nqt(j) , qt(j)L2\n}\nNow observe that: min {\n2 qt(j) , q\nt(j)L2 }\n\u2264 2L, since either 1qt(j) \u2264 L or otherwise, qt(j)L2 \u2264 1LL \u2264 L. Thus we get:\nE\n[ \u2016\u2113\u0302t\u201621 | Ht\u22121 ] \u2264 2LKm\u2016\u2113t\u20162\u2217\nCombining all the above we get the theorem."}, {"heading": "D. Omitted Proofs from Section 6", "text": ""}, {"heading": "D.1. Proof of Theorem 6", "text": "Similar to the analysis in Section 3, the proof of the Theorem is broken apart in two main Lemmas. The first lemma is an analogue of Theorem 1 for algorithms that use a predictor. This lemma can be phrased in the general online learning setting analyzed in Section 2. The second Lemma is an anaolgue of our multiplicative stability Lemma 10.\nLet \u03c1t = M({z} \u222a y1:t) (30)\ndenote the policy that would have been played at time-step t if the predictor was equal to the actual loss vector that occured at time-step t. Moreover, for succinctness we will denote with at = \u03c0t(xt) and with bt = \u03c1t(xt).\nLemma 12 (Follow vs Be the Leader with Predictors). The regret of a player under the optimistic FTPL and with respect to any \u03c0\u2217 \u2208 \u03a0 is upper bounded by:\nREGRET \u2264 T \u2211\nt=1\nE [ \u2206Qt(at)\u2212\u2206Qt(bt) ] + E[ERROR] (31)\nwhere \u2206Qt(a) = f t(a)\u2212Qt(a) and ERROR = max\u03c0\u2208\u03a0 \u2211 x\u2208X\u3008\u03c0(x), \u2113x\u3009 \u2212min\u03c0\u2208\u03a0 \u2211 x\u2208X\u3008\u03c0(x), \u2113x\u3009.\nProof. Consider the augmented sequence (x1, Q1), (x1, f1 \u2212 Q1), (x2, Q2), (x2, f2 \u2212 Q2), . . ., where each observation (xt, f t) is replaced by two observations (xt, Qt) followed by (xt, f t \u2212Qt). Observe that by linearity of the objective, the two observations cancell out each other at the end, to give the same effect as a single observation of (xt, f t). Moreover, the leader after observing (xt, Qt) is equal to at, whilst after observing (xt, f t \u2212Qt) is equal to bt. Thus by applying Lemma 7 to this augmented sequence we get:\nT \u2211\nt=1\n( Qt(at) + f t(bt)\u2212Qt(bt) ) \u2264 T \u2211\nt=1\n( Qt(\u03c0\u2217(xt)) + f t(\u03c0\u2217(xt))\u2212Qt(\u03c0\u2217(xt)) ) + ERROR\n=\nT \u2211\nt=1\nf t(\u03c0\u2217(xt)) + ERROR\nLet BTPLtQ = Q t(at) + f t(bt)\u2212Qt(bt) and FTPLt = f t(at). Then, observe that:\nFTPL t \u2212 BTPLtQ = f t(at)\u2212Qt(at)\u2212 (f t(bt)\u2212Qt(bt)) = \u2206Qt(at)\u2212\u2206Qt(bt) (32)\nCombining the two properties we get that for any policy \u03c0\u2217:\nT \u2211\nt=1\nFTPL t \u2264\nT \u2211\nt=1\n( \u2206Qt(at)\u2212\u2206Qt(bt) ) +\nT \u2211\nt=1\nBTPL t Q\n\u2264 T \u2211\nt=1\n( \u2206Qt(at)\u2212\u2206Qt(bt) ) +\nT \u2211\nt=1\nf t(\u03c0\u2217(xt)) + ERROR\nRe-arranging and taking expectation concludes the proof.\nLemma 13 (Stability with Predictors). In the transductive setting:\nE [ \u2206Qt(at)\u2212\u2206Qt(bt) ] \u2264 4\u01ebK\u2016f t \u2212Qt\u20162\u2217 (33)"}, {"heading": "In the small separator setting:", "text": "E [ \u2206Qt(at)\u2212\u2206Qt(bt) ]\n\u2264 4\u01ebKd\u2016f t \u2212Qt\u20162\u2217 (34)\nProof. We prove the first part of the Lemma. The second follows along identical arguments. By the definition of \u2016f t \u2212 Qt\u2016\u2217 = \u2016\u2206Qt\u2016\u2217 = maxa\u2208A |\u2206Qt(a)|, we have:\nE{z} [ \u2206Qt(at)\u2212\u2206Qt(bt) ] \u2264 2\u2016\u2206Qt\u2016\u2217 Pr [ at 6= bt ]\nNow observe that:\nPr[at 6= bt] \u2264 \u2211\nj\u2208K\n( Pr[j \u2208 at, j /\u2208 bt] + Pr[j /\u2208 at, j \u2208 bt] )\nWe bound the probability Pr[j \u2208 at, j /\u2208 bt]. We condition on all random variables of {z} except for the random variable \u2113xt(j), i.e. the random loss placed at coordinate j on the sample associated with contextxt. Denote the event corresponding to an assignment of all these other random variables as E\u2212xtj . Let \u2113xtj denote a loss vector which is \u2113xt(j) on the j-th coordinate and zero otherwise. Also let:\n\u03a6(\u03c0) =\nt\u22121 \u2211\n\u03c4=1\nf \u03c4 (\u03c0(x\u03c4 )) +Qt(\u03c0(xt)) + \u2211\nx\u2208X\u2212{xt} \u3008\u03c0(x), \u2113x\u3009+ \u3008\u03c0(xt), \u2113xt \u2212 \u2113xtj\u3009 (35)\nLet \u03c0\u2217 = argmin\u03c0\u2208\u03a0:j\u2208\u03c0(xt)\u03a6(\u03c0) and \u03c0\u0303 = min\u03c0\u2208\u03a0:j /\u2208\u03c0(xt) \u03a6(\u03c0). The event that {j \u2208 at} happens only if:\n\u03a6(\u03c0\u2217) + \u2113xt(j) \u2264 \u03a6(\u03c0\u0303) (36)\nLet and \u03bd = \u03a6(\u03c0\u0303)\u2212 \u03a6(\u03c0\u2217). Thus j \u2208 at only if: \u2113xt(j) \u2264 \u03bd (37)\nNow if: \u2113xt(j) < \u03bd \u2212 2\u2016\u2206Qt\u2016\u2217 (38)\nthen it is easy to see that {j \u2208 bt}, since an extra loss of f t(a) \u2212 Qt(a) \u2264 \u2016\u2206Qt\u2016\u2217 cannot push j out of the optimal solution. More elaborately, for any other policy \u03c0 \u2208 \u03a0, such that j /\u2208 \u03c0(xt), the loss of \u03c0\u2217 including time-step t is bounded as:\n\u03a6(\u03c0\u2217) + \u2113xt(j) + f t(\u03c0\u2217(xt))\u2212Qt(\u03c0\u2217(xt)) < \u03a6(\u03c0)\u2212 2\u2016\u2206Qt\u2016\u2217 + f t(\u03c0\u2217(xt))\u2212Qt(\u03c0\u2217(xt))\n< \u03a6(\u03c0)\u2212 \u2016\u2206Q\u2016\u2217 < \u03a6(\u03c0) + f t(\u03c0(xt))\u2212Qt(\u03c0(xt))\nThus any policy \u03c0, such that j /\u2208 \u03c0(xt) is suboptimal after seeing the loss at time-step t. Thus\nPr[j \u2208 at, j /\u2208 bt | E\u2212xtj ] \u2264 Pr[\u2113xt(j) \u2208 [\u03bd \u2212 2\u2016\u2206Qt\u2016\u2217, \u03bd] | E\u2212xtj ]\nSince all other random variables are independent of \u2113xt(j) and \u2113xt(j) is a Laplacian with parameter \u01eb:\nPr[\u2113xt(j) \u2208 [\u03bd \u2212 2\u2016\u2206Qt\u2016\u2217, \u03bd] | E\u2212xtj ] = Pr[\u2113xt(j) \u2208 [\u03bd \u2212 2\u2016\u2206Qt\u2016\u2217, \u03bd]]\n= \u01eb\n2\n\u222b \u03bd\n\u03bd\u22122\u2016\u2206Qt\u2016\u2217 e\u2212\u01eb|z|dz \u2264 \u01eb 2\n\u222b \u03bd\n\u03bd\u22122\u2016\u2206Qt\u2016\u2217 dz \u2264 \u01eb \u00b7 \u2016\u2206Qt\u2016\u2217\nSimilarly it follows that that: Pr[j /\u2208 \u03c0t(xt) and j \u2208 \u03c0t+1(xt)] \u2264 \u01eb \u00b7 \u2016\u2206Qt\u2016\u2217. To sum we get that:\nE{z} [ \u2206Qt(at)\u2212\u2206Qt(bt) ] \u2264 2\u2016\u2206Qt\u2016\u2217 Pr [ \u03c0t(xt) 6= \u03c0t+1(xt) ] \u2264 4\u01ebK\u2016\u2206Qt\u20162\u2217\nThe expected error term is identical to the expected error that we upper bounded in Lemma 8, hence the same bound carries over. Combining the above Lemmas with this observation, yields Theorem 6.\nE. Infinite Policy Classes\nIn this section we focus on the contextual experts problem but consider infinite policy classes. Recall that in this setting, in each round t, the adversary picks a context xt \u2208 X and a loss function \u2113t \u2208 RK\u22650, the learner, upon seeing the context xt, chooses an action at \u2208 [K], and then suffers loss ellt(at). We showed that as a simple consequence of Theorem 2, that when competing with a set of policies \u03a0 \u2282 (X \u2192 [K]) with |\u03a0| = N and against an adaptive adversary, CONTEXT-FTPL has regret at most O(d1/4 \u221a\nT log(N)) in the transductive setting and regret at most O(d3/4 \u221a KT log(N)) in the non-transductive setting with small separator.\nHere we consider the situation where the policy class \u03a0 is infinite in size, but has small Natarajan dimension, which generalizes VC-dimension to multiclass problems. Specifically, we prove two results in this section: First we show that in the transductive case, CONTEXT-FTPL can achieve low regret relative to a policy class with bounded Natarajan dimension. Then we show that in the non-transductive case, it is hard in an information-theoretic sense to achieve sublinear regret relative to a policy class with constant Natarajan dimension. Together, these results show that finite Natarajan or VC dimension is sufficient for sublinear regret in the transductive setting, but it is insufficient for sublinear regret in the fully online setting.\nBefore proceeding with the two results, we must introduce the notion of Natarajan dimension, which requires some notation. For a class of functions F from X \u2192 [K] and for a sequence X = (x1, . . . , xn) \u2208 Xn, define FX = {(f(x1), . . . , f(xn)) \u2208 [K]n : f \u2208 F} be the restriction of the functions to the points. Let \u03a8 be a family of mappings from [K] \u2192 {0, 1, \u22c6}. Let \u03c8\u0304 = (\u03c81, . . . , \u03c8n) \u2208 \u03a8n be a fixed sequence of such mappings and for a sequence (s1, . . . , sn) \u2208 [K]N define \u03c8\u0304(s) = (\u03c81(s1), . . . , \u03c81(sn)) \u2208 {0, 1, \u22c6}n. We say a sequence X \u2208 Xn is \u03a8-shattered by F if there exists \u03c8\u0304 \u2208 \u03a8n such that:\n{0, 1}n \u2286 {\u03c8\u0304(s) : s \u2208 FX}\nThe \u03a8-dimension of a function class F is the largest n such that there exist a sequence X \u2208 Xn that is \u03a8-shattered by F . Notice that if K = 2 and \u03a8 contains only the identity map, then the \u03a8-dimension is exactly the VC dimension.\nThe Natarajan dimension is the \u03a8 dimension for the class \u03a8N = {\u03c8N,i,j, i, j \u2208 [K], j 6= i} where \u03c8N,i,j(a) = 1 if a = i, \u03c8N,i,j(a) = 0 if a = j and \u03c8N,i,j(a) = \u22c6 otherwise. Notice that Natarajan dimension is a strict generalization of VC-dimension as \u03a8N contains only the identity map if K = 2. Thus our result also applies to VC-classes in the two-action case. The main property we will use about function classes with bounded Natarajan Dimension is the following analog of the Sauer-Shelah Lemma:\nLemma 14 (Sauer-Shelah for Natarajan Dimension (Haussler & Long, 1995; Ben-David et al., 1995)). Suppose that F has \u03a8N dimension at most \u03bd. Then for any set X \u2208 Xn, we have:\n|FX | \u2264 ( ne(K + 1)2\n2\u03bd\n)\u03bd\nOur positive result for transductive learning with a Natarajan class is the following regret bound for CONTEXT-FTPL,\nCorollary 15. Consider running CONTEXT-FTPL(X, \u01eb) in the transductive contextual experts setting with a policy class \u03a0 with Natarajan dimension at most \u03bd. Then the algorithm achieves regret against an adaptive and adversarially chosen sequence of contexts and loss functions,\n\u01eb\nT \u2211\nt=1\nE[\u3008\u03c0t(xt), \u2113t\u30092] + 10 \u01eb\n\u221a\nd\u03bd log(K) log\n(\nde(K + 1)2\n2\u03bd\n)\n.\nWhen \u01eb is set optimally and losses are in [0, 1]K , this is O((d\u03bd log(K) log(dK/\u03bd))1/4 \u221a T ).\nProof. The result is a consequence of the second clause of Theorem 2, using the additional fact that any sequence of contexts X = (x1, . . . , xd) induce a finite policy class \u03a0X \u2286 [K]d. The fact that \u03a0 has Natarajan dimension at most \u03bd means that |\u03a0X | \u2264 ( de(K+1)2\n2\u03bd\n)\u03bd\nby Lemma 14. Therefore, once the d contexts are fixed, as they are in the transductive\nsetting, we are back in the finite policy case and can apply Theorem 2 with N replaced by |\u03a0X |.\nThus we see that CONTEXT-FTPL has sublinear regret relative to policy classes with bounded Natarajan dimension, even against adaptive adversaries. The second result in this section shows that this result cannot be lifted to the non-transductive setting. Specifically, we prove the following theorem in the section, which shows that no algorithm, including inefficient ones, can achieve sublinear regret against a VC class in the non-transductive setting.\nTheorem 16. Consider an online binary classification problem in one dimension with F \u2282 [0, 1] \u2192 {0, 1} denoting the set of all threshold functions. Then there is no learning algorithm that can guarantee o(T ) expected regret against an adaptive adversary. In particular, there exists a policy class of VC dimension one such that no learning algorithm can achieve sublinear regret against an adaptive adversary in the contextual experts problem.\nProof. We define an adaptive adversary and argue that it ensures at least 1/2 expected regret per round. While the adversary does not have access to the random coins of the learner, it can compute the probability that the learner would label any point as {0, 1}. At round t, let pt(x) denote the probability that the learner would label a point x \u2208 [0, 1] as 1, and note that this quantity is conditioned on the entire history of interaction. At each round t, the adversary will have played a set of points X+t with positive label and X \u2212 t with negative label and she will maintain the invariant that minx\u2208X+t x > maxx\u2208X\u2212t x for all t. At every time t, the adversary will play context xt \u2208 (maxx\u2208X\u2212t x,minx\u2208X+t x). The adversary, knowing the learning algorithm, will compute pt(xt) and assign label yt = 1 if pt(x) < 1/2 and 0 otherwise. The adversary will then update the sets X+t+1 \u2190 X+t \u222a {xt} if yt = 1 and X+t+1 \u2190 X+t otherwise. X\u2212t+1 is updated analogously. Clearly this sequence of contexts maintains the appropriate invariant for the adversary, namely there is always an interval between the positive and negative examples in which he can pick a context. This implies that on the sequence, there is a threshold f\u22c6 \u2208 F that perfectly classifies the points, so its cumulative reward is T . Moreover, by the choice of label selected by the adversary, the expected reward of the learner at round t is at most 1/2, which means the cumulative expected reward of the learner is at most T/2. Thus the regret of the learner is at least T/2."}], "references": [{"title": "Taming the monster: A fast and simple algorithm for contextual bandits", "author": ["Agarwal", "Alekh", "Hsu", "Daniel", "Kale", "Satyen", "Langford", "John", "Li", "Lihong", "Schapire", "Robert E"], "venue": "In International Conference on Machine Learning (ICML),", "citeRegEx": "Agarwal et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Agarwal et al\\.", "year": 2014}, {"title": "Gambling in a rigged casino: The adversarial multi-armed bandit pproblem", "author": ["Auer", "Peter", "Cesa-Bianchi", "Nicolo", "Freund", "Yoav", "Schapire", "Robert E"], "venue": "In Foundations of Computer Science (FOCS),", "citeRegEx": "Auer et al\\.,? \\Q1995\\E", "shortCiteRegEx": "Auer et al\\.", "year": 1995}, {"title": "Online linear optimization and adaptive routing", "author": ["Awerbuch", "Baruch", "Kleinberg", "Robert"], "venue": "Journal of Computer and System Sciences,", "citeRegEx": "Awerbuch et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Awerbuch et al\\.", "year": 2008}, {"title": "Characterizations of learnability for classes of (0,..., n)-valued functions", "author": ["Ben-David", "Shai", "Cesa-Bianchi", "Nicolo", "Haussler", "David", "Long", "Philip M"], "venue": "Journal of Computer and System Sciences,", "citeRegEx": "Ben.David et al\\.,? \\Q1995\\E", "shortCiteRegEx": "Ben.David et al\\.", "year": 1995}, {"title": "Online learning versus offline learning", "author": ["Ben-David", "Shai", "Kushilevitz", "Eyal", "Mansour", "Yishay"], "venue": "Machine Learning,", "citeRegEx": "Ben.David et al\\.,? \\Q1997\\E", "shortCiteRegEx": "Ben.David et al\\.", "year": 1997}, {"title": "Efficient online learning via randomized rounding", "author": ["Cesa-Bianchi", "Nicolo", "Shamir", "Ohad"], "venue": "In Advances in Neural Information Processing Systems (NIPS),", "citeRegEx": "Cesa.Bianchi et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Cesa.Bianchi et al\\.", "year": 2011}, {"title": "How to use expert advice", "author": ["Cesa-Bianchi", "Nicolo", "Freund", "Yoav", "Haussler", "David", "Helmbold", "David P", "Schapire", "Robert E", "Warmuth", "Manfred K"], "venue": "Journal of the ACM (JACM),", "citeRegEx": "Cesa.Bianchi et al\\.,? \\Q1997\\E", "shortCiteRegEx": "Cesa.Bianchi et al\\.", "year": 1997}, {"title": "Learning in auctions: Regret is hard, envy is easy", "author": ["Daskalakis", "Constantinos", "Syrgkanis", "Vasilis"], "venue": null, "citeRegEx": "Daskalakis et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Daskalakis et al\\.", "year": 2015}, {"title": "Efficient optimal learning for contextual bandits", "author": ["Dud\u0131\u0301k", "Miroslav", "Hsu", "Daniel", "Kale", "Satyen", "Karampatziakis", "Nikos", "Langford", "John", "Reyzin", "Lev", "Zhang", "Tong"], "venue": "In Uncertainty and Artificial Intelligence (UAI),", "citeRegEx": "Dud\u0131\u0301k et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Dud\u0131\u0301k et al\\.", "year": 2011}, {"title": "A decision-theoretic generalization of on-line learning and an application to boosting", "author": ["Freund", "Yoav", "Schapire", "Robert E"], "venue": "Journal of Computer and System Sciences,", "citeRegEx": "Freund et al\\.,? \\Q1997\\E", "shortCiteRegEx": "Freund et al\\.", "year": 1997}, {"title": "A generalization of sauer\u2019s lemma", "author": ["Haussler", "David", "Long", "Philip M"], "venue": "Journal of Combinatorial Theory,", "citeRegEx": "Haussler et al\\.,? \\Q1995\\E", "shortCiteRegEx": "Haussler et al\\.", "year": 1995}, {"title": "Extracting certainty from uncertainty: regret bounded by variation in costs", "author": ["Hazan", "Elad", "Kale", "Satyen"], "venue": "Machine Learning,", "citeRegEx": "Hazan et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Hazan et al\\.", "year": 2010}, {"title": "Online submodular minimization", "author": ["Hazan", "Elad", "Kale", "Satyen"], "venue": "Journal of Machine Learning Research (JMLR),", "citeRegEx": "Hazan et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Hazan et al\\.", "year": 2012}, {"title": "Tracking the best expert", "author": ["Herbster", "Mark", "Warmuth", "Manfred K"], "venue": "Machine Learning,", "citeRegEx": "Herbster et al\\.,? \\Q1998\\E", "shortCiteRegEx": "Herbster et al\\.", "year": 1998}, {"title": "A generalization of sampling without replacement from a finite universe", "author": ["Horvitz", "Daniel G", "Thompson", "Donovan J"], "venue": "Journal of the American Statistical Association (JASA),", "citeRegEx": "Horvitz et al\\.,? \\Q1952\\E", "shortCiteRegEx": "Horvitz et al\\.", "year": 1952}, {"title": "Adaptive online prediction by following the perturbed leader", "author": ["Hutter", "Marcus", "Poland", "Jan"], "venue": "Journal of Machine Learning Research (JMLR),", "citeRegEx": "Hutter et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Hutter et al\\.", "year": 2005}, {"title": "Online submodular minimization for combinatorial structures", "author": ["Jegelka", "Stefanie", "Bilmes", "Jeff A"], "venue": "In International Conference on Machine Learning (ICML),", "citeRegEx": "Jegelka et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Jegelka et al\\.", "year": 2011}, {"title": "From batch to transductive online learning", "author": ["Kakade", "Sham M", "Kalai", "Adam"], "venue": "In Advances in Neural Information Processing Systems (NIPS),", "citeRegEx": "Kakade et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Kakade et al\\.", "year": 2005}, {"title": "Efficient algorithms for online decision problems", "author": ["Kalai", "Adam", "Vempala", "Santosh"], "venue": "Journal of Computer and System Sciences,", "citeRegEx": "Kalai et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Kalai et al\\.", "year": 2005}, {"title": "The epoch-greedy algorithm for multi-armed bandits with side information", "author": ["Langford", "John", "Zhang", "Tong"], "venue": "In Advances in Neural Information Processing Systems (NIPS),", "citeRegEx": "Langford et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Langford et al\\.", "year": 2008}, {"title": "Achieving all with no parameters: Adanormalhedge", "author": ["Luo", "Haipeng", "Schapire", "Robert E"], "venue": "In Conference on Learning Theory (COLT),", "citeRegEx": "Luo et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Luo et al\\.", "year": 2015}, {"title": "An efficient algorithm for learning with semi-bandit feedback", "author": ["Neu", "Gergely", "Bart\u00f3k", "G\u00e1bor"], "venue": "In Algorithmic Learning Theory (ALT),", "citeRegEx": "Neu et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Neu et al\\.", "year": 2013}, {"title": "Optimization, learning, and games with predictable sequences", "author": ["Rakhlin", "Alexander", "Sridharan", "Karthik"], "venue": "In Advances in Neural Information Processing Systems (NIPS),", "citeRegEx": "Rakhlin et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Rakhlin et al\\.", "year": 2013}, {"title": "Online learning with predictable sequences", "author": ["Rakhlin", "Alexander", "Sridharan", "Karthik"], "venue": "In Conference on Learning Theorem (COLT),", "citeRegEx": "Rakhlin et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Rakhlin et al\\.", "year": 2013}, {"title": "Fast convergence of regularized learning in games", "author": ["Syrgkanis", "Vasilis", "Agarwal", "Alekh", "Luo", "Haipeng", "Schapire", "Robert E"], "venue": "In Advances in Neural Information Processing Systems (NIPS),", "citeRegEx": "Syrgkanis et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Syrgkanis et al\\.", "year": 2015}], "referenceMentions": [{"referenceID": 6, "context": "Algorithms for contextual learning, such as Hedge (Freund & Schapire, 1997; Cesa-Bianchi et al., 1997) and Exp4 (Auer et al.", "startOffset": 50, "endOffset": 102}, {"referenceID": 1, "context": ", 1997) and Exp4 (Auer et al., 1995), are well-known to have remarkable theoretical properties, being effective even in adversarial, non-stochastic environments, and capable of performing almost as well as the best among an exponentially large family of policies, or rules for choosing actions at each step.", "startOffset": 17, "endOffset": 36}, {"referenceID": 1, "context": ", 1997) and Exp4 (Auer et al., 1995), are well-known to have remarkable theoretical properties, being effective even in adversarial, non-stochastic environments, and capable of performing almost as well as the best among an exponentially large family of policies, or rules for choosing actions at each step. However, the space requirements and running time of these algorithms are generally linear in the number of policies, which is far too expensive for a great many applications which call for an extremely large policy space. In this paper, we address this gap between the statistical promise and computational challenge of algorithms for contextual online learning in an adversarial setting. As an approach to solving online learning problems, we posit that the corresponding batch version is solvable. In other words, we assume access to a certain optimization oracle for solving an associated batch-learning problem. Concrete instances of such an oracle include empirical risk minimization procedures for supervised learning, algorithms for the shortest paths problem, and dynamic programming. Such an oracle is central to the Follow-the-PerturbedLeader algorithms of Kalai & Vempala (2005), although these algorithms are not generally efficient since they require separately \u201cperturbing\u201d each policy in the entire", "startOffset": 18, "endOffset": 1198}, {"referenceID": 0, "context": "Oracles of this kind have also been used in designing efficient contextual bandit algorithms (Agarwal et al., 2014; Langford & Zhang, 2008; Dud\u0131\u0301k et al., 2011); however, these require a much more benign setting in which contexts and losses are chosen randomly and independently rather than by an adversary.", "startOffset": 93, "endOffset": 160}, {"referenceID": 8, "context": "Oracles of this kind have also been used in designing efficient contextual bandit algorithms (Agarwal et al., 2014; Langford & Zhang, 2008; Dud\u0131\u0301k et al., 2011); however, these require a much more benign setting in which contexts and losses are chosen randomly and independently rather than by an adversary.", "startOffset": 93, "endOffset": 160}, {"referenceID": 4, "context": "The first is a transductive setting (Ben-David et al., 1997) in which the learner knows the set of arriving contexts a priori, or, less stringently, knows only the set, but not necessarily the actual sequence or multiplicity with which each context arrives.", "startOffset": 36, "endOffset": 60}, {"referenceID": 0, "context": "Oracles of this kind have also been used in designing efficient contextual bandit algorithms (Agarwal et al., 2014; Langford & Zhang, 2008; Dud\u0131\u0301k et al., 2011); however, these require a much more benign setting in which contexts and losses are chosen randomly and independently rather than by an adversary. In this paper, for a wide range of problems, we present computationally efficient algorithms for contextual online learning in an adversarial setting, assuming oracle access. We give results for both the full-information and bandit settings. To the best of our knowledge, these results are the first of their kind at this level of generality. Overview of results. We begin by proposing and analyzing in Section 2 a new and general Follow-the-PerturbedLeader algorithm in the style of Kalai & Vempala (2005). This algorithm only accesses the policy class using the optimization oracle.", "startOffset": 94, "endOffset": 815}, {"referenceID": 0, "context": "Oracles of this kind have also been used in designing efficient contextual bandit algorithms (Agarwal et al., 2014; Langford & Zhang, 2008; Dud\u0131\u0301k et al., 2011); however, these require a much more benign setting in which contexts and losses are chosen randomly and independently rather than by an adversary. In this paper, for a wide range of problems, we present computationally efficient algorithms for contextual online learning in an adversarial setting, assuming oracle access. We give results for both the full-information and bandit settings. To the best of our knowledge, these results are the first of their kind at this level of generality. Overview of results. We begin by proposing and analyzing in Section 2 a new and general Follow-the-PerturbedLeader algorithm in the style of Kalai & Vempala (2005). This algorithm only accesses the policy class using the optimization oracle. We then apply these results in Section 3 to two settings. The first is a transductive setting (Ben-David et al., 1997) in which the learner knows the set of arriving contexts a priori, or, less stringently, knows only the set, but not necessarily the actual sequence or multiplicity with which each context arrives. In the second, small-separator setting, we assume that the policy space admits the existence of a small set of contexts, called a separator, such that any two policies differ on at least one context from the set. The size of the smallest separator for a particular policy class can be viewed as a new measure of complexity, different from the VC dimension, and potentially of independent interest. We study these for a generalized online learning problem called online combinatorial optimization, which includes as special cases transductive contextual experts, online shortest-path routing, online linear optimization (Kalai & Vempala, 2005), and online submodular minimization (Hazan & Kale, 2012). In Section 4, we extend our results to the bandit setting, or in fact, to the more general semi-bandit setting, using a technique of Neu & Bart\u00f3k (2013). Among our main results, we obtain regret bounds for the adversarial contextual bandit problem of O(T 3/4 \u221a", "startOffset": 94, "endOffset": 2063}, {"referenceID": 24, "context": "Such bounds have various applications, for instance, in obtaining better bounds for playing repeated games (Rakhlin & Sridharan, 2013a; Syrgkanis et al., 2015).", "startOffset": 107, "endOffset": 159}, {"referenceID": 22, "context": "Such bounds have various applications, for instance, in obtaining better bounds for playing repeated games (Rakhlin & Sridharan, 2013a; Syrgkanis et al., 2015). Other related work. Contextual, transductive online learning using an optimization oracle was previously studied by Kakade & Kalai (2005), whose work was later extended and improved by Cesa-Bianchi & Shamir (2011) using a generalization of a technique from Cesa-Bianchi et al.", "startOffset": 136, "endOffset": 299}, {"referenceID": 22, "context": "Such bounds have various applications, for instance, in obtaining better bounds for playing repeated games (Rakhlin & Sridharan, 2013a; Syrgkanis et al., 2015). Other related work. Contextual, transductive online learning using an optimization oracle was previously studied by Kakade & Kalai (2005), whose work was later extended and improved by Cesa-Bianchi & Shamir (2011) using a generalization of a technique from Cesa-Bianchi et al.", "startOffset": 136, "endOffset": 375}, {"referenceID": 5, "context": "Contextual, transductive online learning using an optimization oracle was previously studied by Kakade & Kalai (2005), whose work was later extended and improved by Cesa-Bianchi & Shamir (2011) using a generalization of a technique from Cesa-Bianchi et al. (1997). However, these previous results are for binary classification or other convex losses defined on one-dimensional predictions and outcomes; as such, they are special cases of the much more general setting we consider in the present paper.", "startOffset": 237, "endOffset": 264}, {"referenceID": 5, "context": "Contextual, transductive online learning using an optimization oracle was previously studied by Kakade & Kalai (2005), whose work was later extended and improved by Cesa-Bianchi & Shamir (2011) using a generalization of a technique from Cesa-Bianchi et al. (1997). However, these previous results are for binary classification or other convex losses defined on one-dimensional predictions and outcomes; as such, they are special cases of the much more general setting we consider in the present paper. Awerbuch & Kleinberg (2008) present an efficient algorithm for the online shortest paths problem.", "startOffset": 237, "endOffset": 530}, {"referenceID": 5, "context": "Contextual, transductive online learning using an optimization oracle was previously studied by Kakade & Kalai (2005), whose work was later extended and improved by Cesa-Bianchi & Shamir (2011) using a generalization of a technique from Cesa-Bianchi et al. (1997). However, these previous results are for binary classification or other convex losses defined on one-dimensional predictions and outcomes; as such, they are special cases of the much more general setting we consider in the present paper. Awerbuch & Kleinberg (2008) present an efficient algorithm for the online shortest paths problem. This can be viewed as solving an adversarial bandit problem with a very particular optimization oracle over an exponentially large but highly structured space of \u201cpolicies\u201d corresponding to paths in a graph. However, their setting is clearly far more restrictive and structured than ours is. 2. Online Learning with Oracles We start by analyzing the family of Follow the Perturbed Leader algorithms in a very general online learning setting. Parts of this generic formulation follow the recent formulation of Daskalakis & Syrgkanis (2015), but we present a more refined analysis which is essential for our contextual learning result in the next sections.", "startOffset": 237, "endOffset": 1139}, {"referenceID": 5, "context": "Contextual, transductive online learning using an optimization oracle was previously studied by Kakade & Kalai (2005), whose work was later extended and improved by Cesa-Bianchi & Shamir (2011) using a generalization of a technique from Cesa-Bianchi et al. (1997). However, these previous results are for binary classification or other convex losses defined on one-dimensional predictions and outcomes; as such, they are special cases of the much more general setting we consider in the present paper. Awerbuch & Kleinberg (2008) present an efficient algorithm for the online shortest paths problem. This can be viewed as solving an adversarial bandit problem with a very particular optimization oracle over an exponentially large but highly structured space of \u201cpolicies\u201d corresponding to paths in a graph. However, their setting is clearly far more restrictive and structured than ours is. 2. Online Learning with Oracles We start by analyzing the family of Follow the Perturbed Leader algorithms in a very general online learning setting. Parts of this generic formulation follow the recent formulation of Daskalakis & Syrgkanis (2015), but we present a more refined analysis which is essential for our contextual learning result in the next sections. The main theorem of this section is essentially a generalization of Theorem 1.1 of Kalai & Vempala (2005). Consider an online learning problem where at each timestep an adversary picks an outcome y \u2208 Y and the algorithm picks a policy \u03c0 \u2208 \u03a0 from some policy space \u03a0.", "startOffset": 237, "endOffset": 1361}, {"referenceID": 24, "context": "Such results have also found applications in learning in game theoretic environments (Rakhlin & Sridharan, 2013a; Syrgkanis et al., 2015).", "startOffset": 85, "endOffset": 137}, {"referenceID": 3, "context": "The main property we will use about function classes with bounded Natarajan Dimension is the following analog of the Sauer-Shelah Lemma: Lemma 14 (Sauer-Shelah for Natarajan Dimension (Haussler & Long, 1995; Ben-David et al., 1995)).", "startOffset": 184, "endOffset": 231}], "year": 2016, "abstractText": "We provide the first oracle efficient sublinear regret algorithms for adversarial versions of the contextual bandit problem. In this problem, the learner repeatedly makes an action on the basis of a context and receives reward for the chosen action, with the goal of achieving reward competitive with a large class of policies. We analyze two settings: i) in the transductive setting the learner knows the set of contexts a priori, ii) in the small separator setting, there exists a small set of contexts such that any two policies behave differently in one of the contexts in the set. Our algorithms fall into the follow the perturbed leader family (Kalai & Vempala, 2005) and achieve regret O(T 3/4 \u221a K log(N)) in the transductive setting and O(T dK \u221a log(N)) in the separator setting, where K is the number of actions, N is the number of baseline policies, and d is the size of the separator. We actually solve the more general adversarial contextual semi-bandit linear optimization problem, whilst in the full information setting we address the even more general contextual combinatorial optimization. We provide several extensions and implications of our algorithms, such as switching regret and efficient learning with predictable sequences.", "creator": "LaTeX with hyperref package"}}}