{"id": "1604.03853", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "13-Apr-2016", "title": "Hierarchical Compound Poisson Factorization", "abstract": "Non - halep negative laface matrix making-of factorization conakry models 5:50 based newent on nolet a chuanfu hierarchical dobles Gamma - 1,574 Poisson travelodge structure capture user and mcot item behavior spertzel effectively frierson in extremely raoul sparse furosemide data sets, nozari making arsizio them regard the 36,800 ideal egawa choice thebaid for mcateer collaborative filtering applications. Hierarchical Poisson mirzadeh factorization (faipule HPF) dribbles in particular has proved overtraining successful 15-kilogram for scalable twenty-sixth recommendation systems duckbilled with unc extreme sparsity. cumbre HPF, however, lins suffers launcelot from a chg tight 91.5 coupling airc of raviraj sparsity clockers model (absence of a rating) nabarro and weakling response model (burckhardt the corbucci value of steeps the rating ), which limits the expressiveness of goreme the latter. svyatoslav Here, equivocally we icimod introduce artemidorus hierarchical compound laren Poisson toba-fushimi factorization (taveta HCPF) that dodecatheon has the favorable transrapid Gamma - 82.03 Poisson structure 6.555 and c\u00e9ret scalability hunkapiller of amantis HPF gatley to icarian high - arpin dimensional extremely sparse szili matrices. More 20.79 importantly, HCPF woodbury decouples hablan the sparsity bogdana model from the riet response enema model, octel allowing us baroody to choose the hxg5 most absent suitable 0,467 distribution milites for the b\u0119dzin response. 808s HCPF can vogel capture binary, heimwehr non - wideouts negative monterotondo discrete, wollo non - division-i negative continuous, and clutching zero - inflated continuous responses. epernay We arconada compare victims HCPF with kifner HPF 11.14 on nine discrete and heneghan three commoner continuous 59.87 data sets jiangzhou and conclude blackbirding that HCPF vina captures passikoff the relationship polillo between sparsity deven and response better than preempt HPF.", "histories": [["v1", "Wed, 13 Apr 2016 16:12:01 GMT  (1201kb,D)", "https://arxiv.org/abs/1604.03853v1", "Under Review for ICML 2016"], ["v2", "Thu, 26 May 2016 11:09:19 GMT  (1201kb,D)", "http://arxiv.org/abs/1604.03853v2", "Will appear on Proceedings of the 33 rd International Conference on Machine Learning, New York, NY, USA, 2016. JMLR: W&amp;CP volume 48"]], "COMMENTS": "Under Review for ICML 2016", "reviews": [], "SUBJECTS": "cs.LG cs.AI stat.ML", "authors": ["mehmet emin basbug", "barbara e engelhardt"], "accepted": true, "id": "1604.03853"}, "pdf": {"name": "1604.03853.pdf", "metadata": {"source": "CRF", "title": "Hierarchical Compound Poisson Factorization", "authors": ["Mehmet E. Basbug", "Barbara E. Engelhardt"], "emails": ["MEHMETBASBUG@YAHOO.COM", "BEE@PRINCETON.EDU"], "sections": [{"heading": "1. Introduction", "text": "Matrix factorization has been a central subject in statistics since the introduction of principal component analysis (PCA) (Pearson, 1901). The goal is to embed data into a lower dimensional space with minimal loss of information. The dimensionality reduction aspect of matrix factorization has become increasingly important in exploratory data analysis as the dimensionality of data has exploded.\nProceedings of the 33 rd International Conference on Machine Learning, New York, NY, USA, 2016. JMLR: W&CP volume 48. Copyright 2016 by the author(s).\nOne alternative to PCA, non-negative matrix factorization (NMF), was first developed for factorizing matrices for face recognition (Lee & Seung, 1999). The idea behind NMF is that the contributions of each feature to a factor are non-negative. Although the motivation behind this choice has roots in cerebral representations of objects, non-negativeness has found great appeal in applications such as collaborative filtering (Gopalan et al., 2013), document classification (Xu et al., 2003), and signal processing (Fe\u0301votte et al., 2009).\nIn collaborative filtering, the data are highly sparse user by item response matrices. For example, the Netflix movie rating data set includes 480K users, 17K movies and 100M ratings, meaning that 0.988 of the matrix entries are missing. In the donors-choose data set, the user (donor) response to an item (project) quantifies their monetary donation to that project; this matrix includes 1.3M donors, 525K projects and 2.66M donations, meaning that 0.999996 of the matrix entries are missing.\nIn the collaborative filtering literature, there are two school of thoughts on how to treat missing entries. The first one assumes that entries are missing at random; that is, we observe a uniformly sampled subset of the data (Marlin et al., 2012). Factorization is done on the premise that the response value provides all the information needed. The second method assumes that matrix entries are not missing at random, but instead there is a underlying mixture model: first, a coin is flipped to determine if an entry is missing. If the entry is missing, its value is set to zero; if it is not missing, the response is drawn from a specific distribution (Marlin & Zemel, 2009). In this framework, we postulate that absence of an entry carries information about the item and the user, and this information can be exploited to improve the overall quality of the factorization. The difficult part is in representing the connection between the absence of a response (sparsity model) and the numerical value of a response (response model) (Little & Rubin, 2014). We are concerned with the problem of sparse matrix factorization where the data are not missing at random. ar X iv :1\n60 4.\n03 85\n3v 2\n[ cs\n.L G\n] 2\n6 M\nay 2\n01 6\nExtensions to the NMF hint at a model that addresses this problem. Recent work showed that the NMF objective function is equivalent to a factorized Poisson likelihood (Cemgil, 2009). The authors proposed a Bayesian treatment of the Poisson model with Gamma conjugate priors on the latent factors, laying the foundation for hierarchical Poisson factorization (HPF) (Gopalan et al., 2013). The Gamma-Poisson structure is also used in earlier work for matrix factorization because of its favorable behavior (Canny, 2004; Ma et al., 2011). Long tailed Gamma priors were found to be powerful in capturing the underlying user and item behavior in collaborative filtering problems by applying strong shrinkage to the values near zero but allowing the non-zero responses to escape shrinkage (Polson & Scott, 2010). An extension of the Poisson factorization to non-discrete data using data augmentation has been considered (Fe\u0301votte et al., 2009; Fe\u0301votte & Idier, 2011). Along the similar lines, the connection between beta divergences and compound Poisson Gamma distribution is exploited to develop a non-negative matrix factorization model for sparse positive data (Simsekli et al., 2013). More recent work introduced a stochastic variational inference algorithm for scalable collaborative filtering using HPF (Gopalan et al., 2013).\nHPF models each factor contribution to be drawn from a Poisson distribution with a long tail gamma prior. Thanks to the additive property of Poisson, the sum of these contributions are again a Poisson random variable which is used to model the response. For a collaborative filtering problem, HPF treats missing entries as true zero responses when applied to both missing and non-missing entries (Gopalan et al., 2013). When the overwhelming majority of the matrix is missing, the posterior estimates for the Poisson factors are close to zero. This mechanism has a profound impact on the response model: When the Poisson parameter of a zero truncated Poisson (ZTP) distribution approaches zero, the ZTP converges to a degenerate distribution at 1. In other words, if we condition on the fact that an entry is not missing, the HPF predicts that the response value is 1 with a very high probability. Since the response model and sparsity model are so tightly coupled, HPF is suitable only for sparse binary matrices. When using HPF on the full matrix (i.e., missing data and responses together), one might binarize the data to improve performance of the HPF (Gopalan et al., 2013). However, binarization ignores the impact of the response model on absence. For instance, a user is more likely to watch a movie that is similar to a movie that she gave a high rating to relative to one that she rated lower. This information is ignored in the HPF model.\nIn this paper, we introduce hierarchical compound Poisson factorization (HCPF), which has the same Gamma-Poisson structure as the HPF model and is equally computationally tractable. HCPF differs from the HPC in that it flexibility\ndecouples the sparsity model from the response model, allowing the HCPF to accurately model binary, non-negative discrete, non-negative continuous and zero-inflated continuous responses in the context of extreme sparsity. Unlike HPF, the ZTP distribution does not concentrate around 1, but instead converges to the response distribution that we choose. In other words, we effectively decouple the sparsity model and the response model. Decoupling does not imply independence, but instead the ability to capture the distributional characteristics of the response more accurately in the presence of extreme sparsity. HCPF still retains the useful property of HPF that the expected nonmissing response value is related to the probability of nonabsence, allowing the sparsity model to exploit information from the responses.\nFirst we generalize HPF to handle non-discrete data. In Section 2, we introduce additive exponential dispersion models, a class of probability distributions. We show that any member of the additive exponential dispersion model family, including normal, gamma, inverse Gaussian, Poisson, binomial, negative binomial, and zero-truncated Poisson, can be used for the response model. In Section 3, we prove that a compound Poisson distribution converges to its element additive EDM distribution as sparsity increases.\nSection 4 describes the generative model for hierarchical compound Poisson factorization (HCPF) and the mean field stochastic variational inference (SVI) algorithm for HCPF, which allows us to fit HCPF to data sets with millions of rows and columns quickly (Gopalan et al., 2013). In Section 5, we show the favorable behavior of HCPF as compared to HPF on twelve data sets of varying size including ratings data sets (amazon, movielens, netflix and yelp), social media activity data sets (wordpress and tencent), a web activity data set (bestbuy), a music data set (echonest), a biochemistry data set (merck), financial data sets (donation and donorschoose), and a genomics data set (geuvadis)."}, {"heading": "2. Exponential Dispersion Models", "text": "Additive exponential dispersion models (EDMs) are a generalization of the natural exponential family where the nonzero dispersion parameter scales the log-partition function (Jorgensen, 1997). We first give a formal definition of additive EDM, and present seven useful members (Table 1). Definition 1. A family of distributions F\u03a8 ={ p(\u03a8,\u03b8,\u03ba) | \u03b8 \u2208 \u0398 = dom(\u03a8) \u2286 R, \u03ba \u2208 R++ } is called an additive exponential dispersion model if\np(\u03a8,\u03b8,\u03ba)(x) = exp(x\u03b8 \u2212 \u03ba\u03a8(\u03b8))h(x, \u03ba) (1)\nwhere \u03b8 is the natural parameter, \u03ba is the dispersion parameter, \u03a8(\u03b8) is the base log-partition function, and h(x, \u03ba) is the base measure.\nThe sum of additive EDMs with a shared natural parameter and base log partition function is again an additive EDM of the same type.\nTheorem 1 (Jorgensen, 1997). Let X1 . . . XM be a sequence of additive EDMs such thatXi \u223c p\u03a8(x; \u03b8, \u03bai), then X+ = X1 + \u00b7 \u00b7 \u00b7+XM \u223c p\u03a8(x; \u03b8, \u2211 i \u03bai).\nIn Table 1, we use a generalized definition of the zero truncated Poisson (ZTP) where the density of the sum of \u03ba i.i.d. random variables from an ordinary ZTP distribution can be expressed with the same formula (Springael & Van Nieuwenhuyse, 2006). The last column in Table 1 shows the variational update for the Poisson parameter of the compound Poisson additive EDM, further discussed in Section 3."}, {"heading": "3. Compound Poisson Distributions", "text": "We start with the general definition of a compound Poisson distribution and discuss compound Poisson additive EDM distributions. We then present the decoupling theorem and explain the implications of the theorem in detail.\nDefinition 2. Let N be a Poisson distributed random variable with parameter \u039b, X1, . . . , XN be i.i.d. random variables distributed with an element distribution p\u03a8(x; \u03b8, \u03ba). Then X+ . = X1 + \u00b7 \u00b7 \u00b7 + XN \u223c p\u03a8(x; \u03b8, \u03ba,\u039b) is called a compound Poisson random variable.\nIn general, p\u03a8(x; \u03b8, \u03ba,\u039b) does not have a closed form expression, but it is a well defined probability distribution. The conditional form, X+ | N , is usually easier to manipulate, and we can calculate the marginal distribution of X+ by integrating out N . When N = 0, X+ has a degenerate distribution at zero. Furthermore, if the element distribu-\ntion is an additive EDM, we have the following theorem: Theorem 2. Let X \u223c p\u03a8(x; \u03b8, \u03ba) be an additive EDM and X+ \u223c p\u03a8(x; \u03b8, \u03ba,\u039b) be the compound Poisson random variable with the element random variable X , then\nX+ | N = n \u223c p\u03a8(x; \u03b8, n\u03ba) (2) X+ | N = 0 \u223c \u03b40. (3)\nTheorem 2 implies that the conditional distribution of a compound Poisson additive EDM is again an additive EDM. Hence, both the conditional and the marginal densities of X+ can be calculated easily.\nWe make the following remark before the decoupling theorem. Later, we show that HPF is a degenerate form of our model using this remark. Remark 1. Compound Poisson random variable X+ is an ordinary Poisson random variable with parameter \u039b if and only if the element distribution is a degenerate distribution at 1.\nWe now present the decoupling theorem. This theorem shows that the distribution of a zero truncated compound Poisson random variable converges to its element distribution as the Poisson parameter (\u039b) goes to zero. Theorem 3. LetX++ . = X+ | X+ 6= 0 be a zero truncated compound Poisson random variable with element random variable X . If zero is not in the support of X , then\nPr(X+ = 0) = e \u2212\u039b (4)\nE[X++] = \u039b\n1\u2212 e\u2212\u039b E[X] (5)\nX++ D\u2192 X as \u039b\u2192 0. (6)\nProofs of Theorem 2, 3 and Remark 1 can be found in the Appendix.\nLet X+ be a compound Poisson variable with element random distribution p\u03a8(x; \u03b8, \u03ba) and let X++ be the zero truncated X+ as in Theorem 3. We can study the probability density function (PDF) of X++ at various sparsity levels (Fig 1; Eq 4) with respect to the average sparsity levels of our 9 discrete data sets and 3 continuous data sets. Importantly, the element distribution is nearly identical across all levels of sparsity.\nWe will use X+ to model an entry of a full sparse matrix, meaning that we are including both missing and nonmissing entries. The zero truncated random variable,X++, corresponds to the non-missing response. In Fig 1a, X+ is an ordinary Poisson variable. As Remark 1 and Theorem 3 suggest, at levels of extreme sparsity (i.e., > 90% zeros), almost all of the probability mass of X++ concentrates at 1. That is, HPF predicts that, if an entry is not missing, then its value is 1 with a high probability. To get a more flexible response model, we might regularize X+ with appropriate gamma priors; however, this approach would degrade the performance of the sparsity model.\nOn the other hand, when X+ is a compound PoissonZTP random variable with \u03bb = 7, extreme sparsity levels have virtually no effect on the distribution of the response (Fig 1b). Using the HCPF, we are free to choose any additive distribution for the response model. For discrete response data, we might opt for degenerate, Poisson, binomial, negative binomial or ZTP and for continuous response data, we might select gamma, inverse Gaussian or normal distribution. Furthermore, HCPF explicitly encodes a relationship between non-absence, Pr(X+ 6= 0), and the expected non-missing response value, E[X++] (Eq 4 and Eq 5), which is defined via the choice of response model.\nHPF, as a degenerate HCPF model, defines this relationship as X \u223c \u03b41 and E[X++] = 1, which leads to the poor behavior outside of binary sparse matrices. Along with the flexibility of choosing the most natural element distribution, HCPF is capable of decoupling the sparsity and response models while still encoding a data-specific relationship between the sparsity model and the values of the nonzero responses in expectation."}, {"heading": "4. Hierarchical Compound Poisson Factorization (HCPF)", "text": "Next, we describe the generative process for HCPF and the Gamma-Poisson structure. We explain the intuition behind the choices of the long-tailed Gamma priors. We then present the stochastic variational inference (SVI) algorithm for HCPF.\nWe can write the generative model of the HCPF with element distribution p\u03a8(x; \u03b8, \u03ba) with fixed hyperparameters \u03b8 and \u03ba as follows, whereCU andCI are the number of users and items, respectively:\n\u2022 For each user u = 1, . . . , CU 1. Sample ru \u223c Ga(\u03c1, \u03c1/%) 2. For each component k, sample suk \u223c Ga(\u03b7, ru)\n\u2022 For each item i = 1, . . . , CI 1. Sample wi \u223c Ga(\u03c9, \u03c9/$) 2. For each component k, sample vik \u223c Ga(\u03b6, wi)\n\u2022 For each user u and item i 1. Sample count nui \u223c Po( \u2211 k sukvik)\n2. Sample response yui \u223c p\u03a8(\u03b8, nui\u03ba)\nAlgorithm 1 SVI for HCPF Initialize: Hyperparameters \u03b7, \u03b6, \u03c1, %, \u03c9,$, \u03b8, \u03ba, \u03c4, \u03be and parameters tu = \u03c4, ti = \u03c4, bru = \u03c1/%, a s uk = \u03b7\nbsuk = %, b w i = \u03c9/$, a v ik = \u03b6, b v ik = $ Fix:\naru = \u03c1+K\u03b7 a w i = \u03c9 +K\u03b6\nrepeat Sample an observation yui uniformly from the data set Compute local variational parameters\n\u039bui = \u2211 k asuka v ik bsukb v ik\nq(nui = n) \u221d exp {\u2212\u03ban\u03a8(\u03b8)}h(yui, n\u03ba) \u039bnui n!\n\u03d5uik \u221d exp {\u03a8(asuk)\u2212 log bsuk +\u03a8(avik)\u2212 log bvik}\nUpdate global variational parameters\nbru = (1\u2212 t\u2212\u03beu )bru + t\u2212\u03beu\n( \u03c1\n% + \u2211 k asuk bsuk ) asuk = (1\u2212 t\u2212\u03beu )asuk + t\u2212\u03beu (\u03b7 + CIE[nui]\u03d5uik)\nbsuk = (1\u2212 t\u2212\u03beu )bsuk + t\u2212\u03beu ( aru bru + CI avik bvik ) bwi = (1\u2212 t \u2212\u03be i )b w i + t \u2212\u03be i ( \u03c9\n$ + \u2211 k avik bvik ) avik = (1\u2212 t \u2212\u03be i )a v ik + t \u2212\u03be i (\u03b6 + CUE[nui]\u03d5uik)\nbvik = (1\u2212 t \u2212\u03be i )b v ik + t \u2212\u03be i ( awi bwi + CU asuk bsuk ) Update learning rates\ntu = tu + 1 ti = ti + 1\n(Optional) Update hyperparameters \u03b8 and \u03ba until Validation log likelihood converges\nThe mean field variational distribution for HCPF is given by\nq(ru | aru, bru)q(suk | asuk, bsuk)q(wi | awi , bwi ) q(vik | avik, bvik)q(zui | \u03d5ui)q(nui).\nThe choice of long tail gamma priors has substantial implications for the response model in a collaborative filtering framework.The effect of the gamma prior on a particular user\u2019s responses is to effectively characterize her average response. Similarly, a gamma prior on a particular item models the average users\u2019 response for that item. The long\ntail gamma prior assumption for users allows some users to have unusually high responses. For instance, in the donations data, we might expect to observe a few donors who make extraordinarily large donations to a few projects. This is not appropriate for movie ratings, since the maximum rating is 5, and a substantial number of non-missing ratings are fives. The long tail gamma prior for items allow a few items to receive unusually high average responses. This is a useful property of all of our data sets: we imagine that a few projects may attract particularly large donations, a few blogs may receive a lot of likes, or a few movies receive an unusually high average rating.\nThe choice of long tail gamma priors has different implications in terms of the sparsity model. The gamma prior on a particular user models how active she is, that is, how many items she has responses for. The long tail assumption on the sparsity model implies that there are unusually active users (e.g., cinephiles or frequent donors). The long tail assumption for items corresponds to very popular items with a large number of responses. Note that the movies with the most ratings are not necessarily the highest rated movies.\nWe leverage the fact that the contributions of Poisson factors can be written as a multinomial distribution (Cemgil, 2009). Using this, we can write out the stochastic variational inference algorithm for HCPF (Hoffman et al., 2013), where \u03c4 and \u03be are the learning rate delay and learning rate power, and \u03c4 > 0 and 0.5 < \u03be < 1.0 (Alg 1). Note that the HCPF is not a conjugate model due to q(nui). For other variational updates, we only need the statistics E[nui]. For that purpose, we calculate q(nui = n) explicitly for n = 1, . . . , Ntr. The choice for the truncation value, Ntr, depends on \u03b8, \u03ba, and \u039bui. We set Ntr using the expected range of \u039bui and yui as well as fixed \u03b8 and \u03ba.\nHCPF reduces to HPF when we set q(nui) = \u03b4yui . The specific form of q(nui) for different additive EDMs is given in Table 1."}, {"heading": "5. Results", "text": ""}, {"heading": "5.1. Data sets for collaborative filtering", "text": "We performed matrix factorization on 12 different data sets with different levels of sparsity, response characteristics, and sizes (Table 2). The rating data sets include amazon fine food ratings (McAuley & Leskovec, 2013), movielens (Harper & Konstan, 2015), netflix (Bell & Koren, 2007) and yelp, where the responses are a star rating from 1 to 5. The only exception is movielens where the maximum rating is 10. The social media data sets include wordpress and tencent (Niu et al., 2012), where the response is the number of likes, a non-negative integer value. Commercial data sets include bestbuy, where the response is the number of user visit to a product page. The biochem-\nistry data sets include merck (Ma et al., 2015), which captures molecules (users) and chemical characteristics (items) where the response is the chemical activity. In echonest (Bertin-Mahieux et al., 2011), the response is the number of times a user listened a song. The donation data sets donation and donorschoose includes donors and projects, where the response is the total amount of a donation in US dollars. The genomics data set geuvadis includes genes and individuals, where the response is the gene expression level for a user of a gene (Lappalainen et al., 2013). Both bestbuy and merck are nearly binary matrices, meaning that the vast majority of the non-missing entries are one. On the other hand, donation, donorschoose, and geuvadis have a continuous response variable."}, {"heading": "5.2. Experimental setup", "text": "We held out 20% and 1% of the non-missing entries for testing (YtestNM ) and validation, respectively. We also sampled an equal number of missing entries for testing (YtestM ) and validation. When calculating test and validation log likelihood, the log likelihood of the missing entries is adjusted to reflect the true sparsity ratio. Test log likelihood of the missing (LM ) and non-missing entries (LNM ) as well as the test log likelihood of a non-missing entry conditioned on that it is not missing (LCNM ) are calculated as\nLM = \u2211 YtestM logPo(n = 0 | \u039bui)\nLNM = \u2211 YtestNM log Ntr\u2211 n=0 p\u03a8(y test ui ; \u03b8, n\u03ba)Po(n | \u039bui)\nL = 0.2(#total missing) | YtestM | LM + LNM\nLCNM = \u2211 YtestNM log Ntr\u2211 n=1 p\u03a8(y test ui ; \u03b8, n\u03ba)ZTP (n | \u039bui).\nIn HCPF, we fix K = 160, \u03be = 0.7 and \u03c4 = 10, 000 after an empirical study on smaller data sets. To set hyperparameters \u03b8 and \u03ba, we use the maximum likelihood estimates of the element distribution parameters on the nonmissing entries. From the number of non-missing entries in the training data set, we inferred the sparsity level, effectively estimating E[nui] empirically (note that we assume E[nui] is the same for every user-item pair). We then used E[nui] to set the factorization hyperparameters \u03b7, \u03b6, \u03c1, %, \u03c9,$. To create heavy tails and uninformative gamma priors, we set $ = % = 0.1 and \u03c9 = \u03c1 = 0.01. We then assumed that the contribution of each factor is equal, and set \u03b7 = % \u221a E[nui]/K and \u03b6 = $ \u221a E[nui]/K. When training on the non-missing entries only, we simply assume that the sparsity level is very low (0.001), and from that we set the parameters as usual, and divide the maximum like-\nlihood estimate of \u03ba by E[nui]. Earlier work noted that HPF is not sensitive to hyperparameter settings within reason (Gopalan et al., 2013).\nTo identify the best response model for HCPF, we ran SVI with all seven additive EDM distributions in Table 1. We first fit all HCPF models by sampling from the full matrix. We calculated L,LM ,LNM and LCNM . In Section 5.3, we compare HCPF and HPF in L. In the second analysis, we only used the non-missing entries for training and calculated LNM . In Section 5.4, we compared LCNM of the first analysis to LNM of the second analysis."}, {"heading": "5.3. Overall performance", "text": "In this analysis we quantify how well these models capture both the sparsity and response behavior in ultra sparse matrices. In a movie ratings data set, the question becomes \u2018Can we predict if a user would rate a given movie and if she does what rating she would give?\u2019. We report the test log likelihood of all twelve data sets. We fit HCPF with normal, gamma, and inverse Gaussian as element distributions for all the data sets. In discrete data sets, we additionally fit HPF and HCPF with Poisson, binomial, negative binomial, and zero truncated Poisson element distributions.\nIn all ratings data sets (amazon, movielens, netflix, and yelp), HCPF significantly outperforms HPF (Table 3). The relative performance difference is even more pronounced in sparser data sets (amazon and yelp). When we break down the test log likelihood into missing and non-missing parts, we see that, in sparser data sets, the relative performance of HPF for non-missing entries is much weaker than it is for less sparse data sets. This is expected, as response coupling in HPF is stronger in sparser data sets, forcing the response variables to zero. The opposite is true for HCPF: its performance improves with increasing data sparsity.\nIn social media activity data (wordpress and tencent) and the music data set (echonest), HCPF shows a significant improvement over HPF (Table 3). Unlike the ratings data sets, we have an unbounded response variable with an ex-\nponentially decaying characteristic. At first HPF might seem to be a good model for such data; however, the sparsity level is so high that the non-missing point mass concentrates at 1. This is best seen in the comparison of HPF with HCPF-ZTP. Although the Poisson distribution seems to capture response characteristic effectively, the test performance degrades when zero is included as part of the response model (as in HPF).\nIn the bestbuy and merck data sets, where the response is near binary, HPF and HCPF performances are very similar. This confirms the observation that HPF is a sufficiently good model for sparse binary data sets. In the financial data sets (donation and donors-choose), we see that the gamma and inverse Gaussian are better distributional choices than the normal as the element distribution."}, {"heading": "5.4. Response model evaluated using test log likelihood", "text": "In this section, we investigate which model captures the response most accurately. In a movie ratings data set, the\nquestion becomes \u2018Can we predict what rating a user would give to a movie given that we know she rated that movie?\u2019. In Table 4, we report the conditional non-missing test log likelihood of models trained on the full matrix and test log likelihood of the models trained only on the non-missing entries.\nFirst, we note that training HPF only on the non-missing entries results in a better response model than training HPF on the full matrix. The only exception is bestbuy where the conditional non-missing test log likelihood is near perfect. This is due to the near binary structure of the data set. When we know if an entry is not missing, then we are fairly confident that it has a value of 1.\nSecondly, we investigate if modeling the missing entries explicitly helps the response model. We compare HPF trained on the non-missing entries to HCPF trained on the full matrix. HCPF-BI outperforms HPF in all ratings data sets except for movielens. A similar pattern can be seen in social media and music data sets where HCPF-IG seems to\nbe the best model.\nThis phenomenon can be attributed to better identification of the relationship between the sparsity model and the response model. Although HPF trained on the full matrix can also capture this relationship, the high sparsity levels force HPF to fit near-zero Poisson parameters, hurting the prediction for response. In ratings data sets, HCPF captures the notion that more likely people are to consume an item, higher their responses are. In movielens and netflix for instance, we know that the most watched movies tend to have higher ratings. In social media data sets, the relation between the reach and popularity is captured. The more followers a blog has, the more content it is likely to produce, and the more reaction it will get. A similar correlation exists for the users as well. The more active users are also the more responsive ones. In summary, HCPF can capture the relationship between the non-missingness of an entry and the actual value of the entry if it is non-missing. Any NMF algorithm that makes the missing at random assumption would miss this relationship.\nOne might argue that perhaps HPF is not a good model because the underlying response distribution is not Possion like. Comparing the rows marked \u2018NM\u2019, we observe that there is some truth to this argument. In netflix and yelp data sets, HCPF-BI outperforms HPF; however, we also see that training HCPF-BI on the full matrix is even better. A similar argument can be made for HCPF-GA in social media data sets (wordpress and tencent). The flexibility of HCPF is a key factor to identifying the underlying response distribution. The ability to model sparsity and response at the same time gives HCPF a further edge in modeling response."}, {"heading": "5.5. Sparsity model evaluated using AUC", "text": "In a movie ratings data set or a purchasing data set, one important question is \u2018Can we predict if a user would rate a given movie or buy a certain item?\u2019. To understand the quality of our performance on this task, we evaluated the sparsity model separately by computing the area under the ROC curve (AUC), fitting all HCPF models by sampling from the full matrix and HPF to the binarized full matrix\n(Table 5). To calculate the AUC, the true label is whether the data are missing (0) or non-missing (1), and we used the estimated probability of a non-missing entry, Pr(X+ 6= 0), as the model prediction. As discussed in Section 5.3, when we fit HPF to the full matrix, we compromise performance on sparsity and response. HCPF, on the other hand, enjoys the decoupling effect while preserving the relationship in expectation (see Eq 5). In 10 of the 12 data sets, we get an improvement over HPF (Table 5); this is somewhat surprising as the HPF is specialized to this task; this illustrates the benefit of coupling the sparsity and response models in expectation. Better modeling of the response would naturally lead to a better sparsity model."}, {"heading": "6. Conclusion", "text": "In this paper, we first proved that a zero truncated compound Poisson distribution converges to its element distribution as sparsity increases. The implication of this theorem for HPF is that the non-missing response distribution concentrates at 1, which is not a good response model unless we have a binary data set. Inspired by the convergence theorem, we introduce HCPF. Similar to HPF, HCPF has the favorable Gamma-Poisson structure to model longtailed user and item activity. Unlike HPF, HCPF is capable of modeling binary, non-negative discrete, non-negative continuous and zero-inflated continuous data. More importantly, HCPF decouples the sparsity and response models, allowing us to specify the most suitable distribution for the non-missing response entries. We show that this decoupling effect improves the test log likelihood dramatically when compared to HPF on high-dimensional, extremely sparse matrices. HCPF also shows superior performance to HPF trained exclusively on non-missing entries in terms of modeling response. Finally, we show that HCPF is a better sparsity model than HPF, despite HPF targeting this sparsity behavior.\nFor future directions, we will investigate the implications of the decoupling theorem in other Bayesian settings. We will also explore hierarchical latent structures for the element distribution."}, {"heading": "Acknowledgements", "text": "BEE was funded by NIH R00 HG006265, NIH R01 MH101822, and a Sloan Faculty Fellowship. MEB was funded in part by the Princeton Innovation J. Insley Blair Pyne Fund Award. We would like to thank Robert E. Schapire for valuable discussions."}], "references": [{"title": "Lessons from the netflix prize challenge", "author": ["R.M. Bell", "Y. Koren"], "venue": "ACM SIGKDD Explorations Newsletter,", "citeRegEx": "Bell and Koren,? \\Q2007\\E", "shortCiteRegEx": "Bell and Koren", "year": 2007}, {"title": "The million song dataset", "author": ["T. Bertin-Mahieux", "D.P.W. Ellis", "B. Whitman", "P. Lamere"], "venue": "In International Society for Music Information Retrieval Conference,", "citeRegEx": "Bertin.Mahieux et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Bertin.Mahieux et al\\.", "year": 2011}, {"title": "Gap: a factor model for discrete data", "author": ["J. Canny"], "venue": "In ACM SIGIR Conference on Research and Development in Information Retrieval,", "citeRegEx": "Canny,? \\Q2004\\E", "shortCiteRegEx": "Canny", "year": 2004}, {"title": "Bayesian inference for nonnegative matrix factorisation models", "author": ["A.T. Cemgil"], "venue": "Computational Intelligence and Neuroscience,", "citeRegEx": "Cemgil,? \\Q2009\\E", "shortCiteRegEx": "Cemgil", "year": 2009}, {"title": "Algorithms for nonnegative matrix factorization with the \u03b2-divergence", "author": ["C. F\u00e9votte", "J. Idier"], "venue": "Neural Computation,", "citeRegEx": "F\u00e9votte and Idier,? \\Q2011\\E", "shortCiteRegEx": "F\u00e9votte and Idier", "year": 2011}, {"title": "Nonnegative matrix factorization with the itakura-saito divergence: With application to music analysis", "author": ["C. F\u00e9votte", "N. Bertin", "J.L. Durrieu"], "venue": "Neural Computation,", "citeRegEx": "F\u00e9votte et al\\.,? \\Q2009\\E", "shortCiteRegEx": "F\u00e9votte et al\\.", "year": 2009}, {"title": "Scalable recommendation with poisson factorization", "author": ["P. Gopalan", "J.M. Hofman", "D.M. Blei"], "venue": "arXiv preprint arXiv:1311.1704,", "citeRegEx": "Gopalan et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Gopalan et al\\.", "year": 2013}, {"title": "The movielens datasets: History and context", "author": ["F.M. Harper", "J.A. Konstan"], "venue": "ACM Transactions on Interactive Intelligent Systems,", "citeRegEx": "Harper and Konstan,? \\Q2015\\E", "shortCiteRegEx": "Harper and Konstan", "year": 2015}, {"title": "Stochastic variational inference", "author": ["M.D. Hoffman", "D.M. Blei", "C. Wang", "J. Paisley"], "venue": "The Journal of Machine Learning Research,", "citeRegEx": "Hoffman et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Hoffman et al\\.", "year": 2013}, {"title": "The theory of dispersion models", "author": ["B. Jorgensen"], "venue": "CRC Press,", "citeRegEx": "Jorgensen,? \\Q1997\\E", "shortCiteRegEx": "Jorgensen", "year": 1997}, {"title": "Transcriptome and genome sequencing uncovers functional variation in humans", "author": ["T. Lappalainen", "M. Sammeth", "M.R. Friedlnder", "P. ACt Hoen", "J. Monlong", "M.A. Rivas", "M. GonzlezPorta", "N. Kurbatova", "T. Griebel", "P.G. Ferreira", "M. Barann"], "venue": "Nature,", "citeRegEx": "Lappalainen et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Lappalainen et al\\.", "year": 2013}, {"title": "Learning the parts of objects by non-negative matrix factorization", "author": ["D.D. Lee", "H.S. Seung"], "venue": null, "citeRegEx": "Lee and Seung,? \\Q1999\\E", "shortCiteRegEx": "Lee and Seung", "year": 1999}, {"title": "Statistical analysis with missing data", "author": ["R.J.A. Little", "D.B. Rubin"], "venue": null, "citeRegEx": "Little and Rubin,? \\Q2014\\E", "shortCiteRegEx": "Little and Rubin", "year": 2014}, {"title": "Probabilistic factor models for web site recommendation", "author": ["H. Ma", "C. Liu", "I. King", "M.R. Lyu"], "venue": "In ACM SIGIR Conference on Research and Development in Information Retrieval,", "citeRegEx": "Ma et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Ma et al\\.", "year": 2011}, {"title": "Deep neural nets as a method for quantitative structure\u2013activity relationships", "author": ["J. Ma", "R.P. Sheridan", "A. Liaw", "G.E. Dahl", "V. Svetnik"], "venue": "Journal of Chemical Information and Modeling,", "citeRegEx": "Ma et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Ma et al\\.", "year": 2015}, {"title": "Collaborative filtering and the missing at random assumption", "author": ["B. Marlin", "R.S. Zemel", "S. Roweis", "M. Slaney"], "venue": "arXiv preprint arXiv:1206.5267,", "citeRegEx": "Marlin et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Marlin et al\\.", "year": 2012}, {"title": "Collaborative prediction and ranking with non-random missing data", "author": ["B.M. Marlin", "R.S. Zemel"], "venue": "In ACM Conference on Recommender Systems,", "citeRegEx": "Marlin and Zemel,? \\Q2009\\E", "shortCiteRegEx": "Marlin and Zemel", "year": 2009}, {"title": "From amateurs to connoisseurs: modeling the evolution of user expertise through online reviews", "author": ["J.J. McAuley", "J. Leskovec"], "venue": "In International Conference on World Wide Web,", "citeRegEx": "McAuley and Leskovec,? \\Q2013\\E", "shortCiteRegEx": "McAuley and Leskovec", "year": 2013}, {"title": "The tencent dataset and kddcup12", "author": ["Y. Niu", "Y. Wang", "G. Sun", "A. Yue", "B. Dalessandro", "C. Perlich", "B. Hamner"], "venue": "In KDD-Cup Workshop,", "citeRegEx": "Niu et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Niu et al\\.", "year": 2012}, {"title": "Liii. on lines and planes of closest fit to systems of points in space", "author": ["K. Pearson"], "venue": "The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science,", "citeRegEx": "Pearson,? \\Q1901\\E", "shortCiteRegEx": "Pearson", "year": 1901}, {"title": "Shrink globally, act locally: Sparse bayesian regularization and prediction", "author": ["Polson", "N. G", "J.G. Scott"], "venue": "Bayesian Statistics,", "citeRegEx": "Polson et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Polson et al\\.", "year": 2010}, {"title": "Learning the beta-divergence in tweedie compound poisson matrix factorization models", "author": ["U. Simsekli", "A.T. Cemgil", "Y.K. Yilmaz"], "venue": "In International Conference on Machine Learning,", "citeRegEx": "Simsekli et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Simsekli et al\\.", "year": 2013}, {"title": "On the sum of independent zero-truncated Poisson random variables", "author": ["J. Springael", "I. Van Nieuwenhuyse"], "venue": "University of Antwerp, Faculty of Applied Economics,", "citeRegEx": "Springael and Nieuwenhuyse,? \\Q2006\\E", "shortCiteRegEx": "Springael and Nieuwenhuyse", "year": 2006}, {"title": "Document clustering based on non-negative matrix factorization", "author": ["W. Xu", "X. Liu", "Y. Gong"], "venue": "In ACM SIGIR Conference on Research and Development in Informaion Retrieval,", "citeRegEx": "Xu et al\\.,? \\Q2003\\E", "shortCiteRegEx": "Xu et al\\.", "year": 2003}], "referenceMentions": [{"referenceID": 19, "context": "Matrix factorization has been a central subject in statistics since the introduction of principal component analysis (PCA) (Pearson, 1901).", "startOffset": 123, "endOffset": 138}, {"referenceID": 6, "context": "Although the motivation behind this choice has roots in cerebral representations of objects, non-negativeness has found great appeal in applications such as collaborative filtering (Gopalan et al., 2013), document classification (Xu et al.", "startOffset": 181, "endOffset": 203}, {"referenceID": 23, "context": ", 2013), document classification (Xu et al., 2003), and signal processing (F\u00e9votte et al.", "startOffset": 33, "endOffset": 50}, {"referenceID": 5, "context": ", 2003), and signal processing (F\u00e9votte et al., 2009).", "startOffset": 31, "endOffset": 53}, {"referenceID": 15, "context": "The first one assumes that entries are missing at random; that is, we observe a uniformly sampled subset of the data (Marlin et al., 2012).", "startOffset": 117, "endOffset": 138}, {"referenceID": 3, "context": "Recent work showed that the NMF objective function is equivalent to a factorized Poisson likelihood (Cemgil, 2009).", "startOffset": 100, "endOffset": 114}, {"referenceID": 6, "context": "The authors proposed a Bayesian treatment of the Poisson model with Gamma conjugate priors on the latent factors, laying the foundation for hierarchical Poisson factorization (HPF) (Gopalan et al., 2013).", "startOffset": 181, "endOffset": 203}, {"referenceID": 2, "context": "The Gamma-Poisson structure is also used in earlier work for matrix factorization because of its favorable behavior (Canny, 2004; Ma et al., 2011).", "startOffset": 116, "endOffset": 146}, {"referenceID": 13, "context": "The Gamma-Poisson structure is also used in earlier work for matrix factorization because of its favorable behavior (Canny, 2004; Ma et al., 2011).", "startOffset": 116, "endOffset": 146}, {"referenceID": 5, "context": "An extension of the Poisson factorization to non-discrete data using data augmentation has been considered (F\u00e9votte et al., 2009; F\u00e9votte & Idier, 2011).", "startOffset": 107, "endOffset": 152}, {"referenceID": 21, "context": "Along the similar lines, the connection between beta divergences and compound Poisson Gamma distribution is exploited to develop a non-negative matrix factorization model for sparse positive data (Simsekli et al., 2013).", "startOffset": 196, "endOffset": 219}, {"referenceID": 6, "context": "More recent work introduced a stochastic variational inference algorithm for scalable collaborative filtering using HPF (Gopalan et al., 2013).", "startOffset": 120, "endOffset": 142}, {"referenceID": 6, "context": "For a collaborative filtering problem, HPF treats missing entries as true zero responses when applied to both missing and non-missing entries (Gopalan et al., 2013).", "startOffset": 142, "endOffset": 164}, {"referenceID": 6, "context": ", missing data and responses together), one might binarize the data to improve performance of the HPF (Gopalan et al., 2013).", "startOffset": 102, "endOffset": 124}, {"referenceID": 6, "context": "Section 4 describes the generative model for hierarchical compound Poisson factorization (HCPF) and the mean field stochastic variational inference (SVI) algorithm for HCPF, which allows us to fit HCPF to data sets with millions of rows and columns quickly (Gopalan et al., 2013).", "startOffset": 257, "endOffset": 279}, {"referenceID": 9, "context": "Additive exponential dispersion models (EDMs) are a generalization of the natural exponential family where the nonzero dispersion parameter scales the log-partition function (Jorgensen, 1997).", "startOffset": 174, "endOffset": 191}, {"referenceID": 9, "context": "Theorem 1 (Jorgensen, 1997).", "startOffset": 10, "endOffset": 27}, {"referenceID": 3, "context": "We leverage the fact that the contributions of Poisson factors can be written as a multinomial distribution (Cemgil, 2009).", "startOffset": 108, "endOffset": 122}, {"referenceID": 8, "context": "Using this, we can write out the stochastic variational inference algorithm for HCPF (Hoffman et al., 2013), where \u03c4 and \u03be are the learning rate delay and learning rate power, and \u03c4 > 0 and 0.", "startOffset": 85, "endOffset": 107}, {"referenceID": 18, "context": "The social media data sets include wordpress and tencent (Niu et al., 2012), where the response is the number of likes, a non-negative integer value.", "startOffset": 57, "endOffset": 75}, {"referenceID": 14, "context": "istry data sets include merck (Ma et al., 2015), which captures molecules (users) and chemical characteristics (items) where the response is the chemical activity.", "startOffset": 30, "endOffset": 47}, {"referenceID": 1, "context": "In echonest (Bertin-Mahieux et al., 2011), the response is the number of times a user listened a song.", "startOffset": 12, "endOffset": 41}, {"referenceID": 10, "context": "The genomics data set geuvadis includes genes and individuals, where the response is the gene expression level for a user of a gene (Lappalainen et al., 2013).", "startOffset": 132, "endOffset": 158}, {"referenceID": 6, "context": "Earlier work noted that HPF is not sensitive to hyperparameter settings within reason (Gopalan et al., 2013).", "startOffset": 86, "endOffset": 108}], "year": 2016, "abstractText": "Non-negative matrix factorization models based on a hierarchical Gamma-Poisson structure capture user and item behavior effectively in extremely sparse data sets, making them the ideal choice for collaborative filtering applications. Hierarchical Poisson factorization (HPF) in particular has proved successful for scalable recommendation systems with extreme sparsity. HPF, however, suffers from a tight coupling of sparsity model (absence of a rating) and response model (the value of the rating), which limits the expressiveness of the latter. Here, we introduce hierarchical compound Poisson factorization (HCPF) that has the favorable GammaPoisson structure and scalability of HPF to highdimensional extremely sparse matrices. More importantly, HCPF decouples the sparsity model from the response model, allowing us to choose the most suitable distribution for the response. HCPF can capture binary, non-negative discrete, non-negative continuous, and zero-inflated continuous responses. We compare HCPF with HPF on nine discrete and three continuous data sets and conclude that HCPF captures the relationship between sparsity and response better than HPF.", "creator": "LaTeX with hyperref package"}}}