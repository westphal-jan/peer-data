{"id": "1701.08074", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "27-Jan-2017", "title": "Model-Free Control of Thermostatically Controlled Loads Connected to a District Heating Network", "abstract": "misfortune Optimal hyperkinetic control \u20ac of thermostatically controlled whittock loads bomb-proof connected bidirectional to fining a district philly heating network bapak is considered a sequential kontio decision - making swirsky problem under baccini uncertainty. The entombed practicality dedlock of a cheruiyot direct markland model - based approach is compromised by 75,000-seat two retford challenges, namely tias scalability 1261 due oronsay to unpromising the large paralamas dimensionality t\u00ecnh of 120.88 the problem d\u012bn and the system identification required croshere to identify uschi an accurate shinbone model. begbie To 53.84 help azumazeki in a-com mitigating these vulpes problems, this usefully paper arvesen leverages on recent deputation developments in reinforcement swatantra learning duck-like in konigsburg combination with pantoprazole a duets market - zanamivir based aditjondro multi - neurophysiological agent endearing system wagher to obtain a scalable boundaries solution that pavia obtains coverdale a significant performance yahiko improvement in a refreshment practical aslo learning time. speranza The control ta\u00f1\u00f3n approach hanegev is iganga applied on a fusarium scenario creggan comprising 100 thermostatically controlled neubert loads connected heed to a wing radial mitteleuropa district heating divvy network cespedes supplied by fracturing a citylife central glasson combined clemetson heat axillaris and power plant. urrutia Both majlis for unica an benfield energy arbitrage getnick and a peak shaving objective, the 122.28 control 97.55 approach miramonte requires yonhap 60 days to obtain a performance within rehz 65% of rutherglen a anti-british theoretical lower bound herse on the cost.", "histories": [["v1", "Fri, 27 Jan 2017 15:15:54 GMT  (2421kb,D)", "https://arxiv.org/abs/1701.08074v1", "Under review at Elsevier: Energy and buildings 2017"], ["v2", "Fri, 24 Feb 2017 15:59:34 GMT  (2419kb,D)", "http://arxiv.org/abs/1701.08074v2", "Under review at Elsevier: Energy and buildings 2017"]], "COMMENTS": "Under review at Elsevier: Energy and buildings 2017", "reviews": [], "SUBJECTS": "cs.SY cs.LG", "authors": ["bert j claessens", "dirk vanhoudt", "johan desmedt", "frederik ruelens"], "accepted": false, "id": "1701.08074"}, "pdf": {"name": "1701.08074.pdf", "metadata": {"source": "CRF", "title": "Model-Free Control of Thermostatically Controlled Loads Connected to a District Heating Network", "authors": ["Bert J. Claessensa", "D. Vanhoudta", "J. Desmedta", "F. Ruelensb"], "emails": ["bert.claessens@restore.eu"], "sections": [{"heading": null, "text": "Optimal control of thermostatically controlled loads connected to a district heating network is considered a sequential decisionmaking problem under uncertainty. The practicality of a direct model-based approach is compromised by two challenges, namely scalability due to the large dimensionality of the problem and the system identification required to identify an accurate model. To help in mitigating these problems, this paper leverages on recent developments in reinforcement learning in combination with a market-based multi-agent system to obtain a scalable solution that obtains a significant performance improvement in a practical learning time. The control approach is applied on a scenario comprising 100 thermostatically controlled loads connected to a radial district heating network supplied by a central combined heat and power plant. Both for an energy arbitrage and a peak shaving objective, the control approach requires 60 days to obtain a performance within 65% of a theoretical lower bound on the cost.\nKeywords: District heating, combined heat and power, reinforcement learning, thermostatically controlled loads."}, {"heading": "1. Introduction", "text": "A District Heating Network (DHN) offers the opportunity to provide the collective heat demand of a cluster of geographically concentrated buildings through a set of central heat sources. This allows the use of centralized production techniques with an efficiency exceeding that of distributed production. Combined Heat and Power plants (CHPs) are a prominent example, as 80- 90% of the primary energy is converted to heat and electricity [1, 2, 3]. But also heat from a geothermal source [4] or excess heat resulting from an industrial process can be used as primary heat source. The heat from the sources is transported through a network of pipes using water as a medium. At each building, heat is extracted in a local substation, resulting in water at a lower temperature, being transported back to the different heat sources. A typical operational model at the production side is to modulate the power of the heat sources to keep the supply temperature close to a design setting. This basically results in the thermal supply following the thermal demand. Heat storage however, can provide demand flexibility enabling flexibility at the production side through demand response approaches. This flexibility allows operational opportunities for cost reduction, examples being peak shaving/valley filling [5] and energy arbitrage by selling the electricity production of the CHP on the wholesale market [1, 2, 6]. Well referenced embodiments of local heat storage are Thermostatically Controlled Loads (TCLs) [7] such as a hot water storage tank [8] where the heat is stored directly in the water, but also the building envelope [1, 7, 9, 10]\n1Bert J. Claessens is currently working at REstore and can be contacted at bert.claessens@restore.eu\ncan be used to store heat. From an operational point of view, controlling a cluster of TCLs connected to a DHN can be considered as a sequential decision-making problem under uncertainty. One well studied control paradigm for operational management of a DHN is that of Model Predictive Control (MPC) [11, 12]. When projected on the setting of TCLs connected to a DHN, this requires defining control actions for the central sources as well as for all individual TCLs. Developing a practical implementation requires one to tackle the problem of scalability, as the state dimensionality and number of control variables quickly result in an intractable optimization problem. This is complicated further by non-linear system dynamics. A second important challenge is that of system identification [13] as identifying an accurate model of both the DHN and all TCLs requires significant amounts of not readily available data and expert knowledge.\nThis work contributes in mitigating operational control challenges for TCLs connected to a DHN by working on these two problems.\nScalability: To obtain scalability, a heuristic dispatch approach as described in [14], is applied to the setting of TLCs connected to a DHN. Instead of calculating an individual control action for each TCL, this approach calculates a collective control action for the entire cluster of TCLs. A market-based dispatch algorithm is used to translate the collective control action into individual control actions.\nSystem identification: Driven by recent developments in Batch Reinforcement Learning (BRL) [15, 16], a blind modelfree approach is considered. As a BRL technique needs no prior information on the system dynamics, this strongly relaxes the system identification requirements, at the cost of a learning time\nPreprint submitted to Energy and Buildings February 27, 2017\nar X\niv :1\n70 1.\n08 07\n4v 2\n[ cs\n.S Y\n] 2\n4 Fe\nb 20\n17\nand sub-optimal performance. In Section 2, an overview is given on related research regarding the control of large clusters of TLCs and model based controllers for DHN. In Section 3, the decision-making problem is formalized as a Markov Decision Problem (MDP). In Section 4, the control approach as used in this work, is described in detail. In Section 5, an evaluation of the controller performance is provided based upon a simulation scenario comprising 100 TCLs connected to a DHN. The simulation scenario is sufficiently complex to evaluate the contributions of the control approach, but also comprehensibly enough to allow for an analysis which is not obfuscated by complexity of the scenario. Finally in Section 6, the conclusions are provided, as is a discussion on the results."}, {"heading": "2. Related Work", "text": "In this section a non-exhaustive overview is given of related work regarding both the control of large clusters of TCLs and model-based control applied to a DHN."}, {"heading": "2.1. Controlling a cluster of TCLs", "text": "The curse of dimensionality [17] lurks around the corner when managing the flexibility present in a large cluster of TCLs. This is attributed to the dimensionality of the state space and the large amount of control variables. To this end, significant recent work [18, 19, 20, 21, 22] has focused on providing computationally tractable solutions for large clusters of TCLs. In [23], a cluster of flexibility carriers represented by generic tank models is considered with the objective of providing day-ahead modulation services to a transmission system operator. Even though all models are linear, a formal branch and bound based optimization approach quickly becomes intractable. The main contribution of the work is a heuristic method including a state dependent dispatch algorithm in combination with an iterated local search technique. High quality solutions to a test problem are presented, obtained within a practical calculation time. The results of a related approach applied in an actual field test comprising 54 heat pumps has been presented in [21]. Here an aggregated model of reduced dimensionality was used to determine power set points for the entire cluster in a MPC approach. A heuristic dispatch algorithm was used to convert the aggregated set points to local control actions in the portfolio. In [22] a data-driven decision framework has been developed using a meta-heuristic optimization technique. An approach from the same solution class is presented in [13]. Here a problem of energy arbitrage with a large cluster of TCLs is presented. An aggregated system model is used in the form of a state bin transition model [24]. All TCLs are clustered, based upon their position within their dead-band, resulting in a state vector containing the fraction of TCLs in each state bin. A linear state bin transition model describes the dynamics of this state vector, the dimensionality of which is independent of the number of TCLs in the cluster. This model is used in an MPC resulting in a control action for each state bin. A simple heuristic is used to dispatch the control signals to individual control\nactions at device level. Although a simplified first order TCL model has been used, the results presented in [13] show that careful system identification is required. Moreover, in [25] it was argued that a first order TCL model is found lacking, further complicating system identification. A different approach is that of distributed optimization [26, 27], where the centralized optimization problem is decomposed over distributed agents who interact through virtual prices. For example in [28], distributed MPC through dual decomposition was presented as a means for energy arbitrage of a large cluster of TCLs subjected to a coupling constraint related to an infrastructure limitation. Although mathematical performance guarantees can be provided under sufficient assumptions, the method heavily relies on the accuracy of local models and has stringent communication and computation requirements due to its iterative character. An example of how an MPC controller can be used at building level is detailed in [12]."}, {"heading": "2.2. Model-Based DHN Control", "text": "When implementing a model-based control approach for a DHN, be it centralized or distributed, one is confronted with (1) the non-linearities in the dynamics of a DHN, and (2) the slow time scales compared to e.g. an electric network [29]. Taking these effects into account is essential for a good performance of the controller. Several model-based optimization approaches have been identified in literature, explicitly incorporating the dynamics of the DHN. For example in [11] a simplified model has been derived that is used together with sequential quadratic programming. In [30] approximate dynamic programming [31] has been used taking advantage of permutational symmetries of the DHN dynamics. A model-based approach using fuzzy direct matrix control to mitigate non-linearities of the DHN dynamics can be found in [32]. Although model-based solutions can have excellent performance, accurate models of the DHN and the consumers coupled to the DHN are required, tuning and shaping these models is considered an expert task making a generic roll-out of this technology challenging [33].\nA scalable model-free solution solution is presented in [34], here a market-based multi-agent system is used to match thermal and electric demand and supply. Although this approach is scalable, it does not take into account the DHN dynamics and follows a myopic control strategy. An approach combining an auction-based multi-agent system with a central optimization, taking into account a forecast of the total heat demand can be found in [1]."}, {"heading": "3. Problem description", "text": "Inspired by Gemine et al. [35], this section presents a problem formulation of the sequential decision-making problem related to optimal control of a cluster of TCLs connected to a DHN. In a second step, the control problem is cast onto a Markov Decision Process (MDP)."}, {"heading": "3.1. Test scenario network", "text": "To make the problem formalism more tangible, references are made to the test scenario as illustrated in Figure 1 and detailed in Section 5. The test scenario comprises 100 TCLs connected to a DHN. One central CHP is assumed to provide the heat to the buildings through a DHN."}, {"heading": "3.2. Problem components", "text": ""}, {"heading": "3.2.1. DHN", "text": "A DHN contains a set of nodes and pipes connecting these nodes. Each pipe l \u2208 L connects two nodes n,m \u2208 N and is characterized by its length Ll, diameter Dl and heat loss coefficient \u03b1l. The flow speed of the medium at time t \u2208 T in pipe l is denoted by Vl,t and its average temperature by Tl,t. The temperature in each node n at time t is characterized by Tn,t."}, {"heading": "3.2.2. TCLs and heat production", "text": "The set D contains the TCLs connected to the DHN, each TCL is assumed connected to a node. For modeling purposes a set of relevant temperatures is associated to each TCL d \u2208 D at time t, i.e. the air temperature T ad,t as measured by a local thermostat, T bd,t a temperature corresponding to a building envelope [9] and T hd,t the heating system return temperature. The control available at the level of a TCL is to decide whether or not to extract heat from the DHN, corresponding to a binary value bd,t \u2208 {0, 1}. The thermal inertia of the DHN and TCLs is used for storage, no separate hot water storage is considered.\nBesides TCLs also production units p \u2208 P are connected to the DHN in specific nodes. As illustrated in Figure 1, here a single CHP is used as heat source. At every time step t, an input power PIp,t, a thermal output power P T p,t and an electric output\npower are Pep,t are associated to p in a node n. The relationship between these powers is defined as:\nPTp,t + \u03d5P e p,t = \u03b7P I p,t, \u2200(p, t) \u2208 P \u00d7 T , (1)\nwith \u03b7 the total fuel utilization ratio of the CHP and \u03d5 defines the heat to power ratio of the CHP. In this work PTp,t \u2208 [ 0, PTp,max ] is considered the control variable."}, {"heading": "3.2.3. Operational limits", "text": "The main interest of the DHN system is to supply a heat service towards the TCLs meeting comfort constraints:\n\u2200(d, t) \u2208 D \u00d7 T : T ad \u2264 T a d,t \u2264 T a d. (2)\nHere \u00b7 and \u00b7 indicate the lower and upper bound respectively. Common for buildings is to have a constraint on the operative temperature. As a simplification the comfort constraints are here directly related to the air temperature T at . Besides constraints for the TCLs also constraints for the DHN are relevant, i.e.\n\u2200(n, t) \u2208 N \u00d7 T :T n \u2264 Tn,t \u2264 T n (3) \u2200(l, t) \u2208 L \u00d7 T :T l \u2264 Tl,t \u2264 T l, (4)\nV l \u2264 Vl,t \u2264 V l."}, {"heading": "3.3. Sequential decision making", "text": "Driven by the possibility of using techniques from Reinforcement Learning (RL) [15], the sequential decision-making process is formulated as a Markov Decision Process (MDP) [17, 36]. The sequential nature results from inter-temporal constraints related to the dynamics of the DHN and the TCLs. Decisions made at time step t impact possible actions allowed at future states. An MDP is defined by its state space X, its action space U, and a transition function f :\nxt+1 = f (xt,ut,wt), (5)\ndescribing the dynamics from state xt \u2208 X to xt+1, following the control actions ut \u2208 U subject to a random process, wt \u2208 W, where wt is drawn from a probability distribution pw(\u00b7, xt). Each transition is accompanied by a cost signal ct:\nct(xt,ut, xt+1) = \u03c1(xt,ut,wt), (6)\nwith \u03c1 the cost function."}, {"heading": "3.3.1. State description", "text": "Following the notation provided in [37], the state of the system is assumed to be spanned by time dependent state information Xt, controllable state information Xphys and uncontrollable exogenous state information Xex [17]. The time dependent state information Xt describes the time information relevant for the dynamics, e.g. the quarter of an hour in the day or the day in the week. In this work Xt = {1, ..., 96}. The controllable state information Xphys represents the state of the DHN and the TCLs:\nxphys,t = (T a1,t,T b 1,t,T h 1,t, ...,T a |D|,t,T b |D|,t,T h |D|,t, (7)\nT1,t, ...,T|N|,t,T1,t,V1,t, ...,T|L|,t,V|L|,t). (8)\nThe uncontrollable exogeneous state information comprises the physical parameters relevant for the dynamics of the system that can not be influenced by ut. Examples being the outside temperature Tout, solar irradiation S , wind speed and direction \u2212\u2192v 2 and local electric consumption ed.\nxex,t = ( Tout,t, S t,\u2212\u2192v t, e1,t, ..., e|D|,t ) . (9)\nIt is xex,t that represents wt. If there is no correlation between wt and wt+1 (pw(.)), xex,t can be omitted from the state information [17] in the MDP, however by having xex,t in the state vector a first order correlation is assumed3 (pw(.|xex))."}, {"heading": "3.3.2. Control actions", "text": "The control vector includes the control actions of the TCLs and the thermal output power of the central CHP:\nut = (PTp,t, b1,t, ..., b|D|,t). (10)"}, {"heading": "3.3.3. DHN Dynamics", "text": "To model the dynamics of the DHN (as used in the evaluation), a quasi-dynamic approach is followed [29] as pressure and flow change orders of magnitude faster than the temperature of the water. In a first step, a hydraulic simulation is performed, in a second step the thermal dynamics are calculated. For the hydraulic calculations the approach as proposed in [38] is followed. This results in applying Kirchhoff\u2019s laws, with the consideration that there exists a non-linear relationship between pressure and flow rate.\nTo calculate the thermal dynamics, the node model as presented by Benonysson [39] has been used, essentially solving the following equation for every pipe section:\ncpw \u2202mTw \u2202t + cpw \u2202m\u0307Tw \u2202x + hA(Tw \u2212 Tg) = Q. (11)\nWith m the mass of the water, cpw the thermal capacity of water, Tw the water temperature, Q the heat demand and h the heat transfer coefficient between the water and the ground. The surface of the pipe considered is A and Tg the local ground temperature."}, {"heading": "3.3.4. TCL Dynamics", "text": "For the building models, a lumped capacitance model is used i.e. an electric analogue following Verbeek [9]. The model includes the temperature dynamics of the inside air, a building envelope and the heating system return temperature [29]. Besides heat losses to the ambient air, also wind speed dependent air infiltration losses are included, as are uncontrolled heating due to solar irradiation and local electric consumption [29].\n2The outside temperature, solar irradiation and wind information are assumed constant over the DHN and the buildings.\n3This can readily be extended to include information several time steps back."}, {"heading": "3.3.5. Cost signal", "text": "Finally also a cost function c needs to be defined: c : X \u00d7 U \u00d7 X \u2192 R, in this work, two objectives are regarded, i.e. energy arbitrage c\u03bb, responding to an external price \u03bb and peak shaving/valley filling cps. The cost functions are defined as:\nc\u03bb(xt,ut, xt+1) = PTp,t\u03bbt\u2206t. (12)\nwith \u03bbt the effective price for producing thermal energy at time step t. For the peak shaving objective, the cost is expressed on a daily basis:\ncps(x1,u1, ...,uT) = E {\u2225\u2225\u2225PTp,1, ..., PTp,T \u2225\u2225\u2225\u221e} . (13)\nThe objective of this work is to find a control policy \u03c0 : X \u2192 U that will minimize the T -stage return J\u03c0(x1) starting from state x1 defined as:\nJ\u03c0(x1) = E (R\u03c0(x1,w1, ...,wT)) . (14)\nwith\nR\u03c0(x1,w1, ...,wT) = T\u2211\nt=1\n\u03c1(xt, \u03c0(xt),wt) (15)\nfrom the understanding that an optimal policy \u03c0\u2217 satisfies the Bellman equation:\nJ\u03c0 \u2217 (x) = min\nu E w\u223cPw(.|w) {\u03c1(x, \u03c0(x),w) + J\u03c0\u2217 ( f (x, \u03c0(x),w))} (16)\nWhen an accurate model is available, typical techniques to find near-optimal policies in an MDP framework are value iteration, policy iteration, direct policy search [40] and tree search algorithms such as optimistic planning [41]. In [30] for example, an approximated value iteration approach is followed to determine a control policy for the control of a DHN. In this work, a model-free approach is explored. Driven by promising results [42, 16, 36], Batch Mode Reinforcement Learning (BRL) techniques are investigated, detailed in Section 4."}, {"heading": "4. DHN controller approach", "text": "This section describes a pragmatic control approach building upon recent results in BRL and market-based multi-agent systems. The control approach illustrated in Figure 2 and followed in this work is based upon a Three Step Approach (TSA) as presented in [14, 43] following a similar strategy as followed in [21, 24]. In a first step, (1) all relevant (and practically available) state information is collected, e.g. the temperature information from the TCLs. From this information a limited set of features [17] is extracted, resulting in a low-dimensional representation of the system state. In a second step (2) a control action for the entire cluster of TCLs is extracted from a policy \u03c0\u2217 determined offline on given time intervals. In a third and last step (3), this control action is dispatched over the different TCLs using a market-based multi-agent system. This process is repeated following a receding horizon approach. In the following, a more detailed description of the three steps is presented."}, {"heading": "4.1. Step 1: Aggregation", "text": "In the first step, state information as described in Section 3.3.1 is retrieved from the system. From a practical perspective however, not all state information is readily available. At building level, only the air temperatures as measured by a local thermostat are assumed available, i.e. the air temperatures measured in the buildings, T ad,t,\u2200d \u2208 D. Furthermore measurements of the outside air temperature Tout,t are assumed available, as is the water temperature from a subset of nodes in the supply side of the DHN, i.e. Tn,t,\u2200n \u2208 Ns \u2282 N and the return side4 Tn,t,\u2200n \u2208 Nr \u2282 N . This information is further aggregated, formally this can be seen as a feature extraction [17], which reduces the dimensionality of the decision-making process. In this work, the feature extraction is handcrafted, resulting in the following effective state vector xt.\nxt = ( \u2329 T at \u232a ,Tout,t,Ts,Tr) (17)\u2329\nT at \u232a = \u2211 d\u2208D T ad,t |D| (18)\nTs = \u2211\nn\u2208Ns Tn,t |Ns|\n(19) Tr = \u2211\nn\u2208Nr Tn,t |Nr |\n(20)\nAlthough, more generic dimension reduction techniques such as autoencoders can be used [44], the aim of this work is to understand what performance can be obtained starting from this limited state description. Alternatively, a convolutional neural network as presented by the the authors in [45] could be used to automatically extract relevant state-time features, allowing to add historic observations to the state [16, 17].\nTo facilitate the dispatch step as explained in Section 4.3, a bid-function is defined for every TCL [5, 14, 46]. In [5], the bid function of a device is expressed as the electric power consumed versus a heuristic (pr). Above a corner value pc,d the bid\n4Only temperatures at a limited set of nodes are assumed available.\nfunction is zero:\npc,d = 1 \u2212 S oC = T\na d \u2212 T ad,t T a d \u2212 T ad . (21)\nDetermining this heuristic is considered relatively straightforward as it requires only the air temperature as measured by the thermostat and the upper and lower temperature bound. Defining the thermal power extracted from the DHN by a TCL when switched on, is less so [29]. To relax this requirement we assume an estimate of the flowrate (Ld) when switched on is available. The flowrate Ld is defined as follows. First the set temperature of the indoor heat supply system, which is a function of the outdoor temperature, is calculated. Then, a model for the substation heat exchanger is used to determine the flow rate extracted from the DHN, by which the outlet temperature of the heat exchanger meets the set temperature. Using this value instead of the actual power results in the following bid function for building d:\nbd(pr) = Ld(1 \u2212 H(pr + S oC \u2212 1)), (22)\nhere H corresponds to the heaviside function.\nAlgorithm 1 Overview fitted Q-iteration Input: FD = { (xls , uls , cls , x \u2032 ls ), ls = 1, ..., ns } , regression algo-\nrithm [47]. 1: let Q\u03020 be zero everywhere on X \u00d7 U 2: repeat 3: for ls = 1, ..., ns do 4: Q\u2032l+1,ls \u2190 rls + minu\u2032 Q\u0302l(x \u2032 ls , u\u2032) 5: end for 6: use regression to obtain Q\u0302l+1 from{(\n(xls , uls ),Q \u2032 l+1,ls\n) , ls = 1, ..., ns } 7: until Q\u0302l+1 is satisfactory 8: return Q\u0302 = Q\u0302l+1"}, {"heading": "4.2. Step 2: Batch Reinforcement Learning", "text": "In the second step, a control action ut is selected once every 15 minutes, following the policy \u03c0. The control action ut is selected for the entire cluster which is projected onto individual control actions as described in Section 4.3. One of the main goals of this work is to explore to what extent (model-free) reinforcement learning can be used to determine \u03c0. Reinforcement Learning (RL) is a model-free control approach that learns a policy by interaction with the system [40]. In recent literature, RL (mainly in the form of Q-learning [48, 49, 50]) has been presented as an effective model-free learning approach for DR applications. The practicality however, suffers from slow convergence [15, 40] and the curse of dimensionality [17]. These challenges can be partially mitigated by using past interactions and appropriate function approximators in a BRL strategy [40, 51]. A popular BRL approach is that of Fitted Q-Iteration (FQI) introduced by Ernst et al. in [52], especially in combination with extremely randomized trees as regression technique [47]. In\n[42] the authors conclude that especially for non-linear control problems, FQI can be a valuable alternative to MPC approaches with the extra advantage that FQI is a blind technique. Moreover, FQI and MPC can strengthen each other [42, 53]. Although several BRL techniques have been proposed in the literature [36, 52, 44], this work focuses on FQI using extremely randomized trees as regression algorithm [47]. Comparison to the performance of other BRL approaches is considered outside the scope of this work.\nFollowing [52], an approximation of the state-action value function Q(xt, ut), Q\u0302(xt, ut) is built on a daily basis5 from a batch of four-tuples FD:\nFD = { (xls , uls , cls , x \u2032 ls ), ls = 1, ..., ns } . (23)\nWith the state vector as defined in equation (17). Algorithm 1 is used to obtain Q\u0302(xt, ut). During the day, the control action ut is selected with a probability defined by [54]:\nP(ut |xt) = eQ\u0302(xt ,ut)/\u03c4D\u2211 u\u0303 eQ\u0302(xt ,u\u0303)/\u03c4D . (24)\nThe temperature \u03c4D is decreased on a daily basis according to a harmonic sequence [31], a high temperature results in more exploration whilst \u03c4D \u2192 0 results in a greedy approach:\nut = arg min u Q\u0302(xt, u). (25)\nIn the peak shaving scenario, a control action is determined on a daily basis, defining the average power to be followed for the next day as detailed in [5]."}, {"heading": "4.3. Step 3: Real-time control", "text": "In the third step, the energy corresponding to u\u2217t is dispatched over the cluster of TCLs, using a market-based multiagent system [14, 55]. Compared to the work of [5], there is a significant difference as only the expected flow rate for each TCL is assumed available. To this end, a Proportional Integrator (PI) controller (at a central level) managing the flow rates at the different buildings is used. Since hydraulic effects occur nearly instantaneous in a DHN, this will have a direct effect on the flow rate at the source, influencing the power at the source side as the supply setpoint is assumed to be constant in the simulations [29]. An overview of the real-time control can be seen in Figure 3. As described in Section 4.1, every TCL is represented by a bid function bd. After a clearing process (26), a clearing priority pr\u2217 is sent back to the different devices:\np\u2217r = arg min pr \u2223\u2223\u2223\u2223\u2223\u2223\u2223 |D|\u2211 d=1 bd(pr) \u2212 u \u2223\u2223\u2223\u2223\u2223\u2223\u2223 , (26)\nThe devices open or close their local valve according to bd(p\u2217r ).\n5This is done for practicality, as the simulations cover a time span of several months, in a real-life application, Q\u0302 should be constructed more frequently, following Algorithm 1."}, {"heading": "5. Evaluation", "text": "To evaluate the performance of the controller described in Section 4, a set of simulations have been performed. In this section, first a condensed description of the simulation scenario will be presented after which the tracking performance of the controller is evaluated. The performance of the controller is evaluated for two distinct objectives, i.e. that of energy arbitrage on a day-ahead energy market and peak shaving/valley filling."}, {"heading": "5.1. Simulation scenario", "text": "As mentioned in Section 1, the scenario is designed to be sufficiently demanding, but also simple enough to allow for an analysis which is not obfuscated by the complexity of the scenario. To this end, the (arbitrary) topology as depicted in Figure 1 has been used, i.e. a central CHP (\u03b7 = 0.97, \u03c6 = 0.93, PTp,max = 1100kW) provides heat to 100 TCLs connected to a radial DHN. Each building is located in one of four streets. The total length of the grid is 2.1 km, with pipe diameters ranging from DN25 to DN100. A detailed description of the simulation scenario can be found in [29]. The TCL building models are lumped capacitance models using an electric analogon comprising capacitances and resistors. The capacitance values are related to the temperature of the inside air, a building envelope and the heating system return temperature [9, 29]. All 100 buildings models included in the simulation are derived from the same model. Different model parameters are used for each building, by sampling capacitance and resistance values from a normal distribution with a standard deviation of 20% of the standard value. The standard values correspond to a detached house with a living area of 103 m2 and a protected volume of 452 m3. The maximum standard power demand of the building is 9.8 kW at an internal temperature of 20\u25e6C and an ambient temperature of -8\u25e6C. Besides heat losses to the ambient air,\nalso wind speed dependent air infiltration losses are included as is uncontrolled heating due to solar irradiation and local electric consumption [29]. For simplicity the temperature constraints are set the same for all buildings at 19.5 and 20.5\u25e6C."}, {"heading": "5.2. Tracking performance", "text": "A first supporting result is depicted in Figure 4, here a numerical experiment was performed where every 15 minutes a random control action was selected (within the technical specification of the CHP). The corresponding set points are depicted in the lower part of Figure 4, as is the average thermal power as produced by the CHP. The upper graph of Figure 4 depicts the internal temperatures of the 100 buildings and the average temperature. The graph shows that when the buildings are on average in their dead band, the requested power can be tracked accurately. Although the buildings have different physical parameters, they tend to synchronize with regard to their temperature relative to the comfort constraints. This is a direct effect of the dispatch dynamics, as those buildings with a higher priority are served first."}, {"heading": "5.3. Energy arbitrage", "text": "In the scenario of energy arbitrage, the CHP can sell its electric energy directly at the wholesale market [2]. The energy prices are taken from the Belgian day-ahead market [56], the gas price is set at 38.6e/MWh [57]. As day-ahead prices can be predicted with a reasonable accuracy [58], these are considered deterministic in this evaluation. Furthermore, the off line policy calculation (Algorithm 1) is performed only on a daily basis6, and the simulation period covers up to 80 days. The results of this numerical experiment are depicted in Figure 5. In the upper\n6 This is for practical reasons as the calculation of a policy typically takes 20 minutes on a Intel, 2.5 GHz, 8GB RAM\nrow, the daily cost is depicted, both for the approach presented in this paper and a default controller. The default controller applies a hysteresis controller at every building and a fixed DHN inlet temperature [29]. The cumulative cost is depicted in the second row. It can be observed that initially the daily cost obtained with the BRL controller is similar to the cost of the default controller. However, as the BRL controller starts gathering more interactions, its daily cost for energy starts decreasing. To evaluate the performance during colder days, the first 20 days with a lower average outside temperature where repeated, with a policy constructed with all data. These results are depicted in the right column. The performance is significantly improved, and the daily cost is decreased with about 20%. Although these results are positive, they do not provide an objective metric of the quality of the control approach, since this percentage is biased by the actual price profiles. To this end, a lower bound on the daily cost is provided by taking the total energy consumed during each day and distributing this over those hours with the highest price assuming the CHP running at full capacity. This is considered an over-optimistic benchmark. In the third row of Figure 5 the following metric is depicted:\nM = FQI \u2212 DC LB \u2212 DC , (27)\nwith DC the daily cost of the default controller, LB the lower bound on the daily cost and FQI the daily cost obtained with the solution presented in this work. A metric of 0 corresponding to the same performance as the default controller, whilst a metric of 1 corresponding to the lower bound solution. From Figure 5 it is observed that the performance metric gradually increases to a value of around 60-70%, also for the colder days as depicted in the right column.\nA snapshot of the daily power profiles of a mature controller\ncompared to the default controller is depicted in Figure 6. It can be seen that the controller produces heat when energy prices are high. It is meaningful to understand that a default controller already has a reasonable performance as the heat demand is typically largest when also the wholesale price is highest. This correlation is however expected to decrease as more renewable energy comes in the production mix, making wholesale prices more volatile."}, {"heading": "5.4. peak shaving", "text": "In the second experiment, peak shaving is considered. The summarizing results are depicted in Figure 7. In the top graph one can see the daily peak in thermal power obtained with the default controller and the BRL approach. The second graph gives the average daily ambient temperature. The daily maximum power peak indeed reduces with time. To make the performance more visible, also the load duration curves are plotted for the first and the last 50 days, both for the BRL approach and the default controller. The first 50 days there is limited improvement over the default controller, however for the subsequent period one can clearly observe the effect of the controller from the load duration curves. A lower bound is depicted by plotting the average power corresponding to the daily energy consumed by the default control approach. Note, on day seven (top graph in Figure 7), the profile obtained with BRL results a high peak power, which is attributed to an exploration step (24). The final performance is visualized more clearly in Figure 8 where the power profile is plotted for a mature controller. Indeed, the thermal power follows a constant profile compared to the default control case. A visualization of the policy obtained by the BRL controller is presented in Figure 9, here the average power set point is plotted versus the initial indoor temperature state and the expected average daily outdoor temperature. As is conceived logical, the setpoint decreases with increasing outside temperature and average air temperature."}, {"heading": "6. Conclusions and future work", "text": "In this work the control problem of a cluster of thermostatically controlled loads connected to a district heating network is addressed by assessing the performance of a control approach comprising a model-free reinforcement learning technique in combination with a market-based multi-agent system. The performance of the controller has been evaluated for two distinct scenarios, i.e. energy arbitrage and peak shaving. In the evaluation a detailed district heating network model has been used including hydraulic and thermal dynamics. For the energy arbitrage scenario, solutions are obtained that reach over 65% of the available optimization potential after a learning period of 40 to 60 days. Knowing that the policy is updated on a daily base, this is considered a promising result. Also for\nIn si\nd e\nT em\np er\nat u\nre [ \u00b0 C\n]\nOutside Temperature [\u00b0 C]\nset point [kW]\n0 5 10 15\n19.5\n19.55\n19.6\n19.65\n19.7\n19.75\n19.8\n19.85\n19.9\n19.95\n20\n600\n650\n700\n750\n800\n850\n900\nFigure 9: Policy map as obtained with the BRL approach for the peak shaving/valley filling scenario.\nthe peak shaving/valley filling scenario, promising results have been obtained, since a clear performance improvement is observed. These results support a practical implementation and coming of age of reinforcement learning techniques.\nTo understand the potential of completely model-free control a direct implementation of fitted Q-iteration as presented in [40] has been used. However as discussed in [42], combining general domain knowledge with a model-free approach is expected to result in an improved performance at a reduced learning time. This domain knowledge can be incorporated through e.g. information regarding the shape of the policy [40] or through using a model similar as in [53]. A second point of future research is directed at more automated feature extraction techniques such as autoencoders [16], which is also expected to result in a reduced learning time."}], "references": [{"title": "On Intelligent District Heating", "author": ["C. Johansson"], "venue": "PhD Thesis, Blekinge Institute of Technology, Blekinge, Sweden", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2014}, {"title": "Stochastic control and real options valuation of thermal storage-enabled demand response from flexible district energy systems", "author": ["Y. Kitapbayev", "J. Moriarty", "P. Mancarella"], "venue": "Applied Energy 137 ", "citeRegEx": "2", "shortCiteRegEx": null, "year": 2015}, {"title": "Simulation and optimization of a CHP biomass plant and district heating network", "author": ["K. Sartor", "S. Quoilin", "P. Dewallef"], "venue": "Applied Energy 130 (0) ", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2014}, {"title": "Performance investigation of two geothermal district heating systems for building applications: Energy analysis", "author": ["L. Ozgener", "A. Hepbasli", "I. Dincer"], "venue": "Energy and Buildings 38 (4) ", "citeRegEx": "4", "shortCiteRegEx": null, "year": 2006}, {"title": "Self-learning demand side management for a heterogeneous cluster of devices with binary control actions", "author": ["B.J. Claessens", "S. Vandael", "F. Ruelens", "M. Hommelberg"], "venue": "in: Proc. 3th IEEE Innov. Smart Grid Technol. Conf. (ISGT Europe), Berlin, Germany", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2012}, {"title": "A trading strategy for industrial chps on multiple power markets", "author": ["F. De Ridder", "B. Claessens"], "venue": "International Trans. on Electrical Energy Systems 24 (5) ", "citeRegEx": "6", "shortCiteRegEx": null, "year": 2014}, {"title": "Demand Response Methods for Ancillary Services and Renewable Energy Integration in Electric Power Systems", "author": ["S. Koch"], "venue": "PhD thesis, University of Stuttgart", "citeRegEx": "7", "shortCiteRegEx": null, "year": 2012}, {"title": "R", "author": ["K. Vanthournout"], "venue": "D\u2019hulst, D. Geysen, G. Jacobs, A smart domestic hot water buffer, IEEE Trans. on Smart Grid 3 (4) ", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2012}, {"title": "Optimisation of Extremely Low Energy Residential Buildings", "author": ["G. Verbeeck"], "venue": "PhD thesis, KULeuven", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2007}, {"title": "Potential of residential buildings as thermal energy storage in district heating systems results from a pilot test", "author": ["J. Kensby", "A. Trschel", "J.-O. Dalenbck"], "venue": "Applied Energy 137 ", "citeRegEx": "10", "shortCiteRegEx": null, "year": 2015}, {"title": "Predictive control of a complex district heating network", "author": ["G. Sandou", "S. Font", "S. Tebbani", "A. Hiret", "C. Mondon", "S. Tebbani", "A. Hiret", "C. Mondon"], "venue": "in: Proc. 44th IEEE Conference on Decision and Control, European Control Conference (CDC-ECC)", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2005}, {"title": "Experimental analysis of model predictive control for an energy efficient building heating system", "author": ["J. \u00c5irok", "F. Oldewurtel", "J. Cigler", "S. Prvara"], "venue": "Applied Energy 88 (9) ", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2011}, {"title": "Energy arbitrage with thermostatically controlled loads", "author": ["J.L. Mathieu", "M. Kamgarpour", "J. Lygeros", "D.S. Callaway"], "venue": "in: Proc. European Control Conference (ECC), IEEE", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2013}, {"title": "A scalable three-step approach for demand side management of plug-in hybrid vehicles", "author": ["S. Vandael", "B.J. Claessens", "M. Hommelberg", "T. Holvoet", "G. Deconinck"], "venue": "IEEE Trans. on Smart Grid 4 (2) ", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2013}, {"title": "Batch reinforcement learning", "author": ["S. Lange", "T. Gabel", "M. Riedmiller"], "venue": "in: M. Wiering, M. van Otterlo (Eds.), Reinforcement Learning: State-ofthe-Art, Springer, New York, NYC", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2012}, {"title": "G", "author": ["V. Mnih", "K. Kavukcuoglu", "D. Silver", "A.A. Rusu", "J. Veness", "M.G. Bellemare", "A. Graves", "M. Riedmiller", "A.K. Fidjeland"], "venue": "Ostrovski, et al., Human-level control through deep reinforcement learning, Nature 518 (7540) ", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2015}, {"title": "Neuro-Dynamic Programming", "author": ["D. Bertsekas", "J. Tsitsiklis"], "venue": "Athena Scientific, Nashua, NH", "citeRegEx": "17", "shortCiteRegEx": null, "year": 1996}, {"title": "Arbitraging intraday wholesale energy market prices with aggregations of thermostatic loads", "author": ["J.L. Mathieu", "M. Kamgarpour", "J. Lygeros", "G. Andersson", "D.S. Callaway"], "venue": "IEEE Trans. on Power Systems 30 (2) ", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2015}, {"title": "Cluster control of heterogeneous thermostatically controlled loads using tracer devices", "author": ["S. Iacovella", "F. Ruelens", "P. Vingerhoets", "B.J. Claessens", "G. Deconinck"], "venue": "IEEE Trans. on Smart Grid PP (99) ", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2015}, {"title": "Direct control service from residential heat pump aggregation with specified payback", "author": ["E. Georges", "B. Corn\u00e9lusse", "D. Ernst", "Q. Louveaux", "V. Lemort", "S. Mathieu"], "venue": "in: Proceedings of the 19th Power Systems Computation Conference (PSCC)", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2016}, {"title": "Aggregation and control of flexible consumers - a real life demonstration", "author": ["B. Biegel", "P. Andersen", "J. Stoustrup", "M.B. Madsen", "L.H. Hansen", "L.H. Rasmussen"], "venue": "in: Proc. of the 19th IFAC World Congress, IFAC, Cape Town, South Africa", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2014}, {"title": "A data-driven feed-forward decision framework for building clusters operation under uncertainty", "author": ["M. Hu"], "venue": "Applied Energy 141 (0) ", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2015}, {"title": "An efficient algorithm for the provision of a day-ahead modulation service by a load aggregator", "author": ["S. Mathieu", "D. Ernst", "Q. Louveaux"], "venue": "in: in Proc. 4th IEEE Innovative Smart Grid Technologies Europe (ISGT EUROPE)", "citeRegEx": "23", "shortCiteRegEx": null, "year": 2013}, {"title": "State estimation and control of electric loads to manage real-time energy imbalance", "author": ["J. Mathieu", "S. Koch", "D. Callaway"], "venue": "IEEE Trans. on Power Systems 28 (1) ", "citeRegEx": "24", "shortCiteRegEx": null, "year": 2013}, {"title": "Aggregate model for heterogeneous thermostatically controlled loads with demand response", "author": ["W. Zhang", "K. Kalsi", "J. Fuller", "M. Elizondo", "D. Chassin"], "venue": "in: Proc. IEEE Power and Energy Society General Meeting", "citeRegEx": "25", "shortCiteRegEx": null, "year": 2012}, {"title": "Residential load control: Distributed scheduling and convergence with lost AMI messages", "author": ["N. Gatsis", "G. Giannakis"], "venue": "IEEE Trans. on Smart Grid 3 (2) ", "citeRegEx": "26", "shortCiteRegEx": null, "year": 2012}, {"title": "Planning in Smart Grids", "author": ["M.G.C. Bosman"], "venue": "PhD Thesis, University of Twente", "citeRegEx": "27", "shortCiteRegEx": null, "year": 2012}, {"title": "The use of distributed thermal storage in district heating grids for demand side management", "author": ["D. Vanhoudt", "B. Claessens", "R. Salenbien", "J. Desmedt"], "venue": "https://arxiv.org/abs/1702.06005, under review at Elsevier: Energy and buildings ", "citeRegEx": "29", "shortCiteRegEx": null, "year": 2017}, {"title": "Short term optimization of district heating network supply temperatures", "author": ["E. Ikonen", "I. Selek", "J. Kovacs", "M. Neuvonen", "Z. Szabo", "J. Bene", "J. Peurasaari"], "venue": "in: Proc. IEEE International Energy Conference (EN- ERGYCON)", "citeRegEx": "30", "shortCiteRegEx": null, "year": 2014}, {"title": "Approximate Dynamic Programming: Solving the Curses of Dimensionality", "author": ["W.B. Powell"], "venue": "2nd Edition, Wiley", "citeRegEx": "31", "shortCiteRegEx": null, "year": 2011}, {"title": "Predictive control of district heating network using fuzzy DMC", "author": ["S. Grosswindhager", "A. Voigt", "M. Kozek"], "venue": "in: Proc. of International Conference on Modelling, Identification Control (ICMIC)", "citeRegEx": "32", "shortCiteRegEx": null, "year": 2012}, {"title": "Temperature prediction at critical points in district heating systems", "author": ["P. Pinson", "T. Nielsen", "H. Nielsen", "N. Poulsen", "H. Madsen"], "venue": "European Journal of Operational Research 194 (1) ", "citeRegEx": "33", "shortCiteRegEx": null, "year": 2009}, {"title": "Multi-agent control for integrated heat and electricity management in residential districts", "author": ["P. Booij", "V. Kamphuis", "O. Pruisen", "C. Warmer"], "venue": "in: 4th International Workshop on Agent Technologies for Energy Systems, ATES 2013", "citeRegEx": "34", "shortCiteRegEx": null, "year": 2013}, {"title": "Batch mode reinforcement learning based on the synthesis of artificial trajectories", "author": ["R. Fonteneau", "S. Murphy", "L. Wehenkel", "D. Ernst"], "venue": "Annals of Operations Research 208 (1) ", "citeRegEx": "36", "shortCiteRegEx": null, "year": 2013}, {"title": "Residential demand response of thermostatically controlled loads using batch reinforcement learning", "author": ["F. Ruelens", "B.J. Claessens", "S. Vandael", "B. De Schutter", "R. Babu\u0161ka", "R. Belmans"], "venue": "IEEE Trans. on Smart Grid PP (99) ", "citeRegEx": "37", "shortCiteRegEx": null, "year": 2016}, {"title": "Modelling of Geothermal District Heating Systems", "author": ["P. Valdimarsson"], "venue": "Phd thesis, University of Iceland ", "citeRegEx": "38", "shortCiteRegEx": null, "year": 1993}, {"title": "Dynamic modellign and operational Optimization of District Heating Systems", "author": ["A. Benonysson"], "venue": "PhD thesis, Technical University of Denmark (DTU)", "citeRegEx": "39", "shortCiteRegEx": null, "year": 1991}, {"title": "Reinforcement learning and Dynamic Programming Using Function Approximators", "author": ["L. Busoniu", "R. Babu\u0161ka", "B. De Schutter", "D. Ernst"], "venue": "1st Edition, CRC Press", "citeRegEx": "40", "shortCiteRegEx": null, "year": 2010}, {"title": "A Survey of Optimistic Planning in Markov Decision Processes", "author": ["L. Busoniu", "R. Munos", "R. Babu\u0161ka"], "venue": "John Wiley & Sons, Inc.", "citeRegEx": "41", "shortCiteRegEx": null, "year": 2013}, {"title": "Reinforcement learning versus model predictive control: a comparison on a power system problem", "author": ["D. Ernst", "M. Glavic", "F. Capitanescu", "L. Wehenkel"], "venue": "IEEE Trans. Syst., Man, Cybern., Syst. 39 (2) ", "citeRegEx": "42", "shortCiteRegEx": null, "year": 2009}, {"title": "Demand side management of the thermal flexibility in a residential neighborhood using a hierarchical market-based multi-agent system", "author": ["A. Aertgeerts"], "venue": "master thesis, KULeuven", "citeRegEx": "43", "shortCiteRegEx": null, "year": 2014}, {"title": "Deep auto-encoder neural networks in reinforcement learning", "author": ["S. Lange", "M. Riedmiller"], "venue": "in: Proc. IEEE 2010 Int. Joint Conf. on Neural Networks (IJCNN), Barcelona, Spain", "citeRegEx": "44", "shortCiteRegEx": null, "year": 2010}, {"title": "Convolutional neural networks for automatic state-time feature extraction in reinforcement learning applied to residential load control", "author": ["B.J. Claessens", "P. Vrancx", "F. Ruelens"], "venue": "IEEE Transactions on Smart Grid PP (99) ", "citeRegEx": "45", "shortCiteRegEx": null, "year": 2016}, {"title": "Balancing trade-offs in coordinated phev charging with continuous market-based control", "author": ["K. De Craemer", "G. Deconinck"], "venue": "in: Proc. 3rd IEEE PES International Conference and Exhibition on Innovative Smart Grid Technologies (ISGT Europe),", "citeRegEx": "46", "shortCiteRegEx": null, "year": 2012}, {"title": "Extremely randomized trees", "author": ["P. Geurts", "D. Ernst", "L. Wehenkel"], "venue": "Machine Learning 63 (1) ", "citeRegEx": "47", "shortCiteRegEx": null, "year": 2006}, {"title": "Optimal demand response using devicebased reinforcement learning", "author": ["Z. Wen", "D. ONeill", "H. Maei"], "venue": "IEEE Trans. on Smart Grid 6 (5) ", "citeRegEx": "48", "shortCiteRegEx": null, "year": 2015}, {"title": "Using smart devices for systemlevel management and control in the smart grid: A reinforcement learning framework", "author": ["E.C. Kara", "M. Berges", "B. Krogh", "S. Kar"], "venue": "in: Proc. 3rd IEEE Int. Conf. on Smart Grid Commun. (SmartGridComm), Tainan, Taiwan", "citeRegEx": "49", "shortCiteRegEx": null, "year": 2012}, {"title": "Unsupervised energy prediction in a smart grid context using reinforcement cross-  building transfer learning", "author": ["E. Mocanu", "P.H. Nguyen", "W.L. Kling", "M. Gibescu"], "venue": "Energy and Buildings 116 ", "citeRegEx": "50", "shortCiteRegEx": null, "year": 2016}, {"title": "Reinforcement learning algorithms with function approximation: Recent advances and applications", "author": ["X. Xu", "L. Zuo", "Z. Huang"], "venue": "Information Sciences 261 (0) ", "citeRegEx": "51", "shortCiteRegEx": null, "year": 2014}, {"title": "Tree-based batch mode reinforcement learning", "author": ["D. Ernst", "P. Geurts", "L. Wehenkel"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "52", "shortCiteRegEx": "52", "year": 2009}, {"title": "Approximate model-assisted neural fitted Qiteration", "author": ["T. Lampe", "M. Riedmiller"], "venue": "in: IEEE International Joint Conference on Neural Networks ", "citeRegEx": "53", "shortCiteRegEx": null, "year": 2014}, {"title": "Adaptive stochastic control for the smart grid", "author": ["R. Anderson", "A. Boulanger", "W. Powell", "W. Scott"], "venue": "Vol. 99", "citeRegEx": "54", "shortCiteRegEx": null, "year": 2011}, {"title": "B", "author": ["M. Hommelberg"], "venue": "van der Velde, C. Warmer, I. Kamphuis, J. Kok, A novel architecture for real-time operation of multi-agent based coordination of demand and supply, in: Power and Energy Society General Meeting - Conversion and Delivery of Electrical Energy in the 21st Century, 2008 IEEE", "citeRegEx": "55", "shortCiteRegEx": null, "year": 2008}, {"title": "Day-ahead electricity price forecasting using the wavelet transform and ARIMA models", "author": ["A. Conejo", "M. Plazas", "R. Espinola", "A. Molina"], "venue": "IEEE Trans. on Power Systems 20 (2) ", "citeRegEx": "58", "shortCiteRegEx": null, "year": 2005}], "referenceMentions": [{"referenceID": 0, "context": "Combined Heat and Power plants (CHPs) are a prominent example, as 8090% of the primary energy is converted to heat and electricity [1, 2, 3].", "startOffset": 131, "endOffset": 140}, {"referenceID": 1, "context": "Combined Heat and Power plants (CHPs) are a prominent example, as 8090% of the primary energy is converted to heat and electricity [1, 2, 3].", "startOffset": 131, "endOffset": 140}, {"referenceID": 2, "context": "Combined Heat and Power plants (CHPs) are a prominent example, as 8090% of the primary energy is converted to heat and electricity [1, 2, 3].", "startOffset": 131, "endOffset": 140}, {"referenceID": 3, "context": "But also heat from a geothermal source [4] or excess heat resulting from an industrial process can be used as primary heat source.", "startOffset": 39, "endOffset": 42}, {"referenceID": 4, "context": "This flexibility allows operational opportunities for cost reduction, examples being peak shaving/valley filling [5] and energy arbitrage by selling the electricity production of the CHP on the wholesale market [1, 2, 6].", "startOffset": 113, "endOffset": 116}, {"referenceID": 0, "context": "This flexibility allows operational opportunities for cost reduction, examples being peak shaving/valley filling [5] and energy arbitrage by selling the electricity production of the CHP on the wholesale market [1, 2, 6].", "startOffset": 211, "endOffset": 220}, {"referenceID": 1, "context": "This flexibility allows operational opportunities for cost reduction, examples being peak shaving/valley filling [5] and energy arbitrage by selling the electricity production of the CHP on the wholesale market [1, 2, 6].", "startOffset": 211, "endOffset": 220}, {"referenceID": 5, "context": "This flexibility allows operational opportunities for cost reduction, examples being peak shaving/valley filling [5] and energy arbitrage by selling the electricity production of the CHP on the wholesale market [1, 2, 6].", "startOffset": 211, "endOffset": 220}, {"referenceID": 6, "context": "Well referenced embodiments of local heat storage are Thermostatically Controlled Loads (TCLs) [7] such as a hot water storage tank [8] where the heat is stored", "startOffset": 95, "endOffset": 98}, {"referenceID": 7, "context": "Well referenced embodiments of local heat storage are Thermostatically Controlled Loads (TCLs) [7] such as a hot water storage tank [8] where the heat is stored", "startOffset": 132, "endOffset": 135}, {"referenceID": 0, "context": "directly in the water, but also the building envelope [1, 7, 9, 10]", "startOffset": 54, "endOffset": 67}, {"referenceID": 6, "context": "directly in the water, but also the building envelope [1, 7, 9, 10]", "startOffset": 54, "endOffset": 67}, {"referenceID": 8, "context": "directly in the water, but also the building envelope [1, 7, 9, 10]", "startOffset": 54, "endOffset": 67}, {"referenceID": 9, "context": "directly in the water, but also the building envelope [1, 7, 9, 10]", "startOffset": 54, "endOffset": 67}, {"referenceID": 10, "context": "One well studied control paradigm for operational management of a DHN is that of Model Predictive Control (MPC) [11, 12].", "startOffset": 112, "endOffset": 120}, {"referenceID": 11, "context": "One well studied control paradigm for operational management of a DHN is that of Model Predictive Control (MPC) [11, 12].", "startOffset": 112, "endOffset": 120}, {"referenceID": 12, "context": "A second important challenge is that of system identification [13] as identifying an accurate model of both the DHN and all TCLs requires significant amounts of not readily available data and expert knowledge.", "startOffset": 62, "endOffset": 66}, {"referenceID": 13, "context": "Scalability: To obtain scalability, a heuristic dispatch approach as described in [14], is applied to the setting of TLCs connected to a DHN.", "startOffset": 82, "endOffset": 86}, {"referenceID": 14, "context": "System identification: Driven by recent developments in Batch Reinforcement Learning (BRL) [15, 16], a blind modelfree approach is considered.", "startOffset": 91, "endOffset": 99}, {"referenceID": 15, "context": "System identification: Driven by recent developments in Batch Reinforcement Learning (BRL) [15, 16], a blind modelfree approach is considered.", "startOffset": 91, "endOffset": 99}, {"referenceID": 16, "context": "The curse of dimensionality [17] lurks around the corner when managing the flexibility present in a large cluster of TCLs.", "startOffset": 28, "endOffset": 32}, {"referenceID": 17, "context": "To this end, significant recent work [18, 19, 20, 21, 22] has focused on providing computationally tractable solutions for large clusters of TCLs.", "startOffset": 37, "endOffset": 57}, {"referenceID": 18, "context": "To this end, significant recent work [18, 19, 20, 21, 22] has focused on providing computationally tractable solutions for large clusters of TCLs.", "startOffset": 37, "endOffset": 57}, {"referenceID": 19, "context": "To this end, significant recent work [18, 19, 20, 21, 22] has focused on providing computationally tractable solutions for large clusters of TCLs.", "startOffset": 37, "endOffset": 57}, {"referenceID": 20, "context": "To this end, significant recent work [18, 19, 20, 21, 22] has focused on providing computationally tractable solutions for large clusters of TCLs.", "startOffset": 37, "endOffset": 57}, {"referenceID": 21, "context": "To this end, significant recent work [18, 19, 20, 21, 22] has focused on providing computationally tractable solutions for large clusters of TCLs.", "startOffset": 37, "endOffset": 57}, {"referenceID": 22, "context": "In [23], a cluster of flexibility carriers represented by generic tank models is considered with the objective of providing day-ahead modulation services to a transmission system operator.", "startOffset": 3, "endOffset": 7}, {"referenceID": 20, "context": "The results of a related approach applied in an actual field test comprising 54 heat pumps has been presented in [21].", "startOffset": 113, "endOffset": 117}, {"referenceID": 21, "context": "In [22] a data-driven decision framework has been developed using a meta-heuristic optimization technique.", "startOffset": 3, "endOffset": 7}, {"referenceID": 12, "context": "An approach from the same solution class is presented in [13].", "startOffset": 57, "endOffset": 61}, {"referenceID": 23, "context": "An aggregated system model is used in the form of a state bin transition model [24].", "startOffset": 79, "endOffset": 83}, {"referenceID": 12, "context": "Although a simplified first order TCL model has been used, the results presented in [13] show that careful system identification is required.", "startOffset": 84, "endOffset": 88}, {"referenceID": 24, "context": "Moreover, in [25] it was argued that a first order TCL model is found lacking, further complicating system identification.", "startOffset": 13, "endOffset": 17}, {"referenceID": 25, "context": "A different approach is that of distributed optimization [26, 27], where the centralized optimization problem is decomposed over distributed agents who interact through virtual prices.", "startOffset": 57, "endOffset": 65}, {"referenceID": 26, "context": "A different approach is that of distributed optimization [26, 27], where the centralized optimization problem is decomposed over distributed agents who interact through virtual prices.", "startOffset": 57, "endOffset": 65}, {"referenceID": 11, "context": "An example of how an MPC controller can be used at building level is detailed in [12].", "startOffset": 81, "endOffset": 85}, {"referenceID": 27, "context": "an electric network [29].", "startOffset": 20, "endOffset": 24}, {"referenceID": 10, "context": "For example in [11] a simplified model has been derived that is used together with sequential quadratic programming.", "startOffset": 15, "endOffset": 19}, {"referenceID": 28, "context": "In [30] approximate dynamic programming [31] has been used taking advantage of permutational symmetries of the DHN dynamics.", "startOffset": 3, "endOffset": 7}, {"referenceID": 29, "context": "In [30] approximate dynamic programming [31] has been used taking advantage of permutational symmetries of the DHN dynamics.", "startOffset": 40, "endOffset": 44}, {"referenceID": 30, "context": "A model-based approach using fuzzy direct matrix control to mitigate non-linearities of the DHN dynamics can be found in [32].", "startOffset": 121, "endOffset": 125}, {"referenceID": 31, "context": "Although model-based solutions can have excellent performance, accurate models of the DHN and the consumers coupled to the DHN are required, tuning and shaping these models is considered an expert task making a generic roll-out of this technology challenging [33].", "startOffset": 259, "endOffset": 263}, {"referenceID": 32, "context": "A scalable model-free solution solution is presented in [34], here a market-based multi-agent system is used to match thermal and electric demand and supply.", "startOffset": 56, "endOffset": 60}, {"referenceID": 0, "context": "An approach combining an auction-based multi-agent system with a central optimization, taking into account a forecast of the total heat demand can be found in [1].", "startOffset": 159, "endOffset": 162}, {"referenceID": 8, "context": "the air temperature T a d,t as measured by a local thermostat, T b d,t a temperature corresponding to a building envelope [9] and T h d,t the heating system return temperature.", "startOffset": 122, "endOffset": 125}, {"referenceID": 14, "context": "Driven by the possibility of using techniques from Reinforcement Learning (RL) [15], the sequential decision-making process is formulated as a Markov Decision Process (MDP) [17, 36].", "startOffset": 79, "endOffset": 83}, {"referenceID": 16, "context": "Driven by the possibility of using techniques from Reinforcement Learning (RL) [15], the sequential decision-making process is formulated as a Markov Decision Process (MDP) [17, 36].", "startOffset": 173, "endOffset": 181}, {"referenceID": 33, "context": "Driven by the possibility of using techniques from Reinforcement Learning (RL) [15], the sequential decision-making process is formulated as a Markov Decision Process (MDP) [17, 36].", "startOffset": 173, "endOffset": 181}, {"referenceID": 34, "context": "Following the notation provided in [37], the state of the system is assumed to be spanned by time dependent state information Xt, controllable state information Xphys and uncontrollable exogenous state information Xex [17].", "startOffset": 35, "endOffset": 39}, {"referenceID": 16, "context": "Following the notation provided in [37], the state of the system is assumed to be spanned by time dependent state information Xt, controllable state information Xphys and uncontrollable exogenous state information Xex [17].", "startOffset": 218, "endOffset": 222}, {"referenceID": 16, "context": ")), xex,t can be omitted from the state information [17] in the MDP, however by having xex,t in the state vector a first order correlation is assumed3 (pw(.", "startOffset": 52, "endOffset": 56}, {"referenceID": 27, "context": "To model the dynamics of the DHN (as used in the evaluation), a quasi-dynamic approach is followed [29] as pressure and flow change orders of magnitude faster than the temperature of the water.", "startOffset": 99, "endOffset": 103}, {"referenceID": 35, "context": "For the hydraulic calculations the approach as proposed in [38] is followed.", "startOffset": 59, "endOffset": 63}, {"referenceID": 36, "context": "To calculate the thermal dynamics, the node model as presented by Benonysson [39] has been used, essentially solving the following equation for every pipe section:", "startOffset": 77, "endOffset": 81}, {"referenceID": 8, "context": "an electric analogue following Verbeek [9].", "startOffset": 39, "endOffset": 42}, {"referenceID": 27, "context": "includes the temperature dynamics of the inside air, a building envelope and the heating system return temperature [29].", "startOffset": 115, "endOffset": 119}, {"referenceID": 27, "context": "Besides heat losses to the ambient air, also wind speed dependent air infiltration losses are included, as are uncontrolled heating due to solar irradiation and local electric consumption [29].", "startOffset": 188, "endOffset": 192}, {"referenceID": 37, "context": "When an accurate model is available, typical techniques to find near-optimal policies in an MDP framework are value iteration, policy iteration, direct policy search [40] and tree search algorithms such as optimistic planning [41].", "startOffset": 166, "endOffset": 170}, {"referenceID": 38, "context": "When an accurate model is available, typical techniques to find near-optimal policies in an MDP framework are value iteration, policy iteration, direct policy search [40] and tree search algorithms such as optimistic planning [41].", "startOffset": 226, "endOffset": 230}, {"referenceID": 28, "context": "In [30] for example, an approximated value iteration approach is followed to determine a control policy for the control of a DHN.", "startOffset": 3, "endOffset": 7}, {"referenceID": 39, "context": "Driven by promising results [42, 16, 36], Batch Mode Reinforcement Learning (BRL) techniques are investigated, detailed in Section 4.", "startOffset": 28, "endOffset": 40}, {"referenceID": 15, "context": "Driven by promising results [42, 16, 36], Batch Mode Reinforcement Learning (BRL) techniques are investigated, detailed in Section 4.", "startOffset": 28, "endOffset": 40}, {"referenceID": 33, "context": "Driven by promising results [42, 16, 36], Batch Mode Reinforcement Learning (BRL) techniques are investigated, detailed in Section 4.", "startOffset": 28, "endOffset": 40}, {"referenceID": 13, "context": "The control approach illustrated in Figure 2 and followed in this work is based upon a Three Step Approach (TSA) as presented in [14, 43] following a similar strategy as followed in [21, 24].", "startOffset": 129, "endOffset": 137}, {"referenceID": 40, "context": "The control approach illustrated in Figure 2 and followed in this work is based upon a Three Step Approach (TSA) as presented in [14, 43] following a similar strategy as followed in [21, 24].", "startOffset": 129, "endOffset": 137}, {"referenceID": 20, "context": "The control approach illustrated in Figure 2 and followed in this work is based upon a Three Step Approach (TSA) as presented in [14, 43] following a similar strategy as followed in [21, 24].", "startOffset": 182, "endOffset": 190}, {"referenceID": 23, "context": "The control approach illustrated in Figure 2 and followed in this work is based upon a Three Step Approach (TSA) as presented in [14, 43] following a similar strategy as followed in [21, 24].", "startOffset": 182, "endOffset": 190}, {"referenceID": 16, "context": "From this information a limited set of features [17] is extracted, resulting in a low-dimensional representation of the system state.", "startOffset": 48, "endOffset": 52}, {"referenceID": 16, "context": "This information is further aggregated, formally this can be seen as a feature extraction [17], which reduces the dimensionality of the decision-making process.", "startOffset": 90, "endOffset": 94}, {"referenceID": 41, "context": "Although, more generic dimension reduction techniques such as autoencoders can be used [44], the aim of this work is to understand what performance can be obtained starting from this limited state description.", "startOffset": 87, "endOffset": 91}, {"referenceID": 42, "context": "Alternatively, a convolutional neural network as presented by the the authors in [45] could be used to automatically extract relevant state-time features, allowing to add historic observations to the state [16, 17].", "startOffset": 81, "endOffset": 85}, {"referenceID": 15, "context": "Alternatively, a convolutional neural network as presented by the the authors in [45] could be used to automatically extract relevant state-time features, allowing to add historic observations to the state [16, 17].", "startOffset": 206, "endOffset": 214}, {"referenceID": 16, "context": "Alternatively, a convolutional neural network as presented by the the authors in [45] could be used to automatically extract relevant state-time features, allowing to add historic observations to the state [16, 17].", "startOffset": 206, "endOffset": 214}, {"referenceID": 4, "context": "3, a bid-function is defined for every TCL [5, 14, 46].", "startOffset": 43, "endOffset": 54}, {"referenceID": 13, "context": "3, a bid-function is defined for every TCL [5, 14, 46].", "startOffset": 43, "endOffset": 54}, {"referenceID": 43, "context": "3, a bid-function is defined for every TCL [5, 14, 46].", "startOffset": 43, "endOffset": 54}, {"referenceID": 4, "context": "In [5], the bid function of a device is expressed as the electric power consumed versus a heuristic (pr).", "startOffset": 3, "endOffset": 6}, {"referenceID": 27, "context": "Defining the thermal power extracted from the DHN by a TCL when switched on, is less so [29].", "startOffset": 88, "endOffset": 92}, {"referenceID": 44, "context": ", ns } , regression algorithm [47].", "startOffset": 30, "endOffset": 34}, {"referenceID": 37, "context": "Reinforcement Learning (RL) is a model-free control approach that learns a policy by interaction with the system [40].", "startOffset": 113, "endOffset": 117}, {"referenceID": 45, "context": "In recent literature, RL (mainly in the form of Q-learning [48, 49, 50]) has been presented as an effective model-free learning approach for DR applications.", "startOffset": 59, "endOffset": 71}, {"referenceID": 46, "context": "In recent literature, RL (mainly in the form of Q-learning [48, 49, 50]) has been presented as an effective model-free learning approach for DR applications.", "startOffset": 59, "endOffset": 71}, {"referenceID": 47, "context": "In recent literature, RL (mainly in the form of Q-learning [48, 49, 50]) has been presented as an effective model-free learning approach for DR applications.", "startOffset": 59, "endOffset": 71}, {"referenceID": 14, "context": "The practicality however, suffers from slow convergence [15, 40] and the curse of dimensionality [17].", "startOffset": 56, "endOffset": 64}, {"referenceID": 37, "context": "The practicality however, suffers from slow convergence [15, 40] and the curse of dimensionality [17].", "startOffset": 56, "endOffset": 64}, {"referenceID": 16, "context": "The practicality however, suffers from slow convergence [15, 40] and the curse of dimensionality [17].", "startOffset": 97, "endOffset": 101}, {"referenceID": 37, "context": "These challenges can be partially mitigated by using past interactions and appropriate function approximators in a BRL strategy [40, 51].", "startOffset": 128, "endOffset": 136}, {"referenceID": 48, "context": "These challenges can be partially mitigated by using past interactions and appropriate function approximators in a BRL strategy [40, 51].", "startOffset": 128, "endOffset": 136}, {"referenceID": 49, "context": "in [52], especially in combination with extremely randomized trees as regression technique [47].", "startOffset": 3, "endOffset": 7}, {"referenceID": 44, "context": "in [52], especially in combination with extremely randomized trees as regression technique [47].", "startOffset": 91, "endOffset": 95}, {"referenceID": 39, "context": "[42] the authors conclude that especially for non-linear control problems, FQI can be a valuable alternative to MPC approaches with the extra advantage that FQI is a blind technique.", "startOffset": 0, "endOffset": 4}, {"referenceID": 39, "context": "Moreover, FQI and MPC can strengthen each other [42, 53].", "startOffset": 48, "endOffset": 56}, {"referenceID": 50, "context": "Moreover, FQI and MPC can strengthen each other [42, 53].", "startOffset": 48, "endOffset": 56}, {"referenceID": 33, "context": "Although several BRL techniques have been proposed in the literature [36, 52, 44], this work focuses on FQI using extremely randomized trees as regression algorithm [47].", "startOffset": 69, "endOffset": 81}, {"referenceID": 49, "context": "Although several BRL techniques have been proposed in the literature [36, 52, 44], this work focuses on FQI using extremely randomized trees as regression algorithm [47].", "startOffset": 69, "endOffset": 81}, {"referenceID": 41, "context": "Although several BRL techniques have been proposed in the literature [36, 52, 44], this work focuses on FQI using extremely randomized trees as regression algorithm [47].", "startOffset": 69, "endOffset": 81}, {"referenceID": 44, "context": "Although several BRL techniques have been proposed in the literature [36, 52, 44], this work focuses on FQI using extremely randomized trees as regression algorithm [47].", "startOffset": 165, "endOffset": 169}, {"referenceID": 49, "context": "Following [52], an approximation of the state-action value function Q(xt, ut), Q\u0302(xt, ut) is built on a daily basis5 from a batch of four-tuples FD:", "startOffset": 10, "endOffset": 14}, {"referenceID": 51, "context": "During the day, the control action ut is selected with a probability defined by [54]:", "startOffset": 80, "endOffset": 84}, {"referenceID": 29, "context": "The temperature \u03c4D is decreased on a daily basis according to a harmonic sequence [31], a high temperature results in more exploration whilst \u03c4D \u2192 0 results in a greedy approach:", "startOffset": 82, "endOffset": 86}, {"referenceID": 4, "context": "In the peak shaving scenario, a control action is determined on a daily basis, defining the average power to be followed for the next day as detailed in [5].", "startOffset": 153, "endOffset": 156}, {"referenceID": 13, "context": "In the third step, the energy corresponding to ut is dispatched over the cluster of TCLs, using a market-based multiagent system [14, 55].", "startOffset": 129, "endOffset": 137}, {"referenceID": 52, "context": "In the third step, the energy corresponding to ut is dispatched over the cluster of TCLs, using a market-based multiagent system [14, 55].", "startOffset": 129, "endOffset": 137}, {"referenceID": 4, "context": "Compared to the work of [5], there is", "startOffset": 24, "endOffset": 27}, {"referenceID": 27, "context": "Since hydraulic effects occur nearly instantaneous in a DHN, this will have a direct effect on the flow rate at the source, influencing the power at the source side as the supply setpoint is assumed to be constant in the simulations [29].", "startOffset": 233, "endOffset": 237}, {"referenceID": 27, "context": "A detailed description of the simulation scenario can be found in [29].", "startOffset": 66, "endOffset": 70}, {"referenceID": 8, "context": "The capacitance values are related to the temperature of the inside air, a building envelope and the heating system return temperature [9, 29].", "startOffset": 135, "endOffset": 142}, {"referenceID": 27, "context": "The capacitance values are related to the temperature of the inside air, a building envelope and the heating system return temperature [9, 29].", "startOffset": 135, "endOffset": 142}, {"referenceID": 27, "context": "also wind speed dependent air infiltration losses are included as is uncontrolled heating due to solar irradiation and local electric consumption [29].", "startOffset": 146, "endOffset": 150}, {"referenceID": 1, "context": "In the scenario of energy arbitrage, the CHP can sell its electric energy directly at the wholesale market [2].", "startOffset": 107, "endOffset": 110}, {"referenceID": 53, "context": "As day-ahead prices can be predicted with a reasonable accuracy [58], these are considered deterministic in this evaluation.", "startOffset": 64, "endOffset": 68}, {"referenceID": 27, "context": "The default controller applies a hysteresis controller at every building and a fixed DHN inlet temperature [29].", "startOffset": 107, "endOffset": 111}, {"referenceID": 37, "context": "To understand the potential of completely model-free control a direct implementation of fitted Q-iteration as presented in [40] has been used.", "startOffset": 123, "endOffset": 127}, {"referenceID": 39, "context": "However as discussed in [42], combining general domain knowledge with a model-free approach is expected to result in an improved performance at a reduced learning time.", "startOffset": 24, "endOffset": 28}, {"referenceID": 37, "context": "information regarding the shape of the policy [40] or through using a model similar as in [53].", "startOffset": 46, "endOffset": 50}, {"referenceID": 50, "context": "information regarding the shape of the policy [40] or through using a model similar as in [53].", "startOffset": 90, "endOffset": 94}, {"referenceID": 15, "context": "A second point of future research is directed at more automated feature extraction techniques such as autoencoders [16], which is also expected to result in a reduced learning time.", "startOffset": 115, "endOffset": 119}], "year": 2017, "abstractText": "Optimal control of thermostatically controlled loads connected to a district heating network is considered a sequential decisionmaking problem under uncertainty. The practicality of a direct model-based approach is compromised by two challenges, namely scalability due to the large dimensionality of the problem and the system identification required to identify an accurate model. To help in mitigating these problems, this paper leverages on recent developments in reinforcement learning in combination with a market-based multi-agent system to obtain a scalable solution that obtains a significant performance improvement in a practical learning time. The control approach is applied on a scenario comprising 100 thermostatically controlled loads connected to a radial district heating network supplied by a central combined heat and power plant. Both for an energy arbitrage and a peak shaving objective, the control approach requires 60 days to obtain a performance within 65% of a theoretical lower bound on the cost.", "creator": "LaTeX with hyperref package"}}}