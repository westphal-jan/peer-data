{"id": "1401.3471", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "15-Jan-2014", "title": "Conservative Inference Rule for Uncertain Reasoning under Incompleteness", "abstract": "In this paper we formulate the problem of inference under incomplete information in very general terms. This includes modelling the process responsible for the incompleteness, which we call the incompleteness process. We allow the process behaviour to be partly unknown. Then we use Walleys theory of coherent lower previsions, a generalisation of the Bayesian theory to imprecision, to derive the rule to update beliefs under incompleteness that logically follows from our assumptions, and that we call conservative inference rule. This rule has some remarkable properties: it is an abstract rule to update beliefs that can be applied in any situation or domain; it gives us the opportunity to be neither too optimistic nor too pessimistic about the incompleteness process, which is a necessary condition to draw reliable while strong enough conclusions; and it is a coherent rule, in the sense that it cannot lead to inconsistencies. We give examples to show how the new rule can be applied in expert systems, in parametric statistical inference, and in pattern classification, and discuss more generally the view of incompleteness processes defended here as well as some of its consequences.", "histories": [["v1", "Wed, 15 Jan 2014 05:28:54 GMT  (509kb)", "http://arxiv.org/abs/1401.3471v1", null]], "reviews": [], "SUBJECTS": "cs.AI", "authors": ["marco zaffalon", "enrique miranda"], "accepted": false, "id": "1401.3471"}, "pdf": {"name": "1401.3471.pdf", "metadata": {"source": "CRF", "title": "Conservative Inference Rule for Uncertain Reasoning under Incompleteness", "authors": ["Marco Zaffalon", "Enrique Miranda"], "emails": ["zaffalon@idsia.ch", "mirandaenrique@uniovi.es"], "sections": [{"heading": "1. Introduction", "text": "We consider a very general inference problem: we want to draw conclusions Z from the observation of facts Y . Here Z and Y are variables that are related, in the sense that observing the value y of Y in Y may change our beliefs about which value z the target variable Z assumes in Z.1\nAlthough apparently simple, the above setting already captures the main features of many important problems, such as making inference in expert systems, learning the values of some statistical parameters from data, learning from data how to classify new objects into one out of a set of preestablished categories (i.e., doing so-called pattern classification), and others.\n1. Throughout the paper, we shall maintain the convention of using capital letters for variables, the corresponding calligraphic letters for their spaces of possibilities, and lower-case letters for the elements of such spaces.\nc\u00a92009 AI Access Foundation. All rights reserved.\nLet us make this more concrete with the help of the graphical language of Bayesian networks (Pearl, 1988):2 consider the well-known \u2018Asia\u2019 net displayed in Figure 1, which is intended to model an artificial medical problem. The nodes of a Bayesian network are variables and the arcs model probabilistic dependencies between them; each node holds the probability distribution of the node itself given any joint state of the parent nodes. The probabilities making up these distributions are also called the parameters of the network.\nNow, if we assume that the network (both the graph and the parameters) is provided by a domain expert, then we are in the field of expert systems. Say that the network is used for diagnosing lung cancer; in this case R is the target node while the others are used to predict the value of R. Therefore in this case Z corresponds to R and Y is the vector (V,K,B,H,O,L,A). In another situation, we may want to infer some of the parameters from data. For example, denote by \u0398 the chance that there is tuberculosis conditional on a recent visit to Asia, and say that there is a sample D of joint values of B and V from which we wish to infer the value of \u0398. In this problem of so-called parametric inference, Z corresponds to \u0398 and Y to the sample D. Finally, say that our goal is to use the Asia net to learn from data how to diagnose lung cancer, i.e., to predict the state of R for the next patient we see, whom we characterise by the vector (V,K,B,H,O,L,A). In this case\n2. The results in the present paper are not restricted to the case of Bayesian networks, but since they can be applied to Bayesian networks, we often use them to convey the intuition more easily.\nwe need to collect, in a data set D, the values of all the variables in the network for the past patients. This data set is exploited to infer the parameters of the Asia net, which is then used for classification by predicting the value of R as in the case of expert systems. Therefore, when the focus is on pattern classification, Z corresponds to the so-called class variable, namely R, while Y is the tuple (D,V,K,B,H,O,L,A).\nThe common feature of all the previous examples is that observing Y is useful for inferring Z, and indeed this is the reason why Y has been introduced in the model. But there is a subtle point about observing Y that is important to realise: very often, the observation of a fact does not coincide with the fact itself. For example, consider again the Asia network, focusing on the problem of parametric inference: in this case, it may well happen that we make mistakes while collecting the values of B and V in a sample; we might for instance mix up some \u2018yes\u2019 values with \u2018no\u2019 values. It is useful to regard this situation as related to two levels of information: the latent level of the actual sample that records the right values of the variables, and the manifest level of the observed sample, which is related to, but does not necessarily coincide with the actual sample, and which is going to be used for the inference. We can exploit the paradigm based on the latent and the manifest level more generally as a powerful conceptual tool. For instance, when we use the Asia network as an expert system, it may be the case that for a certain patient characterised by the vector of values (v\u2032, k\u2032\u2032, b\u2032\u2032, h\u2032\u2032, o\u2032, l\u2032, a\u2032), it is only possible to access the values of the variables H and A. Therefore our observation of the characteristics of the patient will be (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032), where we denote the symbol of missing value by a question mark. Again, we can think of the former vector as latent and the latter as manifest. More generally speaking, the idea underlying the present discussion is that the devices that we use to observe Y , whatever they are, may not let us see Y exactly as it is.\nIn order to account for this problem, we explicitly model the observation of Y by a new variable W , taking values in a finite set W of possible observations. We call W the observation of Y . In our previous terminology, W is a manifest variable while Y is a latent one. In other words, we regard W as the output of the process of observing facts, which is called the observational process in this paper (other authors call it the measurement process). We can think of many different types of observational processes. In this paper we restrict the attention to the special case of observational processes called incompleteness processes (IPs). IPs are processes that lead to set-valued observations by coarsening facts. A special case of IPs are missingness processes, i.e., those that turn some facts into their entire possibility space.\nFor example, the process that prevented some of the variables from being observed in the expert system case is a coarsening process: it has turned the fact (v\u2032, k\u2032\u2032, b\u2032\u2032, h\u2032\u2032, o\u2032, l\u2032, a\u2032) into the observation (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032), which can be regarded as the set of the 25 complete vectors obtained by replacing the question marks with values of the unobserved variables in all the possible ways. On the other hand, if we take the fact under consideration to be a single variable, say V , then the process that makes V not observed is just a missingness process as writing a question mark is equivalent to writing the entire possibility space for such a variable.3\n3. With IPs it makes sense to introduce the additional variable W even only because the incomplete observations are not in the possibility space for Y ; in the case of the Asia net, this happens because\nMissing or coarsened data are indeed a commonplace with expert systems, because the evidence on which an inference task is based is usually incomplete. But they arise frequently also in many other fields; in data mining, just to mention one, missing data are a pervasive problem in applications as well as an important theoretical area of research. In other words, the challenges posed by IPs are widespread. This also means that the problem of incomplete information appears to be a fundamental component of the general task of uncertain reasoning; it is conceptually deep and leads to complicated problems in practice.\nMoreover, while we have powerful theoretical tools for the general task of uncertain reasoning, such as Bayes rule and its generalisations, there are few tools for uncertain reasoning under incompleteness in the general case. Currently, the most popular approach is based on the assumption that the IP produces incompleteness by coarsening facts at random, which means non-selectively. The assumption that models non-selectiveness is called coarsening at random (or CAR, see Gill et al., 1997), or missing at random (or MAR, see Little & Rubin, 1987) in the special case of missingness processes (see also Jaeger, 2008). CAR implies that the incompleteness is non-informative and can be ignored; it thus creates the formal basis for applying the methods developed for complete information to the incomplete case. For example, if we assume that the vector (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032) has been created by a CAR IP, then we are allowed to infer the value of R on the sole basis of the subvector (h\u2032\u2032, a\u2032); more precisely, if we aim at computing the posterior probability of R = r\u2032, CAR allows us to write P (R = r\u2032|W = (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032)) = P (R = r\u2032|H = h\u2032\u2032, A = a\u2032). But this is not the case in general.\nIn fact, incompleteness may well be informative. For example, in the Asia network, it may be the case that the information on whether or not a person has been to Asia is not provided with the same frequency in the two groups. This is an example of incompleteness generated within a communication protocol, where giving or not some information is a key part of the communication. This somewhat selective way of reporting information, albeit very frequent, is not compatible with the CAR assumption. This was pointed out long ago by Shafer (1985), who also has outlined the implications as well as the complications for uncertain reasoning: among these, the fact that modelling IPs can be a very difficult task. More recently, it has been used to argue against the frequent use of CAR (Gru\u0308nwald & Halpern, 2003); by now there is a large agreement in the scientific community that CAR is strong, and hence inappropriate in many situations (see Manski, 2003).\nDe Cooman and Zaffalon (2004) tried to remedy this by an approach to IPs alternative to CAR that is based on coherent lower previsions (Walley, 1991), i.e., closed convex sets of probabilities also called credal sets by Levi (1980). This has led to a rule for updating beliefs under incomplete information in expert systems called the conservative updating rule (CUR).\nIf we regard CAR as the most optimistic approach to incomplete information, CUR should be regarded as the most pessimistic: it does not assume nearly anything about the IP, and in practice it leads to inference based on working with the set of all facts consistent with (i.e., all the completions of) the incomplete information at hand. In the previous example in which we wish to compute the posterior probability of R = r\u2032, CUR leads us to consider all the 25 completions of the vector (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032), i.e.,\nthe symbol \u2018?\u2019 is not a possible value for any variable; observations that contain question marks must necessarily be in the possibility space of W .\n(v, k, b, h\u2032\u2032, o, l, a\u2032), v \u2208 V, k \u2208 K, b \u2208 B, o \u2208 O, l \u2208 L, and to compute for each of them P (r\u2032|v, k, b, h\u2032\u2032, o, l, a\u2032). The posterior inference is then summarised by the lower and upper probabilities P (R = r\u2032|W = (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032)) := minv,k,b,o,l P (r\u2032|v, k, b, h\u2032\u2032, o, l, a\u2032) and P (R = r\u2032|W = (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032)) := maxv,k,b,o,l P (r\u2032|v, k, b, h\u2032\u2032, o, l, a\u2032). In other words, the inference is imprecise, i.e., the width of the interval determined by the lower and upper probabilities does not need to be zero, as a logical consequence of the ignorance CUR assumes about the IP. As an interesting side remark, CUR is as flexible as CAR in dealing with incomplete data: both of them eventually lead to conclusions that depend only on the Y variable. The W variable at a certain point of the derivation cancels out.\nCUR has some drawbacks. It forces us to always assume ignorance about the IP, even when we know that the process is CAR, for instance. This could be the case of the previous example in which we might know that the variables B,O,L are subject to a CAR IP; by using CUR we should be obliged to ignore this information and take all of their completions, as above; and this would lead to inference that is much too weak. Furthermore, CUR has been developed for expert systems only. It cannot be applied to parametric inference when the parameter space is infinite, and some other limitation in the assumptions leading to CUR may sometimes prevent it from being applied more generally.\nThis paper is an attempt to get the best out of CAR and CUR. We assume that the IP is actually made of two parts, one that acts as a CAR process and another that is unknown to us. Then we use the theory of coherent lower previsions to derive the corresponding rule, which we call the conservative inference rule (CIR).\nCIR has the following properties:\n\u2022 Much like traditional, CAR-based, updating, and unlike CUR, it is a rule for the abstract task of updating beliefs on the basis of observations. As such, it can be applied in every situation. With CIR, different applications follow by simply giving different meanings to facts Y , observations W , and to the quantity Z in which we are interested.\n\u2022 CIR allows all the variables involved in an analysis, except for W and Y , to take values from infinite spaces (CUR allows only finite spaces). This allows us to easily focus on statistical problems where the goal of inference is often the value of a continuous parameter, or in problems where we also use auxiliary continuous variables that are later \u2018marginalised\u2019 out to build our model.\n\u2022 It can deal with incomplete observations, not only missing ones as CUR.\n\u2022 Finally, and importantly, CIR is shown to lead to self-consistent (or coherent) inference in the strong sense of Walley (1991, Section 7.1.4(b)).\nCIR leads to treat the information made incomplete by the CAR IP similarly to the traditional updating, and that subject to the unknown one similarly to CUR. As an example, consider again the vector (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032) by assuming that the variables B,O,L are subject to a CAR IP and V,K to an IP whose behaviour is unknown to us. CIR leads to the following posterior lower and upper probabilities for R = r\u2032: P (R = r\u2032|W = (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032)) := minv,k P (r\u2032|v, k, h\u2032\u2032, a\u2032) and P (R = r\u2032|W = (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032)) := maxv,k P (r\u2032|v, k, h\u2032\u2032, a\u2032). If, in addition, we know that only two completions of V,K make sense, say (v\u2032, k\u2032\u2032) and\n(v\u2032\u2032, k\u2032) (this means that the unknown IP is a coarsening rather than a missingness process), the ability of CIR to deal with coarsening processes allows it to take advantage of such an information, leading to the more informative lower and upper probabilities obtained optimising only over those two completions. Furthermore, CIR leads to inference that is based, as its predecessors, only on facts, not on the W variable.\nThe organisation of the material in this paper follows an attept to make the paper accessible also to the readers that prefer not to go into the formal proofs behind CIR. In particular, the paper is logically divided in two parts. The first part, up to and including Section 5, is intended to describe what can be obtained by CIR and its scope of application. Therefore this part briefly gives some introductory material that is needed to define CIR, such as some notions of coherent lower previsions in Section 2 and of incompleteness processes in Section 3. The definition of CIR is given in Section 4. We discuss its significance and compare it with CUR in Section 4.1. Then we show how CIR can be applied to probabilistic expert systems (Section 5.1), parametric inference (Section 5.2), and pattern classification (Section 5.3), each time giving also an example. In this first part we also discuss a number of properties and consequences of the wider view of IPs that we are defending here (e.g., Sections 5.2.2\u20135.2.3). Some of these (Section 5.3.2) are particularly important for data mining; this depends on the fact that it is usually not possible to learn about the IP from data, and yet the inferences we do may critically depend on it.\nThe second part of this paper is more technical as it works out the foundations of CIR. To this aim, we first give advanced notions about coherent lower previsions in Section 6, such as updating, independence, and coherence in the sense of Walley (1991). Then we state a number of probabilistic assumptions in Section 7.1, including CAR, discuss them in Section 7.2 (CAR is also discussed further in Appendix A) and derive CIR in Section 7.3. The parts that are even more technical, and which are needed to show that applying CIR cannot lead to inconsistencies, are relegated to Appendix B."}, {"heading": "2. Coherent Lower Previsions", "text": "We give a short introduction to the concepts and results from the behavioural theory of imprecise probabilities that we shall need to introduce the conservative inference rule. We refer the reader to the work of Walley (1991) for an in-depth study of coherent lower previsions, and to the paper by Miranda (2008) for a survey of the theory.\nConsider a possibility space \u2126. It may represent for instance the set of possible outcomes \u03c9 of an experiment. In the theory of coherent lower previsions, the beliefs about the likelihood of these outcomes are represented by means of lower previsions of gambles on \u2126:\nDefinition 1 Given a possibility space \u2126, a gamble is a bounded real-valued function on \u2126. The set of all gambles on \u2126 is denoted by L(\u2126). A lower prevision P is a real functional defined on some set of gambles K \u2286 L(\u2126).\nA gamble f represents a random reward, which depends on the a priori unknown value \u03c9 of \u2126. A lower prevision P on a set of gambles K represents a subject\u2019s supremum acceptable buying prices for these gambles, in the sense that for all > 0 and all f in K, the subject is disposed to accept the uncertain reward f \u2212P (f) + , where P (f) and can also be seen\nas constant gambles that are identically equal to the real values P (f) and , respectively.4 Intuitively, lower previsions represent lower expectations of gambles: our subject should be disposed to buy a gamble for anything smaller than the expected reward; however, his lack of knowledge about the probability of the different rewards may enable him only to give a lower bound for this expectation, accepting then any buying price smaller than this bound. The bound is his lower prevision for the gamble.\nWe shall use IA to denote a special type of gamble: the indicator function of the set A, i.e., the function whose value is 1 for the elements of A and 0 elsewhere. We shall sometimes use the notation P (A) for the lower prevision P (IA) when no confusion is possible.\nConsider variables X1, . . . , Xn, taking values in the sets X1, . . . ,Xn, respectively. For any subset J \u2286 {1, . . . , n} we shall denote by XJ the (new) variable\nXJ := (Xj)j\u2208J ,\nwhich takes values in the product space\nXJ := \u00d7j\u2208JXj .\nWe shall also use the notation X n for X{1,...,n}. We identify the possibility space \u2126 with X n.\nDefinition 2 Let J be a subset of {1, . . . , n}, and let \u03c0J : X n \u2192 XJ be the so-called projection operator, i.e., the operator that drops the elements of a vector in X n that do not correspond to indexes in J . A gamble f on X n is called XJ -measurable when for all x, y \u2208 X n, \u03c0J(x) = \u03c0J(y) implies that f(x) = f(y). We shall denote by KJ the set of XJ -measurable gambles.\nThis notion means that the value f takes depends only on the components of x \u2208 X n that belong to the set J .5\nThere is a one-to-one correspondence between the XJ -measurable gambles on X n and the gambles on XJ : given an XJ -measurable gamble f on X n, we can define f \u2032 on XJ by f \u2032(x) := f(x\u2032), where x\u2032 is any element in \u03c0\u22121J (x); conversely, given a gamble g on XJ , the gamble g\u2032 on X n given by g\u2032(x) := g(\u03c0J(x)) is XJ -measurable.\nLet O be a subset of {1, . . . , n}, and let P (XO) be a lower prevision on the set KO of XO-measurable gambles. We say that P is coherent if and only if the following three conditions hold for all f, g \u2208 KO, and \u03bb > 0:\n(C1) P (f) \u2265 inf f .\n(C2) P (\u03bbf) = \u03bbP (f).\n4. We say then that the gamble f \u2212 P (f) + is desirable for our subject, and that f \u2212 P (f) is almostdesirable. It follows from this interpretation that the set of desirable (resp., almost-desirable) gambles should be closed under addition and multiplication by non-negative reals, and that a gamble f that dominates a desirable gamble g should also be desirable (resp., almost-desirable). 5. This notion is related to the common notion of measurability as it implies that the gamble f : Xn \u2192 R is indeed a measurable mapping if we consider the \u03c3-field {\u03c0\u22121J (A) : A \u2286 XJ} on the initial space and any \u03c3-field in the final space.\n(C3) P (f + g) \u2265 P (f) + P (g).\nCoherence means that a subject cannot raise the lower prevision P (f) of a gamble by considering the acceptable buying transactions that are implied by other gambles in the domain.\nRemark 1 (Coherent upper previsions) Although for most of the paper we shall work with coherent lower previsions, or supremum acceptable buying prices, we shall also use at times the so-called coherent upper previsions. The upper prevision of a gamble f , P (f), represents the infimum acceptable selling price for f for our subject, in the sense that for any > 0 the transaction P (f)\u2212 f + is desirable for him.\nTaking into account this interpretation, it follows that the upper and lower previsions must be conjugate functions, in the sense that P (f) = \u2212P (\u2212f) for all gambles f . This is why we shall work almost exclusively with lower previsions, and use upper previsions only to refer to their conjugate functions when this helps to simplify the notation. Finally, we say that an upper prevision is coherent if so is its conjugate lower prevision. \u2666\nIt is important at this point to introduce a particular case of coherent lower previsions that will be of special interest for us: linear previsions.\nDefinition 3 A lower prevision P (XO) on the set KO is linear if and only if it is coherent and P (f + g) = P (f) + P (g) for all f, g \u2208 KO.\nLinear previsions correspond to the case where a subject\u2019s supremum acceptable buying price (lower prevision) coincides with his infimum acceptable selling price (or upper prevision) for every gamble on the domain. When a coherent lower prevision P (XO) is linear, we denote it by P (XO). A linear prevision corresponds to the expectation operator (with respect to the Dunford integral, see the book by Bhaskara Rao & Bhaskara Rao, 1983) with respect to a finitely additive probability.\nOne interesting feature of linear previsions allows us to easily characterise coherence.\nDefinition 4 P (XO) is said to dominate P (XO) if P (f) \u2265 P (f) for every XO-measurable gamble f .\nA lower prevision P (XO) is coherent if and only if it is the lower envelope of a closed6 and convex7 set of dominating linear previsions, which we denote byM(P (XO)). It follows also that P (XO) is the lower envelope of the set of extreme points ofM(P (XO)). We denote the set of extreme points of M(P (XO)) by ext(M(P (XO)).\nExample 1 Assume that our subject has the information that the outcome of the variables in XO belongs to some finite subset A of XO, and nothing more. Then he should model these beliefs by the so-called vacuous lower prevision PA(XO) given by PA(f) := min\u03c9\u2208A f(\u03c9) for every f \u2208 KO. The set M(PA(XO)) of dominating linear previsions corresponds to the\n6. In the weak* topology, which is the smallest topology for which all the evaluation functionals given by f(P ) := P (f), where f \u2208 L(\u2126), are continuous. 7. That is, for all linear previsions P1, P2 in the set and all \u03b1 \u2208 (0, 1), the linear prevision \u03b1P1 + (1\u2212 \u03b1)P2 also belongs to this set.\nfinitely additive probabilities P (XO) satisfying the constraint P (A) = 1. Among these, the extreme points are the degenerate probability measures with respect to some \u03c9 \u2208 A, and it follows that any linear prevision in M(PA(XO)) is a convex combination of these. \u2666\nConsider now two disjoint subsets O, I of {1, . . . , n}, with O 6= \u2205. P (XO|XI) represents a subject\u2019s behavioural dispositions about the gambles that depend on the outcome of the variables {Xk, k \u2208 O}, after coming to know the outcome of the variables {Xk, k \u2208 I}. As such, it is defined on the set of gambles that depend on the values of the variables in O \u222a I only,8 i.e., on the set KO\u222aI of the XO\u222aI -measurable gambles on X n. Given such a gamble f and x \u2208 XI , P (f |XI = x) represents a subject\u2019s supremum acceptable buying price for the gamble f , if he came to know that the variable XI took the value x (and nothing else). We can thus consider the gamble P (f |XI) on XI , that on x \u2208 XI takes the value P (f |XI = x).\nDefinition 5 The functional P (\u00b7|XI) that maps a gamble f in its domain KO\u222aI to the gamble P (f |XI) is called a conditional lower prevision.\nThis definition is well posed as the sets {\u03c0\u22121I (x) : x \u2208 XI} form a partition of X n. When there is no possible confusion about the variables involved in the lower prevision, we shall use the notation P (f |x) for P (f |XI = x). In particular, P (y|x) will mean P (Iy|x) for all pairs of values x, y.\nIn Walley\u2019s theory a conditional lower prevision P (XO|XI) defined onKO\u222aI is required to be self-consistent, or separately coherent. Separate coherence means on the one hand that if a subject knows that the variable XI has taken the value x, he cannot raise the (conditional) lower prevision P (f |x) of a gamble by considering the acceptable buying transactions that are implied by other gambles in the domain, and on the other hand that he should bet at any odds on the event that XI = x after having observed it.\nIn this case, where the domain is a linear set of gambles, the definition is the following:\nDefinition 6 The conditional lower prevision P (XO|XI) is separately coherent if and only if for all x \u2208 XI , f, g \u2208 KO\u222aI , and \u03bb > 0:\n(SC1) P (f |x) \u2265 inf\u03c9\u2208\u03c0\u22121I (x) f(\u03c9).\n(SC2) P (\u03bbf |x) = \u03bbP (f |x).\n(SC3) P (f + g|x) \u2265 P (f |x) + P (g|x).\nUsing these conditions, we see more clearly that a separately coherent conditional lower prevision can also be regarded as a lower bound for a conditional expectation. It also follows that if I = \u2205, separate coherence coincides with the notion of coherence introduced above.\nGiven a separately coherent conditional lower prevision P (XO|XI) with domain KO\u222aI , we can see P (XO|x) as defined on the set of XO-measurable gambles, because for any f \u2208 KO\u222aI , P (f |x) = P (g|x), where g is the XO-measurable gamble given by g(w) = f(\u03c0Ic(w), x) for all w \u2208 X n.\n8. We refer to the work by Miranda and De Cooman (2005) and Walley (1991) for more general definitions of the following notions in this section in terms of partitions, and for domains that are not necessarily (these) linear sets of gambles.\nAs with the unconditional case, we can also consider conditional upper previsions, which represent our subject\u2019s infimum acceptable selling prices for the gambles f in KO\u222aI , after coming to know the value of the variables in XI (and nothing else). We have P (f |x) = \u2212P (\u2212f |x) for all gambles f . Similarly, a conditional lower prevision P (XO|XI) on the set KO\u222aI is linear if and only if it is separately coherent and P (f + g|x) = P (f |x) + P (g|x) for all x \u2208 XI and f, g \u2208 KO\u222aI . Conditional linear previsions correspond to the case where a subject\u2019s supremum acceptable buying price (lower prevision) coincides with his infimum acceptable selling price (or upper prevision) for every gamble in the domain. When a separately coherent conditional lower prevision P (XO|XI) is linear, we denote it by P (XO|XI).\nA conditional lower prevision P (XO|XI) dominates P (XO|XI) if P (f |x) \u2265 P (f |x) for every XO\u222aI -measurable gamble f and every x \u2208 XI . A conditional lower prevision P (XO|XI) is separately coherent if and only if it is the lower envelope of a closed and convex set of dominating conditional linear previsions, which we denote byM(P (XO|XI)). This is a bit of an abuse of notation, since actually for every x \u2208 XI the set M(P (XO|x)) is a set of linear previsions. It follows also that P (XO|XI) is the lower envelope of the set of extreme points of M(P (XO|XI)), where we say that P (XO|XI) is an extreme point of M(P (XO|XI)) when for every x \u2208 XI , P (XO|x) is an extreme point of the closed convex set M(P (XO|x)). We denote the set of extreme points ofM(P (XO|x)) by ext(M(P (XO|x))).\nExample 2 Consider the following experiment: a subject throws a coin; if it lands on heads, he selects a ball from an urn with red and white balls of unknown composition; if it lands on tails, he selects a ball from an urn with red and blue balls also of unknown composition. Let X1 be the result of the first experiment, with values in {heads, tails}, and X2 be the color of the ball drawn in the second experiment, with values in {red, white, blue}.\nWe may model this using the conditional prevision P (X2|X1) where P (X2|X1 = heads) is vacuous on {red, white}, and P (X2|X1 = tails) is vacuous on {red, blue}. The extreme points of M(P (X2|X1)) are the conditional previsions P (X2|X1), where P (X2|heads) is degenerate on either red or white, and P (X2|tails) is degenerate on either red or blue. \u2666"}, {"heading": "3. The Basic Setting", "text": "In this section we introduce the basic assumptions about the spaces considered in our model and about the incompleteness process."}, {"heading": "3.1 The Domain", "text": "As we mentioned in the Introduction, in this paper we consider the problem of drawing conclusions about the value that a target variable Z takes in Z from information about of the value that another variable Y takes in a set Y. In this paper we shall assume that the set Y is finite, but the set Z of possible values for the target variable Z can be infinite."}, {"heading": "3.2 The Incompleteness Process", "text": "It is not uncommon that the devices that we use to get information about Y , whatever they are, may not let us see Y exactly as it is. Because of this, we explicitly model the observation\nof Y by a new variable W , taking values in the finite setW of possible observations. We call W the observation of Y . W represents the outcome of the observational process. In this paper we focus on the observational processes called incompleteness processes, which can not only turn a fact into its entire possibility space, but also into other nonempty subsets of the possibility space.\nRemark 2 (Concerning the W variable) We remark that it is necessary to introduce the variable W even if it is quite a common habit in applications to deal only with the variables Z and Y . The possibility to drop W depends on the assumptions done. For instance, if we assume CAR/MAR then the W variable at a certain point of the derivation cancels out, leading to formulae that only involve Z and Y . But one should not confuse the operational procedures with the theoretical representation needed for the derivation of a rule. The theoretical derivation has to take into account that the latent level of information, represented by Y , does not need to coincide with the manifest level, namely W , and hence that we need to model the process that leads from Y to W . This is also necessary because there are assumptions other than those made in this paper that do not lead eventually to drop W . Moreover, the distinction between the latent and the manifest level is not a new proposal at all: on the contrary, it is present, somewhat implicitly, even in the original works about MAR (Little & Rubin, 1987) and fully explicitly in more recent works (Gru\u0308nwald & Halpern, 2003).\u2666\nWe focus now on representing the IP. We start by characterising the IP for Y by a so-called multi-valued map \u0393Y (this idea of modelling the IP through a multi-valued map goes back essentially to Strassen, 1964). \u0393Y is what connects facts with observations: for all y \u2208 Y, \u0393Y gives us the set \u0393(y) \u2286 W of observations into which the IP may turn fact y. We require such a set to be nonempty:\ny \u2208 Y \u21d2 \u0393(y) 6= \u2205. (IP1)\nTake for example the Asia network. If the fact under consideration is the instance y := (v\u2032, k\u2032\u2032, b\u2032\u2032, h\u2032\u2032, o\u2032, l\u2032, a\u2032) of the vector (V,K,B,H,O,L,A), taken to be equal to Y , then \u0393(y) represents the set of all the incomplete instances that may be generated by the IP starting from y. For instance, the IP may be such that \u0393(y) is equal to the set of 27 incomplete instances obtained from (v\u2032, k\u2032\u2032, b\u2032\u2032, h\u2032\u2032, o\u2032, l\u2032, a\u2032) by giving the possibility to replace the values in the vector with question marks in all the possible ways.\n\u0393Y makes it possible to associate, to each observation w \u2208 W, the set of facts that may originate it: i.e.,\n{w}\u2217 := {y \u2208 Y : w \u2208 \u0393(y)}.\nIn the Asia network, our observation might be w = (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032). If \u0393(y) is defined as above, then {w}\u2217 is the set of the 25 completions of (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032). \u0393(y) might also be defined differently, for instance by allowing only for some replacements of values in the vector y with question marks (the possibility to replace values with question marks might also depend on the values that some variables in the vector take jointly). In this case {w}\u2217 would be a subset of the 25 completions. What is important is that the set {w}\u2217 does not allow us to identify the value of Y uniquely, unless it is a singleton. This tells us that IPs are observational processes that produce W by coarsening Y , i.e., by yielding an observation w corresponding to a set {w}\u2217 of possible values for Y that we expect to\nencompass y (this expectation will be formalised in Section 7.1.2). It follows that IPs are a generalisation of the, perhaps more popular, missingness processes, which consider only two possibilities: either {w}\u2217 is a singleton or it is Y, in which case Y is said to be missing. In the case of the Asia net, we could characterise a missingness process by writing \u0393(y) = {(v, k, b, h, o, l, a), (?, ?, ?, ?, ?, ?, ?)} for all y = (v, k, b, h, o, l, a) \u2208 Y.9 If {w}\u2217 = \u2205, w cannot be produced by any y \u2208 Y, and can therefore be eliminated from W without any further consequences; we shall henceforth assume that\nw \u2208 W \u21d2 {w}\u2217 6= \u2205. (IP2)\nFinally, we define for each w \u2208 W the set of facts of which w is the only compatible observation:\n{w}\u2217 := {y \u2208 Y : \u0393(y) = {w}}."}, {"heading": "3.3 Refining Facts, Observations, and the Incompleteness Process", "text": "In this section, we add some structure to the incompleteness process by representing it as the combination of two different incompleteness processes, which act on different parts of a fact. We model these two parts by writing Y := (Y\u0304 , Y\u0302 ), where Y\u0304 and Y\u0302 are two new variables, with values in Y\u0304 and Y\u0302, respectively, such that Y = Y\u0304 \u00d7 Y\u0302. In an analogous way, we regard the observation W of Y as the observation W\u0304 of Y\u0304 jointly with the observation W\u0302 of Y\u0302 , and hence write W := (W\u0304 , W\u0302 ). Here again, W\u0304 and W\u0302 are two new variables, with values in W\u0304 and W\u0302, respectively, such that W = W\u0304 \u00d7 W\u0302.\nThe additional variables introduced indeed allow us to think of two new IPs: the first acts on variable Y\u0304 , leading to observation W\u0304 , and thus is characterised by a certain multi-valued map \u0393Y\u0304 ; the second acts on variable Y\u0302 , leading to observation W\u0302 , and is characterised by another multi-valued map \u0393Y\u0302 . We call them the unknown IP and the CAR IP, respectively, as by the former we aim at modelling an IP whose behaviour is unknown to us and by the latter a CAR IP.\nAssuming that y \u2208 Y \u21d2 \u0393(y) = \u0393(y\u0304)\u00d7 \u0393(y\u0302) (IP3)\nallows us to regard the two IPs, taken together, as the single incompleteness process introduced in Section 3.2, i.e., the one that maps (Y\u0304 , Y\u0302 ) = Y into (W\u0304 , W\u0302 ) = W . From now on, we call this the overall IP. Assumption (IP3) follows as a consequence of our intention to model problems where there are two IPs which observe different parts of a fact and therefore do not interact. This is discussed at some length at the end of Section 7.2.\nWe now impose some assumptions about the unknown and the CAR IP. Consider the sets {w\u0304}\u2217, {w\u0304}\u2217, {w\u0302}\u2217, and {w\u0302}\u2217, defined in the obvious way on the basis of \u0393Y\u0304 and \u0393Y\u0302 . The following assumptions resemble Assumptions (IP1)\u2013(IP2) and are motivated by the same arguments:\ny\u0304 \u2208 Y\u0304 \u21d2 \u0393(y\u0304) 6= \u2205 (IP4)\n9. To avoid confusion, it may be worth outlining that whether a process is a coarsening or a missingness process depends on what we focus on. In the case of the Asia network, for instance, the process can be a missingness process for each single variable of the net (i.e., it yields either the value of the variable or a question mark) and simultaneously be a coarsening process for the vector of variables (in the sense that it does not only yield the vector of values or the vector made entirely of question marks).\ny\u0302 \u2208 Y\u0302 \u21d2 \u0393(y\u0302) 6= \u2205 (IP5)\nw\u0304 \u2208 W\u0304 \u21d2 {w\u0304}\u2217 6= \u2205 (IP6)\nw\u0302 \u2208 W\u0302 \u21d2 {w\u0302}\u2217 6= \u2205. (IP7)\nWe also impose an additional requirement on the unknown IP:\nw\u0304 \u2208 W\u0304 \u21d2 {w\u0304}\u2217 = \u2205. (IP8)\nWe do so as a means to start implementing the idea that there is ignorance about the procedure used by the unknown IP to select an observation starting from a fact.\nHaving \u0393(y) = \u0393(y\u0304)\u00d7 \u0393(y\u0302) for all y \u2208 Y implies that {w}\u2217 = {w\u0304}\u2217 \u00d7 {w\u0302}\u2217 and {w}\u2217 = {w\u0304}\u2217 \u00d7 {w\u0302}\u2217 for all w \u2208 W. This shows that (IP4)\u2013(IP7) imply (IP1)\u2013(IP2)."}, {"heading": "4. The Conservative Inference Rule", "text": "The notations introduced so far finally allow us to write the definition of the conservative inference rule. To this extent, we assume that we have beliefs about (Z, Y ) in the form of a joint lower prevision P 1.\nDefinition 7 (Conservative inference rule) Consider a gamble g on Z and w \u2208 W, and assume that P 1({w}\u2217) > 0. Let {w\u0304}\u22171 := {y\u0304 \u2208 {w\u0304}\u2217 : P 1(y\u0304, {w\u0302}\u2217) > 0}, and define\nR(g|y\u0304, {w\u0302}\u2217) := inf P\u2265P 1:P (y\u0304,{w\u0302}\u2217)>0 P (g|y\u0304, {w\u0302}\u2217)\nfor all y\u0304 \u2208 {w\u0304}\u22171. Then we let\nR(g|w) := min y\u0304\u2208{w\u0304}\u22171\nR(g|y\u0304, {w\u0302}\u2217). (CIR)\nLater, in Section 7.3, we shall see that this definition actually follows as a theorem under a certain number of assumptions.\nLet us clarify the intuition behind the definition of R(g|w). Our goal is to update beliefs about a certain function g of Z once we make the observation w about Y . Remember that w can be regarded as the pair (w\u0304, w\u0302), where w\u0304 is the part of the observation originated by the unknown IP and w\u0302 that originated by the CAR IP. The conservative inference rule prescribes to update beliefs by adopting the lower prevision R(g|w) computed as in Formula (CIR). This means (i) to consider all the completions y\u0304 of w\u0304 with the property that the conditioning event (Y\u0304 = y\u0304, Y\u0302 \u2208 {w\u0302}\u2217) has positive upper probability under P 1; (ii) to compute our updated beliefs under each of these events: we can do this by applying Bayes\u2019 rule to each linear prevision that dominates P 1 and for which the event has positive probability, so as to create a set of posterior linear previsions whose lower envelope is R(g|y\u0304, {w\u0302}\u2217); finally, to define the lower prevision R(g|w) as the minimum of the lower previsions obtained under all the completions considered. This minimum, in particular, has the meaning to be as conservative as possible with respect to the data that has been made incomplete by the unknown IP: we deal with them by considering all the complete data that could have been there before the IP started operating. On the other hand, the data subject to the CAR IP are treated as usual, that is, by conditioning on the set of completions {w\u0302}\u2217."}, {"heading": "4.1 Significance of the Conservative Inference Rule", "text": "We can think of CIR as a generalisation of two kinds of updating rules. It generalises the traditional updating rule, the one that, for instance, prescribes discarding missing observations. CIR coincides with such a rule in the case the IP is made only of the CAR component. On the other hand, if there is no CAR component, and the overall IP is unknown, CIR is similar to (but more powerful than) the so-called conservative updating rule (CUR) proposed by De Cooman and Zaffalon (2004). When both components are present, CIR acts as a mix of traditional updating and CUR.\nAs CUR, CIR is an imprecise-probability rule: it generally leads to lower and upper expectations, and partially determined decisions. This follows, in part, as it allows P 1 to be imprecise. Yet, even if we take that to be a linear prevision P1, CIR turns out to be an imprecise-probability rule: imprecision arises as a logical consequence of our ignorance about the unknown IP."}, {"heading": "4.1.1 Comparison with CUR", "text": "It is instructive to analyse more deeply the difference between CIR and CUR. To this extent, let us first give the definition of CUR using the notation introduced so far:\nDefinition 8 (Conservative updating rule) Assume that Z is a finite set, that Y = Y\u0304 and W = W\u0304 , that is, that the overall IP is entirely unknown. Furthermore, assume that \u0393Y\u0304 is originated by missing values: this means that if we regard Y\u0304 as vector-valued, each of its components is either observed precisely or it is missing. Assume also that P 1(y\u0304) > 0 for all y\u0304 \u2208 {w\u0304}\u2217. For every gamble g on Z, define\nR(g|y\u0304) := inf P\u2265P 1:P (y\u0304)>0 P (g|y\u0304)\nfor all y\u0304 \u2208 {w\u0304}\u2217. Then we let\nR(g|w\u0304) := min y\u0304\u2208{w\u0304}\u2217 R(g|y\u0304). (CUR)\nThe major differences between CIR and CUR are discussed below.\n\u2022 The first difference is that CUR allows only the unknown IP to be present. In doing so, CUR does not model beliefs stronger than ignorance about the IP, for which CURbased inferences will be more conservative than necessary. CIR tries to remedy this by allowing for mixed states of knowledge made of ignorance and CAR. This makes CIR a flexible rule that should lead to strong enough conclusions in many applications.\n\u2022 The by far most important difference between CIR and CUR is the generality of application. The theory used to derive CUR is restricted to the case when P 1 is directly assessed rather than obtained through a number of conditional and unconditional lower previsions, possibly together with some notion of independence. This is the case, for instance, of statistical inference which involves using a certain number of lower previsions to model prior knowledge and the likelihood function and some notion of independence (or exchangeability) to build P 1. Although one can apply CUR also in these more general and common conditions, its theory does not guarantee\nthat CUR leads to self-consistent inference in those cases. CIR, on the other hand, is shown in Sections 7.3 to lead to coherent inference under a very wide spectrum of conditions, which should cover nearly all the practical situations. This means that applying CIR always leads to probabilities that are self-consistent as well as consistent with the original assessments. (Observe that since CUR is a special case of CIR, our proofs finally show that CUR also leads to self-consistent inference.) In other words, CIR is more much than CUR a rule for the general task of updating beliefs based on the observation of facts. In this, it is similar in spirit to traditional updating, which we typically use in every situation: e.g., in the case of expert systems as well as to update our beliefs given data in problems of statistical inference. With CIR, different applications follow by simply giving different meanings to facts (Y\u0304 , Y\u0302 ), observations (W\u0304 , W\u0302 ), and to the quantity Z in which we are interested. Section 5 will give examples to show how this is done in a variety of cases.\nThere are three further characteristics that make CIR more flexible than CUR.\n\u2022 The first is that CIR allows the target space to be infinite, while CUR was defined only for the case of finite spaces.\n\u2022 The second is that CIR deals with general incompleteness processes, while CUR only with the special case of processes that may originate missing information for the variables under consideration. This is related to the restriction about \u0393Y\u0304 mentioned in the definition of CUR. This characteristic of CIR is important when aiming to obtain as strong conclusions as possible: by taking advantage of partially observed facts, CIR leads in general to stronger conclusions than CUR.\n\u2022 The third is somewhat more technical. CUR requires that every element in {w\u0304}\u2217 is given positive upper probability. CIR requires this only for the entire set {w\u0304}\u2217. The difference is important in practice. To see this, consider that in applications it is quite common to represent deterministic relations among variables by degenerate probabilities equal to zero or one. These relations naturally give rise to zero upper probabilities: every joint state of the variables that does not satisfy the relation has zero upper probability by definition. CUR cannot be used in these applications. CIR can, and it simply leads to neglect the states with zero upper probabilities: more precisely, given an observation (w\u0304, w\u0302), it leads to consider only the compatible facts (y\u0304, {w\u0302}\u2217) for which it is possible to condition on them as they are given positive upper probability, or, in other words, such that y\u0304 \u2208 {w\u0304}\u22171.\nSection 5.1 will show how some of these differences between CIR and CUR impact on an example."}, {"heading": "4.1.2 Originality of CIR", "text": "Something interesting to note is that CIR, such as traditional updating and CUR, is based only on the variables Z and Y : i.e., for applying CIR one does not need to consider the W -variables. This makes CIR particularly simple to use. Another consideration concerns originality: to the best of our knowledge, CIR appears here for the first time. There are\ncontributions in the literature similar to CIR for the case of statistical model learning from samples made incomplete by an unknown missingness process (e.g., Manski, 2003; Ramoni & Sebastiani, 2001; Zaffalon, 2002). This is not surprising, as the intuition to take all the completions of an incomplete sample is actually very natural. But we are not aware of any work proposing, and especially deriving, an abstract and general rule to update beliefs from incomplete information such as CIR."}, {"heading": "5. Applications", "text": "In the following sections we shall show how CIR leads easily to several different rules according to the applications under study, and in doing so we present a number of examples. To make things simpler we do not go in the details of the multi-valued maps used; we shall only take W\u0304 to be the set of all the nonempty subsets of Y\u0304, and assume that the hypotheses done throughout the paper hold. We adopt similar considerations for the CAR IP."}, {"heading": "5.1 CIR for Expert Systems", "text": "Probabilistic expert systems represent the key quantities in a domain by a vector of variables, which in this section are assumed to take values from finite spaces. One or more of these variables are the target, i.e., the variables that are the objective of inference. The remaining ones are introduced to the extent of inferring the value of the target.\nThe Asia network in Figure 1 represents a well-known artificial example of expert system in the medical domain. It is supposed that an expert has provided the graph as well as the probabilities that define the Asia network, as reported in Table 1. If we want to use the network to make diagnosis, we first choose a target node, such as R or B. Then we collect information about the patient, as well as the results of medical tests, such as X-rays, and make it available to the network by instantiating the related nodes in the graph to the observed values. Finally, we query the network to update the probability of the target node given the evidence inserted.\nBut usually not all the nodes, apart from the target node, are instantiated as some values are missing, and the way the network has to compute belief updating depends on our assumptions about them. The traditional way entails marginalising them out and it is equivalent to assuming that they are subject to a MAR process. This is the special case of CIR obtained by dropping the unknown IP. The general version of CIR offers more flexibility in their treatment, and can produce a very different solution, as we illustrate by an example below. In it we also use coarsened observations so as to show how set-valued observations may enter the picture of probabilistic inference both in the CIR and in the CAR case.\nExample 3 Say that you are a senior doctor at a hospital and find on your desk a report from a junior colleague about a certain patient he visited. The patient came to the hospital under a state of dyspnea (A = a\u2032). Your colleague visited the patient and did not find any sign of bronchitis (H = h\u2032\u2032). He also made some questions to the patient to collect background information. He remembered that he had to ask something about smoking as well as about some recent trip to Asia; but in the end he was not clear nor determinate enough and he got to know only that the patient was concerned with only one of the two\nthings. Your unexperienced colleague thought then the situation was not serious and sent the patient back home. You are instead a bit more cautious. In fact you suspect that the patient might have hidden some information for privacy reasons, although you recognise that you do not know these reasons. Overall, you are implicitly assuming the existence of an unknown IP for the variables V and K that leads to {w\u0304}\u2217 = {(v\u2032, k\u2032\u2032), (v\u2032\u2032, k\u2032)}, where we denote by w\u0304 the value of W\u0304 that corresponds to the observation of (V,K). In other words you regard (v\u2032, k\u2032\u2032) and (v\u2032\u2032, k\u2032) as the only two possible completions for the information that you lack about (V,K).\nLet us make two remarks before proceeding: (i) that the unknown IP is a coarsening process, not just a missingness process, and this is what allows us to restrict the completions of (V,K) only to two elements; and (ii) that despite the name the unknown IP is (also very) informative when we use coarsened rather than missing values.\nYou finally judge the remaining variables to be subject to a MAR IP. This is very reasonable as your colleague simply decided not to have the patient do any test. In this case the probability of missingness is one independently of the actual values of the variables under consideration. It is instructive to stress that in this case the MAR IP is just your colleague.\nAt this point you are ready to do some diagnosis. You first run an algorithm for Bayesian nets using the completion (v\u2032, k\u2032\u2032), obtaining that the posterior probability for cancer is 0.052 and that for tuberculosis is 0.258; then you run the algorithm once more, in this case using the completion (v\u2032\u2032, k\u2032), which leads to 0.423 for the updated probability of cancer and 0.042 for that of tuberculosis. Now the question is that the first run suggests that you should diagnose tuberculosis, and the second that you should diagnose cancer. Since you have no idea about which one is the right completion of (V,K), you admit that you are not able to discriminate between tuberculosis and cancer at this time. In other words, your model is telling you that the information you have is too weak to draw any useful conclusion, and is implicitly suggesting to collect stronger information. In order to do so, you invite the patient for a next visit, explaining the importance of knowing whether he has been to Asia, something that he actually confirms, thus letting you know eventually that V = v\u2032 and K = k\u2032\u2032. Your updated probabilities are then 0.052 for cancer and 0.258 for tuberculosis. On this basis, you ask the patient to undergo X-rays, which turn out to be abnormal (L = l\u2032), leading to 0.151 and 0.754, respectively, as probabilities for cancer and tuberculosis, and you diagnose tuberculosis.\nConsider what might happen by assuming all the variables to be subject to a CAR/MAR IP, as it is common with Bayesian nets. In that case, the information you have initially is that A = a\u2032, H = h\u2032\u2032, and that (V,K) \u2208 {(v\u2032, k\u2032\u2032), (v\u2032\u2032, k\u2032)}. It is just CAR that allows us to forget about W\u0304 and to write down that (V,K) belongs to {(v\u2032, k\u2032\u2032), (v\u2032\u2032, k\u2032)}. This event is easy to incorporate in a Bayesian network: it is enough to insert a new node in the Asia network that is child of both V and K and that is in state \u2018yes\u2019 with probability one if and only if (V,K) \u2208 {(v\u2032, k\u2032\u2032), (v\u2032\u2032, k\u2032)}. This new node is then instantiated in state \u2018yes\u2019. At this point, running an algorithm for Bayesian nets yields that the probabilities for cancer and tuberculosis conditional on A = a\u2032, H = h\u2032\u2032, and (V,K) \u2208 {(v\u2032, k\u2032\u2032), (v\u2032\u2032, k\u2032)}, are 0.418 and 0.045, respectively. This would make you suspect that there is cancer; moreover, it might well induce you to take the following erroneous course of reasoning: \u2018since the probability of cancer is that high even without knowing the exact values of V and K, trying to obtain that information is a waste of time; I must rather focus on more concrete evidence such\nas X-rays to make my diagnosis.\u2019 But obtaining the positive X-rays test (L = l\u2032) would enforce your beliefs even more by raising the probability of cancer up to 0.859, leading you to a mistaken diagnosis. \u2666\nThese considerations are not limited to expert systems based on precise probability; completely analogous considerations would be done in the case of expert systems that model knowledge using closed convex sets of mass functions (or, equivalently, by the coherent lower prevision which is their lower envelope) for which CIR is also suited. Credal networks, for example, provide such modelling capabilities (Cozman, 2000, 2005).\nIt is easy to rephrase expert system models in the setting of this paper. Say that the expert system is based on the vector of variables (Z, Y\u03041, . . . , Y\u0304m, Y\u03021, . . . , Y\u0302n), where Z is the target variable, and the others are those subject to the unknown and the CAR IP, respectively. Then it is sufficient to write Y\u0304 := (Y\u03041, . . . , Y\u0304m), Y\u0302 := (Y\u03021, . . . , Y\u0302n), and to consider that a set M of joint mass functions for (Z, Y ), or equivalently the lower prevision P 1 made by taking its lower envelope, is given. Doing inference with an expert system, in quite a general form, corresponds then to compute R(g|w\u0304, w\u0302), where w\u0304 is now the observation of the Y\u0304 vector and w\u0302 that of the Y\u0302 vector.\nWe consider some cases to make things clearer. At an extreme, which we already mentioned, there is the case m = 0, which means that there is only the CAR IP. The updating rule that follows from CIR is then the traditional updating: R(g|w\u0302) = R(g|{w\u0302}\u2217). Say that, to be even more specific, g is the indicator function Iz of some z \u2208 Z, and that {w\u0302}\u2217 = {(y\u03021, . . . , y\u0302j , y\u0302\u2032j+1, . . . , y\u0302\u2032n) \u2208 Y\u0302 : y\u0302\u2032j+1 \u2208 Y\u0302j+1, . . . , y\u0302\u2032n \u2208 Y\u0302n)}, i.e., that the first j variables of Y\u0302 are observed precisely, while the others are missing. The updating rule becomes:\nR(g|{w\u0302}\u2217) = R(Iz|y\u03021, . . . , y\u0302j , Y\u0302j+1, . . . , Y\u0302n) = R(Iz|y\u03021, . . . , y\u0302j),\nwhich is equal to infP\u2265P 1:P (y\u03021,...,y\u0302j)>0 P (z|y\u03021, . . . , y\u0302j). The latter is an updating rule implemented by credal networks; and if P 1 is a linear prevision, it is the rule used with Bayesian networks.\nConsider now the other extreme: n = 0, i.e., when there is only the unknown IP. Similarly to the previous case, say that g is the indicator function for z; and that {w\u0304}\u2217 = {(y\u03041, . . . , y\u0304i, y\u0304\u2032i+1, . . . , y\u0304\u2032m) \u2208 Y\u0304 : y\u0304\u2032i+1 \u2208 Y\u0304i+1, . . . , y\u0304\u2032m \u2208 Y\u0304m)}. CIR becomes then R(g|w\u0304) = miny\u0304i+1\u2208Y\u0304i+1,...,y\u0304m\u2208Y\u0304m infP\u2265P 1:P (y\u03041,...,y\u0304m)>0 P (z|y\u03041, . . . , y\u0304m). This case nearly coincides with the conservative updating rule proposed by De Cooman and Zaffalon (2004), with the differences already discussed in Section 4.1. These differences are important: for instance, that CUR cannot deal with coarsened observations makes it impossible to use it to model the observation in Example 3. Some of them would even prevent CUR from being applied more generally to the example: on the one hand, the presence of the logical \u2018or\u2019 gate in the Asia network creates states of zero upper probability (e.g., B = b\u2032, R = r\u2032, O = o\u2032\u2032) that are incompatible with the assumptions underlying CUR; on the other, since domain knowledge (i.e., the Asia net) is built out of a number of conditional mass functions, we cannot guarantee that CUR leads to self-consistent inference as its proof does not deal with such an extended case. We know that CIR instead does lead to self-consistent inference as a consequence of Corollary 3 in Appendix B.\nWhen neither m nor n are equal to zero, CIR becomes a mix of the two extreme cases just illustrated, as in the example: it leads to treat the variables subject to the CAR IP by\nthe traditional updating, while treating those subject to the unknown IP similarly to what CUR does. Mixing the two things has the advantage of greater expressivity: it allows us to represent beliefs about the overall IP that are in between the two extremes.\nWe conclude this section by briefly discussing the problem of doing computations with CIR and its special case CUR.\nIn the context of doing classification with Bayesian nets according to CUR, Antonucci and Zaffalon (2007) have proved an NP-hardness result, as well as given an exact algorithm. The algorithm is a variant of the variable elimination algorithm that has a better complexity than the traditional algorithms on Bayesian nets (implicitly using CAR): it works in linear time not only on polytree networks (i.e., those for which there is at most one path between any two nodes in the graph after dropping the orientation of the arcs) but also on a number of more general nets; on the remaining ones it takes exponential time. Moreover, in another paper, Antonucci and Zaffalon (2006) have shown that when there are missing observations the problem of CIR-updating in Bayesian nets and that of traditional (i.e., MAR-based) updating in credal nets are equivalent. This is exploited in a recent paper (Antonucci & Zaffalon, 2008, Section 9) to show the NP-hardness of CIR-updating in Bayesian nets, and to give a procedure to solve such a problem via existing algorithms for credal nets. The idea behind such a procedure is relatively straightforward, and it takes inspiration from a method proposed by Pearl (1988, Section 4.3) to represent an instantiated node in a Bayesian net using an equivalent formulation: the formulation is based on removing the instantiation from the node and on adding a dummy child to it that is actually instantiated to a certain value. This approach is basically taken as it is for CIR-updating in the case of a node missing in an unknown way; CIR imposes to deal with it by considering all its possible instantiations. Considering the dummy-child method for each of them is shown to be equivalent to using a single imprecise-probability dummy child that is instantiated to a unique value. In this way the node that was originally missing in an unknown way can be treated as a node missing at random, while the dummy child is simply an instantiated imprecise-probability node. As a consequence, the original Bayesian net becomes a credal network and our task becomes the computation of MAR-based updating on such a net. Since there are already many algorithms designed for this task, the described transformation allows one to solve the CIR-updating problem via known algorithms for the MAR-updating problem on credal nets. Yet, MAR-updating on credal networks is a more difficult problem than MAR-updating on Bayesian nets, as it is NP-hard also on polytrees (De Campos & Cozman, 2005). Therefore CIR-updating appears to be more demanding than MAR- or CUR-updating. This is not necessarily going to be a problem in practice as approximate algorithms for credal nets nowadays allow one to solve updating problems on large-scale networks (e.g., Antonucci et al., 2008)."}, {"heading": "5.2 CIR for Parametric Statistical Inference", "text": "In a statistical problem of parametric inference, we are given a sample that we use to update our beliefs about a so-called parameter, say \u0398, with values \u03b8 \u2208 T . The admissible values for \u0398 index a family of data generation models that we consider possible for the problem under consideration. Here we do not exclude the possibility of this set being infinite, as it is often the case in statistics.\nIn this setting, a fact is thus the true, and hence complete, sample. We represent it as the following vector of variables:\nY :=  D1 D2 ... DN  . (1) The elements of a sample are also called units of data. We assume from now on, that the variables Di have the same space of possibilities for every i.\nWe can exemplify the problem of parametric statistical inference by focusing once again on the Asia Bayesian network in Figure 1: a frequent step in the construction of Bayesian nets is the inference of the network parameters from a data set. Say, for instance, that we are interested in evaluating the chance \u0398 that a person suffers from tuberculosis if we know that the same person has made a recent visit to Asia. To this extent we might exploit a data set for the variables B and V , such as the one below:\ny := \n(b\u2032, v\u2032) (b\u2032, v\u2032\u2032) (b\u2032, v\u2032\u2032) (b\u2032\u2032, v\u2032\u2032) (b\u2032\u2032, v\u2032) (b\u2032\u2032, v\u2032)\n , (2)\nfor which we assume in addition that the data have been generated according to an identical and independently distributed (IID) process.\nWe can do parametric inference relying on the tools of Bayesian statistics. This means to compute the posterior linear prevision (i.e., the posterior expectation) P (g|y), for a certain function g : T \u2192 R. This is obtained integrating the posterior density function for \u0398, obtained in turn by Bayes\u2019 rule applied to a prior density function, and the likelihood function (or likelihood) L(\u03b8) := P (y|\u03b8).\nIn this case, a common choice for the prior would be a Beta density for \u0398: Bs,t\u2032(\u03b8) \u221d \u03b8st \u2032\u22121(1\u2212\u03b8)s(1\u2212t\u2032)\u22121, where s and t\u2032 are positive real hyper-parameters that are respectively the overall strength of the prior knowledge and the prior expectation of \u0398. In the case of the data set (2), this choice leads to a posterior expectation for \u0398 that is equal to 1+st \u2032\n3+s . Setting s := 1 and t\u2032 := 1/2, namely, Perks\u2019 prior (see Perks, 1947), we obtain 1+st \u2032\n3+s = 0.375, which can be regarded as an approximation to the true parameter value.\nImprecise probability approaches to parametric inference often extend Bayesian statistical methods by working with a set of prior density functions, and by updating each of them by Bayes\u2019 rule, whenever possible, using the same likelihood function, thus obtaining a set of posteriors. An example is the imprecise Dirichlet model proposed by Walley (1996a). In our notation and terminology, this means that in the imprecise case parametric inference is based on the unconditional lower prevision P 1(\u0398, Y ), obtained by means of the prior P 1(\u0398) and the likelihood P (Y |\u0398) through a rule called marginal extension, that is updated into the posterior lower prevision R(\u0398|Y ) by a procedure called regular extension. Marginal and regular extension will be introduced more precisely in Section 6.\nIn the previous example related to the data set (2) where the variables are binary, the imprecise Dirichlet model is called imprecise Beta model (Bernard, 1996), and can be easily applied as follows. The idea is to consider the set of all the Beta densities with fixed prior strength, say s = 1: i.e., the set of all Bs,t\u2032 such that s = 1 and t\u2032 \u2208 (0, 1).10 This set can be regarded as a single imprecise prior that only states that the prior probability for category b\u2032 lies in (0, 1), which seems a more reasonable way to model a state of prior ignorance about \u0398 than a Bayesian prior, such as Perks\u2019 above. This imprecise prior leads to an imprecise posterior expectation for \u0398: to compute it, it is enough to reconsider the expression 1+st \u2032 3+s and let t\u2032 take all the values in (0, 1); this leads to the interval [0.25, 0.50] that is delimited by the lower and the upper posterior probabilities obtained from 1+st \u2032\n3+s when t \u2032 = 0 and t\u2032 = 1,\nrespectively. Again, this \u2018interval estimate\u201911 appears to be much more reasonable and reliable than the precise posterior expectation obtained by the Bayesian approach, taking especially into account that the sample available to infer the parameter under consideration has size three!\nBut in real problems we often face the further complication of having to deal with incompleteness in statistical data: rather than a complete sample y, we may be given an incomplete sample w, i.e., one that corresponds to a set {w}\u2217 of complete samples. The set {w}\u2217 arises as a consequence of missingness or partial observability of some values. The data set (2) might for instance be turned by an incompleteness process into the following incomplete data set:\nw :=  (b\u2032, v\u2032) (b\u2032, v\u2032\u2032) (b\u2032, ?)\n(b\u2032\u2032, v\u2032\u2032) (b\u2032\u2032, ?) (?, v\u2032)\n . (3)\nIn this example {w}\u2217 is the set of the eight complete data sets that are obtained by replacing the question marks in all the possible ways.\nThe question is then how to do parametric inference with an incomplete sample. We represent each unit in Vector (1) by regarding the generic variable Di as the pair (Y\u0304i, Y\u0302i), and let Y\u0304 := (Y\u03041, . . . , Y\u0304N ), Y\u0302 := (Y\u03021, . . . , Y\u0302N ), so that Y = (Y\u0304 , Y\u0302 ).\nNow it is easy to use CIR to address the question of parametric inference with incomplete data, if we know that Y\u0302 is subject to a CAR IP, and we do not know the IP that acts on Y\u0304 . Observing that \u0398 plays the role of Z, we obtain that CIR prescribes using the following rule: R(g|w) = miny\u0304\u2208{w\u0304}\u22171 R(g|y\u0304, {w\u0302} \u2217), which rewrites also as\nR(g|w\u0304, w\u0302) = min y\u0304\u2208{w\u0304}\u22171 inf P\u2265P 1:P (y\u0304,{w\u0302}\u2217)>0\nP (g|y\u0304, {w\u0302}\u2217), (4)\n10. The reason why we exclude the extreme points of the interval is to avoid creating conditioning events with zero lower probability and have to discuss their implications. In the present setup this is not restrictive, as it can be shown that the closed interval would eventually lead to the same inferences. 11. It is important to be aware that these intervals are conceptually very different tools from Bayesian credible intervals, which arise out of second-order information about a chance. The present intervals arise only out of ignorance about the unknown IP, something that makes a set of IPs be consistent with our assumptions and about which we have no second-order information. Stated differently, the counterpart of these intervals in the precise case are the point estimates, not the credible intervals, which should instead be compared with imprecise credible intervals (e.g., see Walley, 1996a, Section 3).\nbecause imprecision on (\u0398, Y ) originates via prior imprecision only. We prove in Corollary 4 in Appendix B that this rule leads to self-consistent inference.\nWe can regard the lower expectation in Equation (4) as arising from two kinds of imprecise beliefs. The first are beliefs about \u0398 that we model by the lower prevision P 1(\u0398). The remaining beliefs are embodied by the likelihood function. This is imprecise knowledge, too, since there are actually multiple likelihood functions, because of the unknown IP, and we model them using the different conditional previsions P (\u0398|y\u0304, {w\u0302}\u2217) for y\u0304 \u2208 {w\u0304}\u22171. In other words, working with incomplete data according to CIR is equivalent to working with the set of posteriors that arise by applying Bayes\u2019 rule, whenever possible, to each prior-likelihood pair in the model.\nIn the case of the data set (2), we might know that in order to create the incomplete sample (3) out of it, the variable B has been subject to a MAR missingness process, while we might not know what kind of missingness process has acted on variable V ; in this case, the generic unit i of (2) can be written as the pair (y\u0302i, y\u0304i). Say that we focus again on computing the posterior expectation for \u0398, chosen to be that a person suffers from tuberculosis if we know that the same person has made a recent visit to Asia. Say also that we use Perks\u2019 prior as we did before in the Bayesian case, in order not to get distracted in the discussion by prior imprecision. In this case, the outer minimum in (4) corresponds to minimising over the four completions for variable V ; the following infimum corresponds to take into account Perks\u2019 prior. The four completions mentioned above give rise to four different data sets that contain a single missing value in the last unit. For each of them, we can compute the lower probability for the category b\u2032 conditional on v\u2032, using the Expectation-Maximisation algorithm (Dempster, Laird, & Rubin, 1977) together with Perk\u2019s prior, obtaining four values: 0.63, 0.87, 0.50, 0.83 (these values are rounded to the second digit). The lower probability is then their minimum: 0.5; analogously, their maximum is the upper probability: 0.87. We can again think of these two values as delimiting an interval for the probability under consideration: [0.5, 0.87]. The width of this interval reflects our ignorance about the missingness process for V .\nWe consider now the Bayesian case, using for both B and V the MAR assumption, as it is very common when learning parameters from data sets. In this case, the ExpectationMaximisation algorithm together with Perks\u2019 prior yields an estimate for the probability equal to 0.86. Apart from the unrealistic precision of this estimate obtained from such a small data set, we can observe that using MAR has arbitrarily led us very close to the upper extreme of the interval [0.5, 0.87]. This is even more questionable when we consider that the Bayesian estimate from the complete data set (2) was close to the lower extreme.\nIn summary, by using CIR we are able to obtain interval estimates that are arguably more realistic than the point estimates provided by more traditional methods when the MAR assumption is not justified. This also follows by exploiting the option given by CIR to use models of prior knowledge that carefully model the available information, or the absence of information, such as the imprecise Dirichlet model.\nFinally, as the example illustrates, working with multiple likelihoods is a consequence of taking all the possible completions of the incomplete part of the sample subject to the unknown IP. This is a very intuitive procedure; therefore, it is not surprising that analogous procedures have already been advocated with missing data in the context of robust statistical inference (see, e.g., Manski, 2003; Ramoni & Sebastiani, 2001; Zaffalon, 2002). Actually,\nthe discussion in this (and the following) section can be regarded as a formal justification of the cited approaches from the point of view of the theory of coherent lower previsions. It can also be regarded as a generalisation of some of those approaches in that it considers the joint presence of the CAR and the unknown IP, and because it allows one to work with incomplete rather than missing data."}, {"heading": "5.2.1 IID+ID Case", "text": "In the previous section, we have not made hypotheses about the generation of the complete sample. However, in practice it is very frequent to deal with independent and identically distributed data (also called multinomial data), and indeed we have already assumed IID for the data in (2). With multinomial data, the units are identically distributed conditional on \u03b8, and this helps simplifying the developments. Call D the space of possibilities common to the units. When we assume that D is finite (as we shall do in our derivation of the CIR rule in Section 7.3), the parameter \u0398 is defined as the vector [\u0398d]d\u2208D, where the generic element \u0398d represents the aleatory probability of D = d. It follows that \u03b8 \u2208 T is the vector [\u03b8d]d\u2208D, whose generic element \u03b8d is P (d|\u03b8); and that T is a subset of the |D|-dimensional unit simplex. Taking into account that units are also independent conditional on \u03b8, it follows that the likelihood factorises as \u220fN i=1 \u03b8di .\nWhen complete data are IID, it may be reasonable to assume that also the overall IP is independently distributed (ID). Such an assumption allows us to represent the observation of the complete sample as a vector, i.e., as an incomplete sample:\nW :=  W1 W2 ...\nWN  . Here the generic unit Wi is the observation of Di. Remember that we regard Di as the pair (Y\u0304i, Y\u0302i); as a consequence, we also regard Wi as the pair of variables (W\u0304i, W\u0302i), with W\u0304i and W\u0302i the observations of Y\u0304i and Y\u0302i, respectively. Finally, let W\u0304 := (W\u03041, W\u03042, . . . , W\u0304N ) and W\u0302 := (W\u03021, W\u03022, . . . , W\u0302N ). For an example it is sufficient to consider the data set in (3), which is just an instance of W in the current language; and its generic unit i is an instance of Wi = (W\u0304i, W\u0302i), where W\u0304i corresponds to variable V and W\u0302i to B.\nUsing the newly introduced notation, the form that CIR takes is the following (with obvious meaning of the symbols):\nR(g|w\u0304, w\u0302) = min (y\u03041,...,y\u0304N )\u2208{w\u0304}\u22171\nR(g|y\u03041, . . . , y\u0304N , {w\u03021}\u2217, . . . , {w\u0302N}\u2217), (5)\nwhere R(g|y\u03041, . . . , y\u0304N , {w\u03021}\u2217, . . . , {w\u0302N}\u2217) is equal to\ninf P\u2265P 1,P (y\u03041,...,y\u0304N ,{w\u03021}\u2217,...,{w\u0302N}\u2217)>0\nP (g|y\u03041, . . . , y\u0304N , {w\u03021}\u2217, . . . , {w\u0302N}\u2217).\nThat this rule leads to self-consistent inference is established in Corollary 4 in Appendix B. Moreover, the new formulation shows that the ID assumption for the incompleteness process leads in practice to inhibiting certain types of coarsening: those that create logical\n\u2018connections\u2019 between different units. On the one hand, this confirms the expressive power of coarsening. On the other, it suggests that in applications it might be easier to forget about the ID assumption and simply focus on the specification of the kind of coarsening behaviour. This approach appears to be more intuitive and hence more accessible especially to people with little experience in statistics that might be involved in the analysis."}, {"heading": "5.2.2 Full IID Case?", "text": "Is it reasonable to assume that an IP is identically distributed besides independently distributed? And what are the consequences of such an assumption?\nWe start by addressing the second question. Under IID for complete data, the generic element d \u2208 D has a fixed aleatory probability, which we denoted by \u0398d. Call W the space of possibilities common to the variables Wi, i = 1, . . . , N . Under IID for the IP, the generic element w of W has a fixed aleatory probability to be produced conditional on d, let us call it \u03a6dw. It follows that w has a fixed unconditional aleatory probability to be produced: \u03a8w := \u2211 d\u2208D \u0398d \u00b7 \u03a6dw, which means that the process that produces elements of W is also multinomial. This seems to considerably simplify the setup considered so far, and can thus be regarded as an advantage of the full IID assumption (this advantage has clear practical consequences in the case of pattern classification, as illustrated in Section 5.3.2.)\nOn the other hand, and here we turn to address the first question, the possible advantages seem to be dwarfed by the strength of the assumption itself. It is indeed questionable that such an assumption may be largely valid in applications. IPs are often generated by sophisticated behaviour patterns that involve humans, or other complex agents, and that can be regarded as protocols of communications. In this case giving or not giving some information is a fundamental and an intelligent part of the communication. Assuming in this case that the IP is IID, seems to be too much of a strong assumption. In fact, there is a fundamental difference between data-generating processes (giving rise to Z and Y ) and observational processes (giving rise to W ). We believe that the essence of this difference is that in a number of cases it does not make much sense to assume that an observational process is identically distributed, while IID does make sense, or is at least a reasonable approximation for many data-generating processes."}, {"heading": "5.2.3 CAR Units", "text": "Having considered the IID+ID setup in Section 5.2.1 gives us the opportunity to slightly extend the analysis done so far. The idea is that the since the overall IP does not need to be identically distributed, it may happen to act as a CAR process for some units. Say that a certain unit 0 is entirely coarsened at random. The question is what form takes CIR now.\nThis is easy to see by defining Y\u0304 := (Y\u03041, . . . , Y\u0304N ), Y\u0302 := (D0, Y\u03021, . . . , Y\u0302N ), and the corresponding observation variables W\u0304 := (W\u03041, . . . , W\u0304N ), W\u0302 := (W0, W\u03021, . . . , W\u0302N ), which lead to the following rule:\nR(g|w\u0304, w\u0302) = min (y\u03041,...,y\u0304N )\u2208{w\u0304}\u22171\nR(g|y\u03041, . . . , y\u0304N , {w0}\u2217, {w\u03021}\u2217, . . . , {w\u0302N}\u2217).\nIn particular, if Unit 0 is missing, i.e., {w0}\u2217 = D, the rule prescribes to discard such a unit from consideration:\nR(g|w\u0304, w\u0302) = min (y\u03041,...,y\u0304N )\u2208{w\u0304}\u22171\nR(g|y\u03041, . . . , y\u0304N , {w\u03021}\u2217, . . . , {w\u0302N}\u2217).\nThis observation is particularly important for applications because it may well be the case that in practice some units are entirely missing in a non-selective way. CIR tells us that all such units, as Unit 0 above, are not going to alter our beliefs about Z.\nThe situation is obviously different if some units are turned into missing units by an unknown process; in this case there is no justification to discard them. The correct way to proceed is to make those missing values part of the observed data, and then to apply CIR again. This would lead us to consider all the completions of such missing units into account."}, {"heading": "5.3 CIR for Pattern Classification", "text": "This section focuses on problems of pattern classification, a special case of so-called predictive inference. Loosely speaking, this kind of inference is concerned with predicting future elements of a sequence based on the available part of the sequence itself. In a classification problem, the available sequence is represented by the following matrix: C1 F1 C2 F2 ...\n... CN FN  . (6) The generic line i, or unit i, of the matrix represents an object described by a pair of variables that we relabel as Di := (Ci, Fi) to be consistent with the notation used for parametric inference. Variable Ci represents a characteristic of the object in which we are interested, and that we call class. Denote the set of classes by C. By definition of pattern classification, C is a finite set. Variable Fi represents some features of the object that are informative about the class.\nWe can try to make this more clear by an example focused again on the Asia network. Say that we have a data set that records the state of the variables in the Asia network for a number of persons. Say also that we are interested in classifying people as smokers or nonsmokers. In this case, the value of Ci, i.e., the class variable for the i-th person in the data set, is the state of variable K in the Asia network for person i. Variable Fi is then the vector of all the remaining variables in the Asia network for such a person; in other words, Fi represents the profile of person i in the data set.\nNow we consider the next element in the sequence, represented as the further unit DN+1 := (CN+1, FN+1), also called the unit to classify. In the previous example, DN+1 would be the next person we see. The goal of classification is to predict the value that CN+1 assumes given values of all the other variables; in the example this amounts to predict whether the next person is smoker or not given the profile of that person, and the relationship between profiles and classes that is suggested by the historical data. In other words, in this framework CN+1 is Z and (D1, . . . , DN , FN+1) is Y .\nPredicting the class c\u2032 for CN+1 can be regarded as an action with uncertain reward gc\u2032 , whose value gc\u2032(c) depends on the value c that CN+1 actually assumes. In the case of precise probability, the optimal prediction is a class copt that maximises the expected reward:\nP (gcopt |d1, . . . , dN , fN+1) \u2265 P (gc\u2032 |d1, . . . , dN , fN+1), c\u2032 \u2208 C.\nThe previous expression is equivalent to the next:\nP (gcopt \u2212 gc\u2032 |d1, . . . , dN , fN+1) \u2265 0, c\u2032 \u2208 C.\nThis is very similar to the expression used with imprecise probability: in this case an optimal class is one that is undominated, i.e., such that for all c\u2032 \u2208 C:12\nP (gcopt \u2212 gc\u2032 |d1, . . . , dN , fN+1) > 0.\nDespite the similarity in notation, it is important to realise that there is a fundamental difference in the two cases: precise probability always leads to a determinate prediction, imprecise probability does not. With imprecise probability there is a progression according to which stronger beliefs lead to less indeterminate decisions, up to completely determined ones (see the paper by De Cooman & Zaffalon, 2004, Section 2.10, for a wider discussion of decision making with imprecise probability).\nThe discussion up to this point has highlighted that both with precise and with imprecise probabilities, predictions are based on (upper, and hence lower) previsions of functions g : C \u2192 R. In order to address the issue of incompleteness in pattern classification, we can therefore, without loss of generality, restrict the attention to the task of updating beliefs about CN+1.\nThis task is usually regarded as made of two distinct steps. The first is concerned with learning from a sample, represented here by Matrix (6), a probabilistic model of the relationship between features and classes. The second is applying the model to the observed value fN+1 of FN+1 in order to finally compute the (lower) prevision of a gamble g.\nWe illustrate the two steps in the case of IID data; more general cases can be treated analogously.\nIn the Bayesian framework, the first step is often done in a way similar to parametric inference. One defines a family of density functions that may be responsible for producing the units of data, indexes them by the admissible values \u03b8 \u2208 T of a (usually continuous) parameter \u0398, and then assesses a prior density for \u0398. The prior and the likelihood lead via Bayes\u2019 rule to the posterior density for \u0398 conditional on (d1, . . . , dN ). The second step corresponds to use such a posterior together with the density (or the mass function) for DN+1 conditional on \u0398, to obtain (integrating \u0398 out) the so-called predictive posterior: i.e., the mass function for CN+1 conditional on (d1, . . . , dN , fN+1), which embodies the wanted probabilistic model of the relationship between features and classes. Computing the posterior prevision P (g|d1, . . . , dN , fN+1) is trivial at that point.\nThe situation is similar in the imprecise case, with the difference that using a set of prior densities, i.e., a lower prior P 1(\u0398), leads to a lower predictive prevision:\nP (g|d1, . . . , dN , fN+1) := inf P\u2265P 1:P (d1,...,dN ,fN+1)>0 P (g|d1, . . . , dN , fN+1).\n12. Walley (1991) calls maximality the related decision criterion. See the work of Troffaes (2007) for a comparison with other criteria.\nNow we are ready to address the issue of incomplete data using CIR. We must first define the variables that are subject to the CAR and the unknown IP. With respect to feature variables, we assume that the generic variable Fi (i = 1, . . . , N + 1) is equal to the pair (F\u0304i, F\u0302i), with the usual meaning of the symbols. Define the vectors Y\u0304 and Y\u0302 as Y\u0304 := (C1, F\u03041, . . . , CN , F\u0304N , F\u0304N+1), Y\u0302 := (F\u03021, . . . , F\u0302N , F\u0302N+1). To make things more readable, we also define Y\u0304i := (Ci, F\u0304i), Y\u0302i := F\u0302i, for all i = 1, . . . , N ; and Y\u0304N+1 := F\u0304N+1, Y\u0302N+1 := F\u0302N+1.\nThere is obviously arbitrariness in the above definitions of the vectors Y\u0304 and Y\u0302 , and it might well be the case that some applications require different choices. The present definitions are only done for illustrative purposes.\nWith the above definitions, CIR leads to the following rule to update beliefs about g:\nR(g|w\u0304, w\u0302) = min(y\u03041,...,y\u0304N+1)\u2208{w\u0304}\u22171 infP\u2265P 1:P (y\u03041,...,y\u0304N+1,{w\u03021}\u2217,...,{w\u0302N+1}\u2217)>0 P (g|y\u03041, . . . , y\u0304N+1, {w\u03021}\u2217, . . . , {w\u0302N+1}\u2217). (7)\nCorollary 5 proves that this rule leads to self-consistent inference. Equation (7) states that one should consider (i) the set of possible completions of the part of the observed sample originated by the unknown IP, \u00d7Ni=1{w\u0304i}\u22171; (ii) the set of possible completions of the part of the unit to classify originated by the unknown IP, {w\u0304N+1}\u22171; and (iii) the set of (possible) precise priors, which are those dominating our prior lower prevision P 1(\u0398). For each of the above choices, the problem becomes the computation of the posterior expectation of g as in a single Bayesian (i.e., precise-probability) classifier. When we consider all the possible choices in (i)\u2013(iii) above, working with (7) amounts to work with a set of Bayesian classifiers. The set of posterior expectations originated by the Bayesian classifiers is summarised in (7) as a lower expectation.\nWe can look at the problem also from another point of view. Imprecision that produces the lower expectation (7) can be regarded as originated by three components. The first is the presence of multiple priors. The second is the presence of multiple likelihoods, each of which is consistent with a certain completion of the part of the sample originated by the unknown IP. The third component is the set-valued observation of the part F\u0304N+1 of the features of the unit to classify, which we can regard as an imprecise description of the object to classify."}, {"heading": "5.3.1 An Example", "text": "Let us focus again on the initial example in Section 5.3 in which we were interested in classifying people as either smokers or nonsmokers. To make things easier, we take gc\u2032 to be the 0-1 loss function, i.e., we compute posterior probabilities rather than expectations in order to issue a classification. Moreover, we take the graph of the Asia net to represent the probabilistic dependencies between the variables involved (yet, we do not assume the net parameters to be given, as learning the parameters from data is part of the inferential task of classification that we have to solve). To make the example more handy, we assume that for all the people we want to classify we miss information about the variables V , B, O, L and A in the Asia net, and that this missingness is MAR: that is, these variables constitute F\u0302N+1. This implies, through (7), that we can actually discard variables V , B, O, L and A from consideration: we can equivalently work out our inference task by relying only on a learning set for the variables K, R and H alone. This holds because working\nwith (7) amounts to work with a set of Bayesian classifiers, and the above property holds for each of them.13 As a consequence, it turns out that the only portion of the Asia net which is relevant for the classification is that displayed in Figure 2. Such a structure, with\nthe feature variables represented as disconnected children of the class variable is called a naive network. When we use it as a precise-probability classifier, it is best known as naive Bayes classifier (Duda & Hart, 1973).\nSay that our learning set, originated by an IID process, is the following:\nd\u0304 :=  (r\u2032, h\u2032\u2032, k\u2032) (r\u2032, h\u2032\u2032, k\u2032) (r\u2032, h\u2032, k\u2032) (r\u2032, h\u2032, k\u2032) (r\u2032\u2032, h\u2032, k\u2032) (r\u2032\u2032, h\u2032, k\u2032\u2032) (r\u2032\u2032, h\u2032, k\u2032\u2032) (r\u2032\u2032, h\u2032\u2032, k\u2032\u2032) (r\u2032\u2032, h\u2032\u2032, k\u2032\u2032) (r\u2032, h\u2032\u2032, k\u2032\u2032)  .\nThis data set is characterised by a strong positive relationship between smoking and cancer and a weak positive relationship between smoking and bronchitis. Learning naive Bayes from d\u0304 and applying the model to the four joint instances of the feature variables, we obtain the following predictions: \n(r\u2032, h\u2032, k\u2032) (r\u2032, h\u2032\u2032, k\u2032) (r\u2032\u2032, h\u2032, k\u2032\u2032) (r\u2032\u2032, h\u2032\u2032, k\u2032\u2032)  , (8) where we have used Perks\u2019 prior for naive Bayes14 in the above experiments. If we replace such a prior with an imprecise one, we obtain an extension of naive Bayes to imprecise\n13. A proof in relationship with a specific classifier can be found in the work by Corani and Zaffalon (2008, Section 3.1.2). 14. Modified as described by Zaffalon (2001, Section 5.2) (refer to Perks\u2019 prior defined \u2018in analogy with the IDM\u2019 in that section) to make the comparison easier.\nprobability. If we moreover define such a prior P 1(\u0398) so as to model a state of prior ignorance, similarly to what we have done in the case of parametric inference, we obtain an imprecise-probability classifier that is an instance of the so-called naive credal classifier 2 (or NCC2, see Corani & Zaffalon, 2008). We can reinterpret NCC2 as a set of naive Bayes classifiers. In the present case, we have a classifier per each precise prior consistent with (i.e., dominating) the imprecise one.\nThe way NCC2 issues a classification on a specific instance of R andH can be understood easily in terms of the set of naive Bayes classifiers to which it corresponds: the classification of NCC2 is the union of the classes issued by all the naive Bayes classifiers in the set.15 This means that if all the naive Bayes classifiers issue the same class, then the classification of NCC2 is determinate, i.e., made of a single class. Otherwise, when there is disagreement among the naive Bayes classifiers, then NCC2 issues the entire set K, i.e., an indeterminate classification.16\nIf we infer NCC2 from the learning set d\u0304, we obtain again the determinate predictions reported in (8):17 this means that the information in the data is strong enough to smooth the contribution of each precise prior used by NCC2 in favor of a single class.\nWe can move to more interesting examples by introducing missing values. Consider the following two instances to classify that are missing the information about cancer:[\n(?, h\u2032) (?, h\u2032\u2032)\n] . (9)\nThe treatment of these instances will be very different from naive Bayes to NCC2. NCC2 can naturally embed our assumption that R and H are made missing by an unknown process, and deal with it by considering the two completions of the question mark in each instance. In other words, the classification of NCC2 will be not only, as before, equal to the union of the classes delivered by the equivalent set of naive Bayes classifiers, but the union will also be taken with respect to the two completions of the instance to classify. On the other hand, naive Bayes will have to assume MAR to deal with the incomplete instances, and this will lead it to discard R from the conditioning variables.\nThe classifications issued by naive Bayes and NCC2 are respectively:[ (?, h\u2032, k\u2032) (?, h\u2032\u2032, k\u2032\u2032) ] , [ (?, h\u2032,K) (?, h\u2032\u2032,K) ] .\nIn other words, for naive Bayes knowing the state of bronchitis is sufficient to determine whether a person is smoker or not, despite the weak relationship in the learning set between those two characteristics; NCC2 is more cautious and believes that it is not possible to determine the smoking state because it is missing, not necessarily in an ignorable way, the value of a very important predictor variable. On the other hand, it can be checked that if the missing variable is H instead of R, both naive Bayes and NCC2 agree that the\n15. This is the case because the class variable is binary. 16. This total indeterminacy is a consequence of the class variable being binary; in other cases the output set\nof classes can be any subset of classes, not only the least informative one. In these cases, the classification is only partially indeterminate, and carries therefore useful information. 17. The predictions of NCC2 can be computed by an open-source software freely available at the address http://www.idsia.ch/\u223cgiorgio/jncc2.html.\nprediction should be determinate: knowing that a person has cancer tells us that the person is a smoker, and vice versa.\nThe situation can become even more critical for naive Bayes if we use an incomplete learning set w\u0304d\u0304 := (w\u03041, . . . , w\u0304N ) rather than d\u0304, such as\nw\u0304d\u0304 :=  (r\u2032, h\u2032\u2032, k\u2032) (r\u2032, h\u2032\u2032, k\u2032) (r\u2032, ?, k\u2032) (r\u2032, ?, k\u2032) (r\u2032\u2032, ?, k\u2032)\n(r\u2032\u2032, h\u2032, k\u2032\u2032) (r\u2032\u2032, h\u2032, k\u2032\u2032) (r\u2032\u2032, ?, k\u2032\u2032) (r\u2032\u2032, ?, k\u2032\u2032) (r\u2032, ?, k\u2032\u2032)\n .\nWe have originated this data set from d\u0304 by turning some values of H into missing so that the complete portion of the data set suggests that H is a very good predictor for K. This is going to be a problem for naive Bayes, because it has still to deal with the incompleteness assuming MAR, which leads it to compute the counts from the learning set discarding the missing values. NCC2, on the other hand, implicitly considers all the complete data sets that are consistent with w\u0304d\u0304. Therefore in this case NCC2 can be regarded as the set of naive Bayes classifiers that are obtained by considering all the precise priors previously described in relationship with NCC2 and all the likelihoods that arise from the complete data sets consistent with w\u0304d\u0304.\nRunning both classifiers to predict the class of the units in (9), we obtain that naive Bayes predicts that the first person is not a smoker and that the second is, in both cases with posterior probability equal to 0.90 ! NCC2, more reasonably, outputs K in both cases, as a way to say that there is not information enough to make any reliable prediction. This example also points out that NCC2 correctly suspends the judgment even on instances on which precise models such as naive Bayes are actually very confident (for more details about this point, see Section 4.4 in the paper by Corani & Zaffalon, 2008)."}, {"heading": "5.3.2 On the Failure of Empirical Evaluations", "text": "Consider the question of the IID vs. the ID assumption for an IP, as discussed in Section 5.2.2, but placed here in the context of classification. To make things easier, we focus on finite possibility spaces, and assume in addition that the CAR IP is not present and that the classes are always observed precisely (i.e., as singletons).\nThe first interesting thing to note is the following. Recall that imposing the full IID assumption (i.e., IID both for the data-generating process and the IP) implies that the (set-valued) observations can be regarded as the outcomes of a multinomial process. This, together with the fact that the classes are always observed precisely, enables us to discard the Y -variables from consideration: they are not necessary because one can learn the relationship between the classes and the features directly by using the W -variables. To make this more clear, consider the case of incomplete samples originated by missing values. The\nfull IID assumption implies in this case that one is allowed to regard the symbol \u2018?\u2019 of missing value as a further possible value, and to proceed with the traditional learning methods for the case of complete samples. This shows that the full IID assumption in classification makes CIR collapse to the traditional updating rule, although applied to the W -variables. This makes things easier to deal with, and can thus be regarded as an advantage of the full IID assumption in classification. But we have already argued that the IID assumption for an IP is strong, and so we turn to consider the weaker ID assumption also for pattern classification, that we consider more tenable.\nLet us focus on a very simple classification setting where the complete data are generated in an IID way, and where the IP is ID. The problem is to predict the class of the unit to classify given its features and the previous units (1, . . . , N). As already mentioned in Section 5.3, this is usually done in the precise case by following a maximum expected utility approach. Call a model that acts in such a way a precise classifier.\nIt is common practice with precise classifiers to measure their accuracy empirically. In its simplest form, this is obtained by randomly splitting the available data into a learning and a test set, by inferring the classifier from the former and testing it on the latter. This simple, yet powerful, idea is responsible for much of the success and popularity of classification, as it enables one to be relatively confident about how well a classifier performs on previously unseen data. Unfortunately, this key characteristic is lost when we cannot assume that the unknown IP is IID.\nTo see why, consider (for all i = 1, . . . , N + 1) a Boolean class variable Ci and two Boolean feature variables Ai and Bi, such that Fi = F\u0304i = (Ai, Bi). Assume that the class is the result of the exclusive logical disjunction of the two attributes: i.e., the class equals one if and only if either the first or the second attribute equals one, but not both. Assume that the complete data are eventually turned into incomplete data by an (unknown) IP whose only action is to make Bi missing if and only if (Ai, Bi) = (1, 0), for all i. Let WAi and WBi be the observation variables for Ai and Bi, respectively. The IP is then characterised by P (WBi =?|Ai = 1, Bi = 0) = 1, so that observing the pattern (WAi = 1,WBi =?) implies Ci = 1 with certainty. In these conditions, any precise classifier is clearly expected to learn that BN+1 being missing is irrelevant to predict CN+1, whose value coincides with the value of AN+1. Since this is true for all the available data, partitioning them into learning and test set will do nothing but confirm it: the prediction accuracy on the pattern (WAN+1 = 1,WBN+1 =?) will be perfect, i.e., 100%. But the IP is not identically distributed, and it happens that when the classifier is put to work in an operative environment, the IP changes, in particular by making Bi missing if and only if (Ai, Bi) = (1, 1); or, in other words: P (WBi =?|Ai = 1, Bi = 1) = 1. Once put to work in practice, the classifier will be always wrong on the pattern (WAN+1 = 1,WBN+1 =?), the prediction accuracy dropping to 0%.\nOf course the example is designed so as to illustrate an extreme situation. However, experiments on real data sets done without using such an extreme unknown IP, as reported by Corani and Zaffalon (2008, Section 4.6), show that this phenomenon can indeed severely bias the empirical measures of performance. This appears to point to a fact: that empirical evaluations are doomed to failure in general when the data are made incomplete by a nonIID unknown process.\nThese considerations may have profound implications for classification, and more generally for data analysis. These fields of scientific research rest on two fundamental pillars: (i) that the assumptions made to develop a certain model (e.g., a classifier) are tenable; and (ii) that empirical evaluations are reliable. The crucial point is that both pillars may be very fragile with incomplete data, so being unable to sustain credible models and conclusions.\nThe way left to cope with such critical issues seems necessarily to rely on doing tenable assumptions. This involves recognising that the incompleteness process may not be IID."}, {"heading": "6. Advanced Notions about Coherent Lower Previsions", "text": "We introduce some advanced notions about coherent lower previsions that we need in the rest of the paper, and in particular for the derivation of CIR in Section 7."}, {"heading": "6.1 Coherence of a Number of Conditional Lower Previsions", "text": "Reconsider the setup introduced in Section 2 made of variables X1, . . . , Xn about which a subject expresses beliefs. In practice, he can provide assessments for any disjoint subsets O, I of {1, . . . , n}; it is thus not uncommon to model a subject\u2019s beliefs using a finite number of different conditional lower previsions. Formally, we are going to consider what we shall call collections of conditional lower previsions.\nDefinition 9 Let P 1(XO1 |XI1), . . . , Pm(XOm |XIm) be conditional lower previsions with respective domains K1, . . . ,Km \u2286 L(X n), where Kj is the set of XOj\u222aIj -measurable gambles,18 for j = 1, . . . ,m. This is called a collection on X n when for each j1 6= j2 in {1, . . . ,m}, either Oj1 6= Oj2 or Ij1 6= Ij2. This means that we do not have two different conditional lower previsions giving information about the same set of variables XO, conditional on the same set of variables XI .\nEven if all the conditional lower previsions in a collection are separately coherent, they do not need to be coherent with one another, so that a collection could still express inconsistent beliefs. To be able to model this joint coherence, we first introduce some new concepts. Remember that we use IA to denote the indicator function of the set A, i.e., the function whose value is 1 for the elements of A and 0 elsewhere.\nDefinition 10 For all gambles f in the domain KO\u222aI of the conditional lower prevision P (XO|XI), and all x \u2208 XI , we shall denote by G(f |x) the gamble that takes the value I\u03c0\u22121I (x)(y)(f(y)\u2212P (f |x)) for all y \u2208 X n, and by G(f |XI) the gamble equal to \u2211 x\u2208XI G(f |x).\nThese are (almost-)desirable gambles for our subject: under the behavioural interpretation of P (f |x) as the supremum acceptable buying price for f contingent on x, the gamble G(f |x)+ I\u03c0\u22121I (x) is equivalent to buying f for the price P (f |x)\u2212 , provided that XI = x, and is therefore desirable. Since this happens for arbitrarily small, we deduce that the transaction G(f |x) is almost-desirable. That G(f |XI) = \u2211 x\u2208XI G(f |x) is also almost-desirable follows from the rationality principle that a sum of gambles which are almost-desirable for our subject should also be almost-desirable.19\n18. We use Kj instead of KOj\u222aIj in order to alleviate the notation when no confusion is possible about which variables are involved. 19. In the case of an infinite XI we need to add another rationality principle (Walley, 1991, Sect. 6.3.3).\nDefinition 11 The XI-support S(f) of a gamble f in KO\u222aI is given by\nS(f) := {\u03c0\u22121I (x) : x \u2208 XI , fI\u03c0\u22121I (x) 6= 0}, (10)\ni.e., it is the set of conditioning events for which the restriction of f is not identically zero.\nDefinition 12 Let P 1(XO1 |XI1), . . . , Pm(XOm |XIm) be separately coherent. They are coherent when for all fj \u2208 Kj, j = 1, . . . ,m, j0 \u2208 {1, . . . ,m}, f0 \u2208 Kj0 , z0 \u2208 XIj0 , there is some B \u2208 {\u03c0\u22121Ij0 (z0)} \u222a \u222a m j=1Sj(fj) such that\nsup x\u2208B  m\u2211 j=1 Gj(fj |XIj )\u2212Gj0(f0|z0)  (x) \u2265 0, where Sj(fj) is the XIj -support of fj, as defined by Equation (10).\nWe restrict the supremum to a subset of X n because a gamble f \u2264 0 such that f < 0 on some subset A of X n should not be desirable for our subject.\nThe notion in Definition 12 is sometimes also called joint (or strong) coherence. It is the strongest notion of self-consistency in Walley\u2019s theory, and can be regarded as the unique axiom of such a theory. The intuition behind this notion is that we should not be able to raise the conditional lower prevision for a gamble taking into account the acceptable transactions implicit in the other conditional previsions. Let us make this clearer. Assume Definition 12 fails, and that there is some \u03b4 > 0 such that m\u2211\nj=1\nGj(fj |XIj )\u2212Gj0(f0|z0)  (x) \u2264 \u2212\u03b4 < 0, (11) for every x in B \u2208 {\u03c0\u22121Ij0 (z0)} \u222a \u222a m j=1Sj(fj). As a consequence,\nGj0(f0|z0)\u2212 \u03b4Iz0 = Iz0(f0 \u2212 (P j0(f0|z0) + \u03b4)) \u2265 m\u2211 j=1 Gj(fj |XIj ),\ntaking into account that the inequality holds trivially on the elements outside {\u03c0\u22121Ij0 (z0)} \u222a \u222amj=1Sj(fj), and that on this class it is a consequence of Equation (11). But since the righthand side is a sum of almost-desirable gambles, this means that the left-hand side should also be almost-desirable. This means that any price strictly smaller than P j0(f0|z0) + \u03b4 should be an acceptable buying price for the gamble f0, conditional on z0. This contradicts the interpretation of P j0(f0|z0) as the supremum acceptable buying price.\nExample 4 (Walley, 1991, Example 7.3.5) Let X1, X2 be two random variables taking values in X1 = X2 = {1, 2, 3}, and assume that we make the somewhat contradictory assessments X1 = 1 \u21d2 X2 = 1, X1 = 2 \u21d2 X2 = 2, X2 = 1 \u21d2 X1 = 2, X2 = 2 \u21d2 X1 = 1 and X1 = 3 \u21d4 X2 = 3. These assessments can be modelled by the conditional previsions P (X1|X2) and P (X2|X1) given by\nP (f |X2 = 1) = f(2, 1), P (f |X2 = 2) = f(1, 2), P (f |X2 = 3) = f(3, 3) P (f |X1 = 1) = f(1, 1), P (f |X1 = 2) = f(2, 2), P (f |X1 = 3) = f(3, 3)\nfor any gamble f on X1 \u00d7 X2. To see that they are not coherent, consider the gambles f1 = I{(1,2),(2,1)}, f2 = I{(1,1),(2,2)}, f3 = 0. It follows from Equation (10) that S1(f2) = {{1} \u00d7 X2, {2} \u00d7 X2} and S2(f1) = {X1 \u00d7 {1},X1 \u00d7 {2}}. Then\nG(f1|X2) +G(f2|X1)\u2212G(f3|X1 = 1) = G(f1|X2) +G(f2|X1) < 0\non the set {(x1, x2) \u2208 B for some B \u2208 S1(f2) \u222a S2(f1) \u222a {\u03c0\u221211 (1)}} = X1 \u00d7X2 \\ {(3, 3)}. \u2666"}, {"heading": "6.2 Coherence Graphs", "text": "A collection of lower previsions can be given a graphical representation that we call a coherence graph (Miranda & Zaffalon, 2009). A coherence graph is a directed graph made of two types of nodes: actual and dummy nodes. Dummy nodes are in one-to-one correspondence with the lower previsions in the collection; actual nodes represent the variables X1, . . . , Xn.\nFigure 3 shows the coherence graph for the conditional distributions owned by the nodes of the Asia network which we represent as lower previsions, i.e., P 1(V ), P 2(K), P 3(B|V ), P 4(R|K), P 5(H|K), P 6(O|B,R), P 7(L|O), P 8(A|O,H). In order to avoid confusion, we stress that a coherence graph can be built out of any set of lower previsions, not just those arising from graphical models. We use the Asia network here only for illustrative purposes. Moreover, in building the coherence graph from the Asia net, we completely disregard any independence information coded by the net, and we focus only on the list of conditional distributions. Also, the coherence graph is the same irrespective of whether the conditional assessments are linear or not.\nWe adopt some conventions to display a coherence graph: we denote actual nodes with the same letter of the corresponding variable; dummy nodes are instead denoted by black solid circles and are not labelled. Finally, for a dummy node with both a single parent and a single child, we do not show the arrow entering the node, so as to make the graph simpler to see.\nA collection of lower previsions is turned into a coherence graph by turning each of its lower previsions into a subgraph called a D-structure: a directed graph consisting of a dummy node, its directed predecessors (i.e., its parents) and successors (i.e., its children),\nand the arcs connecting the dummy node to its parents and children. The parents of the dummy node are the actual nodes corresponding to the variables on the right-hand side of the conditioning bar of the prevision related to the dummy node. The children are the actual nodes corresponding to the variables on the left-hand side of the conditioning bar. For example, the D-structure for P 1(V ) is the subgraph in Figure 3 consisting of V , its dummy parent, and the arc connecting them; the D-structure for P 6(O|B,R) is the subgraph consisting of the actual nodes B, R, O, the dummy that is child of the first two and parent of the last one, and the three arcs connecting them.\nIn order to distinguish a coherence graph from other graphical models such as Bayesian nets, note that in a coherence graph we cannot deduce independence between nodes in the graph: for instance, in Figure 3 we cannot conclude that the variables L,A are independent given O,H. The reason is that we can have instances of conditional previsions with this very same coherence graph for which the variables L and A are dependent.\nCoherence graphs can have different forms, and each of these forms has some implication on the coherence of the related collection of lower previsions. In this paper we focus on coherence graphs called of type A1+: these coherence graphs are acyclic and have the property that each actual node in the graph has exactly one parent. This is indeed the case of the graph in Figure 3. A more general class of graphs is A1 graphs, which is defined similarly to the A1+ case but with the difference that each actual node in the graph is required to have at most one parent.\nWhen a coherence graph is of type A1+ (resp. A1), we say that the related collection of lower prevision is A1+-representable (resp. A1-representable). A1-representable collections are interesting because the separate coherence of the lower previsions in the collection is equivalent to their joint coherence, as shown by Miranda and Zaffalon (2009, Proposition 4). This means that A1-representable collections are known to be coherent irrespective of the numbers that make up their lower previsions, provided that they give rise to separately coherent lower previsions."}, {"heading": "6.3 Updating Coherent Lower Previsions", "text": "One updating rule that can be used with lower previsions is the regular extension:\nDefinition 13 Let P be a coherent lower prevision, f \u2208 KO\u222aI and x \u2208 XI an element for which P (x) > 0, where P is the conjugate upper prevision derived from P . The regular extension R(f |x) is R(f |x) := inf { P (fIx) P (x) : P \u2208M(P ), P (x) > 0 } .\nRecall thatM(P ) is the set of linear previsions P with domain L(X n) that dominate P . When XI is finite and P (x) > 0 for all x \u2208 XI , the conditional lower prevision R(XO|XI) defined by regular extension is coherent with P . The definition shows that the regular extension also has a nice sensitivity analysis interpretation: i.e., applying Bayes rule to the dominating linear previsions whenever possible. Perhaps for this reason, the regular extension has been proposed and used a number of times in the literature as an updating rule (e.g., De Campos, Lamata, & Moral, 1990; De Cooman & Zaffalon, 2004; Fagin & Halpern, 1991; Jaffray, 1992; Walley, 1981, 1991, 1996b).\nExample 5 Assume we know that a coin is loaded, in the sense that it either always lands on heads or on tails, but we do not know on which. Let Xi be the outcome of a throw for\ni = 1, 2. Our beliefs about (X1, X2) may be modelled by the vacuous lower prevision P on {(heads, heads), (tails, tails)}. If we apply regular extension to define R(X2|X1), we obtain\nR(X2 = heads|X1 = heads) = 1, R(X2 = tails|X1 = tails) = 1,\ntaking into account that P (heads, heads) + P (tails, tails) = 1 for any linear prevision P \u2208 M(P ). \u2666"}, {"heading": "6.4 Products of Conditional Lower Previsions", "text": "We shall later use a generalisation of the marginal extension theorem (Walley, 1991, Theorem 6.7.2) established by Miranda and De Cooman (2007).\nDefinition 14 Let P 1(XO1), P 2(XO2 |XI2), . . . , Pm(XOm |XIm) be separately coherent conditional lower previsions with respective domains K1, . . . ,Km, where I1 = \u2205 and Ij = \u222aj\u22121i=1 (Ii \u222a Oi) = Ij\u22121 \u222a Oj\u22121 for j = 2, . . . ,m. Their marginal extension to L(X n) is given by\nP (f) = P 1(P 2(. . . (Pm(f |XIm)| . . . )|XI2)),\nand it is the smallest unconditional coherent lower prevision which is (jointly) coherent with P 1(XO1), P 2(XO2 |XI2), P 3(XO3 |XI3), . . . , Pm(XOm |XIm).\nTo see that the above definition makes sense, note that for any gamble f on X n, Pm(f |XIm) is a gamble on XIm , and hence belongs to the domain of Pm\u22121(XOm\u22121 |XIm\u22121); then Pm\u22121(Pm(f |XIm)|XIm\u22121) is a gamble on XIm\u22121 which belongs therefore to the domain of Pm\u22122(XOm\u22122 |XIm\u22122); and by repeating the argument, P 2(. . . (Pm(f |XIm)| . . . )|XI2) is a gamble on XI2 = XO1 which belongs to the domain of the unconditional prevision P 1.\nThe idea behind the construction of the marginal extension is that, when we have hierarchical information, the way to combine it into a joint prevision is to follow the order in which this information is structured. It reduces, for instance, to the law of total probability in the case of linear previsions and finite spaces. But it is applicable in more general situations: when we combine a finite number of previsions, and not only two of them; when we are dealing with infinite spaces; and when we have lower previsions instead of linear ones.\nWe give next a notion of conditional independence for coherent lower previsions that we shall use in the following.\nDefinition 15 Consider three variables, Xi, Xj , Xk, and a coherent conditional lower prevision P (Xi, Xj |Xk). Xi and Xj are strongly independent conditional on Xk if Xi and Xj are stochastically independent given Xk for all the extreme points of M(P (Xi, Xj |xk)) and for all xk \u2208 Xk.\nThe previous definition allows joint beliefs to be created out of marginal ones, as it is common with independence in precise probability: consider the coherent conditional lower previsions P i(Xi|Xk) and P j(Xj |Xk). We build their so-called strong product P sp(Xi, Xj |Xk),\ni.e., the least-committal lower prevision that follows from them and the assumption of strong independence, as the lower envelope of the following set:\nMsp := {P (Xi, Xj |Xk) := Pi(Pj(Xj |Xi, Xk)|Xk) s.t.\u2200xk \u2208 Xk, Pi(Xi|xk) \u2208 ext(M(P i(Xi|xk))), P (Xj |xk) \u2208 ext(M(P j(Xj |xk)), and \u2200xi \u2208 Xi, Pj(Xj |xi, xk) := P (Xj |xk)},\nwhere Pj(Xj |Xi, Xk) is defined using stochastic independence, and the linear prevision P (Xi, Xj |Xk) is obtained by applying the marginal extension theorem.\nStrong independence is a relatively straightforward generalisation of stochastic independence to imprecision. It is also a notion that can immediately be given a sensitivity analysis interpretation: since for every xk \u2208 Xk each extreme point of M(P sp(Xi, Xj |xk)) satisfies stochastic independence, we can interpret P sp(Xi, Xj |Xk) as a model arising from partial knowledge of an underlying linear prevision P (Xi, Xj |Xk) which is known to satisfy stochastic independence. In other words, P sp(Xi, Xj |Xk) could be regarded as obtained by listing a number of candidate linear previsions P (Xi, Xj |Xk), each of which satisfies stochastic independence, and by taking their lower envelope.\nIt should also be remarked that in the imprecise case, where we work with sets of probabilities or previsions, there is not a unique extension of the notion of stochastic independence of probability measures (see Campos & Moral, 1995; Couso et al., 2000; or Miranda, 2008, Section 4). The notion we have just considered is the strongest, and therefore more informative, of the possibilities considered in the references above.20\nA notion alternative to strong independence is for instance epistemic irrelevance as proposed by Walley (1991, Section 9.1.1).\nDefinition 16 Given the coherent lower previsions P i(Xi|Xj , Xk) and P i(Xi|Xk), we say that Xj is epistemically irrelevant to Xi conditional on Xk if it holds that P i(Xi|Xj , Xk) = P i(Xi|Xk).\nEpistemic irrelevance is naturally suited for a behavioural interpretation: Xj is irrelevant to Xi given Xk because in the context of Xk the beliefs of a subject about Xi, expressed by the coherent lower prevision P i(Xi|Xk), do not change after getting to know the value of Xj . A sensitivity analysis interpretation of epistemic irrelevance is not possible in general because for a joint created out of marginal information and epistemic irrelevance, the related extreme points do not necessarily satisfy stochastic independence. In fact, strong independence implies epistemic irrelevance while the converse implication does not hold. Moreover, irrelevance is an asymmetric notion: knowing that Xj is irrelevant to Xi does not imply that Xi is irrelevant to Xj . One can create a symmetric notion of epistemic independence (see, e.g., Walley, 1991; Miranda, 2008) by requiring that both Xj is irrelevant to Xi and Xi is irrelevant to Xj ; still, strong independence implies epistemic independence but the other way around does not hold.\nStrong independence can be expressed by means of epistemic irrelevance together with a further requirement. Consider P i(Xi|Xk) and P j(Xj |Xk); we want to create their strong\n20. This is related to the fact that it never holds that all the precise previsions in a convex set with more than one element satisfy stochastic independence; therefore requiring it for the extreme points of the credal set, which are the ones keeping all the behavioural information, amounts to go as far as possible on the direction to independence.\nproduct using epistemic irrelevance. We first write that P j(Xj |Xi, Xk) = P j(Xj |Xk), as strong independence implies epistemic irrelevance. Then we apply the marginal extension theorem to create the so-called irrelevant product P ip(Xi, Xj |Xk) = P i(P j(Xj |Xi, Xk)|Xk), which is the least committal lower prevision that follows from the marginals and the assumption of epistemic irrelevance. In terms of the sets of dominating linear previsions, the marginal extension theorem states that P ip(Xi, Xj |Xk) is the lower envelope of the set\nMip := {P (Xi, Xj |Xk) = Pi(Pj(Xj |Xi, Xk)|Xk) : \u2200xi \u2208 Xi, xk \u2208 Xk, Pi(Xi|xk) \u2208 ext(M(P i(Xi|xk))), Pj(Xj |xi, xk) \u2208 ext(M(P j(Xj |xi, xk)))}.\nEven if for all xk \u2208 Xk the sets ext(M(P j(Xj |xi, xk))), xi \u2208 Xi, are identical to one another because of the irrelevance condition, when building a joint prevision P (Xi, Xj |Xk) we are not forced to choose the same extreme point in each of them. This is just what makes the difference between Mip and Msp, and in fact we can write Msp in a way more similar to Mip as follows:\nMsp := {P (Xi, Xj |Xk) = Pi(Pj(Xj |Xi, Xk)|Xk) : \u2200xi \u2208 Xi, xk \u2208 Xk, Pi(Xi|xk) \u2208 ext(M(P i(Xi|xk))), Pj(Xj |xi, xk) \u2208 ext(M(P j(Xj |xi, xk))) s.t. Pj(Xj |x\u2032i, xk) = Pj(Xj |x\u2032\u2032i , xk) if x\u2032i = x\u2032\u2032i }.\nIn other words, we can think of the strong product as obtained by the same procedure that we use for the irrelevant product, with the additional requirement that for each xk \u2208 Xk, the extreme points chosen in ext(M(P j(Xj |xi, xk))), xi \u2208 Xi, must coincide every time. We shall use this observation in Section 7.1.3."}, {"heading": "7. Derivation of CIR", "text": "In the next sections we state a number of assumptions, discuss them, and eventually use them to derive CIR."}, {"heading": "7.1 Modelling Beliefs", "text": "Our aim in this section is to represent our beliefs about the vector (Z, Y,W ). We intend to model beliefs using coherent lower previsions. We refer to Sections 2 and 6 and, more generally, to the book by Walley (1991) for the concepts and results we shall need.\nA way to represent beliefs about (Z, Y,W ) is through a coherent lower prevision on L(Z\u00d7 Y\u00d7W), representing our joint beliefs about these variables. But, as with precise probability, it is often easier to build joint models out of the composition of simpler conditional and unconditional models. We shall therefore start by focusing on the following lower previsions, which we illustrate for clarity by a coherence graph in Figure 4:\n(LP1) A coherent lower prevision, denoted by P 1, on the set of XZ,Y -measurable gambles;\n(LP2) A separately coherent conditional lower prevision P 2(W\u0304 |Z, Y ) on the set of XZ,Y,W\u0304 - measurable gambles, modelling our beliefs about W\u0304 given the value (z, y) taken by (Z, Y ).\n(LP3) A conditional lower prevision P 3(W\u0302 |Z, Y, W\u0304 ) on L(Z \u00d7 Y \u00d7 W), representing our beliefs about W\u0302 given the value that (Z, Y, W\u0304 ) takes.\nThe coherent lower prevision P 1 is intended to express our beliefs about the domain of interest, which is modeled by the variables Z and Y . In other words, by P 1 we express our beliefs about facts. The conditional lower prevision P 2(W\u0304 |Z, Y ) is concerned with our beliefs about the unknown incompleteness process. Finally, by the conditional lower prevision P 3(W\u0302 |Z, Y, W\u0304 ) we express our beliefs about the CAR incompleteness process. How exactly this is done is detailed in the next sections. For the moment, we are going to build a joint coherent lower prevision for (Z, Y,W ) out of the lower previsions listed in (LP1)\u2013(LP3). This is done by the marginal extension theorem introduced in Section 6.4.\nIn the present case, the generalised marginal extension theorem states that the lower prevision P given by\nP (f) = P 1(P 2(P 3(f |Z, Y, W\u0304 )|Z, Y ))\nfor all gambles f on Z \u00d7 Y \u00d7 W is the smallest (using the point-wise ordering of lower previsions) coherent lower prevision on L(Z \u00d7 Y \u00d7 W) that is jointly coherent with the lower previsions listed in (LP1)\u2013(LP3). This implies, for example, that P coincides with the coherent lower prevision P 1 on its domain. Because it is the smallest lower prevision to be coherent with our assessments, P captures the behavioural implications present in P 1, P 2(W\u0304 |Z, Y ) and P 3(W\u0302 |Z, Y, W\u0304 ), without making any additional assumptions; we shall therefore use it as the model of our beliefs about the vector (Z, Y,W ).\nP is also the lower envelope of the closed and convex set M(P ) of dominating linear previsions. It will be useful for the purposes of this paper to construct this set explicitly. Consider the set\nM\u2032 := { P : P (g) = P1(hg), hg(z, y) :=\n\u2211 w g(z, y, w)P2(w\u0304|z, y)P3(w\u0302|z, y, w\u0304)\n} , (12)\nfor all g \u2208 L(Z,Y,W), where P1 \u2208 ext(M(P 1)), P2(W\u0304 |z, y) \u2208 ext(M(P 2(W\u0304 |z, y))) and P3(W\u0302 |z, y, w\u0304) \u2208 ext(M(P 3(W\u0302 |z, y, w\u0304))) for any (z, y, w) \u2208 Z \u00d7 Y \u00d7 W. Then M(P ) = CH(M\u2032), where the operator CH(\u00b7) stands for convex closure. As a consequence, P can be calculated as the lower envelope of the class M\u2032."}, {"heading": "7.1.1 Domain Beliefs", "text": "Consider variables Z and Y , which represent facts. Beliefs about facts, in the form of a coherent lower prevision P 1, are specific of the domain under consideration; for this reason, we call them domain beliefs. In the case of the Asia network, P 1 would correspond simply to the joint mass function coded by the network itself.\nWe shall impose only a minimal assumption about domain beliefs, just because P 1 must be as flexible a tool as possible in order to express beliefs in a wide range of domains. This task will be postponed after focusing on a very different kind of beliefs, which we call beliefs about the incompleteness process."}, {"heading": "7.1.2 Beliefs about the Incompleteness Process", "text": "These are naturally of a conditional type: they formalise what we believe about the \u2018modus operandi\u2019 of the overall IP, i.e., the procedure by which it turns facts into observations. We represent these beliefs through assumptions to be satisfied by the conditional lower prevision P 2(W\u0304 |Z, Y ), related to the unknown IP, and P 3(W\u0302 |Z, Y, W\u0304 ), related to the CAR IP. We start with the unknown IP.\nThe unknown IP has been introduced to formalise the idea of an incompleteness process about which we are nearly ignorant. The term \u2018nearly\u2019 is there to emphasise that, despite a deep kind of ignorance, something is assumed to be known about the unknown IP. For one thing, it produces incompleteness only on the basis of Y\u0304 . More formally, we assume that there is a separately coherent conditional lower prevision P 2(W\u0304 |Y\u0304 ) such that\nP 2(f |z, y) = P 2(f |y\u0304) (BIP1)\nfor all XW\u0304 ,Y,Z-measurable gambles f and any (z, y) in (Z,Y). (BIP1) states that observing different values for Z and Y\u0302 does not change our beliefs about W\u0304 , once we know what value Y\u0304 takes in Y\u0304. This assumption turns the coherence graph in Figure 4 into that of Figure 5. Assumption (BIP1) arises somewhat naturally within our interpretation of IPs as observational processes, in which we regard the unknown IP just as a process that takes Y\u0304 in input and outputs W\u0304 . Still, it is an important assumption for the following developments, and is therefore discussed in some detail in Section 7.2.\nThe second thing that we assume about the unknown IP is related to the perfection of the multi-valued map \u0393Y\u0304 : 21\ny\u0304 \u2208 Y\u0304 \u21d2 P 2(\u0393(y\u0304)c|y\u0304) = 0. (BIP2)\nIn other words, by this assumption we practically exclude the possibility that for some y\u0304 \u2208 Y\u0304, the unknown IP may lead to observations outside \u0393(y\u0304). Note that for this to be well defined, it is important to assume that \u0393(y\u0304) is nonempty as required by (IP4). Remember that, here and elsewhere, we use P to refer to the conjugate upper prevision of P ; see Remark 1 for more details.\nNothing more is assumed about the unknown IP. We are then led to introduce some assumptions about the CAR IP, of which the first two are analogous to (BIP1) and (BIP2), respectively. The first one is the existence of a separately coherent conditional lower prevision P 3(W\u0302 |Y\u0302 ) such that\nP 3(f |z, y, w\u0304) = P 3(f |y\u0302) (BIP3)\nfor all XW,Y,Z-measurable gambles f and (z, y, w\u0304) in (Z,Y, W\u0304). This assumption turns the coherence graph in Figure 5 into that of Figure 6.\nThe second is an assumption of perfection of the multi-valued map \u0393Y\u0302 :\ny\u0302 \u2208 Y\u0302 \u21d2 P 3(\u0393(y\u0302)c|y\u0302) = 0. (BIP4)\nAgain, this assumption is made possible by (IP5). Now we assume something more substantial about the CAR IP. Indeed, the CAR IP has been introduced to model a process that produces incompleteness in a random fashion, that is to say, in a way that is not related to the underlying value that Y\u0302 takes in Y\u0302. We model this belief as follows:\nw\u0302 \u2208 W\u0302, y\u0302 \u2208 {w\u0302}\u2217 \u21d2 P 3(w\u0302|y\u0302) = P 3(w\u0302|y\u0302) = \u03b1w\u0302, (BIP5)\nwhere the \u03b1w\u0302\u2019s are positive constants that satisfy \u2211\nw\u0302\u2208\u0393(y\u0302) \u03b1w\u0302 = 1, where the restriction w\u0302 \u2208 \u0393(y\u0302) is justified by (BIP4).\nThis assumption is usually called coarsening at random (or CAR, see Gill et al., 1997). In the special case of missingness processes, one usually refers to CAR as missing at random (or MAR, see Little & Rubin, 1987). CAR/MAR is probably the most frequently imposed\n21. It could be argued that this assumption and the corresponding one for the CAR IP, that is, (BIP4), follow from the definition of the multi-valued maps. This nevertheless, we state the assumptions explicitly for clarity.\nassumption on IPs in the literature; it embodies the idea that an IP is non-selective (or non-malicious) in producing observations. Together with (BIP4), it makes the conditional prevision P 3(W\u0302 |Y\u0302 ) precise: i.e., our beliefs about the CAR IP are determinate (they are then the conditional expectation with respect to a probability distribution). An important point is that we must require explicitly that \u0393Y\u0302 be compatible with the CAR assumption (see Appendix A for details); this leads to an assumption about \u0393Y\u0302 other than those reported in Section 3.3: we assume that\n\u0393Y\u0302 leads through (BIP5) to an admissible system of linear constraints, (IP9)\nthat is, one that has a solution. Now that we have characterised the unknown and the CAR IPs, we have also to determine the way in which they interact to make up the overall IP; we do this by imposing an assumption of strong independence, as introduced in Section 6.4:\nW\u0304 and W\u0302 are strongly independent conditional on Y. (BIP6)\nThis assumption is discussed in Section 7.2.22"}, {"heading": "7.1.3 Joint Beliefs", "text": "In this section we aim at constructing the joint coherent lower prevision P mentioned at the beginning of Section 7.1. To do that, we need first to find explicit representations for the assessments related to the unknown and the CAR IP, on the basis of Assumptions (BIP1)\u2013 (BIP6). The joint will be constructed then using the marginal extension theorem mentioned at the beginning of the section, and taking into account the assumption of strong independence (BIP6).\nConsider the unknown IP. Assumption (BIP1) allows us to focus our attention on the conditional lower prevision P 2(W\u0304 |Y\u0304 ). Thanks to Assumption (BIP2), we know that for any y\u0304 in Y\u0304, P 2(W\u0304 |y\u0304) gives lower probability one to \u0393(y\u0304). Since we know nothing else, we take P 2(W\u0304 |y\u0304) to be the least-committal such lower prevision, i.e., the smallest separately coherent conditional lower prevision that assigns probability one to \u0393(y\u0304). Such a lower prevision is also called vacuous relative to \u0393(y\u0304), and is given by P 2(f |y\u0304) = min{f(w\u0304, y\u0304) : w\u0304 \u2208 \u0393(y\u0304)} for any XW\u0304 ,Y\u0304 -measurable gamble f .23\n22. There are similarities between the model developed in this section and the more traditional hidden Markov models (see for instance Rabiner, 1989). First, both focus on the distinction between the two levels of information, the latent and the manifest one, as discussed in the Introduction. For this reason both are concerned with an explicit representation of the observational process, which is what relates the W and the Y variables, and which in our case coincides with the incompleteness process. If we refer to Figure 6, to make things more concrete, we see that the W -variables are manifest and they depend directly only on the related hidden Y -variables. This is a common representation in hidden Markov models. Second, Assumption (BIP6) could be interpreted as a kind of Markovianity property. Yet, there are also differences: a major one is the two W -variables are not related to an order (such as a time order), and more generally that we are not explicitly representing any order in our model. Another is that we quantify the probabilistic information of an observation conditional on the related hidden variable by a set of conditional mass functions rather than a single one. This gives us more expressivity and is the key to model the unknown IP. 23. It follows from this that the implication in (BIP2) is actually an equivalence.\nUsing indicator functions, we can easily write the extreme points of M(P 2(W\u0304 |y\u0304)). Let I\u03b3\u0304 : W\u0304 \u2192 {0, 1} be the indicator function for \u03b3\u0304 \u2208 \u0393(y\u0304). We write I\u03b3\u0304 rather than I{\u03b3\u0304} to simplify notation. Then ext(M(P 2(W\u0304 |y\u0304))) = {I\u03b3\u0304 : \u03b3\u0304 \u2208 \u0393(y\u0304)}. This concludes the definition of P 2(W\u0304 |y\u0304) and also of P 2(W\u0304 |z, y), given that they coincide. Yet, when dealing with P 2(W\u0304 |z, y), we shall use a slightly different formulation: ext(M(P 2(W\u0304 |z, y)) = {I\u03b3\u0304(z,y) : \u03b3\u0304(z, y) \u2208 \u0393(y\u0304)}. The reason is that the extended notation \u03b3\u0304(z, y) allows us to know, in addition to the vertex, the value (z, y) on which we focus, and, consequently, that we focus on the specific lower prevision P 2(W\u0304 |z, y). Hence, we shall see \u03b3\u0304 as a mapping from Z \u00d7Y to W\u0304 such that for any (z, y), \u03b3\u0304(z, y) belongs to \u0393(y\u0304).\nThe situation is somewhat easier with the CAR IP. Similarly to the previous case, we know that we can restrict our attention to the conditional lower prevision P 3(W\u0302 |Y\u0302 ), thanks to (BIP3). But we also know that the conditional lower prevision P 3(W\u0302 |Y\u0302 ) is actually precise (we shall denote it by P3(W\u0302 |Y\u0302 ) from now on), and P3(W\u0302 |y\u0302) consists of the single mass function determined by Assumption (BIP5): i.e., the mass function that assigns probability P (w\u0302|y\u0302) = \u03b1w\u0302I{w\u0302}\u2217(y\u0302) to the generic element w\u0302 \u2208 W\u0302.\nAt this point we can define the coherent lower prevision P that models our beliefs about the value that (Z, Y,W ) assume jointly. We do this by rewriting Expression (12) according to the previous arguments and using in addition (BIP6):\nM\u2032 := {P : P (g) = P1(hg), hg(z, y) = \u2211\nw \u03b1w\u0302g(z, y, w)I\u03b3\u0304(z,y)(w\u0304)I{w\u0304}\u2217(y\u0304)I{w\u0302}\u2217(y\u0302), P1 \u2208 ext(M(P 1)), \u03b3\u0304(z, y) \u2208 \u0393(y\u0304) s.t. \u03b3\u0304(z, y) = \u03b3\u0304(z\u2032, y\u2032) if y\u0304 = y\u0304\u2032,\n(z, y, w) \u2208 Z \u00d7 Y \u00d7W}, (13)\nwhere we have introduced the new term I{w\u0304}\u2217(y\u0304). Such a term is actually redundant, and is introduced only because it is convenient for the next developments. To see that it is redundant, note that I{w\u0304}\u2217(y\u0304) = 0 implies that w\u0304 /\u2208 \u0393(y\u0304) and hence, since \u03b3\u0304(z, y) \u2208 \u0393(y\u0304) by definition, we have that I\u03b3\u0304(z,y)(w\u0304) = 0. The usage of (BIP6), on the other hand, leads to the more substantial introduction of the requirement that \u03b3\u0304(z, y) = \u03b3\u0304(z\u2032, y\u2032) when y\u0304 = y\u0304\u2032. This is needed to represent strong independence by means of epistemic irrelevance, as discussed at the end of Section 6.4. The lower envelope P of the setM\u2032 thus constructed is therefore called the strong product of the assessments P 1(Z, Y ), P 2(W\u0304 |Y\u0304 ), P3(W\u0302 |Y\u0302 ).\nThat the strong product is a coherent lower prevision, which is also coherent with P 1(Z, Y ), P 2(W\u0304 |Y\u0304 ), P3(W\u0302 |Y\u0302 ), follows from Corollary 1 in Appendix B. Importantly, this is also the case if the coherent lower prevision P 1(Z, Y ) is constructed in a modular way from smaller pieces of information (i.e., as a joint which is coherent with a number of smaller pieces of information), provided that the coherence graph representing them is A1+; such a situation is very often the case. It is the case, for instance, for all the the examples in Sections 5.1\u20135.3, as shown by Corollaries 3\u20135 in Appendix B."}, {"heading": "7.1.4 An Assumption about Domain Beliefs", "text": "Recall that we have introduced W as a way to model observations, and hence our beliefs should be consistent with the possibility of doing such an observation. To this extent, it seems necessary that we at least believe that {w}\u2217 can be produced:\nw \u2208 W \u21d2 P ({w}\u2217) > 0, (DB1)\ntaking into account that coherence implies that P ({w}\u2217) = P 1({w}\u2217). Assumption (DB1) is equivalent to the existence of an extreme point P1 ofM(P 1) such that P1({w}\u2217) > 0. The following proposition shows that this assumption is sufficient to make our beliefs consistent with the possibility to do the observation w.\nProposition 1 Assumption (DB1) implies that P (w) := P (Z,Y, w) > 0.\nProof. Let P1 be an extreme point of M(P 1) satisfying P1({w}\u2217) > 0, which exists by Equation (DB1), and take \u03b3\u0304(z, y) = w\u0304 for any y\u0304 \u2208 {w\u0304}\u2217. The joint P constructed from Equation (13) satisfies P (w) = \u03b1w\u0302P1({w}\u2217) > 0. Hence, P (w) > 0. 2"}, {"heading": "7.2 Assumptions Discussed", "text": "We now discuss (BIP1), (BIP5) and (BIP6) in more detail. The other assumptions are quite weak and relatively easy to accept. Assumptions (BIP2) and (BIP4) may be exceptions as it makes sense to consider IPs that are imperfect (or that can lie), but this is out of the scope of the present paper.\nWe start with Assumption (BIP5), i.e., CAR. CAR models a process that does not coarsen facts with a specific purpose. CAR excludes in this way many common and important processes. Consider the medical domain, for example, focusing on a diagnostic application. A fact in this case might describe information about a patient, such as gender, age, lifestyle, and also the results of medical tests. Conclusions would be made by the possible diseases. The IP in this case (at least part of it) often results from the interaction between the doctor and the patient; indeed, there is usually a systematic bias in reporting, and asking for, symptoms that are present instead of symptoms that are absent; and a bias to report, and ask for, urgent symptoms more than others (Peot & Shachter, 1998). Furthermore, a doctor typically prescribes only a subset of the possible diagnostic tests, according to personal views and cost/benefit criteria.24 Overall, the process described is non-CAR by definition, because the incompleteness arises following patterns that do depend on the specific facts under consideration.\nDescriptions such as the one above support the idea that CAR is strong by means of informal arguments. But also on the formal level, recent research has suggested that CAR should be assumed to hold less frequently that it appears to be in practice (Gru\u0308nwald & Halpern, 2003); and one should also remember that there is no way to test CAR statistically (Manski, 2003), so that there is always some degree of arbitrariness in assuming it. All of this should be taken into account in order to put CAR in a more balanced perspective. This is not to say that CAR should be rejected a priori, as there are situations when CAR is completely justified. Consider one notable example: the case when we know that Y\u0302 is missing with probability equal to one. In this case the related IP clearly satisfies MAR: the probability of missingness is one irrespective of the value of Y\u0302 . More broadly speaking, MAR holds for processes that produce missingness in an unintentional way. In these cases, not\n24. This seems to support the idea that we shall hardly get ever rid of incompleteness: often, incompleteness does not happen by mistake, rather, it is generated deliberately. In these cases it actually represents patterns of knowledge (indeed, one can often tell what disease a patient was, or was not, suspected to have by looking only at the medical tests that a doctor did, and did not, prescribe). In this sense, it seems that incompleteness is doomed to be deeply rooted to many, if not most, real problems; and as such, it appears to be a fundamental, and indissoluble, component of uncertain reasoning.\nassuming MAR would lead to results that are far too weak. The CAR IP in the modelling framework presented in Section 7.1.2 is designed just to account for these situations: i.e., to provide one with some flexibility in stating beliefs about the incompleteness process without having to adopt necessarily a worst-case approach (as opposed to the best case embodied by CAR/MAR), of the kind of the unknown IP.\nThe unknown IP is designed to model one\u2019s ignorance about an incompleteness process. It makes sense to adopt a conservative approach to model IPs in practice, for two specific reasons: first, IPs may be very difficult processes to model. They are a special case of observational processes, which often result from by human-to-human interaction, or by other complex factors; in a number of cases they can actually be regarded as the result of a communication protocol. The medical example above is intended to illustrate just this. It is not saying anything new: the difficulty in modelling IPs has been pointed out already long ago (Shafer, 1985; Gru\u0308nwald & Halpern, 2003). But IPs are difficult objects to handle also for a second reason: IP models can be tightly dependent on specific situations. Consider the medical example: again different doctors typically ask different questions to diagnose a disease, even in the same hospital. By changing hospital, one can find entirely different procedures to diagnose the same disease, as the procedures depend on the local culture, on the money available to make the tests, and which ones, or the local time constraints. In other words, even if one is able to model an IP for a specific situation, that model may no longer be appropriate when another doctor is in charge of doing the diagnosis, or when one tries to apply the IP model to another hospital, perhaps in another country. In summary, modelling the IP (especially in a precise way) may present serious practical difficulties, as, in contrast with domain beliefs (e.g., medical knowledge), the way information can be accessed may well depend on the particular environment where a system will be used; and this means that models of the IP may not be easily reusable, and may therefore be costly.\nThese arguments support considering a conservative approach to model the IP that can be effectively implemented, and this is the reason for introducing the unknown IP in Section 7.1.2. Recall that the unknown IP is actually only nearly unknown, because we require that (BIP1) holds. On the other hand, observe that by dropping (BIP1) we could draw only vacuous conclusions about Z. To see this, suppose that you want to predict the probability of Z = z given a certain observation w. Assume from now to the end of the section that there is no CAR IP, in order to make things easier. Then without assuming (BIP1), we could not exclude the possibility that the IP produces w if and only if Z 6= z, so that the probability of Z = z is zero. In the same way, we could not exclude the possibility that the IP produces w if and only if Z = z, so that the probability of Z = z is one. Of course, all the intermediate randomised cases would also be possible, so that the probability would be vacuous. This is to emphasise, perhaps not surprisingly, that complete ignorance about an IP is not consistent with the possibility of drawing useful conclusions.\nHaving said this, it is still useful to wonder whether (BIP1) is reasonable in the present setup. This is easier to do if we rewrite (BIP1) in a somewhat more natural form. We focus on the special case where the spaces of possibilities are finite and we have precise beliefs about the unknown IP. We can then multiply both sides of the equation P (w|z, y) = P (w|y) by the conditional probability of z given y, obtaining P (z, w|y) = P (z|y)P (w|y). The new equation states that variables Z and W are independent conditional on Y . In other words, the original assumption is then equivalent to saying that if we already know fact y, making\nthe observation w is completely superfluous for predicting the target variable. This appears to be nothing else but the precise characterisation of the problems of incomplete or missing information: these problems are characterised by the fact that when something that can be missing is actually measured, the problem of missing information disappears. If this were not the case, the observation w would not only carry information about z via its implications on the fact y: it would say something about z also on its own. But this means that some information useful to predict the target variable has not been included in the definition of the possible facts (see the work by De Cooman & Zaffalon, 2004 for further discussion about an assumption called MDI that is related to the assumption under consideration).\nWe conclude this section discussing Assumption (BIP6), namely the strong independence of W\u0304 and W\u0302 conditional on Y . We discuss this assumption because one could in principle consider weaker notions of independence to replace strong independence.\nThe reason why we have used strong independence is that for the kind of general framework that we have developed it is technically quite difficult to embed other judgments of independence of W\u0304 and W\u0302 conditional on Y . On the other hand, the problem with strong independence is that it does not easily lend itself to a full behavioural interpretation unlike other notions, such as epistemic irrelevance or independence. And we acknowledge that the behavioural interpretation is important both as a way to guide the mathematical developments and when one comes to decision making.\nYet, one could argue that the inference rule, CIR, that follows from our assumptions is the weakest possible one (if we exclude the rule that leads to vacuous posterior expectations and that does not lead to any informative conclusion) for the part related to the unknown IP, because it leads to consider all the replacements for the missing information as the possible latent data. Therefore one could conjecture that by replacing strong independence of W\u0304 and W\u0302 conditional on Y with a weaker notion of independence, the inference rule could either stay the same or lead to vacuous inferences. Whatever the outcome, the choice of strong independence would be even more reasonable."}, {"heading": "7.3 Derivation of CIR", "text": "In order to formulate the basic problem of this paper in a sufficiently general way, we focus on the problem of updating beliefs about a generic function g : Z \u2192 R, to posterior beliefs conditional on W = w. In the precise case, this would be done by computing\nP (g|w) = P (gIw) P (w) ,\nprovided that P (w) > 0. Something similar can be done in the imprecise case, but in such a case it not uncommon for P (w) to be zero. In that case, we should obtain an infinite number of conditional lower previsions which are coherent with P (W ). This has been already discussed by De Cooman and Zaffalon (2004), who proposed the regular extension as a more effective updating rule. This is a very natural choice also under the sensitivity analysis interpretation of coherent lower previsions, as pointed out in Section 6.3, and is therefore also the choice that we pursue. Using the regular extension entails an additional rationality assumption that is reported by Walley (1991, Appendix J3); its coherence with the unconditional lower prevision it is derived from is trivial in the present context, where W is finite (see Appendix B\nfor more details). We also recall that if P (w) > 0, the regular extension provides the only coherent updated lower prevision.\nThe form of the CIR rule given in Definition 7 in Section 4 is derived in the next theorem. It is important to remark that for this theorem to hold, we need to require that the space Y\u0304 of the unknown IP be finite, while this is not necessary for all the other results we establish in Appendix B. The reason for this is that when Y\u0304 is infinite the class {w\u0304}\u22171 that we define in the theorem may be empty for some w\u0304 in W\u0304, making the rule inapplicable.\nTheorem 1 (Conservative inference rule theorem) Consider a gamble g on Z and w \u2208 W. Let {w\u0304}\u22171 := {y\u0304 \u2208 {w\u0304}\u2217 : P 1(y\u0304, {w\u0302}\u2217) > 0}, and let us define the regular extension\nR(g|y\u0304, {w\u0302}\u2217) = inf P\u2265P 1:P (y\u0304,{w\u0302}\u2217)>0 P (g|y\u0304, {w\u0302}\u2217)\nfor all y\u0304 \u2208 {w\u0304}\u22171. Then\nR(g|w) = E1(g|w) := min y\u0304\u2208{w\u0304}\u22171\nR(g|y\u0304, {w\u0302}\u2217).\nProof. First of all, for any prevision P constructed using Equation (13), P (w) = \u03b1w\u0302 \u2211\ny\u0304\u2208Y\u0304,\u03b3\u0304(z,y)=w\u0304\nP (y\u0304, {w\u0302}\u2217) = \u03b1w\u0302 \u2211\ny\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304\nP (y\u0304, {w\u0302}\u2217), (14)\nfor any w \u2208 W, where the second equality follows from Assumption (BIP2), and also taking into account that the mapping \u03b3\u0304 depends only on the value of Y\u0304 . Similarly, we also have\nP (gIw) = \u03b1w\u0302 \u2211\ny\u0304\u2208Y\u0304,\u03b3\u0304(z,y)=w\u0304\nP (gIy\u0304,{w\u0302}\u2217) = \u03b1w\u0302 \u2211\ny\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304\nP (gIy\u0304,{w\u0302}\u2217)\nfor any w \u2208 W and any gamble g on Z. Fix w \u2208 W, and define M := {P \u2265 P 1 : P (w) > 0}, M1 := {P \u2265 P 1 : P (y\u0304, {w\u0302}\u2217) > 0 for some y\u0304 \u2208 {w\u0304}\u2217}. For all gambles g on Z, R(g|w) = inf{P (g|w) : P \u2208 M} and E1(g|w) = inf{P (g|y\u0304, {w\u0302}\u2217) : P \u2208M1}.\nWe start proving that E1(g|w) \u2265 R(g|w). For this, we are going to prove that for any y\u0304 \u2208 {w\u0304}\u2217 and any P \u2208 M1 such that P (y\u0304, {w\u0302}\u2217) > 0 there is some P \u2032 \u2208 M such that P \u2032(g|w) \u2264 P (g|y\u0304, {w\u0302}\u2217). Consider then such P , and let P1 be its restriction to L(Z \u00d7 Y). Then P1 \u2265 P 1. Let \u03b3\u0304 be a mapping such that \u03b3\u0304(z, y) = w\u0304 and \u03b3\u0304(z\u2032, y\u2032) 6= w\u0304 when y\u0304\u2032 6= y\u0304. We can construct such a mapping because by Assumption (IP8) the set {w\u0304}\u2217 is empty, and therefore for every y\u0304\u2032 \u2208 {w\u0304}\u2217 there is some w\u0304\u2032 6= w\u0304 such that y\u0304\u2032 \u2208 {w\u0304\u2032}\u2217. Let P \u2032 \u2265 P be the joint prevision constructed from P1 and \u03b3\u0304 using Equation (13). Taking into account Equation (14), we see that this prevision satisfies P \u2032(w) = \u03b1w\u0302P \u2032(y\u0304, {w\u0302}\u2217) = \u03b1w\u0302P (y\u0304, {w\u0302}\u2217) > 0. As a consequence,\nP \u2032(g|w) = P \u2032(gIw) P \u2032(w) = \u03b1wP \u2032(gIy\u0304,{w\u0302}\u2217) \u03b1wP \u2032(y\u0304, {w\u0302}\u2217) = P (gIy\u0304,{w\u0302}\u2217) P (y\u0304, {w\u0302}\u2217) = P (g|y\u0304, {w\u0302}\u2217),\nwhere the last equality holds because P (y\u0304, {w\u0302}\u2217) > 0. Hence, we deduce that E1(g|w) \u2265 R(g|w).\nWe show now the converse inequality. We are going to prove that for any P \u2208M there is some P \u2032 \u2208M1 such that P (g|w) \u2265 P \u2032(g|y, {w\u0304}\u2217). Consider P \u2208M.\nP (g|w) = P (gIw) P (w)\n= \u03b1w\u0302 \u2211\ny\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304 P (gIy\u0304,{w\u0302}\u2217) \u03b1w\u0302 \u2211 y\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304 P (y\u0304, {w\u0302}\u2217) = \u2211 y\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304 P (gIy\u0304,{w\u0302}\u2217)\u2211 y\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304 P (y\u0304, {w\u0302}\u2217) .\nDefine I := {y\u0304 \u2208 {w\u0304}\u2217 s.t. P (y\u0304, {w\u0302}\u2217) > 0, \u03b3\u0304(z, y) = w\u0304}. Since P (w) > 0, it follows from Equation (14) that this set is nonempty, and the above equality can be expressed as\nP (g|w) = \u2211\ny\u0304\u2208I P (gIy\u0304,{w\u0302}\u2217)\u2211 y\u0304\u2208I P (y\u0304, {w\u0302}\u2217) .\nApplying Lemma 3 in the Appendix we deduce the existence of y\u03041 \u2208 I such that\nP (gIy\u03041,{w\u0302}\u2217) P (y\u03041, {w\u0302}\u2217)\n\u2264 \u2211\ny\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304 P (gIy\u0304,{w\u0302}\u2217)\u2211 y\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304 P (y\u0304, {w\u0302}\u2217) .\nLet P1 be the restriction of P to L(Z\u00d7Y). Consider a mapping \u03b3\u0304 such that \u03b3\u0304(z, y) = w\u0304 when y\u0304 = y\u03041 and \u03b3\u0304(z\u2032, y\u2032) 6= w\u0304 for any other y\u2032. We can construct such a mapping because by Assumption (IP8) the set {w\u0304}\u2217 is empty, and therefore for every y\u0304\u2032 \u2208 {w\u0304}\u2217 there is some w\u0304 \u2032 6= w\u0304 such that y\u0304\u2032 \u2208 {w\u0304\u2032}\u2217. Let P \u2032 \u2265 P be the joint prevision constructed from P1 and \u03b3\u0304 using Equation (13). This prevision satisfies P \u2032(y\u03041, {w\u0302}\u2217) = P (y\u03041, {w\u0302}\u2217) > 0. Moreover,\nP \u2032(g|y\u03041, {w\u0302}\u2217) = P \u2032(gIy\u03041,{w\u0302}\u2217) P \u2032(y\u03041, {w\u0302}\u2217) = P (gIy\u03041,{w\u0302}\u2217) P (y\u03041, {w\u0302}\u2217)\n\u2264 \u2211\ny\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304 P (gIy\u0304,{w\u0302}\u2217)\u2211 y\u0304\u2208{w\u0304}\u2217,\u03b3\u0304(z,y)=w\u0304 P (y\u0304, {w\u0302}\u2217) = P (g|w),\nwhere the second equality follows because P \u2032 = P = P1 on L(Z \u00d7Y). We deduce from this E1(g|w) \u2264 R(g|w) and as a consequence they are equal. 2\nAn important point is whether the lower prevision defined by the CIR rule in this theorem is going to be coherent with the initial assessments: P 1(Z, Y ), P 2(W\u0304 |Y\u0304 ), P3(W\u0302 |Y\u0302 ). We want this to be the case as we want CIR to lead to self-consistent inference. This question is given a positive answer by Theorem 3 in Appendix B.\nMoreover, from this theorem we also deduce (in its subsequent Corollary 2) that coherence will also be maintained under much more general conditions: on the one hand, for some of the examples of application of the CIR rule discussed in Sections 5.1\u20135.3, P 1(Z, Y ) is obtained by making the strong product of a number of conditional lower previsions P 1(XO1 |XI1), . . . , Pm(XOm |XIm). Here we consider a set of variables of interest {X1, . . . , Xn} that contains {Z, Y } and does not include W . We assume moreover that the coherence graph associated to P 1(XO1 |XI1), . . . , Pm(XOm |XIm) is A1+, from which it follows (see Appendix B) that \u222ami=1(Ii \u222a Oi) = \u222ami=1Oi = {1, . . . , n}. An instance of such a situation is given in Figure 7.\nCorollary 2 in Appendix B shows that coherence also holds in this more general situation. On the other hand, the corollary also proves that coherence is maintained if we apply the regular extension to a finite number of conditioning events, thus actually creating an additional finite number of coherent lower previsions out of the original assessments: all of these assessments are going to be jointly coherent. This is another important result as in practice one indeed often conditions on a number of events. These theoretical results give us guarantees that the CIR rule is \u2018well-behaved.\u2019"}, {"heading": "8. Conclusions", "text": "In this paper we have introduced a new rule to update beliefs under incompleteness that we have called conservative inference rule (CIR). CIR has been designed by explicitly taking into consideration the problem of modelling the process that makes our observations incomplete, and that we have called the incompleteness process (or IP). We have represented such a process as made of two sub-processes, one that is non-selective and another that is unknown to us. As a consequence, CIR deals differently with data that are known to be coarsened at random from the other ones. In the first case CIR treats them using the CAR/MAR assumption, in the other by taking all the completions of the incomplete data.\nCIR can be regarded as a generalisation of both the traditional, Bayesian rule to update beliefs and of the recently proposed conservative updating rule (De Cooman & Zaffalon, 2004). CIR is a generalisation of these two rules as it enables one to consider mixed situations. This should make of CIR quite a flexible rule in applications. Moreover, this enables CIR to avoid the risk of being overconfident about the IP, which is a problem for the traditional updating, as well as to avoid being over-pessimistic as it may happen with the conservative updating rule.\nCIR is also a very general rule. It can be used with coarsened or missing data, in statistics as well as in expert systems, and it can be applied to predict the state of a target variable irrespective of the cardinality of its space of possibilities. We have indeed tried to illustrate these characteristics using a number of application domains. Moreover, using some examples we have shown that CIR makes quite a difference with the traditional CAR/MAR-based way of dealing with incomplete data: in these examples the traditional updating is shown to lead to conclusions that are hardly justifiable from the evidence at hand, and, even worse, can do it in such a way that a user may not realise this. In these cases CIR is instead naturally more cautious and clearly communicates to a user that there are limits to the strength of the possible conclusions, as a logical consequence of the strength (or weakness) of the available information.\nFinally, CIR has some nice theoretical properties, most notably that it is a coherent rule. Loosely speaking, this means that by using CIR it is not possible to give rise to probabilistic inconsistencies. As it can be seen from Theorem 3 in Appendix B, the assumptions we require for coherence of CIR are fairly general: if our initial assessments are of a special kind, which we have characterised using a graphical structure called a coherence graph of type A1+, then we require only that some of the possibility spaces involved in the analysis are finite and that the conditioning events in these spaces have positive upper probability.\nThese hypotheses guarantee that we can use Walley\u2019s notion of regular extension to update our beliefs and that the assessments thus obtained are coherent with our initial assessments.\nWe should like to conclude this section commenting also a bit on some of the assumptions we have considered in the construction of our model and in some open problems that we can derive from this work.\nOne point is the requirement that some of the spaces of possibilities be finite. This could be relaxed by taking into account that a conditional prevision defined by regular extension can be coherent with the unconditional it is derived from even in the infinite case. However, we cannot guarantee that the third point of Lemma 2 in Appendix B holds in these more general situations, and this point is necessary for the proof of Theorem 3. This is related to the notion of conglomerability discussed in much detail by Walley (1991). An open problem would be to extend our results to more general situations by addressing the question of conglomerability. On the other hand, as we said, our results are applicable even if the target space Z of our variable of interest, Z, is infinite. This has allowed us, for instance, to model parametric inference in the case where the parameter space is infinite, as discussed in Section 5.2. Moreover, we are not assuming that the upper probability of the values of Z is positive, and this allows us to include the case where our prior beliefs about the parameter are precise and the parameter space is infinite, which coincides with the traditional setup.\nAnother important point is our assumption on the domains of our lower previsions: we have required for instance that P 1(Z, Y ) is defined on the set of all XZ\u222aY -measurable gambles. Similar considerations have been made for P 2(W\u0304 |Y\u0304 ) and P 3(W\u0302 |Y\u0302 ). When these requirements are not met, we can still apply our results by extending our assessments using the notion of natural extension given by Walley (1991). It is easy to see that these extensions will satisfy the hypotheses of our theorems. These considerations allow us to cover in particular the case where we have lower probabilities instead of lower previsions.\nAn interesting feature of the CIR rule derived in Theorem 1 is that it allows us to make the passage from the updated information about Z knowing the observation W to the information about Z knowing the value that Y takes. We think that the key for this is that we are using only vacuous and linear previsions to express the information that Y provides about W , i.e., that the components of the incompleteness process are either unknown or random. It is an open problem to determine whether there are other possibilities allowing us to have an analogous property. Similarly, it would be interesting to study if the other assumptions in the incompleteness process can be weakened.\nTo conclude, CIR is a new rule to update beliefs under incompleteness, it is very general, and is based on solid theoretical foundations. It gives us for the first time the opportunity to avoid being both too optimistic and too pessimistic about the incompleteness process, thus creating a basis to draw credible and strong enough conclusions in a number of applications.\nThis is not to say that we regard CIR as the last word in the subject. On the contrary, it seems to us that research on IPs has so far only scratched the surface of uncertain reasoning under incompleteness. In particular, there will be probably a number of applications where rules stronger than CIR (yet based on more tenable assumption than traditional updating) are needed. Developing these rules appears to be an important research avenue. Such an investigation will probably have to be directed primarily at creating new assumptions about IPs that make the resulting rule stronger while still general enough. A way to do this could be using as a starting point the the framework developed here. In particular, one could\ntake Assumptions (IP1)\u2013(IP9), (BIP3)\u2013(BIP6) and (DB1) as they are, while strengthening those related to the unknown IP, that is, (BIP1) and (BIP2). Then the machinery used to derive CIR could be used again to derive the new rule that follows from the stronger assumptions. Which new assumptions to impose and whether or not they will lead to a rule that is useful while not too domain-specific is matter for future investigation."}, {"heading": "Acknowledgments", "text": "Preliminary work on the topic of this paper appeared in the proceedings of ISIPTA \u201905: the fourth International Symposium on Imprecise Probabilities and Their Applications (Zaffalon, 2005). We should like to thank the reviewers of this paper for comments that helped improve its clarity and readability. This work was partially supported by the Swiss NSF grants n. 200020-116674/1 and 200020-121785/1, and by the projects TIN2008-06796C04-01, MTM2007-61193.\nAppendix A. On the CAR Assumption (IP9)\nIt is important to realise that not all the multi-valued maps \u0393Y\u0302 are consistent with the CAR assumption. Here is an example: take Y\u0302 := {1, 2, 3, 4}, W\u0302 := {a, b, c}, and define the multi-valued map by \u0393Y\u0302 (1) := {a, b}, \u0393Y\u0302 (2) := {b, c}, \u0393Y\u0302 (3) := {a, c}, \u0393Y\u0302 (4) := {a, b, c}. By (BIP5), we should have then P3(a|1) = P3(a|3) = P3(a|4) = \u03b1a, P3(b|1) = P3(b|2) = P3(b|4) = \u03b1b, and P3(c|2) = P3(c|3) = P3(c|4) = \u03b1c. Requiring in addition the nonnegativity of the probabilities and that the conditional mass functions be normalised, leads to the following system of linear constraints:\n\u03b1a + \u03b1b = 1 \u03b1b + \u03b1c = 1 \u03b1a + \u03b1c = 1 \u03b1a + \u03b1b + \u03b1c = 1 \u03b1a, \u03b1b, \u03b1c \u2265 0.\nThis system has no solution, as adding the first three equations we deduce that \u03b1a+\u03b1b+\u03b1c = 1.5, which is incompatible with the fourth equation. Therefore there is no CAR process consistent with \u0393Y\u0302 as defined above.\nThe example shows that in order to define \u0393Y\u0302 properly, we need to add (IP9) as a further assumption to (IP5) and (IP7): that the system of linear constraints originated by \u0393Y\u0302 through (BIP5) has a solution, namely, that it is admissible. Checking admissibility is easy because Y\u0302 is finite and hence so is the number of constraints in the system; this allows one to use standard techniques from linear programming to solve the problem.\nThe example also points to another question, which concerns its relationship with Gill et al.\u2019s well-known \u2018CAR is everything\u2019 theorem (Gill et al., 1997, Section 2). Loosely speaking, such a theorem states, in a precise probability context, that it is always possible to define a CAR process; and the example seems to contradict the theorem.\nIn order to show that there is actually no contradiction, we need to represent the example in the setup of Gill et al.\u2019s paper, which is focused on random sets. This means that they\nregard W\u0302 as a variable that takes values from the powerset of Y\u0302, and hence that the CAR IP is intended as a function that maps elements of Y\u0302 into subsets of Y\u0302 itself.\nTo make the transition, we identify each element of w\u0302 \u2208 W\u0302 with the corresponding set {w\u0302}\u2217; in our example, the possible values of W\u0302 , interpreted as a random set, are then {1, 3, 4}, {1, 2, 4}, and {2, 3, 4}. The intuition here is that the element 1 of Y\u0302 can be coarsened by the CAR IP into the set {1, 3, 4} or {1, 2, 4}; the element 2 into {1, 2, 4} or {2, 3, 4}; the element 3 into {1, 3, 4} or {2, 3, 4}; and the element 4 into {1, 3, 4}, {1, 2, 4} or {2, 3, 4}. For the correspondence to be really consistent, we also need to make sure that zero probability is assigned to all the elements of the power set of Y\u0302 that do not correspond to any of the sets {w\u0302}\u2217, w\u0302 \u2208 W\u0302; this is necessary because of (BIP4) and because Gill et al.\u2019s setup does not explicitly use the notion of multi-valued mapping. With this background we can take a closer look at the relationship between the example and Gill et al.\u2019s theorem.\nWhat the theorem states, in our language, is that no matter how W\u0302 is distributed, one can find an unconditional mass function for Y\u0302 and a CAR process that lead W\u0302 to be distributed in the same way. But if we select an unconditional mass function for the random set W\u0302 that respects the constraint of assigning zero probabilities as above, we are actually implementing the multi-valued map of the example, and we know that there is no CAR process consistent with it.\nThe key to solve the paradox is that Gill et al. allow the CAR-IP probabilities P3(Y\u0302 \u2032|y\u0302) to be non-zero for any set Y\u0302 \u2032 \u2286 Y\u0302 that includes y\u0302, not only for the sets determined by the multi-valued map, as we do. This freedom makes it possible to always find a CAR process.\nConsider again the example above, and assume that W\u0302 is distributed uniformly over the three sets {1, 3, 4}, {1, 2, 4}, {2, 3, 4}: i.e., each of them is assigned probability equal to 13 . We can make this choice consistent with a CAR process by choosing \u03b1{1,3,4} := \u03b1{1,2,4} := \u03b1{2,3,4} := 13 (i.e., \u03b1a := \u03b1b := \u03b1c := 1 3) if, in addition, we set \u03b1{1} := \u03b1{2} := \u03b1{3} := 1 3 , i.e., if we allow the CAR process to be able to potentially output other three sets. But since we know that the three other sets cannot be really returned, we are obliged to also set P (1) := P (2) := P (3) := 0, thus solving the problem, although arguably in a somewhat artificial way.\nIndeed, since we are forced to set to zero the probability of some elements in Y\u0302, one might wonder why those elements have to be included in the set Y\u0302. Precisely this observation has been already used as a source of criticism of Gill et al.\u2019s \u2018CAR is everything\u2019 theorem (Gru\u0308nwald & Halpern, 2003, Section 4.4), leading the authors of the latter paper to say that in these cases it is like if there is actually no CAR process. Our formulation based on the multi-valued map simply confirms this statement in an alternative way."}, {"heading": "Appendix B. Coherence of CIR", "text": "In this appendix, we are going to prove that the assessments in the construction of the conservative inference rule satisfy the notion of coherence and moreover that they are also coherent with any probabilistic assessment that we deduce from them using CIR. In doing so, we want to cover also the case where the unconditional prevision P 1(Z, Y ) is constructed from a number of other conditional and unconditional previsions, which is a very typical case in practice. We shall use the notations established in Section 2 and Section 6. We\nconsider then variables X1, . . . , Xn taking values in respective sets X1, . . . ,Xn, and take a collection of conditional previsions P 1(XO1 |XI1), . . . , Pm(XOm |XIm).\nWe start with a lemma that shows that A1 graphs naturally entail a notion of order of the corresponding lower previsions: in particular, that it is possible to permute the indexes of the lower previsions in such a way that the only admissible paths between two dummy nodes are those in which the index of the origin precedes that of the destination.25\nLemma 1 If the coherence graph of {P 1(XO1 |XI1), . . . , Pm(XOm |XIm)} is A1, then we may assume without loss of generality that for any k = 1, . . . ,m, Ok \u2229 (\u222ak\u22121i=1 Ii) = \u2205.\nProof. We start proving that Ok\u2229(\u222ami=1Ii) = \u2205 for some k. Assume ex-absurdo that this does not hold. Then for any k \u2208 {1, . . . ,m} there is some f(k) 6= k such that Ok\u2229If(k) 6= \u2205. Define z0 := 1, zk := f(zk\u22121) \u2200k \u2265 1. It must be {zk} \u2229 {z0, . . . , zk\u22121} = \u2205 for all k \u2265 1, or we should establish a cycle in the coherence graph, contradicting thus that it is A1. Hence, |{z0, z1, . . . , zk\u22121}| = k for all k \u2265 1, and this means that zm does not exist, or, equivalently, that Ozm\u22121 \u2229 Ii = \u2205 \u2200i = 1, . . . ,m. Hence, there is some k such that Ok \u2229 (\u222ami=1Ii) = \u2205. We can assume without loss of generality that k = m.\nWe prove now that there is some k 6= m such that Ok\u2229(\u222am\u22121i=1 Ii) = \u2205. Assume ex-absurdo that this does not hold. Then for all k \u2208 {1, . . . ,m\u22121} there is some g(k) 6= k,m such that Ok \u2229 Ig(k) 6= \u2205. Define z0 := 1, zk := g(zk\u22121) \u2200k \u2265 1. It must be {zk} \u2229 {z0, . . . , zk\u22121} = \u2205 for all k \u2265 1, or we should establish a cycle in the coherence graph, contradicting thus that it is A1. Hence, |{z0, z1, . . . , zk\u22121}| = k for all k \u2265 1, and this means that zm\u22121 does not exist, or, equivalently, that Ozm\u22122 \u2229 Ii = \u2205 \u2200i = 1, . . . ,m \u2212 1. Hence, there is some k 6= m such that Ok \u2229 (\u222am\u22121i=1 Ii) = \u2205. We can assume without loss of generality that k = m\u2212 1.\nA similar reasoning allows us to deduce the existence of an order \u227a in {1, . . . ,m} such that Ok \u2229 (\u222aj\u227akIj) = \u2205 for all k = 1, . . . ,m. Finally we assume without loss of generality that this order coincides with the natural order. 2\nNow we restrict the attention to the particular case of A1+ graphs. From Lemma 1, if a collection P 1(XO1 |XI1), . . . , Pm(XOm |XIm) is A1+-representable, we can assume without loss of generality that I1 = \u2205. Let A1 := \u2205, Aj := \u222aj\u22121i=1 (Ii \u222aOi) for j = 2, . . . ,m+ 1, and let P \u2032j(XOj |XAj\u222aIj ) be given on the set Hj of XAj+1-measurable gambles for j = 1, . . . ,m by\nP \u2032j(f |z) := P j(f(z, \u00b7)|\u03c0Ij (z))\nfor all z \u2208 XAj\u222aIj and all f \u2208 Hj . Since P j(XOj |XIj ) is separately coherent for j = 1, . . . ,m, so is P \u2032j(XOj |XAj\u222aIj ). Moreover, thanks to Lemma 1 and that {O1, . . . , Om} forms a partition of {1, . . . , n} when we focus on A1+ graphs, the sets of indexes of the conditional variables in P \u20321(XO1), . . . , P \u2032 m(XOm |XAm\u222aIm) form an increasing sequence and hence they satisfy the hypotheses of the generalised marginal extension theorem. As a consequence, P \u20321(XO1), . . . , P \u2032 m(XOm |XAm\u222aIm) are also coherent.\nA similar reasoning shows that if we take for j = 1, . . . ,m a conditional linear prevision P \u2032j(XOj |XAj\u222aIj ) that dominates P \u2032j(XOj |XAj\u222aIj ), then P \u20321(XO1), . . . , P \u2032m(XOm |XAm\u222aIm) are jointly coherent. Moreover, since {O1, . . . , Om} is a partition of {1, . . . , n}, Theorem 3 by\n25. This order notion is similar to the graph-theoretic notion of topological ordering, but here it is applied only to the dummy nodes.\nMiranda and De Cooman (2007) implies that the only prevision P on X n which is coherent with the assessments P \u20321(XO1), . . . , P \u2032 m(XOm |XAm\u222aIm) is\nP (f) = P \u20321(P \u2032 2(. . . (P \u2032 m(f |XAm\u222aIm)| . . . )|XA2\u222aI2)). (15)\nIn other words, P \u20321(XO1), . . . , P \u2032 m(XOm |XAm\u222aIm) give rise to a unique joint lower prevision.\nDefinition 17 Assume that P\u03bb(XOj |XAj\u222aIj ) dominates P \u2032j(XOj |XAj\u222aIj ) for all \u03bb \u2208 \u039b and all j = 1, . . . ,m and\ninf \u03bb\u2208\u039b\nP\u03bb(XOj |XAj\u222aIj ) = P \u2032j(XOj |XAj\u222aIj ).\nThe coherent lower prevision P defined as P := inf\u03bb\u2208\u039b P\u03bb, where P\u03bb is the coherent prevision determined by P\u03bb(XO1), . . . , P\u03bb(XOm |XAm\u222aIm) and Equation (15), is called a lower envelope model.\nIntuitively, a lower envelope model is a joint lower prevision that is built out of a number of conditional and unconditional assessments. The interest in lower envelope models arises because it is a very common practice to build joint models out of smaller conditional and unconditional ones, and then to use the joint model to draw some conclusions. Lower envelope models abstract this procedure in the general case of coherent lower previsions. As particular cases of lower envelope models, we can consider the following:\n1. If for each j = 1, . . . ,m we consider all the P\u03bb(XOj |XAj\u222aIj ) in M(P \u2032j(XOj |XAj\u222aIj )), then P is the marginal extension of P \u20321(XO1), . . . , P \u2032 m(XOm |XAm\u222aIm).\n2. If for j = 1, . . . ,m we take all the P\u03bb(XOj |XAj\u222aIj ) in the set of extreme points of M(P \u2032j(XOj |XAj\u222aIj )), with the additional requirement that P\u03bb(XOj |z) = P\u03bb(XOj |z\u2032) if \u03c0Ij (z) = \u03c0Ij (z\n\u2032), then the lower envelope model P is called the strong product of P 1(XO1), . . . , Pm(XOm |XIm).\nIn this paper, we make our inferences using the strong product. From the results by Miranda and De Cooman (2007), if we let Pj(XOj |XIj ) be an extreme point ofM(P j(XOj |XIj )) for j = 1, . . . ,m and we build a linear prevision P in the manner described above, then P, P1(XO1 |XA1\u222aI1), . . . , Pm(XOm |XAm\u222aIm) are coherent. Moreover, we deduce the following:\nTheorem 2 Let P 1(XO1), . . . , Pm(XOm |XIm) be an A1+-representable collection, and let P be a lower envelope model associated to it. Then P , P 1(XO1), . . . , Pm(XOm |XIm) are coherent.\nProof. It is a consequence of the marginal extension theorem by Miranda and De Cooman (2007) that for any \u03bb \u2208 \u039b the previsions P\u03bb, P\u03bb(XO1 |XA1\u222aI1), . . . , P\u03bb(XOm |XAm\u222aIm) are coherent. Applying Theorem 8.1.6 in Walley (1991), we deduce that the lower envelopes of these families, which are the lower previsions P , P \u20321(XO1 |XA1\u222aI1), . . . , P \u2032m(XOm |XAm\u222aIm), are also coherent. The result now follows applying that any gamble f in Kj belongs to Hj , and that P \u2032j(f |XAj\u222aIj )(x) = P \u2032j(f(\u03c0Aj\u222aIj (x), \u00b7)|\u03c0Aj\u222aIj (x)) = P j(f(\u03c0Ij (x), \u00b7)|\u03c0Ij (x)) for all x \u2208 X n. 2\nWe have the following useful corollary of this theorem:\nCorollary 1 Let P be the strong product of P 1(Z, Y ), P 2(W\u0304 |Y\u0304 ), P3(W\u0302 |Y\u0302 ), constructed in Section 7.1.3. P is coherent and it is also jointly coherent with the original assessments P 1(Z, Y ), P 2(W\u0304 |Y\u0304 ), P3(W\u0302 |Y\u0302 ). This holds also if P 1(Z, Y ) is constructed as a joint which is coherent with a number of smaller pieces of information, provided that the coherence graph representing them is A1+.\nProof. That P is a coherent lower prevision follows because it is the lower envelope of a set of linear previsions. Its coherence with P 1(Z, Y ), P 2(W\u0304 |Y\u0304 ), P3(W\u0302 |Y\u0302 ) follows from Theorem 2, because the coherence graph of P 1(Z, Y ), P 2(W\u0304 |Y\u0304 ), P3(W\u0302 |Y\u0302 ) is A1+, as it is evident from Figure 6. In the more general situation when P 1(Z, Y ) is constructed in a modular way the result follows similarly as the coherence graph representing these assessments together with P 2(W\u0304 |Y\u0304 ), P3(W\u0302 |Y\u0302 ) will also be A1+. 2\nWe prove next that if we use regular extension to derive new conditional previsions Pm+1(XOm+1 |XIm+1), . . . , Pm+k(XOm+k |XIm+k) from the strong product P , these conditional previsions are coherent with all the initial assessments. For this, we need to establish first the following:\nLemma 2 Let P , P (XO|XI) be coherent unconditional and conditional previsions, with XI finite. Let R(XO|XI) be defined from P using regular extension for z \u2208 XI when P (z) > 0, and be equal to P (XO|z) when P (z) = 0. Then:\n1. P ,R(XO|XI) are coherent.\n2. R(XO|XI) \u2265 P (XO|XI).\n3. For any P \u2265 P , there is some P (XO|XI) which is coherent with P and dominates P (XO|XI).\nProof. Since XI is a finite set, we can apply Theorem 6.5.4 in the book of Walley (1991) to deduce that the coherence of P ,R(XO|XI) is equivalent to P (Iz(f \u2212R(f |z))) = 0 for all z \u2208 XI .26 If P (z) = 0, this is trivial. If P (z) > 0, it follows from Walley (1991, Appendix J3).\nFor the second statement, consider some z in XI with P (z) > 0, and f \u2208 KO\u222aI . Assume ex-absurdo that R(f |z) < P (f |z). It follows from the definition of the regular extension that there is some P \u2265 P such that P (z) > 0 and P (f |z) < P (f |z). Since P (z) > 0, it follows from the generalised Bayes rule that P (f |z) is the unique value satisfying 0 = P (Iz(f\u2212P (f |z))). As a consequence, given P (f |z) > P (f |z), we have that Iz(f\u2212P (f |z)) \u2265 Iz(f \u2212 P (f |z)), whence\n0 = P (Iz(f \u2212 P (f |z))) \u2265 P (Iz(f \u2212 P (f |z))) \u2265 P (Iz(f \u2212 P (f |z)) = 0,\nusing that since P , P (XO|XI) are coherent they satisfy the generalised Bayes rule. But this implies that P (Iz(f \u2212 P (f |z))) = P (Iz(f \u2212 P (f |z))) = 0, and then there are two different values of \u00b5 for which P (Iz(f \u2212 \u00b5)) = 0. This is a contradiction.\n26. This is called the generalised Bayes rule. When P (x) > 0, there is a unique value for which P (G(f |x)) = P (Ix(f \u2212 P (f |x))) = 0 holds.\nWe finally establish the third statement. Consider P \u2265 P , and z \u2208 XI . If P (z) > 0, then for any f \u2208 KO\u222aI P (f |z) is uniquely determined by the generalised Bayes rule and dominates the regular extension R(f |z). Hence, P (f |z) \u2265 R(f |z) \u2265 P (f |z), where the last inequality follows from the second statement. Finally, if P (z) = 0, taking any element P (XO|z) of M(P (XO|z)) we have that P (Iz(f \u2212 P (f |z))) = 0 for all f \u2208 KO\u222aI . This completes the proof. 2\nBefore we establish our next result, we need to introduce a consistency notion for conditional lower previsions that is less restrictive than coherence:\nDefinition 18 Let P 1(XO1 |XI1), . . . , Pm(XOm |XIm) be separately coherent conditional previsions. They are weakly coherent when for all fj \u2208 Kj, j = 1, . . . ,m, j0 \u2208 {1, . . . ,m}, f0 \u2208 Kj0 , z0 \u2208 XIj0 ,\nsup x\u2208Xn  m\u2211 j=1 Gj(fj |XIj )\u2212Gj0(f0|z0)  (x) \u2265 0. (16) The intuition behind this notion is that our subject should not raise the conditional lower prevision P j0(f0|z0), which represents his supremum acceptable buying price for f0 contingent on z0, in any positive , using the desirable gambles G1(f1|XI1),. . . ,Gm(fm|XIm). The difference with the notion of (strong) coherence is that the supremum of sum in Equation (16) is required to be non-negative over the whole space X n, and not necessarily when at least one of the summands is non-zero. This implies that the condition holds trivially for gambles f0, f1, . . . , fm for which there are elements w \u2208 X n which do not belong to any set in {\u03c0\u22121Ij0 (z0)} \u222a \u222a m j=1Sj(fj).\nFrom Miranda and Zaffalon (2009, Theorem 1), P 1(XO1 |XI1), . . . , Pm(XOm |XIm) are weakly coherent if and only if there is a joint lower prevision P (X1, . . . , Xn) that is pairwise coherent with each conditional lower prevision P j(XOj |XIj ) in the collection. Similar results hold in the case where we focus on collections made of linear previsions, with the difference that the joint whose existence is equivalent to weak coherence is linear, too. However, under the behavioural interpretation, a number of weakly coherent conditional lower previsions can still present some forms of inconsistency; see Walley (1991, Example 7.3.5) for an example and Walley (1991, Chapter 7), Walley, Pelessoni, and Vicig (2004), Miranda (2009) for some discussion.\nTheorem 3 Let P 1(XO1 |XI1), . . . , Pm(XOm |XIm) be separately coherent conditional lower previsions whose associated coherence graph is A1+. Let P be their strong product. Consider disjoint Om+j , Im+j for j = 1, . . . , k. Assume that XIm+j is finite for j = 1, . . . , k and that P (z) > 0 for all z \u2208 XIm+j , and define Pm+j(XOm+j |XIm+j ) using regular extension for j = 1, . . . , k. Then\nP , P 1(XO1 |XI1), . . . , Pm+k(XOm+k |XIm+k) are coherent.\nProof. LetM denote the set of linear previsions constructed by combining the extreme points of M(P j(XOj |XIj )), j = 1, . . . ,m, in the manner described by Equation (15). The strong product P is the lower envelope of M.\nSince XIm+j is finite for j = 1, . . . , k, it follows from [Appendix J3] in the book of Walley (1991) that P and Pm+j(XOm+j |XIm+j ) are coherent. Applying Theorem 1 by Miranda and Zaffalon (2009), we deduce that the previsions P , P 1(XO1 |XI1), . . . , Pm+k(XOm+k |XIm+k) are weakly coherent. Hence, Theorem 7.1.5 by Walley (1991) implies that it suffices to show that P 1(XO1 |XI1), . . . , Pm+k(XOm+k |XIm+k) are coherent. Consider fi \u2208 Ki for i = 1, . . . ,m+ k, j0 \u2208 {1, . . . ,m+ k}, z0 \u2208 XIj0 , f0 \u2208 K j0 , and let us prove that\nsup \u03c9\u2208B [ m+k\u2211 i=1 [fi \u2212 P i(XOi |XIi)]\u2212 Iz0(f0 \u2212 P j0(f0|z0)) ] (\u03c9) \u2265 0 (17)\nfor some B \u2208 {\u03c0\u22121Ij0 (z0)} \u222a \u222a m+k i=1 Si(fi).\nAssume first that j0 \u2208 {m+1, . . . ,m+k}. If Equation (17) does not hold, there is some \u03b4 > 0 such that\nsup \u03c9\u2208\u03c0\u22121Ij0 (z0) [ m+k\u2211 i=1 [fi \u2212 P i(XOi |XIi)]\u2212 Iz0(f0 \u2212 P j0(f0|z0)) ] (\u03c9) = \u2212\u03b4 < 0.\nSince P (z0) > 0 by assumption, it follows from the definition of the regular extension that there is some P in M such that P (z0) > 0 and Pj0(f0|z0) \u2212 P j0(f0|z0) < \u03b4 2 . From the definition of the elements of M, there are Pi(XOi |XIi) in M(P i(XOi |XIi)), i = 1, . . . ,m, such that P is coherent with Pi(XOi |XIi) for i = 1, . . . ,m. On the other hand, applying Lemma 2, for any j = 1, . . . , k, there is a conditional prevision Pm+j(XOm+j |XIm+j ) that dominates Pm+j(XOm+j |XIm+j ) and is coherent with P . Note that Pj0(XOj0 |z0) is uniquely determined from P by Bayes\u2019s rule because P (z0) > 0.\nUsing these conditional previsions, we deduce that for any \u03c9 \u2208 X n,[ m+k\u2211 i=1 [fi \u2212 Pi(XOi |XIi)]\u2212 Iz0(f0 \u2212 Pj0(f0|z0)) ] (\u03c9)\n\u2264 [ m+k\u2211 i=1 [fi \u2212 P i(XOi |XIi)]\u2212 Iz0(f0 \u2212 P j0(f0|z0)) ] (\u03c9) + \u03b4 2 ,\nwhence [ m+k\u2211 i=1 [fi \u2212 Pi(XOi |XIi)]\u2212 Iz0(f0 \u2212 Pj0(f0|z0)) ] (\u03c9) \u2264 \u2212\u03b4 2\nfor any \u03c9 \u2208 \u03c0\u22121Ij0 (z0). Let us denote g := \u2211m+k\ni=1 [fi\u2212Pi(XOi |XIi)]\u2212 Iz0(f0\u2212Pj0(f0|z0)). The coherence of P, Pj(XOj |XIj ) for j = 1, . . . ,m + k implies that P (g) = 0. But then we also have P (g) \u2264 P (gIz0) \u2264 \u2212 \u03b42P (z0) < 0, where the first inequality holds because g \u2264 0 since we are assuming that Equation (17) does not hold. This is a contradiction.\nAssume next that j0 \u2208 {1, . . . ,m}, and let us prove the existence of a linear prevision Q \u2208 M and conditional previsions Pj(XOj |XIj ) in M(P j(XOj |XIj )) coherent with Q for j = 1, . . . ,m+ k such that Pj0(f0|z0) = P j0(f0|z0) and Q(B) > 0 for some B \u2208 {\u03c0 \u22121 Ij0\n(z0)}\u222a \u222am+ki=1 Si(fi).\n\u2022 Assume first that P (z0) > 0. Then there is some P in M such that P (z0) > 0. This prevision is determined by (and therefore coherent with) conditional previsions P1(XO1 |XI1), . . . , Pm(XOm |XIm), where Pi(XOi |XIi) belongs to M(P i(XOi |XIi)) for i = 1, . . . ,m.\nLet P \u2032j0(XOj0 |XIj0 ) be an extreme point ofM(P j0(XOj0 |XIj0 )) such that P \u2032 j0 (f0|z0) = P (f0|z0), and let Q be the element of M determined by the conditional previsions P1(XO1 |XI1), . . . , P \u2032j0(XOj0 |XIj0 ), . . . , Pm(XOm |XIm). Since the coherence graph of P 1(XO1 |XI1), . . . , Pm(XOm |XIm) is A1, Lemma 1 implies that we can assume without loss of generality that for all k = 1, . . . ,m, Ok \u2229 (\u222ak\u22121i=1 Ii) = \u2205. Since moreover {O1, . . . , Om} forms a partition of {1, . . . , n}, we deduce that Ii \u2286 \u222ai\u22121j=1Oj for i = 1, . . . , n. In particular, Ij0 \u2286 \u222a j0\u22121 j=1 Oj , whence the value of Q on XIj0 -measurable gambles is uniquely determined by P1(XO1 |XI1), . . . , Pj0\u22121(XOj0\u22121 |XIj0\u22121). As a consequence, Q(z0) = P (z0) > 0.\nConsider now conditional previsions Pm+j(XOm+j |XIm+j ) which are pairwise coherent with Q and dominate Pm+j(XOm+j |XIm+j ) for j = 1, . . . , k. There are such previsions because of Lemma 2. The previsions\nQ, P1(XO1 |XI1), . . . , P \u2032j0(XOj0 |XIj0 ), . . . , Pm(XOm |XIm), Pm+1(XOm+1 |XIm+1), . . . , Pm+k(XOm+k |XIm+k)\nsatisfy the conditions stated above, with B = \u03c0\u22121Ij0 (z0).\n\u2022 If P (z0) = 0, there are two possibilities: either fm+1 = \u00b7 \u00b7 \u00b7 = fm+k = 0, and then Equation (17) holds because P 1(XO1 |XI1), . . . , Pm(XOm |XIm) are coherent; or there is some j1 \u2208 {1, . . . , k} such that fm+j1 6= 0. In that case, we consider a set B \u2208 Sm+j1(fm+j1). This set is of the form B = \u03c0\n\u22121 Im+j1 (z1) for some z1 \u2208 XIm+j1 . Because P (z1) > 0 by assumption, there is some Q \u2208 M such that Q(z1) > 0. From the definition of M, there are Pi(XOi |XIi) in M(P i(XOi |XIi)), i = 1, . . . ,m, such that Q is coherent with Pi(XOi |XIi) for i = 1, . . . ,m. Consider a prevision P \u2032j0(XOj0 |z0) in M(P j0(XOj0 |z0)) such that P \u2032 j0\n(f0|z0) = P j0(f0|z0), and define the conditional prevision P \u2032j0(XOj0 |XIj0 ) by\nP \u2032j0(f |z) = { P \u2032j0(f |z0) if z = z0 Pj0(f |z0) otherwise.\nSince Q(z0) = P (z0) = 0, given any f \u2208 Kj0 Q(P \u2032 j0\n(f |XIj0 )) = Q(Pj0(f |XIj0 )) = Q(f), where the last equality follows from the coherence of Q and Pj0(XOj0 |XIj0 ). Hence, Q and P \u2032j0(XOj0 |XIj0 ) are coherent. On the other hand, applying Lemma 2, for all j = 1, . . . , k, there is Pm+j(XOm+j |XIm+j ) \u2265 Pm+j(XOm+j |XIm+j ) that is coherent with Q. From all this we deduce that\nQ,P1(XO1 |XI1), . . . , P \u2032j0(XOj0 |XIj0 ), . . . , Pm+k(XOm+k |XIm+k)\nsatisfy the above stated conditions, with B = \u03c0\u22121Im+j1 (z1).\nIf we now take these previsions, we deduce that for all \u03c9 \u2208 X n,[ m+k\u2211 i=1 [fi \u2212 Pi(XOi |XIi)]\u2212 Iz0(f0 \u2212 Pj0(f0|z0)) ] (\u03c9)\n\u2264 [ m+k\u2211 i=1 [fi \u2212 P i(XOi |XIi)]\u2212 Iz0(f0 \u2212 P j0(f0|z0)) ] (\u03c9).\nLet us denote g := \u2211m+k\ni=1 [fi \u2212 Pi(XOi |XIi)] \u2212 Iz0(f0 \u2212 Pj0(f0|z0)). The coherence of Q and Pj(XOj |XIj ) for j = 1, . . . ,m + k implies that Q(g) = 0. Consider the set B \u2208 {\u03c0\u22121Ij0 (z0)} \u222a \u222a m+k i=1 Si(fi) for which Q(B) > 0. If Equation (17) does not hold, then there must be some \u03b4 > 0 s.t. sup\u03c9\u2208B g(\u03c9) = \u2212\u03b4 < 0. Since it also follows that g(\u03c9) \u2264 0, we deduce that Q(g) \u2264 Q(gIB) \u2264 \u2212\u03b4Q(B) < 0. This is a contradiction.\nWe conclude from this that Equation (17) holds and as a consequence the previsions P , P 1(XO1 |XI1),. . . ,Pm+k(XOm+k |XIm+k) are coherent. 2\nNext we use the results above to apply the CIR rule in more general frameworks. This is necessary for some of the examples of application of the CIR rule discussed in Sections 5.1\u2013 5.3.\nCorollary 2 Let {X1, . . . , Xn} be a set of variables that contains {Z, Y } and does not include W . Assume that the coherence graph associated to P 1(XO1 |XI1),. . . , Pm(XOm |XIm) is A1+. Let P be the strong product of\nP 1(XO1 |XI1), . . . , Pm(XOm |XIm), P (W\u0302 |Y\u0302 ), P (W\u0304 |Y\u0304 ).\nAssume that XIm+j is finite for j = 1, . . . , k and that P (z) > 0 for all z \u2208 XIm+j , and define Pm+j(XOm+j |XIm+j ) using regular extension for j = 1, . . . , k. Then:\n(i) P , P 1(XO1 |XI1), . . . , Pm(XOm+k |XIm+k), P (W\u0302 |Y\u0302 ), P (W\u0304 |Y\u0304 ) are coherent.\n(ii) If P (Z|W ) is one of the previsions we derive from the strong product P using regular extension, then P (Z|W ) satisfies Equation (CIR).\nProof. First of all, P 1(XO1 |XI1), . . . , Pm(XOm |XIm), P (W\u0302 |Y\u0302 ), P (W\u0304 |Y\u0304 ) satisfy the hypotheses of Theorem 2: their associated coherence graph is A1+ and {W,XO1 , . . . , XOm} is our set of variables of interest. Hence, their strong product P is coherent with all these assessments. If moreover we use regular extension to build the updated models Pm+j(XOm+j |XIm+j ) using regular extension for j = 1, . . . , k, it follows from Theorem 3 that the conditional lower previsions Pm+1(XOm+j |XIm+1), . . . , Pm+k(XOm+k |XIm+k) are coherent with P , P 1(XO1 |XI1), . . . , Pm(XOm |XIm), P (W\u0302 |Y\u0302 ), P (W\u0304 |Y\u0304 ).\nSecondly, the strong product P coincides with the one we obtain using the unconditional lower prevision P (XO1 , . . . , XOm) which we obtain by making the strong product of P 1(XO1 |XI1), . . . , Pm(XOm |XIm) on the one hand and the conditional assessments P (W\u0302 |Y\u0302 ), P (W\u0304 |Y\u0304 ) on the other hand: from the results by Miranda and De Cooman (2007), the extreme points of the set M(P (XO1 , . . . , XOm)) are obtained by applying marginal extension on the extreme points of M(P 1(XO1 |XI1)),. . . ,M(Pm(XOm |XIm)). Hence, the updated prevision P (Z|W ) we obtain by regular extension also satisfies Equation (CIR) in this case. 2\nCorollary 3 Updating a credal network a finite number of times by CIR leads to coherent inference.\nProof. It is enough to observe that the probabilistic assessments used to build credal networks lead to an A1+ coherence graph, as detailed in Theorem 8 by Miranda and Zaffalon (2009), and that such a graph, supplemented with the parts for P (W\u0304 |Y\u0304 ) and P (W\u0302 |Y\u0302 ), remains an A1+ graph. The result follows then by Corollary 2. 2\nCorollary 4 Doing parametric inference a finite number of times by CIR according to Rules (4) and (5) leads to coherent inference.\nProof. The coherence of Rule (4) is ensured by Corollary 2 since the coherence graph of the overall assessments used is A1+, as shown in Figure 8. The same holds for Rule (5)\nonce we observe that also in this case the related coherence graph is A1+, as illustrated in Figure 9. 2\nCorollary 5 Computing a finite number of posterior predictive lower previsions by CIR for classification according to Rule (7) leads to coherent inference.\nProof. The coherence of Rule (7) is ensured by Corollary 2 since the coherence graph of the overall assessments used is A1+, as shown in Figure 10. 2\nLemma 3 Consider bj \u2265 0, cj > 0 for j = 1, . . . , n. Then there is some j1 such that(\u2211n j=1 bj\u2211n j=1 cj ) \u2265 bj1 cj1 . (18)\nProof. Assume ex-absurdo that Equation (18) does not hold. Then for any j = 1, . . . ,m, cj Pn k=1 bkPn\nk=1 ck < bj , and by making the sum over all j on both sides of the inequality we obtain\nthat n\u2211 j=1 cj \u2211n k=1 bk\u2211n k=1 ck = n\u2211 k=1 bk < n\u2211 j=1 bj ,\na contradiction. 2"}], "references": [{"title": "Equivalence between Bayesian and credal nets on an updating problem", "author": ["A. Antonucci", "M. Zaffalon"], "venue": "Proceedings of the third international conference on Soft Methods in Probability and Statistics,", "citeRegEx": "Antonucci and Zaffalon,? \\Q2006\\E", "shortCiteRegEx": "Antonucci and Zaffalon", "year": 2006}, {"title": "Fast algorithms for robust classification with Bayesian nets", "author": ["A. Antonucci", "M. Zaffalon"], "venue": "International Journal of Approximate Reasoning,", "citeRegEx": "Antonucci and Zaffalon,? \\Q2007\\E", "shortCiteRegEx": "Antonucci and Zaffalon", "year": 2007}, {"title": "Decision-theoretic specification of credal networks: a unified language for uncertain modeling with sets of Bayesian networks", "author": ["A. Antonucci", "M. Zaffalon"], "venue": "International Journal of Approximate Reasoning,", "citeRegEx": "Antonucci and Zaffalon,? \\Q2008\\E", "shortCiteRegEx": "Antonucci and Zaffalon", "year": 2008}, {"title": "Generalized loopy 2U: a new algorithm for approximate inference in credal networks", "author": ["A. Antonucci", "M. Zaffalon", "Y. Sun", "C.P. de Campos"], "venue": "Proceedings of the fourth European Workshop on Probabilistic Graphical Models,", "citeRegEx": "Antonucci et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Antonucci et al\\.", "year": 2008}, {"title": "Bayesian interpretation of frequentist procedures for a Bernoulli process", "author": ["Bernard", "J.-M."], "venue": "The American Statistician, 50 (1), 7\u201313.", "citeRegEx": "Bernard and J..M.,? 1996", "shortCiteRegEx": "Bernard and J..M.", "year": 1996}, {"title": "Theory of Charges", "author": ["K.P.S. Bhaskara Rao", "M. Bhaskara Rao"], "venue": null, "citeRegEx": "Rao and Rao,? \\Q1983\\E", "shortCiteRegEx": "Rao and Rao", "year": 1983}, {"title": "Independence concepts for convex sets of probabilities", "author": ["L. Campos", "S. Moral"], "venue": null, "citeRegEx": "Campos and Moral,? \\Q1995\\E", "shortCiteRegEx": "Campos and Moral", "year": 1995}, {"title": "Learning reliable classifiers from small or incomplete data sets: the naive credal classifier 2", "author": ["G. Corani", "M. Zaffalon"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "Corani and Zaffalon,? \\Q2008\\E", "shortCiteRegEx": "Corani and Zaffalon", "year": 2008}, {"title": "A survey of concepts of independence for imprecise probability", "author": ["I. Couso", "S. Moral", "P. Walley"], "venue": "Risk, Decision and Policy,", "citeRegEx": "Couso et al\\.,? \\Q2000\\E", "shortCiteRegEx": "Couso et al\\.", "year": 2000}, {"title": "Credal networks", "author": ["F.G. Cozman"], "venue": "Artificial Intelligence, 120 (2), 199\u2013233.", "citeRegEx": "Cozman,? 2000", "shortCiteRegEx": "Cozman", "year": 2000}, {"title": "Graphical models for imprecise probabilities", "author": ["F.G. Cozman"], "venue": "International Journal of Approximate Reasoning, 39 (2\u20133), 167\u2013184.", "citeRegEx": "Cozman,? 2005", "shortCiteRegEx": "Cozman", "year": 2005}, {"title": "The inferential complexity of bayesian and credal networks", "author": ["C.P. De Campos", "F.G. Cozman"], "venue": "In IJCAI-05,", "citeRegEx": "Campos and Cozman,? \\Q2005\\E", "shortCiteRegEx": "Campos and Cozman", "year": 2005}, {"title": "The concept of conditional fuzzy measures", "author": ["L.M. De Campos", "M.T. Lamata", "S. Moral"], "venue": "International Journal of Intelligent Systems,", "citeRegEx": "Campos et al\\.,? \\Q1990\\E", "shortCiteRegEx": "Campos et al\\.", "year": 1990}, {"title": "Updating beliefs with incomplete observations", "author": ["G. De Cooman", "M. Zaffalon"], "venue": "Artificial Intelligence,", "citeRegEx": "Cooman and Zaffalon,? \\Q2004\\E", "shortCiteRegEx": "Cooman and Zaffalon", "year": 2004}, {"title": "Maximum likelihood from incomplete data via the EM algorithm", "author": ["A.P. Dempster", "N.M. Laird", "D.B. Rubin"], "venue": "Journal of the Royal Statistical Society,", "citeRegEx": "Dempster et al\\.,? \\Q1977\\E", "shortCiteRegEx": "Dempster et al\\.", "year": 1977}, {"title": "Pattern Classification and Scene Analysis", "author": ["R.O. Duda", "P.E. Hart"], "venue": null, "citeRegEx": "Duda and Hart,? \\Q1973\\E", "shortCiteRegEx": "Duda and Hart", "year": 1973}, {"title": "A new approach to updating beliefs", "author": ["R. Fagin", "J.Y. Halpern"], "venue": "Uncertainty in Artificial Intelligence,", "citeRegEx": "Fagin and Halpern,? \\Q1991\\E", "shortCiteRegEx": "Fagin and Halpern", "year": 1991}, {"title": "Coarsening at random: characterisations, conjectures and counter-examples", "author": ["R. Gill", "M. Van der Laan", "J. Robins"], "venue": "Proceedings of the first Seattle Conference on Biostatistics,", "citeRegEx": "Gill et al\\.,? \\Q1997\\E", "shortCiteRegEx": "Gill et al\\.", "year": 1997}, {"title": "Ignorability in statistical and probabilistic inference", "author": ["M. Jaeger"], "venue": "Journal of Artificial Intelligence Research, 24, 889\u2013917.", "citeRegEx": "Jaeger,? 2008", "shortCiteRegEx": "Jaeger", "year": 2008}, {"title": "Bayesian updating and belief functions", "author": ["Jaffray", "J.-Y."], "venue": "IEEE Transactions on Systems, Man and Cybernetics, 22, 1144\u20131152.", "citeRegEx": "Jaffray and J..Y.,? 1992", "shortCiteRegEx": "Jaffray and J..Y.", "year": 1992}, {"title": "The Enterprise of Knowledge", "author": ["I. Levi"], "venue": "MIT Press, London.", "citeRegEx": "Levi,? 1980", "shortCiteRegEx": "Levi", "year": 1980}, {"title": "Statistical Analysis with Missing Data", "author": ["R.J.A. Little", "D.B. Rubin"], "venue": null, "citeRegEx": "Little and Rubin,? \\Q1987\\E", "shortCiteRegEx": "Little and Rubin", "year": 1987}, {"title": "Partial Identification of Probability Distributions", "author": ["C.F. Manski"], "venue": "Springer-Verlag, New York.", "citeRegEx": "Manski,? 2003", "shortCiteRegEx": "Manski", "year": 2003}, {"title": "A survey of the theory of coherent lower previsions", "author": ["E. Miranda"], "venue": "International Journal of Approximate Reasoning, 48 (2), 628\u2013658.", "citeRegEx": "Miranda,? 2008", "shortCiteRegEx": "Miranda", "year": 2008}, {"title": "Updating coherent previsions on finite spaces", "author": ["E. Miranda"], "venue": "Fuzzy Sets and Systems, 160 (9), 1286\u20131307.", "citeRegEx": "Miranda,? 2009", "shortCiteRegEx": "Miranda", "year": 2009}, {"title": "Coherence and independence in non-linear spaces", "author": ["E. Miranda", "G. De Cooman"], "venue": "Tech. rep.,", "citeRegEx": "Miranda and Cooman,? \\Q2005\\E", "shortCiteRegEx": "Miranda and Cooman", "year": 2005}, {"title": "Marginal extension in the theory of coherent lower previsions", "author": ["E. Miranda", "G. De Cooman"], "venue": "International Journal of Approximate Reasoning,", "citeRegEx": "Miranda and Cooman,? \\Q2007\\E", "shortCiteRegEx": "Miranda and Cooman", "year": 2007}, {"title": "Probabilistic Reasoning in Intelligent Systems: Networks of Plausible Inference", "author": ["J. Pearl"], "venue": "Morgan Kaufmann, San Mateo.", "citeRegEx": "Pearl,? 1988", "shortCiteRegEx": "Pearl", "year": 1988}, {"title": "Learning from what you don\u2019t observe", "author": ["M.A. Peot", "R.D. Shachter"], "venue": "Uncertainty in Artificial Intelligence (Proceedings of the Fourteenth Conference),", "citeRegEx": "Peot and Shachter,? \\Q1998\\E", "shortCiteRegEx": "Peot and Shachter", "year": 1998}, {"title": "Some observations on inverse probability including a new indifference rule", "author": ["W. Perks"], "venue": "J. Inst. Actuar., 73, 285\u2013312.", "citeRegEx": "Perks,? 1947", "shortCiteRegEx": "Perks", "year": 1947}, {"title": "A tutorial on hidden markov models and selected applications in speech recognition", "author": ["L. Rabiner"], "venue": "Proceedings of the IEEE, 77 (2), 257\u2013286.", "citeRegEx": "Rabiner,? 1989", "shortCiteRegEx": "Rabiner", "year": 1989}, {"title": "Robust learning with missing data", "author": ["M. Ramoni", "P. Sebastiani"], "venue": "Machine Learning,", "citeRegEx": "Ramoni and Sebastiani,? \\Q2001\\E", "shortCiteRegEx": "Ramoni and Sebastiani", "year": 2001}, {"title": "Conditional probability", "author": ["G. Shafer"], "venue": "International Statistical Review, 53, 261\u2013277.", "citeRegEx": "Shafer,? 1985", "shortCiteRegEx": "Shafer", "year": 1985}, {"title": "Me\u00dffehler und Information", "author": ["V. Strassen"], "venue": "Zeitschrift f\u00fcr Wahrscheinlichkeitstheorie und Verwandte Gebiete, 2, 273\u2013305.", "citeRegEx": "Strassen,? 1964", "shortCiteRegEx": "Strassen", "year": 1964}, {"title": "Decision making under uncertainty using imprecise probabilities: an introductory overview", "author": ["M.C.M. Troffaes"], "venue": "International Journal of Approximate Reasoning, 45 (1), 17\u201329.", "citeRegEx": "Troffaes,? 2007", "shortCiteRegEx": "Troffaes", "year": 2007}, {"title": "Coherent lower (and upper) probabilities", "author": ["P. Walley"], "venue": "Tech. rep. Statistics Research Report 22, University of Warwick, Coventry.", "citeRegEx": "Walley,? 1981", "shortCiteRegEx": "Walley", "year": 1981}, {"title": "Statistical Reasoning with Imprecise Probabilities", "author": ["P. Walley"], "venue": "Chapman and Hall, New York.", "citeRegEx": "Walley,? 1991", "shortCiteRegEx": "Walley", "year": 1991}, {"title": "Inferences from multinomial data: learning about a bag of marbles", "author": ["P. Walley"], "venue": "J. R. Statist. Soc. B, 58 (1), 3\u201357.", "citeRegEx": "Walley,? 1996a", "shortCiteRegEx": "Walley", "year": 1996}, {"title": "Measures of uncertainty in expert systems", "author": ["P. Walley"], "venue": "Artificial Intelligence, 83 (1), 1\u201358.", "citeRegEx": "Walley,? 1996b", "shortCiteRegEx": "Walley", "year": 1996}, {"title": "Direct algorithms for checking consistecy and making inferences for conditional probability assessments", "author": ["P. Walley", "R. Pelessoni", "P. Vicig"], "venue": "Journal of Statistical Planning and Inference,", "citeRegEx": "Walley et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Walley et al\\.", "year": 2004}, {"title": "Statistical inference of the naive credal classifier", "author": ["M. Zaffalon"], "venue": "De Cooman, G., Fine, T. L., & Seidenfeld, T. (Eds.), ISIPTA \u201901: Proceedings of the Second International Symposium on Imprecise Probabilities and Their Applications, pp. 384\u2013393, The Netherlands. Shaker.", "citeRegEx": "Zaffalon,? 2001", "shortCiteRegEx": "Zaffalon", "year": 2001}, {"title": "Exact credal treatment of missing data", "author": ["M. Zaffalon"], "venue": "Journal of Statistical Planning and Inference, 105 (1), 105\u2013122.", "citeRegEx": "Zaffalon,? 2002", "shortCiteRegEx": "Zaffalon", "year": 2002}, {"title": "Conservative rules for predictive inference with incomplete data", "author": ["M. Zaffalon"], "venue": "Cozman, F. G., Nau, R., & Seidenfeld, T. (Eds.), ISIPTA \u201905: Proceedings of the Fourth International Symposium on Imprecise Probabilities and Their Applications, pp. 406\u2013415, Manno, Switzerland. SIPTA.", "citeRegEx": "Zaffalon,? 2005", "shortCiteRegEx": "Zaffalon", "year": 2005}], "referenceMentions": [{"referenceID": 27, "context": "Let us make this more concrete with the help of the graphical language of Bayesian networks (Pearl, 1988):2 consider the well-known \u2018Asia\u2019 net displayed in Figure 1, which is intended to model an artificial medical problem.", "startOffset": 92, "endOffset": 105}, {"referenceID": 36, "context": "De Cooman and Zaffalon (2004) tried to remedy this by an approach to IPs alternative to CAR that is based on coherent lower previsions (Walley, 1991), i.", "startOffset": 135, "endOffset": 149}, {"referenceID": 16, "context": "The assumption that models non-selectiveness is called coarsening at random (or CAR, see Gill et al., 1997), or missing at random (or MAR, see Little & Rubin, 1987) in the special case of missingness processes (see also Jaeger, 2008). CAR implies that the incompleteness is non-informative and can be ignored; it thus creates the formal basis for applying the methods developed for complete information to the incomplete case. For example, if we assume that the vector (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032) has been created by a CAR IP, then we are allowed to infer the value of R on the sole basis of the subvector (h\u2032\u2032, a\u2032); more precisely, if we aim at computing the posterior probability of R = r\u2032, CAR allows us to write P (R = r\u2032|W = (?, ?, ?, h\u2032\u2032, ?, ?, a\u2032)) = P (R = r\u2032|H = h\u2032\u2032, A = a\u2032). But this is not the case in general. In fact, incompleteness may well be informative. For example, in the Asia network, it may be the case that the information on whether or not a person has been to Asia is not provided with the same frequency in the two groups. This is an example of incompleteness generated within a communication protocol, where giving or not some information is a key part of the communication. This somewhat selective way of reporting information, albeit very frequent, is not compatible with the CAR assumption. This was pointed out long ago by Shafer (1985), who also has outlined the implications as well as the complications for uncertain reasoning: among these, the fact that modelling IPs can be a very difficult task.", "startOffset": 89, "endOffset": 1365}, {"referenceID": 13, "context": "De Cooman and Zaffalon (2004) tried to remedy this by an approach to IPs alternative to CAR that is based on coherent lower previsions (Walley, 1991), i.", "startOffset": 3, "endOffset": 30}, {"referenceID": 13, "context": "De Cooman and Zaffalon (2004) tried to remedy this by an approach to IPs alternative to CAR that is based on coherent lower previsions (Walley, 1991), i.e., closed convex sets of probabilities also called credal sets by Levi (1980). This has led to a rule for updating beliefs under incomplete information in expert systems called the conservative updating rule (CUR).", "startOffset": 3, "endOffset": 232}, {"referenceID": 35, "context": "To this aim, we first give advanced notions about coherent lower previsions in Section 6, such as updating, independence, and coherence in the sense of Walley (1991). Then we state a number of probabilistic assumptions in Section 7.", "startOffset": 152, "endOffset": 166}, {"referenceID": 33, "context": "We refer the reader to the work of Walley (1991) for an in-depth study of coherent lower previsions, and to the paper by Miranda (2008) for a survey of the theory.", "startOffset": 35, "endOffset": 49}, {"referenceID": 23, "context": "We refer the reader to the work of Walley (1991) for an in-depth study of coherent lower previsions, and to the paper by Miranda (2008) for a survey of the theory.", "startOffset": 121, "endOffset": 136}, {"referenceID": 23, "context": "We refer to the work by Miranda and De Cooman (2005) and Walley (1991) for more general definitions of the following notions in this section in terms of partitions, and for domains that are not necessarily (these) linear sets of gambles.", "startOffset": 24, "endOffset": 53}, {"referenceID": 23, "context": "We refer to the work by Miranda and De Cooman (2005) and Walley (1991) for more general definitions of the following notions in this section in terms of partitions, and for domains that are not necessarily (these) linear sets of gambles.", "startOffset": 24, "endOffset": 71}, {"referenceID": 13, "context": "On the other hand, if there is no CAR component, and the overall IP is unknown, CIR is similar to (but more powerful than) the so-called conservative updating rule (CUR) proposed by De Cooman and Zaffalon (2004). When both components are present, CIR acts as a mix of traditional updating and CUR.", "startOffset": 185, "endOffset": 212}, {"referenceID": 41, "context": "contributions in the literature similar to CIR for the case of statistical model learning from samples made incomplete by an unknown missingness process (e.g., Manski, 2003; Ramoni & Sebastiani, 2001; Zaffalon, 2002).", "startOffset": 153, "endOffset": 216}, {"referenceID": 9, "context": "Credal networks, for example, provide such modelling capabilities (Cozman, 2000, 2005). It is easy to rephrase expert system models in the setting of this paper. Say that the expert system is based on the vector of variables (Z, \u02321, . . . , \u0232m, \u01761, . . . , \u0176n), where Z is the target variable, and the others are those subject to the unknown and the CAR IP, respectively. Then it is sufficient to write \u0232 := (\u02321, . . . , \u0232m), \u0176 := (\u01761, . . . , \u0176n), and to consider that a set M of joint mass functions for (Z, Y ), or equivalently the lower prevision P 1 made by taking its lower envelope, is given. Doing inference with an expert system, in quite a general form, corresponds then to compute R(g|w\u0304, \u0175), where w\u0304 is now the observation of the \u0232 vector and \u0175 that of the \u0176 vector. We consider some cases to make things clearer. At an extreme, which we already mentioned, there is the case m = 0, which means that there is only the CAR IP. The updating rule that follows from CIR is then the traditional updating: R(g|\u0175) = R(g|{\u0175}\u2217). Say that, to be even more specific, g is the indicator function Iz of some z \u2208 Z, and that {\u0175}\u2217 = {(\u01771, . . . , \u0177j , \u0177\u2032 j+1, . . . , \u0177\u2032 n) \u2208 \u0176 : \u0177\u2032 j+1 \u2208 \u0176j+1, . . . , \u0177\u2032 n \u2208 \u0176n)}, i.e., that the first j variables of \u0176 are observed precisely, while the others are missing. The updating rule becomes: R(g|{\u0175}\u2217) = R(Iz|\u01771, . . . , \u0177j , \u0176j+1, . . . , \u0176n) = R(Iz|\u01771, . . . , \u0177j), which is equal to infP\u2265P 1:P (\u01771,...,\u0177j)>0 P (z|\u01771, . . . , \u0177j). The latter is an updating rule implemented by credal networks; and if P 1 is a linear prevision, it is the rule used with Bayesian networks. Consider now the other extreme: n = 0, i.e., when there is only the unknown IP. Similarly to the previous case, say that g is the indicator function for z; and that {w\u0304}\u2217 = {(\u02331, . . . , \u0233i, \u0233\u2032 i+1, . . . , \u0233\u2032 m) \u2208 \u0232 : \u0233\u2032 i+1 \u2208 \u0232i+1, . . . , \u0233\u2032 m \u2208 \u0232m)}. CIR becomes then R(g|w\u0304) = min\u0233i+1\u2208\u0232i+1,...,\u0233m\u2208\u0232m infP\u2265P 1:P (\u02331,...,\u0233m)>0 P (z|\u02331, . . . , \u0233m). This case nearly coincides with the conservative updating rule proposed by De Cooman and Zaffalon (2004), with the differences already discussed in Section 4.", "startOffset": 67, "endOffset": 2071}, {"referenceID": 0, "context": "In the context of doing classification with Bayesian nets according to CUR, Antonucci and Zaffalon (2007) have proved an NP-hardness result, as well as given an exact algorithm.", "startOffset": 76, "endOffset": 106}, {"referenceID": 0, "context": "In the context of doing classification with Bayesian nets according to CUR, Antonucci and Zaffalon (2007) have proved an NP-hardness result, as well as given an exact algorithm. The algorithm is a variant of the variable elimination algorithm that has a better complexity than the traditional algorithms on Bayesian nets (implicitly using CAR): it works in linear time not only on polytree networks (i.e., those for which there is at most one path between any two nodes in the graph after dropping the orientation of the arcs) but also on a number of more general nets; on the remaining ones it takes exponential time. Moreover, in another paper, Antonucci and Zaffalon (2006) have shown that when there are missing observations the problem of CIR-updating in Bayesian nets and that of traditional (i.", "startOffset": 76, "endOffset": 677}, {"referenceID": 29, "context": "Setting s := 1 and t\u2032 := 1/2, namely, Perks\u2019 prior (see Perks, 1947), we obtain 1+st \u2032 3+s = 0.375, which can be regarded as an approximation to the true parameter value. Imprecise probability approaches to parametric inference often extend Bayesian statistical methods by working with a set of prior density functions, and by updating each of them by Bayes\u2019 rule, whenever possible, using the same likelihood function, thus obtaining a set of posteriors. An example is the imprecise Dirichlet model proposed by Walley (1996a). In our notation and terminology, this means that in the imprecise case parametric inference is based on the unconditional lower prevision P 1(\u0398, Y ), obtained by means of the prior P 1(\u0398) and the likelihood P (Y |\u0398) through a rule called marginal extension, that is updated into the posterior lower prevision R(\u0398|Y ) by a procedure called regular extension.", "startOffset": 38, "endOffset": 527}, {"referenceID": 41, "context": "This is a very intuitive procedure; therefore, it is not surprising that analogous procedures have already been advocated with missing data in the context of robust statistical inference (see, e.g., Manski, 2003; Ramoni & Sebastiani, 2001; Zaffalon, 2002).", "startOffset": 187, "endOffset": 255}, {"referenceID": 34, "context": "Walley (1991) calls maximality the related decision criterion.", "startOffset": 0, "endOffset": 14}, {"referenceID": 34, "context": "See the work of Troffaes (2007) for a comparison with other criteria.", "startOffset": 16, "endOffset": 32}, {"referenceID": 23, "context": "2) established by Miranda and De Cooman (2007).", "startOffset": 18, "endOffset": 47}, {"referenceID": 23, "context": "One can create a symmetric notion of epistemic independence (see, e.g., Walley, 1991; Miranda, 2008) by requiring that both Xj is irrelevant to Xi and Xi is irrelevant to Xj ; still, strong independence implies epistemic independence but the other way around does not hold.", "startOffset": 60, "endOffset": 100}, {"referenceID": 35, "context": "We refer to Sections 2 and 6 and, more generally, to the book by Walley (1991) for the concepts and results we shall need.", "startOffset": 65, "endOffset": 79}, {"referenceID": 22, "context": "But also on the formal level, recent research has suggested that CAR should be assumed to hold less frequently that it appears to be in practice (Gr\u00fcnwald & Halpern, 2003); and one should also remember that there is no way to test CAR statistically (Manski, 2003), so that there is always some degree of arbitrariness in assuming it.", "startOffset": 249, "endOffset": 263}, {"referenceID": 32, "context": "It is not saying anything new: the difficulty in modelling IPs has been pointed out already long ago (Shafer, 1985; Gr\u00fcnwald & Halpern, 2003).", "startOffset": 101, "endOffset": 141}, {"referenceID": 13, "context": "This has been already discussed by De Cooman and Zaffalon (2004), who proposed the regular extension as a more effective updating rule.", "startOffset": 38, "endOffset": 65}, {"referenceID": 35, "context": "These hypotheses guarantee that we can use Walley\u2019s notion of regular extension to update our beliefs and that the assessments thus obtained are coherent with our initial assessments. We should like to conclude this section commenting also a bit on some of the assumptions we have considered in the construction of our model and in some open problems that we can derive from this work. One point is the requirement that some of the spaces of possibilities be finite. This could be relaxed by taking into account that a conditional prevision defined by regular extension can be coherent with the unconditional it is derived from even in the infinite case. However, we cannot guarantee that the third point of Lemma 2 in Appendix B holds in these more general situations, and this point is necessary for the proof of Theorem 3. This is related to the notion of conglomerability discussed in much detail by Walley (1991). An open problem would be to extend our results to more general situations by addressing the question of conglomerability.", "startOffset": 43, "endOffset": 918}, {"referenceID": 35, "context": "These hypotheses guarantee that we can use Walley\u2019s notion of regular extension to update our beliefs and that the assessments thus obtained are coherent with our initial assessments. We should like to conclude this section commenting also a bit on some of the assumptions we have considered in the construction of our model and in some open problems that we can derive from this work. One point is the requirement that some of the spaces of possibilities be finite. This could be relaxed by taking into account that a conditional prevision defined by regular extension can be coherent with the unconditional it is derived from even in the infinite case. However, we cannot guarantee that the third point of Lemma 2 in Appendix B holds in these more general situations, and this point is necessary for the proof of Theorem 3. This is related to the notion of conglomerability discussed in much detail by Walley (1991). An open problem would be to extend our results to more general situations by addressing the question of conglomerability. On the other hand, as we said, our results are applicable even if the target space Z of our variable of interest, Z, is infinite. This has allowed us, for instance, to model parametric inference in the case where the parameter space is infinite, as discussed in Section 5.2. Moreover, we are not assuming that the upper probability of the values of Z is positive, and this allows us to include the case where our prior beliefs about the parameter are precise and the parameter space is infinite, which coincides with the traditional setup. Another important point is our assumption on the domains of our lower previsions: we have required for instance that P 1(Z, Y ) is defined on the set of all XZ\u222aY -measurable gambles. Similar considerations have been made for P 2(W\u0304 |\u0232 ) and P 3(\u0174 |\u0176 ). When these requirements are not met, we can still apply our results by extending our assessments using the notion of natural extension given by Walley (1991). It is easy to see that these extensions will satisfy the hypotheses of our theorems.", "startOffset": 43, "endOffset": 1992}, {"referenceID": 42, "context": "Preliminary work on the topic of this paper appeared in the proceedings of ISIPTA \u201905: the fourth International Symposium on Imprecise Probabilities and Their Applications (Zaffalon, 2005).", "startOffset": 172, "endOffset": 188}, {"referenceID": 23, "context": "From the results by Miranda and De Cooman (2007), if we let Pj(XOj |XIj ) be an extreme point ofM(P j(XOj |XIj )) for j = 1, .", "startOffset": 20, "endOffset": 49}, {"referenceID": 23, "context": "It is a consequence of the marginal extension theorem by Miranda and De Cooman (2007) that for any \u03bb \u2208 \u039b the previsions P\u03bb, P\u03bb(XO1 |XA1\u222aI1), .", "startOffset": 57, "endOffset": 86}, {"referenceID": 23, "context": "It is a consequence of the marginal extension theorem by Miranda and De Cooman (2007) that for any \u03bb \u2208 \u039b the previsions P\u03bb, P\u03bb(XO1 |XA1\u222aI1), . . . , P\u03bb(XOm |XAm\u222aIm) are coherent. Applying Theorem 8.1.6 in Walley (1991), we deduce that the lower envelopes of these families, which are the lower previsions P , P 1(XO1 |XA1\u222aI1), .", "startOffset": 57, "endOffset": 219}, {"referenceID": 35, "context": "4 in the book of Walley (1991) to deduce that the coherence of P ,R(XO|XI) is equivalent to P (Iz(f \u2212R(f |z))) = 0 for all z \u2208 XI .", "startOffset": 17, "endOffset": 31}, {"referenceID": 23, "context": "From Miranda and Zaffalon (2009, Theorem 1), P 1(XO1 |XI1), . . . , Pm(XOm |XIm) are weakly coherent if and only if there is a joint lower prevision P (X1, . . . , Xn) that is pairwise coherent with each conditional lower prevision P j(XOj |XIj ) in the collection. Similar results hold in the case where we focus on collections made of linear previsions, with the difference that the joint whose existence is equivalent to weak coherence is linear, too. However, under the behavioural interpretation, a number of weakly coherent conditional lower previsions can still present some forms of inconsistency; see Walley (1991, Example 7.3.5) for an example and Walley (1991, Chapter 7), Walley, Pelessoni, and Vicig (2004), Miranda (2009) for some discussion.", "startOffset": 5, "endOffset": 720}, {"referenceID": 23, "context": "From Miranda and Zaffalon (2009, Theorem 1), P 1(XO1 |XI1), . . . , Pm(XOm |XIm) are weakly coherent if and only if there is a joint lower prevision P (X1, . . . , Xn) that is pairwise coherent with each conditional lower prevision P j(XOj |XIj ) in the collection. Similar results hold in the case where we focus on collections made of linear previsions, with the difference that the joint whose existence is equivalent to weak coherence is linear, too. However, under the behavioural interpretation, a number of weakly coherent conditional lower previsions can still present some forms of inconsistency; see Walley (1991, Example 7.3.5) for an example and Walley (1991, Chapter 7), Walley, Pelessoni, and Vicig (2004), Miranda (2009) for some discussion.", "startOffset": 5, "endOffset": 736}, {"referenceID": 33, "context": ", k, it follows from [Appendix J3] in the book of Walley (1991) that P and Pm+j(XOm+j |XIm+j ) are coherent.", "startOffset": 50, "endOffset": 64}, {"referenceID": 23, "context": "Applying Theorem 1 by Miranda and Zaffalon (2009), we deduce that the previsions P , P 1(XO1 |XI1), .", "startOffset": 22, "endOffset": 50}, {"referenceID": 23, "context": "Applying Theorem 1 by Miranda and Zaffalon (2009), we deduce that the previsions P , P 1(XO1 |XI1), . . . , Pm+k(XOm+k |XIm+k) are weakly coherent. Hence, Theorem 7.1.5 by Walley (1991) implies that it suffices to show that P 1(XO1 |XI1), .", "startOffset": 22, "endOffset": 186}, {"referenceID": 23, "context": ", Pm(XOm |XIm) on the one hand and the conditional assessments P (\u0174 |\u0176 ), P (W\u0304 |\u0232 ) on the other hand: from the results by Miranda and De Cooman (2007), the extreme points of the set M(P (XO1 , .", "startOffset": 124, "endOffset": 153}, {"referenceID": 23, "context": "It is enough to observe that the probabilistic assessments used to build credal networks lead to an A1+ coherence graph, as detailed in Theorem 8 by Miranda and Zaffalon (2009), and that such a graph, supplemented with the parts for P (W\u0304 |\u0232 ) and P (\u0174 |\u0176 ), remains an A1+ graph.", "startOffset": 149, "endOffset": 177}], "year": 2009, "abstractText": "In this paper we formulate the problem of inference under incomplete information in very general terms. This includes modelling the process responsible for the incompleteness, which we call the incompleteness process. We allow the process\u2019 behaviour to be partly unknown. Then we use Walley\u2019s theory of coherent lower previsions, a generalisation of the Bayesian theory to imprecision, to derive the rule to update beliefs under incompleteness that logically follows from our assumptions, and that we call conservative inference rule. This rule has some remarkable properties: it is an abstract rule to update beliefs that can be applied in any situation or domain; it gives us the opportunity to be neither too optimistic nor too pessimistic about the incompleteness process, which is a necessary condition to draw reliable while strong enough conclusions; and it is a coherent rule, in the sense that it cannot lead to inconsistencies. We give examples to show how the new rule can be applied in expert systems, in parametric statistical inference, and in pattern classification, and discuss more generally the view of incompleteness processes defended here as well as some of its consequences.", "creator": "TeX"}}}