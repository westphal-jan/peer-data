{"id": "1604.01376", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "4-Apr-2016", "title": "Lipschitz Continuity of Mahalanobis Distances and Bilinear Forms", "abstract": "Many theoretical results in the machine learning domain stand only for functions that are Lipschitz continuous. Lipschitz continuity is a strong form of continuity that linearly bounds the variations of a function. In this paper, we derive tight Lipschitz constants for two families of metrics: Mahalanobis distances and bounded-space bilinear forms. To our knowledge, this is the first time the Mahalanobis distance is formally proved to be Lipschitz continuous and that such tight Lipschitz constants are derived.", "histories": [["v1", "Mon, 4 Apr 2016 12:39:26 GMT  (8kb)", "http://arxiv.org/abs/1604.01376v1", null]], "reviews": [], "SUBJECTS": "cs.NA cs.LG", "authors": ["valentina zantedeschi", "r\\'emi emonet", "marc sebban"], "accepted": false, "id": "1604.01376"}, "pdf": {"name": "1604.01376.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": ["remi.emonet@univ-st-etienne.fr", "valentina.zantedeschi@univ-st-etienne.fr", "marc.sebban@univ-st-etienne.fr"], "sections": [{"heading": null, "text": "ar X\niv :1\n60 4.\n01 37"}, {"heading": "1 Multi-variate Lipschitz continuity", "text": "A function is said Lipschitz continuous if it takes similar values on points that are close. More precisely, the slope of the function is bounded by a constant that is independent of the choice of points. This means that the variation of a function that is Lipschitz continuous within a certain interval is small. The Lipschitz continuity is a strong form of uniform continuity: for instance, a function that is Lipschitz continuous is also continuous, but the reverse is not necessarily true. Let\u2019s take the example of the square function: x2 is continuous on Rm but it is not Lipschitz continuous (the slope of x2 is not bounded).\nWe now consider the Lipschitz continuity for a function f : X 2 \u2282 Rd\u00d7Rd \u2192 R.\nDefinition 1.1. (Multi-variate Lipschitz continuity) A function f : X 2 \u2282 Rd\u00d7 R\nd \u2192 R is said kn-lipschitz w.r.t. the norm \u2016.\u2016n if \u2200(x1, x2, x\u20321, x\u20322) \u2208 X 4:\n|f(x1, x2)\u2212 f(x\u20321, x\u20322)| \u2264 kn \u2225 \u2225 \u2225\n\u2225\n(\nx1\nx2\n) \u2212 ( x\u20321 x\u20322\n)\u2225\n\u2225 \u2225 \u2225\nn\n. (1)\nIf f is differentiable on X 2 \u2282 Rd \u00d7 Rd and X 2 is a convex space, the best constant kn, the characteristic Lipschitz coefficient, can be estimated considering the fact that\nkn = sup x1,x2,x \u2032\n1 ,x\u2032 2 \u2208X\n(\n|f(x1, x2)\u2212 f(x\u20321, x\u20322)| \u2225\n\u2225 \u2225\n(\nx1 x2\n) \u2212 ( x\u2032 1\nx\u2032 2\n)\n\u2225 \u2225 \u2225\nn\n)\n=\n= sup x1,x2\u2208X\n\u2016\u2207f(x1, x2)\u2016n . (2)"}, {"heading": "2 Derivation for Particular Functions", "text": "In this section, we analyze the Lipschitz continuity of two classic metric functions: the Mahalanobis distance and the bilinear form. These two functions are largely used in the field of Machine Learning, especially in Metric Learning."}, {"heading": "2.1 Derivation for Mahalanobis-like Distances", "text": "We recall that the Mahalanobis distance of a pair (x1, x2) \u2208 X 2 can be written as dM (x1, x2) = \u221a\n(x1 \u2212 x2)TM(x1 \u2212 x2) where M is some Positive Semi-Definite matrix, whose coefficients can be optimized. By Def. 1.1, the function dM : X 2 \u2192 R is kn-lipschitz w.r.t. the norm \u2016.\u2016n if \u2200x1, x2 \u2208 X , \u2016\u2207dM (x1, x2)\u2016n can be bounded by a constant kn, where\n\u2207dM (x1, x2) = (\u2202dM (x1,x2) \u2202x1\n\u2202dM (x1,x2) \u2202x2\n)\nand, for this particular case:\n\u2202dM (x1, x2)\n\u2202x1 =\n1\n2 \u221a (x1 \u2212 x2)TM(x1 \u2212 x2) \u2202 \u2202x1\n( (x1 \u2212 x2)TM(x1 \u2212 x2) )\n= 1\n2 \u221a (x1 \u2212 x2)TM(x1 \u2212 x2) \u2202 \u2202x1 ( xT1 Mx1 \u2212 xT2 Mx1 \u2212 xT1 Mx2 + xT2 Mx2 )\n(3)\n= 2Mx1 \u2212Mx2 \u2212Mx2\n2 \u221a (x1 \u2212 x2)TM(x1 \u2212 x2) (4)\n= Mx1 \u2212Mx2 \u221a\n(x1 \u2212 x2)TM(x1 \u2212 x2) =\nM(x1 \u2212 x2) \u221a\n(x1 \u2212 x2)TM(x1 \u2212 x2)\nand, in the same way:\n\u2202dM (x1, x2)\n\u2202x2 =\nM(x2 \u2212 x1) \u221a\n(x1 \u2212 x2)TM(x1 \u2212 x2) .\nIn Eq. 3 and 4 we made use of the symmetry of the matrix M .\nLemma 2.1. The Mahalanobis distance dM (x1, x2) is k-lipschitz w.r.t. the norm \u2016.\u20162, with k = \u221a 2 \u2016L\u20162, where M = LTL, with L a lower triangular matrix.\nProof.\nmax x1,x2\u2208X\n\u2016\u2207dM (x1, x2)\u20162\n= max x1,x2\u2208X\n\u221a\n\u2225 \u2225 \u2225 \u2225 \u2202dM (x1, x2)\n\u2202x1\n\u2225 \u2225 \u2225 \u2225 2\n2\n+\n\u2225 \u2225 \u2225 \u2225 \u2202dM (x1, x2)\n\u2202x2\n\u2225 \u2225 \u2225 \u2225 2\n2\n= max x1,x2\u2208X\n\u221a \u221a \u221a \u221a \u2225 \u2225 \u2225\n\u2225 \u2225\nM(x1 \u2212 x2) \u221a\n(x1 \u2212 x2)TM(x1 \u2212 x2)\n\u2225 \u2225 \u2225 \u2225 \u2225 2\n2\n+\n\u2225 \u2225 \u2225 \u2225 \u2225 M(x2 \u2212 x1) \u221a\n(x1 \u2212 x2)TM(x1 \u2212 x2)\n\u2225 \u2225 \u2225 \u2225 \u2225 2\n2\n= max x1,x2\u2208X\n\u221a \u221a \u221a \u221a2 \u2225 \u2225 \u2225\n\u2225 \u2225\nM(x1 \u2212 x2) \u221a\n(x1 \u2212 x2)TM(x1 \u2212 x2)\n\u2225 \u2225 \u2225 \u2225 \u2225 2\n2\n= max x1,x2\u2208X\n\u221a \u221a \u221a \u221a2 \u2225 \u2225 \u2225\n\u2225 \u2225\nLTL(x1 \u2212 x2) \u221a\n(x1 \u2212 x2)TLTL(x1 \u2212 x2)\n\u2225 \u2225 \u2225 \u2225 \u2225 2\n2\n(5)\n= max x1,x2\u2208X\n\u221a \u221a \u221a \u221a2 \u2225 \u2225 \u2225\n\u2225 \u2225\nLT (L(x1 \u2212 x2)) \u221a\n(L(x1 \u2212 x2))TL(x1 \u2212 x2)\n\u2225 \u2225 \u2225 \u2225 \u2225 2\n2\n= max x1,x2\u2208X\n\u221a\n2\n\u2225 \u2225 \u2225 \u2225 LT (L(x1 \u2212 x2)) \u2016L(x1 \u2212 x2)\u20162 \u2225 \u2225 \u2225 \u2225 2 2\n\u2264 max x1,x2\u2208X\n\u221a\n2 \u2016LT\u20162 \u2225 \u2225 \u2225\n\u2225 (L(x1 \u2212 x2)) \u2016L(x1 \u2212 x2)\u20162\n\u2225 \u2225 \u2225 \u2225 2\n2\n(6)\n\u2264 \u221a 2 \u2225 \u2225LT \u2225 \u2225\n2 = k. (7)\nIn Eq. 5 we applied the Cholesky decomposition M = LTL, the bound in\n6 is due to the Cauchy-Schwarz inequality and in Eq. 7 \u2225 \u2225\n\u2225 (L(x1\u2212x2)) \u2016L(x1\u2212x2)\u20162\n\u2225 \u2225 \u2225\n2 = 1\nbecause it is a normalized vector."}, {"heading": "2.2 Derivation for Bilinear Forms", "text": "We recall that the bilinear form of a pair (x1, x2) is computed as dM (x1, x2) = xT1 Mx2, where M is a generic matrix that can be optimized. Then:\n\u2202dM (x1, x2)\n\u2202x1 =\n\u2202\n\u2202x1\n( xT1 Mx2) ) = Mx2\n\u2202dM (x1, x2)\n\u2202x2 =\n\u2202\n\u2202x2\n( xT1 Mx2) ) = MTx1.\nLemma 2.2. The bilinear similarity dM (x1, x2) = x T 1 Mx2 is k-lipschitz w.r.t.\nthe norm \u2016.\u20162, with k = \u221a 2 \u2016M\u20162 R, when \u2016x\u20162 \u2264 R \u2200x \u2208 X .\nProof.\nmax \u2200x1,x2\u2208U \u2016\u2207dM (x1, x2)\u20162 = max \u2200x1,x2\u2208U\n\u221a\n\u2225 \u2225 \u2225 \u2225 \u2202dM (x1, x2)\n\u2202x1\n\u2225 \u2225 \u2225 \u2225 2\n2\n+\n\u2225 \u2225 \u2225 \u2225 \u2202dM (x1, x2)\n\u2202x2\n\u2225 \u2225 \u2225 \u2225 2\n2\n= max \u2200x1,x2\u2208U\n\u221a\n\u2016Mx2\u201622 + \u2016MTx1\u2016 2 2\n\u2264 \u221a 2 \u2016M\u20162 R = k. (8)"}, {"heading": "3 Conclusion", "text": "In this paper, we recalled a method for proving the Lipschitz continuity and for finding a tight Lipschitz constant of multivariate differentiable functions. Using this approach, we computed tight Lipschitz constants for two families of metrics that are heavily used, especially in metric learning. We have shown that the Mahalanobis distance is Lipschitz continuous and has a constant of \u221a 2 \u2016L\u20162 (where L is the square root of the correlation matrix). We have also shown that the bilinear form xMy is Lipschitz continuous with a constant \u221a 2 \u2016M\u20162 R (when the space is bounded by R). Many theoretical results in the machine learning domain rely on Lipschitz continuity and depend on the Lipschitz constants. For example, the generalization bounds obtained in the context of the uniform stability (see [1]) can be derived by constraining the studied functions to be Lipschitz continuous and the tightness of those bounds depends on the value of the Lipschitz constant. The derivations from this paper have been originally developed to derive theoretical bounds for [2]. We believe these results can also be used to derive tighter theoretical bounds in other domains of machine learning."}], "references": [{"title": "Metric learning", "author": ["A. Bellet", "A. Habrard", "M. Sebban"], "venue": "Synthesis Lectures on Artificial Intelligence and Machine Learning,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2015}, {"title": "Metric learning as convex combinations of local models with generalization guarantees", "author": ["V. Zantedeschi", "R. Emonet", "M. Sebban"], "venue": "In Computer Vision and Pattern Recognition,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2016}], "referenceMentions": [], "year": 2016, "abstractText": "Many theoretical results in the machine learning domain stand only for functions that are Lipschitz continuous. Lipschitz continuity is a strong form of continuity that linearly bounds the variations of a function. In this paper, we derive tight Lipschitz constants for two families of metrics: Mahalanobis distances and bounded-space bilinear forms. To our knowledge, this is the first time the Mahalanobis distance is formally proved to be Lipschitz continuous and that such tight Lipschitz constants are derived.", "creator": "LaTeX with hyperref package"}}}