{"id": "1605.06421", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "20-May-2016", "title": "Root-cause analysis for time-series anomalies via spatiotemporal causal graphical modeling", "abstract": "Modern distributed cyber-physical systems encounter a large variety of anomalies and in many cases, they are vulnerable to catastrophic fault propagation scenarios due to strong connectivity among the sub-systems. In this regard, root-cause analysis becomes highly intractable due to complex fault propagation mechanisms in combination with diverse operating modes. This paper presents a new data-driven framework for root-cause analysis for addressing such issues. The framework is based on a spatiotemporal feature extraction scheme for multivariate time series built on the concept of symbolic dynamics for discovering and representing causal interactions among subsystems of a complex system. We propose sequential state switching ($S^3$) and artificial anomaly association ($A^3$) methods to implement root-cause analysis in an unsupervised and semi-supervised manner respectively. Synthetic data from cases with failed pattern(s) and anomalous node are simulated to validate the proposed approaches, then compared with the performance of vector autoregressive (VAR) model-based root-cause analysis. The results show that: (1) $S^3$ and $A^3$ approaches can obtain high accuracy in root-cause analysis and successfully handle multiple nominal operation modes, and (2) the proposed tool-chain is shown to be scalable while maintaining high accuracy.", "histories": [["v1", "Fri, 20 May 2016 16:17:59 GMT  (336kb)", "http://arxiv.org/abs/1605.06421v1", "Submitted to NIPS 2016"]], "COMMENTS": "Submitted to NIPS 2016", "reviews": [], "SUBJECTS": "cs.LG", "authors": ["chao liu", "kin gwn lore", "soumik sarkar"], "accepted": false, "id": "1605.06421"}, "pdf": {"name": "1605.06421.pdf", "metadata": {"source": "CRF", "title": "Root-cause analysis for time-series anomalies via spatiotemporal causal graphical modeling", "authors": ["Chao Liu"], "emails": ["cliu5@iastate.edu", "kglore@iastate.edu", "soumiks@iastate.edu"], "sections": [{"heading": null, "text": "ar X\niv :1\n60 5.\n06 42\n1v 1\n[ cs\n.L G"}, {"heading": "1 Introduction", "text": "With the advent ubiquitous sensing, advanced computation and strong connectivity, modern distributed cyber-physical systems (CPSs) such as power plants, integrated buildings, transportation networks and power-grids have shown tremendous potential of increased efficiency, robustness and resilience. From the perspective of performance monitoring, anomaly detection and root-cause analysis of such systems, technical challenges arise from a large number of subsystems that are highly interactive and operate in diverse modes.\nFor the purpose of root-cause analysis for time-series anomalies in complex systems, Granger causality is applied to model the system-wide behavior and capture the variation that can be used to implement root-cause analysis. With multivariate time series data, studies show that the causality from and to the fault variable presents differences and can be used to reason the root-cause [1\u20134]. For anomaly detection in time series, Qiu et. al. [5] derived neighborhood similarity and coefficient similarity from Granger-Lasso algorithm, to compute anomaly score and ascertain threshold for\nanomaly detection. A causality analysis index based on dynamic time warping is proposed by Li et. al. [6] to determine the causal direction between pairs of faulty variables in order to overcome the shortcoming of Granger causality in nonstationary time series. Fault related variables can be clustered and root-cause analysis is implemented in each cluster. A dynamic uncertain causality graph is proposed for probabilistic reasoning and applied to fault diagnosis of generator system of nuclear power plant [7]. Also, Bayesian network has been applied in cyber-physical systems to implement anomaly detection and root-cause analysis [8]. The proposed approaches provide efficient tools in discovering causality in complex systems, while an approach in inferencing (interpreting the variation in causality into decisions on failed patterns of fault variable/node) is less investigated.\nIn this context, we present a semi-supervised tool for root-cause analysis in complex systems based on a data driven framework proposed for system-wide time-series anomaly detection in distributed complex system [9], and using a spatiotemporal feature extraction scheme built on the concept of symbolic dynamics for discovering and representing causal interactions between the subsystems. The proposed tool aims to (i) capture multiple operational modes as nominal in complex CPSs, (ii) only use nominal data and artificially generated fault data to train the model without requiring true labeled anomaly data, and (iii) implement root-cause analysis in a semi-supervised way in a diversity of faults (e.g., one failed pattern, multiple failed patterns, one fault node, and multiple fault nodes). We present two approaches for root-cause analysis, namely the sequential state switching (S3, based on free energy concept of a Restricted Boltzmann Machine, RBM [10]) and artificial anomaly association (A3, a multi-label classification framework using deep neural networks, DNN). Synthetic data from cases with failed pattern(s) and faulty node are simulated to validate the proposed approaches, then compared with the vector autoregressive (VAR) model in terms of root-cause analysis performance."}, {"heading": "2 Background and preliminaries", "text": ""}, {"heading": "2.1 Spatiotemporal pattern network (STPN)", "text": "STPN modeling involves partitioning/discretization, followed by learning markov machines. While details can be found in [11, 9], we are providing brief description for completeness.\nConsider a multivariate time series, X = {XA(t), t \u2208 N, A = 1, 2, \u00b7 \u00b7 \u00b7 , n}, where n is the number of variables or dimension of the time series, corresponding to the number of nodes in graphical modeling. Let X denote a set of partitioning/discretization functions [12], X : X(t) \u2192 S, that transform a general dynamic system (time series X(t)) into a symbol sequence S with an alphabet set \u03a3. Various partitioning approaches have been proposed in the literature, such as uniform partitioning (UP), maximum entropy partitioning (MEP, used for the present study), maximally bijective discretization (MBD) [13] and statistically similar discretization (SSD) [14]. Subsequently, a probabilistic finite state automaton (PFSA) is defined to describe states (representing various parts of the data space) and probabilistic transitions among them (can be learnt from data) via D-Markov machine and xD-Markov machine. With this setup, an STPN is defined as:\nDefinition. A PFSA based STPN is a 4-tuple WD \u2261 (Qa,\u03a3b,\u03a0ab,\u039bab): (a, b denote nodes of the STPN)\n1. Qa = {q1, q2, \u00b7 \u00b7 \u00b7 , q|Qa|} is the state set corresponding to symbol sequences Sa. 2. \u03a3b = {\u03c30, \u00b7 \u00b7 \u00b7 , \u03c3|\u03a3b|\u22121} is the alphabet set of symbol sequence S b. 3. \u03a0ab is the symbol generation matrix of size |Qa| \u00d7 |\u03a3b|, the ijth element of \u03a0ab denotes the probability of finding the symbol \u03c3j in the symbol string sb while making a transition from the state qi in the symbol sequence Sa; while self-symbol generation matrices are called atomic patterns (APs) i.e., when a = b, cross-symbol generation matrices are called relational patterns (RPs) i.e., when a 6= b. 4. \u039bab denotes a metric that can represent the importance of the learnt pattern (or degree of causality) for a \u2192 b which is a function of \u03a0ab."}, {"heading": "2.2 Unsupervised anomaly detection with spatiotemporal causal graphical modeling", "text": "A data-driven framework for system-wide anomaly detection is proposed in [9], noted as the STPN+RBM model. The steps of learning the STPN+RBM model are:\n1. Learn APs and RPs (individual node behaviors and pair-wise interaction behaviors) from the multivariate training symbol sequences.\n2. Consider short symbol sub-sequences from the training sequences and evaluate \u039bij \u2200i, j for each short sub-sequence. 3. For one sub-sequence, based on a user-defined threshold on \u039bij , assign state 0 or 1 for each AP and RP; thus every sub-sequence leads to a binary vector of length L, where L = #AP +#RP .\n4. An RBM is used for modeling system-wide behavior with nodes in the visible layer corresponding to APs and RPs.\n5. The RBM is trained using binary vectors generated from nominal training sub-sequences. 6. Online anomaly detection is implemented by computing the probability of occurrence of a test"}, {"heading": "3 Methods", "text": "In the STPN+RBM framework described above, anomaly manifests itself as a low probability (high energy) event. Therefore, the idea for root-cause analysis is to find potential pattern(s) that, if changed, can transition the system from a high to a low energy state. The probabilities of AP and RP\u2019s existence are discovered by the STPN, and an anomaly will influence the causality of specific patterns (e.g., in STPN, the probability of the pattern might be switched/flipped from 0 to 1). Hence, by switching/flipping a pattern, its contribution on the energy states of the system can be identified and a large contribution may indicate the root-cause of an anomaly. Using this principle, two approaches\u2013the sequential state switching (S3) and artificial anomaly association (A3)\u2013are proposed.\n3.1 Sequential state switching (S3) For an n-node graphical model, all the APs and RPs together form a binary vector v of length L = n2 (L = #AP + #RP , where #AP = n, #RP = n \u00d7 (n \u2212 1)). One such binary vector is treated as one training example for the system-wide RBM (with n2 number of visible units) and many such examples are generated from different short sub-sequences extracted from the overall training sequence. Then, the RBM is trained by maximizing the maximum likelihood of the data.\nDuring training, weights and biases are obtained such that the training data has low energy. During inference then, an anomalous pattern should manifest itself as a low probability (high energy) configuration. The energy function for an RBM is defined as:\nE(v, h) = \u2212hT Wv \u2212 bT v \u2212 cT h\nwhere W are the weights of the hidden units, b and c are the biases of the visible units and hidden units respectively.\nWith the weights and biases of RBM, free energy can be computed. Free energy is defined as the energy that a single visible layer pattern would need to have in order to have the same probability as all of the configurations that contain v [15], which has the following expression:\nF (v) = \u2212 \u2211\ni\nviai \u2212 \u2211\nj\nlog(1 + ebj+ \u2211 i viwij )\nThe free energy in nominal conditions is noted as F\u0303 . In cases where there are multiple input vectors with more than one nominal modes, free energy in the nominal states can be averaged or used in conjunction with other metrics. In anomalous conditions, a failed pattern will shift the energy from\na lower state to a higher state. Assume that the patterns can be categorized into two sets, vnom and vano. By flipping the set of anomalous patterns vano, a new expression for free energy is obtained:\nF s(v) =\u2212 \u2211\ng\nvgag \u2212 \u2211\nj\nlog(1 + ebj+ \u2211 g vgwgj )\n\u2212 \u2211\nh\nv\u22c6hah \u2212 \u2211\nj\nlog(1 + ebj+ \u2211 h v\u22c6hwhj ), {vg} \u2208 v nom, {v\u22c6h} \u2208 v \u22c6,ano\nHere, v\u22c6 has the opposite state to v and represents that the probability of the pattern has been significantly changed. In this work, the probabilities of the patterns are binary (i.e. 0 or 1). Hence, we have that v\u22c6 = 1 \u2212 v. The sequential state switching is formulated by finding a set of patterns vano via min(F s(vano, vnom)\u2212 F\u0303 ). Algorithm 1 is presented to perform root-cause analysis based on the STPN+RBM framework.\nAlgorithm 1 Root-cause analysis with sequential state switching (S3) method 1: procedure STPN+RBM MODELING \u22b2 Algorithm 1 in [9] 2: Online process of computing likelihoods/probabilities of APs & RPs 3: Training RBM to achieve low energy state, using binary vectors from nominal subsequences 4: end procedure 5: procedure ANOMALY DETECTION \u22b2 Algorithm 2 in [9] 6: Online anomaly detection via the probability of the current state via trained RBM 7: end procedure 8: procedure ROOT-CAUSE ANALYSIS 9: if Anomaly = 1 then 10: F c \u2190 F s(v) \u22b2 F c is the current free energy with input vector v = vnom \u222a vano. 11: {Vp} \u2190 {v : F s(v) < F c} 12: while {Vp} 6= \u2205 \u2228 {v : F s(v\u22c6,ano, vnom) < F c} = \u2205 do 13: F c \u2190 min(F s(v\u22c6,ano \u222a v\u22c6i , v nom)), vi \u2208 {Vp}, v\u22c6i = 1\u2212 vi, v \u22c6,ano = 1\u2212 vano 14: {vano} \u2190 {vano} \u222a {v : F s(v\u22c6,ano, vnom) = F c} 15: {vnom} \u2190 {v} \\ {vano} 16: {Vp} \u2190 {Vp} \\ {v : F s(v\u22c6,ano, vnom) = F c} 17: end while 18: end if 19: {\u039bano} \u2190 {vano} 20: return {\u039bano} 21: end procedure\nIt should be noted that free energyF is used in Algorithm 1, and it can used along with other metrics such as KLD. Using KLD alongside with free energy is particularly useful when the distribution of free energy is obtained with multiple sub-sequences. KLD may be more robust as it takes multiple sub-sequences into account because a persistent anomaly across the subsequences will cause a significant impact on KLD.\n3.2 Artificial anomaly association (A3)\nUsing a deep neural network (DNN), we frame the root-cause analysis problem as a multi-class (binary-class in our case) classification problem [16]. The input is presented as an n2-element vector with values of either 0 or 1 which denotes whether a specific pattern is activated. We desire to map the input vector to an output vector of the same length (termed as the indicator label), where the value of each element within the output vector indicates whether a specific pattern is anomalous. For nominal modes, the input vector may be comprised of different combinations of 0\u2019s and 1\u2019s, and the indicator labels will be a vector of all 1\u2019s (where the value 1 denotes no anomaly). However, if a particular element i within the input vector gets flipped, then the indicator label corresponding to the i-th position in the output vector will be flipped and switches from 1 (normal) to 0 (anomalous). In this way, we can identify that the i-th pattern is anomalous. With this setup, a classification sub-problem (i.e. is this pattern normal, or anomalous?) can solved for each elements in the output vector given the input data. One might argue that multi-class classification is unnecessary and adds to higher computational overhead. Although a single class denoting which pattern has failed may work for a single anomalous pattern case, it is not sufficient for simultaneous multiple pattern failures.\nThe crux of the idea is that anomalies are artificially injected into readily-available nominal data since anomalous data are not always available. A justification is that we wish the model to hierarchically extract important features from the nominal data to sufficiently discriminate between nominal and anomalous patterns. Furthermore, realistic physical systems may have multiple nominal nodes and it will most certainly be ardous to discover the root-cause using conventional methods when anomaly occurs. As deep learning methods are able to learn hierarchical representations of the input data, they are attractive candidates to solve the problem where multiple nominal modes are involved.\nDNN Parameters: Training data is generated from 6 modes including both nominal and artificial anomalous data. The training data is split into 222,300 training samples and 74,100 validation samples. Testing was performed on datasets generated from entirely different modes. The DNN is comprised of 3 layers of 500 hidden units each and trained with ReLU activations. A learning rate of 0.1 and a batch size of 10 is used in the gradient descent algorithm. The training procedure employs the early-stopping algorithm where training stops when validation error ceases to decrease."}, {"heading": "4 Results and discussions", "text": "Synthetic datasets are generated with vector autoregressive (VAR) process to simulate anomaly in pattern(s)/node(s) for performance evaluation of S3 and A3 methods."}, {"heading": "4.1 Anomaly in pattern(s)", "text": "Dataset: Anomaly in pattern(s) is defined as the change of one or more causal relationship, while defining anomaly, this translates to a changed/switched pattern in the context of STPN. A 5-node system is defined and shown in Fig. 3 including six different nominal modes. Cycles (1 \u2192 2 \u2192 5 \u2192 1, 1 \u2192 2 \u2192 3 \u2192 1, 2 \u2192 3 \u2192 2) and loops (4 \u2192 4) are included in the models. The graphical models are applied to simulate multiple nominal modes. Anomalies are simulated by breaking specific patterns in the graph; 30 cases are formed including 5 cases in one failed pattern, 10 cases in two failed patterns, 10 cases in three failed patterns, and 5 cases in four failed patterns. Multivariate time series data (denoted as dataset1) are generated using VAR process that follows the causality definition in the graphical models.\nPerformance Evaluation: Root-cause identification performances of S3 and A3 methods are evaluated using dataset1. The accuracy metric used here is a pattern-by-pattern comparison (both anomalous and nominal) between the prediction and the ground truth labels. Formally, we define the accuracy metric \u03b11 as:\n\u03b11 =\n\u2211n2 j=1 \u2211m i=1 \u03c71(Tij = Pij)\nmn2\nwhere Tij denotes the ground truth state (nominal/anomalous) of the jth pattern of the ith test sample. Similarly, Pij is the corresponding predicted state using the root-cause analysis approach. \u03c71(\u00b7) is the indicator function that returns the value 1 if the expression within the function is true. In the denominator, m is the number of test samples and n2 is the number of patterns. With the above metric, results of S3 method and A3 method are listed in Table 1. High accuracy is obtained for\nboth S3 and A3 method. While training time is much less for S3, the inference time in root-cause analysis for S3 is much more than that of A3, as S3 depends on sequential searching. Note, the classification formulation in A3 aims to achieve the exact set of anomalous nodes. On the other hand, the S3 method is an approximate method that sequentially identifies anomalous patterns and hence, the stopping criteria would be critical. The observation that the performance of S3 is quite comparable to that of A3 suggests a reasonable choice of the stopping criteria.\nIt is evident from the above discussion that while the approximate S3 method may overestimate the set of anomalous patterns to some extent, it will be important to not miss any anomalous pattern. In this context, we define a more relaxed metric below to understand the efficacy of the S3 method.\n\u03b12 =\n\u2211m i=1 \u03c71({AT }i \u2286 {AP }i)\nm\nwhere {AT }i denotes the ground truth set of anomalous patterns for test sample i and {AP }i denotes the corresponding predicted set. As expected, we obtain a higher accuracy value of 99.02% for this relaxed metric which shows that the approximate S3 approach is reliable in finding out all failed patterns."}, {"heading": "4.2 Anomaly in node(s)", "text": "Dataset: Anomaly in node(s) occurs when one node or multiple nodes fail in the system. For a cyberphysical system, they may be caused by sensor fault or component degradation. The graphical model defined in Fig. 3 (a) is applied for generating the nominal data using the VAR process. Anomaly data are simulated by introducing time delay in a specific node. The time delay will break most of the causality to and from this node (except possibly the self loop, i.e., AP of the failed node). For validation and comparison, graphs are recovered with VAR process in cases of faulty nodes as shown in Fig. 4). The figure also shows that there are some variations in causality between normal nodes which suggests that causality discovery is more difficult with existence of cycles and loops. The generated dataset is denoted as dataset2. For scalability analysis, a 30-node system is further defined with VAR process, and the same method is applied to simulate the anomaly data, noted as dataset3.\nPerformance Evaluation: This work is aimed at discovering failed patterns instead of recovering underlying graph (which is very difficult in graphs with cycles and loops [17, 18]). The discovered anomalous patterns can then be used for diagnosing the fault node. For instance, a failed pattern Ni \u2192 Nj discovered by root-cause analysis can be caused by the fault node i or j. However, if multiple failed patterns are related to the node i, then this node can be deemed anomalous. In this regard, it is important to learn the impact of one pattern on a detected anomaly compared to another. This can facilitate a ranking of the failed patterns and enable a robust isolation of an anomalous node. However, the exact A3 method does not provide such information and therefore, we investigate only results obtained with the sequential S3 method. Moreover, with anomaly injection process by introducing time delays at a node level prevents us from selecting an appropriate performance\nmetric for the A3 method. For comparison, we use VAR-based graph recovery method that is widely applied in economics and other sciences, and efficient in discovering Granger causality [19]. Note, the test dataset itself is synthetically generated using a VAR model with a specific time delay. Hence, the causality in such a multivariate time series is supposed to be well captured by VAR-based method. The details of the VAR-based root-cause analysis strategy is explained below.\nConsider the time series Y (t) = yi,t, i = (1, 2, \u00b7 \u00b7 \u00b7 , n), t \u2208 N\nyi,t =\np\u2211\nk=1\nn\u2211\nj=1\nAki,jyj,t\u2212k + \u00b5t, j = (1, 2, \u00b7 \u00b7 \u00b7 , n)\nwhere p is time lag order, Ai,j is the coefficient of the influence on ith time series caused by jth time series, and \u00b5t is an error process with the assumption of white noise with zero mean, i.e. E(\u00b5t) = 0, and that the covariance matrix E(\u00b5t\u00b5\u2032t) = \u03a3\u00b5 is time invariant.\nWith the given time series, a VAR model (i.e., the coefficients Ai,j) can be learnt using standard algorithm [19]. The differences in coefficients between the nominal and anomalous models are subsequently used to find out the root causes. The pattern is deemed to have failed when \u03b4Ai,j > 0.4 \u00b7max{\u03b4Ai,j} where \u03b4Ai,j = |Aanoi,j \u2212A nom i,j |.\nThe results of S3 and VAR using dataset3 are shown in Fig. 5. In panel (a), all of the changed patterns discovered by S3 can be attributed to node 1 (shown by the black boxes in column and row 1). Therefore, node 1 is considered as faulty by the S3 method. On the other hand, VAR incorrectly\ndiscovers a significant change in the pattern N12 \u2192 N2 but not the patterns originating from N1. We note this as an error. In general, although S3 and VAR can both discover the fault node, VAR produces more false alarms. Similar observations can be made in cases (b) and (c). In (d), 22 failed patterns are discovered by S3 which can all be attributed to a fault in node 28, but only six failed patterns are discovered by VAR. In this case, the discovery of more changed patterns can contribute to a stronger evidence that node 28 is faulty. As it is always beneficial to avoid false positive error, we conclude that S3 method is more preferred for case (d).\nIn real applications, when more anomalous patterns are discovered incorrectly, more effort will be needed to analyze the failed patterns closely and determine the root-cause node. This will lead to more financial expenditures and time investment in finding the failed node. With this motivation, an error metric \u01eb is defined by computing the ratio of incorrectly discovered anomalous patterns |{\u039b\u01eb}| to all discovered anomalous patterns |{\u039bano}|, i.e., \u01eb = |{\u039b\n\u01eb}| |{\u039bano}| . The results using dataset2 and\ndataset3 are listed in Table 2.\nWhile it should be noted that both S3 and VAR can discover the fault node correctly in both the datasets, the error ratio for S3 method is much lower than that for VAR (i.e., lower false alarm). As the scale of the system increases, the number of discovered anomalous patterns by S3 becomes more than that of by VAR, while the error ratio becomes significantly less than that of VAR. Therefore, S3 method is both scalable as well as demonstrates better accuracy. Note that for comparisons between S3 and VAR, only one nominal mode is considered in Table 2 as VAR is not directly applicable in cases with multiple nominal modes. S3 method can handle multiple nominal modes and it has been validated in Section 4.1.\nRemark 4.1 The root-cause analysis algorithms proposed in this work are fundamentally patternbased as opposed to being node-based. Motivation for such methods come from real cyber-physical systems, where cyber-attacks may only compromise interactions among sub-systems (i.e., relational patterns (RPs)) without directly affecting sub-systems (i.e., the nodes). In contrast, majority of the existing methods mostly focus on node-based anomalies to the best of our knowledge. For example, in [5], root-cause analysis was performed using Granger Graphical Model with neighborhood similarity (GGM-N) and Granger Graphical Model with coefficient similarity (GGM-C). An initial investigation shows that for the single node failure cases in dataset3, GGM-N and GGM-C can isolate correct anomalous nodes 25 and 24 out of 30 cases respectively. On the other hand, with a simple rule of determining the anomalous node in dataset3 (i.e., finding out the anomalous node that can explain all the failed patterns), S3 can discover correct anomalous nodes in all 30 cases. Future work will involve a detail comparison study by formalizing the anomalous node identification process from pattern-based evidences especially for multiple anomalous nodes."}, {"heading": "5 Conclusions", "text": "Based on spatiotemporal causal graphical modelling, this work presents two approaches\u2013the sequential state switching (S3) and artificial anomaly association (A3)\u2013for root-cause analysis in complex cyber-physical systems. With synthetic data, the proposed approaches are validated and showed high accuracy in finding failed patterns and diagnose for the anomalous node. Advantages of the proposed methods include -\n1. Ability to handle multiple nominal modes: The STPN+RBM framework is capable of learning multiple modes as nominal, which corresponds to diverse operation modes in most physical systems (e.g. complex cyber-physical systems). The root-cause analysis approaches proposed in this work enjoy this benefit and are validated with dataset1.\n2. Accuracy: The proposed approaches\u2013S3 and A3\u2013demonstrate high accuracy in root-causes analysis with synthetic data. Moreover, the approach shows considerable credibility in finding out all of the failed patterns while avoiding false negatives.\n3. Scalability: The approaches are scalable with the size of the system. This is important in complex cyber-physical systems where hundreds of sub-systems are often involved.\n4. Robustness: Compared with VAR model, the proposed approach can more effectively isolate the fault node with less incorrectly discovered patterns. S3 method can also find out the maximal set of failed patterns while avoiding false positives.\nFuture work will pursue: (i) inference approach in node failure including single node and multiple nodes, (ii) detection and root-cause analysis of simultaneous multiple faults in distributed complex systems."}], "references": [{"title": "Root cause diagnosis of plant-wide oscillations using granger causality", "author": ["Tao Yuan", "S Joe Qin"], "venue": "Journal of Process Control,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2014}, {"title": "Identification of probabilistic graphical network model for root-cause diagnosis in industrial processes", "author": ["Junichi Mori", "Vladimir Mahalec", "Jie Yu"], "venue": "Computers & Chemical Engineering,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2014}, {"title": "J\u00e4ms\u00e4-Jounela. Fault propagation analysis of oscillations in control loops using data-driven causality and plant connectivity", "author": ["Rinat Landman", "Jukka Kortela", "Q Sun", "S-L"], "venue": "Computers & Chemical Engineering,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2014}, {"title": "Granger causality for timeseries anomaly detection", "author": ["Huida Qiu", "Yan Liu", "Niranjan A Subrahmanya", "Weichang Li"], "venue": "In Data Mining (ICDM),", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2012}, {"title": "Dynamic time warping based causality analysis for root-cause diagnosis of nonstationary fault processes. IFAC-PapersOnLine", "author": ["Gang Li", "Tao Yuan", "S Joe Qin", "Tianyou Chai"], "venue": null, "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2015}, {"title": "Dynamic uncertain causality graph for knowledge representation and probabilistic reasoning: Statistics base, matrix, and application", "author": ["Qin Zhang", "Chunling Dong", "Yan Cui", "Zhihui Yang"], "venue": "Neural Networks and Learning Systems, IEEE Transactions on,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2014}, {"title": "Scalable anomaly detection and isolation in cyberphysical systems using bayesian networks", "author": ["S. Krishnamurthy", "S. Sarkar", "A. Tewari"], "venue": "In Proceedings of ASME Dynamical Systems and Control Conference,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2014}, {"title": "An unsupervised spatiotemporal graphical modeling approach to anomaly detection in distributed CPS", "author": ["Chao Liu", "Sambuddha Ghosal", "Zhanhong Jiang", "Soumik Sarkar"], "venue": "In Proceedings of the International Conference of Cyber-Physical Systems, (Vienna,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2016}, {"title": "Reducing the dimensionality of data with neural networks", "author": ["G. Hinton", "R. Salakhutdinov"], "venue": "Science, 313.5786:504\u2013507,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2006}, {"title": "Sensor fusion for fault detection and classification in distributed physical processes", "author": ["Soumalya Sarkar", "Soumik Sarkar", "Nurali Virani", "Asok Ray", "Murat Yasar"], "venue": "Frontiers in Robotics and AI,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2014}, {"title": "Review and comparative evaluation of symbolic dynamic filtering for detection of anomaly patterns", "author": ["C. Rao", "A. Ray", "S. Sarkar", "M. Yasar"], "venue": "Signal, Image and Video Processing,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2009}, {"title": "Maximally bijective discretization for data-driven modeling of complex systems", "author": ["Soumik Sarkar", "Abhishek Srivastav", "Madhusudana Shashanka"], "venue": "In American Control Conference (ACC),", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2013}, {"title": "A composite discretization scheme for symbolic identification of complex systems", "author": ["Soumik Sarkar", "Abhishek Srivastav"], "venue": "Signal Processing,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2016}, {"title": "A practical guide to training restricted boltzmann machines", "author": ["Geoffrey E Hinton"], "venue": "In Neural Networks: Tricks of the Trade,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2012}, {"title": "Hierarchical feature extraction for efficient design of microfluidic flow patterns", "author": ["Kin Gwn Lore", "Daniel Stoecklein", "Michael Davies", "Baskar Ganapathysubramanian", "Soumik Sarkar"], "venue": "In Proceedings of The 1st International Workshop on \u201cFeature Extraction: Modern Questions and Challenges\u201d,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2015}, {"title": "A discovery algorithm for directed cyclic graphs", "author": ["Thomas Richardson"], "venue": "In Proceedings of the Twelfth international conference on Uncertainty in artificial intelligence,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 1996}, {"title": "Discovering cyclic causal models by independent components analysis", "author": ["Gustavo Lacerda", "Peter L Spirtes", "Joseph Ramsey", "Patrik O Hoyer"], "venue": "In Proceedings of the Twenty-Fourth Conference Annual Conference on Uncertainty in Artificial Intelligence", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2008}, {"title": "Investigating directed cortical interactions in time-resolved fmri data using vector autoregressive modeling and granger causality mapping", "author": ["Rainer Goebel", "Alard Roebroeck", "Dae-Shik Kim", "Elia Formisano"], "venue": "Magnetic resonance imaging,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2003}], "referenceMentions": [{"referenceID": 0, "context": "With multivariate time series data, studies show that the causality from and to the fault variable presents differences and can be used to reason the root-cause [1\u20134].", "startOffset": 161, "endOffset": 166}, {"referenceID": 1, "context": "With multivariate time series data, studies show that the causality from and to the fault variable presents differences and can be used to reason the root-cause [1\u20134].", "startOffset": 161, "endOffset": 166}, {"referenceID": 2, "context": "With multivariate time series data, studies show that the causality from and to the fault variable presents differences and can be used to reason the root-cause [1\u20134].", "startOffset": 161, "endOffset": 166}, {"referenceID": 3, "context": "[5] derived neighborhood similarity and coefficient similarity from Granger-Lasso algorithm, to compute anomaly score and ascertain threshold for", "startOffset": 0, "endOffset": 3}, {"referenceID": 4, "context": "[6] to determine the causal direction between pairs of faulty variables in order to overcome the shortcoming of Granger causality in nonstationary time series.", "startOffset": 0, "endOffset": 3}, {"referenceID": 5, "context": "A dynamic uncertain causality graph is proposed for probabilistic reasoning and applied to fault diagnosis of generator system of nuclear power plant [7].", "startOffset": 150, "endOffset": 153}, {"referenceID": 6, "context": "Also, Bayesian network has been applied in cyber-physical systems to implement anomaly detection and root-cause analysis [8].", "startOffset": 121, "endOffset": 124}, {"referenceID": 7, "context": "In this context, we present a semi-supervised tool for root-cause analysis in complex systems based on a data driven framework proposed for system-wide time-series anomaly detection in distributed complex system [9], and using a spatiotemporal feature extraction scheme built on the concept of symbolic dynamics for discovering and representing causal interactions between the subsystems.", "startOffset": 212, "endOffset": 215}, {"referenceID": 8, "context": "We present two approaches for root-cause analysis, namely the sequential state switching (S, based on free energy concept of a Restricted Boltzmann Machine, RBM [10]) and artificial anomaly association (A, a multi-label classification framework using deep neural networks, DNN).", "startOffset": 161, "endOffset": 165}, {"referenceID": 9, "context": "While details can be found in [11, 9], we are providing brief description for completeness.", "startOffset": 30, "endOffset": 37}, {"referenceID": 7, "context": "While details can be found in [11, 9], we are providing brief description for completeness.", "startOffset": 30, "endOffset": 37}, {"referenceID": 10, "context": "Let X denote a set of partitioning/discretization functions [12], X : X(t) \u2192 S, that transform a general dynamic system (time series X(t)) into a symbol sequence S with an alphabet set \u03a3.", "startOffset": 60, "endOffset": 64}, {"referenceID": 11, "context": "Various partitioning approaches have been proposed in the literature, such as uniform partitioning (UP), maximum entropy partitioning (MEP, used for the present study), maximally bijective discretization (MBD) [13] and statistically similar discretization (SSD) [14].", "startOffset": 210, "endOffset": 214}, {"referenceID": 12, "context": "Various partitioning approaches have been proposed in the literature, such as uniform partitioning (UP), maximum entropy partitioning (MEP, used for the present study), maximally bijective discretization (MBD) [13] and statistically similar discretization (SSD) [14].", "startOffset": 262, "endOffset": 266}, {"referenceID": 7, "context": "2 Unsupervised anomaly detection with spatiotemporal causal graphical modeling A data-driven framework for system-wide anomaly detection is proposed in [9], noted as the STPN+RBM model.", "startOffset": 152, "endOffset": 155}, {"referenceID": 7, "context": "Anomaly is detected by identifying its high energy state, which can be captured using the Kullback-Leibler Distance (KLD) metric [9].", "startOffset": 129, "endOffset": 132}, {"referenceID": 13, "context": "Free energy is defined as the energy that a single visible layer pattern would need to have in order to have the same probability as all of the configurations that contain v [15], which has the following expression: F (v) = \u2212 \u2211", "startOffset": 174, "endOffset": 178}, {"referenceID": 7, "context": "Algorithm 1 Root-cause analysis with sequential state switching (S) method 1: procedure STPN+RBM MODELING \u22b2 Algorithm 1 in [9] 2: Online process of computing likelihoods/probabilities of APs & RPs 3: Training RBM to achieve low energy state, using binary vectors from nominal subsequences 4: end procedure 5: procedure ANOMALY DETECTION \u22b2 Algorithm 2 in [9] 6: Online anomaly detection via the probability of the current state via trained RBM 7: end procedure 8: procedure ROOT-CAUSE ANALYSIS 9: if Anomaly = 1 then 10: F c \u2190 F (v) \u22b2 F c is the current free energy with input vector v = v \u222a v.", "startOffset": 123, "endOffset": 126}, {"referenceID": 7, "context": "Algorithm 1 Root-cause analysis with sequential state switching (S) method 1: procedure STPN+RBM MODELING \u22b2 Algorithm 1 in [9] 2: Online process of computing likelihoods/probabilities of APs & RPs 3: Training RBM to achieve low energy state, using binary vectors from nominal subsequences 4: end procedure 5: procedure ANOMALY DETECTION \u22b2 Algorithm 2 in [9] 6: Online anomaly detection via the probability of the current state via trained RBM 7: end procedure 8: procedure ROOT-CAUSE ANALYSIS 9: if Anomaly = 1 then 10: F c \u2190 F (v) \u22b2 F c is the current free energy with input vector v = v \u222a v.", "startOffset": 354, "endOffset": 357}, {"referenceID": 14, "context": "2 Artificial anomaly association (A) Using a deep neural network (DNN), we frame the root-cause analysis problem as a multi-class (binary-class in our case) classification problem [16].", "startOffset": 180, "endOffset": 184}, {"referenceID": 15, "context": "Performance Evaluation: This work is aimed at discovering failed patterns instead of recovering underlying graph (which is very difficult in graphs with cycles and loops [17, 18]).", "startOffset": 170, "endOffset": 178}, {"referenceID": 16, "context": "Performance Evaluation: This work is aimed at discovering failed patterns instead of recovering underlying graph (which is very difficult in graphs with cycles and loops [17, 18]).", "startOffset": 170, "endOffset": 178}, {"referenceID": 17, "context": "For comparison, we use VAR-based graph recovery method that is widely applied in economics and other sciences, and efficient in discovering Granger causality [19].", "startOffset": 158, "endOffset": 162}, {"referenceID": 17, "context": ", the coefficients Ai,j) can be learnt using standard algorithm [19].", "startOffset": 64, "endOffset": 68}], "year": 2016, "abstractText": "Modern distributed cyber-physical systems encounter a large variety of anomalies and in many cases, they are vulnerable to catastrophic fault propagation scenarios due to strong connectivity among the sub-systems. In this regard, root-cause analysis becomes highly intractable due to complex fault propagation mechanisms in combination with diverse operating modes. This paper presents a new data-driven framework for root-cause analysis for addressing such issues. The framework is based on a spatiotemporal feature extraction scheme for multivariate time series built on the concept of symbolic dynamics for discovering and representing causal interactions among subsystems of a complex system. We propose sequential state switching (S) and artificial anomaly association (A) methods to implement rootcause analysis in an unsupervised and semi-supervised manner respectively. Synthetic data from cases with failed pattern(s) and anomalous node are simulated to validate the proposed approaches, then compared with the performance of vector autoregressive (VAR) model-based root-cause analysis. The results show that: (1) S andA approaches can obtain high accuracy in root-cause analysis and successfully handle multiple nominal operation modes, and (2) the proposed tool-chain is shown to be scalable while maintaining high accuracy.", "creator": "LaTeX with hyperref package"}}}