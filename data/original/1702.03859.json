{"id": "1702.03859", "review": {"conference": "iclr", "VERSION": "v1", "DATE_OF_SUBMISSION": "13-Feb-2017", "title": "Offline bilingual word vectors, orthogonal transformations and the inverted softmax", "abstract": "Usually bilingual word vectors are trained \"online\". Mikolov et al. showed they can also be found \"offline\", whereby two pre-trained embeddings are aligned with a linear transformation, using dictionaries compiled from expert knowledge. In this work, we prove that the linear transformation between two spaces should be orthogonal. This transformation can be obtained using the singular value decomposition. We introduce a novel \"inverted softmax\" for identifying translation pairs, with which we improve the precision @1 of Mikolov's original mapping from 34% to 43%, when translating a test set composed of both common and rare English words into Italian. Orthogonal transformations are more robust to noise, enabling us to learn the transformation without expert bilingual signal by constructing a \"pseudo-dictionary\" from the identical character strings which appear in both languages, achieving 40% precision on the same test set. Finally, we extend our method to retrieve the true translations of English sentences from a corpus of 200k Italian sentences with a precision @1 of 68%.", "histories": [["v1", "Mon, 13 Feb 2017 16:31:06 GMT  (340kb,D)", "http://arxiv.org/abs/1702.03859v1", "Accepted to conference track at ICLR 2017"]], "COMMENTS": "Accepted to conference track at ICLR 2017", "reviews": [], "SUBJECTS": "cs.CL cs.AI cs.IR", "authors": ["samuel l smith", "david h p turban", "steven hamblin", "nils y hammerla"], "accepted": true, "id": "1702.03859"}, "pdf": {"name": "1702.03859.pdf", "metadata": {"source": "CRF", "title": null, "authors": ["INVERTED SOFTMAX", "Samuel L. Smith", "David H. P. Turban", "Steven Hamblin", "Nils Y. Hammerla"], "emails": ["nils.hammerla}@babylonhealth.com", "dt382@cam.ac.uk", "@1", "@1"], "sections": [{"heading": "1 INTRODUCTION", "text": "Monolingual word vectors embed language in a high-dimensional vector space, such that the similarity of two words is defined by their proximity in this space (Mikolov et al., 2013b). They enable us to train sophisticated classifiers to interpret free flowing text (Kim, 2014), but they require independent models to be trained for each language. Crucially, training text obtained in one language cannot improve the performance of classifiers trained in another, unless the text is explicitly translated. Increasing interest is now focused on bilingual vectors, in which words are aligned by their meaning, irrespective of the language of origin. Such vectors may drive improvements in machine translation (Zou et al., 2013), and enable language-agnostic text classifiers (Klementiev et al., 2012). They can also be higher quality than monolingual vectors (Faruqui & Dyer, 2014).\nBilingual vectors are normally trained \u201conline\u201d, whereby both languages are learnt together in a shared space (Chandar et al., 2014; Hermann & Blunsom, 2013). Typically these algorithms exploit two sources of monolingual text alongside a smaller bilingual corpus of aligned sentences. This bilingual signal provides a regularisation term, which penalises the embeddings if similar words in the two languages do not lie nearby in the vector space. However Mikolov et al. (2013a) showed that bilingual word vectors can also be obtained \u201coffline\u201d. Two sets of word vectors in different languages were first obtained independently, and then a linear matrix W was trained using a dictionary to map word vectors from the \u201csource\u201d language into the \u201ctarget\u201d language. Remarkably, this simple procedure was able to translate a test set of English words into Spanish with 33% precision.\nTo develop an intuition for these two approaches, we note that the similarity of two word vectors is defined by their cosine similarity, cos(\u03b8ij) = yTi xj/|yi||xj |. The vectors have no intrinsic meaning, it is only the angles between vectors which are meaningful. This is closely analogous to asking a cartographer to draw a map of England with no compass. The map will be correct, but she does not know which direction is north, so the angle of rotation will be random. Two maps drawn by two such cartographers will be identical, except that one will be rotated by an unknown angle with respect to the other. There are two ways the cartographers could align their maps. They could draw\nar X\niv :1\n70 2.\n03 85\n9v 1\n[ cs\n.C L\n] 1\n3 Fe\nb 20\n17\nthe maps together, thus ensuring that landmarks are placed nearby on both maps during \u201ctraining\u201d. Or they could draw their maps independently, and then compare the two afterwards; rotating one map with respect to the other until the major cities are aligned. We note that the more similar the intrinsic geometry of the two maps, the more accurately this rotation will align the space.\nThe main contribution of this work is to provide theoretical insights which unify and enhance existing approaches in the literature. We prove that a self-consistent linear transformation between vector spaces should be orthogonal. Intuitively, the transformation is a rotation, and it is found using the singular value decomposition (SVD). The shared semantic space obtained by the SVD is illustrated in figure 1. We build on the work of Dinu et al. (2014), by introducing a novel \u201cinverted softmax\u201d to combat the hubness problem. Using the same word vectors, training dictionary and test set provided by Dinu, we improve the precision of Mikolov\u2019s method from 34% to 43%, when translating from English to Italian, and from 25% to 37% when translating from Italian to English. We also present three remarkable new results. First we exploit the superior robustness of orthogonal transformations, by discarding the training dictionary and forming a pseudo-dictionary from the identical character strings which appear in both languages. While Mikolov\u2019s method achieves translation precisions of just 1% and 3% respectively with this pseudo-dictionary, our approach achieves precisions of 40% and 34%. This is a striking result, achieved without any expert bilingual signal. Next, we form simple sentence vectors by summing and normalising over word vectors, and we obtain bilingual sentence vectors by applying the SVD to a phrase dictionary formed from a bilingual corpus of aligned text. The transformation obtained aligns the underlying word vectors, achieving a translation precision of 43% and 38%, en-par with the expert word dictionary above. Finally, we show that we can also use our bilingual word vectors to retrieve sentence translations; identifying the translation of an English sentence from a bag of 200k Italian candidate sentences with 68% precision."}, {"heading": "2 OFFLINE BILINGUAL LANGUAGE VECTORS", "text": ""}, {"heading": "2.1 PREVIOUS WORK", "text": "Offline bilingual word vectors were first proposed by Mikolov et al. (2013a). They obtained a small dictionary of paired words from Google Translate, whose word vectors we denote {yi, xi}ni=1. Next, they applied a linear transformation W to the source language and used stochastic gradient descent to minimise the squared reconstruction error,\nmin W n\u2211 i=1 ||yi \u2212Wxi||2. (1)\nAfter training, any word vector in the source language can be mapped to the target by calculating ye = Wx. The similarity between a source vector x and a target vector yt can then be evaluated by the cosine similarity cos(\u03b8te) = yTt ye/|yt||ye|. Astonishingly, this simple procedure achieved 33% accuracy when translating unseen words from English into Spanish, using a training dictionary of\n5k common English words and their Spanish translations, and word vectors trained using word2vec on the WMT11 text datasets. Translations were found by a simple nearest neighbour procedure.\nWe note that the cost function above is solved by the method of least squares, as realised by Dinu et al. (2014). They did not modify this cost function, but proposed an adapted method of retrieving translation pairs which was more accurate when translating words from English to Italian. Faruqui & Dyer (2014) obtained bilingual word vectors using CCA. They did not attempt any translation tasks, but showed that the combination of CCA and dimensionality reduction improved the performance of monolingual vectors on standard evaluation tasks. CCA had previously been used to iteratively extract translation pairs directly from monolingual corpora (Haghighi et al., 2008). More recently, Xing et al. (2015) argued that Mikolov\u2019s linear matrix should be orthogonal, and introduced an approximate procedure composed of gradient descent updates and repeated applications of the SVD. CCA has been extended to map 59 languages into a single shared space (Ammar et al., 2016), and non-linear \u201cdeep CCA\u201d has been introduced (Lu et al., 2015). A theoretical analysis of bilingual word vectors similar to this paper was recently published by Artetxe et al. (2016)."}, {"heading": "2.2 THE SIMILARITY MATRIX AND THE ORTHOGONAL TRANSFORM", "text": "To prove that a self-consistent linear mapping between semantic spaces must be orthogonal, we form the similarity matrix, S = YWXT . X and Y are word vector matrices for each language, in which each row contains a single word vector, denoted by lower case x and y. The matrix element,\nSij = y T i Wxj (2)\n= yi \u00b7 (Wxj), (3) evaluates the similarity between the jth source word and the ith target word. The matrix W maps the source language into the target language. The largest value in a column of the similarity matrix gives the most similar target word to a particular source word, while the largest value in a row gives the most similar source word to a given target word. However we could also form a second similarity matrix S\u2032 = XQY T , such that the matrix Q maps the target language back into the source.\nS\u2032ji = x T j Qyi (4)\n= xj \u00b7 (Qyi), (5) also evaluates the similarity between the jth source word and the ith target word. To be self consistent, we require S\u2032 = ST . However ST = XWTY T , and therefore the matrix Q = WT . If W maps the source language into the target, then WT maps the target language back into the source.\nWhen we map a source word into the target language, we should be able to map it back into the source language and obtain the original vector. x \u223cWT y and y \u223cWx and thus x \u223cWTWx. This expression should hold for any word vector x and thus we conclude that the transformationW should be an orthogonal matrix O satisfying OTO = I , where I denotes the identity matrix. Orthogonal transformations preserve vector norms, so if we normalise X and Y , then the matrix element Sij = |yi||Oxj | cos(\u03b8ij) = cos(\u03b8ij). The similarity matrix S = Y OXT computes the cosine similarity between all possible pairs of source and target words under the orthogonal transformation O.\nWe now infer the orthogonal transformation O from a dictionary {yi, xi}ni=1 of paired words. Since we predict the similarity of two vectors by evaluating Sij = cos(\u03b8ij), we ought to learn the transformation by maximising the cosine similarity of translation pairs in the dictionary,\nmax O n\u2211 i=1 yTi Oxi, subject to O TO = I. (6)\nThe solution proceeds as follows. We form two ordered matrices XD and YD from the dictionary, such that the ith row of {XD, YD} corresponds to the source and target language word vectors of the ith pair in the dictionary. We then compute the SVD of M = Y TDXD = U\u03a3V\nT . This step is highly efficient, since M is a square matrix with the same dimensionality as the word vectors. U and V are composed of columns of orthonormal vectors, while \u03a3 is a diagonal matrix containing the singular values. Our cost function is minimised by O = UV T . The optimised similarity matrix,\nS = Y UV TXT . (7) Sij = y T i UV Txj (8)\n= (UT yi) \u00b7 (V Txj). (9)\nThus, we map both languages into a single space, by applying the transformation V T to the source language and UT to the target language. We prove that this procedure maximises equation 6 in the appendix. It was recently independently proposed by Artetxe et al. (2016), and provides a numerically exact solution to the cost function proposed by Xing et al. (2015), just as the method of least squares provides a numerically exact solution to the cost function of Mikolov et al. (2013a).\nOur procedure did not use the singular values \u03a3, but these values do carry relevant information. All of the singular values are positive, and each singular value si is uniquely associated to a pair of normalised vectors ui and vi from the matrices U and V . Standard implementations of the SVD return the singular values in descending order. The larger the singular value, the more rapidly the mean cosine similarity of the dictionary decreases if the corresponding vectors are distorted. We can perform dimensionality reduction by neglecting the vectors {ui, vi} which arise from the smallest singular values. This is trivial to implement by simply dropping the final few rows of UT and V T , and we will show below that it leads to a small improvement in the translation performance."}, {"heading": "2.3 THE SVD AND CCA", "text": "Our method is very similar to the CCA procedure proposed by Faruqui & Dyer (2014), which can also be obtained using the SVD (Press, 2011). We first obtain the source dictionary matrix XD and subtract the mean from each column of this matrix to obtain X \u2032D. We then perform our first SVD to obtainX \u2032D = QD\u03a3XV T X . We perform the same two operations on the target dictionary YD to obtain Y \u2032D = WD\u03a3Y V T Y , and then perform another SVD on the product M \u2032 = QTDWD = U \u2032\u03a3\u2032V \u2032T . This last step is identical to the alignment procedure we introduced above. Finally we obtainX \u2032 and Y \u2032 by subtracting the mean value of each column in XD and YD, before computing a new pair of aligned representations of the full vocabulary, Qaligned = X \u2032VX\u03a3\u22121X U \u2032, and Waligned = Y \u2032VY \u03a3\u22121Y V \u2032. Once again, we perform dimensionality reduction by neglecting the final few columns of U \u2032 and V \u2032.\nEffectively, CCA is composed of two stages. In the first stage, we replace our word vector matrices X and Y by two new vector representations Q = X \u2032VX\u03a3\u22121X and W = Y \u2032VY \u03a3 \u22121 Y . In the second stage, we apply the orthogonal transformations {U \u2032, V \u2032} to align {Q,W} in a single shared space. To the authors, the first stage appears redundant. If we have already learned high-quality word vectors {X,Y }, there seems little reason to learn new representations {Q,W}. Additionally, it is unclear why the transformations VX\u03a3\u22121X and VY \u03a3 \u22121 Y are obtained using only the dictionary matrices {XD, YD}, rather than using the full vocabularies {X,Y }."}, {"heading": "2.4 THE INVERTED SOFTMAX", "text": "Mikolov et al. (2013a) predicted the translation of a source word xj by finding the target word yi closest to Wxj . In our formalism, this corresponds to finding the largest entry in the jth column of the similarity matrix. To estimate our confidence in this prediction, we could form the softmax,\nPj\u2192i = e\u03b2Sij\u2211 m e \u03b2Smj . (10)\nTo learn the \u201cinverse temperature\u201d \u03b2, we maximise the log probability over the training dictionary,\nmax \u03b2 \u2211 pairs ij ln(Pj\u2192i). (11)\nThis sum should be performed only over valid translation pairs. Dinu et al. (2014) demonstrated that nearest neighbour retrieval is flawed, since it suffers from the presence of \u201chubs\u201d. Hubs are words which appear as the nearest neighbour target word to many different source words, reducing the translation performance. We propose that the hubness problem is mitigated by inverting the softmax, and normalising the probability over source words rather than target words.\nPj\u2192i = e\u03b2Sij \u03b1j \u2211 n e \u03b2Sin . (12)\nIntuitively, rather than asking whether the source word translates to the candidate target word, we assess the probability that the candidate target word translates back into the source word. We then select the target word which maximises this probability. If the ith target word is a hub, then the\ndenominator in equation 12 will be large, preventing this target word from being selected. The vector \u03b1 ensures normalisation. The sum over n should run over all source words in the vocabulary. However to reduce the computational cost, we only perform this sum over ns sample words, chosen randomly from the vocabulary. Unless explicitly stated, ns = 1500."}, {"heading": "2.5 PSEUDO DICTIONARIES", "text": ""}, {"heading": "2.5.1 IDENTICAL CHARACTER STRINGS", "text": "Our method requires a training dictionary of paired vectors, which is used to infer the orthogonal map O and the inverse temperature \u03b2, and also as a validation set during dimensionality reduction. Typically this dictionary is obtained by translating common source words into the target language using Google Translate, which was constructed using expert human knowledge. However most European languages share a large number of words composed of identical character strings. Words like \u201cLondon\u201d, \u201cDNA\u201d and \u201cTortilla\u201d. It is probable that identical strings across two languages share similar meanings. We can extract these strings and form a \u201cpseudo-dictionary\u201d, compiled without any expert bilingual knowledge. Below we show that this pseudo dictionary is sufficient to successfully translate between English and Italian with high precision."}, {"heading": "2.5.2 ALIGNED SENTENCES", "text": "The Europarl corpus is composed of aligned sentences in a number of European languages (Koehn, 2005). Chandar et al. (2014) showed that such corpora can be used alongside monolingual text sources to learn online bilingual vectors, but to date, offline bilingual vectors have only been obtained from dictionaries. To learn the orthogonal transformation from aligned sentences, we define the vector q of a source language sentence by a normalised sum over the word vectors present, q = \u2211 i xi/ | \u2211 i xi|. The vector w of a target language sentence is defined by a normalised sum of word vectors yi. We view the aligned corpus as a dictionary of paired sentences {wi, qi}, from which we form two dictionary matrices WD and QD. We obtain the transformation O from an SVD on the matrix M = WTDQD, and use this transformation to translate individual words in the test set.\nThis simple procedure embeds words and sentences in the same vector space. The sentence embedding can be thought of as the \u201caverage word\u201d that the sentence conveys. Intuitively, each aligned sentence pair gives us weak information about a possible word pair in the dictionary. By combining a large number of such sentence pairs, we obtain sufficient information to align the vector spaces and infer the translations of individual words. However, we will go on to show that this orthogonal transformation can be used, not only to retrieve the translations of words between languages, but also to retrieve the translations of sentences between languages with remarkably high accuracy."}, {"heading": "3 EXPERIMENTS", "text": "We perform our experiments using the same word vectors, training dictionary and test dictionary provided by Dinu et al. (2014)1. The word vectors were trained using word2vec, and then the 200k most common words in both the English and Italian corpora were extracted. The English word vectors were trained on the WackyPedia/ukWaC and BNC corpora, while the Italian word vectors were trained on the WackyPedia/itWaC corpus. The training dictionary comprises 5k common English words and their Italian translations, while the test set is composed of 1500 English words and their Italian translations. This test set is split into five sets of 300. The first 300 words arise from the most common 5k words in the English corpus, the next 300 from the 5k-20k most common words, followed by bins for the 20k-50k, 50k-100k, and 100k-200k most common words. This enables us to evaluate how word frequency affects the translation performance. Some of the Italian words have both male and female forms, and we follow Dinu in considering either form a valid translation.\nWe report results using our own procedure, as well as the methods proposed by Mikolov, Faruqui, and Dinu. We compute results for Mikolov\u2019s method by applying the method of least squares, and results for Faruqui\u2019s method using Scikit-learn\u2019s implementation of CCA with default parameters. In both cases, we predict translations by nearest neighbour retrieval. We do not apply dimensionality\n1These are available at http://clic.cimec.unitn.it/~georgiana.dinu/down/\nreduction following CCA, to enable a fair comparison with our SVD procedure. We compute results for Dinu\u2019s method using the source code they provided alongside their manuscript. Their method uses 10k source words as \u201cpivots\u201d; 5k from the test set and 5k chosen at random from the vocabulary. By contrast, the inverted softmax does not know which source words occur in the test set."}, {"heading": "3.1 EXPERIMENTS USING THE EXPERT TRAINING DICTIONARY", "text": "In tables 1 and 2 we present the translation performance of our methods when translating the test set between English and Italian, using the expert training dictionary provided by Dinu. We evaluate Mikolov and Dinu\u2019s methods for comparison, as well as CCA- proposed by Faruqui & Dyer (2014). All the methods are more accurate when translating from English to Italian. This is unsurprising given that some English words in the test set can translate to either the male or female form of the Italian word. In the fourth column we evaluate the performance of our SVD procedure with nearest neighbour retrieval. This already provides a marked improvement on Mikolov\u2019s mapping, especially when translating from Italian into English. As anticipated, the performance of the SVD is very similar to CCA. In the following two columns we apply first the inverted softmax, and then dimensionality reduction to the aligned vector space obtained by the SVD. The hyper-parameters of these procedures were optimised on the training dictionary. Combining both procedures improves the precision @1 to 43% and 38% when translating from English to Italian, or Italian to English respectively. These results are a significant improvement on previous work. In table 3 we present the dependence of precision @1 on word frequency. We achieve remarkably high precision when translating common words. This performance drops off for rare words; presumably either because there is insufficient monolingual data to learn high quality rare word vectors, or because the linguistic similarities between rare words across languages are less pronounced."}, {"heading": "3.2 EXPERIMENTS USING IDENTICAL CHARACTER STRINGS", "text": "In the preceding section, we reported our performance using an orthogonal transformation learned on an expert training dictionary of 5k common English and Italian words. We now report our performance when we do not use this dictionary, and instead construct a pseudo dictionary from the list of words which appear in both the English and Italian vocabularies, composed of exactly the same character string. Remarkably, 47074 such identical character strings appear in both vocabularies. There would be fewer identical entries for more diverse language pairs, but our main goal here is to demonstrate the superior robustness of orthogonal transformations to low quality dictionaries.\nWe exhibit our results in table 4, where we evaluate our method (SVD + inverted softmax + dimensionality reduction), when translating either from English to Italian or from Italian to English. Even when using this pseudo dictionary prepared with no expert bilingual knowledge, we still achieve a mean translation performance @1 of 40% from English to Italian on our test set. By contrast, Mikolov and Dinu\u2019s methods achieve precisions of just 1% and 6% respectively. CCA also performs well, although it became significantly more computationally expensive when the vocabulary size increased. Previously translation pairs have been extracted from monolingual corpora using CCA by bootstrapping a small seed lexicon (Haghighi et al., 2008)."}, {"heading": "3.3 EXPERIMENTS ON THE EUROPARL CORPUS OF ALIGNED SENTENCES", "text": "The English-Italian Europarl corpus comprises 2 million English sentences and their Italian translations, taken from the proceedings of the European parliament (Koehn, 2005). As outlined earlier, we can form simple sentence vectors in the word vector space by summing and normalising over the words contained in a sentence. These sentence vectors can be used in two different tasks. First, we can use the Europarl corpus as a training dictionary, whereby the matrices XD and YD are formed from the sentence vectors of translation pairs. By applying the SVD to the first 500k sentences in this \u201cphrase dictionary\u201d, we obtain a set of bilingual word vectors from which we can retrieve translations of individual words. We exhibit the translation performance of this approach in table 5. We achieve 42.8% precision @1 when translating from English into Italian and 37.5% precision when translating from Italian into English, comparable to the accuracy achieved using the expert word dictionary on the same test set. It is difficult to compare the two approaches, since they require different training data. However our performance appears competitive with Bilbowa, a leading method for learning bilingual vectors online from monolingual corpora and aligned text (Gouws et al., 2015). We do not include results for CCA due to the computational complexity on a dictionary of this size.\nSecond, we can apply our orthogonal transformation to retrieve the Italian translation of an English sentence, or vice versa. To achieve this, we hold back the final 200k English and Italian sentences from our 500k sample of Europarl, and attempt to retrieve the true translation of a given sentence in this test set. We obtain the orthogonal transformation by performing the SVD on either the expert word dictionary provided by Dinu, or on a phrase dictionary formed from the first 300k\nsentences from Europarl. For simplicity, we do not apply dimensionality reduction here. Our results are provided in table 6. For precision @1, most approaches favour the phrase dictionary, while Dinu\u2019s method favours the word dictionary. We show in the appendix that all methods favour the phrase dictionary for precision @5 and @10. Remarkably, given no information except the sentence vectors, we are able to retrieve the correct translation of an English sentence with 67.8% precision. This is particularly surprising, since we are using the simplest possible sentence vectors, which have no information about word order or sentence length. It is likely that we could improve on these results if we used higher quality sentence vectors (Le & Mikolov, 2014; Kiros et al., 2015), although we might lose the ability to simultaneously align the underlying word vector space.\nWhen training the inverted softmax, the inverse temperature \u03b2 diverged, and the \u201ctranslation\u201d performance from English to Italian significantly exceeded the performance from Italian to English. This suggested that sentence retrieval from Italian to English might be achieved better by nearest neighbours, so we also evaluated the performance of nearest neighbour retrieval on the same orthogonal transformation, as shown in the third row of table 6. This improved the performance from Italian to English from 48.6% to 65.6%, which suggests that the optimal retrieval approach would be able to tune continuously between the conventional softmax and the inverted softmax."}, {"heading": "4 SUMMARY", "text": "We proved that the optimal linear transformation between word vector spaces should be orthogonal, and can be obtained by a single application of the SVD on a dictionary of translation pairs, as proposed independently by Artetxe et al. (2016). We used the SVD to obtain bilingual word vectors, from which we can predict the translations of previously unseen words. We introduced a novel \u201cinverted softmax\u201d which significantly increased the accuracy of our predicted translations. Combining the SVD with the inverted softmax and dimensionality reduction, we improved the translation precision of Mikolov\u2019s original linear mapping from 34% to 43%, when translating a test set composed of both common and rare English words into Italian. This was achieved using a training dictionary of 5k English words and their Italian translations. Replacing this training dictionary with a pseudodictionary acquired from the identical word strings that appear in both languages, we showed that we still achieved 40% precision, demonstrating that it is possible to obtain bilingual vector spaces without an expert bilingual signal. Mikolov\u2019s method achieves just 1% precision here, emphasising the superior robustness of orthogonal transformations. There are currently a number of approaches to obtaining offline bilingual word vectors in the literature. Our work shows they can all be unified.\nFinally, we defined simple sentence vectors to obtain offline bilingual word vectors without a dictionary using the Europarl corpus. We achieved 43% precision when translating our test set from English into Italian under this approach, comparable to our results above, and competitive with online approaches which use aligned text as the bilingual signal. We demonstrated that we can also use our sentence vectors to retrieve the true translation of an English sentence from a bag of 200k Italian candidate sentences with 68% precision, a striking result worthy of further investigation."}, {"heading": "ACKNOWLEDGMENTS", "text": "We thank Dinu et al. for providing their source code, pre-trained word vectors, and a training and test dictionary of English and Italian words, and Philipp Koehn for compiling the Europarl corpus."}, {"heading": "A THE ORTHOGONAL PROCRUSTES PROBLEM", "text": "There is not an intuitive analytic solution to the cost function in equation 6, but an analytic solution does exist to the closely related \u201corthogonal Procrustes problem\u201d, which minimises the squared reconstruction error subject to an orthogonal constraint (Scho\u0308nemann, 1966),\nmin O n\u2211 i=1 ||yi \u2212Oxi||2, subject to OTO = I. (13)\nHowever both X and Y are normalised, while O preserves the vector norm. We note that,\n||yi \u2212Oxi||2 = |yi|2 + |xi|2 \u2212 2yTi Oxi (14) \u221d A\u2212 yTi Oxi. (15)\nA is a constant, and so the cost functions given in equations 6 and 13 are equivalent. We presented the solution of the orthogonal Procrustes problem in the main text."}, {"heading": "B ADDITIONAL EXPERIMENTS", "text": "In tables 7 and 8, we provide results at precisions @5 and @10, for the same experiments shown @1 in table 6 of the main text. Once again, the inverted softmax performs well when retrieving the Italian translations of English sentences, but is less effective translating Italian sentences into English. However, the performance of Dinu\u2019s method appears to rise more rapidly than other methods as we transition from precision @1 to @5 to @10. Additionally, while Dinu\u2019s method performs better when using the word dictionary @1, it prefers the phrase dictionary @5 and @10."}], "references": [{"title": "Massively multilingual word embeddings", "author": ["Waleed Ammar", "George Mulcaire", "Yulia Tsvetkov", "Guillaume Lample", "Chris Dyer", "Noah A Smith"], "venue": null, "citeRegEx": "Ammar et al\\.,? \\Q1925\\E", "shortCiteRegEx": "Ammar et al\\.", "year": 1925}, {"title": "Learning principled bilingual mappings of word embeddings while preserving monolingual invariance", "author": ["M Artetxe", "G Labaka", "E Agirre"], "venue": "Proceedings of the 2016 Conference on Empirical Methods in Natural Language Processing,", "citeRegEx": "Artetxe et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Artetxe et al\\.", "year": 2016}, {"title": "An autoencoder approach to learning bilingual word representations", "author": ["Sarath Chandar", "Stanislas Lauly", "Hugo Larochelle", "Mitesh Khapra", "Balaraman Ravindran", "Vikas C Raykar", "Amrita Saha"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "Chandar et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Chandar et al\\.", "year": 2014}, {"title": "Improving zero-shot learning by mitigating the hubness problem", "author": ["Georgiana Dinu", "Angeliki Lazaridou", "Marco Baroni"], "venue": null, "citeRegEx": "Dinu et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Dinu et al\\.", "year": 2014}, {"title": "Improving vector space word representations using multilingual correlation", "author": ["Manaal Faruqui", "Chris Dyer"], "venue": "In Proceedings of the 2014 conference of the Association for Computational Linguistics. Association for Computational Linguistics,", "citeRegEx": "Faruqui and Dyer.,? \\Q2014\\E", "shortCiteRegEx": "Faruqui and Dyer.", "year": 2014}, {"title": "Bilbowa: Fast bilingual distributed representations without word alignments", "author": ["Stephan Gouws", "Yoshua Bengio", "Greg Corrado"], "venue": "In Proceedings of The 32nd International Conference on Machine Learning,", "citeRegEx": "Gouws et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Gouws et al\\.", "year": 2015}, {"title": "Learning bilingual lexicons from monolingual corpora", "author": ["Aria Haghighi", "Percy Liang", "Taylor Berg-Kirkpatrick", "Dan Klein"], "venue": "In ACL,", "citeRegEx": "Haghighi et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Haghighi et al\\.", "year": 2008}, {"title": "Multilingual distributed representations without word alignment", "author": ["Karl Moritz Hermann", "Phil Blunsom"], "venue": "arXiv preprint arXiv:1312.6173,", "citeRegEx": "Hermann and Blunsom.,? \\Q2013\\E", "shortCiteRegEx": "Hermann and Blunsom.", "year": 2013}, {"title": "Convolutional neural networks for sentence classification", "author": ["Yoon Kim"], "venue": null, "citeRegEx": "Kim.,? \\Q2014\\E", "shortCiteRegEx": "Kim.", "year": 2014}, {"title": "Skip-thought vectors. In Advances in neural information processing", "author": ["Ryan Kiros", "Yukun Zhu", "Ruslan R Salakhutdinov", "Richard Zemel", "Raquel Urtasun", "Antonio Torralba", "Sanja Fidler"], "venue": null, "citeRegEx": "Kiros et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Kiros et al\\.", "year": 2015}, {"title": "Inducing crosslingual distributed representations of words", "author": ["Alexandre Klementiev", "Ivan Titov", "Binod Bhattarai"], "venue": null, "citeRegEx": "Klementiev et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Klementiev et al\\.", "year": 2012}, {"title": "Europarl: A parallel corpus for statistical machine translation", "author": ["Philipp Koehn"], "venue": "In MT summit,", "citeRegEx": "Koehn.,? \\Q2005\\E", "shortCiteRegEx": "Koehn.", "year": 2005}, {"title": "Distributed representations of sentences and documents", "author": ["Quoc V Le", "Tomas Mikolov"], "venue": "In ICML,", "citeRegEx": "Le and Mikolov.,? \\Q2014\\E", "shortCiteRegEx": "Le and Mikolov.", "year": 2014}, {"title": "Deep multilingual correlation for improved word embeddings", "author": ["Ang Lu", "Weiran Wang", "Mohit Bansal", "Kevin Gimpel", "Karen Livescu"], "venue": "In Proceedings of NAACL,", "citeRegEx": "Lu et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Lu et al\\.", "year": 2015}, {"title": "Exploiting similarities among languages for machine translation", "author": ["Tomas Mikolov", "Quoc V Le", "Ilya Sutskever"], "venue": null, "citeRegEx": "Mikolov et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Mikolov et al\\.", "year": 2013}, {"title": "Distributed representations of words and phrases and their compositionality", "author": ["Tomas Mikolov", "Ilya Sutskever", "Kai Chen", "Greg S Corrado", "Jeff Dean"], "venue": "In Advances in neural information processing systems,", "citeRegEx": "Mikolov et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Mikolov et al\\.", "year": 2013}, {"title": "Canonical correlation clarified by singular value decomposition", "author": ["William H Press"], "venue": null, "citeRegEx": "Press.,? \\Q2011\\E", "shortCiteRegEx": "Press.", "year": 2011}, {"title": "A generalized solution of the orthogonal procrustes problem", "author": ["Peter H Sch\u00f6nemann"], "venue": null, "citeRegEx": "Sch\u00f6nemann.,? \\Q1966\\E", "shortCiteRegEx": "Sch\u00f6nemann.", "year": 1966}, {"title": "Normalized word embedding and orthogonal transform for bilingual word translation", "author": ["Chao Xing", "Dong Wang", "Chao Liu", "Yiye Lin"], "venue": "In Proceedings of the 2015 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies,", "citeRegEx": "Xing et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Xing et al\\.", "year": 2015}, {"title": "Bilingual word embeddings for phrase-based machine translation", "author": ["Will Y Zou", "Richard Socher", "Daniel M Cer", "Christopher D Manning"], "venue": "In EMNLP,", "citeRegEx": "Zou et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Zou et al\\.", "year": 2013}], "referenceMentions": [{"referenceID": 14, "context": "Mikolov et al. (2013a) showed they can also be found \u201coffline\u201d; whereby two pre-trained embeddings are aligned with a linear transformation, using dictionaries compiled from expert knowledge.", "startOffset": 0, "endOffset": 23}, {"referenceID": 8, "context": "They enable us to train sophisticated classifiers to interpret free flowing text (Kim, 2014), but they require independent models to be trained for each language.", "startOffset": 81, "endOffset": 92}, {"referenceID": 19, "context": "Such vectors may drive improvements in machine translation (Zou et al., 2013), and enable language-agnostic text classifiers (Klementiev et al.", "startOffset": 59, "endOffset": 77}, {"referenceID": 10, "context": ", 2013), and enable language-agnostic text classifiers (Klementiev et al., 2012).", "startOffset": 55, "endOffset": 80}, {"referenceID": 2, "context": "Bilingual vectors are normally trained \u201conline\u201d, whereby both languages are learnt together in a shared space (Chandar et al., 2014; Hermann & Blunsom, 2013).", "startOffset": 110, "endOffset": 157}, {"referenceID": 2, "context": "Bilingual vectors are normally trained \u201conline\u201d, whereby both languages are learnt together in a shared space (Chandar et al., 2014; Hermann & Blunsom, 2013). Typically these algorithms exploit two sources of monolingual text alongside a smaller bilingual corpus of aligned sentences. This bilingual signal provides a regularisation term, which penalises the embeddings if similar words in the two languages do not lie nearby in the vector space. However Mikolov et al. (2013a) showed that bilingual word vectors can also be obtained \u201coffline\u201d.", "startOffset": 111, "endOffset": 478}, {"referenceID": 3, "context": "We build on the work of Dinu et al. (2014), by introducing a novel \u201cinverted softmax\u201d to combat the hubness problem.", "startOffset": 24, "endOffset": 43}, {"referenceID": 14, "context": "Offline bilingual word vectors were first proposed by Mikolov et al. (2013a). They obtained a small dictionary of paired words from Google Translate, whose word vectors we denote {yi, xi}i=1.", "startOffset": 54, "endOffset": 77}, {"referenceID": 6, "context": "CCA had previously been used to iteratively extract translation pairs directly from monolingual corpora (Haghighi et al., 2008).", "startOffset": 104, "endOffset": 127}, {"referenceID": 13, "context": ", 2016), and non-linear \u201cdeep CCA\u201d has been introduced (Lu et al., 2015).", "startOffset": 55, "endOffset": 72}, {"referenceID": 1, "context": "We note that the cost function above is solved by the method of least squares, as realised by Dinu et al. (2014). They did not modify this cost function, but proposed an adapted method of retrieving translation pairs which was more accurate when translating words from English to Italian.", "startOffset": 94, "endOffset": 113}, {"referenceID": 1, "context": "We note that the cost function above is solved by the method of least squares, as realised by Dinu et al. (2014). They did not modify this cost function, but proposed an adapted method of retrieving translation pairs which was more accurate when translating words from English to Italian. Faruqui & Dyer (2014) obtained bilingual word vectors using CCA.", "startOffset": 94, "endOffset": 311}, {"referenceID": 1, "context": "We note that the cost function above is solved by the method of least squares, as realised by Dinu et al. (2014). They did not modify this cost function, but proposed an adapted method of retrieving translation pairs which was more accurate when translating words from English to Italian. Faruqui & Dyer (2014) obtained bilingual word vectors using CCA. They did not attempt any translation tasks, but showed that the combination of CCA and dimensionality reduction improved the performance of monolingual vectors on standard evaluation tasks. CCA had previously been used to iteratively extract translation pairs directly from monolingual corpora (Haghighi et al., 2008). More recently, Xing et al. (2015) argued that Mikolov\u2019s linear matrix should be orthogonal, and introduced an approximate procedure composed of gradient descent updates and repeated applications of the SVD.", "startOffset": 94, "endOffset": 707}, {"referenceID": 0, "context": "CCA has been extended to map 59 languages into a single shared space (Ammar et al., 2016), and non-linear \u201cdeep CCA\u201d has been introduced (Lu et al., 2015). A theoretical analysis of bilingual word vectors similar to this paper was recently published by Artetxe et al. (2016).", "startOffset": 70, "endOffset": 275}, {"referenceID": 1, "context": "It was recently independently proposed by Artetxe et al. (2016), and provides a numerically exact solution to the cost function proposed by Xing et al.", "startOffset": 42, "endOffset": 64}, {"referenceID": 1, "context": "It was recently independently proposed by Artetxe et al. (2016), and provides a numerically exact solution to the cost function proposed by Xing et al. (2015), just as the method of least squares provides a numerically exact solution to the cost function of Mikolov et al.", "startOffset": 42, "endOffset": 159}, {"referenceID": 1, "context": "It was recently independently proposed by Artetxe et al. (2016), and provides a numerically exact solution to the cost function proposed by Xing et al. (2015), just as the method of least squares provides a numerically exact solution to the cost function of Mikolov et al. (2013a). Our procedure did not use the singular values \u03a3, but these values do carry relevant information.", "startOffset": 42, "endOffset": 281}, {"referenceID": 16, "context": "Our method is very similar to the CCA procedure proposed by Faruqui & Dyer (2014), which can also be obtained using the SVD (Press, 2011).", "startOffset": 124, "endOffset": 137}, {"referenceID": 3, "context": "Dinu et al. (2014) demonstrated that nearest neighbour retrieval is flawed, since it suffers from the presence of \u201chubs\u201d.", "startOffset": 0, "endOffset": 19}, {"referenceID": 11, "context": "The Europarl corpus is composed of aligned sentences in a number of European languages (Koehn, 2005).", "startOffset": 87, "endOffset": 100}, {"referenceID": 2, "context": "Chandar et al. (2014) showed that such corpora can be used alongside monolingual text sources to learn online bilingual vectors, but to date, offline bilingual vectors have only been obtained from dictionaries.", "startOffset": 0, "endOffset": 22}, {"referenceID": 3, "context": "We perform our experiments using the same word vectors, training dictionary and test dictionary provided by Dinu et al. (2014)1.", "startOffset": 108, "endOffset": 127}, {"referenceID": 6, "context": "Previously translation pairs have been extracted from monolingual corpora using CCA by bootstrapping a small seed lexicon (Haghighi et al., 2008).", "startOffset": 122, "endOffset": 145}, {"referenceID": 11, "context": "The English-Italian Europarl corpus comprises 2 million English sentences and their Italian translations, taken from the proceedings of the European parliament (Koehn, 2005).", "startOffset": 160, "endOffset": 173}, {"referenceID": 5, "context": "However our performance appears competitive with Bilbowa, a leading method for learning bilingual vectors online from monolingual corpora and aligned text (Gouws et al., 2015).", "startOffset": 155, "endOffset": 175}, {"referenceID": 9, "context": "It is likely that we could improve on these results if we used higher quality sentence vectors (Le & Mikolov, 2014; Kiros et al., 2015), although we might lose the ability to simultaneously align the underlying word vector space.", "startOffset": 95, "endOffset": 135}, {"referenceID": 1, "context": "We proved that the optimal linear transformation between word vector spaces should be orthogonal, and can be obtained by a single application of the SVD on a dictionary of translation pairs, as proposed independently by Artetxe et al. (2016). We used the SVD to obtain bilingual word vectors, from which we can predict the translations of previously unseen words.", "startOffset": 220, "endOffset": 242}], "year": 2017, "abstractText": "Usually bilingual word vectors are trained \u201conline\u201d. Mikolov et al. (2013a) showed they can also be found \u201coffline\u201d; whereby two pre-trained embeddings are aligned with a linear transformation, using dictionaries compiled from expert knowledge. In this work, we prove that the linear transformation between two spaces should be orthogonal. This transformation can be obtained using the singular value decomposition. We introduce a novel \u201cinverted softmax\u201d for identifying translation pairs, with which we improve the precision @1 of Mikolov\u2019s original mapping from 34% to 43%, when translating a test set composed of both common and rare English words into Italian. Orthogonal transformations are more robust to noise, enabling us to learn the transformation without expert bilingual signal by constructing a \u201cpseudo-dictionary\u201d from the identical character strings which appear in both languages, achieving 40% precision on the same test set. Finally, we extend our method to retrieve the true translations of English sentences from a corpus of 200k Italian sentences with a precision @1 of 68%.", "creator": "LaTeX with hyperref package"}}}