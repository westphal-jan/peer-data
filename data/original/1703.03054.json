{"id": "1703.03054", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "8-Mar-2017", "title": "Deep Variation-structured Reinforcement Learning for Visual Relationship and Attribute Detection", "abstract": "Despite progress in visual perception tasks such as image classification and detection, computers still struggle to understand the interdependency of objects in the scene as a whole, e.g., relations between objects or their attributes. Existing methods often ignore global context cues capturing the interactions among different object instances, and can only recognize a handful of types by exhaustively training individual detectors for all possible relationships. To capture such global interdependency, we propose a deep Variation-structured Reinforcement Learning (VRL) framework to sequentially discover object relationships and attributes in the whole image. First, a directed semantic action graph is built using language priors to provide a rich and compact representation of semantic correlations between object categories, predicates, and attributes. Next, we use a variation-structured traversal over the action graph to construct a small, adaptive action set for each step based on the current state and historical actions. In particular, an ambiguity-aware object mining scheme is used to resolve semantic ambiguity among object categories that the object detector fails to distinguish. We then make sequential predictions using a deep RL framework, incorporating global context cues and semantic embeddings of previously extracted phrases in the state vector. Our experiments on the Visual Relationship Detection (VRD) dataset and the large-scale Visual Genome dataset validate the superiority of VRL, which can achieve significantly better detection results on datasets involving thousands of relationship and attribute types. We also demonstrate that VRL is able to predict unseen types embedded in our action graph by learning correlations on shared graph nodes.", "histories": [["v1", "Wed, 8 Mar 2017 22:09:10 GMT  (4055kb,D)", "http://arxiv.org/abs/1703.03054v1", "This manuscript is accepted by CVPR 2017 as a spotlight paper"]], "COMMENTS": "This manuscript is accepted by CVPR 2017 as a spotlight paper", "reviews": [], "SUBJECTS": "cs.CV cs.AI cs.LG", "authors": ["xiaodan liang", "lisa lee", "eric p xing"], "accepted": false, "id": "1703.03054"}, "pdf": {"name": "1703.03054.pdf", "metadata": {"source": "CRF", "title": "Deep Variation-structured Reinforcement Learning for Visual Relationship and Attribute Detection", "authors": ["Xiaodan Liang", "Lisa Lee", "Eric P. Xing"], "emails": ["xiaodan1@cs.cmu.edu", "lslee@cs.cmu.edu", "epxing@cs.cmu.edu"], "sections": [{"heading": "1. Introduction", "text": "Although much progress has been made in image classification [7], detection [20] and segmentation [15], we are still far from reaching the goal of holistic scene\nunderstanding\u2014that is, a model capable of recognizing the interactions and relationships between objects, and describing their attributes. While objects are the core building blocks of an image, it is often the relationships and attributes that determine the holistic interpretation of the scene. For example in Fig. 1, the left image can be understood as \u201ca man standing on a yellow and green skateboard\u201d, and the right image as \u201ca woman wearing a blue wet suit and kneeling on a surfboard\u201d. Being able to extract and exploit such visual information would benefit many realworld applications such as image search [19], question answering [1, 9], and fine-grained recognition [27, 4].\nVisual relationships are a pair of localized objects connected via a predicate; for example, predicates can be actions (\u201ckick\u201d), comparative (\u201csmaller than\u201d), spatial (\u201cnear to\u201d), verbs (\u201cwear\u201d), or prepositions (\u201cwith\u201d). Attributes describe a localized object, e.g., with color (\u201cyellow\u201d) or state (\u201cstanding\u201d). Detecting relationships and attributes is more challenging than traditional object detection [20] due to the following reasons: (1) There are a massive number of possible relationship and attribute types (e.g., 13,894 relationship types in Visual Genome [13]), resulting in a greater skew of rare and infrequent types. (2) Each object can be associated with many relationships and attributes, making it inefficient to exhaustively search all possible relationships\n1\nar X\niv :1\n70 3.\n03 05\n4v 1\n[ cs\n.C V\n] 8\nM ar\n2 01\nfor each pair of objects. (3) A global, holistic perspective of the image is essential to resolve semantic ambiguities (e.g., \u201cwoman wearing wetsuit\u201d vs. \u201cwoman wearing shirt\u201d). Existing approaches [22, 10, 16] only predict a limited set of relationship types (e.g., 13 in Visual Phrase [22]) and ignore semantic interdependencies between relationships and attributes by evaluating each region within a scene separately [16]. It is impractical to exhaustively search all possibilities for each region, and also deviates from human perception. Therefore, it is preferable to have a more principled decision-making framework, which can discover all relevant relationships and attributes within a small number of search steps. To address the aforementioned issues, we propose a deep Variation-structured Reinforcement Learning (VRL) framework which sequentially detects relationship and attribute instances by exploiting global context cues.\nFirst, we use language priors to build a directed semantic action graph G, where the nodes are nouns, attributes, and predicates, connected by directed edges that represent semantic correlations (see Fig. 2). This graph provides a highly-informative, compact representation that enables the model to learn rare relationships and attributes from frequent ones using shared graph nodes. For example, the semantic meaning of \u201criding\u201d learned from \u201cperson-ridingbicycle\u201d can help predict the rare phrase \u201cchild-ridingelephant\u201d. This generalizing ability allows VRL to handle a considerable number of possible relationship types.\nSecond, existing deep reinforcement learning (RL) models [24] often require several costly episodes of trial and error to converge, even with a small action space, and our large action space would exacerbate this problem. To efficiently discover all relationships and attributes in a small\nnumber of steps, we introduce a novel variation-structured traversal scheme over the action graph which constructs small, adaptive action sets \u2206a,\u2206p,\u2206c for each step based on the current state and historical actions: \u2206a contains candidate attributes to describe an object; \u2206p contains candidate predicates for relating a pair of objects; and \u2206c contains new object instances to mine in the next step. Since an object instance may belong to multiple object categories which the object detector cannot distinguish, we introduce an ambiguity-aware object mining scheme to assign each object with the most appropriate category given the global scene context. Our variation-structured traversal scheme offers a very promising technique for extending the applications of deep RL to complex real-world tasks.\nThird, to incorporate global context cues for better reasoning, we explicitly encode the semantic embeddings of previously extracted phrases in the state vector. It makes a better tradeoff between increasing the input dimension and utilizing more historical context, compared to appending history frames [28] or binary action vectors [2] as in previous RL methods.\nExtensive experiments on the Visual Relationship Detection (VRD) dataset [16] and Visual Genome dataset [13] demonstrate that the proposed VRL outperforms state-ofthe-art methods for both relationship and attribute detection, and also has good generalization capabilities for predicting unseen types."}, {"heading": "2. Related Works", "text": "Visual relationship and attribute detection. There has been an increased interest in the problem of visual\nrelationship detection [22, 21, 13]. However, most existing approaches [22] [13] can detect only a handful of pre-defined, frequent types by training individual detectors for each relationship. Recently, Lu et al. [16] leveraged word embeddings to handle large-scale relationships. However, their model still ignores the structured correlations between objects and relationships. Furthermore, some methods [10, 23, 14] organized predictions into a scene graph which can provide a structured representation for describing the objects, their attributes and relationships in each image. In particular, Johnson et al. [10] introduced a conditional random field model for reasoning about possible groundings of scene graphs while Schuster et al. [23] proposed a rule-based and classifier-based scene graph parser. In contrast, the proposed VRL makes the first attempt to sequentially discover objects, relationships and attributes by fully exploiting global interdependency.\nDeep reinforcement learning. Integrating deep learning methods with reinforcement learning (RL) [11] has recently shown very promising results on decision-making problems. For example, Mnih et al. [18] proposed using deep Q-networks to play ATARI games. Silver et al. [24] proposed a new search algorithm based on the integration of Monte-Carlo tree search with deep RL, which beat the world champion in the game of Go. Other efforts applied deep RL to various real-world tasks, e.g., robotic manipulation [6], indoor navigation [28], and object proposal generation [2]. Our work deals with real-world scenes that are much more complex than ATARI games or images taken in some constrained scenarios, and investigates how to make decisions over a larger action space (e.g., thousands of attribute types). To handle such a large action space, we propose a variation-structured traversal scheme over the whole action graph to decrease the number of possible actions in each step, which substantially reduces the number of trials and thus speeds up the convergence."}, {"heading": "3. Deep Variation-structured Reinforcement", "text": "Learning\nWe propose a novel VRL framework which formulates the problem of detecting visual relationships and attributes as a sequential decision-making process. An overview is provided in Fig. 2. The key components of VRL, including the directed semantic action graph, the variation-structured traversal scheme, the state space, and the reward function, are detailed in the following sections."}, {"heading": "3.1. Directed Semantic Action Graph", "text": "We build a directed semantic graph G = (V, E) to organize all possible object nouns, attributes, and relationships into a compact and semantically meaningful representation (see Fig. 2). The nodes V consist of the set of all candidate object categories C, attributes A, and predicates P . Object\ncategories in C are nouns, and may be people, places, or parts of objects. Attributes in A can describe color, shape, or pose. Relationships are directional, i.e. they relate a subject noun and an object noun via a predicate. Predicates in P can be spatial (e.g., \u201cinside of\u201d), compositional (e.g. \u201cpart of\u201d) or action (e.g., \u201cswinging\u201d).\nThe directed edges E consist of attribute phrases EA \u2286 C \u00d7A and predicate phrases EP \u2286 C \u00d7P \u00d7C. An attribute phrase (c, a) \u2208 EA represents an attribute a \u2208 A belonging to a noun c \u2208 C. For example, the attribute phrase \u201cyoung girl\u201d can be represented by (\u201cgirl\u201d, \u201cyoung\u201d) \u2208 EA. A predicate phrase (c, p, c\u2032) \u2208 EP represents a subject noun c \u2208 C and an object noun c\u2032 \u2208 C related by a predicate p \u2208 P . For example, the predicate phrase \u201ca man is swinging a bat\u201d can be represented by (\u201cman\u201d, \u201cswinging\u201d, \u201cbat\u201d) \u2208 EP .\nThe recently released Visual Genome dataset [13] provides a large-scale annotation of images containing 18,136 unique object categories, 13,041 unique attributes, and 13,894 unique relationships. We then select the types that appear at least 30 times in Visual Genome dataset, resulting in 1,750 object-, 8,561 attribute-, and 13,823 relationshiptypes. From these attribute and relationship types, we build a directed semantic action graph by extracting all unique object category words, attribute words, and predicate words as the graph nodes. Our directed action graph thus contains |C| = 1750 object nodes, |A| = 1049 attribute nodes, and |P| = 347 predicate nodes. On average, each object word is connected to 5 attribute words and 15 predicate words. This semantic action graph serves as the action space for VRL, as we will see in the next section."}, {"heading": "3.2. Variation-structured RL", "text": "Instead of learning in the entire action space as in traditional deep RL [18, 28], we propose a novel variationstructured traversal scheme over the semantic action graph that dynamically constructs small action sets for each step.\nFirst, VRL uses an object detector to get a set S of candidate object instances, and then sequentially assigns relationships and attributes to each instance s \u2208 S. For our experiments, we used state-of-the-art Faster R-CNN [20] as the object detector, where the network parameters were initialized using the pre-trained VGG-16 ImageNet model [25].\nSince subject instances in an image often have multiple relationships and attributes, we do a breadth-first search: we predict all relationships and attributes with respect to the current subject instance of interest, and then move onto the next instance. We start from the subject instance with the most confident classification score. To prevent the agent from being trapped in a single search path (e.g., in a small local region), the agent selects a new starting subject instance if it has traversed through 5 neighboring objects in the breadth-first search.\nThe same object in multiple scenarios may be described\nby different, semantically ambiguous noun categories that cannot be distinguished by the object detector. To address this semantic ambiguity, we introduce an ambiguity-aware object mining scheme which leverages scene contexts captured by extracted relationships and attributes to help determine the most appropriate object category.\nVariation-structured action space. The directed semantic graph G serves as the action space for VRL. For any object instance s \u2208 S in an image, denote its object category by sc \u2208 C and its bounding box by B(s) = (sx, sy, sw, sh) where (sx, sy) is the center coordinate, sw is the width, and sh is the height. Given the current subject instance s and object instance s\u2032, we select three actions ga \u2208 A, gp \u2208 P , gc \u2208 C according to the VRL network as follows:\n(1) Select an attribute ga describing s from the set \u2206a = {a : (sc, a) \u2208 EA\\HA(s)}, where HA(s) denotes the set of previously mined attribute phrases for s.\n(2) Select a predicate gp relating the subject noun sc and object noun s\u2032c from \u2206p = {p : (sc, p, s\u2032c) \u2208 EP}.\n(3) To select the next object instance s\u0303 \u2208 S in the image, we select its corresponding object category gc from a set \u2206c \u2286 C, which is constructed using an ambiguity-\naware object mining scheme as follows (also illustrated in Fig. 5). Let N(s) \u2286 S be the set of objects neighboring s, where a neighbor of s is defined to be any object s\u0303 \u2208 S such that |s\u0303x \u2212 sx| < 0.5(s\u0303w + sw) and |s\u0303y \u2212 sy| < 0.5(s\u0303h + sh). For each object s\u0303, let C(s\u0303) \u2286 C be the set of object categories of s\u0303 whose confidence scores are at most 0.1 less than that of the most confident category. Let \u2206c = \u22c3 s\u0303\u2208N(s)\\HS C(s\u0303) \u222a {Terminal}, where HS is the set of previously extracted object instances and Terminal is a terminal trigger indicating the end of the object mining scheme for this subject instance. If N(s)\\Hs is empty or the terminal trigger is activated, then we select a new subject instance following the breadth-first scheme. The terminal trigger allows the number of object mining steps for each subject instance to be dynamically specified and limited to a small number.\nIn each step, the VRL selects actions from the adaptive action sets \u2206a,\u2206p, and \u2206c, which we call the variationstructured action space due to their dynamic structure.\nState space. A detailed overview of the state feature extraction process is shown in Fig. 3. Given the current subject s and object s\u2032 instances in each time step, the state vector f is a concatenation of (1) the feature vectors of s and s\u2032; (2) the feature vector of the whole image; and (3) a history phrase embedding vector, which is created by concatenating the semantic embeddings of the last two relationship phrases (relating s and s\u2032) and the last two attribute phrases (describing s) that were mined via the variation-structured traversal scheme. More specifically, each phrase (e.g., \u201cperson riding bicycle\u201d) is embedded into a 2400-dim vector using a pre-trained Skip-thought language model [12], thus resulting in a 9600-dim history phrase embedding.\nThe feature vector of the whole image provides global\ncontext cues which not only help in recognizing relationships and attributes, but also allow the agent to be aware of other uncovered objects. The history phrase embedding captures the search paths and scene contexts that have already been traversed by the agent.\nRewards: Suppose we have groundtruth labels, which consist of the set S\u0302 of object instances in the image, and attribute phrases E\u0302A and predicate phrases E\u0302P describing the objects in S\u0302. Given a predicted object instance s \u2208 S , we say that a groundtruth object s\u0302 \u2208 S\u0302 overlaps with s if they have the same object category (i.e., sc = s\u0302c \u2208 C), and their bounding boxes have at least 0.5 Intersection-overUnion (IoU) overlap.\nWe define the following reward functions to reflect the detection accuracy of taking action (ga,gp,gc) in state f , where the current subject and object instances are s and s\u2032, respectively:\n(1)Ra(f ,ga) returns +1 if there exists a groundtruth object s\u0302 \u2208 S\u0302 that overlaps with s, and the predicted attribute relationship (sc,ga) is in the groundtruth set E\u0302A. Otherwise, it returns -1.\n(2) Rp(f ,gp) returns +1 if there exists s\u0302, s\u0302\u2032 \u2208 S\u0302 that overlap with s and s\u2032 respectively, and (sc,gp, s\u2032c) \u2208 E\u0302P . Otherwise, it returns -1.\n(3) Rc(f ,gc) returns +5 if the next object instance s\u0303 \u2208 S corresponding to category gc \u2208 C overlaps with a new groundtruth object s\u0302 \u2208 S . Otherwise, it returns -1. Thus, it encourages faster exploration over all objects in the image."}, {"heading": "3.3. Deep Variation-structured RL", "text": "We optimize three policies to select three actions for each state by maximizing the sum of discounted rewards, which can be formulated as a decision-making process in the deep RL framework. Due to the high-dimensional continuous image data and a model-free environment, we resort to the deep Q-Network (DQN) framework proposed by [17, 18],\nwhich generalizes well to unseen inputs. The detailed architecture of our Q-network is illustrated in Fig. 3. Specifically, we use DQN to estimate three Q-value sets, parametrized by network weights \u03b8a, \u03b8p, \u03b8c, which correspond to the action sets A,P, C. In each training episode, we use an - greedy strategy to select actions ga,gp,gc in the variationstructured action space \u2206a,\u2206p,\u2206c, where the agent selects random actions with probability , and selects actions with the highest estimated Q-values with probability 1\u2212 . During testing, we directly select the best actions with highest estimated Q-values in \u2206a,\u2206p,\u2206c. The agent sequentially determines the best actions to discover objects, relationships, and attributes in the given image, until either the maximum search step is reached or there are no remaining uncovered object instances.\nWe also utilize a replay memory to store experience from past episodes. In each step, we draw a random minibatch from the replay memory to perform the Q-learning update. The replay memory helps stabilize the training by smoothing the training distribution over past experiences and reducing correlation between training samples [17, 18]. Given a transition sample (f , f \u2032,ga,gp,gc,Ra,Rp,Rc), the network weights \u03b8(t)a , \u03b8 (t) p , \u03b8 (t) c are updated as follows:\n\u03b8(t+1)a =\u03b8 (t) a + \u03b1(Ra + \u03bbmax ga\u2032 Q(f \u2032,ga\u2032 ; \u03b8 (t)\u2212 a )\n\u2212Q(f ,ga; \u03b8(t)a ))5\u03b8(t)a Q(f ,ga; \u03b8 (t) a ),\n\u03b8(t+1)p =\u03b8 (t) p + \u03b1(Rp + \u03bbmax gp\u2032 Q(f \u2032,gp\u2032 ; \u03b8 (t)\u2212 p )\n\u2212Q(f ,gp; \u03b8(t)p ))5\u03b8(t)p Q(f ,gp; \u03b8 (t) p ),\n\u03b8(t+1)c =\u03b8 (t) c + \u03b1(Rc + \u03bbmax gc\u2032 Q(f \u2032,gc\u2032 ; \u03b8 (t)\u2212 c )\n\u2212Q(f ,gc; \u03b8(t)c ))5\u03b8(t)c Q(f ,gc; \u03b8 (t) c ),\n(1)\nwhere ga\u2032 , gp\u2032 , gc\u2032 represent the actions that can be taken in state f \u2032, \u03b1 is the learning rate, and \u03bb is the discount factor. The target network weights \u03b8(t)\u2212a , \u03b8 (t)\u2212 p , \u03b8 (t)\u2212 c are copied every \u03c4 steps from the online network, and kept fixed in all other steps."}, {"heading": "4. Experiments", "text": "Dataset. We conduct our experiments on the Visual Relationship Detection (VRD) dataset [16] and the Visual Genome dataset [13]. VRD [16] contains 5000 images (4000 for training, 1000 for testing) with 100 object categories and 70 predicates. In total, the dataset contains 37,993 relationship instances with 6,672 relationship types, out of which 1,877 relationships occur only in the test set and not in the training set. For the Visual Genome Dataset [13], we experiment on 87,398 images (out of which 5000 are held out for validation, and 5000 for testing), containing 703,839 relationship instances with 13,823 relationship types and 1,464,446 attribute instances with\n8,561 attribute types. There are 2,015 relationship types that occur in the test set but not in the training set, which allows us to evaluate VRL on zero-shot learning.\nImplementation Details. We train a deep Q-network for 60 epochs with a shared RMSProp optimizer [26]. Each epoch ends after performing an episode on all training images. We use a mini-batch size of 64 images. The maximum search step for each image is empirically set to 300. During -greedy training, is annealed linearly from 1 to 0.1 over the first 20 epochs, and is fixed to 0.1 in the remaining epochs. The discount factor \u03bb is set to 0.9, and the network parameters \u03b8(t)\u2212a , \u03b8 (t)\u2212 p and \u03b8 (t)\u2212 c are copied after every \u03c4 = 10000 steps. The learning rate \u03b1 is initialized to 0.0007 and decreased by a factor of 10 after every 10 epochs. Only the top 100 candidate object instances, ranked by objectness confidence scores by the trained object detector, are selected for mining relationships and attributes in an image, in order to balance efficiency and effectiveness. On VRD [16], VRL takes about 8 hours to train an object detector with 100 object categories, and two days to converge. On the Visual Genome dataset [13], VRL takes between 4 to 5 days to train an object detector with 1750 object categories, and one week to converge. On average, it takes 300ms to feed-forward one image into VRL. More details about the dataset are provided in Sec. 4. The implementations are based on the publicly available Torch7 platform on a single NVIDIA GeForce GTX 1080.\nEvaluation. Following [16], we use recall@100 and recall@50 as our evaluation metrics. Recall@x computes the fraction of times the correct relationship or attribute instance is covered in the top x confident predictions, which are ranked by the product of objectness confidence scores for the relevant object instances (i.e., confidence scores of the object detector) and Q-values of the selected predicates or attributes. As discussed in [16], we do not use the mean average precision (mAP), which is a pessimistic evaluation metric because the dataset cannot exhaustively annotate all\npossible relationships and attributes in an image.\nFollowing [16], we evaluate on three tasks: (1) In relationship phrase detection [22], the goal is to predict a \u201csubject-predicate-object\u201d phrase, where the localization of the entire relationship has at least 0.5 overlap with a groundtruth bounding box. (2) In relationship detection, the goal is to predict a \u201csubject-predicate-object\u201d phrase, where the localizations of the subject and object instances have at least 0.5 overlap with their corresponding groundtruth boxes. (3) In attribute detection, the goal is to predict a \u201csubject-attribute\u201d phrase, where the subject\u2019s localization has at least 0.5 overlap with a groundtruth box.\nBaseline models. First, we compare our model with state-of-the-art approaches, Visual Phrases [22], Joint CNN+R-CNN [25] and Lu et al. [16]. Note that the latter two methods use R-CNN [5] to extract object proposals. Their results on VRD are reported in [16], and we also experiment their methods on the Visual Genome dataset. Lu et al. V only [16] trains individual detectors for object and predicate categories separately, and then combines their confidences to generate a relationship prediction. Furthermore, we train and compare with the following models: \u201cFaster R-CNN [20]\u201d directly detects each unique relationship or attribute type, following Visual Phrases [22]. \u201cFaster R-CNN V only [20]\u201d model is similar to Lu et al. V only [16], with the only difference being that Faster RCNN is used for object detection. \u201cJoint CNN+RPN [25]\u201d extracts proposals using the pre-trained RPN [20] model on VOC 2012 [3] and then performs the classification. \u201cJoint CNN+Trained RPN [20]\u201d trains a separate RPN model on our dataset to generate proposals."}, {"heading": "4.1. Comparison with State-of-the-art Models", "text": "Comparison of results with baseline methods on VRD and Visual Genome are reported in Tables 1, 2, and 3.\nShared Detectors vs Individual Detectors. The compared models can be categorized into two classes: (1) Models that train individual detectors for each predicate or attribute type, i.e., Visual Phrases [22], Joint CNN+RCNN [25], Joint CNN+RPN [25], Faster R-CNN [20], Joint CNN+Trained RPN [20]. (2) Models that train shared detectors for predicate or attribute types, and then combine their results with object detectors to generate the final prediction, i.e., Lu et al. V only [16], Faster R-CNN V only [20], Lu et al. [16] and our VRL. Since the space of all possible relationships and attributes is often large, there are insufficient training examples for infrequent relationships, leading to poor average performance of the models that use individual detectors.\nRPN vs R-CNN. In all cases, we obtain performance improvements using RPN network [20] over R-CNN [5] for proposal generation. Additionally, training the proposal network on VRD and VG datasets can also increase the recalls over the pre-trained networks on other datasets.\nLanguage Priors. Unlike baselines that simply train classifiers from visual cues, VRL and Lu et al. [16] leverage language priors to facilitate prediction. Lu et al. [16] uses semantic word embeddings to finetune the likelihood of a predicted relationship, while VRL follows a variationalstructured traversal scheme over a directed semantic action graph built from language priors. Both VRL and Lu et al. [16] achieve significantly better performance than other baselines, which demonstrates the necessity of language priors for relationship and attribute detection. Moreover, VRL still shows substantial improvements comparison to Lu et al. [16]. Therefore, VRL\u2019s directed semantic action graph provides a more compact and rich representation of semantic correlations than the word embeddings used in Lu et al. [16]. The significant performance improvement is also due to the sequential reasoning of RL.\nQualitative Comparisons We show some qualitative comparison with Lu et al. [16] in Fig. 6, and more detection\nresults of VRL in Fig. 8. Our VRL generates a rich understanding of the image, including the localization and recognition of objects, and the detection of object relationships and attributes. For instance, VRL can correctly detect interactions (\u201cperson on elephant\u201d, \u201cman riding motor\u201d), spatial layouts (\u201cpicture hanging on wall\u201d, \u201ccar on road\u201d), parts of objects (\u201cperson has shirt\u201d, \u201cwheel of motor\u201d), and attribute descriptions (\u201ctelevision old\u201d, \u201cwoman standing\u201d)."}, {"heading": "4.2. Discussion", "text": "We give further analysis on the key components of VRL, and report the results in Table 4.\nReinforcement Learning vs. Random Walk. The variant \u201cRL\u201d is a standard deep RL model that selects three actions over the entire action space instead of the variationstructured action space. We compare RL with a simple \u201cRandom Walk\u201d traversal scheme where in each step, the agent randomly selects one object instance in the image, and predicts relationships and attributions for the two mostrecently selected instances.\u201cRandom Walk\u201d only achieves slightly better results than \u201cJoint+Trained RPN [20]\u201d and performs much worse than the remaining variants, again demonstrating the benefit of sequential mining in RL.\nVariation-structured traversal scheme. VRL achieves a remarkably higher recall compared to RL (e.g., 13.34% vs 6.23% on relationship detection and 26.43% vs 12.47% on attribute detection, in terms of Recall@100). Thus, we conclude that using a variation-structured traversal scheme to dynamically configure the small action set for each state can accelerate and stabilize the learning procedure, by dramatically decreasing the number of possible actions. For example, the number of predicate actions (347) can be dropped to 15 on average.\nHistory phrase embedding. To validate the effectiveness of history phrase embeddings, we evaluate two variants of VRL: (1) \u201cVRL w/o history phrase\u201d does not incorporate history phrase embedding into state features. This variant causes the recall to drop by over 4% compared to the original VRL. Thus, leveraging history phrase embeddings can help inform the current state what has happened\nin the past and stabilize search trajectories that might get stuck in repetitive cycles. (2) \u201cVRL w/ historical actions\u201d directly stores a historical action vector in the state [2]. Each historical action vector is the concatenation of four (|C|+|A|+|P|)-dim action vectors corresponding to the last four actions taken, where each action vector is zero in all elements except the indices corresponding to the three actions taken in C, A, P . This variant still causes the recall to drop, demonstrating that semantic phrase embeddings learned by language models can capture richer history cues (e.g., relationship similarity).\nAmbiguity-aware object mining. \u201cVRL w/o ambiguity\u201d only considers the top-1 predicted category of each object for the action set \u2206c. It obtains lower recall than VRL, suggesting that incorporating semantically ambiguous categories into \u2206c can help identify a more appropriate category for each object under different scene contexts. Fig. 7 illustrates two examples where VRL successfully resolves vague predictions of \u201cVRL w/o ambiguity\u201d into more concrete ones (\u201cman\u201d\u2192\u201cskier\u201d and \u201cstick\u201d\u2192\u201cbat\u201d).\nSpatial actions. Similar to [2], we experiment using spatial actions in the deep RL setting to sequentially extract object instances. The variant \u201cVRL w/ directional actions\u201d replaces the 1751-dim object category action vector with a 9-dim action vector indexed by directions (N, NE, E, SE, S, SW, W, NW) plus one terminal trigger. In each step, the agent selects a neighboring object instance with the highest\nconfidence whose center lies in one of the eight directions w.r.t. that of the subject instance. The diverse spatial layouts of object instances across different images make it difficult to learn a spatial action policy, and causes this variant to perform poorly.\nLong Short-Term Memory \u201cVRL w/ LSTM\u201d is a variant where all fully-connected layers in Fig. 3 are replaced with LSTM [8] layers, which have shown promising results in capturing long-term dependencies. However, \u201cVRL w/ LSTM\u201d has no noticeable performance improvements over VRL, while requiring much more training time. This shows that history phrase embeddings can sufficiently model historical context for sequential prediction."}, {"heading": "4.3. Zero-shot Learning", "text": "We also compare VRL with Lu et al. [16] in the zeroshot learning setting (see Tables 1 and 2). A promising model should be capable of predicting unseen relationships, since the training data will not cover all possible relationship types. Lu et al. [16] uses word embeddings to project similar relationships onto unseen ones, while our VRL uses a large semantic action graph to learn similar relationships on shared graph nodes. Our VRL achieves > 5% performance improvements over Lu et al. [16] on both datasets."}, {"heading": "5. Conclusion and Future Work", "text": "We proposed a novel deep variation-structured reinforcement learning framework for detecting visual relationships and attributes. The VRL sequentially discovers the relationship and attribute instances following a variation-structured traversal scheme on a directed semantic action graph. It incorporates global interdependency to facilitate predictions in local regions. Our experiments on VRD and the Visual Genome dataset demonstrate the power and efficiency of our model over baselines. As future work, a larger directed action graph can be built using natural language sentences. Additionally, VRL can be generalized into an unsupervised learning framework to learn from a massive number of unlabeled images."}], "references": [{"title": "Vqa: Visual question answering", "author": ["S. Antol", "A. Agrawal", "J. Lu", "M. Mitchell", "D. Batra", "C. Lawrence Zitnick", "D. Parikh"], "venue": "In Proceedings of the IEEE International Conference on Computer Vision,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2015}, {"title": "Active object localization with deep reinforcement learning", "author": ["J.C. Caicedo", "S. Lazebnik"], "venue": "In Proceedings of the IEEE International Conference on Computer Vision, pages 2488\u20132496,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2015}, {"title": "The pascal visual object classes (voc) challenge", "author": ["M. Everingham", "L. Van Gool", "C.K. Williams", "J. Winn", "A. Zisserman"], "venue": "International journal of computer vision,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2010}, {"title": "Describing objects by their attributes", "author": ["A. Farhadi", "I. Endres", "D. Hoiem", "D. Forsyth"], "venue": "In IEEE Conference on Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2009}, {"title": "Rich feature hierarchies for accurate object detection and semantic segmentation", "author": ["R. Girshick", "J. Donahue", "T. Darrell", "J. Malik"], "venue": "In Proceedings of the IEEE conference on computer vision and pattern recognition,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2014}, {"title": "Deep reinforcement learning for robotic manipulation", "author": ["S. Gu", "E. Holly", "T. Lillicrap", "S. Levine"], "venue": "arXiv preprint arXiv:1610.00633,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2016}, {"title": "Deep residual learning for image recognition", "author": ["K. He", "X. Zhang", "S. Ren", "J. Sun"], "venue": "In The IEEE Conference on Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2016}, {"title": "Long short-term memory", "author": ["S. Hochreiter", "J. Schmidhuber"], "venue": "Neural computation,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1997}, {"title": "Densecap: Fully convolutional localization networks for dense captioning", "author": ["J. Johnson", "A. Karpathy", "L. Fei-Fei"], "venue": "In IEEE Conference on Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2016}, {"title": "Image retrieval using scene graphs", "author": ["J. Johnson", "R. Krishna", "M. Stark", "L.-J. Li", "D.A. Shamma", "M.S. Bernstein", "L. Fei-Fei"], "venue": "In IEEE Conference on Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2015}, {"title": "Reinforcement learning: A survey", "author": ["L.P. Kaelbling", "M.L. Littman", "A.W. Moore"], "venue": "Journal of artificial intelligence research,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 1996}, {"title": "Skip-thought vectors. In Advances in neural information processing", "author": ["R. Kiros", "Y. Zhu", "R.R. Salakhutdinov", "R. Zemel", "R. Urtasun", "A. Torralba", "S. Fidler"], "venue": null, "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2015}, {"title": "Visual genome: Connecting language and vision using crowdsourced dense image annotations", "author": ["R. Krishna", "Y. Zhu", "O. Groth", "J. Johnson", "K. Hata", "J. Kravitz", "S. Chen", "Y. Kalantidis", "L.-J. Li", "D.A. Shamma"], "venue": "arXiv preprint arXiv:1602.07332,", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2016}, {"title": "On support relations and semantic scene graphs", "author": ["W. Liao", "M.Y. Yang", "H. Ackermann", "B. Rosenhahn"], "venue": "arXiv preprint arXiv:1609.05834,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2016}, {"title": "Fully convolutional networks for semantic segmentation", "author": ["J. Long", "E. Shelhamer", "T. Darrell"], "venue": "In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2015}, {"title": "Visual relationship detection with language priors", "author": ["C. Lu", "R. Krishna", "M. Bernstein", "L. Fei-Fei"], "venue": "In European Conference on Computer Vision,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2016}, {"title": "Playing atari with deep reinforcement learning", "author": ["V. Mnih", "K. Kavukcuoglu", "D. Silver", "A. Graves", "I. Antonoglou", "D. Wierstra", "M. Riedmiller"], "venue": "In Deep Learning, Neural Information Processing Systems Workshop,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2013}, {"title": "Human-level control through deep reinforcement learning", "author": ["V. Mnih", "K. Kavukcuoglu", "D. Silver", "A.A. Rusu", "J. Veness", "M.G. Bellemare", "A. Graves", "M. Riedmiller", "A.K. Fidjeland", "G. Ostrovski"], "venue": null, "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2015}, {"title": "Query adaptive similarity for large scale object retrieval", "author": ["D. Qin", "C. Wengert", "L. Van Gool"], "venue": "In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2013}, {"title": "Faster r-cnn: Towards real-time object detection with region proposal networks. In Advances in neural information processing systems, pages", "author": ["S. Ren", "K. He", "R. Girshick", "J. Sun"], "venue": null, "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2015}, {"title": "Viske: Visual knowledge extraction and question answering by visual verification of relation phrases", "author": ["F. Sadeghi", "S.K. Divvala", "A. Farhadi"], "venue": "In IEEE Conference on Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2015}, {"title": "Recognition using visual phrases", "author": ["M.A. Sadeghi", "A. Farhadi"], "venue": "In IEEE Conference on Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2011}, {"title": "Generating semantically precise scene graphs from textual descriptions for improved image retrieval", "author": ["S. Schuster", "R. Krishna", "A. Chang", "L. Fei-Fei", "C.D. Manning"], "venue": "In Proceedings of the Fourth Workshop on Vision and Language,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2015}, {"title": "Mastering the game of go with deep neural networks and tree search", "author": ["D. Silver", "A. Huang", "C.J. Maddison", "A. Guez", "L. Sifre", "G. Van Den Driessche", "J. Schrittwieser", "I. Antonoglou", "V. Panneershelvam", "M. Lanctot"], "venue": null, "citeRegEx": "24", "shortCiteRegEx": "24", "year": 2016}, {"title": "Very deep convolutional networks for large-scale image recognition", "author": ["K. Simonyan", "A. Zisserman"], "venue": "In ICLR,", "citeRegEx": "25", "shortCiteRegEx": "25", "year": 2015}, {"title": "Lecture 6.5-rmsprop: Divide the gradient by a running average of its recent magnitude", "author": ["T. Tieleman", "G. Hinton"], "venue": "COURSERA: Neural Networks for Machine Learning,", "citeRegEx": "26", "shortCiteRegEx": "26", "year": 2012}, {"title": "Reasoning about object affordances in a knowledge base representation", "author": ["Y. Zhu", "A. Fathi", "L. Fei-Fei"], "venue": "In European Conference on Computer Vision,", "citeRegEx": "27", "shortCiteRegEx": "27", "year": 2014}, {"title": "Target-driven visual navigation in indoor scenes using deep reinforcement learning", "author": ["Y. Zhu", "R. Mottaghi", "E. Kolve", "J.J. Lim", "A. Gupta", "L. Fei- Fei", "A. Farhadi"], "venue": "arXiv preprint arXiv:1609.05143,", "citeRegEx": "28", "shortCiteRegEx": "28", "year": 2016}], "referenceMentions": [{"referenceID": 6, "context": "Although much progress has been made in image classification [7], detection [20] and segmentation [15], we are still far from reaching the goal of holistic scene man", "startOffset": 61, "endOffset": 64}, {"referenceID": 19, "context": "Although much progress has been made in image classification [7], detection [20] and segmentation [15], we are still far from reaching the goal of holistic scene man", "startOffset": 76, "endOffset": 80}, {"referenceID": 14, "context": "Although much progress has been made in image classification [7], detection [20] and segmentation [15], we are still far from reaching the goal of holistic scene man", "startOffset": 98, "endOffset": 102}, {"referenceID": 18, "context": "Being able to extract and exploit such visual information would benefit many realworld applications such as image search [19], question answering [1, 9], and fine-grained recognition [27, 4].", "startOffset": 121, "endOffset": 125}, {"referenceID": 0, "context": "Being able to extract and exploit such visual information would benefit many realworld applications such as image search [19], question answering [1, 9], and fine-grained recognition [27, 4].", "startOffset": 146, "endOffset": 152}, {"referenceID": 8, "context": "Being able to extract and exploit such visual information would benefit many realworld applications such as image search [19], question answering [1, 9], and fine-grained recognition [27, 4].", "startOffset": 146, "endOffset": 152}, {"referenceID": 26, "context": "Being able to extract and exploit such visual information would benefit many realworld applications such as image search [19], question answering [1, 9], and fine-grained recognition [27, 4].", "startOffset": 183, "endOffset": 190}, {"referenceID": 3, "context": "Being able to extract and exploit such visual information would benefit many realworld applications such as image search [19], question answering [1, 9], and fine-grained recognition [27, 4].", "startOffset": 183, "endOffset": 190}, {"referenceID": 19, "context": "Detecting relationships and attributes is more challenging than traditional object detection [20] due to the following reasons: (1) There are a massive number of possible relationship and attribute types (e.", "startOffset": 93, "endOffset": 97}, {"referenceID": 12, "context": ", 13,894 relationship types in Visual Genome [13]), resulting in a greater skew of rare and infrequent types.", "startOffset": 45, "endOffset": 49}, {"referenceID": 21, "context": "Existing approaches [22, 10, 16] only predict a limited set of relationship types (e.", "startOffset": 20, "endOffset": 32}, {"referenceID": 9, "context": "Existing approaches [22, 10, 16] only predict a limited set of relationship types (e.", "startOffset": 20, "endOffset": 32}, {"referenceID": 15, "context": "Existing approaches [22, 10, 16] only predict a limited set of relationship types (e.", "startOffset": 20, "endOffset": 32}, {"referenceID": 21, "context": ", 13 in Visual Phrase [22]) and ignore semantic interdependencies between relationships and attributes by evaluating each region within a scene separately [16].", "startOffset": 22, "endOffset": 26}, {"referenceID": 15, "context": ", 13 in Visual Phrase [22]) and ignore semantic interdependencies between relationships and attributes by evaluating each region within a scene separately [16].", "startOffset": 155, "endOffset": 159}, {"referenceID": 23, "context": "Second, existing deep reinforcement learning (RL) models [24] often require several costly episodes of trial and error to converge, even with a small action space, and our large action space would exacerbate this problem.", "startOffset": 57, "endOffset": 61}, {"referenceID": 27, "context": "It makes a better tradeoff between increasing the input dimension and utilizing more historical context, compared to appending history frames [28] or binary action vectors [2] as in previous RL methods.", "startOffset": 142, "endOffset": 146}, {"referenceID": 1, "context": "It makes a better tradeoff between increasing the input dimension and utilizing more historical context, compared to appending history frames [28] or binary action vectors [2] as in previous RL methods.", "startOffset": 172, "endOffset": 175}, {"referenceID": 15, "context": "Extensive experiments on the Visual Relationship Detection (VRD) dataset [16] and Visual Genome dataset [13] demonstrate that the proposed VRL outperforms state-ofthe-art methods for both relationship and attribute detection, and also has good generalization capabilities for predicting unseen types.", "startOffset": 73, "endOffset": 77}, {"referenceID": 12, "context": "Extensive experiments on the Visual Relationship Detection (VRD) dataset [16] and Visual Genome dataset [13] demonstrate that the proposed VRL outperforms state-ofthe-art methods for both relationship and attribute detection, and also has good generalization capabilities for predicting unseen types.", "startOffset": 104, "endOffset": 108}, {"referenceID": 21, "context": "relationship detection [22, 21, 13].", "startOffset": 23, "endOffset": 35}, {"referenceID": 20, "context": "relationship detection [22, 21, 13].", "startOffset": 23, "endOffset": 35}, {"referenceID": 12, "context": "relationship detection [22, 21, 13].", "startOffset": 23, "endOffset": 35}, {"referenceID": 21, "context": "However, most existing approaches [22] [13] can detect only a handful of pre-defined, frequent types by training individual detectors for each relationship.", "startOffset": 34, "endOffset": 38}, {"referenceID": 12, "context": "However, most existing approaches [22] [13] can detect only a handful of pre-defined, frequent types by training individual detectors for each relationship.", "startOffset": 39, "endOffset": 43}, {"referenceID": 15, "context": "[16] leveraged word embeddings to handle large-scale relationships.", "startOffset": 0, "endOffset": 4}, {"referenceID": 9, "context": "Furthermore, some methods [10, 23, 14] organized predictions into a scene graph which can provide a structured representation for describing the objects, their attributes and relationships in each image.", "startOffset": 26, "endOffset": 38}, {"referenceID": 22, "context": "Furthermore, some methods [10, 23, 14] organized predictions into a scene graph which can provide a structured representation for describing the objects, their attributes and relationships in each image.", "startOffset": 26, "endOffset": 38}, {"referenceID": 13, "context": "Furthermore, some methods [10, 23, 14] organized predictions into a scene graph which can provide a structured representation for describing the objects, their attributes and relationships in each image.", "startOffset": 26, "endOffset": 38}, {"referenceID": 9, "context": "[10] introduced a conditional random field model for reasoning about possible groundings of scene graphs while Schuster et al.", "startOffset": 0, "endOffset": 4}, {"referenceID": 22, "context": "[23] proposed a rule-based and classifier-based scene graph parser.", "startOffset": 0, "endOffset": 4}, {"referenceID": 10, "context": "Integrating deep learning methods with reinforcement learning (RL) [11] has recently shown very promising results on decision-making problems.", "startOffset": 67, "endOffset": 71}, {"referenceID": 17, "context": "[18] proposed using deep Q-networks to play ATARI games.", "startOffset": 0, "endOffset": 4}, {"referenceID": 23, "context": "[24] proposed a new search algorithm based on the integration of Monte-Carlo tree search with deep RL, which beat the world champion in the game of Go.", "startOffset": 0, "endOffset": 4}, {"referenceID": 5, "context": ", robotic manipulation [6], indoor navigation [28], and object proposal generation [2].", "startOffset": 23, "endOffset": 26}, {"referenceID": 27, "context": ", robotic manipulation [6], indoor navigation [28], and object proposal generation [2].", "startOffset": 46, "endOffset": 50}, {"referenceID": 1, "context": ", robotic manipulation [6], indoor navigation [28], and object proposal generation [2].", "startOffset": 83, "endOffset": 86}, {"referenceID": 12, "context": "The recently released Visual Genome dataset [13] provides a large-scale annotation of images containing 18,136 unique object categories, 13,041 unique attributes, and 13,894 unique relationships.", "startOffset": 44, "endOffset": 48}, {"referenceID": 17, "context": "Instead of learning in the entire action space as in traditional deep RL [18, 28], we propose a novel variationstructured traversal scheme over the semantic action graph that dynamically constructs small action sets for each step.", "startOffset": 73, "endOffset": 81}, {"referenceID": 27, "context": "Instead of learning in the entire action space as in traditional deep RL [18, 28], we propose a novel variationstructured traversal scheme over the semantic action graph that dynamically constructs small action sets for each step.", "startOffset": 73, "endOffset": 81}, {"referenceID": 19, "context": "For our experiments, we used state-of-the-art Faster R-CNN [20] as the object detector, where the network parameters were initialized using the pre-trained VGG-16 ImageNet model [25].", "startOffset": 59, "endOffset": 63}, {"referenceID": 24, "context": "For our experiments, we used state-of-the-art Faster R-CNN [20] as the object detector, where the network parameters were initialized using the pre-trained VGG-16 ImageNet model [25].", "startOffset": 178, "endOffset": 182}, {"referenceID": 24, "context": "The state vector f is a concatenation of (1) a 4096-dim feature of the whole image, taken from the fc6 layer of the pre-trained VGG-16 ImageNet model [25]; (2) two 4096-dim features of the subject s and object s\u2032 instances, taken from the conv5 3 layer of the trained Faster R-CNN object detector; and (3) a 9600-dim history phrase embedding, which is created by concatenating four 2400-dim semantic embeddings from a Skip-thought language model [12] of the last two relationship phrases (relating s and s\u2032) and the last two attribute phrases (describing s) that were predicted by VRL.", "startOffset": 150, "endOffset": 154}, {"referenceID": 11, "context": "The state vector f is a concatenation of (1) a 4096-dim feature of the whole image, taken from the fc6 layer of the pre-trained VGG-16 ImageNet model [25]; (2) two 4096-dim features of the subject s and object s\u2032 instances, taken from the conv5 3 layer of the trained Faster R-CNN object detector; and (3) a 9600-dim history phrase embedding, which is created by concatenating four 2400-dim semantic embeddings from a Skip-thought language model [12] of the last two relationship phrases (relating s and s\u2032) and the last two attribute phrases (describing s) that were predicted by VRL.", "startOffset": 446, "endOffset": 450}, {"referenceID": 11, "context": ", \u201cperson riding bicycle\u201d) is embedded into a 2400-dim vector using a pre-trained Skip-thought language model [12], thus resulting in a 9600-dim history phrase embedding.", "startOffset": 110, "endOffset": 114}, {"referenceID": 16, "context": "Due to the high-dimensional continuous image data and a model-free environment, we resort to the deep Q-Network (DQN) framework proposed by [17, 18], which generalizes well to unseen inputs.", "startOffset": 140, "endOffset": 148}, {"referenceID": 17, "context": "Due to the high-dimensional continuous image data and a model-free environment, we resort to the deep Q-Network (DQN) framework proposed by [17, 18], which generalizes well to unseen inputs.", "startOffset": 140, "endOffset": 148}, {"referenceID": 16, "context": "The replay memory helps stabilize the training by smoothing the training distribution over past experiences and reducing correlation between training samples [17, 18].", "startOffset": 158, "endOffset": 166}, {"referenceID": 17, "context": "The replay memory helps stabilize the training by smoothing the training distribution over past experiences and reducing correlation between training samples [17, 18].", "startOffset": 158, "endOffset": 166}, {"referenceID": 15, "context": "We conduct our experiments on the Visual Relationship Detection (VRD) dataset [16] and the Visual Genome dataset [13].", "startOffset": 78, "endOffset": 82}, {"referenceID": 12, "context": "We conduct our experiments on the Visual Relationship Detection (VRD) dataset [16] and the Visual Genome dataset [13].", "startOffset": 113, "endOffset": 117}, {"referenceID": 15, "context": "VRD [16] contains 5000 images (4000 for training, 1000 for testing) with 100 object categories and 70 predicates.", "startOffset": 4, "endOffset": 8}, {"referenceID": 12, "context": "For the Visual Genome Dataset [13], we experiment on 87,398 images (out of which 5000 are held out for validation, and 5000 for testing), containing 703,839 relationship instances with 13,823 relationship types and 1,464,446 attribute instances with", "startOffset": 30, "endOffset": 34}, {"referenceID": 21, "context": "Visual Phrases [22] 0.", "startOffset": 15, "endOffset": 19}, {"referenceID": 24, "context": "Joint CNN+R-CNN [25] 0.", "startOffset": 16, "endOffset": 20}, {"referenceID": 24, "context": "Joint CNN+RPN [25] 2.", "startOffset": 14, "endOffset": 18}, {"referenceID": 15, "context": "V only [16] 2.", "startOffset": 7, "endOffset": 11}, {"referenceID": 19, "context": "Faster R-CNN [20] 3.", "startOffset": 13, "endOffset": 17}, {"referenceID": 19, "context": "Joint CNN+Trained RPN [20] 3.", "startOffset": 22, "endOffset": 26}, {"referenceID": 19, "context": "Faster R-CNN V only [20] 6.", "startOffset": 20, "endOffset": 24}, {"referenceID": 15, "context": "[16] 17.", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16] (zero-shot) 3.", "startOffset": 0, "endOffset": 4}, {"referenceID": 25, "context": "We train a deep Q-network for 60 epochs with a shared RMSProp optimizer [26].", "startOffset": 72, "endOffset": 76}, {"referenceID": 15, "context": "On VRD [16], VRL takes about 8 hours to train an object detector with 100 object categories, and two days to converge.", "startOffset": 7, "endOffset": 11}, {"referenceID": 12, "context": "On the Visual Genome dataset [13], VRL takes between 4 to 5 days to train an object detector with 1750 object categories, and one week to converge.", "startOffset": 29, "endOffset": 33}, {"referenceID": 15, "context": "Following [16], we use recall@100 and recall@50 as our evaluation metrics.", "startOffset": 10, "endOffset": 14}, {"referenceID": 15, "context": "As discussed in [16], we do not use the mean average precision (mAP), which is a pessimistic evaluation metric because the dataset cannot exhaustively annotate all Table 2.", "startOffset": 16, "endOffset": 20}, {"referenceID": 24, "context": "Joint CNN+R-CNN [25] 0.", "startOffset": 16, "endOffset": 20}, {"referenceID": 24, "context": "Joint CNN+RPN [25] 1.", "startOffset": 14, "endOffset": 18}, {"referenceID": 15, "context": "V only [16] 1.", "startOffset": 7, "endOffset": 11}, {"referenceID": 19, "context": "Faster R-CNN [20] 2.", "startOffset": 13, "endOffset": 17}, {"referenceID": 19, "context": "Joint CNN+Trained RPN [20] 2.", "startOffset": 22, "endOffset": 26}, {"referenceID": 19, "context": "Faster R-CNN V only [20] 5.", "startOffset": 20, "endOffset": 24}, {"referenceID": 15, "context": "[16] 10.", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16] (zero-shot) 1.", "startOffset": 0, "endOffset": 4}, {"referenceID": 24, "context": "Joint CNN+R-CNN [25] 2.", "startOffset": 16, "endOffset": 20}, {"referenceID": 24, "context": "Joint CNN+RPN [25] 3.", "startOffset": 14, "endOffset": 18}, {"referenceID": 19, "context": "Faster R-CNN [20] 7.", "startOffset": 13, "endOffset": 17}, {"referenceID": 19, "context": "Joint CNN+Trained RPN [20] 9.", "startOffset": 22, "endOffset": 26}, {"referenceID": 15, "context": "Following [16], we evaluate on three tasks: (1) In relationship phrase detection [22], the goal is to predict a \u201csubject-predicate-object\u201d phrase, where the localization of the entire relationship has at least 0.", "startOffset": 10, "endOffset": 14}, {"referenceID": 21, "context": "Following [16], we evaluate on three tasks: (1) In relationship phrase detection [22], the goal is to predict a \u201csubject-predicate-object\u201d phrase, where the localization of the entire relationship has at least 0.", "startOffset": 81, "endOffset": 85}, {"referenceID": 21, "context": "First, we compare our model with state-of-the-art approaches, Visual Phrases [22], Joint CNN+R-CNN [25] and Lu et al.", "startOffset": 77, "endOffset": 81}, {"referenceID": 24, "context": "First, we compare our model with state-of-the-art approaches, Visual Phrases [22], Joint CNN+R-CNN [25] and Lu et al.", "startOffset": 99, "endOffset": 103}, {"referenceID": 15, "context": "[16].", "startOffset": 0, "endOffset": 4}, {"referenceID": 4, "context": "Note that the latter two methods use R-CNN [5] to extract object proposals.", "startOffset": 43, "endOffset": 46}, {"referenceID": 15, "context": "Their results on VRD are reported in [16], and we also experiment their methods on the Visual Genome dataset.", "startOffset": 37, "endOffset": 41}, {"referenceID": 15, "context": "V only [16] trains individual detectors for object and predicate categories separately, and then combines their confidences to generate a relationship prediction.", "startOffset": 7, "endOffset": 11}, {"referenceID": 19, "context": "Furthermore, we train and compare with the following models: \u201cFaster R-CNN [20]\u201d directly detects each unique relationship or attribute type, following Visual Phrases [22].", "startOffset": 75, "endOffset": 79}, {"referenceID": 21, "context": "Furthermore, we train and compare with the following models: \u201cFaster R-CNN [20]\u201d directly detects each unique relationship or attribute type, following Visual Phrases [22].", "startOffset": 167, "endOffset": 171}, {"referenceID": 19, "context": "\u201cFaster R-CNN V only [20]\u201d model is similar to Lu et al.", "startOffset": 21, "endOffset": 25}, {"referenceID": 15, "context": "V only [16], with the only difference being that Faster RCNN is used for object detection.", "startOffset": 7, "endOffset": 11}, {"referenceID": 24, "context": "\u201cJoint CNN+RPN [25]\u201d extracts proposals using the pre-trained RPN [20] model on VOC 2012 [3] and then performs the classification.", "startOffset": 15, "endOffset": 19}, {"referenceID": 19, "context": "\u201cJoint CNN+RPN [25]\u201d extracts proposals using the pre-trained RPN [20] model on VOC 2012 [3] and then performs the classification.", "startOffset": 66, "endOffset": 70}, {"referenceID": 2, "context": "\u201cJoint CNN+RPN [25]\u201d extracts proposals using the pre-trained RPN [20] model on VOC 2012 [3] and then performs the classification.", "startOffset": 89, "endOffset": 92}, {"referenceID": 19, "context": "\u201cJoint CNN+Trained RPN [20]\u201d trains a separate RPN model on our dataset to generate proposals.", "startOffset": 23, "endOffset": 27}, {"referenceID": 15, "context": "Qualitative comparison between VRD [16] and our VRL.", "startOffset": 35, "endOffset": 39}, {"referenceID": 21, "context": ", Visual Phrases [22], Joint CNN+RCNN [25], Joint CNN+RPN [25], Faster R-CNN [20], Joint CNN+Trained RPN [20].", "startOffset": 17, "endOffset": 21}, {"referenceID": 24, "context": ", Visual Phrases [22], Joint CNN+RCNN [25], Joint CNN+RPN [25], Faster R-CNN [20], Joint CNN+Trained RPN [20].", "startOffset": 38, "endOffset": 42}, {"referenceID": 24, "context": ", Visual Phrases [22], Joint CNN+RCNN [25], Joint CNN+RPN [25], Faster R-CNN [20], Joint CNN+Trained RPN [20].", "startOffset": 58, "endOffset": 62}, {"referenceID": 19, "context": ", Visual Phrases [22], Joint CNN+RCNN [25], Joint CNN+RPN [25], Faster R-CNN [20], Joint CNN+Trained RPN [20].", "startOffset": 77, "endOffset": 81}, {"referenceID": 19, "context": ", Visual Phrases [22], Joint CNN+RCNN [25], Joint CNN+RPN [25], Faster R-CNN [20], Joint CNN+Trained RPN [20].", "startOffset": 105, "endOffset": 109}, {"referenceID": 15, "context": "V only [16], Faster R-CNN V only [20], Lu et al.", "startOffset": 7, "endOffset": 11}, {"referenceID": 19, "context": "V only [16], Faster R-CNN V only [20], Lu et al.", "startOffset": 33, "endOffset": 37}, {"referenceID": 15, "context": "[16] and our VRL.", "startOffset": 0, "endOffset": 4}, {"referenceID": 19, "context": "In all cases, we obtain performance improvements using RPN network [20] over R-CNN [5] for proposal generation.", "startOffset": 67, "endOffset": 71}, {"referenceID": 4, "context": "In all cases, we obtain performance improvements using RPN network [20] over R-CNN [5] for proposal generation.", "startOffset": 83, "endOffset": 86}, {"referenceID": 15, "context": "[16] leverage language priors to facilitate prediction.", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16] uses semantic word embeddings to finetune the likelihood of a predicted relationship, while VRL follows a variationalstructured traversal scheme over a directed semantic action graph built from language priors.", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16] achieve significantly better performance than other baselines, which demonstrates the necessity of language priors for relationship and attribute detection.", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16].", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16].", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16] in Fig.", "startOffset": 0, "endOffset": 4}, {"referenceID": 19, "context": "\u201cRandom Walk\u201d only achieves slightly better results than \u201cJoint+Trained RPN [20]\u201d and performs much worse than the remaining variants, again demonstrating the benefit of sequential mining in RL.", "startOffset": 76, "endOffset": 80}, {"referenceID": 19, "context": "Joint CNN+Trained RPN [20] 2.", "startOffset": 22, "endOffset": 26}, {"referenceID": 1, "context": "(2) \u201cVRL w/ historical actions\u201d directly stores a historical action vector in the state [2].", "startOffset": 88, "endOffset": 91}, {"referenceID": 1, "context": "Similar to [2], we experiment using spatial actions in the deep RL setting to sequentially extract object instances.", "startOffset": 11, "endOffset": 14}, {"referenceID": 7, "context": "3 are replaced with LSTM [8] layers, which have shown promising results in capturing long-term dependencies.", "startOffset": 25, "endOffset": 28}, {"referenceID": 15, "context": "[16] in the zeroshot learning setting (see Tables 1 and 2).", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16] uses word embeddings to project similar relationships onto unseen ones, while our VRL uses a large semantic action graph to learn similar relationships on shared graph nodes.", "startOffset": 0, "endOffset": 4}, {"referenceID": 15, "context": "[16] on both datasets.", "startOffset": 0, "endOffset": 4}], "year": 2017, "abstractText": "Despite progress in visual perception tasks such as image classification and detection, computers still struggle to understand the interdependency of objects in the scene as a whole, e.g., relations between objects or their attributes. Existing methods often ignore global context cues capturing the interactions among different object instances, and can only recognize a handful of types by exhaustively training individual detectors for all possible relationships. To capture such global interdependency, we propose a deep Variation-structured Reinforcement Learning (VRL) framework to sequentially discover object relationships and attributes in the whole image. First, a directed semantic action graph is built using language priors to provide a rich and compact representation of semantic correlations between object categories, predicates, and attributes. Next, we use a variation-structured traversal over the action graph to construct a small, adaptive action set for each step based on the current state and historical actions. In particular, an ambiguity-aware object mining scheme is used to resolve semantic ambiguity among object categories that the object detector fails to distinguish. We then make sequential predictions using a deep RL framework, incorporating global context cues and semantic embeddings of previously extracted phrases in the state vector. Our experiments on the Visual Relationship Detection (VRD) dataset and the large-scale Visual Genome dataset validate the superiority of VRL, which can achieve significantly better detection results on datasets involving thousands of relationship and attribute types. We also demonstrate that VRL is able to predict unseen types embedded in our action graph by learning correlations on shared graph nodes.", "creator": "LaTeX with hyperref package"}}}