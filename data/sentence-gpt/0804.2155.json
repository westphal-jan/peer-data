{"id": "0804.2155", "review": {"conference": "AAAI", "VERSION": "v1", "DATE_OF_SUBMISSION": "14-Apr-2008", "title": "From Qualitative to Quantitative Proofs of Security Properties Using First-Order Conditional Logic", "abstract": "A first-order conditional logic is considered, with semantics given by a variant of epsilon-semantics, where p -&gt; q means that Pr(q | p) approaches 1 super-polynomially --faster than any inverse polynomial. This type of convergence is needed for reasoning about security protocols. A complete axiomatization is provided for this semantics, and it is shown how a qualitative proof of the correctness of a security protocol can be automatically converted to a quantitative proof appropriate for reasoning about concrete security protocols.\n\n\nA final example of an argument for an argument for an argument for a proof of the correctness of a security protocol can be shown in the following program. This example shows a proof of the correctness of a security protocol can be implemented by the following programs:\n1. The proof of the correctness of a security protocol can be used in the following programs:\n2. The proof of the correctness of a security protocol can be implemented by the following programs:\n3. A proof of the correctness of a security protocol can be implemented by the following programs:\nThe proof of the correctness of a security protocol can be implemented by the following programs:\n1. The proof of the correctness of a security protocol can be implemented by the following programs:\n3. The proof of the correctness of a security protocol can be implemented by the following programs:\n1. The proof of the correctness of a security protocol can be implemented by the following programs:\n3. The proof of the correctness of a security protocol can be implemented by the following programs:\n1. The proof of the correctness of a security protocol can be implemented by the following programs:\nThe proof of the correctness of a security protocol can be implemented by the following programs:\n2. The proof of the correctness of a security protocol can be implemented by the following programs:\n2. The proof of the correctness of a security protocol can be implemented by the following programs:\n1. The proof of the correctness of a security protocol can be implemented by the following programs:\n1. The proof of the correctness of a security protocol can be implemented by the following programs:\n2. The proof of the correctness of a security protocol can be implemented by the following programs:\n3. The proof of the correctness of a security protocol can be implemented by the following programs:\n1. The proof of the correctness of a security protocol can be implemented by the following programs:\n1. The proof of the correctness of a security protocol can", "histories": [["v1", "Mon, 14 Apr 2008 12:06:04 GMT  (34kb)", "http://arxiv.org/abs/0804.2155v1", null]], "reviews": [], "SUBJECTS": "cs.CR cs.AI cs.LO", "authors": ["joseph y halpern"], "accepted": true, "id": "0804.2155"}, "pdf": {"name": "0804.2155.pdf", "metadata": {"source": "CRF", "title": "From Qualitative to Quantitative Proofs of Security Properties Using First-Order Conditional Logic", "authors": ["Joseph Y. Halper"], "emails": ["halpern@cs.cornell.edu"], "sections": [{"heading": null, "text": "ar X\niv :0\n80 4.\n21 55\nv1 [\ncs .C\nR ]\n1 4\nA pr\n2 00"}, {"heading": "1 Introduction", "text": "Security protocols, such as key-exchange and keymanagement protocols, are short, but notoriously difficult to prove correct. Flaws have been found in numerous protocols, ranging from the the 802.11 Wired Equivalent Privacy (WEP) protocol used to protect link-layer communications from eavesdropping and other attacks (Borisov, Goldberg, & Wagner 2001) to standards and proposed standards for Secure Socket Layer (Wagner & Schneier 1996; Mitchell, Shmatikov, & Stern 1998) to Kerberos (Bella & Paulson 1998). Not surprisingly, a great deal of effort has been devoted to proving the correctness of such protocols. There are two largely disjoint approaches. The first essentially ignores the details of cryptography by assuming perfect cryptography (i.e., nothing encrypted can ever be decrypted without the encryption key) and an adversary that controls the network. By ignoring the cryptography, it is possible to give a more qualitative proof of correctness, using logics designed for reasoning about security protocols. Indeed, this approach has enabled axiomatic proofs of correctness and model checking of proofs (see, for example, (Mitchell, Mitchell, & Stern 1997; Paulson 1994)). The second approach applies the tools of modern cryptography to proving correctness, using more quantitative arguments. Typically it is shown that, given some security parameter k (where k may be, for example, the length of the key used) an adversary\n\u2217Supported in part by NSF under under grants ITR-0325453 and IIS-0534064, and by AFOSR under grant FA9550-05-1-0055. Copyright c\u00a9 2008, American Association for Artificial Intelligence (www.aaai.org). All rights reserved.\nwhose running time is polynomial in k has a negligible probability of breaking the security, where \u201cnegligible\u201d means \u201cless than any inverse polynomial function of k\u201d (see, for example, (Bellare, Canetti, & Krawczyk 1998; Goldreich 2001)).\nThere has been recent work on bridging the gap between these two approaches, with the goal of constructing a logic that can allow reasoning about quantitative aspects of security protocols while still being amenable to mechanization. This line of research started with the work of Abadi and Rogaway 2000. More recently, Datta et al. 2005 showed that by giving a somewhat nonstandard semantics to their first-order Protocol Composition Logic (Datta et al. 2007), it was possible to reason about many features of the computational model. In this logic, an \u201cimplication\u201d of the form \u03d5 \u2283 B is interpreted as, roughly speaking, the probability of B given \u03d5 is high. For example, a statement like secret encrypted \u2283 adversary does not decrypt the secret says \u201cwith high probability, if the secret is encrypted, the adversary does not decrypt it\u201d. While the need for such statements should be clear, the probabilistic interpretation used is somewhat unnatural, and no axiomatization is provided by Datta et al. 2005 for the \u2283 operator (although some sound axioms are given that use it).\nThe interpretation of \u2283 is quite reminiscent of one of the interpretations of \u2192 in conditional logic, where \u03d5 \u2192 \u03c8 can be interpreted as \u201ctypically, if \u03d5 then \u03c8\u201d (Kraus, Lehmann, & Magidor 1990). Indeed, one semantics given to \u2192, called \u01eb-semantics (Adams 1975; Goldszmidt & Pearl 1992), is very close in spirit to that used in (Datta et al. 2005); this is particularly true for the formulation of \u01eb-semantics given by Goldszmidt, Morris, and Pearl 1993. In this formulation, a formula \u03d5 \u2192 \u03c8 is evaluated with respect to a sequence (Pr1,Pr2, . . .) of probability measures (probability sequence, for short): it is true if, roughly speaking, limn\u2192\u221e Prn(\u03c8 | \u03d5) = 1 (where Prk(\u03c8 | \u03d5) is taken to be 1 if Prk(\u03d5) = 1). This formulation is not quite strong enough for some security-related purposes, where the standard is super-polynomial convergence, that is, convergence faster than any inverse polynomial. To capture such convergence, we can take \u03d5 \u2192 \u03c8 to be true with respect to this probability sequence if, for all polynomials p, there exists n\u2217 such that, for all n \u2265 n\u2217, Prn(\u03c8 | \u03d5) \u2265 1 \u2212 1/p(n). (Note that this implies that limn\u2192\u221e Prn(\u03c8 |\n\u03d5) = 1.) In a companion paper, it is shown that reinterpreting \u2192 in this way gives an elegant, powerful variant of the logic considered in (Datta et al. 2005), which can be used to reason about security protocols of interest.\nWhile it is already a pleasant surprise that conditional logic provides such a clean approach to reasoning about security, using conditional logic has two further significant advantages, which are the subject of this paper. The first is that, as I show here, the well-known complete axiomatization of conditional logic with respect to \u01eb-semantics continues to be sound and complete with respect to the super-polynomial semantics for \u2192; thus, the axioms form a basis for automated proofs. The second is that the use of conditional logic allows for a clean transition from qualitative to quantitative arguments. To explain these points, I need to briefly recall some well-known results from the literature.\nAs is well known, the KLM properties (Kraus, Lehmann, & Magidor 1990) (see Section 2) provide a sound and complete axiomatization for reasoning about \u2192 formulas with respect to \u01eb-semantics (Geffner 1992). More precisely, if \u2206 is a collection of formulas of the form \u03d5\u2032 \u2192 \u03c8\u2032, then \u2206 (\u01eb-)entails \u03d5 \u2192 \u03c8 (that is, for every probability sequence P , if every formula in \u2206 is true in P according to \u01eb semantics, then so is \u03d5 \u2192 \u03c8), then \u03d5 \u2192 \u03c8 is provable from \u2206 using the KLM properties. This result applies only when \u2206 is a collection of \u2192 formulas. \u2206 cannot include negations or disjunctions of \u2192 formulas. Conditional logic extends the KLM framework by allowing Boolean combinations of \u2192 statements. A sound and complete axiomatization of propositional conditional logic with semantics given by what are called preferential structures was given by Burgess 1981; Friedman and Halpern 2001 proved it was also sound and complete for \u01eb-semantics.\nPropositional conditional logic does not suffice for reasoning about security. The logic of (Datta et al. 2005) is first-order; quantification is needed to capture important properties of security protocols. A sound and complete axiomatization for the language of first-order conditional logic, denoted \u0141C , with respect to \u01eb-semantics is given by Friedman, Halpern, and Koller 2000. The first major result of this paper shows a conditional logic formula \u03d5 is satisfiable in some model M with respect to \u01eb-semantics iff it is satisfiable in some model M \u2032 with respect to the super-polynomial semantics. It follows that all the completeness results for \u01eb-semantics apply without change to the super-polynomial semantics.\nI then consider the language \u01410C which essentially consists of universal \u2192 formulas, that is, formulas of the form \u2200x1 . . .\u2200xn(\u03d5\u2192\u03c8), where\u03d5 and \u03c8 are first-order formulas. As in the KLM framework, there are no nested \u2192 formulas or negated \u2192 formulas. The second major result of this paper is to provide a sound and complete axiomatization that extends the KLM properties for reasoning abut when a collection of formulas in \u01410C entails a formula in \u0141 0 C .\nIt might seem strange to be interested in an axiomatization for \u01410C when there is already a sound and complete axiomatization for the full language \u0141C . However, \u0141 0 C has some significant advantages. In reasoning about concrete security, asymptotic complexity results do not suffice; more de-\ntailed information about security guarantees is needed. For example, we may want to prove that an SSL server that supports 1,000,000 sessions using 1024 bit keys has a probability of 0.999999 of providing the desired service without being compromised. I show how to convert a qualitative proof of security in the language \u01410C , which provides only asymptotic guarantees, to a quantitative proof. Moreover, the conversion shows exactly how strong the assumptions have to be in order to get the desired 0.999999 level of security. Such a conversion is not posisble with \u0141C .\nThis conversion justifies reasoning at the qualitative level. A qualitative proof can be constructed without worrying about the details of the numbers, and then automatically converted to a quantitative proof for the desired level of security.\nIn the next section, I review the syntax and semantics of conditional logic, with an emphasis on \u01eb semantics, and show how it can be modified to deal with the superpolynomial convergence that is more appropriate for reasoning about security. In Section 3, I provide axioms and inference rules for both qualitative and quantitative reasoning."}, {"heading": "2 First-Order Conditional Logic", "text": "I review the syntax and semantics of first-order conditional logic here. Although I focus on first-order conditional logic here, it is straightforward to specialize all the definitions and results to the propositional case, so I do not discuss the propositional case further.\nThe syntax of first-order conditional logic is straightforward. Fix a finite first-order vocabulary T consisting, as usual, of function symbols, predicate symbols, and constants. Starting with atomic formulas of first-order logic over the vocabulary T , more complicated formulas are formed by closing off under the standard truth-functional connectives (i.e., \u2227 ,\u2228, \u00ac, and \u21d2), first-order quantification, and the binary modal operator \u2192. Thus, a typical formula is \u2200x(P (x)\u2192\u2203y(Q(x, y)\u2192R(y))). Let \u0141C(T ) be the resulting language. Let \u0141fo(T ) be the pure first-order fragment of \u0141C(T ), consisting of \u2192-free formluas. Let \u0141 0 C(T ) consist of all formulas in \u0141C(T ) of the form \u2200x1 . . . \u2200xn(\u03d5\u2192\u03c8), where \u03d5 and \u03c8 are in \u0141fo . (I henceforth omit the T unless it is necessary for clarity.) Note that \u01410C does not include negations of \u2192 formulas or conjunctions of \u2192 formulas. While not having conjunctions does not really impair the expressive power of \u01410C (since we will be interested in sets of \u0141 0 C formulas, where a set can be identified with the conjunction of the formulas in the set), the lack of negation does.\nI give two semantics to formulas in \u0141C(T ). In both semantics, the truth of formulas is defined with respect to PS structures. A PS structure is a tuple M = (D,W, \u03c0,P), where D is a domain, W is a set of worlds, \u03c0 is an interpretation, which associates with each predicate symbol (resp., function symbol, constant symbol) in T and world w \u2208 W a predicate (resp., function, domain element) of the right arity, and P = \u3008Pr1,Pr2, . . .\u3009 is a probability sequence. As usual, a valuation V associates with each variable x an element V (x) \u2208 D.\nGiven a valuation V and structure M , the semantics of \u2227, \u00ac, \u21d2, and \u2200 is completely standard. In particular, the\ntruth of a first-order formula in \u0141fo in a world w, written (M,V,w) |= \u03d5, is determined as usual. For \u03d5 \u2208 \u0141fo , let [[\u03d5]]M,V = {w : (M,V,w) |= \u03d5}. If \u03d5 is a closed formula, so that its truth does not depend on the valuation, I occasionally write [[\u03d5]]M rather than [[\u03d5]]M,V . I write (M,V ) |= \u03d5 if (M,V,w) |= \u03d5 for all worlds w. The truth of an \u2192 formula does not depend on the world, but only on the structure M .\n(M,V ) |= \u03d5\u2192\u03c8 if lim n\u2192\u221e Prn([[\u03c8]]M,V | [[\u03d5]]M,V ) = 1,\nwhere Prn([[\u03c8]]M,V | [[\u03d5]]M,V ) is taken to be 1 if Prn([[\u03d5]]M,V ) = 0.\nI also consider an alternative semantics that gives superpolynomial convergence. A polynomial is positive if all its coefficients are nonnegative and at least one is nonzero.\n(M,V ) |= sp \u03d5\u2192\u03c8 if for all positive polynomials p, there exists some n\u2217 \u2265 0 such that, for all n \u2265 n\u2217, Prn([[\u03c8]]M,V | [[\u03d5]]M,V ) \u2265 1\u2212 (1/p(n)).\nAs usual, I write M |= \u03d5 if (M,V ) |= \u03d5 for all valuations V , and M |= \u03d5 if M |= \u03d5 for all PS structures in a set M, and similarly with |= replaced by |= sp ."}, {"heading": "3 Axioms for qualitative and quantitative reasoning", "text": "In this section, I start by showing that qualitative reasoning for both |= and |= sp is characterized by the same axiom system. I then provide a complete axiomatization for \u01410C . Finally, I consider quantitative conditional logic. In the axioms, it is convenient to use N\u03d5 as an abbreviation for \u00ac\u03d5\u2192false. Note that if \u03d5 is a closed formula, then M |= N\u03d5 iff, for some n\u2217, Prn([[\u03d5]]M ) = 0 for all n \u2265 n\u2217, and similarly with |= replaced by |= sp . Thus, N\u03d5 can be read as saying \u201c\u03d5 is almost surely true\u201d."}, {"heading": "3.1 Qualitative Reasoning", "text": "As was mentioned in the introduction, Friedman, Halpern, and Koller 2000 provide a complete axiomatization AXC for \u0141C with respect to |=. For the security applications, a generalization of their result is needed, where it is possible to restrict to models where all worlds satisfy a particular firstorder theory \u039b. Let \u22a2\u039b denote provability in first-order logic given the axioms in the theory \u039b. Let AX\u039bC consist of the following axioms and rules:\n\u039b-AX. \u03d5, if \u03d5 \u2208 \u0141fo and \u22a2\u039b \u03d5.\nC0. All substitution instances of propositional tautologies."}, {"heading": "C1. \u03d5\u2192\u03d5.", "text": ""}, {"heading": "C2. ((\u03d5\u2192\u03c81) \u2227 (\u03d5\u2192\u03c82)) \u21d2 (\u03d5\u2192(\u03c81 \u2227 \u03c82)).", "text": ""}, {"heading": "C3. ((\u03d51\u2192\u03c8) \u2227 (\u03d52\u2192\u03c8)) \u21d2 ((\u03d51 \u2228 \u03d52)\u2192\u03c8).", "text": ""}, {"heading": "C4. ((\u03d51\u2192\u03d52) \u2227 (\u03d51\u2192\u03c8)) \u21d2 ((\u03d51 \u2227 \u03d52)\u2192\u03c8).", "text": ""}, {"heading": "C5. [(\u03d5\u2192\u03c8) \u21d2 N(\u03d5\u2192\u03c8)] \u2227 [\u00ac(\u03d5\u2192\u03c8) \u21d2 N\u00ac(\u03d5\u2192\u03c8)].", "text": ""}, {"heading": "C6. \u00ac(true\u2192false).", "text": "F1. \u2200x\u03d5 \u21d2 \u03d5[x/t], where t is substitutable for x in the sense discussed below and \u03d5[x/t] is the result of substituting t for all free occurrences of x in \u03d5 (see (Enderton 1972) for a formal definition)."}, {"heading": "F2. \u2200x(\u03d5 \u21d2 \u03c8) \u21d2 (\u2200x\u03d5 \u21d2 \u2200x\u03c8).", "text": "F3. \u03d5 \u21d2 \u2200x\u03d5 if x does not occur free in \u03d5.\nF4. x = y \u21d2 (\u03d51 \u21d2 \u03d52), where \u03d51 is quantifier-free and \u03d52 is obtained from \u03d51 by replacing zero or more occurrences of x in \u03d51 by y.\nF5. x 6= y \u21d2 N(x 6= y).\nMP. From \u03d5 and \u03d5 \u21d2 \u03c8 infer \u03c8.\nGen. From \u03d5 infer \u2200x\u03d5.\nR1. From \u03d51 \u21d4 \u03d52 infer \u03d51\u2192\u03c8 \u21d4 \u03d52\u2192\u03c8.\nR2. From \u03c81 \u21d2 \u03c82 infer \u03d5\u2192\u03c81 \u21d2 \u03d5\u2192\u03c82.\nThe axiom system AXC of (Friedman, Halpern, & Koller 2000) does not have \u039bAX (this is needed to incorporate the theory \u039b) and includes an axiom x = x that follows from \u039b-AX; otherwise, the axiom systems are identical. As observed in (Friedman, Halpern, & Koller 2000), the \u201cpositive\u201d version of F5, x = y \u21d2 N(x = y), is also sound. It is not included in the axiomatization because it is provable from the other axioms.\nIt remains to explain the notion of \u201csubstitutable\u201d in F1. Clearly a term t with free variables that might be captured by some quantifiers in \u03d5 cannot be substituted for x; for example, while \u2200x\u2203y(x 6= y) is true as long as the domain has at least two elements, the result of substituting y for x is \u2203y(y 6= y), which is surely false. In the case of first-order logic, it suffices to define \u201csubstitutable\u201d so as to make sure this does not happen (see (Enderton 1972) for details). However, in modal logics such as this one, more care must be taken In general, terms cannot be substituted for universally quantified variables in a modal context, since terms are not in general rigid; that is, they can have different interpretations in different worlds. To understand the impact of this, consider the formula \u2200x(\u00acNP (x)) \u21d2 \u00acNP (c) (where P is a unary predicate and c is a constant). This formula is not valid in PS structures. For example, consider a PS structure with two worlds w1 andw2, and a domain with two elements d1 and d2. Suppose that in world w1, P (d1) holds, P (d2) does not, and c is interpreted as d1, while in world w2, P (d2) holds, P (d1) does not, and c is interpreted as d2. Then it is easy to see that NP (c) holds in both worlds, but NP (x) holds in only one world, no matter how x is interpreted. If Prn(w1) = Prn(w2) = 1/2 for all n, then M |= NP (c), while M |= \u2200x(\u00acNP (x)). Thus, if \u03d5 is a formula that has occurrences of \u2192, then the only terms that are considered substitutable for x in \u03d5 are other variables.\nIt is interesting to contrast R1, R2, and C4. While R2 allows a formula \u03c81 on the right-hand side of \u2192 to be replaced by a weaker formula \u03c82 (that is, a formula such that that \u03c81 \u21d2 \u03c82 is provable), R1 just allows a formula \u03d51 on the left-hand side of \u2192 to be replaced by an equivalent formula\u03d52, rather than a stronger formula. C4 allows the replacement of a formula\u03d51 on the left-hand side by a stronger formula, \u03d51\u2227\u03d52, but only if \u03d51\u2192\u03d52 holds. Intuitively, this says that if \u03d52 and \u03c8 each almost always hold given \u03d51, then \u03c8 almost always holds given both \u03d51 and \u03d52. Monotonicity\ndoes not hold in general. That is, if if \u03d51 \u21d2 \u03d52 is provable and \u03d52\u2192\u03c8 holds, then \u03d51\u2192\u03c8 does not necessarily hold. For a simple counterexample, it is not the case that if true\u2192\u03c8 holds then \u00ac\u03c8\u2192\u03c8 holds. If \u03c8(x) states that x cannot break the encryption, it seems reasonable to expect that, almost always, x cannot break the encryption (true\u2192\u03c8(x)), but it surely is not the case that x cannot break the encryption given that x can break it.\nThe remaining axioms and rules are easy to explain. In particular, C2 says that if both \u03c81 and \u03c82 almost always hold given \u03d5, then so does \u03c81 \u2227 \u03c82, while C3 allows reasoning by cases: if \u03c8 almost always holds given each of \u03d51 and \u03d52, then it almost always holds given their disjunction.\nI want to show that AX\u039bC is also sound and complete for the |= sp semantics. The key step in doing that is to show that a formula is satisfiable with respect to the |= semantics iff it is satisfiable with respect to the |= sp semantics.\nTheorem 3.1: If M = (D,W, \u03c0,P) is a PS structure and D is countable, then there exists a probability sequence P \u2032 such that, for all valuations V , (M,V ) |= \u03d5 iff (M \u2032, V ) |= sp \u03d5, where M \u2032 = (D,W, \u03c0,P \u2032).\nProof: Suppose that M = (D,W, \u03c0,P), where D = {d1, d2, . . .} (D may be finite), and P = (Pr1,Pr2, . . .). Let L = (\u03d51\u2192\u03c81, \u03d52\u2192\u03c82, . . .) be a list of all formulas of the form \u03d5\u2032\u2192\u03c8\u2032 in \u0141C with the property that if (M,V \u2032) |= \u00ac(\u03d5\u2032\u2192\u03c8\u2032) for some valuation V \u2032, then \u03d5\u2032\u2192\u03c8\u2032 appears infinitely often in L. Suppose that the set of variables is {x1, x2, . . .}. (I am implicitly assuming that the set of variables is countable, as is standard.) Let Vn be the set of valuations V such that V (xi) \u2208 {d1, . . . , dn} for i = 1, . . . , n and V (xm) = d1 for all m > n. Given a valuation V \u2032 and a formula \u03d5 \u2208 \u0141C , there exists n such that, for all free variables x in \u03d5, x \u2208 {x1, . . . , xn} and V \u2032(x) \u2208 {d1, . . . , dn}. Thus, (M,V \u2032) |= \u03d5 for some valuation V \u2032 iff (M,V \u2032) |= \u03d5 for some valuation V \u2032 \u2208 Vn. Suppose that the elements of Vn are V n1 , . . . , V n |Vn|\n. Since Vn is finite, there is a subsequence P \u2032 = (Pr\u203211, . . .Pr1|V1|,Pr \u2032 21, . . . ,Pr2|V2|, . . .) of P with the following properties, for 1 \u2264 m \u2264 |Vn|:\nfor all j \u2264 n and V \u2032 \u2208 Vn, if (M,V \u2032) |= \u03d5j\u2192\u03c8j , then Pr\u2032nm([[\u03c8j ]]M,V \u2032 | [[\u03d5j ]]M,V \u2032) \u2265 1\u2212 1/n n; (1)\nif (M,V nm) |= \u00ac(\u03d5n\u2192\u03c8n), then Pr\u2032nm([[\u03c8n]]M,V nm | [[\u03d5n]]M,V nm) < 1\u2212 1/k, where k is the smallest integer such that, for infinitely many indices h, Prh([[\u03c8n]]M,V n\nm | [[\u03d5n]]M,V n m ) < 1\u2212 1/k.\n(2)\n(There must be such a k, since limh\u2192\u221e Prh([[\u03c8n]]M,V n m | [[\u03d5n]]M,V n\nm ) 6= 1.)\nLet M \u2032\u2212(D,W, \u03c0,P \u2032). I now prove that (M,V ) |= \u03d5 iff (M \u2032, V ) |= sp \u03d5 for all valuations V and formulas \u03d5 \u2208 \u0141C by a straightforward induction on the structure of \u03d5. If \u03d5 is an atomic formula, this is immediate, since M and M \u2032 differ only in their probability sequences. All cases but the one where \u03d5 has the form \u03d5\u2032\u2192\u03c8\u2032 follow immediately from the induction hypothesis. If \u03d5 has the form \u03d5\u2032\u2192\u03c8\u2032, first suppose that (M,V ) |= \u03d5\u2032\u2192\u03c8\u2032. Fix a polynomial p. There must exist some n\u2217 such that (a) for all free variables x in\n\u03d5\u2032 or \u03c8\u2032, x \u2208 {x1, . . . , xn\u2217} and V (x) \u2208 {d1, . . . dn\u2217}, (b) p(n) < 1/nn for all n \u2265 n\u2217, and (c) \u03d5\u2032\u2192\u03c8\u2032 is among the first n\u2217 formulas in L. It follows from (a) that for all n \u2265 n\u2217, there exists some V \u2032 \u2208 VN such that V \u2032 and V agree on all the free variables in \u03d5\u2032\u2192\u03c8\u2032. It then follows from (b), (c), and (1) that, for all n \u2265 n\u2217 and 1 \u2264 m \u2264 |Vn|, Pr \u2032 nm([[\u03c8\n\u2032]]M,V | [[\u03d5\u2032]]M,V ) \u2265 1 \u2212 1/p(n). Thus, (M,V ) |= sp \u03d5\u2032\u2192\u03c8\u2032.\nIf (M,V ) |= \u00ac(\u03d5\u2032\u2192\u03c8\u2032), there must be some minimal k such that Prh([[\u03c8\u2032]]M,V | [[\u03d5\u2032]]M,V ) < 1 \u2212 1/k for infinitely many indices h. Since \u03d5\u2032\u2192\u03c8\u2032 occurs infinitely often in L, it easily follows from (2) that, for infinitely many values of n and h, Pr\u2032nh([[\u03c8\n\u2032]]M,V | [[\u03d5\u2032]]M,V ) < 1 \u2212 1/k. Let p(n) = k (so p(n) is a constant function). It follows that Pr\u2032nh([[\u03c8\n\u2032]]M,V | [[\u03d5\u2032]]M,V ) < 1 \u2212 1/p(n) for infinitely many values of n and h. Thus, (M,V ) |= sp \u00ac(\u03d5\u2032\u2192\u03c8\u2032). This completes the proof.\nLet PS(\u039b) consist of all PS structures M where every world satisfies \u039b.\nTheorem 3.2: AX\u039bC is a sound and complete axiomatization for PS(\u039b) with respect to both |= and |= sp . That is, the following are equivalent for all formulas in \u0141C(T ):\n(a) AX\u039bC \u22a2 \u03d5; (b) PS(\u039b) |= \u03d5; (c) PS(\u039b) |= sp \u03d5.\nProof: The equivalence of parts (a) and (b) for the case that \u039b = \u2205 is proved in Theorem 5.2 of (Friedman, Halpern, & Koller 2000). The same proof shows that the result holds for arbitrary \u039b. To show that (a) implies (c), I must show that all the axioms are sound. The soundness of all the axioms and rules other than C2, C3, C4, and C5 is trivial. I consider each of these axioms in turn.\nFor C2, suppose that M = (D,W, \u03c0, \u3008Pr1,Pr2, . . .\u3009) is a PS structure such that M |= sp \u03d5\u2192\u03c81 and M |= sp \u03d5\u2192\u03c82. Since M |= sp \u03d5\u2192\u03c8i, i = 1, 2, given a positive polynomial p, there exists n\u22171, n \u2217 2 \u2265 0 such that, for all n \u2265 n \u2217 i , Prn([[\u03c8i]]M,V | [[\u03d5]]M,V ) \u2265 1 \u2212 1/2p(n), for i = 1, 2. For all n \u2265 max(n\u22171, n \u2217 2), Prn([[\u03c8i]] | [[\u03d5]]) \u2264 1/2p(n). Thus, for n \u2265 max(n\u22171, n \u2217 2),\nPrn([[\u03c81 \u2227 \u03c82]]M,V | [[\u03d5]]M,V ) \u2265 1\u2212 (Prn([[\u03c81]] | [[\u03d5]]) + Prn([[\u03c82]] | [[\u03d5]])) \u2265 1\u2212 12p(n) \u2212 1 2p(n) = 1\u2212 1 p(n) .\nFor C3, note that\nPr(A | B1 \u222aB2) = Pr((A \u2229B1 \u222aA \u2229B2) | B1 \u222aB2) = Pr(A \u2229B1 | B1 \u222aB2) + Pr(A \u2229B2 | B1 \u222aB2)\n\u2212Pr(A \u2229B1 \u2229B2 | B1 \u222aB2) = Pr(A | B1)\u00d7 Pr(B1 | B1 \u222aB2)\n+Pr(A | B2)\u00d7 Pr(B2 | B1 \u222aB2) \u2212Pr(A \u2229B1 \u2229B2 | B1 \u222aB2).\n(3) Now suppose that M |= sp \u03d51\u2192\u03c8 and M |= sp \u03d52\u2192\u03c8. Given a positive polynomial p, as in the case of C2, there\nexist n\u22171 and n \u2217 2 such that, for all n \u2265 n \u2217 i , Prn([[\u03c8]]M,V | [[\u03d51]]M,V ) \u2265 1 \u2212 1/2p(n), for i = 1, 2. It easily follows from (3) that if n \u2265 max(n\u22171, n \u2217 2), then\nPrn([[\u03c8]]M,V | [[\u03d51 \u2228 \u03d52]]M,V ) \u2265 (1\u2212 12p(n) )Prn([[\u03d51]]M,V | [[\u03d51 \u2228 \u03d52]]M,V )\n+(1\u2212 12p(n) )Prn([[\u03d52]]M,V | [[\u03d51 \u2228 \u03d52]]M,V )\n\u2212Prn([[\u03c8 \u2227 \u03d51 \u2227 \u03d52]]M,V | [[\u03d51 \u2228 \u03d52]]M,V ) \u2265 (1\u2212 12p(n) )Prn([[\u03d51]]M,V | [[\u03d51 \u2228 \u03d52]]M,V )\n+(1\u2212 12p(n) )Prn([[\u03d52]]M,V | [[\u03d51 \u2228 \u03d52]]M,V )\n\u2212Prn([[\u03d51 \u2227 \u03d52]]M,V | [[\u03d51 \u2228 \u03d52]]M,V ) \u2265 (1\u2212 12p(n) )[Prn([[\u03d51]]M,V | [[\u03d51 \u2228 \u03d52]]M,V )\n+Prn([[\u03d52]]M,V | [[\u03d51 \u2228 \u03d52]]M,V ) \u2212Prn([[\u03d51 \u2227 \u03d52]]M,V | [[\u03d51 \u2228 \u03d52]]M,V )] \u2212 12p(n)Prn([[\u03d51 \u2227 \u03d52]]M,V | [[\u03d51 \u2228 \u03d52]]M,V )\n\u2265 (1\u2212 12p(n) )\u2212 1 2p(n) = 1\u2212 1 p(n) .\nFor C4, note that\nPr(A1 | A2 \u2229B) = Pr(A1 \u2229A2 | B)/Pr(A2 | B) \u2265 Pr(A2 \u2229A2 | B),\nso the argument follows essentially the same lines as that for C2.\nFinally, C5 follows easily from the fact that the truth of a formula of the form \u03d5\u2192\u03c8 or \u00ac(\u03d5\u2192\u03c8) is independent of the world, and depends only on the probability sequence.\nFinally, I must show that (c) implies (b). Suppose not. Then there exists a formula \u03d5 such that PS(\u039b) |= sp \u03d5 but PS(\u039b)6 |=\u03d5. Thus, there exists M \u2208 PS(\u039b) and valuation V such that (M,V )6 |=\u03d5. The proof in (Friedman, Halpern, & Koller 2000) shows that if a formula is satisfiable with respect to |= at all, then it is satisfiable in a structure in PS(\u039b) with a countable domain. Thus, without loss of generality, M has a countable domain. But then it immediately follows from Theorem 3.1 that PS(\u039b)6 |= sp\u03d5.\nI next completely characterize reasoning in \u01410C . I start by considering the fragment \u0141\u2212C of \u0141 0 C consisting of all formulas of the form \u03d5\u2192\u03c8 where \u03d5 and \u03c8 are closed first-order formulas. Thus, \u0141\u2212C does not allow \u2192 formulas to be universally quantified. Consider the following rules:\nLLE. If \u22a2\u039b \u03d51 \u21d4 \u03d52, then from \u03d51\u2192\u03c8 infer \u03d52\u2192\u03c8 (left logical equivalence).\nRW. If \u22a2\u039b \u03c81 \u21d2 \u03c82, then from \u03d5\u2192\u03c81 infer \u03d5\u2192\u03c82 (right weakening).\nREF. \u03d5\u2192\u03d5 (reflexivity).\nAND. From \u03d5\u2192\u03c81 and \u03d5\u2192\u03c82 infer \u03d5\u2192\u03c81 \u2227 \u03c82.\nOR. From \u03d51\u2192\u03c8 and \u03d52\u2192\u03c8 infer \u03d51 \u2228 \u03d52\u2192\u03c8.\nCM. From \u03d51\u2192\u03d52 and \u03d51\u2192\u03c8 infer \u03d5\u2227\u03d52\u2192\u03c8 (cautious monotonicity).\nThis collection of rules has been called system P\u039b (Kraus, Lehmann, & Magidor 1990) or the KLM properties1\n1\u039b is not usually mentioned explicitly, but it will be useful to do so for the results of this paper.\nThe rules are obvious analogues of axioms in AX\u039bC . In particular, LLE is the analogue of R1, RW is the analogue of R2, REF is the analogue C1, AND is the analogue of C2, OR is the analogue of C3, and CM is the analogue of C4. Given a collection \u2206 of \u2192 formulas, I write P\u039b \u22a2 \u2206 \u2192\u0592 \u03d5\u2192\u03c8 if \u03d5\u2192\u03c8 can be derived from \u2206 using these rules. A derivation from \u2206 consists of a sequence of steps of the form \u2206 \u2192\u0592 \u03d5\u2192\u03c8, where either (a) \u03d5\u2192\u03c8 \u2208 \u2206, (b) \u03d5 = \u03c8 (which can be viewed as an application of the axiom REF), or (c) \u03d5\u2192\u03c8 follows from previous steps by application of one of the rules in P\u039b. All the rules above have the form \u201cfrom \u03d51 \u2192 \u03c81, . . . \u03d5n \u2192 \u03c8i\u2019 infer \u03d5 \u2192 \u03c8\u201d; this can be viewed as an abbreviation for the rule scheme \u201cfrom \u2206 \u2192\u0592 \u03d51\u2192\u03c8i, . . .\u2206 \u2192\u0592 \u03d5n\u2192\u03c8n infer \u2206 \u2192\u0592 \u03d5\u2192\u03c8\u201d, with the same \u2206 everywhere. Although, for all these rules, the set \u2206 is the same everywhere, later there will be rules where different sets \u2206 are involved. I write (M,V ) |= \u2206 \u2192\u0592 \u03d5\u2192\u03c8 if (M,V ) |= \u03d5\u2032\u2192\u03c8\u2032 for every formula \u03d5\u2032\u2192\u03c8\u2032 \u2208 \u2206 implies that (M,V ) |= \u03d5\u2192\u03c8. (For a formula \u03d5\u2192\u03c8 \u2208 \u0141\u2212C , \u03d5 and \u03c8 are closed, so (M,V ) |= \u03d5\u2192\u03c8 iff M |= \u03d5\u2192\u03c8. However, in \u01410C there are open formulas, so the valuation V plays a role.) I write PS(\u039b) |= \u2206 \u2192\u0592 \u03d5\u2192\u03c8 if (M,V ) |= \u2206 \u2192\u0592 \u03d5\u2192\u03c8 for all PS structures M and valuations V . As usual, a rule is said to be sound if it preserves truth (in this case, with respect to all (M,V )); that is, if all the antecedents hold with respect to (M,V ), then so does the conclusion.\nThe following result is well known.\nTheorem 3.3 : (Kraus, Lehmann, & Magidor 1990; Geffner 1992) If \u2206 \u222a {\u03d5\u2192\u03c8} \u2286 \u0141\u2212C , then P\u039b \u22a2 \u2206 \u2192\u0592 \u03d5\u2192\u03c8 iff PS(\u039b) |= \u2206 \u2192\u0592 \u03d5\u2192\u03c8.\nI want to extend this result from \u0141\u2212C to \u0141 0 C , and to the |= sp semantics as well as the |= semantics, so as to make it applicable to reasoning about security protocols. I actually extend it to \u01410C\u222a\u0141 fo . A collection\u2206 of formulas in \u01410C\u222a\u0141 fo can be written as \u2206\u2192 \u222a\u2206fo , where \u2206\u2192 \u2286 \u0141 0 C and \u2206fo \u2286 \u0141fo . Consider the following strengthening of LLE:\nLLE+. If \u22a2\u039b\u222a\u2206fo \u03d5 \u21d4 \u03c8, then from \u2206 \u2192\u0592 \u03d51\u2192\u03c8 infer \u2206 \u2192\u0592 \u03d52\u2192\u03c8.\nRW can be similarly strengthened to RW+. Some rules from AX\u039bC to deal with the universal quantification are also needed, specifically, variants of \u039b-AX, F1, and F3, and another rule similar in spirit to F3:\n\u039b-AX+. If \u22a2\u039b\u222a\u2206fo \u03d5, then \u2206 \u2192\u0592 \u03d5.\nF1+. From \u2200x\u03d5 infer\u03d5[x/z], where z is a variable that does not appear in \u03d5.\nF3+. If x does not appear free in \u2206, then from\u2206 \u2192\u0592 \u03d5 infer \u2206 \u2192\u0592 \u2200x\u03d5.\nEQ. If x does not appear free in \u2206, \u03d5, or \u03c8, and \u03c3 is a first-order formula, then from \u2206 \u222a {\u03c3} \u2192\u0592 \u03d5 infer \u2206 \u222a {\u2203x\u03c3} \u2192\u0592 \u03d5 (existential quantification).\nREN. If y1, . . . , yn do not appear in \u03d5, then from \u2200x1, . . . , xn\u03d5 infer \u2200y1, . . . , yn(\u03d5[x1/y1, . . . , xn/yn]) (renaming).\nBut these rules do not seem to suffice. Intuitively, what is needed is a way to capture the fact that the domain is the same in all worlds In AX\u039bC , the one axiom that captures this is F5. Unfortunately, F5 is not expressible in \u01410C . To capture its effects in \u01410C , a somewhat more complicated rule seems necessary.\nDefinition 3.4: An interpretation-independent formula \u03d5 is a first-order formula that does not mention any constant, function, or predicate symbols (and, thus, is a formula whose atomic predicates all are of the form x = y).\nThe following rule can be viewed as a variant of the OR rule for interpretation-independent formulas.\nII. If \u2206 \u222a {\u03c31} \u2192\u0592 \u03d5, \u2206 \u222a {\u03c32} \u2192\u0592 \u03d5, and \u03c31 and \u03c32 are interpretation-independent, then \u2206 \u222a {\u03c31 \u2228 \u03c32} \u2192\u0592 \u03d5 (interpretation independence).\nLet P+\u039b consist of P\u039b (with LLE and RW replaced by LLE+ and RW+, respectively) together with F1+, F3+, EQ, REN, and II.\nTheorem 3.5: If \u2206 \u222a {\u03d5} \u2286 \u01410C \u222a \u0141 fo , then the following are equivalent:\n(a) P+\u039b \u22a2 \u2206 \u2192\u0592 \u03d5; (b) PS(\u039b) |= \u2206 \u2192\u0592 \u03d5; (c) PS(\u039b) |= sp \u2206 \u2192\u0592 \u03d5.\nProof: The argument for soundness (that is, that (a) implies (c)) for the axioms and rules that also appear in P\u039b is essentially done in the proof of Theorem 3.2; the soundness of F1+, F3+, EQ, and REN is straightforward. The soundness of II follows easily from the observation that, since there is a fixed domain, if \u03c31 and \u03c32 are interpretation independent and (M,V ) |= \u03c32 \u2228 \u03c32, then (M,V ) |= \u03c31 or (M,V ) |= \u03c32. This would not be the case for a formula such as d1 = d2 \u2228 d1 = d3. It could be that, for every world w, (M,V,w) |= d1 = d2 \u2228 d1 = d3, with either d1 = d2 being true in every world or d1 = d3 being true in every world.\nThe fact that (c) implies (b) follows just as in the proof of Theorem 3.2, using Theorem 3.1. Thus, it remains to show that (b) implies (a). As usual, for completeness, it suffices to show that if P+\u039b 6 \u22a2\u2206 \u2192\u0592 \u2200x1 . . .\u2200xn(\u03d5\u2192\u03c8), then there is a structure M \u2208 PS(\u039b) and valuation V such that M |= \u2206 and (M,V ) |= \u00ac\u2200x1 . . .\u2200xn(\u03d5\u2192\u03c8). The idea is to reduce to Theorem 3.3 by transforming to a situation where the rules in P\u039b suffice. Let Distk be the formula that says that there are at least k distinct domain elements;\n\u2203x1 . . . \u2203xk(\u22271\u2264i<j\u2264kxi 6= xj).\nNote that Distk is interpretation-independent. Let \u22060 = \u2206; let \u2206n+1 = \u2206n \u222a {Distn+1} if P + \u039b 6 \u22a2\u2206n \u222a {Distn+1} \u2192\u0592 \u03d5\u2192\u03c8 and let \u2206n+1 = \u2206n\u222a{\u00acDistn+1} otherwise; finally, let \u2206\u221e = \u222an\u2206n.\nAn easy induction using II and \u039b-AX+ shows that P\n+ \u039b 6 \u22a2\u2206n \u2192\u0592 \u2200x1 . . .\u2200xn(\u03d5 \u2217 \u2192\u03c8\u2217) for all n, and hence\nP + \u039b 6 \u22a2\u2206\u221e \u2192\u0592 \u2200x1 . . . \u2200xn(\u03d5 \u2217 \u2192\u03c8\u2217). Let k\u2217 be the largest k such that Distk \u2208 \u2206\u221e (where take k\u2217 = \u221e if, for all k, Distk \u2208 \u2206\u221e). Intuitively, k\u2217 will be the size of the domain in the PS structure that we construct.\nBy REN, I can assume without loss of generality that x1, . . . , xn do not appear in \u2206\u221e. Thus, from F3+, it follows that P+\u039b 6 \u22a2\u2206\u221e \u2192\u0592 \u03d5\u2192\u03c8. A formula is a (complete) equality statement for x1, . . . , xn if it is a conjunction of formulas of the form xi = xj and xi 6= xj , such that for all 1 \u2264 i < j \u2264 n, either xi = xj or xi 6= xj is a conjunct. Note that a complete equality statement is interpretationindependent, and some equality statement must be true of every valuation. It thus follows (using II and \u039b-AX+), that P\n+ \u039b 6 \u22a2\u2206\u221e \u222a {\u03c3} \u2192\u0592 \u03d5\u2192\u03c8, for some equality statement \u03c3. An equality statement \u03c3 partitions x1, . . . , xn into equivalence classes, where it follows from \u03c3 that all the variables in each equivalence class are equal to each other, but variables in two different equivalence classes are not equal to each other. Suppose that there are h equivalence classes. Clearly h \u2264 k\u2217 (for otherwise \u03c3 would be inconsistent with distk\u2217 \u2208 \u2206\u221e, so it would follow that P + \u039b \u22a2 \u2206\u221e \u222a {\u03c3} \u2192\u0592 \u03d5\u2192\u03c8). Without loss of generality, I can assume that x1, . . . , xh are in distinct equivalence classes (so that \u03c3 implies that, for all j, x1 = xj \u2228 . . . \u2228 xh = xj ). Let \u03d5\u2032 and \u03c8\u2032 be the result of replacing xj for j > h by xi for i \u2264 h, where \u03c3 \u21d2 xi = xj . It easily follows, using LLE+ and RW+, that P\n+ \u039b 6 \u22a2\u2206\u221e \u222a {\u03c3} \u2192\u0592 \u03d5 \u2032 \u2192\u03c8\u2032. Let yi, 1 \u2264 i < k\u2217 + 1 \u2212 h be fresh variables (where k\u2217 + 1 \u2212 h = \u221e if k\u2217 = \u221e) that do not appear in \u2206, \u03d5\u2032, or \u03c8\u2032. Let \u22060\u221e = \u2206\u221e \u222a {\u03c3}; if m > 0, let \u2206m\u221e = \u2206 m\u22121 \u221e \u222a {(\u22271\u2264j<mym 6= yj \u2227 (\u22271\u2264j\u2264hym 6= xj)}. Let \u2206\u2020 = \u222ai<k\u2217+1\u2212h\u2206i\u221e. I claim that P+\u039b 6 \u22a2\u2206\n\u2020 \u2192\u0592 \u03d5\u2032\u2192\u03c8\u2032. To show this, since proofs are finite, it suffices to show that P+\u039b 6 \u22a2\u2206 m \u221e \u2192\u0592 \u03d5 \u2032 \u2192\u03c8\u2032 for all m < k\u2217 + 1 \u2212 h. I do this by induction on m. For m = 0, this is true by assumption. Suppose, by way of contradiction, that P+\u039b \u22a2 \u2206 m \u221e \u2192\u0592 \u03d5 \u2032 \u2192\u03c8\u2032. For m > 0, note that \u2206m\u221e has the form \u2206\u221e \u222a {\u03c3 0, \u03c31, . . . , \u03c3m}, where ym appears only in \u03c3m. It thus follows from EQ that P+\u039b \u22a2 \u2206m\u221e \u222a {\u03c3\n0, . . . , \u03c3m\u22121, \u2203ym\u03c3m} \u2192\u0592 \u03d5\u2032\u2192\u03c8\u2032. It is easy to see that Distm \u21d2 \u2203ym\u03c3m is valid. Since Distm \u2208 \u2206\u221e, it follows that P+\u039b \u22a2 \u2206 m\u22121 \u221e \u2192\u0592 \u03d5 \u2032 \u2192\u03c8\u2032, contradicting the inductive hypothesis. Let D = {di : 1 \u2264 i < k\u2217 + 1} consist of fresh constant symbols not in T \u222a {c1, . . . , cn}. Let an instantiation of \u2200x1 . . . \u2200xn(\u03d5\u2032\u2192\u03c8\u2032) be a formula in \u0141 \u2212 C of the form \u03d5\u2032\u2032\u2192\u03c8\u2032\u2032 that results by replacing each free variable in \u03d5\u2032\u2192\u03c8\u2032 by some element of D. For example, the instantiations of \u2200x\u2200y(P (x, y)\u2192Q(y)) are all formulas the form P (di,dj)\u2192Q(dj). Let \u2206\u2217 be the result of replacing each formula \u2200x1 . . . \u2200xn(\u03d5\u2032\u2192\u03c8\u2032) in \u2206 by all its instantiations, and replacing the free variables x1, . . . , xh, y1, y2, . . . in the formulas in \u2206\u2020 \u2212 \u2206 by d1,d2, . . . respectively. Let \u03d5\u2217 and \u03c8\u2217 be the result of replacing x1, . . . , xh in \u03d5\u2032 and \u03c8\u2032 by d1, . . . ,dh, respectively. I claim that P\u039b\u222a\u2206\u2217 0 6 \u22a2\u2206\u2217\u2192 \u2192\u0592 \u03d5\u2217\u2192\u03c8\u2217. Suppose, by way of contradiction, that P\u039b\u222a\u2206\u2217 0 \u22a2 \u2206\u2217\u2192 \u2192\u0592 \u03d5 \u2217 \u2192\u03c8\u2217. Then clearly P+\u039b \u22a2 \u2206\n\u2217 \u2192\u0592 \u03d5\u2217\u2192\u03c8\u2217. Let \u22061 be the result of replacing all occurrences of d1,d2, . . . by x1, . . . , xh, y1, y2, . . ., respectively. Then P + \u039b \u22a2 \u22061 \u2192\u0592 \u03d5\u2032\u2192\u03c8\u2032 (simply replace the constants dj by the appropriate variables in each line of the derivation of \u03d5\u2217\u2192\u03c8\u2217). Moreover, \u22061 has the form \u22062 \u222a (\u2206\u2020 \u2212 \u2206), and, by F1+ and \u039b-AX+, it easily follows that \u2206 \u222a (\u2206\u2020 \u2212 \u2206) \u2192\u0592 \u03d5\u2032\u2192\u03c8\u2019;\nthat is, \u2206\u2020 \u2192\u0592 \u03d5\u2032\u2192\u03c8\u2032. This gives us the desired contradiction.\nSince P\u039b\u222a\u2206\u2217 0 6 \u22a2\u2206\u2217\u2192 \u2192\u0592 \u03d5 \u2217 \u2192\u03c8\u2217, it follows by Theorem 3.3 that there exists a PS structure M \u2208 PS(\u039b) and a valuation V such that M |= \u2206\u2217 and M |= \u03d5\u2217\u2192\u03c8\u2217. Moreover, by standard arguments (used, for example, in (Friedman, Halpern, & Koller 2000)) the domain of M can be taken to be countable. Since Distk \u2208 \u2206\u2217 for all k < k\u2217, and if k\u2217 < \u221e, \u00acDistk\u2217 \u2208 \u2206\u2217, all the worlds in M mus+t have domain size k\u2217 (where, if k\u2217 = \u221e, the domain is countable). Hence, I can assume without loss of generality that all the worlds have the same domain, which can be take to be D = {di : i < k\u2217}; moreover, di can be taken to be the interpretation di in each domain. It follows that M |= \u2206, and M 6 |=\u03d5\u2192\u03c8, as desired."}, {"heading": "3.2 Quantitative Reasoning", "text": "The super-polynomial semantics just talks about asymptotic complexity. It says that for any polynomial p, the conclusion will hold with probability greater than 1 \u2212 1/p(n) for sufficiently large n, provided that the assumptions hold with sufficiently high probability, where n can be, for example, the security parameter. While this asymptotic complexity certainly gives insight into the security of a protocol, in practice, a system designer wants to achieve a certain level of security, and needs to know, for example, how large to take the keys in order to achieve this. In this section, I provide a more quantitative semantics appropriate for such reasoning, and connect the qualitative and quantitative semantics.\nThe syntax of the quantitative language, which is denoted \u0141C,q, is just like that of the qualitative language, except that, instead of formulas of the form \u03d5\u2192\u03c8, there are formulas of the form \u03d5\u2192r\u03c8, where r is a real number in [0, 1]. The semantics of such a formula is straightforward:\n(M,V ) |= \u03d5\u2192r\u03c8 if there exists some n\u2217 \u2265 0 such that for all n \u2265 n\u2217, Prn([[\u03c8]]M,V | [[\u03d5]]M,V ) \u2265 1\u2212 r).\nI define \u01410C,q in the obvious way. For each of the axioms and rules in system P\u039b, there is a corresponding sound axiom or rule in \u01410C,q: LLEq . If \u22a2\u039b\u222a\u2206fo \u03d51 \u21d4 \u03d52, then from \u2206 \u2192\u0592 \u03d51\u2192 r\u03c8 infer\n\u2206 \u2192\u0592 \u03d52\u2192r\u03c8.\nRWq . If \u22a2\u039b\u222a\u2206fo \u03c81 \u21d2 \u03c82, then from \u2206 \u2192\u0592 \u03d5\u2192 r\u03c81 infer\n\u2206 \u2192\u0592 \u03d5\u2192r\u03c82.\nREFq . \u03d5\u21920\u03d5 (reflexivity).\nANDq. From \u03d5\u2192r1\u03c81 and \u03d5\u2192r2\u03c82 infer \u03d5\u2192r3\u03c81 \u2227 \u03c82, where r3 = min(r1 + r2, 1).\nORq. From \u03d51\u2192r1\u03c8 and \u03d5\u2192r2\u03c82 infer \u03d51 \u2228 \u03d52\u2192r3\u03c8, where r3 = max(2r1, 2r2, 1).\nCMq . From \u03d51\u2192r1\u03d52 and \u03d51\u2192r2\u03c8 infer \u03d5 \u2227 \u03d52\u2192r3\u03c8, where r3 = max(r1 + r2, 1).\nLet P+,q\u039b denote this set of rules, together with F1 +, F3+, EQ, REN, and II (all of which hold with no change in the quantitative setting), and\nINC. If r1 \u2264 r2, then from \u03d5\u2192r1\u03c8 infer \u03d5\u2192r2\u03c8.\nTheorem 3.6: The rules in P+,q\u039b are all sound.\nProof: The soundness of the quantitative analogues of the rules in P\u039b is immediate from the proof of Theorem 3.2. The soundness of remaining rules holds as it did before (since they are unchanged). PS structure\nI do not believe that P+,q\u039b is complete, nor do I have a candidate complete axiomatization for the quantitative language. Nevertheless, as the proofs in (Datta et al. 2008) show, P+,q\u039b suffices for proving many results of interest in security. Moreover, as I now show, there is a deep relationship between P+\u039b and P +,q \u039b . To make it precise, given a set of formulas \u2206 \u2286 \u01410C , say that \u2206 \u2032 \u2286 \u01410C,q is a quantitative instantiation of \u2206 if, for every formula \u03d5\u2192\u03c8 \u2208 \u2206, there is a bijection f from \u2206 to \u2206\u2032 such that, for every formula \u03d5\u2192\u03c8 \u2208 \u2206, there is a real number r \u2208 [0, 1] such that f(\u03d5\u2192\u03c8) = \u03d5\u2192r\u03c8. That is, \u2206\u2032 is a quantitative instantiation of \u2206 if each qualitative formula in \u2206 has a quantitative analogue in \u2206\u2032.\nAlthough the proof of the following theorem is straightforward, it shows the power of using of P+\u039b . Specifically, it shows The following theorem shows that if \u03d5\u2192\u03c8 is derivable from \u2206 in P+\u039b then, for all r \u2208 [0, 1], there exists a quantitative instantiation \u2206\u2032 of \u2206 such that \u03d5\u2192r\u03c8 is derivable from \u2206\u2032 in P+,q\u039b . Thus, if the system designer wants security at level r (that is, she wants to know that the desired security property holds with probability at least 1\u2212 r), then if she has a qualitative proof of the result, she can compute the strength with which her assumptions must hold in order for the desired conclusion to hold. For example, she can compute how to set the security parameters in order to get the desired level of security. This result can be viewed as justifying qualitative reasoning. Roughly speaking, it says that it is safe to avoid thinking about the quantitative details, since they can always be derived later. Note that this result would not hold if the language allowed negation. For example, even if \u00ac(\u03d5\u2192\u03c8) could be proved given some assumptions (using the axiom system AX\u039bC ), it would not necessarily follow that \u00ac(\u03d5\u2192q\u03c8) holds, even if the probability of the assumptions was taken arbitrarily close to one.\nTheorem 3.7: If P+\u039b \u22a2 \u2206 \u2192\u0592 \u03d5\u2192\u03c8, then for all r \u2208 [0, 1], there exists a quantitative instantiation \u2206\u2032 of \u2206 such that P\n+,q \u039b \u22a2 \u2206 \u2032 \u2192\u0592 \u03d5\u2192q\u03c8. Moreover, \u2206\u2032 can be found in polynomial time, given the derivation of \u2206 \u2192\u0592 \u03d5\u2192\u03c8.\nProof: The existence of \u2206\u2032 follows by a straightforward induction on the length of the derivation. If it has length 1, then either \u03d5 = \u03c8, in which case it is an instance of REFq , or \u03d5\u2192\u03c8 \u2208 \u2206, in which case I simply take \u2206\u2032 such that it includes \u03d5\u2192r\u03c8. For the inductive step, the only nontrivial case is if \u03d5\u2192\u03c8 follows from earlier steps by an instance of a rule of inference in P+\u039b . The result then follows by a simple case analysis on the form of the rule. For example, if the AND rule is used, then \u03d5\u2192\u03c8 has the form \u03d5\u2192\u03c81 \u2227 \u03c82, and there are shorter derivations of \u2206 \u2192\u0592 \u03d5\u2192\u03c81 and \u2206 \u2192\u0592 \u03d5\u2192\u03c82. Choose s1, s2 \u2208 [0, 1] such that s1+s2 = r2\n2It suffices to take s1 = s2 = r/2, but there is an advantage to having this greater flexibility; see the discussion after the proof.\nBy the induction hypothesis, there exist variants \u22061 and \u22062 such that P +,q \u039b \u22a2 \u2206i \u2192\u0592 \u03d5\u2192\nsi\u03c8i, for i = 1, 2. Let \u22063 be a quantitative instantiation of \u2206 that dominates both \u22061 and \u22062, in the sense that if \u03d5\u2032\u2192ri\u03c8\u2032 \u2208 \u2206i, for i = 1, 2, 3, then ri \u2265 max(r1, r2). Then it is easy to see that P+,q\u039b \u22a2 \u22063 \u2192\u0592 \u03d5\u2192\nsi\u03c8i for i = 1, 2. By ANDq , it easily follows that P+,q\u039b \u22063 \u2192\u0592 \u03d5\u2192\nr\u03c81\u2227\u03c82. The argument for all the other rules in P+\u039b is similar. This argument also shows that finding \u2206\u2032 from the proof of \u2206 \u2192\u0592 \u03d5\u2192\u03c8 just involves solving some simple linear inequalities, which can be done in polynomial time.\nThe proof of Theorem 3.7 gives even more useful information to the system designer. In general, there may be a number of quantitative instantiations \u2206\u2032 of \u2206 that give the desired conclusion. For example, as the proof shows, if the AND rule is used in the qualitative proof, and we want the conclusion to hold at level r, we must just choose s1 and s2 such that \u03d5\u2192\u03c81 and \u03d5\u2192\u03c82 hold at level s1 and s2, respectively. If the system designer finds it easier to satisfy the first formula than the second (for example, the first may involve the length of the key, while the second may involve the degree of trustworthiness of one of the participants in the protocol), there may be an advantage in choosing s1 relatively small and s2 larger. As long as s1 + s2 = r, the desired conclusion will hold.\nAcknowledgements: I think Anupam Datta, John Mitchell, Riccardo Pucella, and Arnab Roy for many useful discussions on applying conditional logic to security protocols."}], "references": [{"title": "and Rogaway", "author": ["M. Abadi"], "venue": "P.", "citeRegEx": "Abadi . Rogaway 2000", "shortCiteRegEx": null, "year": 2000}, {"title": "L", "author": ["G. Bella", "Paulson"], "venue": "C.", "citeRegEx": "Bella . Paulson 1998", "shortCiteRegEx": null, "year": 1998}, {"title": "A modular approach to the design and analysis of authentication and key exchange protocols", "author": ["Canetti Bellare", "M. Krawczyk 1998] Bellare", "R. Canetti", "H. Krawczyk"], "venue": "In Proc. 30th Annual Symposium on the Theory of Computing", "citeRegEx": "Bellare et al\\.,? \\Q1998\\E", "shortCiteRegEx": "Bellare et al\\.", "year": 1998}, {"title": "Intercepting mobile communications: the insecurity of 802.11", "author": ["Goldberg Borisov", "N. Wagner 2001] Borisov", "I. Goldberg", "D. Wagner"], "venue": "In Proc. 7th Annual International Conference on Mobile Computing and Networking,", "citeRegEx": "Borisov et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Borisov et al\\.", "year": 2001}, {"title": "J", "author": ["A. Datta", "A. Derek", "Mitchell"], "venue": "C.; Shmatikov, V.; and Turuani, M.", "citeRegEx": "Datta et al. 2005", "shortCiteRegEx": null, "year": 2005}, {"title": "J", "author": ["A. Datta", "A. Derek", "Mitchell"], "venue": "C.; and Roy, A.", "citeRegEx": "Datta et al. 2007", "shortCiteRegEx": null, "year": 2007}, {"title": "J", "author": ["A. Datta", "J.Y. Halpern", "Mitchell"], "venue": "C.; Pucella, R.; and Roy, A.", "citeRegEx": "Datta et al. 2008", "shortCiteRegEx": null, "year": 2008}, {"title": "H", "author": ["Enderton"], "venue": "B.", "citeRegEx": "Enderton 1972", "shortCiteRegEx": null, "year": 1972}, {"title": "J", "author": ["N. Friedman", "Halpern"], "venue": "Y.", "citeRegEx": "Friedman . Halpern 2001", "shortCiteRegEx": null, "year": 2001}, {"title": "J", "author": ["Friedman, N.", "Halpern"], "venue": "Y.; and Koller, D.", "citeRegEx": "Friedman. Halpern. . Koller 2000", "shortCiteRegEx": null, "year": 2000}, {"title": "and Pearl", "author": ["M. Goldszmidt"], "venue": "J.", "citeRegEx": "Goldszmidt . Pearl 1992", "shortCiteRegEx": null, "year": 1992}, {"title": "A maximum entropy approach to nonmonotonic reasoning", "author": ["Morris Goldszmidt", "M. Pearl 1993] Goldszmidt", "P. Morris", "J. Pearl"], "venue": "IEEE Transactions of Pattern Analysis and Machine Intelligence", "citeRegEx": "Goldszmidt et al\\.,? \\Q1993\\E", "shortCiteRegEx": "Goldszmidt et al\\.", "year": 1993}, {"title": "Nonmonotonic reasoning, preferential models and cumulative logics", "author": ["Lehmann Kraus", "S. Magidor 1990] Kraus", "D. Lehmann", "M. Magidor"], "venue": "Artificial Intelligence", "citeRegEx": "Kraus et al\\.,? \\Q1990\\E", "shortCiteRegEx": "Kraus et al\\.", "year": 1990}, {"title": "Automated analysis of cryptographic protocols using Mur\u03c6", "author": ["Mitchell Mitchell", "J. Stern 1997] Mitchell", "M. Mitchell", "U. Stern"], "venue": "In Proc", "citeRegEx": "Mitchell et al\\.,? \\Q1997\\E", "shortCiteRegEx": "Mitchell et al\\.", "year": 1997}, {"title": "J", "author": ["Mitchell"], "venue": "C.; Shmatikov, V.; and Stern, U.", "citeRegEx": "Mitchell. Shmatikov. . Stern 1998", "shortCiteRegEx": null, "year": 1998}, {"title": "L", "author": ["Paulson"], "venue": "C.", "citeRegEx": "Paulson 1994", "shortCiteRegEx": null, "year": 1994}, {"title": "and Schneier", "author": ["D. Wagner"], "venue": "B.", "citeRegEx": "Wagner . Schneier 1996", "shortCiteRegEx": null, "year": 1996}], "referenceMentions": [], "year": 2008, "abstractText": "A first-order conditional logic is considered, with semantics given by a variant of \u01eb-semantics (Adams 1975; Goldszmidt & Pearl 1992), where \u03c6\u2192\u03c8 means that Pr(\u03c8 | \u03c6) approaches 1 super-polynomially\u2014faster than any inverse polynomial. This type of convergence is needed for reasoning about security protocols. A complete axiomatization is provided for this semantics, and it is shown how a qualitative proof of the correctness of a security protocol can be automatically converted to a quantitative proof appropriate for reasoning about concrete security.", "creator": "LaTeX with hyperref package"}}}