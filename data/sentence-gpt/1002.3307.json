{"id": "1002.3307", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "17-Feb-2010", "title": "Graph Zeta Function in the Bethe Free Energy and Loopy Belief Propagation", "abstract": "We propose a new approach to the analysis of Loopy Belief Propagation (LBP) by establishing a formula that connects the Hessian of the Bethe free energy with the edge zeta function. The formula has a number of theoretical implications on LBP. It is applied to give a sufficient condition that the Hessian of the Bethe free energy is positive definite, which shows non-convexity for graphs with multiple cycles. The formula clarifies the relation between the local stability of a fixed point of LBP and local minima of the Bethe free energy. We also propose a new approach to the uniqueness of LBP fixed point, and show various conditions of uniqueness. The formula makes clear the difference between the Hessian of the Bethe free energy and the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of the LBP of", "histories": [["v1", "Wed, 17 Feb 2010 17:55:58 GMT  (80kb)", "http://arxiv.org/abs/1002.3307v1", "19 pages, Annual Conference on Neural Information Processing Systems (NIPS 2009), together with the supplementary material"]], "COMMENTS": "19 pages, Annual Conference on Neural Information Processing Systems (NIPS 2009), together with the supplementary material", "reviews": [], "SUBJECTS": "cs.AI cs.DM math-ph math.MP", "authors": ["yusuke watanabe", "kenji fukumizu"], "accepted": true, "id": "1002.3307"}, "pdf": {"name": "1002.3307.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": ["watay@ism.ac.jp", "fukumizu@ism.ac.jp"], "sections": [{"heading": null, "text": "ar X\niv :1\n00 2.\n33 07\nv1 [\ncs .A\nI] 1\n7 Fe"}, {"heading": "1 Introduction", "text": "Pearl\u2019s belief propagation [1] provides an efficient method for exact computation in the inference with probabilistic models associated to trees. As an extension to general graphs allowing cycles, Loopy Belief Propagation (LBP) algorithm [2] has been proposed, showing successful performance in various problems such as computer vision and error correcting codes.\nOne of the interesting theoretical aspects of LBP is its connection with the Bethe free energy [3]. It is known, for example, the fixed points of LBP correspond to the stationary points of the Bethe free energy. Nonetheless, many of the properties of LBP such as exactness, convergence and stability are still unclear, and further theoretical understanding is needed.\nThis paper theoretically analyzes LBP by establishing a formula asserting that the determinant of the Hessian of the Bethe free energy equals the reciprocal of the edge zeta function up to a positive factor. This formula derives a variety of results on the properties of LBP such as stability and uniqueness, since the zeta function has a direct link with the dynamics of LBP as we show.\nThe first application of the formula is the condition for the positive definiteness of the Hessian of the Bethe free energy. The Bethe free energy is not necessarily convex, which causes unfavorable behaviors of LBP such as oscillation and multiple fixed points. Thus, clarifying the region where the Hessian is positive definite is an importance problem. Unlike the previous approaches which consider the global structure of the Bethe free energy such as [4, 5], we focus the local structure. Namely, we provide a simple sufficient condition that determines the positive definite region: if all the correlation coefficients of the pseudomarginals are smaller than a value given by a characteristic of the graph, the Hessian is positive definite. Additionally, we show that the Hessian always has a negative eigenvalue around the boundary of the domain if the graph has at least two cycles.\nSecond, we clarify a relation between the local stability of a LBP fixed point and the local structure of the Bethe free energy. Such a relation is not necessarily obvious, since LBP is not the gradient descent of the Bethe free energy. In this line of studies, Heskes [6] shows that a locally stable fixed point of LBP is a local minimum of the Bethe free energy. It is thus interesting to ask which local\nminima of the Bethe free energy are stable or unstable fixed points of LBP. We answer this question by elucidating the conditions of the local stability of LBP and the positive definiteness of the Bethe free energy in terms of the eigenvalues of a matrix, which appears in the graph zeta function.\nFinally, we discuss the uniqueness of LBP fixed point by developing a differential topological result on the Bethe free energy. The result shows that the determinant of the Hessian at the fixed points, which appears in the formula of zeta function, must satisfy a strong constraint. As a consequence, in addition to the known result on the one-cycle case, we show that the LBP fixed point is unique for any unattractive connected graph with two cycles without restricting the strength of interactions."}, {"heading": "2 Loopy belief propagation algorithm and the Bethe free energy", "text": "Throughout this paper, G = (V,E) is a connected undirected graph with V the vertices and E the undirected edges. The cardinality of V and E are denoted by N and M respectively.\nIn this article we focus on binary variables, i.e., xi \u2208 {\u00b11}. Suppose that the probability distribution over the set of variables x = (xi)i\u2208V is given by the following factorization form with respect to G:\np(x) = 1\nZ\n\u220f\nij\u2208E\n\u03c8ij(xi, xj) \u220f\ni\u2208V\n\u03c8i(xi), (1)\nwhere Z is a normalization constant and \u03c8ij and \u03c8i are positive functions given by \u03c8ij(xi, xj) = exp(Jijxixj) and \u03c8i(xi) = exp(hixi) without loss of generality.\nIn various applications, the computation of marginal distributions pi(xi) := \u2211\nx\\{xi} p(x) and\npij(xi, xj) := \u2211\nx\\{xixj} p(x) is required though the exact computation is intractable for large\ngraphs. If the graph is a tree, they are efficiently computed by Pearl\u2019s belief propagation algorithm [1]. Even if the graph has cycles, it is empirically known that the direct application of this algorithm, called Loopy Belief Propagation (LBP), often gives good approximation.\nLBP is a message passing algorithm. For each directed edge, a message vector \u00b5i\u2192j(xj) is assigned and initialized arbitrarily. The update rule of messages is given by\n\u00b5newi\u2192j(xj) \u221d \u2211\nxi\n\u03c8ji(xj , xi)\u03c8i(xi) \u220f\nk\u2208Ni\\j\n\u00b5k\u2192i(xi), (2)\nwhere Ni is the neighborhood of i \u2208 V . The order of edges in the update is arbitrary. In this paper we consider parallel update, that is, all edges are updated simultaneously. If the messages converge to a fixed point {\u00b5\u221ei\u2192j}, the approximations of pi(xi) and pij(xi, xj) are calculated by the beliefs,\nbi(xi) \u221d \u03c8i(xi) \u220f\nk\u2208Ni\n\u00b5 \u221e k\u2192i(xi), bij(xi, xj) \u221d \u03c8ij(xi, xj)\u03c8i(xi)\u03c8j(xj)\n\u220f\nk\u2208Ni\\j\n\u00b5 \u221e k\u2192i(xi)\n\u220f\nk\u2208Nj\\i\n\u00b5 \u221e k\u2192j(xj),\n(3) with normalization \u2211\nxi bi(xi) = 1 and\n\u2211\nxi,xj bij(xi, xj) = 1. From (2) and (3), the constraints\nbij(xi, xj) > 0 and \u2211\nxj bij(xi, xj) = bi(xi) are automatically satisfied.\nWe introduce the Bethe free energy as a tractable approximation of the Gibbs free energy. The exact distribution (1) is characterized by a variational problem p(x) = argminp\u0302 FGibbs(p\u0302), where the minimum is taken over all probability distributions on (xi)i\u2208V and FGibbs(p\u0302) is the Gibbs free energy defined by FGibbs(p\u0302) = KL(p\u0302||p)\u2212 logZ . Here KL(p\u0302||p) = \u222b\np\u0302 log(p\u0302/p) is the KullbackLeibler divergence from p\u0302 to p. Note that FGibbs(p\u0302) is a convex function of p\u0302.\nIn the Bethe approximation, we confine the above minimization to the distribution of the form b(x) \u221d \u220f\nij\u2208E bij(xi, xj) \u220f i\u2208V bi(xi) 1\u2212di , where di := |Ni| is the degree and the constraints\nbij(xi, xj) > 0, \u2211\nxi,xj bij(xi, xj) = 1 and\n\u2211\nxj bij(xi, xj) = bi(xi) are satisfied. A set\n{bi(xi), bij(xi, xj)} satisfying these constraints is called pseudomarginals. For computational tractability, we modify the Gibbs free energy to the objective function called Bethe free energy:\nF (b) :=\u2212 \u2211\nij\u2208E\n\u2211\nxixj\nbij(xi, xj) log\u03c8ij(xi, xj)\u2212 \u2211\ni\u2208V\n\u2211\nxi\nbi(xi) log\u03c8i(xi)\n+ \u2211\nij\u2208E\n\u2211\nxixj\nbij(xi, xj) log bij(xi, xj) + \u2211\ni\u2208V\n(1\u2212 di) \u2211\nxi\nbi(xi) log bi(xi). (4)\nThe domain of the objective function F is the set of pseudomarginals. The function F does not necessarily have a unique minimum. The outcome of this modified variational problem is the same as that of LBP [3]. To put it more precisely, There is a one-to-one correspondence between the set of stationary points of the Bethe free energy and the set of fixed points of LBP.\nIt is more convenient if we work with minimal parameters, mean mi = Ebi [xi] and correlation \u03c7ij = Ebij [xixj ]. Then we have an effective parametrization of pseudomarginals:\nbij(xi, xj) = 1\n4 (1 +mixi +mjxj + \u03c7ijxixj), bi(xi) =\n1 2 (1 +mi). (5)\nThe Bethe free energy (4) is rewritten as\nF ({mi, \u03c7ij}) = \u2212 \u2211\nij\u2208E\nJij\u03c7ij \u2212 \u2211\ni\u2208V\nhimi\n+ \u2211\nij\u2208E\n\u2211\nxixj\n\u03b7 (1+mixi+mjxj+ \u03c7ijxixj\n4\n)\n+ \u2211\ni\u2208V\n(1\u2212 di) \u2211\nxi\n\u03b7 (1 +mixi\n2\n)\n, (6)\nwhere \u03b7(x) := x log x. The domain of F is written as\nL(G) := { {mi, \u03c7ij} \u2208 R N+M |1+mixi+mjxj +\u03c7ijxixj > 0 for all ij \u2208 E and xi, xj = \u00b11 } .\nThe Hessian of F , which consists of the second derivatives with respect to {mi, \u03c7ij}, is a square matrix of size N +M and denoted by \u22072F . This is considered to be a matrix-valued function on L(G). Note that, from (6), \u22072F does not depend on Jij and hi."}, {"heading": "3 Zeta function and Hessian of Bethe free energy", "text": ""}, {"heading": "3.1 Zeta function and Ihara\u2019s formula", "text": "For each undirected edge of G, we make a pair of oppositely directed edges, which form a set of directed edges ~E. Thus | ~E| = 2M . For each directed edge e \u2208 ~E, o(e) \u2208 V is the origin of e and t(e) \u2208 V is the terminus of e. For e \u2208 ~E, the inverse edge is denoted by e\u0304, and the corresponding undirected edge by [e] = [e\u0304] \u2208 E.\nA closed geodesic in G is a sequence (e1, . . . , ek) of directed edges such that t(ei) = o(ei+1) and ei 6= e\u0304i+1 for i \u2208 Z/kZ. Two closed geodesics are said to be equivalent if one is obtained by cyclic permutation of the other. An equivalent class of closed geodesics is called a prime cycle if it is not a repeated concatenation of a shorter closed geodesic. Let P be the set of prime cycles of G. For given weights u = (ue)e\u2208 ~E , the edge zeta function [7, 8] is defined by\n\u03b6G(u) := \u220f\np\u2208P\n(1\u2212 g(p))\u22121, g(p) := ue1 \u00b7 \u00b7 \u00b7uek for p = (e1, . . . , ek),\nwhere ue \u2208 C is assumed to be sufficiently small for convergence. This is an analogue of the Riemann zeta function which is represented by the product over all the prime numbers.\nExample 1. If G is a tree, which has no prime cycles, \u03b6G(u) = 1. For 1-cycle graph CN of length N , the prime cycles are (e1, e2, . . . , eN ) and (e\u0304N , e\u0304N\u22121, . . . , e\u03041), and thus \u03b6CN (u) = (1 \u2212 \u220fN\nl=1 uel) \u22121(1\u2212 \u220fN l=1 ue\u0304l) \u22121. Except for these two types of graphs, the number of prime cycles is infinite.\nIt is known that the edge zeta function has the following simple determinant formula, which gives analytical continuation to the whole C2M . Let C( ~E) be the set of functions on the directed edges. We define a matrix on C( ~E), which is determined by the graph G, by\nMe,e\u2032 :=\n{\n1 if e 6= e\u0304\u2032 and o(e) = t(e\u2032), 0 otherwise.\n(7)\nTheorem 1 ([8], Theorem 3). \u03b6G(u) = det(I \u2212 UM)\n\u22121, (8) where U is a diagonal matrix defined by Ue,e\u2032 := ue\u03b4e,e\u2032 .\nWe need to show another determinant formula of the edge zeta function, which is used in the proof of Theorem 3. We leave the proof of Theorem 2 to the supplementary material. Theorem 2 (Multivariable version of Ihara\u2019s formula). Let C(V ) be the set of functions on V . We define two linear operators on C(V ) by\n(D\u0302f)(i) := ( \u2211\ne\u2208~E t(e)=i\nueue\u0304 1\u2212 ueue\u0304 ) f(i), (A\u0302f)(i) := \u2211\ne\u2208~E t(e)=i\nue 1\u2212 ueue\u0304 f(o(e)), where f \u2208 C(V ).\n(9) Then we have\n(\n\u03b6G(u) \u22121 =\n)\ndet(I \u2212 UM) = det(I + D\u0302 \u2212 A\u0302) \u220f\n[e]\u2208E\n(1\u2212 ueue\u0304). (10)\nIf we set ue = u for all e \u2208 ~E , the edge zeta function is called the Ihara zeta function [9] and denoted by \u03b6G(u). In this single variable case, Theorem 2 is reduced to Ihara\u2019s formula [10]:\n\u03b6G(u) \u22121 = det(I \u2212 uM) = (1\u2212 u2)M det(I +\nu2\n1\u2212 u2 D \u2212\nu\n1\u2212 u2 A), (11)\nwhere D is the degree matrix and A is the adjacency matrix defined by\n(Df)(i) := dif(i), (Af)(i) := \u2211\ne\u2208 ~E,t(e)=i\nf(o(e)), f \u2208 C(V )."}, {"heading": "3.2 Main formula", "text": "Theorem 3 (Main Formula). The following equality holds at any point of L(G): (\n\u03b6G(u) \u22121=\n)\ndet(I \u2212 UM) = det(\u22072F ) \u220f\nij\u2208E\n\u220f\nxi,xj=\u00b11\nbij(xi, xj) \u220f\ni\u2208V\n\u220f\nxi=\u00b11\nbi(xi) 1\u2212di 22N+4M ,\n(12) where bij and bi are given by (5) and\nui\u2192j := \u03c7ij \u2212mimj\n1\u2212m2j . (13)\nProof. (The detail of the computation is given in the supplementary material.) From (6), it is easy to see that the (E,E)-block of the Hessian is a diagonal matrix given by\n\u22022F\n\u2202\u03c7ij\u2202\u03c7kl = \u03b4ij,kl\n1\n4\n( 1\n1+mi+mj+\u03c7ij +\n1\n1\u2212mi+mj\u2212\u03c7ij +\n1\n1+mi\u2212mj\u2212\u03c7ij +\n1\n1\u2212mi\u2212mj+\u03c7ij\n)\n.\nUsing this diagonal block, we erase (V,E)-block and (E,V)-block of the Hessian. In other words, we choose a square matrix X such that detX = 1 and\nXT (\u22072F )X =\n[\nY 0 0 (\n\u22022F \u2202\u03c7ij\u2202\u03c7kl\n)\n]\n.\nAfter the computation given in the supplementary material, we see that\n(Y )i,j =\n\n\n\n1 1\u2212m2i + \u2211 k\u2208Ni\n(\u03c7ik\u2212mimk) 2\n(1\u2212m2i )(1\u2212m 2 i\u2212m 2 k +2mimk\u03c7ik\u2212\u03c72ik)\nif i = j,\n\u2212Ai,j \u03c7ij\u2212mimj\n1\u2212m2i\u2212m 2 j+2mimj\u03c7ij\u2212\u03c7 2 ij\notherwise. (14)\nFrom uj\u2192i = \u03c7ij\u2212mimj\n1\u2212m2i , it is easy to check that IN + D\u0302 \u2212 A\u0302 = YW , where A\u0302 and D\u0302 is defined in\n(9) and W is a diagonal matrix defined by Wi,j := \u03b4i,j(1\u2212m2i ). Therefore,\ndet(I \u2212 UM) = det(Y ) \u220f\ni\u2208V\n(1\u2212m2i ) \u220f\n[e]\u2208E\n(1\u2212 ueue\u0304) = R.H.S. of (12)\nFor the left equality, Theorem 2 is used.\nTheorem 3 shows that the determinant of the Hessian of the Bethe free energy is essentially equal to det(I\u2212UM), the reciprocal of the edge zeta function. Since the matrix UM has a direct connection with LBP as seen in section 5, the above formula derives many consequences shown in the rest of the paper."}, {"heading": "4 Application to positive definiteness conditions", "text": "The convexity of the Bethe free energy is an important issue, as it guarantees uniqueness of the fixed point. Pakzad et al [11] and Heskes [5] derive sufficient conditions of convexity and show that the Bethe free energy is convex for trees and graphs with one cycle. In this section, instead of such global structure, we shall focus the local structure of the Bethe free energy as an application of the main formula.\nFor given square matrix X , Spec(X) \u2282 C denotes the set of eigenvalues (spectra), and \u03c1(X) the spectral radius of a matrix X , i.e., the maximum of the modulus of the eigenvalues. Theorem 4. Let M be the matrix given by (7). For given {mi, \u03c7ij} \u2208 L(G), U is defined by (13). Then, Spec(UM) \u2282 C \\ R\u22651 =\u21d2 \u22072F is a positive definite matrix at {mi, \u03c7ij}.\nProof. We define mi(t) := mi and \u03c7ij(t) := t\u03c7ij + (1 \u2212 t)mimj . Then {mi(t), \u03c7ij(t)} \u2208 L(G) and {mi(1), \u03c7ij(1)} = {mi, \u03c7ij}. For t \u2208 [0, 1], we define U(t) and \u22072F (t) in the same way by {mi(t), \u03c7ij(t)}. We see that U(t) = tU . Since Spec(UM) \u2282 C\\R\u22651, we have det(I\u2212tUM) 6= 0 \u2200t \u2208 [0, 1]. From Theorem 3, det(\u22072F (t)) 6= 0 holds on this interval. Using (14) and \u03c7ij(0) = mi(0)mj(0), we can check that \u22072F (0) is positive definite. Since the eigenvalues of \u22072F (t) are real and continuous with respect t, the eigenvalues of \u22072F (1) must be positive reals.\nWe define the symmetrization of ui\u2192j and uj\u2192i by\n\u03b2i\u2192j = \u03b2j\u2192i := \u03c7ij \u2212mimj\n{(1\u2212m2i )(1\u2212m 2 j)}\n1/2 =\nCovbij [xi, xj ]\n{Varbi [xi]Varbj [xj ]} 1/2\n. (15)\nThus, ui\u2192juj\u2192i = \u03b2i\u2192j\u03b2j\u2192i. Since \u03b2i\u2192j = \u03b2j\u2192i, we sometimes abbreviate \u03b2i\u2192j as \u03b2ij . From the final expression, we see that |\u03b2ij | < 1. Define diagonal matrices Z and B by (Z)e,e\u2032 := \u03b4e,e\u2032(1\u2212m 2 t(e)) 1/2 and (B)e,e\u2032 := \u03b4e,e\u2032\u03b2e respectively. Then we have ZUMZ\u22121 = BM, because\n(ZUMZ\u22121)e,e\u2032 = (1\u2212m 2 t(e)) 1/2ue(M)e,e\u2032(1 \u2212m 2 o(e)) \u22121/2 = \u03b2e(M)e,e\u2032 .\nTherefore Spec(UM) = Spec(BM).\nThe following corollary gives a more explicit condition of the region where the Hessian is positive definite in terms of the correlation coefficients of the pseudomarginals. Corollary 1. Let \u03b1 be the Perron Frobenius eigenvalue of M and define L\u03b1\u22121(G) := {{mi, \u03c7ij} \u2208 L(G)||\u03b2e| < \u03b1 \u22121 for all e \u2208 ~E}. Then, the Hessian \u22072F is positive definite on L\u03b1\u22121(G).\nProof. Since |\u03b2e| < \u03b1\u22121, we have \u03c1(BM) < \u03c1(\u03b1\u22121M) = 1 ([12] Theorem 8.1.18). Therefore Spec(BM) \u2229 R\u22651 = \u03c6.\nAs is seen from (11), \u03b1\u22121 is the distance from the origin to the nearest pole of Ihara\u2019s zeta \u03b6G(u). From example 1, we see that \u03b6G(u) = 1 for a tree G and \u03b6CN (u) = (1\u2212 u\nN )\u22122 for a 1-cycle graph CN . Therefore \u03b1\u22121 is \u221e and 1 respectively. In these cases, L\u03b1\u22121(G) = L(G) and F is a strictly convex function on L(G), because |\u03b2e| < 1 always holds. This reproduces the results shown in [11]. In general, using Theorem 8.1.22 of [12], we have mini\u2208V di \u2212 1 \u2264 \u03b1 \u2264 maxi\u2208V di \u2212 1.\nTheorem 3 is also useful to show non-convexity. Corollary 2. Let {mi(t) := 0, \u03c7ij(t) := t} \u2208 L(G) for t < 1. Then we have\nlim t\u21921\ndet(\u22072F (t))(1 \u2212 t)M+N\u22121 = \u22122\u2212M\u2212N+1(M \u2212N)\u03ba(G), (16)\nwhere \u03ba(G) is the number of spanning trees in G. In particular, F is never convex on L(G) for any connected graph with at least two linearly independent cycles, i.e. M \u2212N \u2265 1.\nProof. The equation (16) is obtained by Hashimoto\u2019s theorem [13], which gives the u \u2192 1 limit of the Ihara zeta function. (See supplementary material for the detail.) If M \u2212 N \u2265 1, the right hand side of (16) is negative. As approaches to {mi = 0, \u03c7ij = 1} \u2208 L(G), the determinant of the Hessian diverges to \u2212\u221e. Therefore the Hessian is not positive definite near the point.\nSummarizing the results in this section, we conclude that F is convex on L(G) if and only if G is a tree or a graph with one cycle. To the best of our knowledge, this is the first proof of this fact."}, {"heading": "5 Application to stability analysis", "text": "In this section we discuss the local stability of LBP and the local structure of the Bethe free energy around a LBP fixed point. Heskes [6] shows that a locally stable fixed point of sufficiently damped LBP is a local minima of the Bethe free energy. The converse is not necessarily true in general, and we will elucidate the gap between these two properties.\nFirst, we regard the LBP update as a dynamical system. Since the model is binary, each message \u00b5i\u2192j(xj) is parametrized by one parameter, say \u03b7i\u2192j . The state of LBP algorithm is expressed by \u03b7 = (\u03b7e)e\u2208 ~E \u2208 C( ~E), and the update rule (2) is identified with a transform T on C( ~E), \u03b7new = T (\u03b7). Then, the set of fixed points of LBP is {\u03b7\u221e \u2208 C( ~E)|T (\u03b7\u221e) = \u03b7\u221e}.\nA fixed point \u03b7\u221e is called locally stable if LBP starting with a point sufficiently close to \u03b7\u221e converges to \u03b7\u221e. The local stability is determined by the linearizion T \u2032 around the fixed point. As is discussed in [14], \u03b7\u221e is locally stable if and only if Spec(T \u2032(\u03b7\u221e)) \u2282 {\u03bb \u2208 C||\u03bb| < 1}.\nTo suppress oscillatory behaviors of LBP, damping of update T\u01eb := (1 \u2212 \u01eb)T + \u01ebI is sometimes useful, where 0 \u2264 \u01eb < 1 is a damping strength and I is the identity. A fixed point is locally stable with some damping if and only if Spec(T \u2032(\u03b7\u221e)) \u2282 {\u03bb \u2208 C|Re\u03bb < 1}.\nThere are many representations of the linearization (derivative) of LBP update (see [14, 15]), we choose a good coordinate following Furtlehner et al [16]. In section 4 of [16], they transform messages as \u00b5i\u2192j \u2192 \u00b5i\u2192j/\u00b5\u221ei\u2192j and functions as \u03c8ij \u2192 bij/(bibj) and \u03c8i \u2192 bi, where \u00b5 \u221e i\u2192j is the message of the fixed point. This changes only the representations of messages and functions, and does not affect LBP essentially. This transformation causes T \u2032(\u03b7\u221e) \u2192 P T \u2032(\u03b7\u221e)P\u22121 with an invertible matrix P . Using this transformation, we see that the following fact holds. (See supplementary material for the detail.)\nTheorem 5 ([16], Proposition 4.5). Let ui\u2192j be given by (3), (5) and (13) at a LBP fixed point \u03b7\u221e. The derivative T \u2032(\u03b7\u221e) is similar to UM, i.e. UM = P T \u2032(\u03b7\u221e)P\u22121 with an invertible matrix P .\nSince det(I \u2212 T \u2032 (\u03b7\u221e)) = det(I \u2212 UM), the formula in Theorem 3 implies a direct link between the linearization T \u2032\n(\u03b7\u221e) and the local structure of the Bethe free energy. From Theorem 4, we have that a fixed point of LBP is a local minimum of the Bethe free energy if Spec(T \u2032(\u03b7\u221e)) \u2282 C\\R\u22651.\nIt is now clear that the condition for positive definiteness, local stability of damped LBP and local stability of undamped LBP are given in terms of the set of eigenvalues, C \\R\u22651, {\u03bb \u2208 C|Re\u03bb < 1} and {\u03bb \u2208 C||\u03bb| < 1} respectively. A locally stable fixed point of sufficiently damped LBP is a local minimum of the Bethe free energy, because {\u03bb \u2208 C|Re\u03bb < 1} is included in C \\ R\u22651. This reproduces Heskes\u2019s result [6]. Moreover, we see the gap between the locally stable fixed points with some damping and the local minima of the Bethe free energy: if Spec(T \u2032(\u03b7\u221e)) is included in C \\ R\u22651 but not in {\u03bb \u2208 C|Re\u03bb < 1}, the fixed point is a local minimum of the Bethe free energy though it is not a locally stable fixed point of LBP with any damping.\nIt is interesting to ask under which condition a local minimum of the Bethe free energy is a stable fixed point of (damped) LBP. While we do not know a complete answer, for an attractive model, which is defined by Jij \u2265 0, the following theorem implies that if a stable fixed point becomes unstable by changing Jij and hi, the corresponding local minimum also disappears.\nTheorem 6. Let us consider continuously parametrized attractive models {\u03c8ij(t), \u03c8i(t)}, e.g. t is a temperature: \u03c8ij(t) = exp(t\u22121Jijxixj) and \u03c8i(t) = exp(t\u22121hixi). For given t, run LBP algorithm and find a (stable) fixed point. If we continuously change t and see the LBP fixed point becomes unstable across t = t0, then the corresponding local minimum of the Bethe free energy becomes a saddle point across t = t0.\nProof. From (3), we see bij(xi, xj) \u221d exp(Jijxixj + \u03b8ixi + \u03b8jxj) for some \u03b8i and \u03b8j . From Jij \u2265 0, we have Covbij [xi, xj ] = \u03c7ij \u2212mimj \u2265 0, and thus ui\u2192j \u2265 0. When the LBP fixed point becomes unstable, the Perron Frobenius eigenvalue of UM goes over 1, which means det(I\u2212UM) crosses 0. From Theorem 3 we see that det(\u22072F ) becomes positive to negative at t = t0.\nTheorem 6 extends Theorem 2 of [14], which discusses only the case of vanishing local fields hi = 0 and the trivial fixed point (i.e. mi = 0)."}, {"heading": "6 Application to uniqueness of LBP fixed point", "text": "The uniqueness of LBP fixed point is a concern of many studies, because the property guarantees that LBP finds the global minimum of the Bethe free energy if it converges. The major approaches to the uniqueness is to consider equivalent minimax problem [5], contraction property of LBP dynamics [17, 18], and to use the theory of Gibbs measure [19]. We will propose a different, differential topological approach to this problem.\nIn our approach, in combination with Theorem 3, the following theorem is the basic apparatus.\nTheorem 7. If det\u22072F (q) 6= 0 for all q \u2208 (\u2207F )\u22121(0) then\n\u2211\nq:\u2207F (q)=0\nsgn ( det\u22072F (q) ) = 1, where sgn(x) :=\n{\n1 if x > 0, \u22121 if x < 0.\nWe call each summand, which is +1 or \u22121, the index of F at q.\nNote that the set (\u2207F )\u22121(0), which is the stationary points of the Bethe free energy, coincides with the fixed points of LBP. The above theorem asserts that the sum of indexes of all the fixed points must be one. As a consequence, the number of the fixed points of LBP is always odd. Note also that the index is a local quantity, while the assertion expresses the global structure of the function F .\nFor the proof of Theorem 7, we prepare two lemmas. The proof of Lemma 1 is shown in the supplementary material. Lemma 2 is a standard result in differential topology, and we refer [20] Theorem 13.1.2 and comments in p.104 for the proof.\nLemma 1. If a sequence {qn} \u2282 L(G) converges to a point q\u2217 \u2208 \u2202L(G), then \u2016\u2207F (qn)\u2016 \u2192 \u221e, where \u2202L(G) is the boundary of L(G) \u2282 RN+M .\nLemma 2. Let M1 and M2 be compact, connected and orientable manifolds with boundaries. Assume that the dimensions of M1 and M2 are the same. Let f : M1 \u2192 M2 be a smooth map satisfying f(\u2202M1) \u2282 \u2202M2. For a regular value of p \u2208 M2, i.e. det(\u2207f(q)) 6= 0 for all q \u2208 f\u22121(p), we define the degree of the map f by deg f := \u2211\nq\u2208f\u22121(p) sgn(det\u2207f(q)). Then deg f does not depend on the choice of a regular value p \u2208 M2.\nSketch of proof. Define a map \u03a6 : L(G) \u2192 RN+M by \u03a6 := \u2207F + ( h\nJ\n)\n. Note that \u03a6 does not depend on h and J as seen from (6). Then it is enough to prove\n\u2211\nq\u2208\u03a6\u22121((hJ))\nsgn(det\u2207\u03a6(q)) = \u2211\nq\u2208\u03a6\u22121(0)\nsgn(det\u2207\u03a6(q)), (17)\nbecause \u03a6\u22121(0) has a unique element {mi = 0, \u03c7ij = 0}, at which \u22072F is positive definite, and the right hand side of (45) is equal to one. Define a sequence of manifolds {Cn} by Cn := {q \u2208 L(G)| \u2211\nij\u2208E\n\u2211\nxi,xj \u2212 log bij \u2264 n}, which increasingly converges to L(G). Take K > 0 and \u01eb > 0\nto satisfy K \u2212 \u01eb > \u2016 ( h J ) \u2016. From Lemma 1, for sufficiently large n0, we have \u03a6\u22121(0),\u03a6\u22121 ( h J )\n\u2282 Cn0 and \u03a6(\u2202Cn0) \u2229 B0(K) = \u03c6, where B0(K) is the closed ball of radius K at the origin. Let \u03a0\u01eb : R\nN+M \u2192 B0(K) be a smooth map that is the identity on B0(K\u2212\u01eb), monotonically increasing on \u2016x\u2016, and \u03a0\u01eb(x) = K\u2016x\u2016x for \u2016x\u2016 \u2265 K . We obtain a map \u03a6\u0303 := \u03a0\u01eb \u25e6\u03a6 : Cn0 \u2192 B0(K) such that\n\u03a6\u0303(\u2202Cn0) \u2282 \u2202B0(K). Applying Lemma 2 yields (45).\nIf we can guarantee that the index of every fixed point is +1 in advance of running LBP, we conclude that fixed point of LBP is unique. We have the following a priori information for \u03b2.\nLemma 3. Let \u03b2ij be given by (15) at any fixed point of LBP. Then |\u03b2ij | \u2264 tanh(|Jij |) and sgn(\u03b2ij) = sgn(Jij) hold.\nProof. From (3), we see that bij(xi, xj) \u221d exp(Jijxixj + \u03b8ixi + \u03b8jxj) for some \u03b8i and \u03b8j . With (15) and straightforward computation, we obtain \u03b2ij = sinh(2Jij)(cosh(2\u03b8i) + cosh(2Jij)) \u22121/2(cosh(2\u03b8j)+cosh(2Jij)) \u22121/2. The bound is attained when \u03b8i = 0 and \u03b8j = 0.\nFrom Theorem 7 and Lemma 3, we can immediately obtain the uniqueness condition in [18], though the stronger contractive property is proved under the same condition in [18].\nCorollary 3 ([18]). If \u03c1(JM) < 1, then the fixed point of LBP is unique, where J is a diagonal matrix defined by Je,e\u2032 = tanh(|Je|)\u03b4e,e\u2032 .\nProof. Since |\u03b2ij | \u2264 tanh(|Jij |), we have \u03c1(BM) \u2264 \u03c1(JM) < 1. ([12] Theorem 8.1.18.) Then det(I \u2212BM) = det(I \u2212UM) > 0 implies that the index of any LBP fixed point must be +1.\nIn the proof of the above corollary, we only used the bound of modulus. In the following case of Corollary 4, we can utilize the information of signs. To state the corollary, we need a terminology. The interactions {Jij , hi} and {J \u2032ij , h \u2032 i} are said to be equivalent if there exists (si) \u2208 {\u00b11}\nV such that J \u2032ij = Jijsisj and h \u2032 i = hisi. Since an equivalent model is obtained by gauge transformation xi \u2192 xisi, the uniqueness property of LBP for equivalent models is unchanged.\nCorollary 4. If the number of linearly independent cycle of G is two (i.e. M \u2212N +1 = 2), and the interaction is not equivalent to attractive model, then the LBP fixed point is unique.\nThe proof is shown in the supplementary material. We give an example to illustrate the outline.\nExample 2. Let V := {1, 2, 3, 4} and E := {12, 13, 14, 23, 34}. The interactions are given by arbitrary {hi} and {\u2212J12, J13, J14, J23, J34} with Jij \u2265 0. See figure 1. It is enough to check that det(I \u2212 BM) > 0 for arbitrary 0 \u2264 \u03b213, \u03b223, \u03b214, \u03b234 < 1 and \u22121 < \u03b212 \u2264 0. Since the prime cycles ofG bijectively correspond to those of G\u0302 (in figure 2), we have det(I\u2212BM) = det(I\u2212B\u0302M\u0302), where \u03b2\u0302e1 = \u03b212\u03b223, \u03b2\u0302e2 = \u03b213, and \u03b2\u0302e3 = \u03b234. We see that det(I \u2212 B\u0302M\u0302) = (1 \u2212 \u03b2\u0302e1 \u03b2\u0302e2 \u2212 \u03b2\u0302e1 \u03b2\u0302e3 \u2212 \u03b2\u0302e2 \u03b2\u0302e3 \u2212 2\u03b2\u0302e1 \u03b2\u0302e2 \u03b2\u0302e3)(1\u2212 \u03b2\u0302e1 \u03b2\u0302e2 \u2212 \u03b2\u0302e1 \u03b2\u0302e3 \u2212 \u03b2\u0302e2 \u03b2\u0302e3 +2\u03b2\u0302e1 \u03b2\u0302e2 \u03b2\u0302e3) > 0. In other cases, we can reduce to the graph G\u0302 or the graphs in figure 3 similarly (see the supplementary material).\nFor attractive models, the fixed point of the LBP is not necessarily unique.\nFor graphs with multiple cycles, all the existing results on uniqueness make assumptions that upperbound |Jij | essentially. In contrast, Corollary 4 applies to arbitrary strength of interactions if the graph has two cycles and the interactions are not attractive. It is noteworthy that, from Corollary 2, the Bethe free energy is non-convex in the situation of Corollary 4, while the fixed point is unique."}, {"heading": "7 Concluding remarks", "text": "For binary pairwise models, we show the connection between the edge zeta function and the Bethe free energy in Theorem 3, in the proof of which the multi-variable version of Ihara\u2019s formula (Theorem 2) is essential. After the initial submission of this paper, we found that Theorem 3 is extended to a more general class of models including multinomial models and Gaussian models represented by arbitrary factor graphs. We will discuss the extended formula and its applications in a future paper.\nSome recent researches on LBP have suggested the importance of zeta function. In the context of the LDPC code, which is an important application of LBP, Koetter et al [21, 22] show the connection between pseudo-codewords and the edge zeta function. On the LBP for the Gaussian graphical model, Johnson et al [23] give zeta-like product formula of the partition function. While these are not directly related to our work, pursuing covered connections is an interesting future research topic."}, {"heading": "Acknowledgements", "text": "This work was supported in part by Grant-in-Aid for JSPS Fellows 20-993 and Grant-in-Aid for Scientific Research (C) 19500249."}, {"heading": "Supplementary Material for", "text": "\u201cGraph Zeta Function in the Bethe Free Energy and"}, {"heading": "Loopy Belief Propagation\u201d", "text": ""}, {"heading": "Yusuke Watanabe and Kenji Fukumizu, NIPS 2009", "text": ""}, {"heading": "A Proof of Theorem 2", "text": "Proof. First, we define three linear operators O : C(V ) \u2192 C( ~E), T \u2217 : C( ~E) \u2192 C(V ), and \u03b9 : C( ~E) \u2192 C( ~E) as follows:\n(Of)(e) := f(o(e)), (T \u2217g)(i) := \u2211\ne\u2208~E,t(e)=i\ng(e), (\u03b9g)(e) := g(e\u0304) where f \u2208 C(V ) and g \u2208 C( ~E).\nWe see that M = OT \u2217 \u2212 \u03b9, because\n( (OT \u2217 \u2212 \u03b9)g ) (e) = \u2211\ne\u2032\u2208 ~E,t(e\u2032)=o(e)\ng(e\u2032) \u2212 g(e\u0304) = (Mg)(e) for g \u2208 C( ~E).\nThen we have\ndet(I \u2212 UM) = det ( I \u2212 UOT \u2217(I + U\u03b9)\u22121 ) det(I + U\u03b9)\n= det ( I \u2212 T \u2217(I + U\u03b9)\u22121UO ) det(I + U\u03b9).\nIn the second equality, we used det(In \u2212 AB) = det(Im \u2212 BA) for n \u00d7 m and m \u00d7 n matrices A and B ([24], Lemma 8.2.4). The linear operator \u03b9 is a block diagonal matrix with standard basis. The (e, e\u0304) block of I + U\u03b9 is\n[\n1 ue ue\u0304 1\n]\n.\nTherefore, we have det(I + U\u03b9) = \u220f\n[e]\u2208E(1\u2212 ueue\u0304).\nFinally, we check that T \u2217(I + U\u03b9)\u22121UO = A\u0302 \u2212 D\u0302. The matrix (I + U\u03b9)\u22121 is a block diagonal matrix with (e, e\u0304) block\n1\n1\u2212 ueue\u0304\n[\n1 \u2212ue \u2212ue\u0304 1\n]\n. (18)\nFor f \u2208 C(V ), we have (\nT \u2217(I + U\u03b9)\u22121UOf ) (i) = \u2211\ne\u2208 ~E,t(e)=i\n( (I + U\u03b9)\u22121UOf ) (e)\n= \u2211\ne\u2208 ~E,t(e)=i\n1\n1\u2212 ueue\u0304\n( (UOf)(e) \u2212 ue(UOf)(e\u0304) )\n= \u2211\ne\u2208 ~E,t(e)=i\n1\n1\u2212 ueue\u0304\n( uef(o(e))\u2212 ueue\u0304f(o(e\u0304)) )\n= (A\u0302f)(i)\u2212 (D\u0302f)(i)."}, {"heading": "B Proof of Theorem 3", "text": "B.1 Explicit formula of derivatives of the Bethe free energy\nIn the proof of Theorem 3, the graph G = (V,E) is assumed to be a simple graph, i.e., there is no multiple edges and loop-edge\nFor the proof, we need explicit expressions of the second derivatives of the Bethe free energy. We list them below.\nThe first derivatives of the Bethe Free Energy are \u2202F\n\u2202mi = \u2212hi + (1\u2212 di)\n1\n2\n\u2211\nxi=\u00b11\nxi log bi(xi) + 1\n4\n\u2211\nk\u2208Ni\n\u2211\nxi,xk=\u00b11\nxi log bik(xi, xk), (19)\n\u2202F\n\u2202\u03c7ij = \u2212Jij +\n1\n4\n\u2211\nxi,xj=\u00b11\nxixj log bij(xi, xj). (20)\nThe second derivatives of the Bethe Free Energy are\n\u22022F\n\u2202mi\u2202mj =\n\n \n \n(1 \u2212 di) 1 1\u2212m2i + 14\n\u2211\nk\u2208Ni\n\u2211\nxi,xk 1 1+mixi+mkxk+\u03c7ikxixk if i = j,\n1 4\n\u2211\nxi,xj xixj 1+mixi+mjxj+\u03c7ijxixj if i and j are adjacent (i 6= j),\n0 otherwise,\n(21)\n\u22022F\n\u2202mk\u2202\u03c7ij =\n\n \n \n1 4\n\u2211\nxi,xj xj 1+mixi+mjxj+\u03c7ijxixj\nif k = i, 1 4 \u2211 xi,xj xi 1+mixi+mjxj+\u03c7ijxixj if k = j, 0 otherwise,\n(22)\n\u22022F\n\u2202\u03c7ij\u2202\u03c7kl =\n{\n1 4\n\u2211\nxixj 1 1+mixi+mjxj+\u03c7ijxixj if ij = kl,\n0 otherwise. (23)\nWe use notations\nrij := 1\n4\n\u2211\nxi,xj\n1\n1 +mixi +mjxj + \u03c7ijxixj , (24)\nsij := 1\n4\n\u2211\nxi,xj\nxj 1 +mixi +mjxj + \u03c7ijxixj , (25)\ntij := 1\n4\n\u2211\nxi,xj\nxixj 1 +mixi +mjxj + \u03c7ijxixj . (26)\nNote that rij = rji and tij = tji, but sij 6= sji in general."}, {"heading": "B.2 Detailed proof of Theorem 3", "text": "Proof. First, note that the Hessian of the Bethe free energy is a square matrix of size N +M :\n\u22072F ({mi, \u03c7ij}) :=\n\n\n(\n\u22022F \u2202mi\u2202mj\n) (\n\u22022F \u2202mi\u2202\u03c7st\n)\n(\n\u22022F \u2202\u03c7uv\u2202mj\n) (\n\u22022F \u2202\u03c7uv\u2202\u03c7st\n)\n\n .\nRecall that N is the number of vertices and M is the number of undirected edges.\nStep1: Computation of Y From (23), the (E,E)-block of the Hessian is a diagonal matrix given by\n\u22022F\n\u2202\u03c7ij\u2202\u03c7kl = \u03b4ij,klrij .\nUsing this diagonal block, we erase (V,E)-block and (E,V)-block of the Hessian. Thus, we obtain a square matrix X such that detX = 1 and\nXT (\u22072F )X =\n[\nY 0 0 (\n\u22022F \u2202\u03c7ij\u2202\u03c7kl\n)\n]\n.\nApplying an identity\n\n \n1 0 \u2212sij rij 0 1 \u2212sji rij 0 0 1\n\n \n\n wi tij sij tij wj sji sij sji rij\n\n\n\n\n1 0 0 0 1 0\n\u2212sij rij \u2212sji rij 1\n\n =\n\n  \nwi \u2212 s2ij\nrij tij \u2212\nsijsji\nrij 0\ntij \u2212 sijsji\nrij wj \u2212\ns2ji rij 0\n0 0 rij\n\n  \nfor each edge, we have\n(Y )i,j =\n\n \n \n(1\u2212 di) 1 1\u2212m2i + \u2211 k\u2208Ni (rik \u2212 s2ik rik ) if i = j, tij \u2212 sijsji rij if i and j are adjacent , 0 otherwise.\nThe elements of Y are represented in terms of {mi, \u03c7ij} as follows:\n(Y )i,i = 1\n1\u2212m2i +\n\u2211\nk\u2208Ni\n(rik \u2212 s2ik rik \u2212 1 1\u2212m2i )\n= 1\n1\u2212m2i +\n\u2211\nk\u2208Ni\n(\u03c7ik \u2212mimk) 2\n(1\u2212m2i )(1 \u2212m 2 i \u2212m 2 k + 2mimk\u03c7ik \u2212 \u03c7 2 ik)\nand,\n(Y )i,j = tij \u2212 sijsji rij\n= \u2212(\u03c7ij \u2212mimj)\n(1\u2212m2i \u2212m 2 j + 2mimj\u03c7ij \u2212 \u03c7 2 ij)\nfor adjacent i and j.\nStep2: Computation of IN + D\u0302 \u2212 A\u0302 From the definition (13) of uj\u2192i, we see that\nui\u2192juj\u2192i 1\u2212 ui\u2192juj\u2192i = (\u03c7ij \u2212mimj)\n2\n(1\u2212m2i \u2212m 2 j + 2mimj\u03c7ij \u2212 \u03c7 2 ij)\n,\nui\u2192j 1\u2212 ui\u2192juj\u2192i = (1\u2212m2i )(\u03c7ij \u2212mimj) (1\u2212m2i \u2212m 2 j + 2mimj\u03c7ij \u2212 \u03c7 2 ij) .\nTherefore, the diagonal element is\n(IN + D\u0302 \u2212 A\u0302)i,i = (IN + D\u0302)i,i = 1 + \u2211\nk\u2208Ni\nui\u2192kuk\u2192i 1\u2212 ui\u2192kuk\u2192i\n= 1 + \u2211\nk\u2208Ni\n(\u03c7ik \u2212mimk) 2\n(1\u2212m2i \u2212m 2 k + 2mimk\u03c7ik \u2212 \u03c7 2 ik)\n,\nand for adjacent i and j,\n(IN + D\u0302 \u2212 A\u0302)i,j = \u2212(A\u0302)i,j = \u2212uj\u2192i\n1\u2212 ui\u2192juj\u2192i\n= \u2212(1\u2212m2j)(\u03c7ij \u2212mimj)\n(1 \u2212m2i \u2212m 2 j + 2mimj\u03c7ij \u2212 \u03c7 2 ij)\n.\nCombining the results of step 1 and 2, we have\nIN + D\u0302 \u2212 A\u0302 = Y\n\n   1\u2212m21 0 . . . 0 0 1\u2212m22 . . . 0 ... ... . . .\n... 0 0 . . . 1\u2212m2N\n\n   .\nStep3: Final step We see that\n\u03b6G(u) \u22121 = det(I \u2212 UM) (27)\n= det(IN + D\u0302 \u2212 A\u0302) \u220f\n[e]\u2208E\n(1\u2212 ueue\u0304) (28)\n= det(Y ) \u220f\ni\u2208V\n(1\u2212m2i ) \u220f\n[e]\u2208E\n(1\u2212 ueue\u0304)\n= det(\u22072F ) \u220f\ni\u2208V\n(1 \u2212m2i ) \u220f\nij\u2208E\n1\u2212 ui\u2192juj\u2192i rij\n= det(\u22072F ) \u220f\ni\u2208V\n(1 \u2212m2i ) 1\u2212di\n\u220f\nij\u2208E\n(1\u2212 ui\u2192juj\u2192i)(1 \u2212m 2 i )(1 \u2212m 2 j)\nrij . (29)\nFrom (27) to (28), we used the edge zeta version of Ihara\u2019s formula (Theorem 2).\nFurthermore, with a straightforward computation we see that\n(1\u2212 ui\u2192juj\u2192i)(1 \u2212m 2 i )(1\u2212m 2 j )\nrij = 44\n\u220f\nxi,xj=\u00b11\nbij(xi, xj),\n(1\u2212m2i ) 1\u2212di = 22\u22122di\n\u220f\nxi=\u00b11\nbi(xi) 1\u2212di ,\nwhere bij(xi, xj) = 14 (1 +mixi +mjxj + \u03c7ijxixj) and bi(xi) = 1 2 (1 +mi).\nTherefore,\n(29) = 2 \u2211 i\u2208V (2\u22122di)44M det(\u22072F ) \u220f\ni\u2208V\n\u220f\nxi=\u00b11\nbi(xi) 1\u2212di\n\u220f\nij\u2208E\n\u220f\nxi,xj=\u00b11\nbij(xi, xj)\n= 22N+4M det(\u22072F ) \u220f\ni\u2208V\n\u220f\nxi=\u00b11\nbi(xi) 1\u2212di\n\u220f\nij\u2208E\n\u220f\nxi,xj=\u00b11\nbij(xi, xj)."}, {"heading": "C Proof of Corollary 2", "text": "Here, we prove the limit formula in Corollary 2.\nProof. We can easily check that ui\u2192j(t) = t, \u220f\nij\u2208E\n\u220f\nxi,xj=\u00b11\nbij(xi, xj) = 4 \u22124M (1 \u2212 t)2M (1 + t)2M , and\n\u220f\ni\u2208V\n\u220f\nxi=\u00b11\nbi(xi) 1\u2212di = 2\u22122N+4M\non this interval. Therefore\nlim t\u21921 det(\u22072F (t))(1 \u2212 t)M+N\u22121 = lim t\u21921 \u03b6G(u(t)) \u22121(1\u2212 t)M+N\u22121\n( 4\u22124M (1\u2212 t)2M (1 + t)2M2\u22122N+4M22N+4M )\u22121\n= lim t\u21921\n\u03b6G(t) \u22121(1\u2212 t)\u2212M+N\u221212\u22122M\n= \u2212(M \u2212N)\u03ba(G)2\u2212M\u2212N+1.\nOn the final equality, we used Hashimoto\u2019s formula:\nlim u\u21921\n\u03b6G(u) \u22121(1 \u2212 u)\u2212M+N\u22121 = \u22122M\u2212N+1(M \u2212N)\u03ba(G).\nWe refer to [13, 25, 26] for this formula."}, {"heading": "D Transformation of messages and proof of Theorem 5", "text": ""}, {"heading": "D.1 Transformation of messages", "text": "First, we make an easy observation on the LBP update.\nProposition 1. Let {\u03c0i\u2192j} be any set of messages. We define a transformation from messages {\u00b5ti\u2192j} to messages {\u00b5\u0303 t i\u2192j} by\n\u00b5\u0303ti\u2192j(xj) \u221d \u00b5ti\u2192j(xj)\n\u03c0i\u2192j(xj) . (30)\nWe also define transformation from functions {\u03c8ij , \u03c8i} to functions {\u03c8\u0303ij , \u03c8\u0303i} by\n\u03c8\u0303ij(xi, xj) \u221d \u03c8ij(xi, xj)\n\u03c0i\u2192j(xj)\u03c0j\u2192i(xi) , (31)\n\u03c8\u0303i(xi) \u221d \u03c8i(xi) \u220f\nk\u2208Ni\n\u03c0k\u2192i(xi). (32)\nThen the update \u00b5t+1i\u2192j(xj) \u221d \u2211\nxi\n\u03c8ji(xj , xi)\u03c8i(xi) \u220f\nk\u2208Ni\\j\n\u00b5tk\u2192i(xi), (33)\nis equivalent to \u00b5\u0303t+1i\u2192j(xj) \u221d \u2211\nxi\n\u03c8\u0303ji(xj , xi)\u03c8\u0303i(xi) \u220f\nk\u2208Ni\\j\n\u00b5\u0303tk\u2192i(xi). (34)\nProof. The equivalence of (33) and (34) is easily checked by (30), (31), and (32).\nSymbolically, Proposition 1 implies that\n\u03a0 \u25e6 T \u25e6\u03a0\u22121 = T\u0303 , (35)\nwhere \u03a0 is the transformation of the messages by \u03c0i\u2192j , T is the LBP update with {\u03c8ij , \u03c8i}, and T\u0303 is the LBP update with {\u03c8\u0303ij , \u03c8\u0303i} . Differentiation of this relation gives the transformation of the linearization matrix.\nIf we choose {\u03c0i\u2192j} as \u03c0i\u2192j(xj) = \u00b5\u221ei\u2192j(xj), then (30), (31) and (32) becomes\n\u00b5\u0303ti\u2192j(xj) \u221d \u00b5ti\u2192j(xj)\n\u00b5\u221ei\u2192j(xj) (36)\n\u03c8\u0303ij(xi, xj) \u221d bij(xi, xj)\nbi(xi)bj(xj) (37)\n\u03c8\u0303i(xi) \u221d bi(xi). (38)\nThis is the transformation used in the paper."}, {"heading": "D.2 Proof of Theorem 5", "text": "Proof. Let {\u00b5\u221ei\u2192j(xj)} be the set of messages at the fixed point and let \u03a0 be the transformation of messages defined by the fixed point messages. We parameterize the messages by \u03b7ti\u2192j = \u00b5ti\u2192j(+)/\u00b5 t i\u2192j(\u2212). It is enough to prove the assertion after the transformation and in this parameterization, because these operations cause similar linearization matrices.\nAfter the transformation, the LBP update is given in terms of \u03b7\u0303 as follows:\n\u03b7\u0303t+1i\u2192j =\n\u2211\nxi \u03c8\u0303ji(+, xi)\u03c8\u0303i(xi)\n\u220f\nk\u2208Ni\\j \u00b5\u0303k\u2192i(xi)\n\u2211\nxi \u03c8\u0303ji(\u2212, xi)\u03c8\u0303i(xi)\n\u220f\nk\u2208Ni\\j \u00b5\u0303k\u2192i(xi)\n=\nbji(+,+) bj(+) \u220f k\u2208Ni\\j \u03b7\u0303k\u2192i(xi) + bji(+,\u2212) bj(+) bji(\u2212,+) bj(\u2212) \u220f k\u2208Ni\\j \u03b7\u0303k\u2192i(xi) + bji(\u2212,\u2212) bj(\u2212) .\nLet \u03b7\u0303\u221e := \u03a0(\u03b7\u221e), then \u03b7\u0303\u221ee = 1 for all e \u2208 ~E. We can compute T\u0303 \u2032(\u03b7\u0303 \u221e) as follows:\nT\u0303 \u2032(\u03b7\u0303\u221e) = \u2202\u03b7\u0303t+1i\u2192j \u2202\u03b7\u0303tk\u2192l \u2223 \u2223 \u2223 \u03b7\u0303t=1\n= (bji(+,+)\nbj(+) \u2212\nbji(\u2212,+)\nbj(\u2212)\n)\nMi\u2192j,k\u2192l\n= \u03c7ij \u2212mimj 1\u2212m2j Mi\u2192j,k\u2192l.\nE Idea and proof of Theorem 7\nE.1 Idea of Theorem 7\nIn Theorem 7, we show that the sum of indexes is equal to one. This is not so special. The simplest example that illustrate the idea of the theorem is sketched in figure 4. For each stationary point, plus or minus sign is assigned depending on the sign of the second derivative. When we deform the function, the sum is still equal to one as long as the outward gradients are positive at the boundaries. (See figure 5.)\nLemma 1, combined with Lemma 2, describes the behavior of the Bethe free energy near the boundary of L(G)."}, {"heading": "E.2 Proof of Lemma 1", "text": "Proof. First, note that it is enough to prove the assertion when hi = 0 and Jij = 0.\nWe prove by contradiction. Assume that \u2016\u2207F (qn)\u2016 6\u2192 \u221e. Then, there exists R > 0 such that \u2016\u2207F (qn)\u2016 \u2264 R for infinitely many n. Let B0(R) be the closed ball of radius R centered at the origin. Taking subsequences, if necessary, we can assume that\n\u2207F (qn) \u2192 \u2203\n(\n\u03be\n\u03b7\n)\n\u2208 B0(R), (39)\nbecause of the compactness of B0(R). Let b (n) ij (xi, xj) and b (n) i (xi) be the pseudomarginals corresponding to qn. Since qn \u2192 q\u2217 \u2208 \u2202L(G), there exist ij \u2208 E, xi and xj such that\nb (n) ij (xi, xj) \u2192 0.\nWithout loss of generality, we assume that xi = +1 and xj = +1. From (39), we have\n\u2207F (qn)ij = 1\n4 log\nb (n) ij (+,+)b (n) ij (\u2212,\u2212) b (n) ij (+,\u2212)b (n) ij (\u2212,+) \u2212\u2192 \u03b7ij . (40)\nTherefore b(n)ij (+,\u2212) \u2192 0 or b (n) ij (\u2212,+) \u2192 0 holds; we assume b (n) ij (+,\u2212) \u2192 0 without loss of generality. Now we have\nb (n) i (+) = b (n) ij (+,\u2212) + b (n) ij (+,+) \u2192 0.\nIn this situation, the following claim holds.\nClaim. Let k \u2208 Ni. In the limit of n \u2192 \u221e,\n\u2211\nxi,xk=\u00b11\nxi log b (n) ik (xi, xk)\nb (n) i (xi)\n= log\n[\nb (n) ik (+,+)b (n) ik (+,\u2212)b (n) i (\u2212) 2 b (n) ik (\u2212,+)b (n) ik (\u2212,\u2212)b (n) i (+) 2\n]\n(41)\nconverges to a finite value.\nproof of claim. From b(n)i (+) \u2192 0, we have\nb (n) ik (+,\u2212), b (n) ik (+,+) \u2212\u2192 0 and b (n) i (\u2212) \u2192 1.\nCase 1: b(n)ik (\u2212,+) \u2212\u2192 b \u2217 ik(\u2212,+) 6= 0 and b (n) ik (\u2212,\u2212) \u2212\u2192 b \u2217 ik(\u2212,\u2212) 6= 0. In the same way as (40),\n\u2207F (qn)ik = 1\n4 log\nb (n) ik (+,+)b (n) ik (\u2212,\u2212) b (n) ik (+,\u2212)b (n) ik (\u2212,+) \u2212\u2192 \u03b7ik.\nTherefore b (n) ik (+,+)\nb (n) ik (+,\u2212)\n\u2212\u2192 \u2203r 6= 0.\nThen we see that (41) converges to a finite value.\nCase 2: b(n)ik (\u2212,+) \u2212\u2192 1 and b (n) ik (\u2212,\u2212) \u2212\u2192 0. Similar to the case 1, we have\nb (n) ik (+,+)b (n) ik (\u2212,\u2212)\nb (n) ik (+,\u2212)\n\u2212\u2192 \u2203r 6= 0.\nTherefore b (n) ik (+,\u2212)\nb (n) ik\n(+,+) \u2192 0. This implies that b\n(n) i (+)\nb (n) ik\n(+,+) \u2192 1. Then we see that (41) converges to a\nfinite value.\nCase 3: b(n)ik (\u2212,+) \u2212\u2192 0 and b (n) ik (\u2212,\u2212) \u2212\u2192 1. Same as the case 2.\nNow let us get back to the proof of Lemma 1. We rewrite (19) as\n\u2207F (qn)i = 1\n2 log b\n(n) i (+)\u2212\n1 2 log b (n) i (\u2212) + 1 4 \u2211\nk\u2208Ni\n\u2211\nxi,xk=\u00b11\nxi log b (n) ik (xi, xk)\nb (n) i (xi)\n(42)\nFrom (39), this value converges to \u03bei. The second and the third terms in (42) converges to a finite value, while the first value converges to infinite. This is a contradiction."}, {"heading": "E.3 Detailed proof of Theorem 7", "text": "Proof. Define a map \u03a6 : L(G) \u2192 RN+M by\n\u03a6(q)i = (1\u2212 di) 1\n2\n\u2211\nxi=\u00b11\nxi log bi(xi) + 1\n4\n\u2211\nk\u2208Ni\n\u2211\nxi,xk=\u00b11\nxi log bik(xi, xk), (43)\n\u03a6(q)ij = 1\n4\n\u2211\nxi,xj=\u00b11\nxixj log bij(xi, xj), (44)\nwhere bij(xi, xj) and bi(xi) are given by q = {mi, \u03c7ij} \u2208 L(G). Therefore, we have \u2207F = \u03a6\u2212 ( h\nJ\n)\nand \u2207\u03a6 = \u22072F . Then following claim holds.\nFigure 6: The graph G.\nFigure 7: The graph G\u0302.\nClaim. The sets \u03a6\u22121( ( h\nJ\n)\n),\u03a6\u22121(0) \u2282 L(G) are finite and\n\u2211\nq\u2208\u03a6\u22121( h J )\nsgn(det\u2207\u03a6(q)) = \u2211\nq\u2208\u03a6\u22121(0)\nsgn(det\u2207\u03a6(q)), (45)\nholds.\nBefore the proof of this claim, we prove Theorem 7 under the claim.\nFrom (43) and (44), it is easy to see that \u03a6(q) = 0 \u21d4 q = {mi = 0, \u03c7ij = 0}. At this point, we can easily check that \u2207\u03a6 = \u22072F is a positive definite matrix. Therefore the right hand side of (45) is equal to one. The left hand side of (45) is equal to the left hand side of (??), because q \u2208 \u03a6\u22121( (\nh J\n)\n) \u21d4 \u2207F (q) = 0. Then the assertion of Theorem 7 is proved.\nProof of the claim. First, we prove that\u03a6\u22121( ( h\nJ\n)\n) = (\u2207F )\u22121(0) is a finite set. If not, we can choose\na sequence {qn} of distinct points from this set. Let L(G) be the closure of L(G). Since L(G) is compact, we can choose a subsequence that converges to some point q\u2217 \u2208 L(G). From Lemma 1, q\u2217 \u2208 L(G) and \u2207F (q\u2217) = 0 hold. By the assumption in Theorem 7, we have det\u22072F (q\u2217) 6= 0. This implies that \u2207F (q) 6= 0 in some neighborhood of q\u2217. This is a contradiction because qn \u2192 q\u2217.\nSecondly, we prove the equality (45) using Lemma 2. Define a sequence of compact convex sets Cn := {q \u2208 L(G)| \u2211\nij\u2208E\n\u2211\nxi,xj \u2212 log bij \u2264 n}, which increasingly converges to L(G). Since\n\u03a6\u22121(0) and \u03a6\u22121 ( h\nJ\n)\nare finite, they are included in Cn for sufficiently large n. Take K > 0 and \u01eb > 0 to satisfy K \u2212 \u01eb > \u2016 (\nh J\n)\n\u2016. From Lemma 1, we see that \u03a6(\u2202Cn)\u2229B0(K) = \u03c6 for sufficiently large n. Let no be such a large number. Let \u03a0\u01eb : RN+M \u2192 B0(K) be a smooth map that is identity on B0(K \u2212 \u01eb), monotonically increasing on \u2016x\u2016, and \u03a0\u01eb(x) = K\u2016x\u2016x for \u2016x\u2016 \u2265 K . Then we obtain\na composition map \u03a6\u0303 := \u03a0\u01eb \u25e6 \u03a6 : Cn0 \u2192 B0(K) that satisfy \u03a6\u0303(\u2202Cn0) \u2282 \u2202B0(K). By definition, we have \u03a6\u22121(0) = \u03a6\u0303\u22121(0) and \u03a6\u22121 (\nh J\n) = \u03a6\u0303\u22121 ( h J ) . Therefore, both 0 and ( h J )\nare regular values of \u03a6\u0303. From Lemma 2, we have\n\u2211\nq\u2208\u03a6\u0303\u22121( h J )\nsgn(det\u2207\u03a6\u0303(q)) = \u2211\nq\u2208\u03a6\u0303\u22121(0)\nsgn(det\u2207\u03a6\u0303(q)).\nThen, the assertion of the claim is proved."}, {"heading": "F Proof of Corollary 4", "text": ""}, {"heading": "F.1 Detailed proof of Example 2", "text": "In this subsection we prove the assertion of Corollary 4 for the graph of Example 2, which is displayed in figure 6. The + and \u2212 signs represent that of two body interactions.\nIt is enough to check that det(I \u2212 BM) > 0 for arbitrary 0 \u2264 \u03b213, \u03b223, \u03b214, \u03b234 < 1 and \u22121 < \u03b212 \u2264 0. The graph G\u0302 in figure 7 is obtained by erasing vertices 2 and 4 in G. To compute det(I \u2212 BM), it is enough to consider G\u0302. In fact\ndet(I \u2212 BM) = \u03b6G(\u03b2) \u22121\n= \u220f\np\u2208P\n(1\u2212 g(p)) (46)\n= \u220f\np\u0302\u2208P\u0302\n(1\u2212 g(p\u0302)) (47)\n= \u03b6G\u0302(\u03b2\u0302) \u22121 = det(I \u2212 B\u0302M\u0302),\nwhere \u03b2\u0302e1 := \u03b212\u03b223, \u03b2\u0302e2 := \u03b213, \u03b2\u0302e3 := \u03b214\u03b234 and \u03b2\u0302ei = \u03b2\u0302e\u0304i . The equality between (46) and (47) is obtained by the one to one correspondence between prime cycles of G and G\u0302.\nBy definition, we have\nB\u0302M\u0302 =\n\n       \n0 0 0 0 \u03b2\u0302e1 \u03b2\u0302e1 0 0 0 \u03b2\u0302e2 0 \u03b2\u0302e2 0 0 0 \u03b2\u0302e3 \u03b2\u0302e3 0 0 \u03b2\u0302e1 \u03b2\u0302e1 0 0 0\n\u03b2\u0302e2 0 \u03b2\u0302e2 0 0 0 \u03b2\u0302e3 \u03b2\u0302e3 0 0 0 0\n\n        ,\nwhere the rows and columns are indexed by e1, e2, e3, e\u03041, e\u03042 and e\u03043. Then the determinant is\ndet(I \u2212 B\u0302M\u0302) = det\n\nI \u2212\n\n 0 \u03b2\u0302e1 \u03b2\u0302e1 \u03b2\u0302e2 0 \u03b2\u0302e2 \u03b2\u0302e3 \u03b2\u0302e3 0\n\n\n\ndet\n\nI +\n\n 0 \u03b2\u0302e1 \u03b2\u0302e1 \u03b2\u0302e2 0 \u03b2\u0302e2 \u03b2\u0302e3 \u03b2\u0302e3 0\n\n\n\n\n= (1 \u2212 \u03b2\u0302e1 \u03b2\u0302e2 \u2212 \u03b2\u0302e1 \u03b2\u0302e3 \u2212 \u03b2\u0302e2 \u03b2\u0302e3 \u2212 2\u03b2\u0302e1 \u03b2\u0302e2 \u03b2\u0302e3)\n(1\u2212 \u03b2\u0302e1 \u03b2\u0302e2 \u2212 \u03b2\u0302e1 \u03b2\u0302e3 \u2212 \u03b2\u0302e2 \u03b2\u0302e3 + 2\u03b2\u0302e1 \u03b2\u0302e2 \u03b2\u0302e3).\nSince \u22121 < \u03b2\u0302e1 \u2264 0 and 0 \u2264 \u03b2\u0302e2 , \u03b2\u0302e3 < 1, we conclude that this is positive."}, {"heading": "F.2 Other cases", "text": "There are two operations on graphs that do not change the set of prime cycles. The first one is adding or removing a vertex of degree two on any edge. The second one is adding or removing an edge with a vertex of degree one. With these two operations, all graphs that have two linearly independent cycles are reduced to three types of graphs. The first type is in figure 7. The other types are in figure 8.\nUp to equivalence of interactions, all types of signs of two body interactions are listed in figure 9 except for the attractive case. We check the uniqueness for each case in order.\nCase (1): Proved in Example 2.\nCase (2): In this case,\nBM =\n\n      \u03b2e1 0 0 0 \u03b2e1 0 \u03b2e2 0 0 \u03b2e2 0 0 0 \u03b2e3 \u03b2e3 0 0 0 0 0 0 \u03b2e1 \u03b2e1 0 0 0 \u03b2e2 0 0 \u03b2e2 0 \u03b2e3 0 0 0 \u03b2e3\n\n      ,\nwhere rows and columns are labeled by e1, e2, e3, e\u03041, e\u03042 and e\u03043. Then the determinant is\ndet(I \u2212 BM) = (1 \u2212 \u03b2e1)(1\u2212 \u03b2e3)(1 \u2212 \u03b2e1 \u2212 \u03b2e3 + \u03b2e1\u03b2e3 \u2212 4\u03b2e1\u03b2 2 e2\u03b2e3). (48)\nThis is positive when 0 \u2264 \u03b2e1 , \u03b2e2 < 1 and \u22121 < \u03b2e3 \u2264 0.\nCase (3): The determinant (48) is also positive when 0 \u2264 \u03b2e2 < 1 and \u22121 < \u03b2e1 , \u03b2e3 \u2264 0.\nCase (4): In this case,\nBM =\n\n  \u03b2e1 \u03b2e1 0 \u03b2e1 \u03b2e2 \u03b2e2 \u03b2e2 0 0 \u03b2e1 \u03b2e1 \u03b2e1 \u03b2e2 0 \u03b2e2 \u03b2e2\n\n  ,\nwhere rows and columns are labeled by e1, e2, e\u03041 and e\u03042. Then we have\ndet(I \u2212 BM) = (1\u2212 \u03b2e1)(1 \u2212 \u03b2e2)(1\u2212 \u03b2e1 \u2212 \u03b2e2 \u2212 3\u03b2e1\u03b2e2). (49)\nThis is positive when 0 \u2264 \u03b2e1 < 1 and \u22121 < \u03b2e2 \u2264 0.\nCase (5): The determinant (49) is positive when \u22121 < \u03b2e1 , \u03b2e2 \u2264 0."}], "references": [], "referenceMentions": [], "year": 2010, "abstractText": "<lb>We propose a new approach to the analysis of Loopy Belief Propagation (LBP) by<lb>establishing a formula that connects the Hessian of the Bethe free energy with the<lb>edge zeta function. The formula has a number of theoretical implications on LBP.<lb>It is applied to give a sufficient condition that the Hessian of the Bethe free energy<lb>is positive definite, which shows non-convexity for graphs with multiple cycles.<lb>The formula clarifies the relation between the local stability of a fixed point of<lb>LBP and local minima of the Bethe free energy. We also propose a new approach<lb>to the uniqueness of LBP fixed point, and show various conditions of uniqueness.<lb>", "creator": "LaTeX with hyperref package"}}}