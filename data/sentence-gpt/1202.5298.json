{"id": "1202.5298", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "23-Feb-2012", "title": "Min Max Generalization for Two-stage Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes", "abstract": "We study the minmax optimization problem introduced in [22] for computing policies for batch mode reinforcement learning in a deterministic setting. First, we show that this problem is NP-hard. In the two-stage case, we provide two relaxation schemes. The first relaxation scheme works by dropping some constraints in order to obtain a problem that is solvable in polynomial time. The second relaxation scheme, based on a Lagrangian relaxation where all constraints are dualized, leads to a conic quadratic programming problem. We also theoretically prove and empirically illustrate that both relaxation schemes provide better results than those given in [22]. We also demonstrate that both the linearized optimization and the linearization approaches for non-linearization and the optimization solutions for non-linearization are well in advance. We also show that the computational problems are also solved using the first formulation of these techniques. We show that we can achieve more accurate, faster algorithms for recurrent and non-linear optimization, as well as provide better performance in parallelizing all of the approaches for non-linearization and non-linearization.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "histories": [["v1", "Thu, 23 Feb 2012 20:53:18 GMT  (560kb,D)", "http://arxiv.org/abs/1202.5298v1", null], ["v2", "Tue, 30 Oct 2012 16:29:38 GMT  (560kb,D)", "http://arxiv.org/abs/1202.5298v2", null]], "reviews": [], "SUBJECTS": "cs.SY cs.LG", "authors": ["raphael fonteneau", "damien ernst", "bernard boigelot", "quentin louveaux"], "accepted": false, "id": "1202.5298"}, "pdf": {"name": "1202.5298.pdf", "metadata": {"source": "CRF", "title": "MIN MAX GENERALIZATION FOR DETERMINISTIC BATCH MODE REINFORCEMENT LEARNING: RELAXATION SCHEMES", "authors": ["R. FONTENEAU", "D. ERNST", "B. BOIGELOT"], "emails": [], "sections": [{"heading": null, "text": "Key words. Reinforcement Learning, Min Max Generalization, Non-convex Optimization, Computational Complexity\nAMS subject classifications. 60J05 Discrete-time Markov processes on general state spaces\n1. Introduction. Research in Reinforcement Learning (RL) [48] aims at designing computational agents able to learn by themselves how to interact with their environment to maximize a numerical reward signal. The techniques developed in this field have appealed researchers trying to solve sequential decision making problems in many fields such as Finance [26], Medicine [34, 35] or Engineering [42]. Since the end of the nineties, several researchers have focused on the resolution of a subproblem of RL: computing a high-performance policy when the only information available on the environment is contained in a batch collection of trajectories of the agent [10, 17, 28, 38, 42, 19]. This subfield of RL is known as \u201cbatch mode RL\u201d.\nBatch mode RL (BMRL) algorithms are challenged when dealing with large or continuous state spaces. Indeed, in such cases they have to generalize the information contained in a generally sparse sample of trajectories. The dominant approach for generalizing this information is to combine BMRL algorithms with function approximators [6, 28, 17, 11]. Usually, these approximators generalize the information contained in the sample to areas poorly covered by the sample by implicitly assuming that the properties of the system in those areas are similar to the properties of the system in the nearby areas well covered by the sample. This in turn often leads to low performance guarantees on the inferred policy when large state space areas are poorly covered by the sample. This can be explained by the fact that when computing the performance guarantees of these policies, one needs to take into account that they may actually drive the system into the poorly visited areas to which the generalization strategy associates a favorable environment behavior, while the environment may actually be particularly adversarial in those areas. This is corroborated by theoretical results which show that the performance guarantees of the policies inferred by these algorithms degrade with the sample dispersion where, loosely speaking, the dispersion can be seen as the radius of the largest non-visited state space area.\nTo overcome this problem, [22] propose a min max-type strategy for generalizing in deterministic, Lipschitz continuous environments with continuous state spaces, finite action spaces, and finite time-horizon. The min max approach works by determining a sequence of actions that maximizes the worst return that could possibly be obtained considering any system compatible with the sample of trajectories, and a weak prior knowledge given in the form of upper bounds on the Lipschitz constants related to the environment (dynamics, reward\n\u2020Department of Electrical Engineering and Computer Science, University of Lie\u0300ge, Belgium\n1\nar X\niv :1\n20 2.\n52 98\nv1 [\ncs .S\nY ]\n2 3\nFe b\n20 12\n2 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nfunction). However, they show that finding an exact solution of the min max problem is far from trivial, even after reformulating the problem so as to avoid the search in the space of all compatible functions. To circumvent these difficulties, they propose to replace, inside this min max problem, the search for the worst environment given a sequence of actions by an expression that lower-bounds the worst possible return which leads to their so called CGRL algorithm (the acronym stands for \u201cCautious approach to Generalization in Reinforcement Learning\u201d). This lower bound is derived from their previous work [20, 21] and has a tightness that depends on the sample dispersion. However, in some configurations where areas of the the state space are not well covered by the sample of trajectories, the CGRL bound turns to be very conservative.\nIn this paper, we propose to further investigate the min max generalization optimization problem that was initially proposed in [22]. We first show that this optimization problem is NP-hard. We then focus on the two-stage case, which is still NP-hard. Since it seems hopeless to exactly solve the problem, we propose two relaxation schemes that preserve the nature of the min max generalization problem by targetting policies leading to high performance guarantees. The first relaxation scheme works by dropping some constraints in order to obtain a problem that is solvable in polynomial time. This results into a well known configuration called the trust-region subproblem [13]. The second relaxation scheme, based on a Lagrangian relaxation where all constraints are dualized, can be solved using conic quadratic programming in polynomial time. We prove that both relaxation schemes always provide bounds that are greater or equal to the CGRL bound. We also show that these bounds are tight in a sense that they converge towards the actual return when the sample dispersion converges towards zero, and that the sequences of actions that maximize these bounds converge towards optimal ones.\nThe paper is organized as follows:\n\u2022 in Section 2, we give a short summary of the literature related to this work, \u2022 Section 3 formalizes the min max generalization problem in a Lipschitz continuous,\ndeterministic BMRL context, \u2022 in Section 4, we focus on the particular two-stage case, for which we prove that it\ncan be decoupled into two independent problems corresponding respectively to the first stage and the second stage (Theorem 4.2):\n\u2013 the first stage problem leads to a trivial optimization problem that can be solved in closed-form (Corollary 4.3), \u2013 we prove in Section 4.2 that the second stage problem is NP-hard (Corollary 4.7), which consequently proves the NP-hardness of the general min max generalization problem (Theorem 4.8),\n\u2022 we then describe in Section 5 the two relaxation schemes that we propose for the second stage problem:\n\u2013 the trust-region relaxation scheme (Section 5.1), \u2013 the Lagrangian relaxation scheme (Section 5.2), which is shown to be a conic-\nquadratic problem (Theorem 5.4), \u2022 we prove in Section 5.3.1 that the first relaxation scheme gives better results than\nCGRL (Theorem 5.9), \u2022 we show in Section 5.3.2 that the second relaxation scheme povides better results\nthan the first relaxation scheme (Theorem 5.13), and consequently better results than CGRL (Theorem 5.14), \u2022 we analyze in Section 5.4 the asymptotic behavior of the relaxation schemes as a function of the sample dispersion:\n\u2013 we show that the the bounds provided by the relaxtion schemes converge to-\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 3\nwards the actual return when the sample dispersion decreases towards zero (Theorem 5.17), \u2013 we show that the sequences of actions maximizing such bounds converge towards optimal sequences of actions when the sample dispersion decreases towards zero (Theorem 5.20),\n\u2022 Section 6 illustrates the relaxation schemes on an academic benchmark, \u2022 Section 7 concludes.\nWe provide in Figure 1.1 an illustration of the roadmap of the main results of this paper.\n2. Related Work. Several works have already been built upon min max paradigms for computing policies in a RL setting. In stochastic frameworks, min max approaches are often successful for deriving robust solutions with respect to uncertainties in the (parametric) representation of the probability distributions associated with the environment [16]. In the context where several agents interact with each other in the same environment, min max approaches appear to be efficient strategies for designing policies that maximize one agent\u2019s reward given the worst adversarial behavior of the other agents. [29, 43]. They have also received some attention for solving partially observable Markov decision processes [30, 27].\nThe min max approach towards generalization, originally introduced in [22], implicitly relies on a methodology for computing lower bounds on the worst possible return (considering any compatible environment) in a deterministic setting with a mostly unknown actual environment. In this respect, it is related to other approaches that aim at computing performance guarantees on the returns of inferred policies [33, 41, 39].\nOther fields of research have proposed min max-type strategies for computing control policies. This includes Robust Control theory [24] with H\u221e methods [2], but also Model Predictive Control (MPC) theory - where usually the environment is supposed to be fully known [12, 18] - for which min max approaches have been used to determine an optimal sequence of actions with respect to the \u201cworst case\u201d disturbance sequence occurring [44, 4]. Finally, there is a broad stream of works in the field of Stochastic Programming [7] that\n4 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nhave addressed the problem of safely planning under uncertainties, mainly known as \u201crobust stochastic programming\u201d or \u201crisk-averse stochastic programming\u201d [15, 45, 46, 36]. In this field, the two-stage case has also been particularly well-studied [23, 14].\n3. Problem Formalization. We first formalize the BMRL setting in Section 3.1, and we state the min max generalization problem in Section 3.2.\n3.1. Batch Mode Reinforcement Learning. We consider a deterministic discrete-time system whose dynamics over T stages is described by a time-invariant equation\nxt+1 = f (xt, ut) t = 0, . . . , T \u2212 1,\nwhere for all t, the state xt is an element of the state space X \u2282 Rd where Rd denotes the d\u2212dimensional Euclidean space and ut is an element of the finite (discrete) action space U = { u(1), . . . , u(m) } that we abusively identify with {1, . . . ,m}. T \u2208 N \\ {0} is referred to as the (finite) optimization horizon. An instantaneous reward\nrt = \u03c1 (xt, ut) \u2208 R\nis associated with the action ut taken while being in state xt. For a given initial state x0 \u2208 X and for every sequence of actions (u0, . . . , uT\u22121) \u2208 UT , the cumulated reward over T stages (also named T\u2212stage return) is defined as follows:\nDEFINITION 3.1 (T\u2212stage Return).\n\u2200 (u0, . . . , uT\u22121) \u2208 UT , J (u0,...,uT\u22121)T , T\u22121\u2211 t=0 \u03c1 (xt, ut) ,\nwhere\nxt+1 = f (xt, ut) , \u2200t \u2208 {0, . . . , T \u2212 1} .\nAn optimal sequence of actions is a sequence that leads to the maximization of the T\u2212stage return:\nDEFINITION 3.2 (Optimal T\u2212stage Return).\nJ\u2217T , max (u0,...,uT\u22121)\u2208UT J (u0,...,uT\u22121) T .\nWe further make the following assumptions that characterize the batch mode setting: 1. The system dynamics f and the reward function \u03c1 are unknown; 2. For each action u \u2208 U , a set of n(u) \u2208 N one-step system transitions\nF (u) = {( x(u),k, r(u),k, y(u),k )}n(u) k=1\nis known where each one-step transition is such that:\ny(u),k = f ( x(u),k, u ) and r(u),k = \u03c1 ( x(u),k, u ) .\n3. We assume that every set F (u) contains at least one element:\n\u2200u \u2208 U , n(u) > 0 .\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 5\nIn the following, we denote by F the collection of all system transitions:\nF = F (1) \u222a . . . \u222a F (m)\nUnder those assumptions, batch mode reinforcement learning (BMRL) techniques propose to infer from the sample of one-step system transitions F a high-performance sequence of actions, i.e. a sequence of actions ( u\u0303\u22170, . . . , u\u0303 \u2217 T\u22121 ) \u2208 UT such that J (u\u0303 \u2217 0 ,...,u\u0303 \u2217 T\u22121)\nT is as close as possible to J\u2217T .\n3.2. Min max Generalization under Lipschitz Continuity Assumptions. In this section, we state the min max generalization problem that we study in this paper. The formalization was originally proposed in [22].\nWe first assume that the system dynamics f and the reward function \u03c1 are assumed to be Lipschitz continuous. There exist finite constants Lf , L\u03c1 \u2208 R such that:\n\u2200(x, x\u2032) \u2208 X 2,\u2200u \u2208 U , \u2016f (x, u)\u2212 f (x\u2032, u)\u2016 \u2264 Lf \u2016x\u2212 x\u2032\u2016 , |\u03c1 (x, u)\u2212 \u03c1 (x\u2032, u)| \u2264 L\u03c1 \u2016x\u2212 x\u2032\u2016 ,\nwhere \u2016.\u2016 denotes the Euclidean norm over the space X . We also assume that two constants Lf and L\u03c1 satisfying the above-written inequalities are known.\nFor a given sequence of actions, one can define the worst possible return that can be obtained by any system whose dynamics f \u2032 and \u03c1\u2032 would satisfy the Lipschitz inequalities and that would coincide with the values of the functions f and \u03c1 given by the sample of system transitions F . As shown in [22], this worst possible return can be computed by solving a finite-dimensional optimization problem over X T\u22121 \u00d7 RT . Intuitively, solving such an optimization problem amounts in determining a most pessimistic trajectory of the system that is still compliant with the sample of data and the Lipschitz continuity assumptions. More specifically, for a given sequence of actions (u0, . . . , uT\u22121) \u2208 UT , some given constants Lf and L\u03c1, a given initial state x0 \u2208 X and a given sample of transitions F , this optimization problem writes:\n(PT (F , Lf , L\u03c1, x0, u0, . . . , uT\u22121)) :\nmin r\u03020 . . . r\u0302T\u22121 \u2208 R x\u03020 . . . x\u0302T\u22121 \u2208 X\nT\u22121\u2211 t=0 r\u0302t,\nsubject to\u2223\u2223\u2223\u0302rt \u2212 r(ut),kt\u2223\u2223\u22232 \u2264 L2\u03c1 \u2225\u2225\u2225x\u0302t \u2212 x(ut),kt\u2225\u2225\u22252 ,\u2200(t, kt) \u2208 {0, . . . , T \u2212 1} \u00d7 {1, . . . , n(ut)} ,\u2225\u2225\u2225x\u0302t+1 \u2212 y(ut),kt\u2225\u2225\u22252 \u2264 L2f \u2225\u2225\u2225x\u0302t \u2212 x(ut),kt\u2225\u2225\u22252,\u2200(t, kt) \u2208 {0, . . . , T \u2212 1} \u00d7 {1, . . . , n(ut)}, |\u0302rt \u2212 r\u0302t\u2032 |2 \u2264 L2\u03c1 \u2016x\u0302t \u2212 x\u0302t\u2032\u2016 2 ,\u2200t, t\u2032 \u2208 {0, . . . , T \u2212 1|ut = ut\u2032} , \u2016x\u0302t+1 \u2212 x\u0302t\u2032+1\u20162 \u2264 L2f \u2016x\u0302t \u2212 x\u0302t\u2032\u2016 2 ,\u2200t, t\u2032 \u2208 {0, . . . , T \u2212 2|ut = ut\u2032} ,\nx\u03020 = x0 .\nNote that, throughout the paper, optimization variables will be written in bold. The min max approach to generalization aims at identifying which sequence of actions maximizes its worst possible return, that is which sequence of actions leads to the highest value of (PT (F , Lf , L\u03c1, x0, u0, . . . , uT\u22121)).\n6 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nWe focus in this paper on the design of resolution schemes for solving the program (PT (F , Lf , L\u03c1, x0, u0, . . . , uT\u22121)). These schemes can afterwards be used for solving the min max problem through exhaustive search over the set of all sequences of actions.\nLater in this paper, we will also analyze the computational complexity of this min max generalization problem. When carrying out this analysis, we will assume that all the data of the problem (i.e., T,F , Lf , L\u03c1, x0, u0, . . . , uT\u22121) are given in the form of rational numbers.\n4. The Two-stage Case. In this section, we restrict ourselves to the case where the time horizon contains only two steps, i.e. T = 2, which is an important particular case of ( PT (F , Lf , L\u03c1, x0, u0, . . . , uT\u22121) ) . Many works in optimal sequential decision making have considered the two-stage case [23, 14], which relates to many applications, such as for instance medical applications where one wants to infer \u201csafe\u201d clinical decision rules from batch collections of clinical data [1, 31, 32, 49].\nIn Section 4.1, we show that this problem can be decoupled into two subproblems. While the first subproblem is straightforward to solve, we prove in Section 4.2 that the second one is NP-hard, which proves that the two-stage problem as well as the generalized T\u2212stage problem (PT (F , Lf , L\u03c1, x0, u0, . . . , uT\u22121)) are also NP-hard.\nGiven a two-stage sequence of actions (u0, u1) \u2208 U2, the two-stage version of the problem ( PT (F , Lf , L\u03c1, x0, u0, . . . , uT\u22121) ) writes as follows:(\nP2(F , Lf , L\u03c1, x0, u0, u1) ) :\nmin r\u03020, r\u03021 \u2208 R x\u03020, x\u03021 \u2208 X\nr\u03020 + r\u03021,\nsubject to\u2223\u2223\u2223\u0302r0 \u2212 r(u0),k0 \u2223\u2223\u22232 \u2264 L2\u03c1 \u2225\u2225\u2225x\u03020 \u2212 x(u0),k0\u2225\u2225\u22252 ,\u2200k0 \u2208 {1, . . . , n(u0)} , (4.1)\u2223\u2223\u2223\u0302r1 \u2212 r(u1),k1 \u2223\u2223\u22232 \u2264 L2\u03c1 \u2225\u2225\u2225x\u03021 \u2212 x(u1),k1\u2225\u2225\u22252 ,\u2200k1 \u2208 {1, . . . , n(u1)} , (4.2)\u2225\u2225\u2225x\u03021 \u2212 y(u0),k0\u2225\u2225\u22252 \u2264 L2f \u2225\u2225\u2225x\u03020 \u2212 x(u0),k0\u2225\u2225\u22252 ,\u2200k0 \u2208 {1, . . . , n(u0)} , (4.3) |\u0302r0 \u2212 r\u03021|2 \u2264 L2\u03c1 \u2016x\u03020 \u2212 x\u03021\u2016\n2 if u0 = u1 , (4.4) x\u03020 = x0 . (4.5)\nFor a matter of simplicity, we will often drop the arguments in the definition of the optimization problem and refer ( P2(F , Lf , L\u03c1, x0, u0, u1) ) as (P(u0,u1)2 ). We denote by B (u0,u1) 2 (F) the lower bound associated with an optimal solution of (P (u0,u1) 2 ):\nDEFINITION 4.1 (Optimal ValueB(u0,u1)2 (F)). Let (u0, u1) \u2208 U2, and let (r\u0302\u22170, r\u0302\u22171, x\u0302\u22170, x\u0302\u22171) be an optimal solution to ( P(u0,u1)2 ) . Then,\nB (u0,u1) 2 (F) , r\u0302\u22170 + r\u0302\u22171 .\n4.1. Decoupling Stages. Let (P \u2032(u0,u1)2 ) and (P \u2032\u2032(u0,u1) 2 ) be the two following subprob-\nlems:\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 7( P \u2032(u0,u1)2 ) :\nmin r\u03020 \u2208 R x\u03020 \u2208 X\nr\u03020\nsubject to \u2223\u2223\u2223\u0302r0 \u2212 r(u0),k0\u2223\u2223\u22232 \u2264 L2\u03c1 \u2225\u2225\u2225x\u03020 \u2212 x(u0),k0\u2225\u2225\u22252 ,\u2200k0 \u2208 {1, . . . , n(u0)} , x\u03020 = x0 . ( P \u2032\u2032(u0,u1)2 ) :\nmin r\u03021 \u2208 R x\u03021 \u2208 X\nr\u03021 (4.6)\nsubject to \u2223\u2223\u2223\u0302r1 \u2212 r(u1),k1\u2223\u2223\u22232 \u2264 L2\u03c1 \u2225\u2225\u2225x\u03021 \u2212 x(u1),k1\u2225\u2225\u22252 ,\u2200k1 \u2208 {1, . . . , n(u1)} , (4.7)\u2225\u2225\u2225x\u03021 \u2212 y(u0),k0\u2225\u2225\u22252 \u2264 L2f \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u22252 ,\u2200k0 \u2208 {1, . . . , n(u0)} . (4.8) We show in this section that an optimal solution to (P(u0,u1)2 ) can be obtained by solving the two subproblems (P \u2032(u0,u1)2 ) and (P \u2032\u2032(u0,u1) 2 ) corresponding to the first stage and the second stage. Indeed, one can see that the stages t = 0 and t = 1 are theoretically coupled by constraint (4.4), except in the case where the two actions u0 and u1 are different for which (P(u0,u1)2 ) is trivially decoupled. We prove in the following that, even in the case u0 = u1, optimal solutions to the two decoupled problems (P \u2032(u0,u1)2 ) and (P \u2032\u2032(u0,u1) 2 ) also satisfy constraint (4.4). Additionally, we provide the solution of (P \u2032(u0,u1)2 ).\nTHEOREM 4.2. Let (u0, u1) \u2208 U2. If (r\u0302\u22170, x\u0302\u22170) is an optimal solution to ( P \u2032(u0,u1)2 ) and\n(r\u0302\u22171, x\u0302 \u2217 1) is an optimal solution to ( P \u2032\u2032(u0,u1)2 ) , then (r\u0302\u22170, r\u0302\n\u2217 1, x\u0302 \u2217 0, x\u0302 \u2217 1) is an optimal solution to( P(u0,u1)2 ) .\nProof. \u2022 First case: u0 6= u1 .\nThe constraint (4.4) drops and the theorem is trivial. \u2022 Second case: u0 = u1 .\nThe rationale of the proof is the following. We first relax constraint (4.4), and consider the two problems (P \u2032(u0,u1)2 ) and (P \u2032\u2032(u0,u1) 2 ). Then, we show that optimal solutions of (P \u2032(u0,u1) 2 ) and (P \u2032\u2032(u0,u1)2 ) also satisfy constraint (4.4).\nAbout (P \u2032(u0,u1)2 ). The problem (P \u2032(u0,u1) 2 ) consists in the minimization of r\u03020 under the intersection of interval constraints. It is therefore straightforward to solve. In particular the optimal solution r\u0302\u22170 lies at the lower value of one of the intervals. Therefore there exists\n8 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux( x(u0),k \u2217 0 , r(u0),k \u2217 0 , y(u0),k \u2217 0 ) \u2208 F (u0) such that\nr\u0302\u22170 = r (u0),k \u2217 0 \u2212 L\u03c1 \u2225\u2225\u2225x0 \u2212 x(u0),k\u22170\u2225\u2225\u2225 . (4.9) Furthermore r\u0302\u22170 must belong to all intervals. We therefore have that\nr\u0302\u22170 \u2265 r(u0),k0 \u2212 L\u03c1 \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u2225 , \u2200k0 \u2208 {1, . . . , n(u0)} . (4.10)\nIn other words,\nr\u0302\u22170 = max k0\u2208{1,...,n(u0)}\nr(u0),k0 \u2212 L\u03c1 \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u2225 .\nAbout (P \u2032\u2032(u0,u1)2 ). Again we observe that it is the minimization of r\u03021 under the intersection of interval constraints as well. The sizes of the intervals are however not fixed but determined by the variable x\u03021. If we denote the optimal solution of (P \u2032\u2032(u0,u1)2 ) by r\u0302\u22171 and x\u0302\u22171, we know that r\u0302 \u2217 1 also lies at the lower value of one of the intervals. Hence there exists(\nx(u),k \u2217 1 , r(u),k \u2217 1 , y(u),k \u2217 1 ) \u2208 F (u) such that\nr\u0302\u22171 = r (u),k\u22171 \u2212 L\u03c1 \u2225\u2225\u2225x\u0302\u22171 \u2212 x(u),k\u22171\u2225\u2225\u2225 . (4.11) Furthermore r\u0302\u22171 must belong to all intervals. We therefore have that\nr\u0302\u22171 \u2265 r(u),k1 \u2212 L\u03c1 \u2225\u2225\u2225x\u0302\u22171 \u2212 x(u),k1\u2225\u2225\u2225 , \u2200k1 \u2208 {1, . . . , n(u)} . (4.12)\nWe now discuss two cases depending on the sign of r\u0302\u22170 \u2212 r\u0302\u22171.\n\u2212 If r\u0302\u22170 \u2212 r\u0302\u22171 \u2265 0 Using (4.9) and (4.12) with index k\u22170 , we have\nr\u0302\u22170 \u2212 r\u0302\u22171 \u2264 L\u03c1 (\u2225\u2225\u2225x\u0302\u22171 \u2212 x(u),k\u22170\u2225\u2225\u2225\u2212 \u2225\u2225\u2225x0 \u2212 x(u),k\u22170\u2225\u2225\u2225) (4.13)\nSince r\u0302\u22170 \u2212 r\u0302\u22171 \u2265 0, we therefore have\n|\u0302r\u22170 \u2212 r\u0302\u22171| \u2264 L\u03c1 (\u2225\u2225\u2225x\u0302\u22171 \u2212 x(u),k\u22170\u2225\u2225\u2225\u2212 \u2225\u2225\u2225x0 \u2212 x(u),k\u22170\u2225\u2225\u2225) . (4.14)\nUsing the triangle inequality we can write\u2225\u2225\u2225x\u0302\u22171 \u2212 x(u),k\u22170\u2225\u2225\u2225 \u2264 \u2016x\u0302\u22171 \u2212 x0\u2016+ \u2225\u2225\u2225x0 \u2212 x(u),k\u22170\u2225\u2225\u2225 . (4.15) Replacing (4.15) in (4.14) we obtain\n|\u0302r\u22171 \u2212 r\u0302\u22170| \u2264 L\u03c1 \u2016x\u0302\u22171 \u2212 x0\u2016\nwhich shows that r\u0302\u22170 and r\u0302 \u2217 1 satisfy constraint (4.4).\n\u2212 If r\u0302\u22170 \u2212 r\u0302\u22171 < 0 Using (4.11) and (4.10) with index k\u22171 , we have\nr\u0302\u22171 \u2212 r\u0302\u22170 \u2264 L\u03c1 (\u2225\u2225\u2225x0 \u2212 x(u),k\u22171\u2225\u2225\u2225\u2212 \u2225\u2225\u2225x\u0302\u22171 \u2212 x(u),k\u22171\u2225\u2225\u2225)\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 9\nand since r\u0302\u22170 \u2212 r\u0302\u22171 < 0,\n|\u0302r\u22171 \u2212 r\u0302\u22170| \u2264 L\u03c1 (\u2225\u2225\u2225x0 \u2212 x(u),k\u22171\u2225\u2225\u2225\u2212 \u2225\u2225\u2225x\u0302\u22171 \u2212 x(u),k\u22171\u2225\u2225\u2225) . (4.16)\nUsing the triangle inequality we can write\u2225\u2225\u2225x0 \u2212 x(u),k\u22171\u2225\u2225\u2225 \u2264 \u2016x0 \u2212 x\u0302\u22171\u2016+ \u2225\u2225\u2225x\u0302\u22171 \u2212 x(u),k\u22171\u2225\u2225\u2225 . (4.17) Replacing (4.17) in (4.16) yields\n|\u0302r\u22171 \u2212 r\u0302\u22170| \u2264 L\u03c1 \u2016x0 \u2212 x\u0302\u22171\u2016 ,\nwhich again shows that r\u0302\u22170 and r\u0302 \u2217 1 satisfy constraint (4.4). In both cases r\u0302\u22170\u2212 r\u0302\u22171 \u2265 0 and r\u0302\u22170\u2212 r\u0302\u22171 < 0, we have shown that constraint (4.4) is satisfied. In the following of the paper, we focus on the two subproblems (P \u2032(u0,u1)2 ) and (P \u2032\u2032(u0,u1) 2 ) rather than on (P(u0,u1)2 ). From the proof of Theorem 4.2 given above, we can directly obtain the solution of (P \u2032(u0,u1)2 ):\nCOROLLARY 4.3. The solution of the problem (P \u2032(u0,u1)2 ) is\nr\u0302\u22170 = max k0\u2208{1,...,n(u0)}\nr(u0),k0 \u2212 L\u03c1 \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u2225 .\n4.2. Complexity of (P \u2032\u2032(u0,u1)2 ). The problem (P \u2032(u0,u1) 2 ) being solved, we now focus in this section on the resolution of (P \u2032\u2032(u0,u1)2 ). In particular, we show that it is NPhard, even in the particular case where there is only one element in the sample F (u1) ={( x(u1),1, r(u1),1, y(u1),1 )} . In this particular case, the problem (P \u2032\u2032(u0,u1)2 ) amounts to max-\nimizing of the distance \u2225\u2225x\u03021 \u2212 x(u1),1\u2225\u2225 under an intersection of balls as we show in the following lemma. LEMMA 4.4. If the cardinality of F (u1) is equal to 1:\nF (u1) = {( x(u1),1, r(u1),1, y(u1),1 )} ,\nthen the optimal solution to ( P \u2032\u2032(u0,u1)2 ) satisfies\nr\u0302\u22171 = r (u1),1 \u2212 L\u03c1 \u2225\u2225\u2225x\u0302\u22171 \u2212 x(u1),1\u2225\u2225\u2225 where x\u0302\u22171 maximizes\n\u2225\u2225x\u03021 \u2212 x(u1),1\u2225\u2225 subject to\u2225\u2225\u2225x\u03021 \u2212 y(u0),k0\u2225\u2225\u22252 \u2264 L2f \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u22252 , \u2200(x(u0),k0 , r(u0),k0 , y(u0),k0) \u2208 F (u0) . Proof. The unique constraint concerning r\u03021 is an interval. Therefore r\u0302\u22171 takes the value of the lower bound of the interval. In order to obtain the lowest such value, the right-hand-side of (4.7) must be maximized under the other constraints.\nNote that if the cardinality n(u0) ofF (u0) is also equal to 1, then (P(u0,u1)2 ) can be solved exactly, as we will later show in Corollary 5.3. But, in the general case where n(u0) > 1, this\n10 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nproblem of maximizing a distance under a set of ball-constraints is NP-hard as we now prove. To do it, we introduce the MNBC (for \u201cMax Norm with Ball Constraints\u201d) decision problem:\nDEFINITION 4.5 (MNBC Decision Problem). Given x(0) \u2208 Qd, yi \u2208 Qd, \u03b3i \u2208 Q, i \u2208 {1, . . . , I}, C \u2208 Q, the MNBC problem is to determine whether there exists x \u2208 Rd such that\u2225\u2225\u2225x\u2212 x(0)\u2225\u2225\u22252 \u2265 C and \u2225\u2225x\u2212 yi\u2225\u22252 \u2264 \u03b3i , \u2200i \u2208 {1, . . . , I} .\nLEMMA 4.6. MNBC is NP-hard. Proof. To prove it, we will do a reduction from the {0, 1}\u2212programming feasibility problem [40]. More precisely, we consider in this proof the {0, 2}\u2212programming feasibility problem, which is equivalent. The problem is, given p \u2208 N, A \u2208 Zp\u00d7d, b \u2208 Zp to find whether there exists x \u2208 {0, 2}d that satisfies Ax \u2264 b. This problem is known to be NP-hard and we now provide a polynomial reduction to MNBC.\nThe dimension d is kept the same in both problems. The first step is to define a set of constraints for MNBC such that the only potential feasible solutions are exactly x \u2208 {0, 2}d. We define\nx(0) , (1, . . . , 1)\nand\nC , d.\nFor i = 1, . . . , d, we define\ny2i , ( y2i1 , . . . , y 2i d ) with y2ii , 0 and y 2i j , 1 for all j 6= i and \u03b3i , d+ 3. Similarly for i = 1, . . . , d, we define\ny2i+1 , (y2i+11 , . . . , y 2i+1 d )\nwith y2i+1i , 2 and y 2i+1 j , 1 for all j 6= i and \u03b3i , d+ 3.\nClaim{ x \u2208 Rd | \u2016x\u2212 x(0)\u20162 \u2265 d } \u2229 ( 2d+1\u22c2 i=2 { x \u2208 Rd | \u2016x\u2212 yi\u20162 \u2264 \u03b3i }) = {0, 2}d\nIt is readily verified that any x \u2208 {0, 2}d belongs to the 2d+ 1 above sets. Consider x \u2208 Rd that belongs to the 2d + 1 above sets. Consider an index k \u2208 {1, . . . , d}. Using the constraints defining the sets, we can in particular write\n\u2016(x1, . . . , xk\u22121, xk, xk+1, . . . , xd)\u2212 (1, . . . , 1)\u20162 \u2265 d \u2016(x1, . . . , xk\u22121, xk, xk+1, . . . , xd)\u2212 (1, . . . , 1, 0, 1, . . . , 1)\u20162 \u2264 d+ 3 \u2016(x1, . . . , xk\u22121, xk, xk+1, . . . , xd)\u2212 (1, . . . , 1, 2, 1, . . . , 1)\u20162 \u2264 d+ 3\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 11\nthat we can write algebraically\u2211 j 6=k\n(xj \u2212 1)2 + (xk \u2212 1)2 \u2265 d (4.18)\u2211 j 6=k\n(xj \u2212 1)2 + x2k \u2264 d+ 3 (4.19)\u2211 j 6=k (xj \u2212 1)2 + (xk \u2212 2)2 \u2264 d+ 3. (4.20)\nBy computing (4.19)\u2212 (4.18) and (4.20)\u2212 (4.18), we obtain xk \u2264 2 and xk \u2265 0 respectively. This implies that\nd\u2211 k=1 (xk \u2212 1)2 \u2264 d\nand the equality is obtained if and only if we have that xk \u2208 {0, 2} for all k which proves the claim.\nIt remains to prove that we can encode any linear inequality through a ball constraint. Consider an inequality of the type \u2211d j=1 ajxj \u2264 b. We assume that a 6= 0 and that b is even and therefore that there exists no x \u2208 {0, 2}d such that aTx = b+ 1. We want to show that there exists y \u2208 Qd and \u03b3 \u2208 Q such that{\nx \u2208 {0, 2}d | aTx \u2264 b } = { x \u2208 {0, 2}d | \u2016x\u2212 y\u20162 \u2264 \u03b3 } . (4.21)\nLet y\u0304 \u2208 Rd be the intersection point of the hyperplane aTx = b+1 and the line (1 \u00b7 \u00b7 \u00b7 1)T + \u03bb(a1 \u00b7 \u00b7 \u00b7 ad)T , \u03bb \u2208 R. Let r be defined as follows:\nr = d2 \u221a\u221a\u221a\u221a d\u2211\nj=1\na2j + 1  . We claim that choosing \u03b3 , r2 and y , y\u0304 \u2212 ra allows us to obtain (4.21). To prove it, we need to show that x \u2208 {0, 2}d belongs to the ball if and only if it satisfies the constraint aTx \u2264 b. Let x\u0304 \u2208 {0, 2}d. There are two cases to consider: \u2022 Suppose first that aT x\u0304 \u2265 b+ 2. Since y\u0304 is the closest point to y that satisfies aT y = b + 1, it also implies that any point x such that aTx > b+ 1 is such that \u2016x\u2212 y\u20162 > r2 proving that:\nx\u0304 /\u2208 { x \u2208 Rd | \u2016x\u2212 y\u20162 \u2264 r2 } .\n\u2022 Suppose now that aT x\u0304 \u2264 b and in particular that aT x\u0304 = b \u2212 k with k \u2208 N (see Figure 4.1).\nLet y\u0303 \u2208 Rd be the intersection point of the hyperplane aTx = b\u2212k and the line (1 \u00b7 \u00b7 \u00b7 1)T + \u03bb(a1 \u00b7 \u00b7 \u00b7 ad)T , \u03bb \u2208 R. Since ( (1 \u00b7 \u00b7 \u00b7 1)T , y\u0303, x\u0304 ) form a right triangle with the right angle in y\u0303 and since \u2016(1 \u00b7 \u00b7 \u00b7 1)T \u2212 x\u0304\u20162 \u2264 d, we have\n\u2016y\u0303 \u2212 x\u0304\u20162 \u2264 d. (4.22)\nBy definition of y, we have:\n\u2016y \u2212 y\u0304\u2016 = r ,\n12 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nand by definition of y\u0304 and y\u0303, we have:\n\u2016y\u0304 \u2212 y\u0303\u2016 \u2265 1\u221a\u2211d j=1 a 2 j .\nSince y\u0304, y\u0303 and y belong to the same line, we have\n\u2016y \u2212 y\u0303\u2016 \u2264 r \u2212 1\u221a\u2211d j=1 a 2 j . (4.23)\nAs (y, y\u0303, x\u0304) form a right triangle with the right angle in y\u0303, we have that\n\u2016x\u0304\u2212 y\u20162 = \u2016y \u2212 y\u0303\u20162 + \u2016x\u0304\u2212 y\u0303\u20162\n\u2264 r \u2212 1\u221a\u2211d j=1 a 2 j 2 + d using (4.22), (4.23) = r2 \u2212 2r\u221a\u2211d\nj=1 a 2 j\n+ 1\u2211d j=1 a 2 j + d.\nSince by definition, r \u2265 d2 \u221a\u2211d j=1 a 2 j + 1, we can write\n\u2016x\u0304\u2212 y\u20162 \u2264 r2 \u2212 d\u2212 2\u221a\u2211d j=1 a 2 j + 1\u2211d j=1 a 2 j + d\n= r2 \u2212 1\u2211d j=1 a 2 j \u2264 r2.\nThis proves that the chosen ball { x \u2208 Rd | \u2016x\u2212 y\u20162 \u2264 r2 } includes the same points from {0, 2}d as the linear inequality aTx \u2264 b.\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 13\nThe encoding length of all data is furthermore polynomial in the encoding length of the initial inequalities. This completes the reduction and proves the NP-hardness of MNBC.\nNote that the NP-hardness of MNBC is independent from the choice of the norm used over the state space X . The two results follow:\nCOROLLARY 4.7. ( P \u2032\u2032(u0,u1)2 ) is NP-hard.\nTHEOREM 4.8. The two-stage problem ( P(u0,u1)2 ) and the generalized T\u2212stage prob-\nlem (PT (F , Lf , L\u03c1, x0, u0, . . . , uT\u22121)) are NP-hard.\n5. Relaxation Schemes for the Two-stage Case. The two-stage case with only one element in the set F (u1) was proven to be NP-hard in the previous section (except if the cardinality of n(u0) of F (u0) is also equal to 1, in this case (P(u0,u1)2 ) is solvable in polynomial time as we will see later in Corollary 5.3). It is therefore unlikely that one can design an algorithm that optimally solves the general two-stage case in polynomial time (unless P = NP). The aim of the min max optimization problem is to obtain a sequence of actions that has a performance guarantee. Therefore solving the optimization problem approximately or obtaining an upper bound would be irrelevant. Instead we want to propose some relaxation schemes that are computationally more tractable, and that are still leading to lower bounds on the actual return of the sequences of actions.\nThe first relaxation scheme works by dropping some constraints in order to obtain a problem that is solvable in polynomial time. We show that this scheme provides bounds that are greater or equal to the CGRL bound introduced in [22]. The second relaxation scheme is based on a Lagrangian relaxation where all constraints are dualized. Solving the Lagrangian dual is shown to be a conic-quadratic problem that can be solved in polynomial time using interior-point methods. We also prove that this relaxation scheme always gives better bounds than the first relaxation scheme mentioned above, and consequently, better bounds than [22]. We also prove that the bounds computed from these relaxation schemes converge towards the actual return of the sequence (u0, u1) when the sample dispersion converges towards zero. As a consequence, the sequences of actions that maximize those bounds also become optimal when the dispersion decreases towards zero.\nFrom the previous section, we know that the two-stage problem (P(u0,u1)2 ) can be decoupled into two subproblems (P \u2032(u0,u1)2 ) and (P \u2032\u2032(u0,u1) 2 ), where (P \u2032(u0,u1) 2 ) can be solved straightforwardly (cf Theorem 4.2). We therefore only focus on relaxing the subproblem (P \u2032\u2032(u0,u1)2 ):(\nP \u2032\u2032(u0,u1)2 )\n: min r\u03021 \u2208 R x\u03021 \u2208 X r\u03021\nsubject to \u2223\u2223\u2223\u0302r1 \u2212 r(u1),k1 \u2223\u2223\u22232 \u2264 L2\u03c1 \u2225\u2225\u2225x\u03021 \u2212 x(u1),k1\u2225\u2225\u22252 \u2200k1 \u2208 {1, . . . , n(u1)} (5.1)\u2225\u2225\u2225x\u03021 \u2212 y(u0),k0\u2225\u2225\u22252 \u2264 L2f \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u22252 \u2200k0 \u2208 {1, . . . , n(u0)} (5.2)\n5.1. The Trust-region Subproblem Relaxation Scheme. An easy way to obtain a relaxation from an optimization problem is to drop some constraints. We therefore suggest to drop all constraints (5.1) but one, indexed by k1. Similarly we drop all constraints (5.2) but one, indexed by k0. The following problem is therefore a relaxation of (P \u2032\u2032(u0,u1)2 ):\n14 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux( P \u2032\u2032(u0,u1)TR (k0, k1) ) :\nmin r\u03021 \u2208 R x\u03021 \u2208 X\nr\u03021\nsubject to \u2223\u2223\u2223\u0302r1 \u2212 r(u1),k1\u2223\u2223\u22232 \u2264 L2\u03c1 \u2225\u2225\u2225x\u03021 \u2212 x(u1),k1\u2225\u2225\u22252 , (5.3)\u2225\u2225\u2225x\u03021 \u2212 y(u0),k0\u2225\u2225\u22252 \u2264 L2f \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u22252 . (5.4) We then have the following theorem: THEOREM 5.1. Let us denote by B\u2032\u2032(u0,u1),k0,k1TR (F) the bound given by the resolution\nof (P \u2032\u2032(u0,u1)TR (k0, k1)). We have:\nB \u2032\u2032(u0,u1),k0,k1 TR (F) = r (u1),k1 \u2212 L\u03c1 \u2225\u2225\u2225x\u0302\u22171(k0, k1)\u2212 x(u1),k1\u2225\u2225\u2225 ,\nwhere\nx\u0302\u22171(k0, k1) . = y(u0),k0 + Lf \u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u2225\u2225y(u0),k0 \u2212 x(u1),k1\u2225\u2225 (y(u0),k0 \u2212 x(u1),k1) if y(u0),k0 6= x(u1),k1 and, if y(u0),k0 = x(u1),k1 , x\u0302\u22171(k0, k1) can be any point of the sphere centered in y\n(u0),k0 = x(u1),k1 with radius Lf\u2016x0 \u2212 x(u0),k0\u2016.\nProof. Observe that it consists in the minimization of r\u03021 under one interval constraint for r\u03021 where the size of the interval is determined through the constraint (5.4). The problem is therefore equivalent to finding the largest right-hand-side of (5.3) under constraint (5.4). An equivalent problem is therefore\nmax x\u03021\u2208X \u2225\u2225\u2225x\u03021 \u2212 x(u1),k1\u2225\u2225\u22252 subject to\n\u2225\u2225\u2225x\u03021 \u2212 y(u0),k0\u2225\u2225\u2225 \u2264 Lf \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u2225 . This is the maximization of a quadratic function under a norm constraint. This problem is referred to in the literature as the trust-region subproblem [13]. In our case, the optimal value for x\u03021 - denoted by x\u0302\u22171(k0, k1) - lies on the same line as x\n(u1),k1 and y(u0),k0 , with y(u0),k0 lying in between x(u1),k1 and x\u0302\u22171(k0, k1), the distance between y\n(u0),k0 and x\u0302\u22171(k0, k1) being exactly equal to the distance between x0 and x(u0),k0 . An illustration is given in Figure 5.1.\nSolving (P \u2032\u2032(u0,u1)TR (k0, k1)) provides us with a family of relaxations for our initial problem by considering any combination (k0, k1) of two non-relaxed constraints. Taking the maximum out of these lower bounds yields the best possible bound out of this family of relaxations. Finally, if we denote by B(u0,u1)TR (F) the bound made of the sum of the solution of (P \u2032(u0,u1)2 ) and the maximal Trust-region relaxation of the problem (P \u2032\u2032(u0,u1) 2 ) over all possible couples of constraints, we have: DEFINITION 5.2 (Trust-region Bound B(u0,u1)TR (F)).\n\u2200(u0, u1) \u2208 U2, B(u0,u1)TR (F) , r\u0302 \u2217 0 + max\nk1 \u2208 {1, . . . , n(u1)} k0 \u2208 {1, . . . , n(u0)}\nB \u2032\u2032(u0,u1),k0,k1 TR (F).\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 15\nNotice that in the case where n(u0) and n(u1) are both equal to 1, then the trust-region relaxation scheme provides an exact solution of the original optimization problem (P(u0,u1)2 ):\nCOROLLARY 5.3.\n\u2200(u0, u1) \u2208 U2, ({\nn(u0) = 1 n(u1) = 1 ) =\u21d2 B(u0,u1)TR (F) = B (u0,u1) 2 (F).\n5.2. The Lagrangian Relaxation. Another way to obtain a lower bound on the value of a minimization problem is to consider a Lagrangian relaxation. In this section, we show that the Lagrangian relaxation of the second stage problem is a conic quadratic optimization program. Consider again the optimization problem (P \u2032\u2032(u0,u1)2 ). If we multiply the constraints (5.1) by dual variables \u00b51, . . . , \u00b5k1 , . . . , \u00b5n(u1) \u2265 0 and the constraints (5.2) by dual variables \u03bb1, . . . , \u03bbk0 , . . . , \u03bbn(u0) \u2265 0, we obtain the Lagrangian dual:( P \u2032\u2032(u0,u1)LD ) :\nmax \u03bb1, . . . , \u03bbn(u0) \u2208 R+ \u00b51, . . . , \u00b5n(u1) \u2208 R+ min r\u03021 \u2208 R x\u03021 \u2208 X\nr\u03021\n+ n(u1)\u2211 k1=1 \u00b5k1 (( r\u03021 \u2212 r(u1),k1 )2 \u2212 L2\u03c1 \u2225\u2225\u2225x\u03021 \u2212 x(u1),k1\u2225\u2225\u22252)\n+ n(u0)\u2211 k0=1 \u03bbk0 (\u2225\u2225\u2225x\u03021 \u2212 y(u0),k0\u2225\u2225\u22252 \u2212 L2f \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u22252) . (5.5)\nObserve that the optimal value of (P \u2032\u2032(u0,u1)LD ) is known to provide a lower bound on the optimal value of (P \u2032\u2032(u0,u1)2 ) [25].\nTHEOREM 5.4. ( P \u2032\u2032(u0,u1)LD ) is a conic quadratic program.\n16 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nProof. In (5.5), we can decompose the squared norms and obtain( P \u2032\u2032(u0,u1)LD ) :\nmax \u03bb1, . . . , \u03bbn(u0) \u2208 R+ \u00b51, . . . , \u00b5n(u1) \u2208 R+ min r\u03021 \u2208 R x\u03021 \u2208 X\nr\u030221 n(u1)\u2211 k1=1 \u00b5k1 + \u2016x\u03021\u20162 \u2212L2\u03c1 n(u1)\u2211 k1=1 \u00b5k1 + n(u0)\u2211 k0=1 \u03bbk0  (5.6)\n+ r\u03021 1\u2212 2 n(u1)\u2211 k1=1 r(u1),k1 + n(u1)\u2211 k1=1 2L2\u03c1\u00b5k1 \u2329 x\u03021, x (u1),k1 \u232a \u2212 n(u0)\u2211 k0=1 2\u03bbk0 \u2329 x\u03021, y (u0),k0 \u232a\n(5.7)\n+ n(u1)\u2211 k1=1 \u00b5k1 (( r(u1),k1 )2 \u2212 L2\u03c1 \u2225\u2225\u2225x(u1),k1\u2225\u2225\u22252)\n+ n(u0)\u2211 k0=1 \u03bbk0 (\u2225\u2225\u2225y(u0),k0\u2225\u2225\u22252 \u2212 L2f \u2225\u2225\u2225x(u0),k0 \u2212 x0\u2225\u2225\u22252) , (5.8) where \u3008a, b\u3009 denotes the inner product of a and b. We observe that the minimization problem in r\u03021 and x\u03021 contains a quadratic part (5.6), a linear part (5.7) and a constant part (5.8) once we fix \u03bbk0 and \u00b5k1 . In particular, observe that the optimal solution of the minimization problem is \u2212\u221e as soon as the quadratic term is negative, i.e. if :\nn(u1)\u2211 k1=1 \u00b5k1 \u2264 0 (5.9)\nor \u2212L2\u03c1 n(u1)\u2211 k1=1 \u00b5k1 + n(u0)\u2211 k0=1 \u03bbk0  \u2264 0. (5.10) Since we want to find the maximum of this series of optimization problems, we are only interested in the problems for which the solution is finite. Observe that, since \u00b5k1 \u2265 0 for all k1, the inequality (5.9) is never satisfied, unless if \u00b5k1 = 0 for all k1. Therefore in the following, we will constraint \u03bbk0 and \u00b5k1 to be such that inequalities (5.9) and (5.10) are never satisfied, i.e.:\nn(u1)\u2211 k1=1 \u00b5k1 > 0\n\u2212L2\u03c1 n(u1)\u2211 k1=1 \u00b5k1 + n(u0)\u2211 k0=1 \u03bbk0 > 0.\nOnce that constraint is enforced, we observe that the minimization program is the minimization of a convex quadratic function for which the optimum can be found as a closed form formula. In order to simplify the rest of the proof, we introduce some useful notations:\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 17\nDEFINITION 5.5 (Additional Notations).\nM , n(u1)\u2211 k1=1 \u00b5k1 , L , n(u0)\u2211 k0=1 \u03bbk0 ,\nX , ( x(u1),1 \u00b7 \u00b7 \u00b7x(u1),n (u1) ) , Y , ( y(u0),1 \u00b7 \u00b7 \u00b7 y(u0),n (u0) ) , \u03bb , ( \u03bb1 . . . \u03bbn(u0) )T , \u00b5 , ( \u00b51 . . . \u00b5n(u1) )T , r\u0304 , ( r(1) . . . r(n (u1)) )T ,\n\u2200p \u2208 N0, Ip is an identity matrix of size p.\nThe quadratic form coming from (5.6), (5.7) and (5.8) can be written in the form\nzTQz + lT z + c\nwith\nz , ( x\u03021 r\u03021 ) \u2208 Rd+1, Q , ( ( \u2212ML2\u03c1 + L ) Id M ) , l , ( 2L2\u03c1X\u00b5\u2212 2Y \u03bb 1\u2212 2r\u0304T\u00b5 )\nand the constant term is given by (5.8). The minimum of a convex quadratic form zTQz + lT z + c is known to take the value \u2212 14 l\nTQ\u22121l+ c. In our case, the inverse of the matrix Q is trivial to compute and we obtain finally that (P \u2032\u2032(u0,u1)LD ) can be written as\n( P \u2032\u2032(u0,u1)LD ) : max \u03bb\u2208Rn(u0)+ ,\u00b5\u2208Rn (u1) + \u2212\u2016L2\u03c1X\u00b5\u2212 Y \u03bb\u20162 \u2212ML2\u03c1 + L \u2212 ( 1\u2212 2r\u0304T\u00b5 )2 4M\n(5.11)\n+ n(u0)\u2211 k0=1 \u03bbk0 (\u2225\u2225\u2225y(u0),k0\u2225\u2225\u22252 \u2212 L2f \u2225\u2225\u2225x(u0),k0 \u2212 x0\u2225\u2225\u22252)\n+ n(u1)\u2211 k1=1 \u00b5k1 (( r(u1),k1 )2 \u2212 L2\u03c1 \u2225\u2225\u2225x(u1),k1\u2225\u2225\u22252)\nsubject to M > 0 L > ML2\u03c1\nThe optimization problem (5.11) is in variables \u03bb1, . . . , \u03bbn(u0) and \u00b51, . . . , \u00b5n(u1) . Observe that, with our notation, M and L are linear functions of the variables. The objective function contains linear terms in \u03bb1, . . . , \u03bbn(u0) and \u00b51, . . . , \u00b5n(u1) as well as a fractionalquadratic function ([5]), i.e. the quotient of a concave quadratic function with a linear function. The constraint is linear. This type of problem is known as a rotated quadratic conic problem and can be formulated as a conic quadratic optimization problem ([5]) that can be solved in polynomial time using interior point methods [5, 37, 9].\n18 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nFrom there, we have the following corollary: COROLLARY 5.6. \u2200(u0, u1) \u2208 U2,\nB \u2032\u2032(u0,u1) LD (F) , max\n\u03bb\u2208Rn(u0)+ ,\u00b5\u2208Rn (u1) +\n\u2212\u2016L2\u03c1X\u00b5\u2212 Y \u03bb\u20162 \u2212ML2\u03c1 + L \u2212 ( 1\u2212 2r\u0304T\u00b5 )2 4M\n(5.12)\n+ n(u0)\u2211 k0=1 \u03bbk0 (\u2225\u2225\u2225y(u0),k0\u2225\u2225\u22252 \u2212 L2f \u2225\u2225\u2225x(u0),k0 \u2212 x0\u2225\u2225\u22252) (5.13) +\nn(u1)\u2211 k1=1 \u00b5k1 (( r(u1),k1 )2 \u2212 L2\u03c1 \u2225\u2225\u2225x(u1),k1\u2225\u2225\u22252)\nsubject to M > 0\nL > ML2\u03c1\nIn the following, we denote by B(u0,u1)LD (F) the lower bound made of the sum of the solution of (P \u2032(u0,u1)2 ) and the relaxation of (P \u2032\u2032(u0,u1) 2 ) computed from the Lagrangian relaxation:\nDEFINITION 5.7 (Lagrangian Relaxation Bound B(u0,u1)LD (F)).\n\u2200(u0, u1) \u2208 U2, B(u0,u1)LD (F) , r\u0302 \u2217 0 +B \u2032\u2032(u0,u1) LD (F) (5.14)\n5.3. Comparing the Bounds. The CGRL algorithm proposed in [21, 22] for addressing the min max problem uses the procedure described in [20] for computing a lower bound on the return of a policy given a sample of trajectories. More specifically, for a given sequence (u0, u1) \u2208 U2, the program (PT (F , Lf , L\u03c1, x0, u0, . . . , uT\u22121)) is replaced by a lower bound B\n(u0,u1) CGRL (F). We may now wonder how this bound compares in the two-stage case with the two new bounds of ( P(u0,u1)2 ) that we have proposed: the trust-region bound and the Lagrangian relaxation bound.\n5.3.1. Trust-region Versus CGRL. We first recall the definition of the CGRL bound in the two-stage case.\nDEFINITION 5.8 (CGRL Bound B(u0,u1)CGRL (F)). \u2200(u0, u1) \u2208 U2,\nB (u0,u1) CGRL (F) , max\nk1 \u2208 {1, . . . , n(u1)} k0 \u2208 {1, . . . , n(u0)}\nr(u0),k0 \u2212 L\u03c1(1 + Lf ) \u2225\u2225\u2225x(u0),k0 \u2212 x0\u2225\u2225\u2225\n+r(u1),k1 \u2212 L\u03c1 \u2225\u2225\u2225y(u0),k0 \u2212 x(u1),k1\u2225\u2225\u2225 .\nThe following theorem shows that the Trust-region bound is always greater than or equal to the CGRL bound.\nTHEOREM 5.9.\n\u2200(u0, u1) \u2208 U2, B(u0,u1)CGRL (F) \u2264 B (u0,u1) TR (F) .\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 19\nProof. Let k\u22170 \u2208 { 1, . . . , n(u0) } and k\u22171 \u2208 { 1, . . . , n(u1) } be such that\nB (u0,u1) CGRL (F) = r (u0),k \u2217 0 \u2212 L\u03c1(1 + Lf ) \u2225\u2225\u2225x(u0),k\u22170 \u2212 x0\u2225\u2225\u2225+ r(u1),k\u22171 \u2212 L\u03c1 \u2225\u2225\u2225y(u0),k\u22170 \u2212 x(u1),k\u22171\u2225\u2225\u2225 . Now, let us consider the solution B\u2032\u2032(u0,u1),k \u2217 0 ,k \u2217 1\nTR (F) of the problem (P \u2032\u2032(u0,u1) TR (k \u2217 0 , k \u2217 1)), and\nlet us denote byB(u0,u1),k \u2217 0 ,k \u2217 1 the bound obtained if, in the definition of the value of r\u0302\u22170 given in Corollary 4.3, we fix the value of k\u20320 to k \u2217 0 instead of maximizing over all possible k \u2032 0:\nB(u0,u1),k \u2217 0 ,k \u2217 1 = r(u0),k \u2217 0 \u2212 L\u03c1 \u2225\u2225\u2225x0 \u2212 x(u0),k\u22170\u2225\u2225\u2225+B\u2032\u2032(u0,u1),k\u22170 ,k\u22171TR (F) Since r(u0),k \u2217 0 \u2212L\u03c1\n\u2225\u2225x0 \u2212 x(u0),k\u22170\u2225\u2225 is smaller or equal to the solution r\u0302\u22170 of (P \u2032(u0,u1)2 ), one has:\nB (u0,u1),k\n\u2217 0 ,k \u2217 1\nTR (F) \u2265 B (u0,u1),k\n\u2217 0 ,k \u2217 1 . (5.15)\nNow, observe that:\nB(u0,u1),k \u2217 0 ,k \u2217 1 \u2212B(u0,u1)CGRL (F) = L\u03c1Lf \u2225\u2225\u2225x(u0),k\u22170 \u2212 x0\u2225\u2225\u2225+ L\u03c1 \u2225\u2225\u2225y(u0),k\u22170 \u2212 x(u1),k\u22171\u2225\u2225\u2225 \u2212 L\u03c1\n\u2225\u2225\u2225x\u0302\u22171(k\u22170 , k\u22171)\u2212 x(u1),k\u22171\u2225\u2225\u2225 . (5.16) By construction, x\u0302\u22171(k \u2217 0 , k \u2217 1) lies on the same line as y (u0),k \u2217 0 and x(u1),k \u2217 1 (see Figure 5.1). Furthermore\u2225\u2225\u2225x\u0302\u22171(k\u22170 , k\u22171)\u2212 x(u1),k\u22171\u2225\u2225\u2225 = \u2225\u2225\u2225x\u0302\u22171(k\u22170 , k\u22171)\u2212 y(u0),k\u22170\u2225\u2225\u2225+ \u2225\u2225\u2225y(u0),k\u22170 \u2212 x(u1),k\u22171\u2225\u2225\u2225 . (5.17) Using (5.17) in (5.16) yields\nB(u0,u1),k \u2217 0 ,k \u2217 1 \u2212B(u0,u1),k \u2217 0 ,k \u2217 1 CGRL (F) = L\u03c1Lf \u2225\u2225\u2225x(u0),k\u22170 \u2212 x0\u2225\u2225\u2225\n+L\u03c1 (\u2225\u2225\u2225y(u0),k\u22170 \u2212 x(u1),k\u22171\u2225\u2225\u2225\u2212 \u2225\u2225\u2225x\u0302\u22171(k\u22170 , k\u22171)\u2212 y(u0),k\u22170\u2225\u2225\u2225\u2212 \u2225\u2225\u2225y(u0),k\u22170 \u2212 x(u1),k\u22171\u2225\u2225\u2225) = L\u03c1 ( Lf\n\u2225\u2225\u2225x(u0),k\u22170 \u2212 x0\u2225\u2225\u2225\u2212 \u2225\u2225\u2225x\u0302\u22171(k\u22170 , k\u22171)\u2212 y(u0),k\u22170\u2225\u2225\u2225) . (5.18) By construction, Equation (5.18) is equal to 0 (see Figure 5.1), which proves the equality of the two bounds:\nB(u0,u1),k \u2217 0 ,k \u2217 1 = B (u0,u1) CGRL (F) . (5.19)\nThe final result is given by combining Equations (5.15) and (5.19). From the proof, one can observe that the gap between the CGRL bound and the Trustregion bound is only due to the resolution of (P \u2032(u0,u1)2 ). Note that in the case where k\u22170 also belongs to the set arg max\nk0\u2208{1,...,n(u0)} r(u0),k0 \u2212 L\u03c1 \u2225\u2225x(u0),k0 \u2212 x0\u2225\u2225, then the bounds are equal. The two corollaries follow:\nCOROLLARY 5.10. Let (u0, u1) \u2208 U2. Let k\u22170 \u2208 { 1, . . . , n(u0) } and k\u22171 \u2208 { 1, . . . , n(u1) }\nbe such that:\nB (u0,u1) CGRL (F) = r (u0),k \u2217 0 \u2212 L\u03c1(1 + Lf ) \u2225\u2225\u2225x(u0),k\u22170 \u2212 x0\u2225\u2225\u2225+ r(u1),k\u22171 \u2212 L\u03c1 \u2225\u2225\u2225y(u0),k\u22170 \u2212 x(u1),k\u22171\u2225\u2225\u2225 .\n20 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nThen,( k\u22170 \u2208 arg max\nk0\u2208{1,...,n(u0)} r(u0),k0 \u2212 L\u03c1 \u2225\u2225\u2225x(u0),k0 \u2212 x0\u2225\u2225\u2225) =\u21d2 B(u0,u1)CGRL (F) = B(u0,u1)TR (F) . COROLLARY 5.11.\n\u2200(u0, u1) \u2208 U2, ( n(u0) = 1 ) =\u21d2 B(u0,u1)CGRL (F) = B (u0,u1) TR (F) .\n5.3.2. Lagrangian Relaxation Versus Trust-region. In this section, we prove that the lower bound obtained with the Lagrangian relaxation is always greater than or equal to the Trust-region bound. To prove this result, we give a preliminary lemma:\nLEMMA 5.12. Let (u0, u1) \u2208 U2 and (k0, k1) \u2208 { 1, . . . , n(u0) } \u00d7 { 1, . . . , n(u1) } .\nConsider again the problem ( P \u2032\u2032(u0,u1)TR (k0, k1) ) where all constraints are dropped except the two defined by (k0, k1):( P \u2032\u2032(u0,u1)TR (k0, k1) ) : min\nr\u03021 \u2208 R x\u03021 \u2208 X\nr\u03021\nsubject to \u2223\u2223\u2223\u0302r1 \u2212 r(u1),k1 \u2223\u2223\u22232 \u2264 L2\u03c1 \u2225\u2225\u2225x\u03021 \u2212 x(u1),k1\u2225\u2225\u22252\u2225\u2225\u2225x\u03021 \u2212 y(u0),k0\u2225\u2225\u22252 \u2264 L2f \u2225\u2225\u2225x0 \u2212 x(u0),k0\u2225\u2225\u22252 .\nThen, the Lagrangian relaxation of ( P \u2032\u2032(u0,u1)TR (k0, k1) ) leads to a bound denoted by B \u2032\u2032(u0,u1),k0,k1 LD (F) which is equal to the Trust-region bound B \u2032\u2032(u0,u1),k0,k1 TR (F), i.e.\nB \u2032\u2032(u0,u1),k0,k1 LD (F) = B \u2032\u2032(u0,u1),k0,k1 TR (F) .\nProofs of this lemma can be found in [3] and [8], but we also provide in Appendix A a proof in our particular case. We then have the following theorem:\nTHEOREM 5.13.\n\u2200 (u0, u1) \u2208 U2, B(u0,u1)TR (F) \u2264 B (u0,u1) LD (F).\nProof. Let (u0, u1) \u2208 U2. Let (k\u22170 , k\u22171) \u2208 { 1, . . . , n(u0) } \u00d7 { 1, . . . , n(u1) } be such that:\nB (u0,u1) TR (F) = r\u0302 \u2217 0 +B\n\u2032\u2032(u0,u1),k\u22170 ,k \u2217 1 TR (F).\nConsidering (k0, k1) = (k\u22170 , k \u2217 1) in Lemma 5.12, we have:\nB (u0,u1) TR (F) = r\u0302 \u2217 0 +B\n\u2032\u2032(u0,u1),k\u22170 ,k \u2217 1 LD (F) (5.20)\nThen, one can observe that the Lagrangian relaxation of the problem (P \u2032\u2032(u0,u1)TR (k\u22170 , k\u22171)) - from whichB\u2032\u2032(u0,u1),k \u2217 0 ,k \u2217 1\nLD (F) is computed - is also a relaxation of the problem (P \u2032\u2032(u0,u1) LD )\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 21\nfor which all the dual variables corresponding to constraints that are not related with the system transitions ( x(u0),k \u2217 0 , r(u0),k \u2217 0 , y(u0),k \u2217 0 ) and ( x(u1),k \u2217 1 , r(u1),k \u2217 1 , y(u1),k \u2217 1 ) would be forced to zero, i.e.\nB \u2032\u2032(u0,u1),k\u22170 ,k \u2217 1\nLD (F) = max \u03bb\u2208Rn(u0)+ ,\u00b5\u2208Rn (u1) +\n\u2212\u2016L2\u03c1X\u00b5\u2212 Y \u03bb\u20162 \u2212ML2\u03c1 + L \u2212 ( 1\u2212 2r\u0304T\u00b5 )2 4M\n+ n(u0)\u2211 k0=1 \u03bbk0 (\u2225\u2225\u2225y(u0),k0\u2225\u2225\u22252 \u2212 L2f \u2225\u2225\u2225x(u0),k0 \u2212 x\u03020\u2225\u2225\u22252)\n+ n(u1)\u2211 k1=1 \u00b5k1 (( r(u1),k1 )2 \u2212 L2\u03c1 \u2225\u2225\u2225x(u1),k1\u2225\u2225\u22252) subject to M > 0 ,\nL > ML2\u03c1 , \u03bbk0 = 0 if k0 6= k\u22170 ,\u2200k0 \u2208 { 1, . . . , n(u0) } ,\n\u00b5k1 = 0 if k1 6= k\u22171 ,\u2200k1 \u2208 { 1, . . . , n(u1) } .\nWe therefore have:\nB \u2032\u2032(u0,u1),k\u22170 ,k \u2217 1 LD (F) \u2264 B \u2032\u2032(u0,u1) LD (F) . (5.21)\nBy definition of the Lagrangian relaxation bound B(u0,u1)LD (F), we have:\nB (u0,u1) LD (F) = r\u0302 \u2217 0 +B \u2032\u2032(u0,u1) LD (F) (5.22)\nEquations (5.20), (5.21) and (5.22) finally give:\nB (u0,u1) TR (F \u2032) = B (u0,u1) LD (F) .\n5.3.3. Bounds Inequalities: Summary. We summarize in the following theorem all the results that were obtained in the previous sections.\nTHEOREM 5.14. \u2200 (u0, u1) \u2208 U2,\nB (u0,u1) CGRL (F) \u2264 B (u0,u1) TR (F) \u2264 B (u0,u1) LD (F) \u2264 B (u0,u1) 2 (F) \u2264 J (u0,u1) 2 .\nProof. Let (u0, u1) \u2208 U2. The inequality\nB (u0,u1) CGRL (F) \u2264 B (u0,u1) TR (F) \u2264 B (u0,u1) LD (F) (5.23)\nis a straightforward consequence of Theorems 5.9 and 5.13. The inequality\nB (u0,u1) LD (F) \u2264 B (u0,u1) 2 (F) (5.24)\nis a property of the Lagrangian relaxation, and the inequality\nB (u0,u1) 2 (F) \u2264 J (u0,u1) 2\nis derived from the formalization of the min max generalization problem introduced in [22].\n22 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\n5.4. Convergence Properties. We finally propose to analyze the convergence of the bounds, as well as the sequences of actions that lead to the maximization of the bounds, when the sample dispersion decreases towards zero. We assume in this section that the state space X is bounded:\n\u2203CX > 0 : \u2200(x, x\u2032) \u2208 X 2, \u2016x\u2212 x\u2032\u2016 \u2264 CX .\nLet us now introduce the sample dispersion: DEFINITION 5.15 (Sample Dispersion). Since X is bounded, one has:\n\u2203 \u03b1 > 0 : \u2200u \u2208 U , sup x\u2208X\nmin k\u2208{1,...,n(u)} \u2225\u2225\u2225x(u),k \u2212 x\u2225\u2225\u2225 \u2264 \u03b1 . (5.25) The smallest \u03b1 which satisfies equation (5.25) is named the sample dispersion and is denoted by \u03b1\u2217(F). Intuitively, the sample dispersion \u03b1\u2217(F) can be seen as the radius of the largest non-visited state space area.\n5.4.1. Bounds. We analyze in this subsection the tightness of the Trust-region and the Lagrangian relaxation lower bounds as a function of the sample dispersion.\nLEMMA 5.16. \u2203 C > 0 : \u2200(u0, u1) \u2208 U2,\u2200B(u0,u1)(F) \u2208 { B (u0,u1) CGRL (F), B (u0,u1) TR (F), B (u0,u1) LD (F) } ,\nJ (u0,u1) 2 \u2212B(u0,u1)(F) \u2264 C\u03b1\u2217(F).\nProof. The proof for the case where B(u0,u1)(F) = B(u0,u1)CGRL (F) is given in [21]. According to Theorem 5.14, one has:\n\u2200 (u0, u1) \u2208 U2, B(u0,u1)CGRL (F) \u2264 B (u0,u1) TR (F) \u2264 B (u0,u1) LD (F) \u2264 J (u0,u1) 2 ,\nwhich ends the proof. We therefore have the following theorem: THEOREM 5.17.\n\u2200(u0, u1) \u2208 U2,\u2200B(u0,u1)(F) \u2208 { B (u0,u1) CGRL (F), B (u0,u1) TR (F), B (u0,u1) LD (F) } ,\nlim \u03b1\u2217(F)\u21920\nJ (u0,u1) 2 \u2212B(u0,u1)(F) = 0 .\n5.4.2. Bound-optimal Sequences of Actions. In the following, we denote byB(\u2217)CGRL (F) (resp. B(\u2217)TR (F) and B (\u2217) LD (F) ) the maximal CGRL bound (resp. the maximal Trust-region bound and maximal Lagrangian relaxation bound) over the set of all possible sequences of actions, i.e.,\nDEFINITION 5.18 (Maximal Bounds).\nB (\u2217) CGRL (F) , max\n(u0,u1)\u2208U2 B\n(u0,u1) CGRL (F) ,\nB (\u2217) TR (F) , max\n(u0,u1)\u2208U2 B\n(u0,u1) TR (F) ,\nB (\u2217) LD (F) , max\n(u0,u1)\u2208U2 B\n(u0,u1) LD (F) .\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 23\nWe also denote by (u0, u1) CGRL F (resp. (u0, u1) TR F and (u0, u1) LD F ) three sequences of\nactions that maximize the bounds: DEFINITION 5.19 (Bound-optimal Sequences of Actions).\n(u0, u1) CGRL F \u2208 { (u0, u1) \u2208 U2|B(u0,u1)CGRL (F) = B (\u2217) CGRL (F) } (u0, u1) TR F \u2208 { (u0, u1) \u2208 U2|B(u0,u1)TR (F) = B (\u2217) TR (F)\n} (u0, u1) LD F \u2208 { (u0, u1) \u2208 U2|B(u0,u1)LD (F) = B (\u2217) LD (F)\n} We finally give in this section a last theorem that shows the convergence of the sequences\nof actions (u0, u1) CGRL F , (u0, u1) TR F and (u0, u1) LD F towards optimal sequences of actions - i.e. sequences of actions that lead to an optimal return J\u22172 - when the sample dispersion \u03b1\u2217(F) decreases towards zero.\nTHEOREM 5.20. Let J\u2217 be the set of optimal two-stage sequences of actions:\nJ\u22172 , { (u0, u1) \u2208 U2|J (u0,u1)2 = J\u22172 } ,\nand let us suppose that J\u22172 6= U2 (if J\u22172 = U2, the search for an optimal sequence of actions is indeed trivial). We define\n, min (u0,u1)\u2208U2\\J\u22172\n{ J\u22172 \u2212 J (u0,u1) 2 } .\nThen, \u2200 (u\u03030, u\u03031)F \u2208 { (u0, u1) CGRL F , (u0, u1) TR F , (u0, u1) LD F } ,(\nC\u03b1\u2217(F) < )\n=\u21d2 (u\u03030, u\u03031)F \u2208 J \u2217 2 . (5.26)\nProof. Let us prove the theorem by contradiction. Let us assume that C\u03b1\u2217(F) < . Let B(u0,u1)(F) \u2208 { B\n(u0,u1) CGRL (F), B (u0,u1) TR (F), B (u0,u1) LD (F) } , and let (u\u03030, u\u03031)F be a sequence\nsuch that\n(u\u03030, u\u03031)F \u2208 arg max (u0,u1)\u2208U2 B(u0,u1)(F)\nand let us assume that (u\u03030, u\u03031)F is not optimal. This implies that\nJ (u\u03030,u\u03031)F 2 \u2264 J\u22172 \u2212 .\nNow, let us consider a sequence (u\u22170, u \u2217 1) \u2208 J\u22172. Then\nJ (u\u22170 ,u \u2217 1)\n2 = J \u2217 2 .\nThe lower bound B(u \u2217 0 ,u \u2217 1)(F) satisfies the relationship\nJ\u22172 \u2212B(u \u2217 0 ,u \u2217 1)(F) \u2264 C\u03b1\u2217(F).\nKnowing that C\u03b1\u2217(F) < , we have\nB(u \u2217 0 ,u \u2217 1)(F) > J\u22172 \u2212 .\n24 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nSince\nJ (u\u03030,u\u03031)F 2 \u2265 B(u\u03030,u\u03031)F (F),\nwe have\nB(u \u2217 0 ,u \u2217 1)(F) > B(u\u03030,u\u03031)F (F)\nwhich contradicts the fact that (u\u03030, u\u03031)F belongs to the set arg max (u0,u1)\u2208U2 B(u0,u1)(F). This ends the proof.\n5.4.3. Remark. It is important to notice that the tightness of the bounds resulting from the relaxation schemes proposed in this paper does not depend explicitly on the sample dispersion (which suffers from the curse of dimensionality), but depends rather on the initial state for which the sequence of actions is computed and on the local concentration of samples around the actual (unknown) trajectories of the system. Therefore, this may lead to cases where the bounds are tight for some specific initial states, even if the sample does not cover every area of the state space well enough.\n6. Experimental Results. We provide some experimental results to illustrate the theoretical properties of the CGRL, Trust-region and Lagrangian relaxation bounds given below. We compare the tightness of the bounds, as well as the performances of the bound-optimal sequences of actions, on an academic benchmark.\n6.1. Benchmark. We consider a linear benchmark whose dynamics is defined as follows :\n\u2200(x, u) \u2208 X \u00d7 U , f(x, u) = x+ 3.1416\u00d7 u\u00d7 1d,\nwhere 1d \u2208 Rd denotes a d\u2212dimensional vector for which each component is equal to 1. The reward function is defined as follows:\n\u2200(x, u) \u2208 X \u00d7 U , \u03c1(x, u) = d\u2211 i=1 x(i) ,\nwhere x(i) denotes the i\u2212th component of x. The state space X is included in Rd and the finite action space is equal to U = {0, 0.1}. The system dynamics f is 1\u2212Lipschitz continuous and the reward function is \u221a d\u2212Lipschitz continuous. The initial state of the system is set to\nx0 = 0.5772\u00d7 1d .\nThe dimension d of the state space is set to d = 2. In all our experiments, the computation of the Lagrangian relaxations, which requires to solve a conic-quadratic program, are done using SeDuMi [47]."}, {"heading": "6.2. Protocol and Results.", "text": "6.2.1. Typical Run. For different cardinalities ci = 2i2, i = 1, . . . , 15, we generate a sample of transitions Fci using a grid over [0, 1]d \u00d7 U , as follows: \u2200u \u2208 U ,\nF (u)ci = {([ i1 i ; i2 i ] , u, \u03c1 ([ i1 i ; i2 i ] , u ) , f ([ i1 i ; i2 i ] , u )) \u2223\u2223\u2223\u2223(i1, i2) \u2208 {1, . . . , i}2}\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 25\nand\nFci = F (0)ci \u222a F (.1) ci\n26 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nWe report in Figure 6.1 the values of the maximal CGRL bound B(\u2217)CGRL (Fci), the maximal Trust-region bound B(\u2217)TR (Fci) and the maximal Lagrangian relaxation bound B (\u2217) LD (Fci) as a function of the cardinality ci of the samples of transitions Fci . We also report in Figure 6.2 the returns J (u0,u1) CGRL Fci 2 , J (u0,u1) TR Fci 2 and J (u0,u1) LD Fci\n2 of the bound-optimal sequences of actions (u0, u1)\nCGRL Fci , (u0, u1) TR Fci and (u0, u1) LD Fci .\nAs expected, we observe that the bound computed with the Lagrangian relaxation is always greater or equal to the Trust-region bound, which is also greater or equal to the CGRL bound as predicted by Theorem 5.14. On the other hand, no difference were observed in terms of return of the bound-optimal sequences of actions.\n6.2.2. Uniformly Drawn Samples of Transitions. In order to observe the influence of the dispersion of the state-action points of the transitions on the quality of the bounds, we propose the following protocol. For each cardinality ci = 2i2, i = 1, . . . , 15, we generate 100 samples of transitionsFci,1, . . . ,Fci,100 using a uniform probability distribution over the space [0, 1]d \u00d7 U . For each sample of transition Fci,k i \u2208 {1, . . . , 15}, k \u2208 {1, . . . , 100}, we compute the maximal CGRL bound B(\u2217)CGRL (Fci,k), the maximal Trust-region bound B\n(\u2217) TR (Fci,k) and the maximal Lagrangian relaxation bound B (\u2217) LD (Fci,k). We then compute\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 27\nthe average values of the maximal CGRL, Trust-region and Lagrangian relaxation bounds :\n\u2200i \u2208 {1, . . . , 15}, ACGRL(ci) = 1\n100 100\u2211 k=1 B (\u2217) CGRL (Fci,k)\nATR(ci) = 1\n100 100\u2211 k=1 B (\u2217) TR (Fci,k)\nALD(ci) = 1\n100 100\u2211 k=1 B (\u2217) LD (Fci,k)\nand we report in Figure 6.3 the values ACGRL(ci) (resp. ATR(ci) and ALD(ci)) as a function of the cardinality ci of the samples of transitions. We also report in Figure 6.4 the average returns of the bound-optimal sequences of actions (u0, u1)\nCGRL Fci,k , (u0, u1) TR Fci,k and\n(u0, u1) LD Fci,k :\n\u2200i \u2208 {1, . . . , 15}, JCGRL(ci) = 1\n100 100\u2211 k=1 J (u0,u1) CGRL Fci,k 2\nJTR(ci) = 1\n100 100\u2211 k=1 J (u0,u1) TR Fci,k 2\nJLD(ci) = 1\n100 100\u2211 k=1 J (u0,u1) LD Fci,k 2 .\nas a function of the cardinality ci of the samples of transitions.\n28 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\nWe observe that, on average, the Lagrangian relaxation bound is much tighter that the Trust-region and the CGRL bounds. The CGRL bound and the Trust-region bound remain very close on average, which illustrates, in a sense, Corollary 5.10. Moreover, we also observe that the bound-optimal sequences of actions (u0, u1)\nLD Fci,k better perform on average.\n7. Conclusions. We have considered in this paper the problem of computing min max policies for deterministic, Lipschitz continuous batch mode reinforcement learning. First, we have shown that this min max problem is NP-hard. Afterwards, we have proposed for the two-stage case two relaxation schemes. Both have been extensively studied and, in particular, they have been shown to perform better than the CGRL algorithm that has been introduced earlier to address this min-max generalization problem.\nA natural extension of this work would be to investigate how the proposed relaxation schemes could be extended to the T -stage (T \u2265 3) framework. Lipschitz continuity assumptions are common in a batch mode reinforcement learning setting, but one could imagine developing min max strategies in other types of environments that are not necessarily Lipschitzian, or even not continuous. Additionnaly, it would also be interesting to extend the resolution schemes proposed in this paper to problems with very large/continuous action spaces.\nAcknowledgements. Raphael Fonteneau is a Post-doctoral fellow of the FRS-FNRS (Funds for Scientific Research). This paper presents research results of the Belgian Network DYSCO (Dynamical Systems, Control and Optimization) funded by the Interuniversity Attraction Poles Programme, initiated by the Belgian State, Science Policy Office. The authors thank Yurii Nesterov for pointing out the idea of using Lagrangian relaxation. The scientific responsibility rests with its authors."}, {"heading": "Appendix A. Proof of Lemma 5.12.", "text": "Proof. For conciseness, we denote ( x(u0),k0 , r(u0),k0 , y(u0),k0 ) ( resp.(\nx(u1),k1 , r(u1),k1 , y(u1),k1 ) ) by ( x0, r0, y0 ) (resp. ( x1, r1, y1 ) ), and \u03bb1 (resp. \u00b51) by \u03bb\n(resp. \u00b5). We assume that x0 6= x0 and x1 6= y0 otherwise the problem is trivial. \u2022 Trust-region solution.\nAccording to Definition 5.2, we have:\nB \u2032\u2032(u0,u1),k0,k1 TR (F) = r 1 \u2212 L\u03c1 \u2225\u2225x\u0302\u22171(k0, k1)\u2212 x1\u2225\u2225 ,\nwhere\nx\u0302\u22171(k0, k1) = y 0 + Lf \u2225\u2225x0 \u2212 x0\u2225\u2225 \u2016y0 \u2212 x1\u2016 ( y0 \u2212 x1 ) ,\nwhich writes\nB \u2032\u2032(u0,u1),k0,k1 TR (F) = r 1 \u2212 L\u03c1 \u2225\u2225\u2225\u2225\u2225y0 + Lf \u2225\u2225x0 \u2212 x0\u2225\u2225 \u2016y0 \u2212 x1\u2016 ( y0 \u2212 x1 ) \u2212 x1 \u2225\u2225\u2225\u2225\u2225 , = r1 \u2212 L\u03c1 \u2225\u2225y0 \u2212 x1\u2225\u2225(1 + Lf \u2225\u2225x0 \u2212 x0\u2225\u2225\u2016y0 \u2212 x1\u2016 )\n= r1 \u2212 L\u03c1 \u2225\u2225y0 \u2212 x1\u2225\u2225\u2212 L\u03c1Lf \u2225\u2225x0 \u2212 x0\u2225\u2225\n\u2022 Lagrangian relaxation based solution.\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 29\nAccording to Equation (5.11), we can write:\nB \u2032\u2032(u0,u1),k0,k1 LD (F) = max\n\u03bb\u2208R+,\u00b5\u2208R+ \u2212 \u2225\u2225L2\u03c1x1\u00b5\u2212 y0\u03bb\u2225\u22252 \u2212\u00b5L2\u03c1 + \u03bb \u2212 ( 1\u2212 2r1\u00b5 )2 4\u00b5\n+\u03bb (\u2225\u2225y0\u2225\u22252 \u2212 L2f \u2225\u2225x0 \u2212 x0\u2225\u22252) + \u00b5((r1)2 \u2212 L2\u03c1 \u2225\u2225x1\u2225\u22252)\nsubject to\n\u00b5 > 0\n\u03bb > \u00b5L2\u03c1\nWe denote by L(\u03bb, \u00b5) the quantity:\nL(\u03bb, \u00b5) = \u2212 \u2225\u2225L2\u03c1x1\u00b5\u2212 y0\u03bb\u2225\u22252 \u2212\u00b5L2\u03c1 + \u03bb \u2212 ( 1\u2212 2r1\u00b5 )2 4\u00b5 + \u03bb (\u2225\u2225y0\u2225\u22252 \u2212 L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)\n+\u00b5 (( r1 )2 \u2212 L2\u03c1 \u2225\u2225x1\u2225\u22252)\nLet \u03bb and \u00b5 be such that \u03bb > \u00b5L2\u03c1. Since the Trust-region solution to (P \u2032\u2032(u0,u1) TR (k0, k1)) is optimal, and by property of the Lagrangian relaxation [25], one has:\nL(\u03bb, \u00b5) \u2264 B\u2032\u2032(u0,u1),k0,k1TR (F) . (A.1)\nIn order to prove the lemma, it is therefore sufficient to determine two values \u03bb0 and \u00b50 such that the inequality (A.1) is an equality. By differentiating L(\u03bb, \u00b5), we obtain, after a long calculation (that we omit here):  \u2202L(\u03bb,\u00b5) \u2202\u03bb = 0 \u2202L(\u03bb,\u00b5) \u2202\u00b5 = 0\n\u03bb > \u00b5L2\u03c1\n =\u21d2 { \u03bb = L\u03c12Lf\u2016x0\u2212x0\u2016 , \u00b5 = 12L\u03c1(\u2016y0\u2212x1\u2016+Lf\u2016x0\u2212x0\u2016) .\nWe denote by \u03bb0 and \u00b50 the following values for the dual variables:\n\u03bb0 , L\u03c1\n2Lf \u2016x0 \u2212 x0\u2016 ,\n\u00b50 , 1\n2L\u03c1 (\u2016y0 \u2212 x1\u2016+ Lf \u2016x0 \u2212 x0\u2016) .\nWe have:\n\u00b50 = 1\n2L\u03c1 (\u2016y0 \u2212 x1\u2016+ Lf \u2016x0 \u2212 x0\u2016) > 0\n\u03bb0 \u00b50 = L2\u03c1\n( 1 + \u2225\u2225y0 \u2212 x1\u2225\u2225 Lf \u2016x0 \u2212 x0\u2016 ) > L2\u03c1 .\n30 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux In the following, we denote (\n1 + \u2016y0\u2212x1\u2016 Lf\u2016x0\u2212x0\u2016 ) byK. We now give the expression ofL(\u03bb0, \u00b50)\nusing only \u00b50 and K:\nL(\u03bb0, \u00b50) = \u2212 L4\u03c1\u00b5 2 0 \u2225\u2225x1 \u2212Ky0\u2225\u22252 \u00b50L2\u03c1(\u22121 +K) \u2212 1 4\u00b50 + r1 \u2212 ( r1 )2 \u00b50\n+\u00b50KL 2 \u03c1 (\u2225\u2225y0\u2225\u22252 \u2212 L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)+ \u00b50 ((r1)2 \u2212 L2\u03c1 \u2225\u2225x1\u2225\u22252) = \u2212 L2\u03c1\u00b50 \u2225\u2225x1 \u2212Ky0\u2225\u22252 K \u2212 1 \u2212 1 4\u00b50 + r1\n+L2\u03c1\u00b50K (\u2225\u2225y0\u2225\u22252 \u2212 L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)\u2212 L2\u03c1\u00b50 \u2225\u2225x1\u2225\u22252 .\nUsing the fact that x1 \u2212Ky0 = x1 \u2212 y0 \u2212 (K \u2212 1)y0, we can write:\nL(\u03bb0, \u00b50) = \u2212 L2\u03c1\u00b50\nK \u2212 1 (\u2225\u2225x1 \u2212 y0\u2225\u22252 + (K \u2212 1)2 \u2225\u2225y0\u2225\u22252 \u2212 2(K \u2212 1)(x1 \u2212 y0)T y0) \u2212 1\n4\u00b50 + r1 + L2\u03c1\u00b50K (\u2225\u2225y0\u2225\u22252 \u2212 L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)\u2212 L2\u03c1 \u2225\u2225x1\u2225\u22252 and\nL(\u03bb0, \u00b50) = \u2212 L2\u03c1\u00b50 K \u2212 1 \u2225\u2225x1 \u2212 y0\u2225\u22252 \u2212 L2\u03c1\u00b50(K \u2212 1)\u2225\u2225y0\u2225\u22252 + 2L2\u03c1\u00b50(x1 \u2212 y0)T y0\n\u2212 1 4\u00b50\n+ r1 + L2\u03c1\u00b50K (\u2225\u2225y0\u2225\u22252 \u2212 L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)\u2212 L2\u03c1 \u2225\u2225x1\u2225\u22252 .\nFrom there,\nL(\u03bb0, \u00b50) = \u2212 L2\u03c1\u00b50 K \u2212 1 \u2225\u2225x1 \u2212 y0\u2225\u22252 + \u2225\u2225y0\u2225\u22252 (\u2212L2\u03c1\u00b50(K \u2212 1)\u2212 2L2\u03c1\u00b50 + L2\u03c1\u00b50K)\n\u22122L2\u03c1\u00b50(x1)T y0 \u2212 1\n4\u00b50 + r1 + L2\u03c1\u00b50K\n( \u2212L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)\u2212 L2\u03c1 \u2225\u2225x1\u2225\u22252 and, since ( \u2212L2\u03c1\u00b50(K \u2212 1)\u2212 2L2\u03c1\u00b50 + L2\u03c1\u00b50K ) = \u2212L2\u03c1\u00b50, we have that\nL(\u03bb0, \u00b50) = \u2212 L2\u03c1\u00b50 K \u2212 1 \u2225\u2225x1 \u2212 y0\u2225\u22252 \u2212 L2\u03c1\u00b50 \u2225\u2225y0\u2225\u22252 \u2212 2L2\u03c1\u00b50(x1)T y0\n\u2212 1 4\u00b50\n+ r1 + L2\u03c1\u00b50K ( \u2212L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)\u2212 L2\u03c1 \u2225\u2225x1\u2225\u22252 and\nL(\u03bb0, \u00b50) = \u2212 L2\u03c1\u00b50 K \u2212 1 \u2225\u2225x1 \u2212 y0\u2225\u22252 \u2212 L2\u03c1\u00b50 (\u2225\u2225y0\u2225\u22252 + \u2225\u2225x1\u2225\u22252 \u2212 2(x1)T y0)\n\u2212 1 4\u00b50\n+ r1 + L2\u03c1\u00b50K ( \u2212L2f \u2225\u2225x0 \u2212 x0\u2225\u22252) .\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 31\nSince (\u2225\u2225y0\u2225\u22252 + \u2225\u2225x1\u2225\u22252 \u2212 2(x1)T y0) = \u2225\u2225x1 \u2212 y0\u2225\u22252, we have: L(\u03bb0, \u00b50) = \u2212 L2\u03c1\u00b50 K \u2212 1 \u2225\u2225x1 \u2212 y0\u2225\u22252 \u2212 L2\u03c1\u00b50 \u2225\u2225x1 \u2212 y0\u2225\u22252\n\u2212 1 4\u00b50\n+ r1 + L2\u03c1\u00b50K ( \u2212L2f \u2225\u2225x0 \u2212 x0\u2225\u22252) = \u2212L2\u03c1\u00b50 \u2225\u2225x1 \u2212 y0\u2225\u22252 K K \u2212 1\n\u2212 1 4\u00b50\n+ r1 + L2\u03c1\u00b50K ( \u2212L2f \u2225\u2225x0 \u2212 x0\u2225\u22252) = \u2212KL2\u03c1\u00b50 (\u2225\u2225x1 \u2212 y0\u2225\u22252 K \u2212 1 + L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)\u2212 1 4\u00b50 + r1 .\nSince K , (\n1 + \u2016y0\u2212x1\u2016 Lf\u2016x0\u2212x0\u2016\n) , we have:\nL(\u03bb0, \u00b50) = \u2212 ( 1 + \u2225\u2225y0 \u2212 x1\u2225\u2225 Lf \u2016x0 \u2212 x\u03020\u2016 ) L2\u03c1\u00b50  \u2225\u2225x1 \u2212 y0\u2225\u22252( 1 + \u2016y\n0\u2212x1\u2016 Lf\u2016x0\u2212x0\u2016\n) \u2212 1\n+ L2f \u2225\u2225x0 \u2212 x0\u2225\u22252  \u2212 1\n4\u00b50 + r1\n= \u2212 L2\u03c1\u00b50 ( Lf \u2225\u2225x0 \u2212 x0\u2225\u2225+ \u2225\u2225y0 \u2212 x1\u2225\u2225) Lf \u2016x0 \u2212 x0\u2016 ( Lf \u2225\u2225x0 \u2212 x0\u2225\u2225\u2225\u2225x1 \u2212 y0\u2225\u22252 \u2016x1 \u2212 y0\u2016 + L2f \u2225\u2225x0 \u2212 x0\u2225\u22252)\n\u2212 1 4\u00b50 + r1\n= \u2212 L2\u03c1\u00b50 ( Lf \u2225\u2225x0 \u2212 x0\u2225\u2225+ \u2225\u2225y0 \u2212 x1\u2225\u2225) (\u2225\u2225x1 \u2212 y0\u2225\u2225+ Lf \u2225\u2225x0 \u2212 x0\u2225\u2225)\u2212 1\n4\u00b50 + r1 .\nSince \u00b50 = 12L\u03c1(\u2016y0\u2212x1\u2016+Lf\u2016x0\u2212x0\u2016) , we finally obtain:\nL(\u03bb0, \u00b50) = \u2212 L\u03c1\n2 (\u2225\u2225y0 \u2212 x1\u2225\u2225+ Lf \u2225\u2225x0 \u2212 x0\u2225\u2225)\u2212 L\u03c1 2 (\u2225\u2225y0 \u2212 x1\u2225\u2225+ Lf \u2225\u2225x0 \u2212 x0\u2225\u2225)+ r1 = r1 \u2212 L\u03c1\n\u2225\u2225y0 \u2212 x1\u2225\u2225\u2212 L\u03c1Lf \u2225\u2225x0 \u2212 x0\u2225\u2225 = B\n\u2032\u2032(u0,u1),k0,k1 TR (F) ,\nwhich ends the proof.\nREFERENCES\n[1] A. BANERJEE AND A.A. TSIATIS, Adaptive two-stage designs in phase ii clinical trials, Statistics in medicine, 25 (2006), pp. 3382\u20133395. [2] T. BAS\u0327AR AND P. BERNHARD, H\u221e-optimal control and related minimax design problems: a dynamic game approach, vol. 5, Birkhauser, 1995. [3] A. BECK AND Y.C. ELDAR, Strong duality in nonconvex quadratic optimization with two quadratic constraints, SIAM Journal on Optimization, 17 (2007), pp. 844\u2013860. [4] A. BEMPORAD AND M. MORARI, Robust model predictive control: A survey, Robustness in Identification and Control, 245 (1999), pp. 207\u2013226. [5] A. BEN-TAL AND A.S. NEMIROVSKI, Lectures on Modern Convex Optimization, Siam, 2001. [6] D.P. BERTSEKAS AND J.N. TSITSIKLIS, Neuro-Dynamic Programming, Athena Scientific, 1996.\n32 R. Fonteneau, D. Ernst, B. Boigelot, Q. Louveaux\n[7] J.R. BIRGE AND F. LOUVEAUX, Introduction to Stochastic Programming, Springer Verlag, 1997. [8] JF BONNANS, J.C. GILBERT, C. LEMARE\u0301CHAL, AND C. SAGASTIZA\u0301BAL, Numerical optimization, theoretical and numerical aspects, 2006. [9] S.P. BOYD AND L. VANDENBERGHE, Convex Optimization, Cambridge Univ Pr, 2004. [10] S.J. BRADTKE AND A.G. BARTO, Linear least-squares algorithms for temporal difference learning, Machine Learning, 22 (1996), pp. 33\u201357. [11] L. BUSONIU, R. BABUSKA, B. DE SCHUTTER, AND D. ERNST, Reinforcement Learning and Dynamic Programming using Function Approximators, Taylor & Francis CRC Press, 2010. [12] E.F. CAMACHO AND C. BORDONS, Model Predictive Control, Springer, 2004. [13] A.R. CONN, N.I.M. GOULD, AND P.L. TOINT, Trust-region Methods, vol. 1, Society for Industrial Mathematics, 2000. [14] K. DARBY-DOWMAN, S. BARKER, E. AUDSLEY, AND D. PARSONS, A two-stage stochastic programming\nwith recourse model for determining robust planting plans in horticulture, Journal of the Operational Research Society, (2000), pp. 83\u201389.\n[15] B. DEFOURNY, D. ERNST, AND L. WEHENKEL, Risk-aware decision making and dynamic programming, Selected for oral presentation at the NIPS-08 Workshop on Model Uncertainty and Risk in Reinforcement Learning, Whistler, Canada, (2008). [16] E. DELAGE AND S. MANNOR, Percentile optimization for Markov decision processes with parameter uncertainty, Operations Research, 58 (2010), pp. 203\u2013213. [17] D. ERNST, P. GEURTS, AND L. WEHENKEL, Tree-based batch mode reinforcement learning, Journal of Machine Learning Research, 6 (2005), pp. 503\u2013556. [18] D. ERNST, M. GLAVIC, F. CAPITANESCU, AND L. WEHENKEL, Reinforcement learning versus model predictive control: a comparison on a power system problem, IEEE Transactions on Systems, Man, and Cybernetics - Part B: Cybernetics, 39 (2009), pp. 517\u2013529. [19] R. FONTENEAU, Contributions to Batch Mode Reinforcement Learning, PhD thesis, University of Lie\u0300ge, 2011. [20] R. FONTENEAU, S. MURPHY, L. WEHENKEL, AND D. ERNST, Inferring bounds on the performance of a control policy from a sample of trajectories, in Proceedings of the 2009 IEEE Symposium on Adaptive Dynamic Programming and Reinforcement Learning (IEEE ADPRL 09), Nashville, TN, USA, 2009. [21] R. FONTENEAU, S.A. MURPHY, L. WEHENKEL, AND D. ERNST, A cautious approach to generalization in reinforcement learning, in Proceedings of the Second International Conference on Agents and Artificial Intelligence (ICAART 2010), Valencia, Spain, 2010. [22] R. FONTENEAU, S. A. MURPHY, L. WEHENKEL, AND D. ERNST, Towards min max generalization in reinforcement learning, in Agents and Artificial Intelligence: International Conference, ICAART 2010, Valencia, Spain, January 2010, Revised Selected Papers. Series: Communications in Computer and Information Science (CCIS), vol. 129, Springer, Heidelberg, 2011, pp. 61\u201377. [23] K. FRAUENDORFER, Stochastic Two-stage Programming, Springer, 1992. [24] L.P. HANSEN AND T.J. SARGENT, Robust Control and Model Uncertainty, American Economic Review, (2001), pp. 60\u201366. [25] J.B. HIRIART-URRUTY AND C. LEMARE\u0301CHAL, Convex Analysis and Minimization Algorithms: Fundamentals, vol. 305, Springer-Verlag, 1996. [26] J.E. INGERSOLL, Theory of Financial Decision Making, Rowman and Littlefield Publishers, Inc., 1987. [27] S. KOENIG, Minimax real-time heuristic search, Artificial Intelligence, 129 (2001), pp. 165\u2013197. [28] M.G. LAGOUDAKIS AND R. PARR, Least-squares policy iteration, Jounal of Machine Learning Research, 4 (2003), pp. 1107\u20131149. [29] M. L. LITTMAN, Markov games as a framework for multi-agent reinforcement learning, in Proceedings of\nthe Eleventh International Conference on Machine Learning (ICML 1994), New Brunswick, NJ, USA, 1994.\n[30] , A tutorial on partially observable markov decision processes, Journal of Mathematical Psychology, 53 (2009), pp. 119 \u2013 125. Special Issue: Dynamic Decision Making. [31] Y. LOKHNYGINA AND A.A. TSIATIS, Optimal two-stage group-sequential designs, Journal of Statistical Planning and Inference, 138 (2008), pp. 489\u2013499. [32] J.K. LUNCEFORD, M. DAVIDIAN, AND A.A. TSIATIS, Estimation of survival distributions of treatment policies in two-stage randomization designs in clinical trials, Biometrics, (2002), pp. 48\u201357. [33] S. MANNOR, D. SIMESTER, P. SUN, AND J.N. TSITSIKLIS, Bias and variance in value function estimation, in Proceedings of the Twenty-first International Conference on Machine Learning (ICML 2004), Banff, Alberta, Canada, 2004. [34] S.A. MURPHY, Optimal dynamic treatment regimes, Journal of the Royal Statistical Society, Series B, 65(2) (2003), pp. 331\u2013366. [35] S.A. MURPHY, An experimental design for the development of adaptive treatment strategies, Statistics in Medicine, 24 (2005), pp. 1455\u20131481. [36] A. NEMIROVSKI, A. JUDITSKY, G. LAN, AND A. SHAPIRO, Robust stochastic approximation approach to\nMin Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 33\nstochastic programming, SIAM Journal on Optimization, 19 (2009), pp. 1574\u20131609. [37] Y. NESTEROV AND A. NEMIROVSKI, Interior point polynomial methods in convex programming, Studies in applied mathematics, 13 (1994). [38] D. ORMONEIT AND S. SEN, Kernel-based reinforcement learning, Machine Learning, 49 (2002), pp. 161\u2013 178. [39] C. PADURARU, D. PRECUP, AND J. PINEAU, A framework for computing bounds for the return of a policy, in Ninth European Workshop on Reinforcement Learning (EWRL9), 2011. [40] C.H. PAPADIMITRIOU, Computational Complexity, John Wiley and Sons Ltd., 2003. [41] M. QIAN AND S.A. MURPHY, Performance guarantees for individualized treatment rules, Tech. Report 498, Department of Statistics, University of Michigan, 2009. [42] M. RIEDMILLER, Neural fitted Q iteration - first experiences with a data efficient neural reinforcement learn-\ning method, in Proceedings of the Sixteenth European Conference on Machine Learning (ECML 2005), Porto, Portugal, 2005, pp. 317\u2013328.\n[43] M. ROVATOUS AND M. LAGOUDAKIS, Minimax search and reinforcement learning for adversarial tetris, in Proceedings of the 6th Hellenic Conference on Artificial Intelligence (SETN\u201910), Athens, Greece, 2010. [44] P. SCOKAERT AND D. MAYNE, Min-max feedback model predictive control for constrained linear systems, IEEE Transactions on Automatic Control, 43 (1998), pp. 1136\u20131142. [45] A. SHAPIRO, A dynamic programming approach to adjustable robust optimization, Operations Research Letters, 39 (2011), pp. 83\u201387. [46] , Minimax and risk averse multistage stochastic programming, tech. report, School of Industrial & Systems Engineering, Georgia Institute of Technology, 2011. [47] J.F. STURM, Using SeDuMi 1.02, a MATLAB toolbox for optimization over symmetric cones, Optimization methods and software, 11 (1999), pp. 625\u2013653. [48] R.S. SUTTON AND A.G. BARTO, Reinforcement Learning, MIT Press, 1998. [49] A.S. WAHED AND A.A. TSIATIS, Optimal estimator for the survival distribution and related quantities for\ntreatment policies in two-stage randomization designs in clinical trials, Biometrics, 60 (2004), pp. 124\u2013 133."}], "references": [{"title": "Adaptive two-stage designs in phase ii clinical trials", "author": ["A. BANERJEE", "A.A. TSIATIS"], "venue": "Statistics in medicine, 25 ", "citeRegEx": "1", "shortCiteRegEx": null, "year": 2006}, {"title": "H\u221e-optimal control and related minimax design problems: a dynamic game approach", "author": ["T. BA\u015eAR", "P. BERNHARD"], "venue": "vol. 5, Birkhauser", "citeRegEx": "2", "shortCiteRegEx": null, "year": 1995}, {"title": "Strong duality in nonconvex quadratic optimization with two quadratic constraints", "author": ["A. BECK", "Y.C. ELDAR"], "venue": "SIAM Journal on Optimization, 17 ", "citeRegEx": "3", "shortCiteRegEx": null, "year": 2007}, {"title": "Robust model predictive control: A survey", "author": ["A. BEMPORAD", "M. MORARI"], "venue": "Robustness in Identification and Control, 245 ", "citeRegEx": "4", "shortCiteRegEx": null, "year": 1999}, {"title": "Lectures on Modern Convex Optimization", "author": ["A. BEN-TAL", "A.S. NEMIROVSKI"], "venue": "Siam", "citeRegEx": "5", "shortCiteRegEx": null, "year": 2001}, {"title": "Neuro-Dynamic Programming", "author": ["D.P. BERTSEKAS", "J.N. TSITSIKLIS"], "venue": "Athena Scientific", "citeRegEx": "6", "shortCiteRegEx": null, "year": 1996}, {"title": "Introduction to Stochastic Programming", "author": ["J.R. BIRGE", "F. LOUVEAUX"], "venue": "Springer Verlag", "citeRegEx": "7", "shortCiteRegEx": null, "year": 1997}, {"title": "Numerical optimization", "author": ["JF BONNANS", "J.C. GILBERT", "C. LEMAR\u00c9CHAL", "C. SAGASTIZ\u00c1BAL"], "venue": "theoretical and numerical aspects", "citeRegEx": "8", "shortCiteRegEx": null, "year": 2006}, {"title": "Convex Optimization", "author": ["S.P. BOYD", "L. VANDENBERGHE"], "venue": "Cambridge Univ Pr", "citeRegEx": "9", "shortCiteRegEx": null, "year": 2004}, {"title": "Linear least-squares algorithms for temporal difference learning", "author": ["S.J. BRADTKE", "A.G. BARTO"], "venue": "Machine Learning, 22 ", "citeRegEx": "10", "shortCiteRegEx": null, "year": 1996}, {"title": "Reinforcement Learning and Dynamic Programming using Function Approximators", "author": ["L. BUSONIU", "R. BABUSKA", "B. DE SCHUTTER", "D. ERNST"], "venue": "Taylor & Francis CRC Press", "citeRegEx": "11", "shortCiteRegEx": null, "year": 2010}, {"title": "Model Predictive Control", "author": ["E.F. CAMACHO", "C. BORDONS"], "venue": "Springer", "citeRegEx": "12", "shortCiteRegEx": null, "year": 2004}, {"title": "Trust-region Methods", "author": ["A.R. CONN", "N.I.M. GOULD", "P.L. TOINT"], "venue": "vol. 1, Society for Industrial Mathematics", "citeRegEx": "13", "shortCiteRegEx": null, "year": 2000}, {"title": "A two-stage stochastic programming with recourse model for determining robust planting plans in horticulture", "author": ["K. DARBY-DOWMAN", "S. BARKER", "E. AUDSLEY", "D. PARSONS"], "venue": "Journal of the Operational Research Society, ", "citeRegEx": "14", "shortCiteRegEx": null, "year": 2000}, {"title": "Risk-aware decision making and dynamic programming", "author": ["B. DEFOURNY", "D. ERNST", "L. WEHENKEL"], "venue": "Selected for oral presentation at the NIPS-08 Workshop on Model Uncertainty and Risk in Reinforcement Learning, Whistler, Canada, ", "citeRegEx": "15", "shortCiteRegEx": null, "year": 2008}, {"title": "Percentile optimization for Markov decision processes with parameter uncertainty", "author": ["E. DELAGE", "S. MANNOR"], "venue": "Operations Research, 58 ", "citeRegEx": "16", "shortCiteRegEx": null, "year": 2010}, {"title": "Tree-based batch mode reinforcement learning", "author": ["D. ERNST", "P. GEURTS", "L. WEHENKEL"], "venue": "Journal of Machine Learning Research, 6 ", "citeRegEx": "17", "shortCiteRegEx": null, "year": 2005}, {"title": "Reinforcement learning versus model predictive control: a comparison on a power system problem", "author": ["D. ERNST", "M. GLAVIC", "F. CAPITANESCU", "L. WEHENKEL"], "venue": "IEEE Transactions on Systems, Man, and Cybernetics - Part B: Cybernetics, 39 ", "citeRegEx": "18", "shortCiteRegEx": null, "year": 2009}, {"title": "Contributions to Batch Mode Reinforcement Learning", "author": ["R. FONTENEAU"], "venue": "PhD thesis, University of Li\u00e8ge", "citeRegEx": "19", "shortCiteRegEx": null, "year": 2011}, {"title": "Inferring bounds on the performance of a control policy from a sample of trajectories", "author": ["R. FONTENEAU", "S. MURPHY", "L. WEHENKEL", "D. ERNST"], "venue": "Proceedings of the 2009 IEEE Symposium on Adaptive Dynamic Programming and Reinforcement Learning (IEEE ADPRL 09), Nashville, TN, USA", "citeRegEx": "20", "shortCiteRegEx": null, "year": 2009}, {"title": "A cautious approach to generalization in reinforcement learning", "author": ["R. FONTENEAU", "S.A. MURPHY", "L. WEHENKEL", "D. ERNST"], "venue": "Proceedings of the Second International Conference on Agents and Artificial Intelligence ", "citeRegEx": "21", "shortCiteRegEx": null, "year": 2010}, {"title": "Towards min max generalization in reinforcement learning", "author": ["R. FONTENEAU", "S.A. MURPHY", "L. WEHENKEL", "D. ERNST"], "venue": "Agents and Artificial Intelligence: International Conference, ICAART 2010, Valencia, Spain, January 2010, Revised Selected Papers. Series: Communications in Computer and Information Science (CCIS), vol. 129, Springer, Heidelberg", "citeRegEx": "22", "shortCiteRegEx": null, "year": 2011}, {"title": "Stochastic Two-stage Programming", "author": ["K. FRAUENDORFER"], "venue": "Springer", "citeRegEx": "23", "shortCiteRegEx": null, "year": 1992}, {"title": "Robust Control and Model Uncertainty", "author": ["L.P. HANSEN", "T.J. SARGENT"], "venue": "American Economic Review, ", "citeRegEx": "24", "shortCiteRegEx": null, "year": 2001}, {"title": "Convex Analysis and Minimization Algorithms: Fundamentals", "author": ["J.B. HIRIART-URRUTY", "C. LEMAR\u00c9CHAL"], "venue": "vol. 305, Springer-Verlag", "citeRegEx": "25", "shortCiteRegEx": null, "year": 1996}, {"title": "Theory of Financial Decision Making", "author": ["J.E. INGERSOLL"], "venue": "Rowman and Littlefield Publishers, Inc.", "citeRegEx": "26", "shortCiteRegEx": null, "year": 1987}, {"title": "Minimax real-time heuristic search", "author": ["S. KOENIG"], "venue": "Artificial Intelligence, 129 ", "citeRegEx": "27", "shortCiteRegEx": null, "year": 2001}, {"title": "Least-squares policy iteration", "author": ["M.G. LAGOUDAKIS", "R. PARR"], "venue": "Jounal of Machine Learning Research, 4 ", "citeRegEx": "28", "shortCiteRegEx": null, "year": 2003}, {"title": "Markov games as a framework for multi-agent reinforcement learning", "author": ["M.L. LITTMAN"], "venue": "Proceedings of the Eleventh International Conference on Machine Learning ", "citeRegEx": "29", "shortCiteRegEx": null, "year": 1994}, {"title": "Optimal two-stage group-sequential designs", "author": ["Y. LOKHNYGINA", "A.A. TSIATIS"], "venue": "Journal of Statistical Planning and Inference, 138 ", "citeRegEx": "31", "shortCiteRegEx": null, "year": 2008}, {"title": "Estimation of survival distributions of treatment policies in two-stage randomization designs in clinical trials", "author": ["J.K. LUNCEFORD", "M. DAVIDIAN", "A.A. TSIATIS"], "venue": "Biometrics, ", "citeRegEx": "32", "shortCiteRegEx": null, "year": 2002}, {"title": "Bias and variance in value function estimation", "author": ["S. MANNOR", "D. SIMESTER", "P. SUN", "J.N. TSITSIKLIS"], "venue": "Proceedings of the Twenty-first International Conference on Machine Learning ", "citeRegEx": "33", "shortCiteRegEx": null, "year": 2004}, {"title": "Optimal dynamic treatment regimes", "author": ["S.A. MURPHY"], "venue": "Journal of the Royal Statistical Society, Series B, 65(2) ", "citeRegEx": "34", "shortCiteRegEx": null, "year": 2003}, {"title": "An experimental design for the development of adaptive treatment strategies", "author": ["S.A. MURPHY"], "venue": "Statistics in Medicine, 24 ", "citeRegEx": "35", "shortCiteRegEx": null, "year": 2005}, {"title": "Robust stochastic approximation approach to  Min Max Generalization for Deterministic Batch Mode Reinforcement Learning: Relaxation Schemes 33 stochastic programming", "author": ["A. NEMIROVSKI", "A. JUDITSKY", "G. LAN", "A. SHAPIRO"], "venue": "SIAM Journal on Optimization, 19 ", "citeRegEx": "36", "shortCiteRegEx": null, "year": 2009}, {"title": "Interior point polynomial methods in convex programming", "author": ["Y. NESTEROV", "A. NEMIROVSKI"], "venue": "Studies in applied mathematics, 13 ", "citeRegEx": "37", "shortCiteRegEx": null, "year": 1994}, {"title": "Kernel-based reinforcement learning", "author": ["D. ORMONEIT", "S. SEN"], "venue": "Machine Learning, 49 ", "citeRegEx": "38", "shortCiteRegEx": null, "year": 2002}, {"title": "A framework for computing bounds for the return of a policy", "author": ["C. PADURARU", "D. PRECUP", "J. PINEAU"], "venue": "Ninth European Workshop on Reinforcement Learning (EWRL9)", "citeRegEx": "39", "shortCiteRegEx": null, "year": 2011}, {"title": "Computational Complexity", "author": ["C.H. PAPADIMITRIOU"], "venue": "John Wiley and Sons Ltd.", "citeRegEx": "40", "shortCiteRegEx": null, "year": 2003}, {"title": "Performance guarantees for individualized treatment rules", "author": ["M. QIAN", "S.A. MURPHY"], "venue": "Tech. Report 498, Department of Statistics, University of Michigan", "citeRegEx": "41", "shortCiteRegEx": null, "year": 2009}, {"title": "Neural fitted Q iteration - first experiences with a data efficient neural reinforcement learning method", "author": ["M. RIEDMILLER"], "venue": "Proceedings of the Sixteenth European Conference on Machine Learning ", "citeRegEx": "42", "shortCiteRegEx": null, "year": 2005}, {"title": "Minimax search and reinforcement learning for adversarial tetris", "author": ["M. ROVATOUS", "M. LAGOUDAKIS"], "venue": "Proceedings of the 6th Hellenic Conference on Artificial Intelligence (SETN\u201910), Athens, Greece", "citeRegEx": "43", "shortCiteRegEx": null, "year": 2010}, {"title": "Min-max feedback model predictive control for constrained linear systems", "author": ["P. SCOKAERT", "D. MAYNE"], "venue": "IEEE Transactions on Automatic Control, 43 ", "citeRegEx": "44", "shortCiteRegEx": null, "year": 1998}, {"title": "A dynamic programming approach to adjustable robust optimization", "author": ["A. SHAPIRO"], "venue": "Operations Research Letters, 39 ", "citeRegEx": "45", "shortCiteRegEx": null, "year": 2011}, {"title": "Using SeDuMi 1.02, a MATLAB toolbox for optimization over symmetric cones", "author": ["J.F. STURM"], "venue": "Optimization methods and software,", "citeRegEx": "47", "shortCiteRegEx": "47", "year": 1999}, {"title": "Reinforcement Learning", "author": ["R.S. SUTTON", "A.G. BARTO"], "venue": "MIT Press", "citeRegEx": "48", "shortCiteRegEx": null, "year": 1998}, {"title": "Optimal estimator for the survival distribution and related quantities for treatment policies in two-stage randomization designs in clinical trials", "author": ["A.S. WAHED", "A.A. TSIATIS"], "venue": "Biometrics, 60 ", "citeRegEx": "49", "shortCiteRegEx": null, "year": 2004}], "referenceMentions": [{"referenceID": 21, "context": "We study the min max optimization problem introduced in [22] for computing policies for batch mode reinforcement learning in a deterministic setting.", "startOffset": 56, "endOffset": 60}, {"referenceID": 21, "context": "We also theoretically prove and empirically illustrate that both relaxation schemes provide better results than those given in [22].", "startOffset": 127, "endOffset": 131}, {"referenceID": 45, "context": "Research in Reinforcement Learning (RL) [48] aims at designing computational agents able to learn by themselves how to interact with their environment to maximize a numerical reward signal.", "startOffset": 40, "endOffset": 44}, {"referenceID": 25, "context": "The techniques developed in this field have appealed researchers trying to solve sequential decision making problems in many fields such as Finance [26], Medicine [34, 35] or Engineering [42].", "startOffset": 148, "endOffset": 152}, {"referenceID": 32, "context": "The techniques developed in this field have appealed researchers trying to solve sequential decision making problems in many fields such as Finance [26], Medicine [34, 35] or Engineering [42].", "startOffset": 163, "endOffset": 171}, {"referenceID": 33, "context": "The techniques developed in this field have appealed researchers trying to solve sequential decision making problems in many fields such as Finance [26], Medicine [34, 35] or Engineering [42].", "startOffset": 163, "endOffset": 171}, {"referenceID": 40, "context": "The techniques developed in this field have appealed researchers trying to solve sequential decision making problems in many fields such as Finance [26], Medicine [34, 35] or Engineering [42].", "startOffset": 187, "endOffset": 191}, {"referenceID": 9, "context": "Since the end of the nineties, several researchers have focused on the resolution of a subproblem of RL: computing a high-performance policy when the only information available on the environment is contained in a batch collection of trajectories of the agent [10, 17, 28, 38, 42, 19].", "startOffset": 260, "endOffset": 284}, {"referenceID": 16, "context": "Since the end of the nineties, several researchers have focused on the resolution of a subproblem of RL: computing a high-performance policy when the only information available on the environment is contained in a batch collection of trajectories of the agent [10, 17, 28, 38, 42, 19].", "startOffset": 260, "endOffset": 284}, {"referenceID": 27, "context": "Since the end of the nineties, several researchers have focused on the resolution of a subproblem of RL: computing a high-performance policy when the only information available on the environment is contained in a batch collection of trajectories of the agent [10, 17, 28, 38, 42, 19].", "startOffset": 260, "endOffset": 284}, {"referenceID": 36, "context": "Since the end of the nineties, several researchers have focused on the resolution of a subproblem of RL: computing a high-performance policy when the only information available on the environment is contained in a batch collection of trajectories of the agent [10, 17, 28, 38, 42, 19].", "startOffset": 260, "endOffset": 284}, {"referenceID": 40, "context": "Since the end of the nineties, several researchers have focused on the resolution of a subproblem of RL: computing a high-performance policy when the only information available on the environment is contained in a batch collection of trajectories of the agent [10, 17, 28, 38, 42, 19].", "startOffset": 260, "endOffset": 284}, {"referenceID": 18, "context": "Since the end of the nineties, several researchers have focused on the resolution of a subproblem of RL: computing a high-performance policy when the only information available on the environment is contained in a batch collection of trajectories of the agent [10, 17, 28, 38, 42, 19].", "startOffset": 260, "endOffset": 284}, {"referenceID": 5, "context": "The dominant approach for generalizing this information is to combine BMRL algorithms with function approximators [6, 28, 17, 11].", "startOffset": 114, "endOffset": 129}, {"referenceID": 27, "context": "The dominant approach for generalizing this information is to combine BMRL algorithms with function approximators [6, 28, 17, 11].", "startOffset": 114, "endOffset": 129}, {"referenceID": 16, "context": "The dominant approach for generalizing this information is to combine BMRL algorithms with function approximators [6, 28, 17, 11].", "startOffset": 114, "endOffset": 129}, {"referenceID": 10, "context": "The dominant approach for generalizing this information is to combine BMRL algorithms with function approximators [6, 28, 17, 11].", "startOffset": 114, "endOffset": 129}, {"referenceID": 21, "context": "To overcome this problem, [22] propose a min max-type strategy for generalizing in deterministic, Lipschitz continuous environments with continuous state spaces, finite action spaces, and finite time-horizon.", "startOffset": 26, "endOffset": 30}, {"referenceID": 19, "context": "This lower bound is derived from their previous work [20, 21] and has a tightness that depends on the sample dispersion.", "startOffset": 53, "endOffset": 61}, {"referenceID": 20, "context": "This lower bound is derived from their previous work [20, 21] and has a tightness that depends on the sample dispersion.", "startOffset": 53, "endOffset": 61}, {"referenceID": 21, "context": "In this paper, we propose to further investigate the min max generalization optimization problem that was initially proposed in [22].", "startOffset": 128, "endOffset": 132}, {"referenceID": 12, "context": "This results into a well known configuration called the trust-region subproblem [13].", "startOffset": 80, "endOffset": 84}, {"referenceID": 21, "context": "Trust-region better than [22]", "startOffset": 25, "endOffset": 29}, {"referenceID": 21, "context": "Lagrangian relaxation better than Trust-region thus better than [22] Convergence when the sample dispersion goes to 0 NP-hard", "startOffset": 64, "endOffset": 68}, {"referenceID": 15, "context": "In stochastic frameworks, min max approaches are often successful for deriving robust solutions with respect to uncertainties in the (parametric) representation of the probability distributions associated with the environment [16].", "startOffset": 226, "endOffset": 230}, {"referenceID": 28, "context": "[29, 43].", "startOffset": 0, "endOffset": 8}, {"referenceID": 41, "context": "[29, 43].", "startOffset": 0, "endOffset": 8}, {"referenceID": 26, "context": "They have also received some attention for solving partially observable Markov decision processes [30, 27].", "startOffset": 98, "endOffset": 106}, {"referenceID": 21, "context": "The min max approach towards generalization, originally introduced in [22], implicitly relies on a methodology for computing lower bounds on the worst possible return (considering any compatible environment) in a deterministic setting with a mostly unknown actual environment.", "startOffset": 70, "endOffset": 74}, {"referenceID": 31, "context": "In this respect, it is related to other approaches that aim at computing performance guarantees on the returns of inferred policies [33, 41, 39].", "startOffset": 132, "endOffset": 144}, {"referenceID": 39, "context": "In this respect, it is related to other approaches that aim at computing performance guarantees on the returns of inferred policies [33, 41, 39].", "startOffset": 132, "endOffset": 144}, {"referenceID": 37, "context": "In this respect, it is related to other approaches that aim at computing performance guarantees on the returns of inferred policies [33, 41, 39].", "startOffset": 132, "endOffset": 144}, {"referenceID": 23, "context": "This includes Robust Control theory [24] with H\u221e methods [2], but also Model Predictive Control (MPC) theory - where usually the environment is supposed to be fully known [12, 18] - for which min max approaches have been used to determine an optimal sequence of actions with respect to the \u201cworst case\u201d disturbance sequence occurring [44, 4].", "startOffset": 36, "endOffset": 40}, {"referenceID": 1, "context": "This includes Robust Control theory [24] with H\u221e methods [2], but also Model Predictive Control (MPC) theory - where usually the environment is supposed to be fully known [12, 18] - for which min max approaches have been used to determine an optimal sequence of actions with respect to the \u201cworst case\u201d disturbance sequence occurring [44, 4].", "startOffset": 57, "endOffset": 60}, {"referenceID": 11, "context": "This includes Robust Control theory [24] with H\u221e methods [2], but also Model Predictive Control (MPC) theory - where usually the environment is supposed to be fully known [12, 18] - for which min max approaches have been used to determine an optimal sequence of actions with respect to the \u201cworst case\u201d disturbance sequence occurring [44, 4].", "startOffset": 171, "endOffset": 179}, {"referenceID": 17, "context": "This includes Robust Control theory [24] with H\u221e methods [2], but also Model Predictive Control (MPC) theory - where usually the environment is supposed to be fully known [12, 18] - for which min max approaches have been used to determine an optimal sequence of actions with respect to the \u201cworst case\u201d disturbance sequence occurring [44, 4].", "startOffset": 171, "endOffset": 179}, {"referenceID": 42, "context": "This includes Robust Control theory [24] with H\u221e methods [2], but also Model Predictive Control (MPC) theory - where usually the environment is supposed to be fully known [12, 18] - for which min max approaches have been used to determine an optimal sequence of actions with respect to the \u201cworst case\u201d disturbance sequence occurring [44, 4].", "startOffset": 334, "endOffset": 341}, {"referenceID": 3, "context": "This includes Robust Control theory [24] with H\u221e methods [2], but also Model Predictive Control (MPC) theory - where usually the environment is supposed to be fully known [12, 18] - for which min max approaches have been used to determine an optimal sequence of actions with respect to the \u201cworst case\u201d disturbance sequence occurring [44, 4].", "startOffset": 334, "endOffset": 341}, {"referenceID": 6, "context": "Finally, there is a broad stream of works in the field of Stochastic Programming [7] that", "startOffset": 81, "endOffset": 84}, {"referenceID": 14, "context": "have addressed the problem of safely planning under uncertainties, mainly known as \u201crobust stochastic programming\u201d or \u201crisk-averse stochastic programming\u201d [15, 45, 46, 36].", "startOffset": 155, "endOffset": 171}, {"referenceID": 43, "context": "have addressed the problem of safely planning under uncertainties, mainly known as \u201crobust stochastic programming\u201d or \u201crisk-averse stochastic programming\u201d [15, 45, 46, 36].", "startOffset": 155, "endOffset": 171}, {"referenceID": 34, "context": "have addressed the problem of safely planning under uncertainties, mainly known as \u201crobust stochastic programming\u201d or \u201crisk-averse stochastic programming\u201d [15, 45, 46, 36].", "startOffset": 155, "endOffset": 171}, {"referenceID": 22, "context": "In this field, the two-stage case has also been particularly well-studied [23, 14].", "startOffset": 74, "endOffset": 82}, {"referenceID": 13, "context": "In this field, the two-stage case has also been particularly well-studied [23, 14].", "startOffset": 74, "endOffset": 82}, {"referenceID": 21, "context": "The formalization was originally proposed in [22].", "startOffset": 45, "endOffset": 49}, {"referenceID": 21, "context": "As shown in [22], this worst possible return can be computed by solving a finite-dimensional optimization problem over X T\u22121 \u00d7 R .", "startOffset": 12, "endOffset": 16}, {"referenceID": 22, "context": "Many works in optimal sequential decision making have considered the two-stage case [23, 14], which relates to many applications, such as for instance medical applications where one wants to infer \u201csafe\u201d clinical decision rules from batch collections of clinical data [1, 31, 32, 49].", "startOffset": 84, "endOffset": 92}, {"referenceID": 13, "context": "Many works in optimal sequential decision making have considered the two-stage case [23, 14], which relates to many applications, such as for instance medical applications where one wants to infer \u201csafe\u201d clinical decision rules from batch collections of clinical data [1, 31, 32, 49].", "startOffset": 84, "endOffset": 92}, {"referenceID": 0, "context": "Many works in optimal sequential decision making have considered the two-stage case [23, 14], which relates to many applications, such as for instance medical applications where one wants to infer \u201csafe\u201d clinical decision rules from batch collections of clinical data [1, 31, 32, 49].", "startOffset": 268, "endOffset": 283}, {"referenceID": 29, "context": "Many works in optimal sequential decision making have considered the two-stage case [23, 14], which relates to many applications, such as for instance medical applications where one wants to infer \u201csafe\u201d clinical decision rules from batch collections of clinical data [1, 31, 32, 49].", "startOffset": 268, "endOffset": 283}, {"referenceID": 30, "context": "Many works in optimal sequential decision making have considered the two-stage case [23, 14], which relates to many applications, such as for instance medical applications where one wants to infer \u201csafe\u201d clinical decision rules from batch collections of clinical data [1, 31, 32, 49].", "startOffset": 268, "endOffset": 283}, {"referenceID": 46, "context": "Many works in optimal sequential decision making have considered the two-stage case [23, 14], which relates to many applications, such as for instance medical applications where one wants to infer \u201csafe\u201d clinical decision rules from batch collections of clinical data [1, 31, 32, 49].", "startOffset": 268, "endOffset": 283}, {"referenceID": 38, "context": "To prove it, we will do a reduction from the {0, 1}\u2212programming feasibility problem [40].", "startOffset": 84, "endOffset": 88}, {"referenceID": 21, "context": "We show that this scheme provides bounds that are greater or equal to the CGRL bound introduced in [22].", "startOffset": 99, "endOffset": 103}, {"referenceID": 21, "context": "We also prove that this relaxation scheme always gives better bounds than the first relaxation scheme mentioned above, and consequently, better bounds than [22].", "startOffset": 156, "endOffset": 160}, {"referenceID": 12, "context": "This problem is referred to in the literature as the trust-region subproblem [13].", "startOffset": 77, "endOffset": 81}, {"referenceID": 24, "context": "5) Observe that the optimal value of (P \u2032\u2032(u0,u1) LD ) is known to provide a lower bound on the optimal value of (P \u2032\u2032(u0,u1) 2 ) [25].", "startOffset": 130, "endOffset": 134}, {"referenceID": 4, "context": ", \u03bcn(u1) as well as a fractionalquadratic function ([5]), i.", "startOffset": 52, "endOffset": 55}, {"referenceID": 4, "context": "This type of problem is known as a rotated quadratic conic problem and can be formulated as a conic quadratic optimization problem ([5]) that can be solved in polynomial time using interior point methods [5, 37, 9].", "startOffset": 132, "endOffset": 135}, {"referenceID": 4, "context": "This type of problem is known as a rotated quadratic conic problem and can be formulated as a conic quadratic optimization problem ([5]) that can be solved in polynomial time using interior point methods [5, 37, 9].", "startOffset": 204, "endOffset": 214}, {"referenceID": 35, "context": "This type of problem is known as a rotated quadratic conic problem and can be formulated as a conic quadratic optimization problem ([5]) that can be solved in polynomial time using interior point methods [5, 37, 9].", "startOffset": 204, "endOffset": 214}, {"referenceID": 8, "context": "This type of problem is known as a rotated quadratic conic problem and can be formulated as a conic quadratic optimization problem ([5]) that can be solved in polynomial time using interior point methods [5, 37, 9].", "startOffset": 204, "endOffset": 214}, {"referenceID": 20, "context": "The CGRL algorithm proposed in [21, 22] for addressing the min max problem uses the procedure described in [20] for computing a lower bound on the return of a policy given a sample of trajectories.", "startOffset": 31, "endOffset": 39}, {"referenceID": 21, "context": "The CGRL algorithm proposed in [21, 22] for addressing the min max problem uses the procedure described in [20] for computing a lower bound on the return of a policy given a sample of trajectories.", "startOffset": 31, "endOffset": 39}, {"referenceID": 19, "context": "The CGRL algorithm proposed in [21, 22] for addressing the min max problem uses the procedure described in [20] for computing a lower bound on the return of a policy given a sample of trajectories.", "startOffset": 107, "endOffset": 111}, {"referenceID": 2, "context": "Proofs of this lemma can be found in [3] and [8], but we also provide in Appendix A a proof in our particular case.", "startOffset": 37, "endOffset": 40}, {"referenceID": 7, "context": "Proofs of this lemma can be found in [3] and [8], but we also provide in Appendix A a proof in our particular case.", "startOffset": 45, "endOffset": 48}, {"referenceID": 21, "context": "is derived from the formalization of the min max generalization problem introduced in [22].", "startOffset": 86, "endOffset": 90}, {"referenceID": 20, "context": "The proof for the case where B01(F) = B01 CGRL (F) is given in [21].", "startOffset": 63, "endOffset": 67}, {"referenceID": 44, "context": "In all our experiments, the computation of the Lagrangian relaxations, which requires to solve a conic-quadratic program, are done using SeDuMi [47].", "startOffset": 144, "endOffset": 148}, {"referenceID": 0, "context": ", 15, we generate a sample of transitions Fci using a grid over [0, 1] \u00d7 U , as follows: \u2200u \u2208 U , F (u) ci = {([ i1 i ; i2 i ] , u, \u03c1 ([ i1 i ; i2 i ] , u ) , f ([ i1 i ; i2 i ] , u )) \u2223\u2223\u2223\u2223(i1, i2) \u2208 {1, .", "startOffset": 64, "endOffset": 70}, {"referenceID": 0, "context": ",Fci,100 using a uniform probability distribution over the space [0, 1] \u00d7 U .", "startOffset": 65, "endOffset": 71}, {"referenceID": 24, "context": "Since the Trust-region solution to (P \u2032\u2032(u0,u1) TR (k0, k1)) is optimal, and by property of the Lagrangian relaxation [25], one has:", "startOffset": 118, "endOffset": 122}], "year": 2017, "abstractText": "We study the min max optimization problem introduced in [22] for computing policies for batch mode reinforcement learning in a deterministic setting. First, we show that this problem is NP-hard. In the twostage case, we provide two relaxation schemes. The first relaxation scheme works by dropping some constraints in order to obtain a problem that is solvable in polynomial time. The second relaxation scheme, based on a Lagrangian relaxation where all constraints are dualized, leads to a conic quadratic programming problem. We also theoretically prove and empirically illustrate that both relaxation schemes provide better results than those given in [22].", "creator": "LaTeX with hyperref package"}}}