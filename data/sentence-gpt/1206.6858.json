{"id": "1206.6858", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "27-Jun-2012", "title": "Sequential Document Representations and Simplicial Curves", "abstract": "The popular bag of words assumption represents a document as a histogram of word occurrences. While computationally efficient, such a representation is unable to maintain any sequential information. We present a continuous and differentiable sequential document representation that goes beyond the bag of words assumption, and yet is efficient and effective. This representation employs smooth curves in the multinomial simplex to account for sequential information. We discuss the representation and its geometric properties and demonstrate its applicability for the task of text classification.\n\n\n\n\n\nThe word count is an abstraction. Each of the words of the word count is derived by an abstraction. The word counts consist of word counts which have a sequence of words from a sequence to the root of the word count. These represent words, which represent word counts. Each word counts represent a sequence of words from a sequence to the root of the word count. These represent words, which represent word counts. Each word counts represent a sequence of words from a sequence to the root of the word count. Each word counts represent a sequence of words from a sequence to the root of the word count.\n\nFigure 2\n\nFigure 3\nFigure 4\nFigure 5\nFigure 6\nFigure 7\nFigure 8\nFigure 9\nFigure 10\nFigure 11\nFigure 12\nFigure 13\nFigure 14\nFigure 15\nFigure 16\nFigure 17\nFigure 18\nFigure 19\nFigure 20\nFigure 21\nFigure 22\nFigure 22\nFigure 23\nFigure 24\nFigure 25\nFigure 26\nFigure 27\nFigure 28\nFigure 29\nFigure 30\nFigure 30\nFigure 31\nFigure 32\nFigure 33\nFigure 34\nFigure 35\nFigure 36\nFigure 37\nFigure 38\nFigure 39\nFigure 40\nFigure 41\nFigure 42\nFigure 43\nFigure 44\nFigure 45\nFigure 46\nFigure 47\nFigure 48\nFigure 48\nFigure 49\nFigure 50\nFigure 51\nFigure 52\nFigure 53\nFigure 54\nFigure 55\nFigure 56\nFigure 57\nFigure 58\nFigure 59\nFigure 60\nFigure 61\nFigure 62\nFigure 63\nFigure 64\nFigure 65\nFigure 66\nFigure 67\nFigure 68\nFigure 69\nFigure 70\nFigure 71\nFigure 72\nFigure 73\nFigure 73\nFigure 74\nFigure 75\nFigure 74\nFigure 75\nFigure 76\nFigure 76\nFigure 77\nFigure 77\nFigure 78\nFigure 78\nFigure 79\nFigure 80\nFigure 80\nFigure 81\nFigure 82\nFigure 83\nFigure 84\nFigure 85\nFigure 86\nFigure", "histories": [["v1", "Wed, 27 Jun 2012 16:26:46 GMT  (1442kb)", "http://arxiv.org/abs/1206.6858v1", "Appears in Proceedings of the Twenty-Second Conference on Uncertainty in Artificial Intelligence (UAI2006)"]], "COMMENTS": "Appears in Proceedings of the Twenty-Second Conference on Uncertainty in Artificial Intelligence (UAI2006)", "reviews": [], "SUBJECTS": "cs.IR cs.LG", "authors": ["guy lebanon"], "accepted": false, "id": "1206.6858"}, "pdf": {"name": "1206.6858.pdf", "metadata": {"source": "CRF", "title": "Sequential Document Representations and Simplicial Curves", "authors": ["Guy Lebanon"], "emails": [], "sections": [{"heading": null, "text": "The popular bag of words assumption represents a document as a histogram of word occurrences. While computationally efficient, such a representation is unable to maintain any sequential information. We present a continuous and differentiable sequential document representation that goes beyond the bag of words assumption, and yet is efficient and effective. This representation employs smooth curves in the multinomial simplex to account for sequential information. In contrast to n-grams the new representation is able to robustly model long rage sequential trends in the document. We discuss the representation and its geometric properties and demonstrate its applicability for the task of text classification."}, {"heading": "1 Introduction", "text": "Modeling of text documents is an essential part in a wide variety of applications such as the classification, segmentation, visualization and retrieval of text. A crucial part of the modeling process is choosing an appropriate representation for the documents. The original representation of documents as a sequence of words is extremely high-dimensional, discrete, and brittle making it an inconvenient representation for most models to work on. Instead, the words sequences are typically preprocessed by mapping them to a lower dimensional lossy representation such as n-gram, on which the modeling is carried out.\nThe n-gram representation keeps track of the number of n consecutive words of different types, called n-grams. In the case n = 1 this amounts to ignoring the order of the words in the document, keeping only the histogram of word occurrences. This specific case, also called bag of words (bow) representation, is the\nmost frequent one used due to its relative robustness in sparse situations. Assuming that the word counts are normalized by the document length, the bow representation of a word sequence y = \u3008y1, . . . , yN \u3009 over a vocabulary of integers V = {1, . . . , |V |} is x \u2208 R|V |, where xj = 1 N \u2211N\ni=1 \u03b4yi,j . Alternatively, to avoid zeros the bow representation is often defined using smoothed word counts\nxj = 1\nZ\nN \u2211\ni=1\n(\u03b4yi,j + c), c \u2265 0 (1)\nwhere Z ensures normalization. The smoothed version (1) may also be derived as the maximum posterior estimate for multinomial model and Dirichlet prior and is equal to the non-smooth version for c = 0.\nClearly, the n-gram representation sacrifices sequential information in favor of reduced dimensionality. In the case of n = 1 or bow representation, all sequential information is lost. In the case of 1 < n \u226a N , frequently occurring word patterns are kept, but long range sequential information concerning the word sequence y is lost. Moreover, there is no way to tie the occurrences of word patterns to the specific locations in the document that they occurred. In terms of the applications mentioned above, the improvement that results from increasing n is largely disappointing due to the high dimensionality and discreteness of the ngram representation.\nIn this paper, we present a new representation called locally weighted bag of words (lowbow). This representation generalizes bow in a robust way that maintains long and short range sequential information. In contrast to n-gram that keeps track of frequently occurring patterns independent of their positions, lowbow keeps track of changes in the word histogram as it sweeps through the document from beginning to end.\nOne major advantage of lowbow is that it is a continuous and differentiable representation equivalent to smooth curves in the multinomial simplex. By naturally incorporating a smoothing kernel we are able to\nuse lowbow effectively, even in cases that n-gram performs poorly due to its high dimensionality. Moreover, the smooth representation facilitates the use of tools from differentiable calculus and geometry to characterize the sequential contents of documents.\nIn the next section we describe the multinomial simplex and its geometry and then proceed with a formal definition of the lowbow representation."}, {"heading": "2 The Multinomial Simplex and its Geometry", "text": "In this section, we present a brief description of the multinomial simplex and its geometry. Since the simplex is the space of bow representations, its geometry is crucial to the lowbow representation. The brief description below uses some concepts from Riemannian geometry. For additional information concerning the geometry of the simplex refer to (Amari & Nagaoka, 2000; Lafferty & Lebanon, 2005). A standard textbook on Riemannian geometry is (Spivak, 1975).\nThe multinomial simplex Pm for m > 0 is the mdimensional subset of Rm+1 of all positive probability vectors or histograms over m+ 1 objects\nPm =\n\n\n\n\u03b8 \u2208 Rm+1 : \u2200i \u03b8i > 0,\nm+1 \u2211\nj=1\n\u03b8j = 1\n\n\n\n.\nIts connection to the multinomial distribution is that every \u03b8 \u2208 Pm corresponds to a multinomial distribution over m + 1 items. The definition above does not include zero probabilities which lie on the boundary of the simplex closure Pm. As a result, Pm is a differentiable manifold and we can use the standard language of differentiable manifolds, rather than the more complicated notion of a geometry with corners. A discussion concerning the positivity restriction and its relative unimportance in practice may be found in (Lafferty & Lebanon, 2005).\nThe topological structure of Pm, which determines the notions of convergence and continuity, is naturally inherited from the standard topological structure of the embedding space Rm+1. The geometrical structure of Pm that determines the notions of distance, angle and curvature is determined by a local inner product g\u03b8(\u00b7, \u00b7), \u03b8 \u2208 Pm, called the Riemannian metric. The most obvious choice, perhaps, is the standard Euclidean inner product g\u03b8(u, v) = \u2211\nuivi. However, such a choice is problematic from several aspects. Fortunately, a particular choice of a Riemannian metric is motivated by C\u030cencov (1982) who proved that the\nFisher information metric\ng\u03b8(u, v) = \u2211\nij\nuivjEp\u03b8\n(\n\u2202 log p\u03b8(x)\n\u2202\u03b8i\n\u2202 log p\u03b8(x)\n\u2202\u03b8j\n)\n(2)\n=\nm+1 \u2211\ni=1\nuivi \u03b8i\n(3)\n(above, p\u03b8(x) is the multinomial probability associated with the parameter \u03b8) is the only invariant metric under sufficient statistics transformations. In addition, various recent results motivate the Fisher geometry from a practical perspective (Lafferty & Lebanon, 2005).\nThe inner product (3) defines the geometric properties of distance, angle and curvature on Pm in a way that is quite different from the Euclidean inner product. The distance function d : Pm\u00d7Pm \u2192 [0, \u03c0/2] corresponding to (3) is\nd(\u03b8, \u03b7) = acos\n(\nm+1 \u2211\ni=1\n\u221a\n\u03b8i\u03b7i\n)\n. (4)\nThe distance function (4) and the Euclidean distance function d(\u03b8, \u03b7) = \u221a \u2211\n(\u03b8i \u2212 \u03b7i)2 resulting from the inner product g\u03b8(u, v) = \u2211\nuivi on P2 are illustrated in Figures 1-2.\nBy determining geometric properties such as distance, the choice of metric for Pm is of direct importance to the bow representation of documents and its modeling. For example, while the Euclidean metric is homogenous across the simplex, the Fisher metric (3) emphasizes the area close to the boundary. The next section describes the lowbow representation which amounts to a parameterized curve in Pm. In addressing the question of modeling such curves, the simplex geometry plays a central role. It dictates notions such as the distance between two curves, the instantaneous direction of a curve, and the curvature or complexity of a curve. Understanding the relationship between these\ngeometric notions and g\u03b8 is the first step in modeling documents using the lowbow representation."}, {"heading": "3 Sequential Document Representations", "text": "We typically think of documents over a vocabulary V = {1, . . . , |V |} as a finite sequence \u3008y1, . . . , yN \u3009 of words represented as integers in V . However, we use the following broader definition for documents that will be more convenient later on.\nDefinition 1. A document x of length N is a function x : {1, . . . , N} \u00d7 V \u2192 [0, 1] such that\n|V | \u2211\nj=1\nx(i, j) = 1 \u2200i \u2208 {1, . . . , N}."}, {"heading": "The set of documents (of all lengths) is denoted by X.", "text": "For a document x \u2208 X the value x(i, j) is the weight of the word j \u2208 V at location i. The standard way to represent a word sequence as a document in X is to have each location host the appropriate single word with constant weight, which corresponds to the \u03b4c representation defined below with c = 0.\nDefinition 2. The standard representation \u03b4c(y) \u2208 X, where c \u2265 0, of a word sequence y = \u3008y1, . . . , yN\u3009 is\n\u03b4c(y)(i, j) =\n{\nc 1+c|V | yi 6= j\n1+c 1+c|V | yi = j\n.\nThe above is a legitimate representation since \u2211\nj \u03b4c(y)(i, j) = 1+c|V | 1+c|V | = 1. The parameter c in the above definition is useful for avoiding zero counts in the obtained local histograms \u03b4c(y)(i, \u00b7).\nThe standard representation \u03b4c assumes that each word yj in the sequence y occupies a single location 1, . . . , N . In general, however, Definition 1 lets several words occupy the same location by smoothing the influence of words yj across different document positions. Doing so is central in converting the discretetime standard representation to a continuous representation that is much more convenient for analysis and modeling.\nWe are interested in comparing different documents on the basis of their sequential contents. Definition 1 is problematic since it depends on the length of the document. We would like to treat two documents with similar sequential contents but different lengths in a similar fashion. Towards this goal we introduce length-normalized documents that abstract away from the document length by normalizing the sequential information to lie in the interval [0, 1].\nDefinition 3. A length-normalized document x is a function x : [0, 1]\u00d7 V \u2192 [0, 1] such that\n|V | \u2211\nj=1\nx(t, j) = 1, \u2200t \u2208 [0, 1]."}, {"heading": "The set of length-normalized documents is denoted X\u2217.", "text": "The procedure of converting a document x \u2208 X to a\nlength-normalized document x\u2032 \u2208 X\u2217 is expressed by the length-normalization function defined below.\nDefinition 4. The length-normalization function for a document x \u2208 X of length N is\n\u03d5 : X \u2192 X\u2217 \u03d5(x)(t, j) = x(\u2308tN\u2309, j)\nwhere \u2308r\u2309 is the smallest integer greater than r.\nWith each length-normalized document we can associate the following global bow or histogram.\nDefinition 5. The global bow representation of a length-normalized document x \u2208 X\u2217 is\n\u03c1 : X\u2217 \u2192 P|V |\u22121 [\u03c1(x)]j =\n\u222b 1\n0\nx(t, j) dt.\nNote that the function \u03c1 is well defined since\n|V | \u2211\nj=1\n[\u03c1(x)]j =\n|V | \u2211\nj=1\n\u222b 1\n0\nx(t, j) dt =\n\u222b 1\n0\n|V | \u2211\nj=1\nx(t, j) dt\n=\n\u222b 1\n0\n1 dt = 1 =\u21d2 \u03c1(x) \u2208 P|V |\u22121.\nAs proved in Theorem 2, the global bow representation defined above for a document in its standard representation \u03b4c(y) is equivalent to the popular definition of bow expressed in equation (1).\nWe describe below a smoothed representation in X\u2217 that is analogous to a curve in the multinomial simplex. The smoothed representation is obtained by convolving the length-normalized standard representation \u03d5(\u03b4c(y)) with a positive smoothing kernel. A positive smoothing kernel is a function K\u00b5,\u03c3 : [0, 1] \u2192 (0,\u221e), parameterized by location and scale parameters \u00b5 \u2208 [0, 1], \u03c3 \u2208 (0,\u221e). The parameter \u00b5 represents the (normalized) document location and \u03c3 represents the amount of smoothing. We further assume that a smoothing kernel is continuous and differentiable in \u00b5, r and normalized, i.e., \u222b 1\n0 K\u00b5,\u03c3(t) dt = 1.\nOne example for a smoothing kernel is the normal distribution pdf restricted to [0, 1] and normalized\nK\u00b5,\u03c3(x) =\n{\n1 Z N(x ;\u00b5, \u03c3) x \u2208 [0, 1] 0 x 6\u2208 [0, 1] . (5)\nAnother example is the beta distribution pdf\nK\u00b5,\u03c3(x) = Beta\n(\nx ; c \u00b5\n\u03c3 , c\n1\u2212 \u00b5\n\u03c3\n)\n(6)\nwhere c is selected so that the two parameters of the beta distribution will be greater than 1. The above Beta pdf has expectation \u00b5 and variance that is increasing in the scale parameter \u03c3. The following definitions complete the description of the lowbow representation.\nDefinition 6. The \u00b5-modulation function \u03c8\u00b5 maps a document x \u2208 X\u2217 to\n\u03c8\u00b5(x)(t, j) = x(t, j)K\u00b5,\u03c3(t) t \u2208 [0, 1], j \u2208 V.\nDefinition 7. The locally weighted bag of words (lowbow) representation at \u00b5 of the word sequence y is\n\u03b3\u00b5(y) = \u03c1 \u25e6 \u03c8\u00b5 \u25e6 \u03d5 \u25e6 \u03b4c(y) \u2208 P|V |\u22121, \u00b5 \u2208 [0, 1].\nFirst note that lowbow indeed maps a word sequence y and \u00b5 into the simplex \u03b3\u00b5(y) \u2208 P|V |\u22121 since \u2211 j [\u03b3\u00b5(y)]j = \u2211 j \u222b 1\n0 x(t, j)K\u00b5,\u03c3(t) dt = \u222b 1\n0 K\u00b5,\u03c3(t)\n\u2211 j x(t, j) dt = \u222b 1 0 K\u00b5,\u03c3(t) \u00b7 1 dt = 1.\nTheorem 1. The lowbow representation is a continuous and differentiable parameterized curve in the simplex, in both the Euclidean and the Fisher geometry.\nProof. We prove below only the continuity of the lowbow representation. The proof of differentiability proceeds along similar lines. Fixing y, the mapping \u00b5 7\u2192 \u03b3\u00b5(y) maps [0, 1] into the simplex P|V |\u22121. Since K\u00b5,\u03c3(t) is continuous on a compact region (\u00b5, t) \u2208 [0, 1]2, it is also uniformly continuous and we have\nlim \u01eb\u21920 |[\u03b3\u00b5(y)]j \u2212 [\u03b3\u00b5+\u01eb(y)]j |\n= lim \u01eb\u21920\n\u2223 \u2223 \u2223\n\u222b 1\n0\nx(t, j)K\u00b5,\u03c3(t)\u2212 x(t, j)K\u00b5+\u01eb,\u03c3(t)dt \u2223 \u2223 \u2223\n\u2264 lim \u01eb\u21920\n\u222b 1\n0\nx(t, j)|K\u00b5,\u03c3(t)\u2212K\u00b5+\u01eb,\u03c3(t)| dt\n\u2264 lim \u01eb\u21920 sup t\u2208[0,1] |K\u00b5,\u03c3(t)\u2212K\u00b5+\u01eb,\u03c3(t)|\n\u222b 1\n0\nx(t, j) dt\n\u2264 lim \u01eb\u21920 sup t\u2208[0,1] |K\u00b5,\u03c3(t)\u2212K\u00b5+\u01eb,\u03c3(t)| = 0.\nAs a result,\nlim \u01eb\u21920 \u2016\u03b3\u00b5(y)\u2212 \u03b3\u00b5+\u01eb(y)\u2016 = \u221a \u2211 |[\u03b3\u00b5(t)]j \u2212 [\u03b3\u00b5+\u01eb(t)]j |2 \u2192 0\nproving the continuity of \u03b3\u00b5(y) in the Euclidean geometry. Since the Euclidean geometry and the Fisher geometry share the same topology, the lowbow curves are also continuous in the Fisher geometry.\nIt is important to note that the parameterized curve that corresponds to the lowbow representation consists of two parts: the geometric figure {\u03b3\u00b5(y) : \u00b5 \u2208 [0, 1]} \u2282 P|V |\u22121 and the parameterization function \u00b5 7\u2192 \u03b3\u00b5(y) that ties the local histogram to a location \u00b5 in the document. A common mistake in dealing with parameterized curves is to focus on the geometric figure while ignoring the parameterization. This is a mistake since different lowbow representations may share\nsimilar geometric figures but possess different parameterization speeds indicating different local properties.\nThe geometric properties of the curve depend on the word sequence, the kernel shape and the kernel scale parameter. The kernel scale parameter is especially important as it determines the amount of temporal smoothing employed. If \u03c3 \u2192 \u221e the lowbow curve degenerates into a single point that is the global bow representation.\nTheorem 2. Let K\u00b5,\u03c3 be a smoothing kernel such that when \u03c3 \u2192 \u221e, K\u00b5,\u03c3(x) is constant in \u00b5, x. Then for \u03c3 \u2192 \u221e, the lowbow curve \u03b3(y) degenerates into a single point equivalent to the bow representation (1).\nProof. Since the kernel is both constant and normalized, K\u00b5,\u03c3(t) = 1, \u2200\u00b5, t \u2208 [0, 1] 2. For all \u00b5 \u2208 [0, 1],\n[\u03b3\u00b5(y)]j =\n\u222b 1\n0\n\u03d5(\u03b4c(y))(t, j)K\u00b5,\u03c3(t) dt\n=\n\u222b 1\n0\n\u03d5(\u03b4c(y))(t, j) dt\n=\nN \u2211\ni=1\n1\nN\n(\n\u03b4yi,j 1 + c\n1 + c|V | + (1\u2212 \u03b4yi,j)\nc\n1 + c|V |\n)\n\u221d\nN \u2211\ni=1\n\u03b4yi,j(1 + c) + (1\u2212 \u03b4yi,j)c \u221d\nN \u2211\ni=1\n(\u03b4yi,j + c).\nIn the other extreme, small \u03c3 will result in a curve figure that quickly moves between the different corners of the simplex as the words \u3008y1, . . . , yN \u3009 are encountered at times t = 1/N, . . . , N/N . Thus the lowbow representation as \u03c3 \u2192 0 approaches a representation equivalent to the original word sequence. It is unlikely that either extreme cases \u03c3 \u2192 0 or \u03c3 \u2192 \u221e will be optimal from a modeling perspective. By varying \u03c3 between 0 and \u221e we are able to interpolate between these two extreme cases and obtain a convenient sequential, yet robust, representation.\nFigure 3 illustrates the geometric figure resulting from the lowbow representation and its dependency on the kernel scale parameter and the smoothing coefficient. Notice how the figure shrinks as \u03c3 increases until it reaches the single point that is bow. Increasing c, on the other hand, pushes the geometric figure towards the center of the simplex.\nIt is useful to have a quantitative characterization of the complexity of the lowbow representation as a function of the chosen kernel and \u03c3. Towards this end, the kernel\u2019s complexity, defined below, serves as a bound for variations in the lowbow curve.\nDefinition 8. Let K\u00b5,\u03c3(t) be a kernel that is Lipschitz continuous1 in \u00b5 with a Lipschitz constant CK(t). The kernel\u2019s complexity is defined as\nO(K) = \u221a |V |\n\u222b 1\n0\nCK(t) dt.\nThe theorem below proves that the lowbow curve is Lipschitz continuous with a Lipschitz constant O(K), thus connecting the curve complexity with the shape and the scale of the kernel.\nTheorem 3. The lowbow curve \u03b3(y) satisfies\n\u2016\u03b3\u00b5(y)\u2212 \u03b3\u03c4 (y)\u2016 \u2264 |\u00b5\u2212 \u03c4 | O(K)."}, {"heading": "Proof.", "text": "|[\u03b3\u00b5(y)]j \u2212 [\u03b3\u00b5+\u01eb(y)]j |\n\u2264\n\u222b 1\n0\nx(t, j)|K\u00b5,\u03c3(t)\u2212K\u00b5+\u01eb,\u03c3(t)| dt\n\u2264\n\u222b 1\n0\n|K\u00b5,\u03c3(t)\u2212K\u00b5+\u01eb,\u03c3(t)| dt \u2264 \u01eb\n\u222b 1\n0\nCK(t) dt\nand so \u2016\u03b3\u00b5(y)\u2212 \u03b3\u00b5+\u01eb(y)\u2016 \u2264 \u01ebO(K).\nWhile Theorem 3 is expressed in terms of the Euclidean distance on the simplex, it is straightforward to extend it to the case of the Fisher geodesic distance d(\u03b3\u00b5(y), \u03b3\u03c4 (y)) as it is a smooth function of the Euclidean distance."}, {"heading": "4 Modeling of Simplicial Curves", "text": "A lowbow representation is equivalent to a parameterized curve in the simplex. As such, it is a point in an infinite product of simplices P [0,1] m , that is naturally equipped with the product topology and geometry of the individual simplices. In practice, maintaining a continuous representation is difficult, and the straightforward solution is to sample the path at representative points t1, . . . , tl \u2208 [0, 1] resulting in a discrete lowbow representation equivalent to a point in the finite dimensional product space Plm. We describe below geometrical features of lowbow and their use in modeling. The discussion focuses on continuous lowbow curves case, but the discrete case resulting from finite sampling may be obtained by replacing integrals with sums.\nThe distance between lowbow representations of two word sequences \u03b3(y1), \u03b3(y2) \u2208 P [0,1] m , is the average distance between the corresponding time coordinates\nd(\u03b3(y1), \u03b3(y2)) =\n\u222b 1\n0\nd(\u03b3t(y1), \u03b3t(y2)) dt (7)\n1A Lipschitz continuous function f satisfies |f(x) \u2212 f(y)| \u2264 C|x \u2212 y| for some constant C called the Lipschitz constant.\nwhere d(\u03b3t(y1), \u03b3t(y2)) depends on the simplex geometry under consideration, e.g. Equation (4) or the Euclidean norm.\nThe distance between lowbow curves d(\u03b3(y1), \u03b3(y2)) (or its discrete analog) may be used in various modeling tasks. In k-nearest neighbors it simply replaces traditional bow-based distances such as tf similarity or the Euclidean norm. The distance (7) may also be used to construct the approximated heat kernel for use in SVM classification and regression as described by Lafferty and Lebanon (2005). The lowbow distance may also be used to construct generative models for text that generalizes the naive Bayes or multinomial model. Such language models serve an important role in applications such as machine translation, speech recognition and information retrieval.\nOther geometrical features may also be used in modeling text documents. The instantaneous direction of the curve \u03b3(y) at t0 is given by its tangent vector \u03b3\u0307t0(y). Since the curve is differentiable we can obtain a tangent vector field \u03b3\u0307(y) along the curve that describes sequential topic trends and their change. The second derivative \u03b3\u0308(y) vector field, together with the Riemannian metric, may be used to define the curvature at different points along the lowbow curve. Intuitively, curvature measures the amount of wigglyness or deviation from a straight line (or geodesic). Integrating the norm of the curvature tensor over t \u2208 [0, 1] provides a measure of the sequential topic complexity or variability along the document. The tangent vector field and curvature of lowbow may be used to study local properties of documents that relate to tasks such as segmentation or summarization.\nThe geometric properties mentioned above are useful in constructing generative and conditional models for text applications such as retrieval, classification, filtering, segmentation and visualization. Due to lack of space we will briefly present in the next section a simple lowbow k-nearest neighbor classifier. The application of lowbow to additional tasks, and other classification models will be studied in future work."}, {"heading": "5 Text Classification Experiments", "text": "In this section, we examine lowbow and its properties in the context of text classification using a nearest neighbor classifier. We report experimental results for the WebKB faculty vs. course task and the Reuters top ten categories using the standard mod-apte split. In the WebKB task we repeatedly sampled subsets for training and testing with equal positive and negative examples. In the Reuters task we randomly sampled subsets of the mod-apte split for training (to examine the influence of the train set size) resulting in unbalanced train and test set containing more negative\nthan positive examples. The continuous quantities in the lowbow calculation were approximated by a discrete sample of 5 equally spaced points in the interval [0, 1] turning the integrals into efficiently computed Riemann sums. The kernel used was the bounded Gaussian kernel (5). Throughout the experiments we computed several alternatives for the kernel scale parameter and chose the best one. An important extension of the current experiments that we plan to conduct in the future is automatic selection of \u03c3.\nFigure 4 (top) displays results for the WebKB data. The left graph is a standard train-set size vs. test set error rate comparing the lowbow geodesic using scale \u03c3 \u2192 \u221e (dashed) and the lowbow geodesic distance using an intermediate scale value. The right graph display the dependency of the test set error rate on the scale parameter indicating an optimal scale at around \u03c3 = 0.2 (for repeated samplings of 500 training examples). In both cases, the performances of standard bow techniques such as tf cosine similarity or Euclidean distance were significantly inferior (20-40% higher error rate) than the displayed curves and are not displayed.\nFigure 4 (bottom) displays test set error rates for the Reuters task. The 10 rows in the table indicate the classification task of identifying each of the 10 most popular classes in the Reuters collection. The columns represent varying training set sizes (sampled from the mod-apte split). The lowbow geodesic distance for an intermediate scale is denoted by err1 and for \u03c3 \u2192 \u221e is denoted by err2. tf-Cosine similarity and Euclidean distance for bow are denoted by err3 and err4.\nThe experiments indicate that lowbow geodesic clearly outperforms, for most values of \u03c3, the standard tfcosine similarity and Euclidean distance for bow. In addition they also indicate that in general, the best scale parameter for lowbow is an intermediate one - and not \u03c3 \u2192 \u221e thus validating the hypothesis that we can leverage sequential information using the lowbow framework to improve on global bow models. Whether or not the optimal value of \u03c3 is small or large depends on several factors. It depends on the relationship between the sequential information and the response variable as some tasks are more amenable to such an approach than others. The size of the training set matters as well since excessive lowbow smoothing will be required for extremely small datasets resulting in an optimal scale of \u03c3 \u2192 \u221e."}, {"heading": "6 Related Work and Conclusion", "text": "The use of n-gram and bow in document modeling has a long history. A geometric point of view considering the bow representation as a point in the multinomial simplex is expressed in (Lafferty & Lebanon, 2005), and a recent overview of the geometrical properties of\nprobability spaces is (Amari & Nagaoka, 2000). The use of simplicial curves in text modeling is a relatively new approach promoted by Gous (1998) and Hall and Hofmann (). ? (?) describes some related ideas that lead to a non-smooth multi-scale view of images.\nThe lowbow representation is a promising new direction in text modeling. By varying \u03c3 it interpolates between the standard word sequence representation \u3008y1, . . . , yN\u3009 and bow. It is equivalent to a smooth curve that is amenable to techniques from real analysis and geometry. In contrast to n-gram, it captures topical trends and incorporates long range information. On the other hand, the lowbow novelty is orthogonal to n-gram as it is possible to combine the two.\nThe lowbow framework is aesthetically pleasing, and achieves good results in practice. Using a smoothing parameter, it naturally interpolates between bow and complete sequential information. The correspondence with smooth curves in the simplex enables the use of a wide array of tools from analysis and geometry in an otherwise discrete representation. It seems likely that the lowbow representation and its geometric properties will lead to improvements in many areas of text modeling, including retrieval, classification, visualization, segmentation, summarization, and language modeling."}], "references": [{"title": "Methods of information geometry. American Mathematical Society", "author": ["S. Amari", "H. Nagaoka"], "venue": null, "citeRegEx": "Amari and Nagaoka,? \\Q2000\\E", "shortCiteRegEx": "Amari and Nagaoka", "year": 2000}, {"title": "Statistical decision rules and optimal inference. American Mathematical Society", "author": ["N.N. \u010cencov"], "venue": null, "citeRegEx": "\u010cencov,? \\Q1982\\E", "shortCiteRegEx": "\u010cencov", "year": 1982}, {"title": "Exponential and spherical subfamily models", "author": ["A. Gous"], "venue": "Doctoral dissertation,", "citeRegEx": "Gous,? \\Q1998\\E", "shortCiteRegEx": "Gous", "year": 1998}, {"title": "Diffusion kernels on statistical manifolds", "author": ["J. Lafferty", "G. Lebanon"], "venue": "Journal of Machine Learning Research", "citeRegEx": "Lafferty and Lebanon,? \\Q2005\\E", "shortCiteRegEx": "Lafferty and Lebanon", "year": 2005}, {"title": "A comprehensive introduction to differential geometry, vol. 1-5", "author": ["M. Spivak"], "venue": "Publish or Perish", "citeRegEx": "Spivak,? \\Q1975\\E", "shortCiteRegEx": "Spivak", "year": 1975}], "referenceMentions": [{"referenceID": 4, "context": "A standard textbook on Riemannian geometry is (Spivak, 1975).", "startOffset": 46, "endOffset": 60}, {"referenceID": 1, "context": "Fortunately, a particular choice of a Riemannian metric is motivated by \u010cencov (1982) who proved that the Figure 1: The 2-simplex P2 may be visualized as a surface in R (left) or as a triangle in R (right).", "startOffset": 72, "endOffset": 86}, {"referenceID": 3, "context": "The distance (7) may also be used to construct the approximated heat kernel for use in SVM classification and regression as described by Lafferty and Lebanon (2005). The lowbow distance may also be used to construct generative models for text that generalizes the naive Bayes or multinomial model.", "startOffset": 137, "endOffset": 165}], "year": 2006, "abstractText": "The popular bag of words assumption represents a document as a histogram of word occurrences. While computationally efficient, such a representation is unable to maintain any sequential information. We present a continuous and differentiable sequential document representation that goes beyond the bag of words assumption, and yet is efficient and effective. This representation employs smooth curves in the multinomial simplex to account for sequential information. In contrast to n-grams the new representation is able to robustly model long rage sequential trends in the document. We discuss the representation and its geometric properties and demonstrate its applicability for the task of text classification.", "creator": "dvips(k) 5.94a Copyright 2003 Radical Eye Software"}}}