{"id": "1302.2552", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "11-Feb-2013", "title": "Selecting the State-Representation in Reinforcement Learning", "abstract": "The problem of selecting the right state-representation in a reinforcement learning problem is considered. Several models (functions mapping past observations to a finite set) of the observations are given, and it is known that for at least one of these models the resulting state dynamics are indeed Markovian. Without knowing neither which of the models is the correct one, nor what are the probabilistic characteristics of the resulting MDP, it is required to obtain as much reward as the optimal policy for the correct model (or for the best of the correct models, if there are several) than that of the MDP. This is a task that is well documented by the best models, and is in fact part of a requirement for a reinforcement learning problem. For this reason, there are numerous examples of the model to be found, but only one is found, of course, in the first two instances of MDP. It is interesting to note that the models which are found in the first two instances of MDP are quite well tested (from this point on), and have very few weaknesses. On the other hand, the models are far from easy to interpret, even if there is a strong relationship between the probability of the model and the accuracy of the model.\n\nThe most common example is the model used to predict a large number of outcomes from an MDP. A model for all the outcomes must be considered correct for all the outcomes (if the model is not correct for the probability of the model, the probability of the model is not correct for the probability of the model, the probability of the model is not correct for the probability of the model, the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the model is not correct for the probability of the model, and the probability of the", "histories": [["v1", "Mon, 11 Feb 2013 17:49:38 GMT  (24kb)", "http://arxiv.org/abs/1302.2552v1", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["odalric-ambrym maillard", "r\u00e9mi munos", "daniil ryabko"], "accepted": true, "id": "1302.2552"}, "pdf": {"name": "1302.2552.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": ["odalricambrym.maillard@gmail.com", "remi.munos@inria.fr", "daniil@ryabko.net"], "sections": [{"heading": null, "text": "ar X\niv :1\n30 2.\n25 52\nv1 [\ncs .L\nG ]"}, {"heading": "1 Introduction", "text": "We consider the problem of selecting the right state-representation in an average-reward reinforcement learning problem. Each state-representation is defined by a model \u03c6j (to which corresponds a state space S\u03c6j ) and we assume that the number J of available models is finite and that (at least) one model is a weakly-communicating Markov decision process (MDP). We do not make any assumption at all about the other models. This problem is considered in the general reinforcement learning setting, where an agent interacts with an unknown environment in a single stream of repeated observations, actions and rewards. There are no \u201cresests,\u201d thus all the learning has to be done online. Our goal is to construct an algorithm that performs almost as well as the algorithm that knows both which model is a MDP (knows the \u201ctrue\u201d model) and the characteristics of this MDP (the transition probabilities and rewards).\nConsider some examples that help motivate the problem. The first example is high-level feature selection. Suppose that the space of histories is huge, such as the space of video streams or that of game plays. In addition to these data, we also have some high-level features extracted from it, such as \u201cthere is a person present in the video\u201d or \u201cthe adversary (in a game) is aggressive.\u201d We know that most of the features are redundant, but we also know that some combination of some of the features describes the problem well and exhibits Markovian dynamics. Given a potentially large number of feature combinations of this kind, we want to find a policy whose average reward is as good as that of the best policy for the right combination of features. Another example is bounding the order of an MDP. The process is known to be k-order Markov, where k is unknown but un upper bound K >> k is given. The goal is to perform as well as if we knew k. Yet another example is selecting the right discretization. The environment is an MDP with a continuous state space. We have several candidate quantizations of the state space, one of which gives an MDP. Again, we would like to find a policy that is as good as the optimal policy for the right discretization. This example also opens\nthe way for extensions of the proposed approach: we would like to be able to treat an infinite set of possible discretization, none of which may be perfectly Markovian. The present work can be considered the first step in this direction.\nIt is important to note that we do not make any assumptions on the \u201cwrong\u201d models (those that do not have Markovian dynamics). Therefore, we are not able to test which model is Markovian in the classical statistical sense, since in order to do that we would need a viable alternative hypothesis (such as, the model is not Markov but is K-order Markov). In fact, the constructed algorithm never \u201cknows\u201d which model is the right one; it is \u201conly\u201d able to get the same average level of reward as if it knew.\nPrevious work. This work builds on previous work on learning average-reward MDPs. Namely, we use in our algorithm as a subroutine the algorithm UCRL2 of [6] that is designed to provide finite time bounds for undiscounted MDPs. Such a problem has been pioneered in the reinforcement learning literature by [7] and then improved in various ways by [4, 11, 12, 6, 3]; UCRL2 achieves a regret of the order DT 1/2 in any weakly-communicating MDP with diameter D, with respect to the best policy for this MDP. The diameter D of a MDP is defined in [6] as the expected minimum time required to reach any state starting from any other state. A related result is reported in [3], which improves on constants related to the characteristics of the MDP.\nA similar approach has been considered in [10]; the difference is that in that work the probabilistic characteristics of each model are completely known, but the models are not assumed to be Markovian, and belong to a countably infinite (rather than finite) set.\nThe problem we address can be also viewed as a generalization of the bandit problem (see e.g. [9, 8, 1]): there are finitely many \u201carms\u201d, corresponding to the policies used in each model, and one of the arms is the best, in the sense that the corresponding model is the \u201ctrue\u201d one. In the usual bandit setting, the rewards are assumed to be i.i.d. thus one can estimate the mean value of the arms while switching arbitrarily from one arm to the next (the quality of the estimate only depends on the number of pulls of each arm). However, in our setting, estimating the average-reward of a policy requires playing it many times consecutively. This can be seen as a bandit problem with dependent arms, with complex costs of switching between arms.\nContribution. We show that despite the fact that the true Markov model of states is unknown and that nothing is assumed on the wrong representations, it is still possible to derive a finite-time analysis of the regret for this problem. This is stated in Theorem 1; the bound on the regret that we obtain is of order T 2/3.\nThe intuition is that if the \u201ctrue\u201d model \u03c6\u2217 is known, but its probabilistic properties are not, then we still know that there exists an optimal control policy that depends on the observed state sj\u2217,t only. Therefore, the optimal rate of rewards can be obtained by a clever exploration/exploitation strategy, such as UCRL2 algorithm [6]. Since we do not know in advance which model is a MDP, we need to explore them all, for a sufficiently long time in order to estimate the rate of rewards that one can get using a good policy in that model.\nOutline. In Section 2 we introduce the precise notion of model and set up the notations. Then we present the proposed algorithm in Section 3; it uses UCRL2 of [6] as a subroutine and selects the models \u03c6 according to a penalized empirical criterion. In Section 4 we discuss some directions for further development. Finally, Section 5 is devoted to the proof of Theorem 1."}, {"heading": "2 Notation and definitions", "text": "We consider a space of observations O, a space of actions A, and a space of rewards R (all assumed to be Polish). Moreover, we assume that A is of finite cardinality A def= |A| and that 0 \u2208 R \u2282 [0, 1]. The set of histories up to time t for all t \u2208 N\u222a{0} will be denoted by H<t def= O\u00d7(A\u00d7R\u00d7O)t\u22121, and we define the set of all possible histories by H def= \u221e\u22c3\nt=1 H<t. Environments. For a Polish X , we Denote by P(X ) the set of probability distributions over X . Define an environment to be a mapping from the set of histories H to the set of functions that map any action a \u2208 A to a probability distribution \u03bda \u2208 P(R \u00d7 O) over the product space of rewards and observations.\nWe consider the problem of reinforcement learning when the learner interacts with some unknown environment e\u22c6. The interaction is sequential and goes as follows: first some h<1 = {o0} is generated according to \u03b9, then at time step t > 0, the learner choses an action at \u2208 A according to the current history h<t \u2208 H<t. Then a couple of reward and observations (rt, ot) is drawn according to the distribution (e\u22c6(h<t))at \u2208 P(R\u00d7O). Finally, h<t+1 is defined by the concatenation of h<t with (at, rt, ot). With these notations, at each time step t > 0, ot\u22121 is the last observation given to the learner before choosing an action, at is the action output at this step, and rt is the immediate reward received after playing at.\nState representation functions (models). Let S \u2282 N be some finite set; intuitively, this has to be considered as a set of states. A state representation function \u03c6 is a function from the set of histories H to S. For a state representation function \u03c6, we will use the notation S\u03c6 for its set of states, and st,\u03c6 := \u03c6(h<t).\nIn the sequel, when we talk about a Markov decision process, it will be assumed to be weakly communicating, which means that for each pair of states u1, u2 there exists k \u2208 N and a sequence of actions \u03b11, .., \u03b1k \u2208 A such that P (sk+1,\u03c6 = u2|s1,\u03c6 = u1, a1 = \u03b11...ak = \u03b1k) > 0. Having that in mind, we introduce the following definition.\nDefinition 1 We say that an environment e with a state representation function \u03c6 is Markov, or, for short, that \u03c6 is a Markov model (of e), if the process (st,\u03c6, at, rt), t \u2208 N is a (weakly communicating) Markov decision process.\nFor example, consider a state-representation function \u03c6 that depends only on the last observation, and that partitions the observation space into finitely many cells. Then an environment is Markov with this representation function if the probability distribution on the next cells only depends on the last observed cell and action. Note that there may be many state-representation functions with which an environment e is Markov."}, {"heading": "3 Main results", "text": "Given a set \u03a6 = {\u03c6j ; j 6 J} of J state-representation functions (models), one of which being a Markov model of the unknown environment e\u22c6, we want to construct a strategy that performs nearly as well as the best algorithm that knows which \u03c6j is Markov, and knows all the probabilistic characteristics (transition probabilities and rewards) of the MDP corresponding to this model. For that purpose we define the regret of any strategy at time T , like in [6, 3], as\n\u2206(T ) def = T\u03c1\u22c6 \u2212\nT\u2211\nt=1\nrt ,\nwhere rt are the rewards received when following the proposed strategy and \u03c1\u22c6 is the average optimal value in the best Markov model, i.e., \u03c1\u22c6 = limT 1T E( \u2211T t=1 rt(\u03c0\n\u22c6)) where rt(\u03c0\u22c6) are the rewards received when following the optimal policy for the best Markov model. Note that this definition makes sense since when the MDP is weakly communicating, the average optimal value of reward does not depend on the initial state. Also, one could replace T\u03c1\u2217 with the expected sum of rewards obtained in T steps (following the optimal policy) at the price of an additional O( \u221a T ) term.\nIn the next subsection, we describe an algorithm that achieves a sub-linear regret of order T 2/3."}, {"heading": "3.1 Best Lower Bound (BLB) algorithm", "text": "In this section, we introduce the Best-Lower-Bound (BLB) algorithm, described in Figure 1.\nThe algorithm works in stages of doubling length. Each stage consists in 2 phases: an exploration and an exploitation phase. In the exploration phase, BLB plays the UCRL2 algorithm on each model (\u03c6j)16j6J successively, as if each model \u03c6j was a Markov model, for a fixed number \u03c4i,1,J of rounds. The exploitation part consists in selecting first the model with highest lower bound, according to the empirical rewards obtained in the previous exploration phase. This model is initially selected for the same time as in the exploration phase, and then a test decides to either continue playing this model (if its performance during exploitation is still above the corresponding lower bound, i.e. if the rewards obtained are still at least as good as if it was playing the best model). If it does not pass the test, then another model (with second best lower-bound) is select and played, and so on. Until the exploitation phase (of fixed length \u03c4i,2) finishes and the next stage starts.\nThe length of stage i is fixed and defined to be \u03c4i def = 2i. Thus for a total time horizon T , the number of stages I(T ) before time T is I(T ) def = xlog2(T + 1)y. Each stage i (of length \u03c4i) is further decomposed into an exploration (length \u03c4i,1) and an exploitation (length \u03c4i,2) phases.\nExploration phase. All the models {\u03c6j}j6J are played one after another for the same amount of time \u03c4i,1,J def = \u03c4i,1 J . Each episode 1 6 j 6 J consists in running the UCRL2 algorithm using the model of states and transitions induced by the state-representation function \u03c6j . Note that UCRL2 does not require the horizon T in advance, but requires a parameter p in order to ensure a near optimal regret bound with probability higher than 1 \u2212 p. We define this parameter p to be \u03b4i(\u03b4) in stage i, where\n\u03b4i(\u03b4) def = (2i \u2212 (J\u22121 + 1)22i/3 + 4)\u221212\u2212i+1\u03b4 . (1)\nThe average empirical reward received during each episode is written \u00b5\u0302i,1(\u03c6j).\nExploitation phase. We use the empirical rewards \u00b5\u0302i,1(\u03c6j) received in the previous exploration part of stage i together with a confidence bound in order to select the model to play. Moreover, a model \u03c6 is no longer run for a fixed period of time (as in the exploration part of stage i), but for a period \u03c4i,2(\u03c6) that depends on some test; we first initialize J := {1, . . . , J} and then choose\nj\u0302 def = argmax j\u2208J \u00b5\u0302i,1(\u03c6j)\u2212 2B(i, \u03c6j , \u03b4) , (2)\nwhere we define\nB(i, \u03c6, \u03b4) def = 34f(\u03c4i \u2212 1 + \u03c4i,1)|S\u03c6|\n\u221a A log(\n\u03c4i,1,J \u03b4i(\u03b4) )\n\u03c4i,1,J , (3)\nwhere \u03b4 and the function f are parameters of the BLB algorithm. Then UCRL2 is played using the selected model \u03c6j\u0302 for the parameter \u03b4i(\u03b4). In parallel we test whether the average empirical reward we receive during this exploitation phase is high enough; at time t, if the length of the current episode is larger than \u03c41,i,J , we test if\n\u00b5\u0302i,2,t(\u03c6j\u0302) > \u00b5\u0302i,1(\u03c6j\u0302)\u2212 2B(i, \u03c6j\u0302 , \u03b4). (4) If the test is positive, we keep playing UCRL2 using the same model. Now, if the test fails, then the model j\u0302 is discarded (until the end of stage i) i.e. we update J := J \\ {j\u0302} and we select a new one according to (2). We repeat those steps until the total time \u03c4i,2 of the exploitation phase of stage i is over.\nRemark Note that the model selected for exploitation in (2) is the one that has the best lower bound. This is a pessimistic (or robust) selection strategy. We know that if the right model is selected, then with high probability, this model will be kept during the whole exploitation phase. If this is not the right model, then either the policy provides good rewards and we should keep playing it, or it does not, in which case it will not pass the test (4) and will be removed from the set of models that will be exploited in this phase."}, {"heading": "3.2 Regret analysis", "text": "Theorem 1 (Main result) Assume that a finite set of J state-representation functions \u03a6 is given, and there exists at least one function \u03c6\u22c6 \u2208 \u03a6 such that with \u03c6\u22c6 as a state-representation function the environment is a Markov decision process. If there are several such models, let \u03c6\u22c6 be the one with the highest average reward of the optimal policy of the corresponding MDP. Then the regret (with respect to the optimal policy corresponding to \u03c6\u2217) of the BLB algorithm run with parameter \u03b4, for any horizon T , with probability higher than 1\u2212 \u03b4 is bounded as follows\n\u2206(T ) 6 cf(T )S ( AJ log ( (J\u03b4)\u22121 ) log2(T ) )1/2 T 2/3 + c\u2032DS ( A log(\u03b4\u22121) log2(T )T )1/2 + c(f,D), (5)\nfor some numerical constants c, c\u2032 and c(f,D). The parameter f(t) can be chosen to be any increasing function, for instance the choice f(t) := log2 t+ 1, gives c(f,D) 6 2\nD. The proof of this result is reported in Section 5.\nRemark. Importantly, the algorithm considered here does not know in advance the diameter D of the true model, nor the time horizon T . Due to this lack of knowledge, it uses a guess f(t) (e.g. log(t)) on this diameter, which result in the additional regret term c(f,D) and the additional factor f(T ); knowing D would enable to remove both of them, but this is a strong assumption. Choosing f(t) := log2 t + 1 gives a bound which is of order T\n2/3 in T but is exponential in D; taking f(t) := t\u03b5 we get a bound of order T 2/3+\u03b5 in T but of polynomial order 1/\u03b5 in D."}, {"heading": "4 Discussion and outlook", "text": "Intuition. The main idea why this algorithm works is as follows. The \u201cwrong\u201d models are used during exploitation stages only as long as they are giving rewards that are higher than the rewards that could be obtained in the \u201ctrue\u201d model. All the models are explored sufficiently long so as to be able to estimate the optimal reward level in the true model, and to learn its policy. Thus, nothing has to be known about the \u201cwrong\u201d models. This is in stark contrast to the usual situation in mathematical statistics, where to be able to test a hypothesis about a model (e.g., that the data is generated by a certain model versus some alternative models), one has to make assumptions about alternative models. This has to be done in order to make sure that the Type II error is small (the power of the test is large): that this error is small has to be proven under the alternative. Here, although we are solving seemingly the same problem, the role of the Type II error is played by the rewards. As long as the rewards are high we do not care where the model we are using is correct or not. We only have to ensure that the true model passes the test.\nAssumptions. A crucial assumption made in this work is that the \u201ctrue\u201d model \u03c6\u2217 belongs to a known finite set. While passing from a finite to a countably infinite set appears rather straightforward, getting rid of the assumption that this set contains the true model seems more difficult. What one would want to obtain in this setting is sub-linear regret with respect to the performance of the optimal policy in the best model; this, however, seems difficult without additional assumptions on the probabilistic characteristics of the models. Another approach not discussed here would be to try to build a good state representation function, as what is suggested for instance in [5]. Yet another interesting generalization in this direction would be to consider uncountable (possibly parametric but general) sets of models. This, however, would necessarily require some heavy assumptions on the set of models.\nRegret. The reader familiar with adversarial bandit literature will notice that our bound of order T 2/3 is worse than T 1/2 that usually appears in this context (see, for example [2]). The reason is that our notion of regret is different: in adversarial bandit literature, the regret is measured with respect to the best choice of the arm for the given fixed history. In contrast, we measure the regret with respect to the best policy (for knows the correct model and its parameters) that, in general, would obtain completely different (from what our algorithm would get) rewards and observations right from the beginning.\nEstimating the diameter? As previously mentioned, a possibly large additive constant c(f,D) appears in the regret since we do not known a bound on the diameter of the MDP in the \u201ctrue\u201d model, and use logT instead. Finding a way to properly address this problem by estimating online the diameter of the MDP is an interesting open question. Let us provide two intuitions concerning this problem. First, we notice that, as reported in [6], when we compute an optimistic model based on the empirical rewards and transitions of the true model, the span of the corresponding optimistic value function sp(V\u0302 +) is always smaller than the diameter D. This span increases as we get more rewards and transitions samples, which gives a natural empirical lower bound on D. However, it seems quite difficult to compute a tight empirical upper bound on D (or sp(V\u0302 +)). In [3], the authors derive a regret bound that scales with the span of the true value function sp(V \u22c6), which is also less than D, and can be significantly smaller in some cases. However, since we do not have the property that sp(V\u0302 +) 6 sp(V \u22c6), we need to introduce an explicit penalization in order to control the span of the computed optimistic models, and this requires assuming we know an upper bound B on sp(V \u22c6) in order to guarantee a final regret bound scaling with B. Unfortunately this does not solve the estimation problem of D, which remains an open question."}, {"heading": "5 Proof of Theorem 1", "text": "In this section, we now detail the proof of Theorem 1. The proof is stated in several parts. First we remind a general confidence bound for the UCRL2 algorithm in the true model. Then we decompose the regret into the sum of the regret in each stage i. After analyzing the contribution to the regret in stage i, we then gather all stages and tune the length of each stage and episode in order to get the final regret bound."}, {"heading": "5.1 Upper and Lower confidence bounds", "text": "From the analysis of UCRL2 in [6], we have the property that with probability higher than 1 \u2212 \u03b4\u2032, the regret of UCRL2 when run for \u03c4 consecutive many steps from time t1 in the true model \u03c6\u22c6 is upper bounded by\n\u03c1\u22c6 \u2212 1 \u03c4\nt1+\u03c4\u22121\u2211\nt=t1\nrt 6 34D|S\u03c6\u22c6 | \u221a A log( \u03c4\u03b4\u2032 )\n\u03c4 , (6)\nwhere D is the diameter of the MDP. What is interesting is that this diameter does not need to be known by the algorithm. Also by carefully looking at the proof of UCRL, it can be shown that the following bound is also valid with probability higher than 1\u2212 \u03b4\u2032:\n1\n\u03c4\nt1+\u03c4\u22121\u2211\nt=t1\nrt \u2212 \u03c1\u22c6 6 34D|S\u03c6\u22c6 | \u221a A log( \u03c4\u03b4\u2032 )\n\u03c4 .\nWe now define the following quantity, for every model \u03c6, episode length \u03c4 and \u03b4\u2032 \u2208 (0, 1)\nBD(\u03c4, \u03c6, \u03b4 \u2032) def = 34D|S\u03c6|\n\u221a A log( \u03c4\u03b4\u2032 )\n\u03c4 . (7)"}, {"heading": "5.2 Regret of stage i", "text": "In this section we analyze the regret of the stage i, which we denote \u2206i. Note that since each stage i 6 I is of length \u03c4i = 2i except the last one I that may stop before, we have\n\u2206(T ) =\nI(T )\u2211\ni=1\n\u2206i , (8)\nwhere I(T ) = xlog2(T+1)y. We further decompose\u2206i = \u22061,i+\u2206i,2 into the regret corresponding to the exploration stage \u22061,i and the regret corresponding to the exploitation stage \u2206i,2.\nRecall that \u03c4i,1 is the total length of the exploration stage i and \u03c4i,2 is the total length of the exploitation stage i. Then for each model \u03c6, we write \u03c4i,1,J def = \u03c4i,1 J the number of consecutive steps during which the UCRL2 algorithm is run with model \u03c6 in the exploration stage i, and \u03c4i,2(\u03c6) the number of consecutive steps during which the UCRL2 algorithm is run with model \u03c6 in the exploitation stage i.\nGood and Bad models. Let us now introduce the two following sets of models, defined after the end of the exploration stage, i.e. at time ti.\nGi def= {\u03c6 \u2208 \u03a6 ; \u00b5\u0302i,1(\u03c6)\u2212 2B(i, \u03c6, \u03b4) \u2265 \u00b5\u0302i,1(\u03c6\u22c6)\u2212 2B(i, \u03c6\u22c6, \u03b4)}\\{\u03c6\u2217} , Bi def= {\u03c6 \u2208 \u03a6 ; \u00b5\u0302i,1(\u03c6)\u2212 2B(i, \u03c6, \u03b4) < \u00b5\u0302i,1(\u03c6\u22c6)\u2212 2B(i, \u03c6\u22c6, \u03b4)} .\nWith this definition, we have the decomposition \u03a6 = Gi \u222a {\u03c6\u22c6} \u222a Bi."}, {"heading": "5.2.1 Regret in the exploration phase", "text": "Since in the exploration stage i each model \u03c6 is run for \u03c4i,1,J many steps, the regret for each model \u03c6 6= \u03c6\u22c6 is bounded by \u03c4i,1,J\u03c1\u22c6. Now the regret for the true model is \u03c4i,1,J (\u03c1\u22c6 \u2212 \u00b5\u03021(\u03c6\u22c6)), thus the total contribution to the regret in the exploration stage i is upper-bounded by\n\u2206i,1 6 \u03c4i,1,J(\u03c1 \u22c6 \u2212 \u00b5\u03021(\u03c6\u22c6)) + (J \u2212 1)\u03c4i,1,J\u03c1\u22c6 . (9)"}, {"heading": "5.2.2 Regret in the exploitation phase", "text": "By definition, all models in Gi \u222a {\u03c6\u22c6} are selected before any model in Bi is selected. The good models. Let us consider some \u03c6 \u2208 Gi and an event \u2126i under which the exploitation phase does not reset. The test (equation (4)) starts after \u03c4i,1,J , thus, since there is not reset, either \u03c4i,2(\u03c6) = \u03c4i,1,J in which case the contribution to the regret is bounded by \u03c4i,1,J\u03c1\u22c6 , or \u03c4i,2(\u03c6) > \u03c4i,1,J , in which case the regret during the (\u03c4i,2(\u03c6) \u2212 1) steps (where the test was successful) is bounded by\n(\u03c4i,2(\u03c6) \u2212 1)(\u03c1\u22c6 \u2212 \u00b5\u0302i,2,\u03c4i,2(\u03c6)\u22121(\u03c6)) 6 (\u03c4i,2(\u03c6)\u2212 1)(\u03c1\u22c6 \u2212 \u00b5\u0302i,1(\u03c6) + 2B(i, \u03c6, \u03b4)) 6 (\u03c4i,2(\u03c6)\u2212 1)(\u03c1\u22c6 \u2212 \u00b5\u0302i,1(\u03c6\u22c6) + 2B(i, \u03c6\u22c6, \u03b4)) ,\nand now since in the last step \u03c6 fails to pass the test, this adds a contribution to the regret at most \u03c1\u22c6.\nWe deduce that the total contribution to the regret of all the models \u03c6 \u2208 Gi in the exploitation stages on the event \u2126i is bounded by\n\u2206i,2(Gi) 6 \u2211\n\u03c6\u2208G\nmax{\u03c4i,1,J\u03c1\u22c6, (\u03c4i,2(\u03c6) \u2212 1)(\u03c1\u22c6 \u2212 \u00b5\u0302i,1(\u03c6\u22c6) + 2B(i, \u03c6\u22c6, \u03b4)) + \u03c1\u22c6} . (10)\nThe true model. First, let us note that since the total regret of the true model during the exploitation step i is given by\n\u03c4i,2(\u03c6 \u22c6)(\u03c1\u22c6 \u2212 \u00b5\u0302i,2,t(\u03c6\u22c6)) ,\nthen the total regret of the exploration and exploitation stages in episode i on \u2126i is bounded by\n\u2206i 6 \u03c4i,1,J (\u03c1 \u22c6 \u2212 \u00b5\u03021(\u03c6 \u22c6)) + \u03c4i,1,J (J \u2212 1)\u03c1 \u22c6 + \u03c4i,2(\u03c6 \u22c6)(\u03c1\u22c6 \u2212 \u00b5\u0302i,2,ti+\u03c4i,2(\u03c6 \u22c6)) +\n\u2211\n\u03c6\u2208Gi\nmax{\u03c4i,1,J\u03c1 \u22c6 , (\u03c4i,2(\u03c6)\u2212 1)(\u03c1 \u22c6 \u2212 \u00b5\u0302i,1(\u03c6 \u22c6) + 2B(i, \u03c6\u22c6, \u03b4)) + \u03c1\u22c6}+\n\u2211\n\u03c6\u2208Bi\n\u03c4i,2(\u03c6)\u03c1 \u22c6 .\nNow from the analysis provided in [6] we know that when we run the UCRL2 with the true model \u03c6\u22c6 with parameter \u03b4i(\u03b4), then there exists an event \u21261,i of probability at least 1\u2212 \u03b4i(\u03b4) such that on this event \u03c1\u22c6 \u2212 \u00b5\u0302i,1(\u03c6\u22c6) 6 BD(\u03c4i,1,J , \u03c6\u22c6, \u03b4i(\u03b4)) , and similarly there exists an event \u21262,i of probability at least 1\u2212 \u03b4i(\u03b4), such that on this event \u03c1\u22c6 \u2212 \u00b5\u0302i,2,t(\u03c6\u22c6) 6 BD(\u03c4i,2(\u03c6\u22c6), \u03c6\u22c6, \u03b41(\u03b4)) . Now we show that, with high probability, the true model \u03c6\u22c6 passes all the tests (equation (4)) until the end of the episode i, and thus equivalently, with high probability no model \u03c6 \u2208 Bi is selected, so that \u2211\n\u03c6\u2208Bi\n\u03c4i,2(\u03c6) = 0.\nFor the true model, after \u03c4(\u03c6\u22c6, t) > \u03c4i,1,J , there remains at most (\u03c4i,2\u2212\u03c4i,1,J+1) possible timesteps where we do the test for the true model \u03c6\u22c6. For each test we need to control \u00b5i,2,t(\u03c6\u22c6), and the event corresponding to \u00b5\u0302i,1(\u03c6\u22c6) is shared by all the tests. Thus we deduce that with probability higher than 1\u2212 (\u03c4i,2\u2212 \u03c4i,1,J +2)\u03b4i(\u03b4) we have simultaneously on all time step until the end of exploitation phase of stage i,\n\u00b5\u0302i,2,t(\u03c6 \u22c6)\u2212 \u00b5\u0302i,1(\u03c6\u22c6) = \u00b5\u0302i,2,t(\u03c6\u22c6)\u2212 \u03c1\u22c6 + \u03c1\u22c6 \u2212 \u00b5\u0302i,1(\u03c6\u22c6)\n> \u2212BD(\u03c4(\u03c6\u22c6, t), \u03c6\u22c6, \u03b4i(\u03b4))\u2212BD(\u03c4i,1,J , \u03c6\u22c6, \u03b4i(\u03b4)) > \u22122BD(\u03c4i,1,J , \u03c6\u22c6, \u03b4i(\u03b4)) .\nNow provided that f(ti) > D, then BD(\u03c4i,1,J , \u03c6\u22c6, \u03b4i(\u03b4)) 6 B(i, \u03c6\u22c6, \u03b4) , thus the true model passes all tests until the end of the exploitation part of stage i on an event \u21263,i of probability higher than 1 \u2212 (\u03c4i,2 \u2212 \u03c4i,1,J + 2)\u03b4i(\u03b4). Since there is no reset, we can choose \u2126i def= \u21263,i. Note that on this event, we thus have \u2211\n\u03c6\u2208Bi\n\u03c4i,2(\u03c6) = 0.\nBy using a union bound over the events \u21261,i,\u21262,i and \u21263,i, then we deduce that with probability higher than 1\u2212 (\u03c4i,2 \u2212 \u03c4i,1,J + 4)\u03b4i(\u03b4), \u2206i 6 \u03c4i,1,JBD(\u03c4i,1,J , \u03c6\n\u22c6, \u03b4i(\u03b4))) + [\u03c4i,1,J(J \u2212 1) + |Gi|]\u03c1\u22c6 + \u03c4i,2(\u03c6\u22c6)BD(\u03c4i,2(\u03c6\u22c6), \u03c6\u22c6, \u03b4i(\u03b4)) + \u2211\n\u03c6\u2208Gi\nmax{(\u03c4i,1,J \u2212 1)\u03c1\u22c6, (\u03c4i,2(\u03c6)\u2212 1)(BD(\u03c4i,1,J , \u03c6\u22c6, \u03b4i(\u03b4)) + 2B(i, \u03c6\u22c6, \u03b4)} .\nNow using again the fact that f(ti) > D, and after some simplifications, we deduce that\n\u2206i 6 \u03c4i,1,JBD(\u03c4i,1,J , \u03c6 \u22c6, \u03b4i(\u03b4)) + \u03c4i,2(\u03c6 \u22c6)BD(\u03c4i,2(\u03c6 \u22c6), \u03c6\u22c6, \u03b4i(\u03b4))\n+ \u2211\n\u03c6\u2208Gi\n(\u03c4i,2(\u03c6) \u2212 1)3B(i, \u03c6\u22c6, \u03b4) + \u03c4i,1,J (J + |Gi| \u2212 1)\u03c1\u22c6 .\nFinally, we use the fact that \u03c4BD(\u03c4, \u03c6\u22c6, \u03b4i(\u03b4)) is increasing with \u03c4 to deduce the following rough bound that holds with probability higher than 1\u2212 (\u03c4i,2 \u2212 \u03c4i,1,J + 4)\u03b4i(\u03b4)\n\u2206i 6 \u03c4i,2B(i, \u03c6 \u22c6, \u03b4) + \u03c4i,2BD(\u03c4i,2, \u03c6 \u22c6, \u03b4i(\u03b4)) + 2J\u03c4i,1,J\u03c1 \u22c6 ,\nwhere we used the fact that \u03c4i,2 = \u03c4i,2(\u03c6\u22c6) + \u2211\n\u03c6\u2208G\n\u03c4i,2(\u03c6) ."}, {"heading": "5.3 Tuning the parameters of each stage.", "text": "We now conclude by tuning the parameters of each stage, i.e. the probabilities \u03b4i(\u03b4) and the length \u03c4i, \u03c4i,1 and \u03c4i,2. The total length of stage i is by definition\n\u03c4i = \u03c4i,1 + \u03c4i,2 = \u03c4i,1,JJ + \u03c4i,2 ,\nwhere \u03c4i = 2i . So we set \u03c4i,1 def = \u03c4 2/3 i and then we have \u03c4i,2 def = \u03c4i \u2212 \u03c42/3i and \u03c4i,1,J =\n\u03c4 2/3 i\nJ . Now using these values and the definition of the bound B(i, \u03c6\u22c6, \u03b4), and BD(\u03c4i,2, \u03c6\u22c6, \u03b4i(\u03b4)), we deduce with probability higher than 1\u2212 (\u03c4i,2 \u2212 \u03c4i,1,J + 4)\u03b4i(\u03b4) the following upper bound\n\u2206i 6 34f(ti)S\n\u221a\nAJ log ( \u03c42/3i J\u03b4i(\u03b4) ) \u03c4 2/3 i + 34DS \u221a A log ( \u03c4i \u03b4i(\u03b4) ) \u03c4i + 2\u03c4 2/3 i \u03c1 \u22c6 ,\nwith ti = 2i \u2212 1 + 22i/3 and where we used the fact that ( J\n\u03c4 2/3 i\n)1/2 \u03c4i,2 6 \u221a J\u03c4 2/3 i .\nWe now define \u03b4i(\u03b4) such that \u03b4i(\u03b4) def = (2i \u2212 (J\u22121 + 1)22i/3 + 4)\u221212\u2212i+1\u03b4 . Since for the stages i \u2208 I0 def= {i > 1; f(ti) < D}, the regret is bounded by \u2206i 6 \u03c4i\u03c1\u22c6, then the total cumulative regret of the algorithm is bounded with probability higher than 1 \u2212 \u03b4 (using the defition of the \u03b4i(\u03b4)) by\n\u2206(T ) 6 \u2211\ni/\u2208I0\n[34f(ti)S\n\u221a JA log\n(28i/3 J\u03b4 ) + 2]22i/3 + 34DS\n\u221a A log\n(23i \u03b4 ) 2i + \u2211\ni\u2208I0\n2i\u03c1\u22c6 .\nwhere ti = 2i \u2212 1 + 22i/3 6 T . We conclude by using the fact that since I(T ) 6 log2(T + 1), then with probability higher than 1\u2212 \u03b4, the following bound on the regret holds \u2206(T ) 6 cf(T )S ( AJ log(J\u03b4)\u22121 log2(T ) )1/2 T 2/3 + c\u2032DS ( A log(\u03b4\u22121) log2(T )T )1/2 + c(f,D) .\nfor some constant c, c\u2032, and where c(f,D) = \u2211\ni\u2208I0 2i\u03c1\u22c6. Now for the special choice when f(T )\ndef =\nlog2(T+1), then i \u2208 I0 means 2i+22i/3 < 2D+2, thus we must have i < D, and thus c(f, d) 6 2D."}, {"heading": "Acknowledgements", "text": "This research was partially supported by the French Ministry of Higher Education and Research, Nord- Pas-de-Calais Regional Council and FEDER through CPER 2007-2013, ANR projects EXPLO-RA (ANR-08-COSI-004) and Lampada (ANR-09-EMER-007), by the European Communitys Seventh Framework Programme (FP7/2007-2013) under grant agreement 231495 (project CompLACS), and by Pascal-2."}], "references": [{"title": "Finite time analysis of the multiarmed bandit problem", "author": ["Peter Auer", "Nicol\u00f2 Cesa-Bianchi", "Paul Fischer"], "venue": "Machine Learning,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2002}, {"title": "Gambling in a rigged casino: The adversarial multi-armed bandit problem", "author": ["Peter Auer", "Nicol\u00f2 Cesa-Bianchi", "Yoav Freund", "Robert E. Schapire"], "venue": "In Foundations of Computer Science,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 1995}, {"title": "REGAl: a regularization based algorithm for reinforcement learning in weakly communicating mdps", "author": ["Peter L. Bartlett", "Ambuj Tewari"], "venue": "In Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2009}, {"title": "R-max - a general polynomial time algorithm for near-optimal reinforcement learning", "author": ["Ronen I. Brafman", "Moshe Tennenholtz"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2003}, {"title": "Feature reinforcement learning: Part I: Unstructured MDPs", "author": ["Marcus Hutter"], "venue": "Journal of Artificial General Intelligence,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2009}, {"title": "Near-optimal regret bounds for reinforcement learning", "author": ["Thomas Jaksch", "Ronald Ortner", "Peter Auer"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2010}, {"title": "Near-optimal reinforcement learning in polynomial time", "author": ["Michael Kearns", "Satinder Singh"], "venue": "Machine Learning,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2002}, {"title": "Asymptotically efficient adaptive allocation rules", "author": ["Tze L. Lai", "Herbert Robbins"], "venue": "Advances in Applied Mathematics,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 1985}, {"title": "Some aspects of the sequential design of experiments", "author": ["Herbert Robbins"], "venue": "Bulletin of the American Mathematics Society,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 1952}, {"title": "On the possibility of learning in reactive environments with arbitrary dependence", "author": ["Daniil Ryabko", "Marcus Hutter"], "venue": "Theoretical Compututer Science,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2008}, {"title": "PAC model-free reinforcement learning", "author": ["Alexander L. Strehl", "Lihong Li", "Eric Wiewiora", "John Langford", "Michael L. Littman"], "venue": "In Proceedings of the 23rd international conference on Machine learning,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2006}, {"title": "Optimistic linear programming gives logarithmic regret for irreducible mdps", "author": ["Ambuj Tewari", "Peter L. Bartlett"], "venue": "In Proceedings of Neural Information Processing Systems Conference (NIPS),", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2007}], "referenceMentions": [{"referenceID": 5, "context": "Namely, we use in our algorithm as a subroutine the algorithm UCRL2 of [6] that is designed to provide finite time bounds for undiscounted MDPs.", "startOffset": 71, "endOffset": 74}, {"referenceID": 6, "context": "Such a problem has been pioneered in the reinforcement learning literature by [7] and then improved in various ways by [4, 11, 12, 6, 3]; UCRL2 achieves a regret of the order DT 1/2 in any weakly-communicating MDP with diameter D, with respect to the best policy for this MDP.", "startOffset": 78, "endOffset": 81}, {"referenceID": 3, "context": "Such a problem has been pioneered in the reinforcement learning literature by [7] and then improved in various ways by [4, 11, 12, 6, 3]; UCRL2 achieves a regret of the order DT 1/2 in any weakly-communicating MDP with diameter D, with respect to the best policy for this MDP.", "startOffset": 119, "endOffset": 136}, {"referenceID": 10, "context": "Such a problem has been pioneered in the reinforcement learning literature by [7] and then improved in various ways by [4, 11, 12, 6, 3]; UCRL2 achieves a regret of the order DT 1/2 in any weakly-communicating MDP with diameter D, with respect to the best policy for this MDP.", "startOffset": 119, "endOffset": 136}, {"referenceID": 11, "context": "Such a problem has been pioneered in the reinforcement learning literature by [7] and then improved in various ways by [4, 11, 12, 6, 3]; UCRL2 achieves a regret of the order DT 1/2 in any weakly-communicating MDP with diameter D, with respect to the best policy for this MDP.", "startOffset": 119, "endOffset": 136}, {"referenceID": 5, "context": "Such a problem has been pioneered in the reinforcement learning literature by [7] and then improved in various ways by [4, 11, 12, 6, 3]; UCRL2 achieves a regret of the order DT 1/2 in any weakly-communicating MDP with diameter D, with respect to the best policy for this MDP.", "startOffset": 119, "endOffset": 136}, {"referenceID": 2, "context": "Such a problem has been pioneered in the reinforcement learning literature by [7] and then improved in various ways by [4, 11, 12, 6, 3]; UCRL2 achieves a regret of the order DT 1/2 in any weakly-communicating MDP with diameter D, with respect to the best policy for this MDP.", "startOffset": 119, "endOffset": 136}, {"referenceID": 5, "context": "The diameter D of a MDP is defined in [6] as the expected minimum time required to reach any state starting from any other state.", "startOffset": 38, "endOffset": 41}, {"referenceID": 2, "context": "A related result is reported in [3], which improves on constants related to the characteristics of the MDP.", "startOffset": 32, "endOffset": 35}, {"referenceID": 9, "context": "A similar approach has been considered in [10]; the difference is that in that work the probabilistic characteristics of each model are completely known, but the models are not assumed to be Markovian, and belong to a countably infinite (rather than finite) set.", "startOffset": 42, "endOffset": 46}, {"referenceID": 8, "context": "[9, 8, 1]): there are finitely many \u201carms\u201d, corresponding to the policies used in each model, and one of the arms is the best, in the sense that the corresponding model is the \u201ctrue\u201d one.", "startOffset": 0, "endOffset": 9}, {"referenceID": 7, "context": "[9, 8, 1]): there are finitely many \u201carms\u201d, corresponding to the policies used in each model, and one of the arms is the best, in the sense that the corresponding model is the \u201ctrue\u201d one.", "startOffset": 0, "endOffset": 9}, {"referenceID": 0, "context": "[9, 8, 1]): there are finitely many \u201carms\u201d, corresponding to the policies used in each model, and one of the arms is the best, in the sense that the corresponding model is the \u201ctrue\u201d one.", "startOffset": 0, "endOffset": 9}, {"referenceID": 5, "context": "Therefore, the optimal rate of rewards can be obtained by a clever exploration/exploitation strategy, such as UCRL2 algorithm [6].", "startOffset": 126, "endOffset": 129}, {"referenceID": 5, "context": "Then we present the proposed algorithm in Section 3; it uses UCRL2 of [6] as a subroutine and selects the models \u03c6 according to a penalized empirical criterion.", "startOffset": 70, "endOffset": 73}, {"referenceID": 0, "context": "Moreover, we assume that A is of finite cardinality A def = |A| and that 0 \u2208 R \u2282 [0, 1].", "startOffset": 81, "endOffset": 87}, {"referenceID": 5, "context": "For that purpose we define the regret of any strategy at time T , like in [6, 3], as", "startOffset": 74, "endOffset": 80}, {"referenceID": 2, "context": "For that purpose we define the regret of any strategy at time T , like in [6, 3], as", "startOffset": 74, "endOffset": 80}, {"referenceID": 4, "context": "Another approach not discussed here would be to try to build a good state representation function, as what is suggested for instance in [5].", "startOffset": 136, "endOffset": 139}, {"referenceID": 1, "context": "The reader familiar with adversarial bandit literature will notice that our bound of order T 2/3 is worse than T 1/2 that usually appears in this context (see, for example [2]).", "startOffset": 172, "endOffset": 175}, {"referenceID": 5, "context": "First, we notice that, as reported in [6], when we compute an optimistic model based on the empirical rewards and transitions of the true model, the span of the corresponding optimistic value function sp(V\u0302 ) is always smaller than the diameter D.", "startOffset": 38, "endOffset": 41}, {"referenceID": 2, "context": "In [3], the authors derive a regret bound that scales with the span of the true value function sp(V ), which is also less than D, and can be significantly smaller in some cases.", "startOffset": 3, "endOffset": 6}, {"referenceID": 5, "context": "1 Upper and Lower confidence bounds From the analysis of UCRL2 in [6], we have the property that with probability higher than 1 \u2212 \u03b4, the regret of UCRL2 when run for \u03c4 consecutive many steps from time t1 in the true model \u03c6 is upper bounded by \u03c1 \u2212 1 \u03c4 t1+\u03c4\u22121 \u2211", "startOffset": 66, "endOffset": 69}, {"referenceID": 5, "context": "Now from the analysis provided in [6] we know that when we run the UCRL2 with the true model \u03c6 with parameter \u03b4i(\u03b4), then there exists an event \u03a91,i of probability at least 1\u2212 \u03b4i(\u03b4) such that on this event \u03c1 \u2212 \u03bc\u0302i,1(\u03c6) 6 BD(\u03c4i,1,J , \u03c6, \u03b4i(\u03b4)) , and similarly there exists an event \u03a92,i of probability at least 1\u2212 \u03b4i(\u03b4), such that on this event \u03c1 \u2212 \u03bc\u0302i,2,t(\u03c6) 6 BD(\u03c4i,2(\u03c6), \u03c6, \u03b41(\u03b4)) .", "startOffset": 34, "endOffset": 37}], "year": 2013, "abstractText": "The problem of selecting the right state-representation in a reinforcement learning problem is considered. Several models (functions mapping past observations to a finite set) of the observations are given, and it is known that for at least one of these models the resulting state dynamics are indeed Markovian. Without knowing neither which of the models is the correct one, nor what are the probabilistic characteristics of the resulting MDP, it is required to obtain as much reward as the optimal policy for the correct model (or for the best of the correct models, if there are several). We propose an algorithm that achieves that, with a regret of order T 2/3 where T is the horizon time.", "creator": "LaTeX with hyperref package"}}}