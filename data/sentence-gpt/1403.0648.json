{"id": "1403.0648", "review": {"conference": "ICML", "VERSION": "v1", "DATE_OF_SUBMISSION": "4-Mar-2014", "title": "Multi-period Trading Prediction Markets with Connections to Machine Learning", "abstract": "We present a new model for prediction markets, in which we use risk measures to model agents and introduce a market maker to describe the trading process. This specific choice on modelling tools brings us mathematical convenience. The analysis shows that the whole market effectively approaches a global objective, despite that the market is designed such that each agent only cares about its own goal.\n\n\n\n\nIn a similar fashion, markets have become part of the global social network in which participants choose and sell. One of these strategies is to identify markets which are in agreement with each other and which need to be identified on the basis of the value of a given action. This approach can also be employed as a proxy for the valuation and valuation of an action in which the underlying value of the action is determined by the investment, the market price of the action, and the market price of the action. These products are traded in the market, in their markets, in its markets, and in the marketplace where they are placed, by trading them at a price that is not specified in the model.\nIn contrast, a model of market price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade price for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for a trade for", "histories": [["v1", "Tue, 4 Mar 2014 01:14:40 GMT  (109kb,D)", "http://arxiv.org/abs/1403.0648v1", null]], "reviews": [], "SUBJECTS": "cs.GT cs.LG q-fin.TR stat.ML", "authors": ["jinli hu", "amos j storkey"], "accepted": true, "id": "1403.0648"}, "pdf": {"name": "1403.0648.pdf", "metadata": {"source": "CRF", "title": "Multi-period Trading Prediction Markets with Connections to Machine Learning", "authors": ["Jinli Hu"], "emails": ["A.STORKEY}@ED.AC.UK"], "sections": [{"heading": "1 Introduction", "text": "Following the mainstream interest in \u201cbig data\u201d, one valuable direction of machine learning is towards to building up distributed, scalable and self-incentivised systems which could organise for solving large scale problems. Recently, prediction markets (Wolfers and Zitzewitz, 2004) show the promise of being the abstract framework for machine learners to design these systems. As one type of markets, prediction markets naturally introduce the concepts such as self-incentivised computation and distributed environment. Additionally, the close relationship between prediction markets and probabilities shed light on a new way of achieving probabilistic modelling (Storkey, 2011).\nSince Pennock and Wellman (1996), researchers have spent decades on building connections between machine learning and prediction markets. However, this problem has still not been well solved. One reason is that the framework of prediction markets is somehow too flexible, and in order to analyse the markets for machine learning goals one has to first specify a market model to describe the prediction markets. The other reason is that given a market model, we may still not know what the market is doing, even if we understand agent behaviours and market mechanisms. As distinct from most machine learning methods which explicitly define and optimise certain objectives, markets only introduce local objectives to each individual agent. To interpret a market as a machine learning method, we have to find the global objective that the market aims to optimise. This idea motivates our work.\nInstead of just focusing on market mechanisms (Chen and Vaughan, 2010), we would like to incorporate the agents and analyse our market as a whole. This setting is similar to (Storkey, 2011; Penna et al., 2012; Barbu and Lay, 2012); but unlike Barbu and Lay (2012), we will build a model on agent behaviours; and unlike\nar X\niv :1\n40 3.\n06 48\nv1 [\ncs .G\nT ]\nStorkey (2011) and Penna et al. (2012), we model agents using risk measures, which makes our markets analytical.\nThe novel results of this paper are:\n\u2022 establishing a new prediction market model which both inherits the strengths of prediction markets and has mathematical convenience;\n\u2022 giving explicitly the global objective that the market aims to optimise as a whole, and interpreting the market trading process as a sequential optimisation procedure of the global objective;\n\u2022 strengthening the intimate connections between machine learning and markets by showing that the market effectively solves the dual of certain machine learning problems."}, {"heading": "2 A General Prediction Market Setup", "text": "Let \u2126 be the space of all possible future states. We say a prediction market is built on \u2126 if it trades securities associated with the future state \u03c9 \u2208 \u2126. Specifically, securities are defined as a set of random variables {\u03bek(\u00b7)} = {\u03be1(\u00b7), \u03be2(\u00b7) . . . , \u03beK(\u00b7)}. Each \u03bek(\u00b7) : \u2126 \u2192 R is a payment function, that is, one unit of this security will pay to the holder \u03bek(\u03c9) if \u03c9 turns out to be the future state. This definition is quite general, and securities defined in this way are also referred to as complex securities (Abernethy et al., 2013). We require that all securities {\u03bek(\u00b7)} (collected into the vector \u03be(\u00b7)) are linearly independent, that is, for a \u2208 RK , we have a \u00b7 \u03be(\u00b7) = 0 only if a = 0. If they are not, then we can always pick a subset {\u03bek\u2032(\u00b7)} of linearly independent securities from {\u03bek(\u00b7)} such that all the other securities in {\u03bek(\u00b7)} can be represented by the linear combination of {\u03bek\u2032(\u00b7)} (Kreyszig, 2007). Therefore it is redundant to consider {\u03bek(\u00b7)} that are not linearly independent. As an example, the Arrow-Debreu security is a special case of complex securities. When the sample space \u2126 is discrete and contains only finite number of states, Arrow-Debreu securities are a set of K = |\u2126| securities, in which the k-th one pays one unit if the k-th state is true: \u03bek(\u03c9) = 1(\u03c9 = k). Note that in general cases K < |\u2126|, e.g. when the value of \u03c9 is continuous, there will be infinite number of states but we always have a finite K for practice.\nAgents can only trade these predefined securities. The behaviour of an agent is characterised by its portfolio {w, sk} = {w, s1, s2, . . . , sK}, where w is the amount of money that the agent has, and sk is the amount of shares the agent holds in security k. We collect all sk into vector s. If an agent has a portfolio {w, sk}, the total payment of the securities is\nX(\u00b7) = s \u00b7 \u03be(\u00b7), (2.1)\nwhere X(\u00b7) : \u2126 \u2192 R is in essence a random variable on \u2126. We call X(\u00b7) the risky asset because of its uncertainty and w the risk-free asset. The gross payment is thus\nX\u0302(\u00b7) = w + s \u00b7 \u03be(\u00b7) = w +X(\u00b7), (2.2)\nwhich is also a random variable. We call X\u0302(\u00b7) the (gross) asset. Denote X the set of allX(\u00b7) that are accessible for an agent, and similarly X\u0302 the set of all X\u0302(\u00b7). Notice that since {\u03bek(\u00b7)} are linearly independent, there exists a unique map (bijection) between X(\u00b7) and s via (2.1). Therefore a portfolio could also be represented by {w,X(\u00b7)}. In our setting X \u2286 span(\u03be1(\u00b7), \u03be2(\u00b7) . . . , \u03beK(\u00b7)), but it is possible to make X more abstract, which is not a space spanned by a prefixed number of securities but allows new security types to be added on the fly. This discussion is beyond our scope.\nA market consists of two processes, that 1) each agent chooses a portfolio {w,X(\u00b7)} it would like to hold, and 2) agents try to move to their preferred portfolio by trading. To describe the decision making process we need a model of portfolio selection, while to describe trading we need to specify a market mechanism. These two parts will be discussed in Section 3 and 4.\nLater in this paper, when the context is clear we will omit parentheses and write a random variable in an uppercase letter, e.g.X (except the securities, which are denoted by \u03be), and use the lowercase of the same letter for the value of it, e.g. x. We will also write functionals in letters without any parentheses."}, {"heading": "3 Preferences on Assets", "text": "Agents select assets based on their preferences. An agent\u2019s preference order of two assets is measured by a functional f : X\u0302 \u2192 R, such that the agent prefers one asset X\u0302 than the other asset Y\u0302 if and only if f(X\u0302) > f(Y\u0302 ), and that the agent is indifferent between X and Y if and only if f(X\u0302) = f(Y\u0302 ). There are plenty of theories on choosing and analysing a specific form of f . These includes expected utility theory (EUT) (Von Neumann and Morgenstern, 2007), dual utility theory (Yaari, 1987), risk measures (Artzner et al., 1999), etc. EUT is perhaps the most popular theories in economics and game theory, while risk measures are commonly seen in finance literature. We choose to use risk measures to model agent behaviours. We introduce risk measures in this section, while putting the detailed justification of using risk measures and its relation to EUT in Section 6."}, {"heading": "3.1 Risk measures", "text": "As is indicated by their name, risk measures assign higher scores to assets that are more \u201crisky\u201d. They can also be understood as measures of the potential loss of choosing certain asset. A (monetary) risk measure is defined as a functional \u03c1 : X \u2192 R such that \u03c1(0) is finite and \u03c1 satisfies the following conditions (Artzner et al., 1999):\nTranslation invariance If X \u2208 X and m \u2208 R, then\n\u03c1(X +m) = \u03c1(X)\u2212m. (3.1)\nMonotonicity If X,Y \u2208 X and X \u2264 Y , then\n\u03c1(X) \u2265 \u03c1(Y ). (3.2)\nHere X \u2264 Y should be understood as P (x \u2264 y) = 1, that is, with the probability of one that X will generate a lower return than Y . Thus monotonicity indicates that an asset with a better return deserves a lower risk. Due to translation invariance, a risk measure maps any risk-free asset to itself, and is additive w.r.t. any risk-free asset. Therefore, the output of a risk measure has the same unit with a risk-free asset, and can be calculated like an asset.\nThe domains of risk measures and the preference functional f are different, as risk measures are defined on X while the space of assets that agent can hold is X\u0302 . Fortunately, we could easily extend the definition to the domain X\u0302 by applying translation invariance (3.1)\n\u03c1(X\u0302) = \u03c1(X + w) = \u03c1(X)\u2212 w, \u2200X\u0302 \u2208 X\u0302 . (3.3)\nA corresponding f can thus be obtained by f = \u2212\u03c1.\nRisk measures are very generic. In our discussion we will use both risk measures and a specific class of them, the convex risk measures (Fo\u0308llmer and Schied, 2002). A risk measure is convex if \u2200X1, X2 \u2208 X and \u03bb \u2208 [0, 1]\n\u03c1(\u03bbX1 + (1\u2212 \u03bb)X2) \u2264 \u03bb\u03c1(X1) + (1\u2212 \u03bb)\u03c1(X2). (3.4)\nIt says that the risk of a combination of two assets should not be higher than holding them separately. In other words, convex risk measures encourage diversification, which is a natural condition on risk measures."}, {"heading": "3.1.1 Examples of risk measures", "text": "A famous non-convex risk measure is the Value at Risk (VaR) (Linsmeier and Pearson, 2000), which outputs a threshold loss l such that the probability of \u2212X exceeding l is smaller than a predefined level\nVaR\u03b1(X) \u2261 inf{l \u2208 R | P (\u2212X > l) \u2264 1\u2212 \u03b1}. (3.5)\nA famous convex risk measure is the Entropic risk measure (Fo\u0308llmer et al., 2004)\n\u03c1E = 1\n\u03b8 logMX(\u2212\u03b8) = sup Q\u2208P EQ[\u2212X]\u2212\n1 \u03b8 D[Q||P ]. (3.6)\nHereMX(t) \u2261 EP [etX ] is the moment-generating function, andD[\u00b7||\u00b7] is the KL-divergence (and this is where \u201centropic\u201d comes in). We mention that the second representation of \u03c1E holds for all convex risk measures, and this representation becomes the key to connecting the markets to machine learning (cf. Section 5)."}, {"heading": "3.2 Rational Choices", "text": "Recall that a portfolio that leads to a higher value of f(X\u0302) is preferred. Thus the favourite portfolio of an agent should be the one that maximises f , which we denote by {w,X}opt. The behaviour of choosing {w,X}opt is called the rational choice, and an agent is rational if it always chooses {w,X}opt as its trading goal. Since in our framework f = \u2212\u03c1, a rational agent will choose will {w,X}opt under the rule of\nmin {w,X} \u03c1(X\u0302) = min {w,X} \u03c1(w +X). (3.7)\nIn a market an agent only cares about its own goal (3.7). It seems like this property prevents us from linking markets to machine learning methods, as the latter always aim to achieve certain global objectives. However, with a careful design, we can let our markets implicitly define global objectives and make an agent contributes to the global objective at the same time as it achieves its own goal."}, {"heading": "4 Multi-period Trading Markets", "text": "In this section we will build our market, a multi-period trading market whose trades are driven by a market maker. \u201cMulti-period\u201d is used to indicate that the prices of the securities are allowed to vary at different time steps, and that agents can trade with the market maker in multiple times (Fo\u0308llmer et al., 2004). The market maker is introduced to simplify the market mechanism and to make the market run efficiently.\nIt is difficult to characterise the trading process in the markets with unspecified mechanisms, and those markets may not run efficiently. For example, there may not exist a consistent agreement among agents on how much should be paid to buy/sell one share of a security. Moreover, one agent who wants to sell a certain amount of shares may not find any buyers (Chen and Pennock, 2007). One way to simplify the trading process is by introducing a market maker (Hanson, 2007). A market maker is a special agent. It is a price maker, who defines the price for trading each security. All agents are only allowed to trade with the market maker. They can, however, make a trade at any time as long as they agree to pay under the market maker\u2019s pricing. The pricing rule of a market maker at time step t is a functional ct : X \u2192 R. At different time steps the cost for purchasing an asset may be different, i.e. it may happen that ct(X) 6= ct\u2032(X) when t 6= t\u2032.\nSuppose that an agent has a portfolio {wt\u22121, Xt\u22121} at time t\u22121 and it would like to buy \u2206Xt from the market maker at t. The agent cannot propose an arbitrary price \u2206wt for \u2206Xt but has to accept the price provided by the market maker \u2206wt = \u2212ct(\u2206Xt). The updated portfolio is thus restricted to {wt\u22121\u2212ct(\u2206Xt), Xt\u22121 +\u2206Xt},\nand the updated asset is restricted to X\u0302t = Xt\u22121 + wt\u22121 + \u2206Xt \u2212 ct(\u2206Xt). Now a rational agent only cares about choosing its optimal purchase amount \u2206Xt such that \u03c1(X\u0302t) is minimised:\nmin {wt,Xt} \u03c1(X\u0302t) = min \u2206Xt\u2208X\n\u03c1(Xt\u22121 + \u2206Xt + wt\u22121 \u2212 ct(\u2206Xt)). (4.1)\nThis portfolio selection procedure leads to Algorithm 1.\nAlgorithm 1 Select({wt\u22121, Xt\u22121}, \u03c1(\u00b7), ct(\u00b7)): portfolio selection of a rational agent Require: portfolio {wt\u22121, Xt\u22121}, risk measure \u03c1(\u00b7), pricing rule ct(\u00b7)\ncompute \u2206Xt = arg min\u2206X\u2032t\u2208X \u03c1(Xt\u22121 + \u2206X \u2032 t + wt\u22121 \u2212 ct(\u2206X \u2032t)) using (4.1)\nEnsure: {\u2206Xt,\u2212ct(\u2206Xt)}\nWe now consider a multi-period market which involves a set A = {1, 2, . . . , N} of agents and a market maker. Assume that at each round t there is only one agent at \u2208 A that trades with the market maker. This assumption indicates that each agent trades with the market maker separately, and they do not cooperate to make a joint purchase. {a1, a2, . . . , aT } is thus the trading queue of the market. Since there are multiple agents, we use an extra subscript to distinguish the portfolios of different agents. For example, an agent n \u2208 A\u2019s portfolio at time t is {wn,t, Xn,t}. The initial values are denoted with the subscript t = 0. We collect all wn,t, Xn,t, X\u0302n,t into vectors wt,Xt and X\u0302t, respectively. We assume that agents do not bring in any risky asset at the beginning, which is a natural assumption since only the market maker can issue securities. This assumption means we have X0 = 0 and so X\u03020 = w0.\nAt time t, only the agent at updates its portfolio by trading with the market maker while all the other agents keep the same portfolios as at t\u2212 1. Suppose the asset that the agent at would like to purchase is \u2206Xat,t, then for all n \u2208 A\nXn,t = Xn,t\u22121 + 1(n = at)\u2206Xat,t, (4.2a) wn,t = wn,t\u22121 \u2212 1(n = at)ct(\u2206Xat,t). (4.2b)\nAlgorithm 2 runs a multi-period trading market.\nAlgorithm 2 A multi-period market with a set A of agents and a market maker Require: initial portfolios {w,X0}, risk measures {\u03c1n(\u00b7)}, pricing rule ct(\u00b7), time period T\nfor t = 1 to T do for each agent n \u2208 A do\npropose {\u2206Xn,t,\u2212ct(\u2206Xt)} = Select({wn,t\u22121, Xn,t\u22121}, \u03c1n(\u00b7), ct(\u00b7)) using Algorithm 1 end for trade happens between the market maker and at for each agent n \u2208 A do\nupdate their portfolios using (4.2) end for\nend for\nWe can also split Algorithm 2 into two routines, in terms of the market maker and each agent, respectively (Algorithm 3 and 4). We say this to emphasise the fact that each agent in the market has its own objective (which is to achieve the optimal portfolio based on its unique preferences), plus a communication with the market maker."}, {"heading": "4.1 Appropriate choice on the pricing rule ct(\u00b7)", "text": "There has been plenty of work on studying the pricing rule ct(\u00b7) of the market maker (Brahma et al., 2012; Pennock, 2004). A popular class of mechanisms is Hanson\u2019s market scoring rules (Hanson, 2007). It is later\nAlgorithm 3 The market maker in a multi-period market Require: time period T\nfor t = 1 to T do publish a pricing rule ct(\u00b7) collect trading request {\u2206Xn,t} from agents choose agent at and make trade, \u2206Xt \u2261 \u2206Xat,t update ct(\u00b7)\u2192 ct\u22121(\u00b7) end for close the market\nEnsure: {at}, {\u2206Xt}\nAlgorithm 4 An agent n \u2208 A in a multi-period market Require: initial portfolio {wn,0, Xn,0}, risk measure \u03c1n(\u00b7), starting point t = 1\nrepeat receive the pricing rule for time t compute {\u2206Xn,t,\u2212ct(\u2206Xn,t)} = Select({wn,t\u22121, Xn,t\u22121}, \u03c1n(\u00b7), ct(\u00b7)) and send its trading request to the market maker if trade happens then Xn,t = Xn,t\u22121 + \u2206Xn,t wn,t = wn,t\u22121 \u2212 ct(\u2206Xn,t)\nelse Xn,t = Xn,t\u22121, wn,t = wn,t\u22121,\u2206Xn,t = 0 end if t = t+ 1\nuntil market is closed Ensure: {wn,t, Xn,t}t=1,2,..., {\u2206Xn,t}t=1,2,...\nformalised by Abernethy et al. (2013), who use a set of reasonable axioms to characterise the pricing mechanism. We apply their result to our framework.\nLet \u2206Xt \u2261 \u2206Xat,t be the trade with the market maker at time t. Consider two situations: 1) a trade happens with the market maker in \u2206X; and 2) a trade happens with the market maker in \u2206X \u2032 and is immediately followed by another trade \u2206X \u2032\u2032, where \u2206X = \u2206X \u2032 + \u2206X \u2032\u2032. A natural requirement is that the cost of purchasing \u2206X should be equal to the total cost of purchasing \u2206X \u2032 and \u2206X \u2032\u2032. If we accept this property, then we can always find a functional c : X \u2192 R such that (Abernethy et al., 2013)\nct(\u2206Xt) = c(\u2206X1 + \u00b7 \u00b7 \u00b7+ \u2206Xt\u22121 + \u2206Xt)\u2212 c(\u2206X1 + \u00b7 \u00b7 \u00b7+ \u2206Xt\u22121). (4.3)\nWe say a pricing rule ct is path-independent if it has the form of (4.3), and reload the notation c to represent ct."}, {"heading": "5 The Machine Learning Objective of the Multi-period Trading Markets", "text": "Remember that the primary goal of this paper is to establish an intimate connection between machine learning and our new prediction markets model. Before we start to analyse the multi-period trading markets, we introduce the machine learning context for which we want our markets to be utilised. Many machine learning tasks could be interpreted under the following generic framework: given a set of data sampled from a space \u2126 and a hypothesis space P which contains a class of accessible probabilities on \u2126, we would like to find a probability from P that can best describe the data. Usually we use a functional F : P \u2192 R to characterise the \u201cbest\u201d performance, such that the best probability is the one that minimises F . Formally, this involves an optimisation\nproblem min P\u2208P F (P ) (5.1)\nFor specific problems in which the information comes from different parts of the data or the models, F has a form of F = \u2211 n Fn, the sum of a set of functionals which share the same domain P (see examples in Section 7 for details). We will show that a multi-period market effectively defines and optimises a machine learning task whose F (P ) = \u2211 n Fn(P ).\nThe connection is established in two steps: first we show that the market does have a global objective, and then show that under mild conditions the market optimises the dual of a machine learning problem minP\u2208P \u2211 n Fn."}, {"heading": "5.1 The global objective of a market", "text": "We show that a multi-period trading market minimises a global objective. The optimisation is done sequentially via the market trading dynamics, that is, an agent will contribute to minimising this global objective as long as it makes a trade with the market maker. This argument is formalised in the following\nProposition 1 (The global objective of a market). A multi-period market (Algorithm 2) with a path-independent pricing rule market maker aims to minimise the global objective\nL = c(Y ) + \u2211 n\u2208A \u03c1n(Xn), Y = \u2211 n\u2208A Xn, (5.2)\nby performing a sequential optimisation algorithm, which is implemented by the market trading process (cf. (4.1) and (4.2)):\n\u2206Xt = arg min\u2206X\u2032t \u03c1at(Xat,t\u22121 + \u2206X \u2032 t + wat,t\u22121 \u2212 ct(\u2206X \u2032t)), (5.3a) Xn,t = Xn,t\u22121 + 1(n = at)\u2206Xt, (5.3b) wn,t = wn,t\u22121 \u2212 1(n = at)ct(\u2206Xt), (5.3c) Yt = Yt\u22121 + \u2206Xt, (5.3d)"}, {"heading": "If the algorithm converges at time t\u2032, i.e. \u2206Xt = 0 for all t > t\u2032, then {Xn,t\u2032}, Yt\u2032 achieves a local minimum of the objective L in (5.2).", "text": "Proof. At time t only agent at will trade with the market maker, so \u2206Xt = \u2206Xat,t. At time t, for any agent n all quantities calculated before t can be treated as constants as they could no longer be modified. Therefore, the functional that is minimised in (5.3a) has the same optimal point with the following functional\nlt(\u2206X \u2032 t) = \u03c1at(Xat,t\u22121 + \u2206X \u2032 t + wat,t\u22121 \u2212 ct(\u2206X \u2032t))\u2212 \u03c1at(Xat,t\u22121 + wat,t\u22121). (5.4)\nApply the property of translation invariance to lt, we have\nlt(\u2206X \u2032 t) = \u03c1at(Xat,t\u22121 + \u2206X \u2032 t)\u2212 \u03c1at(Xat,t\u22121) + ct(\u2206X \u2032t). (5.5)\nSum over all lt\u2019s and denote this summation by LT , which is a functional. Then\nmin {\u2206X\u2032t} LT = min {\u2206X\u2032t} T\u2211 t=1 lt(\u2206X \u2032 t) = T\u2211 t=1 min \u2206X\u2032t lt(\u2206X \u2032 t) = T\u2211 t=1 lt(\u2206Xt). (5.6)\nHere \u2206Xt\u2019s are the optimal point obtained from (5.3a). Substitute (5.5) to (5.6)\nT\u2211 t=1 lt(\u2206Xt) = T\u2211 t=1 \u03c1at(Xat,t\u22121 + \u2206Xt)\u2212 \u03c1at(Xat,t\u22121) + T\u2211 t=1 ct(\u2206Xt). (5.7)\nNote that at time t for any agent n 6= at it makes no trade \u2206Xn,t = 0, and so\n\u03c1n(Xn,t\u22121 + \u2206Xn,t)\u2212 \u03c1n(Xn,t\u22121) = 0, \u2200n 6= at. (5.8)\nThe first summation on RHS thus becomes\nT\u2211 t=1 \u03c1at(Xat,t\u22121 + \u2206Xt)\u2212 \u03c1at(Xat,t\u22121)\n= T\u2211 t=1 \u2211 n\u2208A \u03c1n(Xn,t\u22121 + \u2206Xn,t)\u2212 \u03c1n(Xn,t\u22121)\n= \u2211 n\u2208A \u03c1n(Xn,T )\u2212 \u03c1n(Xn,0). (5.9)\nSince the pricing rule is path-independent, the second summation on RHS is\nT\u2211 t=1 ct(\u2206Xt) = T\u2211 t=1 ct(Yt)\u2212 ct(Yt\u22121) = c(Yt)\u2212 c(0), (5.10)\nwhere Yt = \u2211t \u03c4=1 \u2206X\u03c4 and Y0 = 0. Since Xn,0 = 0 and for any t and n 6= at \u2206Xn,t = 0, we have\nYt = t\u2211 \u03c4=1 \u2206X\u03c4 = t\u2211 \u03c4=1 \u2206Xa\u03c4 ,\u03c4 = t\u2211 \u03c4=1 \u2211 n\u2208A \u2206Xn,\u03c4\n= \u2211 n\u2208A t\u2211 \u03c4=1 \u2206Xn,\u03c4 = \u2211 n\u2208A Xn,t, \u2200t > 0. (5.11)\nFinally, substitute (5.9) (5.10) and (5.11) to (5.6) and merge the rest terms we can end up with\nmin {\u2206Xt} LT = min {\u2206Xt} c(YT ) + \u2211 n\u2208A \u03c1n(Xn,T )\u2212 c(0), (5.12)\nwhere YT = \u2211 n\u2208A \u2206Xn,T . This is a sequential minimisation scheme for minL. Finally, if the market converges at time T , we have Xn = Xn,T and Y = YT , leading to at a local minimum of L.\nProposition 1 is the key to understanding the market mechanism. Despite that the market is set up to let agents behave under their own preferences, the market mechanism ensures that a global objective is established, and that the agent will contribute to optimising the global objective at the same time as it optimise its own goal. The trading process thus provides a sensible algorithm for achieving this global objective."}, {"heading": "5.2 A primal-dual representation via convex analysis", "text": "One concern is that (5.2) is not commonly seen in machine learning problems1. A different view of this objective should somehow be introduced. In fact, under mild requirements on the form of risk measures and pricing rules, the global objective forms the dual of the optimisation problem minP\u2208P \u2211 n Fn(P ). The requirement for the risk measures is convexity (3.4). The requirement for the pricing rules is that it is dualitybased (Abernethy et al., 2013).\n1However, to complete our discussion, we show one example that uses (5.2) in Section 7"}, {"heading": "5.2.1 More on convex risk measures", "text": "Artzner et al. (1999) and Fo\u0308llmer and Schied (2002) show that a convex risk measure has a form\n\u03c1(X) = sup Q\u2208P\n(EQ[\u2212X]\u2212 \u03b1(Q)) , (5.13)\nwhere P is a set of probabilities on (\u2126,F) such that Q is absolutely continuous w.r.t. P and EQ[X] is well defined. The risk measure decreases as EQ[X] increases but this effect is penalised by a functional \u03b1. (5.13) is in essence a Legendre-Fenchel transform with a slight change on signs (Boyd and Vandenberghe, 2004)."}, {"heading": "5.2.2 Duality-based pricing rules", "text": "We keep following the idea of Abernethy et al. (2013) and apply their duality-based pricing rules to our problem. The authors point out that duality-based pricing rules are well motivated as they meet some natural conditions such as no-arbitrage. A duality-based pricing rule is path-independent and has a form2\nc(X) \u2261 sup Q\u2208P (EQ[X]\u2212R(Q)) = R\u2217(X), (5.14)\nwhere R\u2217 denotes the Legendre-Fenchel transform of R. Note that in their work R is required to be convex, but this condition could be relaxed since for any R we could define R\u2032 \u2261 (R\u2217)\u2217 = c\u2217 to replace R, as R\u2032 is always convex (as it is a conjugate dual) and c = (R\u2032)\u2217 = R\u2217."}, {"heading": "5.2.3 The primal problem", "text": "Now we are ready to show\nProposition 2 (The primal problem). For a multi-period market which involves agents who use convex risk measures in (5.13)and a duality-based pricing rule market maker in (5.14), its global objective is the dual of\nmin P\u2208P N\u2211 n=0 Fn(P ), (5.15)\nwhere F0 and Fn are functionals that share the same domain P . Specifically, F0 = R in (5.14), and Fn = \u03b1n where \u03b1n is the penalty functional of agent n.\nProof. We use the generalised Fenchel\u2019s duality (Shalev-Shwartz and Singer, 2007) to derive the Lagrange dual problem of (5.15). The generalised Fenchel\u2019s duality states that the dual of problem (5.15) is\n\u2212 min {Xn}\u2208X F \u22170 (Y ) + N\u2211 n=1 F \u2217n(\u2212Xn), Y = N\u2211 n=1 Xn, (5.16)\nwhere F \u2217n denotes the Legendre-Fenchel transform.\nWe construct the convex risk measure for each agent n. use (5.13) and choose \u03b1 = Fn\n\u03c1n(X) = sup Q\u2208P\n(EQ[\u2212X]\u2212 Fn(Q)) = F \u2217n(\u2212X). (5.17)\nFor the pricing rule (5.14) we choose R = F0 and obtain c = F \u22170 . Substitute them back to the dual problem (5.16) and we end up with\n\u2212 min {Xn} L = \u2212 min {Xn}\u2208X c(Y ) + N\u2211 n=1 \u03c1n(Xn). (5.18)\n2Abernethy et al. (2013) represent markets in securities {\u03bek} and shares {sk}. To be consistent with our framework we change the representation to assets X (cf. Section 2).\nThis matches the global objective L (cf. (5.2)) with a different sign. The negation sign is necessary because the Lagrange dual problem lower bounds the primal one\n\u2212 min {Xn} L \u2264 min P\u2208P N\u2211 n=0 Fn(P ), (5.19)\nand become exact when the strong duality holds (Boyd and Vandenberghe, 2004).\nProposition 2 gives us two ways of building the connection between markets and machine learning: 1) If we model a market using our framework, we could then figure out the global objective of the market and then the primal problem, which can be solved using machine learning methods. 2) More interestingly, given a machine learning problem of form (5.15), we could transform it to a market and solve the problem by running the market, during which we could take the advantage of some market properties, such as distributed environment and privacy, to gain extra benefits."}, {"heading": "6 Related Work", "text": "The idea of building models for prediction markets and discussing their relation to optimisation is not novel, and a few significant progresses have been achieved in the past few years. We will discuss the work that is closely related to ours.\nIt is Chen and Vaughan (2010) who first show that what scoring rule market makers do are effectively online no-regret learning. Their study focuses on the market makers while agents are not directly modelled, which motivates a framework for the whole market.\nStorkey (2011) defines and analyses a type of prediction markets based on definitions on the markets, securities, and agents. Agents are modelled by EUT, that is, an agent is rational by maximising its expected utility. By analysing the equilibrium status of the market the author shows that the market can aggregate beliefs from agents to output a probability distribution over the future events. The author does not discuss precise market mechanisms or give the global objective of the market, which makes it difficult to link these markets to optimisation procedures.\nAnother important progress is given by Penna et al. (2012), who apply the market scoring rules as the market mechanism to the framework of Storkey (2011). The work shows that with a large population of agents whose portfolios are drawn from a demand distribution, the whole market implements stochastic mirror descent. One concern is that they suggest using EUT to model agents but they do not use it to solve the optimal portfolios for the agents. This problem is partially solved by Premachandra and Reid (2013), who derives the solution for a certain type of expected utilities. A similar setting is also studied by Sethi and Vaughan (2013). They focus more on the convergence of the market dynamics, and show how markets can aggregate beliefs by using numerical evidences."}, {"heading": "6.1 Risk measures and EUT", "text": "Here we justify the choice of risk measures as the agent decision rules. First, the output value of a risk measure can be treated as a risk-free asset and standard linear operations are well defined for it. In comparison, an expected utility outputs a number that only has abstract meaning, i.e. to measure the degree of agent\u2019s satisfaction. Additionally, risk measures force translation invariance by definition, but expected utility functions do not have this property in general. With the help of translation invariance, the wealth w can always be separated from the risky asset X , which implies that the optimal portfolio does not depend on w. This saves us from the trouble of associating w with the aggregation weights, as the relationship between them is highly\ninconsistent and varies dramatically under different utilities (Storkey et al., 2012). Finally, we could always derive convex a risk measure \u03c1u from any expected utility (Fo\u0308llmer et al., 2004)\n\u03c1u(X) \u2261 inf{m \u2208 R | EP [u(X +m)] \u2265 u0}, (6.1)\nwhere P is the personal belief of the agent. In fact, the output of this risk measure is the risk premium, the least amount of money that one would like to borrow in order to accept this risky asset. Then a sensible decision rule should be to find an asset that minimise the premium, which leads to our decision rule.\nAs an example, consider the HARA utility\nuH(x) = 1\u2212 \u03b3 \u03b3\n( ax\n1\u2212 \u03b3 + b\n)\u03b3 , a > 0, ax\n1\u2212 \u03b3 + b > 0. (6.2)\nThe resultant convex risk measure is the one who has the following penalty functional\n\u03b1(Q) = \u03b3\na \u03b7\u22121/\u03b7(\u2212u0)1/\u03b3 E\n[( dQ\ndP\n)\u03b7]1/\u03b7 + (1\u2212 \u03b3) b\na , (6.3)\nwhere 1/\u03b7+1/\u03b3 = 1. A special case of HARA is given by b = 1 and \u03b3 \u2192 \u2212\u221e, which leads to the exponential utility function uE(x) = \u2212 exp(\u2212ax). It is easy to check that the risk measure associated with exponential utility uE is exactly the entropic risk measure in (3.6) with \u03b8 = a (Fo\u0308llmer and Schied, 2002)."}, {"heading": "7 Examples", "text": "In this section we use three examples to illustrate the connections between the multi-period trading markets and machine learning."}, {"heading": "7.1 Opinion Pooling", "text": "The opinion pooling problem is a common setting for prediction market models (Barbu and Lay, 2012; Storkey et al., 2012). Garg et al. (2004) show that the objective of an opinion pool is to minimise a weighted sum of a set of divergences. Particularly, for logarithmic opinion pool the objective is to\nmin P\u2208P \u2211 n wnD[P ||Pn], (7.1)\nwhere D[\u00b7||\u00b7] is the KL-divergence and {wn} are weight parameters.\nNow consider an log-opinion pool of a set of A probabilities on a finite discrete sample space \u2126 with K states. To set up a market that matches the log-opinion pool, we first define a market on the same space \u2126 and introduce K Arrow-Debreu securities. We introduce N agents, and assign a unique probability Pn \u2208 A to agent n as its personal belief. According to (3.6), agent n\u2019s risk measure has the form\n\u03c1n(sn) = 1\n\u03b8n log K\u2211 k=1 pke \u2212\u03b8nsn,k , (7.2)\nwhere we let \u03b8n match the weight wn by \u03b8\u22121n = wn. For the sake of simplicity, we choose a logarithmic market scoring rule market maker (Hanson, 2007)\nc(s0) = 1\n\u03b80 log K\u2211 k=1 e\u03b80s0,k . (7.3)\nThe market can be run by using Algorithm 2. Two typical simulation results are shown in Figure 1 and 2. The primal problem of this market is (applying Proposition 1 and 2)\nmin P\u2208P\n1\n\u03b80 D[P ||P0] + \u2211 n\u2208A 1 \u03b8n D[P ||Pn], (7.4)\nwhere the domain P = \u2206K is the probability simplex in K dimensions and P0 = uniform(K) is the discrete uniform distribution in \u2206K . In this case the optimal P can be analytically solved. Recall that \u03b8\u22121n = wn and we have\nP \u221d \u220f n\u2208A P wn/(\u03b8 \u22121 0 + \u2211 n\u2208A wn) n . (7.5)\nSince we introduce the market maker, the aggregated belief P is not a pure weighted product of agents\u2019 beliefs, but with a bias towards P0. However, when the population is sufficiently large such that \u2211 n \u03b8 \u22121 n \u03b8\u221210 , the effect of the market maker could be ignored and we will end up with a pure aggregation of agent beliefs (Penna et al., 2012)."}, {"heading": "7.2 Bayesian Update", "text": "We give our second example by first setting up a market and then match a machine learning problem to the market. Let\u2019s build a market on a continuous sample space \u2126 = R. We only define one security \u03be(\u03c9) = \u03c9, and so the asset X = s\u03c9. We introduce only one agent. Again, the agent is characterised by an entropic risk measures, with coefficient \u03b81 and P1 = N (\u00b51, \u03c321) is the normal distribution. The moment-generating function in (3.6) is\nMX(\u2212\u03b81) = EP1 [e\u2212\u03b81s\u03c9] = e\u2212\u03b81s\u00b51+\u03c3 2 1\u03b8 2 1s 2/2, (7.6)\nand so the risk measure is \u03c11(s) = \u2212s\u00b51 + \u03c321\u03b81s2/2. For the market maker we use the quadratic market scoring rule c(s) = \u03b80s2/2. Now we could run this market using Algorithm 2 with only one agent.\nIt could be shown that this market implements a Bayesian maximum a posteriori (MAP) update for the Gaussian, in which the prior is provided by the market maker and the likelihood information is provided by the agent.\nConsider the setting of estimating a univariate Gaussian N (\u00b5, \u03c31). All we need is the sufficient statistics calculated from a set of N data points D = {x1, x2, . . . , xN}. For clarity of exposition let\u2019s assume that we only care about the Bayesian updates of the mean parameter \u00b5, and think \u03c31 is a prefixed constant. Introduce a Conjugate prior on the mean\np(\u00b5 | \u00b50, \u03c30) \u221d exp ( \u2212 1 \u03b80 (\u00b5\u2212 \u00b50)2 2\u03c320 ) , (7.7)\nwhere \u03b8\u221210 is so-called the pseudo count. The posterior is\np(\u00b5 | D, \u00b50, \u03c30) \u221d p(\u00b5 | \u00b50, \u03c30)p(D | \u00b5, \u03c31) \u221d exp ( \u2212 1 \u03b80 (\u00b5\u2212 \u00b50)2 2\u03c320 ) exp ( \u2212N (\u00b5\u2212 x\u0304) 2 2\u03c321 ) \u221d exp\n( \u2212 1 \u03b80 (\u00b5\u2212 \u00b50)2 2\u03c320 \u2212 1 \u03b81 (\u00b5\u2212 \u00b51) 2\u03c321 ) , (7.8)\nwhere \u00b51 = x\u0304 denotes the sample mean of the data set, and \u03b81 = N\u22121. If our goal is to calculate the MAP distribution then we have an optimisation problem\nL = min \u00b5\u2208R\n1\n\u03b80\n(\u00b5\u2212 \u00b50)2\n2\u03c320 +\n1\n\u03b81\n(\u00b5\u2212 \u00b51)2\n2\u03c321 . (7.9)\nLet\nF0(\u00b5) \u2261 1\n\u03b80\n(\u00b5\u2212 \u00b50)2\n2\u03c320 , F1(\u00b5) \u2261\n1\n\u03b81\n(\u00b5\u2212 \u00b51)2\n2\u03c321 , (7.10)\nand thus we have L = min\u00b5\u2208R F0(\u00b5) + F1(\u00b5). Since F0 and F1 are convex, we could apply the Fenchel\u2019s duality to the problem L, which gives us the following dual problem\n\u2212 L\u2032 = min s\u2208R F \u22170 (s) + F \u2217 1 (\u2212s), (7.11)\nwhere F \u22170 is the Legendre-Fenchel transform of F0\nF \u22170 (s) = sup \u00b5\u2208R\ns\u00b5\u2212 F0(s) = s\u00b50 + 1\n2 \u03c320\u03b80s 2, (7.12)\nand similarly F \u22171 (s) = s\u00b51 + 1 2\u03c3 2 1\u03b81s 2. Choose the hyperparameter \u00b50 = 0, \u03c30 = 1, and we finally have\n\u2212 L\u2032 = min s\u2208R \u03b80 2 s2 +\n( \u2212s\u00b51 + 1\n2 \u03c321\u03b81s 2\n) = min\ns\u2208R c(x) + \u03c11(s). (7.13)\nThis is exactly the agent\u2019s objective. Since s and \u00b5 are dual to each other, the market performs the Bayesian update (MAP estimate) in the dual space of the mean parameters."}, {"heading": "7.3 Logistic Regression", "text": "In the third example we discuss a classic machine learning problem. Given a data set D = {{xm,ym} | xm \u2208 RK ,ym = {+1,\u22121},m = 1, . . . ,M}, we would like to build logistic regression model with l2-regularisation. The objective is\nL = min w\u2208RK\n1\nM M\u2211 m=1 log ( 1 + eym(w\u00b7xm) ) + \u03bb 2 \u2016w\u20162, (7.14)\nwhere \u2016 \u00b7 \u2016 is the l2 norm.\nTo convert this problem to a market we use (5.2) and Proposition 1. Let the sample space be the space that generates the data \u2126 \u2261 RK\u222a{+1,\u22121} and each future state is associated with a data in \u2126, \u03c9 = {x, y}. Define K securities, each of which is \u03bek(\u03c9) = yxk. We introduce N = K agents, such that the agent n = k is only interested in trading in the k-th security \u03bek. Thus the shares of security k held by agent n is sn,k = 1(n = k)wk, and the asset is Xn = sn \u00b7 \u03be = wn\u03ben. The market inventory is s0 = \u2211 n sn = w. Let c(w) be the first term on the RHS of (7.14) and define the risk measure of agent n as \u03c1n(sn) = \u03bbs2n/2. We end up with\nL = min w c(w) + K\u2211 k=1 \u03bb 2 w2k = min{sn} c(s0) + N\u2211 n=1 \u03c1n(sn). (7.15)\nNow the market is ready to run under Algorithm 2. In order to show a slightly deeper connection to a specific learning method, we notice that the objective of agent n at each round is min\u2206wk,t c(wt\u22121+\u2206wk,t)+(wk,t\u22121+ \u2206wk,t)\n2/2. As the solution to this is not analytic, it is costly to solve for the exactly minimum of this objective at each time. To get rid of this problem, we could relax the condition that agents behaviour is rationally optimal, and let the agents accept a portfolio as long as it is better than its current position \u03c1n(s\u0302n,t) < \u03c1n(s\u0302n,t\u22121). Specifically agents can take steps towards the optimal solution. This can be achieved by the following portfolio updating rule\n\u2206wk,t = \u2212a d\ndwk\n( c(w) + \u03bb\n2 w2k )\u2223\u2223\u2223\u2223 w=wt\u22121 , (7.16)\nwhere a > 0 is adjusted such that \u03c1n(s\u0302n,t) < \u03c1n(s\u0302n,t\u22121). In practice a could be chosen by backtracking line search (Boyd and Vandenberghe, 2004). The market we designed above effectively implements a coordinate descent algorithm (Luo and Tseng, 1992).\nNote that, instead of introducing N = K agents, we can match the logistic regression problem by using only one agent and allowing it to trade all securities. This will result in a standard gradient descent method."}, {"heading": "8 Conclusion", "text": "This paper establishes and discusses a new model for prediction markets. We use risk measures instead of expected utility to model agents, which results in an analytical market framework. We show that our market as a whole optimises certain global objective through its market dynamics. Based on this result, we make intimate connections between machine learning and markets.\nOne future work would be conducting a detailed analysis of this framework using the tools of convex optimisation (Boyd and Vandenberghe, 2004). A particularly interesting topic is to find the conditions under which the market will converge. As we have observed, the stochasticity comes in when a large population of agents are involved, which is believed to be the nature of any real market (Penna et al., 2012)."}, {"heading": "Acknowledgement", "text": "This work was supported by Microsoft Research Cambridge through its PhD Scholarship Programme."}], "references": [{"title": "Efficient market making via convex optimization, and a connection to online learning", "author": ["J. Abernethy", "Y. Chen", "J.W. Vaughan"], "venue": "ACM Trans. Econ. Comput., 1(2):12:1\u201312:39. 2, 6, 8, 9", "citeRegEx": "Abernethy et al\\.,? 2013", "shortCiteRegEx": "Abernethy et al\\.", "year": 2013}, {"title": "Coherent measures of risk", "author": ["P. Artzner", "F. Delbaen", "Eber", "J.-M.", "D. Heath"], "venue": "Mathematical Finance, 9(3):203\u2013228. 3, 9", "citeRegEx": "Artzner et al\\.,? 1999", "shortCiteRegEx": "Artzner et al\\.", "year": 1999}, {"title": "An introduction to artificial prediction markets for classification", "author": ["A. Barbu", "N. Lay"], "venue": "Journal of Machine Learning Research, 13:2177\u20132204. 1, 11", "citeRegEx": "Barbu and Lay,? 2012", "shortCiteRegEx": "Barbu and Lay", "year": 2012}, {"title": "Convex optimization", "author": ["S.P. Boyd", "L. Vandenberghe"], "venue": "Cambridge university press. 9, 10, 14, 15", "citeRegEx": "Boyd and Vandenberghe,? 2004", "shortCiteRegEx": "Boyd and Vandenberghe", "year": 2004}, {"title": "A bayesian market maker", "author": ["A. Brahma", "M. Chakraborty", "S. Das", "A. Lavoie", "M. Magdon-Ismail"], "venue": "Proceedings of the 13th ACM Conference on Electronic Commerce, EC \u201912, pages 215\u2013232, New York, NY, USA. ACM. 5", "citeRegEx": "Brahma et al\\.,? 2012", "shortCiteRegEx": "Brahma et al\\.", "year": 2012}, {"title": "A utility framework for bounded-loss market makers", "author": ["Y. Chen", "D. Pennock"], "venue": "Proceedings of the Twenty-Third Conference Annual Conference on Uncertainty in Artificial Intelligence (UAI-07), pages 49\u201356, Corvallis, Oregon. AUAI Press. 4", "citeRegEx": "Chen and Pennock,? 2007", "shortCiteRegEx": "Chen and Pennock", "year": 2007}, {"title": "A new understanding of prediction markets via no-regret learning", "author": ["Y. Chen", "J.W. Vaughan"], "venue": "Proceedings of the 11th ACM conference on Electronic commerce, EC \u201910, pages 189\u2013198, New York, NY, USA. ACM. 1, 10", "citeRegEx": "Chen and Vaughan,? 2010", "shortCiteRegEx": "Chen and Vaughan", "year": 2010}, {"title": "Convex measures of risk and trading constraints", "author": ["H. F\u00f6llmer", "A. Schied"], "venue": "Finance and Stochastics, 6(4):429\u2013447. 3, 9, 11", "citeRegEx": "F\u00f6llmer and Schied,? 2002", "shortCiteRegEx": "F\u00f6llmer and Schied", "year": 2002}, {"title": "Stochastic finance: An introduction in discrete time", "author": ["H. F\u00f6llmer", "A. Schied", "T.J. Lyons"], "venue": "Springer, 2nd revised edition edition. 4, 11", "citeRegEx": "F\u00f6llmer et al\\.,? 2004", "shortCiteRegEx": "F\u00f6llmer et al\\.", "year": 2004}, {"title": "Generalized opinion pooling", "author": ["A. Garg", "T. Jayram", "S. Vaithyanathan", "H. Zhu"], "venue": "AMAI. 11", "citeRegEx": "Garg et al\\.,? 2004", "shortCiteRegEx": "Garg et al\\.", "year": 2004}, {"title": "Logarithmic market scoring rules for modular combinatorial information aggregation", "author": ["R. Hanson"], "venue": "The Journal of Prediction Markets, 1(1):3\u201315. 4, 5, 11", "citeRegEx": "Hanson,? 2007", "shortCiteRegEx": "Hanson", "year": 2007}, {"title": "Introductory functional analysis with applications", "author": ["E. Kreyszig"], "venue": "Wiley. com. 2", "citeRegEx": "Kreyszig,? 2007", "shortCiteRegEx": "Kreyszig", "year": 2007}, {"title": "Value at risk", "author": ["T.J. Linsmeier", "N.D. Pearson"], "venue": "Financial Analysts Journal, 56(2):pp. 47\u201367. 4", "citeRegEx": "Linsmeier and Pearson,? 2000", "shortCiteRegEx": "Linsmeier and Pearson", "year": 2000}, {"title": "On the convergence of the coordinate descent method for convex differentiable minimization", "author": ["Z. Luo", "P. Tseng"], "venue": "Journal of Optimization Theory and Applications, 72(1):7\u201335. 14", "citeRegEx": "Luo and Tseng,? 1992", "shortCiteRegEx": "Luo and Tseng", "year": 1992}, {"title": "Interpreting prediction markets: a stochastic approach", "author": ["N.D. Penna", "M.D. Reid", "R.M. Frongillo"], "venue": "Pereira, F., Burges, C., Bottou, L., and Weinberger, K., editors, Advances in Neural Information Processing Systems 25, pages 3275\u20133283. 1, 2, 10, 12, 13, 15", "citeRegEx": "Penna et al\\.,? 2012", "shortCiteRegEx": "Penna et al\\.", "year": 2012}, {"title": "A dynamic pari-mutuel market for hedging, wagering, and information aggregation", "author": ["D.M. Pennock"], "venue": "Proceedings of the 5th ACM conference on Electronic commerce, EC \u201904, pages 170\u2013179, New York, NY, USA. ACM. 5", "citeRegEx": "Pennock,? 2004", "shortCiteRegEx": "Pennock", "year": 2004}, {"title": "Toward a market model for bayesian inference", "author": ["D.M. Pennock", "M.P. Wellman"], "venue": "Proceedings of the Twelfth international conference on Uncertainty in artificial intelligence, pages 405\u2013413. Morgan Kaufmann Publishers Inc. 1", "citeRegEx": "Pennock and Wellman,? 1996", "shortCiteRegEx": "Pennock and Wellman", "year": 1996}, {"title": "Aggregating predictions via sequential mini-trading", "author": ["M. Premachandra", "M. Reid"], "venue": "the 5th Asian Conference on Machine Learning (ACML 2013). 10", "citeRegEx": "Premachandra and Reid,? 2013", "shortCiteRegEx": "Premachandra and Reid", "year": 2013}, {"title": "Belief aggregation with automated market makers", "author": ["R. Sethi", "J.W. Vaughan"], "venue": "Technical report, Microsoft Research New York. 10", "citeRegEx": "Sethi and Vaughan,? 2013", "shortCiteRegEx": "Sethi and Vaughan", "year": 2013}, {"title": "Convex repeated games and fenchel duality", "author": ["S. Shalev-Shwartz", "Y. Singer"], "venue": "Sch\u00f6lkopf, B., Platt, J., and Hoffman, T., editors, Advances in Neural Information Processing Systems 19, pages 1265\u20131272, Cambridge, MA. MIT Press. 9", "citeRegEx": "Shalev.Shwartz and Singer,? 2007", "shortCiteRegEx": "Shalev.Shwartz and Singer", "year": 2007}, {"title": "Machine learning markets", "author": ["A. Storkey"], "venue": "JMLR Workshop and Conference Proceedings, volume 15, pages 716\u2013724. 1, 2, 10", "citeRegEx": "Storkey,? 2011", "shortCiteRegEx": "Storkey", "year": 2011}, {"title": "Isoelastic agents and wealth updates in machine learning markets", "author": ["A. Storkey", "J. Millin", "K. Geras"], "venue": "the 29th International Conference on Machine Learning (ICML 2012). 11", "citeRegEx": "Storkey et al\\.,? 2012", "shortCiteRegEx": "Storkey et al\\.", "year": 2012}, {"title": "Theory of games and economic behavior (commemorative edition)", "author": ["J. Von Neumann", "O. Morgenstern"], "venue": "Princeton university press. 3", "citeRegEx": "Neumann and Morgenstern,? 2007", "shortCiteRegEx": "Neumann and Morgenstern", "year": 2007}, {"title": "Prediction markets", "author": ["J. Wolfers", "E. Zitzewitz"], "venue": "The Journal of Economic Perspectives, 18(2):107\u2013 126. 1", "citeRegEx": "Wolfers and Zitzewitz,? 2004", "shortCiteRegEx": "Wolfers and Zitzewitz", "year": 2004}, {"title": "The dual theory of choice under risk", "author": ["M.E. Yaari"], "venue": "Econometrica, 55(1):95\u2013115. 3", "citeRegEx": "Yaari,? 1987", "shortCiteRegEx": "Yaari", "year": 1987}], "referenceMentions": [{"referenceID": 23, "context": "Recently, prediction markets (Wolfers and Zitzewitz, 2004) show the promise of being the abstract framework for machine learners to design these systems.", "startOffset": 29, "endOffset": 58}, {"referenceID": 20, "context": "Additionally, the close relationship between prediction markets and probabilities shed light on a new way of achieving probabilistic modelling (Storkey, 2011).", "startOffset": 143, "endOffset": 158}, {"referenceID": 6, "context": "Instead of just focusing on market mechanisms (Chen and Vaughan, 2010), we would like to incorporate the agents and analyse our market as a whole.", "startOffset": 46, "endOffset": 70}, {"referenceID": 20, "context": "This setting is similar to (Storkey, 2011; Penna et al., 2012; Barbu and Lay, 2012); but unlike Barbu and Lay (2012), we will build a model on agent behaviours; and unlike", "startOffset": 27, "endOffset": 83}, {"referenceID": 14, "context": "This setting is similar to (Storkey, 2011; Penna et al., 2012; Barbu and Lay, 2012); but unlike Barbu and Lay (2012), we will build a model on agent behaviours; and unlike", "startOffset": 27, "endOffset": 83}, {"referenceID": 2, "context": "This setting is similar to (Storkey, 2011; Penna et al., 2012; Barbu and Lay, 2012); but unlike Barbu and Lay (2012), we will build a model on agent behaviours; and unlike", "startOffset": 27, "endOffset": 83}, {"referenceID": 12, "context": "Since Pennock and Wellman (1996), researchers have spent decades on building connections between machine learning and prediction markets.", "startOffset": 6, "endOffset": 33}, {"referenceID": 2, "context": ", 2012; Barbu and Lay, 2012); but unlike Barbu and Lay (2012), we will build a model on agent behaviours; and unlike", "startOffset": 8, "endOffset": 62}, {"referenceID": 14, "context": "Storkey (2011) and Penna et al. (2012), we model agents using risk measures, which makes our markets analytical.", "startOffset": 19, "endOffset": 39}, {"referenceID": 0, "context": "This definition is quite general, and securities defined in this way are also referred to as complex securities (Abernethy et al., 2013).", "startOffset": 112, "endOffset": 136}, {"referenceID": 11, "context": "If they are not, then we can always pick a subset {\u03bek\u2032(\u00b7)} of linearly independent securities from {\u03bek(\u00b7)} such that all the other securities in {\u03bek(\u00b7)} can be represented by the linear combination of {\u03bek\u2032(\u00b7)} (Kreyszig, 2007).", "startOffset": 210, "endOffset": 226}, {"referenceID": 24, "context": "These includes expected utility theory (EUT) (Von Neumann and Morgenstern, 2007), dual utility theory (Yaari, 1987), risk measures (Artzner et al.", "startOffset": 102, "endOffset": 115}, {"referenceID": 1, "context": "These includes expected utility theory (EUT) (Von Neumann and Morgenstern, 2007), dual utility theory (Yaari, 1987), risk measures (Artzner et al., 1999), etc.", "startOffset": 131, "endOffset": 153}, {"referenceID": 1, "context": "A (monetary) risk measure is defined as a functional \u03c1 : X \u2192 R such that \u03c1(0) is finite and \u03c1 satisfies the following conditions (Artzner et al., 1999): Translation invariance If X \u2208 X and m \u2208 R, then \u03c1(X +m) = \u03c1(X)\u2212m.", "startOffset": 129, "endOffset": 151}, {"referenceID": 7, "context": "In our discussion we will use both risk measures and a specific class of them, the convex risk measures (F\u00f6llmer and Schied, 2002).", "startOffset": 104, "endOffset": 130}, {"referenceID": 12, "context": "A famous non-convex risk measure is the Value at Risk (VaR) (Linsmeier and Pearson, 2000), which outputs a threshold loss l such that the probability of \u2212X exceeding l is smaller than a predefined level VaR\u03b1(X) \u2261 inf{l \u2208 R | P (\u2212X > l) \u2264 1\u2212 \u03b1}.", "startOffset": 60, "endOffset": 89}, {"referenceID": 8, "context": "5) A famous convex risk measure is the Entropic risk measure (F\u00f6llmer et al., 2004)", "startOffset": 61, "endOffset": 83}, {"referenceID": 8, "context": "\u201cMulti-period\u201d is used to indicate that the prices of the securities are allowed to vary at different time steps, and that agents can trade with the market maker in multiple times (F\u00f6llmer et al., 2004).", "startOffset": 180, "endOffset": 202}, {"referenceID": 5, "context": "Moreover, one agent who wants to sell a certain amount of shares may not find any buyers (Chen and Pennock, 2007).", "startOffset": 89, "endOffset": 113}, {"referenceID": 10, "context": "One way to simplify the trading process is by introducing a market maker (Hanson, 2007).", "startOffset": 73, "endOffset": 87}, {"referenceID": 4, "context": "1 Appropriate choice on the pricing rule ct(\u00b7) There has been plenty of work on studying the pricing rule ct(\u00b7) of the market maker (Brahma et al., 2012; Pennock, 2004).", "startOffset": 132, "endOffset": 168}, {"referenceID": 15, "context": "1 Appropriate choice on the pricing rule ct(\u00b7) There has been plenty of work on studying the pricing rule ct(\u00b7) of the market maker (Brahma et al., 2012; Pennock, 2004).", "startOffset": 132, "endOffset": 168}, {"referenceID": 10, "context": "A popular class of mechanisms is Hanson\u2019s market scoring rules (Hanson, 2007).", "startOffset": 63, "endOffset": 77}, {"referenceID": 0, "context": "If we accept this property, then we can always find a functional c : X \u2192 R such that (Abernethy et al., 2013) ct(\u2206Xt) = c(\u2206X1 + \u00b7 \u00b7 \u00b7+ \u2206Xt\u22121 + \u2206Xt)\u2212 c(\u2206X1 + \u00b7 \u00b7 \u00b7+ \u2206Xt\u22121).", "startOffset": 85, "endOffset": 109}, {"referenceID": 0, "context": "formalised by Abernethy et al. (2013), who use a set of reasonable axioms to characterise the pricing mechanism.", "startOffset": 14, "endOffset": 38}, {"referenceID": 0, "context": "The requirement for the pricing rules is that it is dualitybased (Abernethy et al., 2013).", "startOffset": 65, "endOffset": 89}, {"referenceID": 3, "context": "13) is in essence a Legendre-Fenchel transform with a slight change on signs (Boyd and Vandenberghe, 2004).", "startOffset": 77, "endOffset": 106}, {"referenceID": 0, "context": "2 Duality-based pricing rules We keep following the idea of Abernethy et al. (2013) and apply their duality-based pricing rules to our problem.", "startOffset": 60, "endOffset": 84}, {"referenceID": 19, "context": "We use the generalised Fenchel\u2019s duality (Shalev-Shwartz and Singer, 2007) to derive the Lagrange dual problem of (5.", "startOffset": 41, "endOffset": 74}, {"referenceID": 0, "context": "2Abernethy et al. (2013) represent markets in securities {\u03bek} and shares {sk}.", "startOffset": 1, "endOffset": 25}, {"referenceID": 3, "context": "and become exact when the strong duality holds (Boyd and Vandenberghe, 2004).", "startOffset": 47, "endOffset": 76}, {"referenceID": 6, "context": "It is Chen and Vaughan (2010) who first show that what scoring rule market makers do are effectively online no-regret learning.", "startOffset": 6, "endOffset": 30}, {"referenceID": 6, "context": "It is Chen and Vaughan (2010) who first show that what scoring rule market makers do are effectively online no-regret learning. Their study focuses on the market makers while agents are not directly modelled, which motivates a framework for the whole market. Storkey (2011) defines and analyses a type of prediction markets based on definitions on the markets, securities, and agents.", "startOffset": 6, "endOffset": 274}, {"referenceID": 6, "context": "It is Chen and Vaughan (2010) who first show that what scoring rule market makers do are effectively online no-regret learning. Their study focuses on the market makers while agents are not directly modelled, which motivates a framework for the whole market. Storkey (2011) defines and analyses a type of prediction markets based on definitions on the markets, securities, and agents. Agents are modelled by EUT, that is, an agent is rational by maximising its expected utility. By analysing the equilibrium status of the market the author shows that the market can aggregate beliefs from agents to output a probability distribution over the future events. The author does not discuss precise market mechanisms or give the global objective of the market, which makes it difficult to link these markets to optimisation procedures. Another important progress is given by Penna et al. (2012), who apply the market scoring rules as the market mechanism to the framework of Storkey (2011).", "startOffset": 6, "endOffset": 889}, {"referenceID": 6, "context": "It is Chen and Vaughan (2010) who first show that what scoring rule market makers do are effectively online no-regret learning. Their study focuses on the market makers while agents are not directly modelled, which motivates a framework for the whole market. Storkey (2011) defines and analyses a type of prediction markets based on definitions on the markets, securities, and agents. Agents are modelled by EUT, that is, an agent is rational by maximising its expected utility. By analysing the equilibrium status of the market the author shows that the market can aggregate beliefs from agents to output a probability distribution over the future events. The author does not discuss precise market mechanisms or give the global objective of the market, which makes it difficult to link these markets to optimisation procedures. Another important progress is given by Penna et al. (2012), who apply the market scoring rules as the market mechanism to the framework of Storkey (2011). The work shows that with a large population of agents whose portfolios are drawn from a demand distribution, the whole market implements stochastic mirror descent.", "startOffset": 6, "endOffset": 984}, {"referenceID": 6, "context": "It is Chen and Vaughan (2010) who first show that what scoring rule market makers do are effectively online no-regret learning. Their study focuses on the market makers while agents are not directly modelled, which motivates a framework for the whole market. Storkey (2011) defines and analyses a type of prediction markets based on definitions on the markets, securities, and agents. Agents are modelled by EUT, that is, an agent is rational by maximising its expected utility. By analysing the equilibrium status of the market the author shows that the market can aggregate beliefs from agents to output a probability distribution over the future events. The author does not discuss precise market mechanisms or give the global objective of the market, which makes it difficult to link these markets to optimisation procedures. Another important progress is given by Penna et al. (2012), who apply the market scoring rules as the market mechanism to the framework of Storkey (2011). The work shows that with a large population of agents whose portfolios are drawn from a demand distribution, the whole market implements stochastic mirror descent. One concern is that they suggest using EUT to model agents but they do not use it to solve the optimal portfolios for the agents. This problem is partially solved by Premachandra and Reid (2013), who derives the solution for a certain type of expected utilities.", "startOffset": 6, "endOffset": 1344}, {"referenceID": 6, "context": "It is Chen and Vaughan (2010) who first show that what scoring rule market makers do are effectively online no-regret learning. Their study focuses on the market makers while agents are not directly modelled, which motivates a framework for the whole market. Storkey (2011) defines and analyses a type of prediction markets based on definitions on the markets, securities, and agents. Agents are modelled by EUT, that is, an agent is rational by maximising its expected utility. By analysing the equilibrium status of the market the author shows that the market can aggregate beliefs from agents to output a probability distribution over the future events. The author does not discuss precise market mechanisms or give the global objective of the market, which makes it difficult to link these markets to optimisation procedures. Another important progress is given by Penna et al. (2012), who apply the market scoring rules as the market mechanism to the framework of Storkey (2011). The work shows that with a large population of agents whose portfolios are drawn from a demand distribution, the whole market implements stochastic mirror descent. One concern is that they suggest using EUT to model agents but they do not use it to solve the optimal portfolios for the agents. This problem is partially solved by Premachandra and Reid (2013), who derives the solution for a certain type of expected utilities. A similar setting is also studied by Sethi and Vaughan (2013). They focus more on the convergence of the market dynamics, and show how markets can aggregate beliefs by using numerical evidences.", "startOffset": 6, "endOffset": 1474}, {"referenceID": 21, "context": "inconsistent and varies dramatically under different utilities (Storkey et al., 2012).", "startOffset": 63, "endOffset": 85}, {"referenceID": 8, "context": "Finally, we could always derive convex a risk measure \u03c1u from any expected utility (F\u00f6llmer et al., 2004) \u03c1u(X) \u2261 inf{m \u2208 R | EP [u(X +m)] \u2265 u0}, (6.", "startOffset": 83, "endOffset": 105}, {"referenceID": 7, "context": "6) with \u03b8 = a (F\u00f6llmer and Schied, 2002).", "startOffset": 14, "endOffset": 40}, {"referenceID": 2, "context": "1 Opinion Pooling The opinion pooling problem is a common setting for prediction market models (Barbu and Lay, 2012; Storkey et al., 2012).", "startOffset": 95, "endOffset": 138}, {"referenceID": 21, "context": "1 Opinion Pooling The opinion pooling problem is a common setting for prediction market models (Barbu and Lay, 2012; Storkey et al., 2012).", "startOffset": 95, "endOffset": 138}, {"referenceID": 2, "context": "1 Opinion Pooling The opinion pooling problem is a common setting for prediction market models (Barbu and Lay, 2012; Storkey et al., 2012). Garg et al. (2004) show that the objective of an opinion pool is to minimise a weighted sum of a set of divergences.", "startOffset": 96, "endOffset": 159}, {"referenceID": 10, "context": "For the sake of simplicity, we choose a logarithmic market scoring rule market maker (Hanson, 2007)", "startOffset": 85, "endOffset": 99}, {"referenceID": 14, "context": "The experiment setting is similar to the biased coin market (Penna et al., 2012), in that all agents start with a uniform prior on \u03c9 and each one builds its own posterior belief after a private observation of 5 samples of \u03c9.", "startOffset": 60, "endOffset": 80}, {"referenceID": 14, "context": "However, when the population is sufficiently large such that \u2211 n \u03b8 \u22121 n \u03b8\u22121 0 , the effect of the market maker could be ignored and we will end up with a pure aggregation of agent beliefs (Penna et al., 2012).", "startOffset": 188, "endOffset": 208}, {"referenceID": 14, "context": "This is expected, as for a large population the market should reproduce the results of the biased coin market (Penna et al., 2012).", "startOffset": 110, "endOffset": 130}, {"referenceID": 3, "context": "In practice a could be chosen by backtracking line search (Boyd and Vandenberghe, 2004).", "startOffset": 58, "endOffset": 87}, {"referenceID": 13, "context": "The market we designed above effectively implements a coordinate descent algorithm (Luo and Tseng, 1992).", "startOffset": 83, "endOffset": 104}, {"referenceID": 3, "context": "One future work would be conducting a detailed analysis of this framework using the tools of convex optimisation (Boyd and Vandenberghe, 2004).", "startOffset": 113, "endOffset": 142}, {"referenceID": 14, "context": "As we have observed, the stochasticity comes in when a large population of agents are involved, which is believed to be the nature of any real market (Penna et al., 2012).", "startOffset": 150, "endOffset": 170}], "year": 2014, "abstractText": "We present a new model for prediction markets, in which we use risk measures to model agents and introduce a market maker to describe the trading process. This specific choice on modelling tools brings us mathematical convenience. The analysis shows that the whole market effectively approaches a global objective, despite that the market is designed such that each agent only cares about its own goal. Additionally, the market dynamics provides a sensible algorithm for optimising the global objective. An intimate connection between machine learning and our markets is thus established, such that we could 1) analyse a market by applying machine learning methods to the global objective, and 2) solve machine learning problems by setting up and running certain markets.", "creator": "LaTeX with hyperref package"}}}