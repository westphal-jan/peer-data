{"id": "1505.00308", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "2-May-2015", "title": "Multi-Object Classification and Unsupervised Scene Understanding Using Deep Learning Features and Latent Tree Probabilistic Models", "abstract": "Deep learning has shown state-of-art classification performance on datasets such as ImageNet, which contain a single object in each image. However, multi-object classification is far more challenging. We present a unified framework which leverages the strengths of multiple machine learning methods, viz deep learning, probabilistic models and kernel methods to obtain state-of-art performance on Microsoft COCO, consisting of non-iconic images. In each instance we propose a more general approach, using the algorithm-based approach to understand classification and non-iconic images.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "histories": [["v1", "Sat, 2 May 2015 03:23:46 GMT  (3153kb)", "http://arxiv.org/abs/1505.00308v1", null]], "reviews": [], "SUBJECTS": "cs.CV cs.LG", "authors": ["tejaswi nimmagadda", "anima anandkumar"], "accepted": false, "id": "1505.00308"}, "pdf": {"name": "1505.00308.pdf", "metadata": {"source": "CRF", "title": "Multi-Object Classification and Unsupervised Scene Understanding Using Deep Learning Features and Latent Tree Probabilistic Models", "authors": ["Tejaswi Nimmagadda"], "emails": ["nimmagas@uci.edu", "a.anandkumar@uci.edu"], "sections": [{"heading": null, "text": "ar X\niv :1\n50 5.\n00 30\n8v 1\n[ cs\n.C V\n] 2\nM ay\nDeep learning has shown state-of-art classification performance on datasets such as ImageNet, which contain a single object in each image. However, multi-object classification is far more challenging. We present a unified framework which leverages the strengths of multiple machine learning methods, viz deep learning, probabilistic models and kernel methods to obtain state-of-art performance on Microsoft COCO, consisting of non-iconic images. We incorporate contextual information in natural images through a conditional latent tree probabilistic model (CLTM), where the object co-occurrences are conditioned on the extracted fc7 features from pre-trained Imagenet CNN as input. We learn the CLTM tree structure using conditional pairwise probabilities for object co-occurrences, estimated through kernel methods, and we learn its node and edge potentials by training a new 3-layer neural network, which takes fc7 features as input. Object classification is carried out via inference on the learnt conditional tree model, and we obtain significant gain in precision-recall and F-measures on MS-COCO, especially for difficult object categories. Moreover, the latent variables in the CLTM capture scene information: the images with top activations for a latent node have common themes such as being a grasslands or a food scene, and on on. In addition, we show that a simple k-means clustering of the inferred latent nodes alone significantly improves scene classification performance on the MIT-Indoor dataset, without the need for any retraining, and without using scene labels during training. Thus, we present a unified framework for multi-object classification and unsupervised scene understanding."}, {"heading": "1 Introduction", "text": "Deep learning has revolutionized performance on a variety of computer vision tasks such as object classification and localization, scene parsing, human pose estimation, and so on. Yet, most deep learning works focus on simple classifiers at the output, and train on datasets such as ImageNet which consist of single object categories. On the other hand, multi-object classification is a far more challenging problem.\nCurrently many frameworks for multi-object classification use simple approaches: the multiclass setting, which predicts one category out of a set of mutually exclusive categories (e.g. ILSVRC [22]), or binary classification, which makes binary decisions for each label independently (e.g. PASCAL VOC [8]). Both models, however, do not capture the complexity of labels in natural\nimages. The labels are not mutually exclusive, as assumed in the multi-class setting. Independent binary classifiers, on the other hand, ignore the relationships between labels and miss the opportunity to transfer and share knowledge among different label categories during learning. More sophisticated classification techniques based on structured prediction are being explored, but in general, they are computationally more expensive and not scalable to large datasets (see related works for a discussion).\nIn this paper, we propose an efficient multi-object classification framework by incorporating contextual information in images. The context in natural images captures relationships between various object categories, such as co-occurrence of objects within a scene or relative positions of objects with respect to a background scene. Incorporating such contextual information can vastly improve detection performance, eliminate false positives, and provide a coherent scene interpretation.\nWe present an efficient and a unified approach to learn contextual information through probabilistic latent variable models, and combine it with pre-trained deep learning features to obtain state-of-art multi-object classification system. It is known that deep learning produces transferable features, which can be used to learn new tasks, which differ from tasks on which the neural networks were trained [26, 21]. Here, we demonstrate that the transferability of pre-trained deep learning features can be further enhanced by capturing the contextual information in images.\nWe model the contextual dependencies using a conditional latent tree model (CLTM), where we condition on the pre-trained deep learning features as input. This allows us to incorporate the joint effects of both the pre-trained features and the context for object classification. Note that a hierarchical tree structure is natural for capturing the groupings of various object categories in images; the latent or hidden variables capture the \u201cgroup\u201d labels of objects. Unlike previous works, we do not impose a fixed tree structure, or even a fixed number of latent variables, but learn a flexible structure efficiently from data. Moreover, since we make these \u201cgroup\u201d variables latent, there is no need to have access to group labels during training, and we learn the object groups or scene categories in a unsupervised manner. Thus, in addition to efficient multi-object classification, we also learn latent variables that capture semantic information about the scene in a unsupervised manner."}, {"heading": "1.1 Summary of Results", "text": "We propose a unified framework for multi-object classification and scene understanding that combines the strengths of multiple machine learning techniques, viz deep learning, probabilistic models, and kernel methods. We demonstrate significant improvement over state-of-art deep learning methods, especially on challenging objects. We learn a conditional latent tree model, where we condition on pre-trained deep learning features. We employ kernel methods to learn the structure of the hierarchical tree model, and we train a new smaller neural network to learn the node and edge potentials of the model. Multi-object classification is carried out via inference on the tree. All these steps are efficient and scalable to large datasets with a large number of object categories.\nWe extract features using pre-trained ImageNet CNN [15] from Caffe [12], and use it as input to the conditional latent tree model (CLTM), a type of conditional random field (CRF). The tree dependency structure for this model is recovered using distance based methods [4], which requires pairwise conditional probabilities of object co-occurrences, conditioned on the input features. We employ the kernel conditional embedding framework [23] to compute these pairwise measures. Using a feed-forward neural network, we train the above energy based model; the outputs of this neural network yield the node and edge potentials of the CLTM. We test performance of multi-object classification on a non-iconic image set Microsoft COCO [20] and we test its unsupervised scene learning capabilities on the MIT Indoor dataset [13].\nWe recover a natural coherent tree structure on the MS COCO data-set, using training images, each of which contain only few object categories. For instance, objects (e.g. table, chair and couch) that appear in a given scene (living room) are grouped together. Using our approach, precision-recall performance and F-measures are significantly improved compared to the baseline of a 3-layer neural\nnetwork with independent binary classifiers, which also takes in fc7 features as input. We see across the board improvement for all object categories over the entire precision-recall curve. The overall relative gain in F-measure for our method is 7%. For difficult objects like couch, frisbee, cup, bowl, remote, fork, and wine-glass, the F-measure relative gain is 41%, 48%, 50%, 53%, 113%, 122%, and 171% respectively. Thus, we combine pre-trained deep learning features and the learnt contextual model to obtain state-of-art multi-object classification performance.\nWe also demonstrate how latent nodes can be used for unsupervised scene understanding, without using any scene labels during training. We observe that latent nodes capture high-level semantic information common to images, based on the neighborhoods of object categories in the latent tree. When we consider the top images with largest activations of node potential for a given latent node, we find diverse images with different objects, but with a unifying common theme. For instance, for one of the latent variables, the top images capture a grassland scene but with different animals in different images. Similarly, the latent variable representing an outdoor scene contains diverse images with traffic, beaches, and buildings. As another example, the latent variable representing the food scene shows foods of various different kinds. Thus, we present a flexible framework for capturing thematic information in images in a unsupervised manner.\nWe also quantitatively show that the latent variables yield efficient scene classification performance on the MIT-Indoor dataset, without any re-training, and without using any scene labels during training. We use the marginal probabilities of the latent variables in our model on test images, and perform k-means clustering. For validation, we match these clusters to ground truth scene categories using maximum weight matching [1]. We obtain 20% improvement in misclassification rate of the scenes, compared to the neural network baseline. Note that we assume that the scene labels are not present during training for both our method, and for the neural network baseline. Thus, we demonstrate that our model is capable of capturing rich semantic information about the scenes, without using any scene labels during the training process.\nThus, we present a carefully engineering unified framework for multi-object classification that combines the strengths of diverse machine learning techniques. While general non-parametric methods are computationally expensive, and not scalable to large datasets, we employ kernel methods only to estimate pairwise conditional probabilities, which can be carried out efficiently using randomized matrix techniques [7]. Our tree structure estimation is scalable to large datasets using recent advances in parallel techniques for structure estimation [11]. Instead of training a large neural network from scratch, we train a smaller one, and we use a energy-based model at its output to obtain the node and edge potentials of the latent tree model. Finally, at test time, we have \u201clightning\u201d fast inference using message passing on the tree model. Thus, we present an efficient and a scalable framework for handling large image datasets with a large number of object categories."}, {"heading": "1.2 Related Work", "text": "Correlations between labels have been explored for detecting multiple object categories before. [6, 5] learn contextual relations between co-occurring objects using a tree structure graphical model to capture dependencies among different objects. In this model, they incorporate dependencies between object categories, and outputs of local detectors into one probabilistic framework. However, using simple pre-trained object detectors are typically noisy and lead to performance degradation. In contrast, we employ pre-trained deep learning features as input, and consider a conditional model for context, given the features. This allows us to incorporate both deep learning features and context into our framework.\nIn many settings, the hierarchical structure representing the contextual relations between different objects is fixed and is based on semantic similarity [10], or may rely on text, in addition to image information [19]. In contrast, we learn the tree structure from data efficiently, and thus, the framework can be adapted to settings where such a tree may not be available, and even if available, may not give the best classification performance for multi-object classification.\nUsing pre-trained ImageNet features for other computer vision tasks has been popular in a number of works recently, e.g. [26, 9, 21]. [9] term this as supervised pre-training and employ them to train regional convolutional neural networks (R-CNN) for object localization. We note that our framework can be extended to localization and we plan to pursue it in future. While [9] employ independent SVM classifiers for each class, we believe that incorporating our probabilistic framework for multi-object localization can significantly improve performance. Recently, [27] propose improving object detection using Bayesian optimization for fine grained search and a structured loss function that aims at both classification and localization. We believe that incorporating probabilistic contextual models can further improve performance in these settings.\nRecent papers also incorporate deep learning for scene classification. [29, 28] introduce the places dataset and use CNNs for scene classification. In this framework, scene labels are available during training, while we do not assume access to these labels during our training process. We demonstrate how introducing latent variables can automatically capture semantic information about the scenes, without the need for labeled data.\nScene understanding is a very rich and an active area of computer vision and consists of a variety of tasks such as object localization, pixel labeling, segmentation and so on, in addition to classification tasks. [18] propose a hierarchical generative model that performs multiple tasks in a coherent manner. [17] also consider the use of context by taking into account the spatial location of the regions of interest. While there is a large body of such works which use contextual information (see for instance [17]), they mostly do not incorporate latent variables in their modeling. In future, we plan to extend our framework for these various scene understanding tasks and expect significant improvement over existing methodologies.\nThere have been some recent attempts to combine neural networks with probabilistic models. For example, [2] propose to combine CRF and auto-encoder frameworks for unsupervised learning. Markov random fields are employed for pose estimation to encode the spatial relationships between joint locations in [24]. [3] propose a joint framework for deep learning and probabilistic models. They learn deep features which take into account dependencies between output variables. While they train a 8-layer deep network from scratch to learn the potential functions of a MRF, we exhibit how a simpler network can be used if we employ pre-trained features as an input to the conditional model. Moreover, we incorporate latent variables that allow us to use a simple tree model, leading to faster training and inference. Finally, while many works have used MS-COCO for captioning and joint image-text related tasks [14, 25], there have been no attempts to improve multi-object classification over standard deep learning techniques, using images alone on MS-COCO and not the text data, to the best of our knowledge.\nThe rest of this paper is organized as follows. Section 2 presents overview of the model. Section 3 presents structure learning method using input distribution of fc7 features. In Section 4, we discuss how we train CLTM using neural networks. In Section 5, we evaluate the proposed model on MS COCO dataset and discuss the results. Finally, Section 6 concludes the paper."}, {"heading": "2 Overview of The Model And Algorithm", "text": "We consider pre-trained ImageNet [15] as a fixed feature extractor by considering the fc7 layer (4096-D vector) as the feature vector for a given input image. We denote this extracted feature as xi for ith image. It is also demonstrated in [26] that such feature vectors can be effectively used for different tasks with different labels. The goal here is to learn models which can label an image to multiple-object categories present in a given image. Our model predicts a structured output y \u2208 {0, 1}L. To achieve this goal ,we use a dependency structure that relates different object labels. Such dependency structure should able to capture pair-wise probabilities of object labels conditioned on input features. We model this dependency structure using a latent tree. Firstly, these type of structures allow for more complex structures of dependence compared to a fully observed tree. Secondly, inference on it is tractable.\nAlgorithm 1 Overview of the Framework\nRequire: Labeled image-set I = {(I1, y1), \u00b7 \u00b7 \u00b7 , (In, yn)} 1: {x1, x2, \u00b7 \u00b7 \u00b7 , xn} \u2190 ExtractFc7Features(I) 2: Estimate conditional distance matrix :\nD\u2190 CondDistanceMatrix({(x1, y1), \u00b7 \u00b7 \u00b7 , (xn, yn)}) using kernel methods.\n3: Extract tree structure using [4] T \u2190 CLRG(D) 4: Training a NN with randomly initialized weights W: 5: repeat 6: randomly select a mini-batch M . 7: compute negative marginalized log-likelihood loss: Eqn.(2) L \u2190 Loss(W,T ,M ) 8: W\u2190 BackpropogateGradient(L) 9: until convergence\n10: Given a test image T : xt \u2190 ExtractFc7Features(T ) 11: Potentials\u2190 FeedForward(W,xt) 12: Prediction: y \u2190 argminY Energy(Y, Potentials)\nWe estimate probabilities of object co-occurrences conditioned on input fc7 features. We then use distance-based algorithm to recover the structure using estimated distance matrix. Once we recover the structure, we model the distribution of observed labels and latent nodes for a given input covariates as a discriminative model. We use conditional latent Tree Model, a class of CRF that belongs to exponential family of distributions to model distribution of output variables given an input. Instead of restricting the potentials(factors) to linear functions of covariates, we generalize potentials as functions represented by outputs of a neural network. For a given architecture of neural network which takes X as input, we learn weights W by backpropogating the gradient of marginalized log-likelihood of output binary variables. Once we train the given neural network, we consider the outputs of neural network as potentials for estimating marginal node beliefs conditioned on input covariates X . Our model also results in MAP configuration for a given input covariates X . Algo.1 gives overview of our framework.\nUse of non-parametric methods for end-end tasks on large datasets is computationally expensive. So, we restrict using kernel methods to only evaluate pairwise conditional probabilities, and here, we can use randomized matrix methods to efficiently scale the computations [7]. The tree structure\nis estimated through CL grouping algorithm from [4]. Although the method in [4] is serial, we note that recently there have been parallel versions of this method in [11]. Finally, we train neural networks to output node and edge potentials for CLTM. Finally, detection is carried out via inference on the tree model through message passing algorithms. Thus, we have an efficient procedure for multi-object detection in images."}, {"heading": "3 Conditional Latent Tree Model", "text": "We denote given labeled training set as D = {(x1, y1), \u00b7 \u00b7 \u00b7 , (xn, yn)} and xi \u2208 R4096, yi \u2208 {0, 1}L \u2200 i \u2208 (1, 2, \u00b7 \u00b7 \u00b7 , n). We denote extracted tree by T = (Z, E) where Z indicates the set of observed and latent nodes and E denotes edge set. Once we recover the structure, we use conditional latent tree model to model P (Z|X). Conditioned on input X , we model distribution of Z using in the below Eqn.\nP (Z|X) = exp\n\n\u2212 \u2211\nk\u2208Z\n\u03c6k(X, \u03b8)zk + \u2211\n(k,t)\u2208E\n\u03c6(k,t)(X, \u03b8)zkzt \u2212A(\u03b8,X)\n\n\nwhereA(X, \u03b8) is the term that normalizes the distribution, also known as the log partition function. \u03c6k(X, \u03b8) and \u03c6(k,t)(X, \u03b8) indicate the node and edge potentials of the exponential family distribution, respectively. Instead of restricting the potentials to linear functions of covariates, we generalize potentials as functions represented by outputs of a neural network. Sec.4 explains how we learn the weights of such a neural network.\nWe learn the dependency structure among object labels from a set of fully labeled images. Traditional distance-based methods use only empirical co-occurrences of objects to learn the structure. Learning a structure that involves strong pair-wise relations among objects requires training images to contain many instances of different object categories. In this section, we propose a new structure recovery method without the need of such training sets. This method involves both empirical co-occurrences and the distribution of fc7 features to calculate distances between labels.\nSince there are very few positive sample images with multiple object-categories, training just based on co-occurrence is not sufficient to recover a coherent tree structure. We leverage on extracted features to estimate moments by conditioning on them. We propose a new method to calculate the distance matrix by using a RKHS framework to estimate moments. The estimated distance matrix is then used by distance-based methods for structure recovery [4].\nKernel Embedding of Conditional Distribution\nThe kernel conditional embedding framework, described in [23] gives us methods for modeling conditional and joint distributions. These methods are effective in high-dimensional settings with multi-modal components such as the current setting .\nIn the general setting, given transformations \u03c6(X) and \u03a8(Y ) on X,Y to the RKHS using kernel functions K(x, .), K \u2032\n(y, .), the above framework provides us with the following empirical operators to embed joint distributions into the reproducing kernel Hilbert space (RKHS). Define\nC\u0302XX = 1\nN\nN \u2211\nn=1\n\u03c6(xn)\u2297 \u03c6(xn)\nC\u0302XY = 1\nN\nN \u2211\nn=1\n\u03c6(xn)\u2297\u03a8(yn),\nand C\u0302Y |X := C\u0302YXC\u0302\u22121XX . We have following results that can be used to evaluate E\u0302YiYj |X [yi \u2297 yj|x] for a given data-set.\n\u03a8(y)\u22a4C\u0302Y |X\u03c6(x) = \u03a8(y)\u22a4\u03a8Y (KXX + \u03bbNI)\u22121\u03c6\u22a4X\u03c6(x) (1)\nWe employ Gaussian RBF kernels and use the estimated conditional pairwise probabilities for learning the latent tree structure."}, {"heading": "3.1 Learning Latent Tree Structure", "text": "Algorithm 2 CondDistanceMatrix\nRequire: Input data-set D = {(x1, y1), \u00b7 \u00b7 \u00b7 , (xn, yn)} 1: Compute Gram matrix Kn\u00d7n using hyper-parameter \u03b3 2: for i = 1 TO i = n do 3: G = (K + \u03bbI)\u22121 \u00d7K(:, i). 4: for all pairs (k,t) where k,t \u2208 (1, 2, \u00b7 \u00b7 \u00b7 , L) do 5: E\u0302[Yk \u2297 Yt|X = xi] = [y1k \u2297 y1t , y2k \u2297 y2t , \u00b7 \u00b7 \u00b7 , ynk \u2297 ynt ]\u22a4G 6: Sk,t = | det(E\u0302[Yk \u2297 Yt|X = xi])| 7: Compute Di where Di[k, t] = \u2212 log( Sk,t\u221a\nSk,k\u00d7St,t )\n8: return DL\u00d7L = 1n \u2211n i=1 D i\nA significant amount of work has been done on learning latent tree models. Among the available approaches for latent tree learning, we use the information distance based algorithm CLGrouping [4] which has provable computational efficiency guarantees. These algorithms are based on a measure of statistical additive tree distance. For our conditional setting, we use the following form of the distance function:\nd\u0302kt = 1\nn\nn \u2211\ni=1\n\u2212 log ( | det(E\u0302[Yk \u2297 Yt|X = xi])| \u221a\nSk,k \u00b7 St,t\n)\n,\nwhere Sk,k := | det(E\u0302[Yk \u2297 Yk|X = xi])|, and similarly for St,t, for observed nodes k, t using N samples. We employ the CL grouping to learn the tree structure from the estimated distances."}, {"heading": "4 Learning CLTM Using Neural Networks", "text": "Energy-based learning provides a unified framework for many probabilistic and non-probabilistic approaches to structured output tasks [16], particularly for non-probabilistic training of graphical models and other structured models. Furthermore, the absence of the normalization condition allows for more flexibility in the design of learning machines. Most probabilistic models can be viewed as special types of energy-based models in which the energy function satisfies certain normalizability conditions, and in which the loss function, optimized by learning, has a particular form."}, {"heading": "4.1 Inference", "text": "Consider observed variable X and output variable Y. Define an energy function E(X,Y ) that is minimized when X and Y are compatible. The most compatible Y \u2217 given an observed X can be expressed as\nY \u2217 = argminY E(Y,X)\nThe energy function can be expressed as a factor graph, i.e. a sum of energy functions (node and edge potentials) that depend on input covariates x. Efficient inference procedures for factor graphs can be used to find the optimum configuration Y \u2217. In the below Eqn., we define the energy function which is used to model loss function.\nE(x, z, \u03b8) = \u2211\nk\u2208Z\n\u03c6k(x, \u03b8)zk + \u2211\n(k,t)\u2208E\n\u03c6(k,t)(x, \u03b8)zkzt"}, {"heading": "4.2 Training Energy Based Models using Neural Networks", "text": "Training an energy based model (EBM) consists of finding an energy function that produces the best Y for any X. The search for the best energy function is performed within a family of energy functions indexed by a parameter W. The architecture of the EBM is the internal structure of the parameterized energy function E(W,Y,X). In the case of neural networks the family of energy functions are the set of neural net architectures and weight values.\nFor a given neural network architecture, weights are learned by backpropagating the gradient through some loss function [16]. In the case of structures involving latent variables h, we use negative marginal log-likelihood loss (2) for training.\nL = E [E(W,x, y, h)|y, x]\u2212 E [E(W, y, x, h)|x] (2)\nAnd the gradient is evaluated using below Eqn.\n\u2202L \u2202W = E\n[\n\u2202E(W, y, x, h) \u2202W |x, y ] \u2212 E [ \u2202E(W, y, x, h) \u2202W |x ]"}, {"heading": "5 Experiments", "text": "In this section, we show experimental results of (a) classifying an image to multiple-object categories simultaneously and (b) identifying scenes from which images emerged. We use the non-iconic image data-set MS COCO [20] to evaluate our model. This data-set contains 83K training images with images labeled with 80 different object classes. The validation set contains 40K images. We use an independent classifier trained using 3 layer neural network (Indep. Classifier) as a baseline, and compare precision-recall measures with our proposed conditional latent tree model.\nImplementation\nWe use our conditional latent tree model as a standalone layer on top of a neural network. The layer takes as input a set of scores \u03c6(x,W ) \u2208 Rn. These scores correspond to node potentials of the energy function. To avoid over-fitting we make edge potentials independent of input covariates. Using these potentials, our model outputs marginal probabilities of all the labels along with the MAP configuration. During learning, we use stochastic gradient descent and compute \u2202L\n\u2202\u03c6 , where\nL is loss function defined in Eqn.(2). This derivative is then back propagated to the previous layers represented by \u03c6(x;w). Using a mini-batch size of 250 and dropout, we train the model. We use the Viterbi message passing algorithm for exact inference on conditional latent tree model."}, {"heading": "5.1 Structure Recovery", "text": "We use 40k images randomly selected from the training set to learn the tree structure using the distance based method proposed in Section 3. We have the recovered tree structure relating 80 different objects and 22 hidden nodes in 6 Appendix. From the learned tree structure, we can see that hidden nodes take the role of dividing the tree according to the scene category. For instance, the nodes connected to hidden nodes h19, h22, h9 and h17 contain objects from the kitchen, bathroom, wild animals and living room respectively. Similarly, all the objects that appear in outdoor traffic scenes are clustered around the observed node car. Note that most training images contain fewer than 3 instances of different object categories."}, {"heading": "5.2 Classification Performance on MS COCO", "text": "Table 1 shows the comparison of precision, recall and F-measure between 3 layer neural network independent classifier and Conditional Latent Tree Model trained using 1,2 and 3 layer feed forward neural networks respectively. For 3 layer neural network independent classifier, we use a threshold of 0.5 to make binary decisions for different object labels. For CLTM, we use the MAP configuration to make binary decisions. Note that CLTM improves F-measure significantly. Fig.2 shows the comparison of F-measure for each object category between baseline and CLTM trained using a 3 layer neural network. Over-all the gain in F-measure using our model is 7-percent compared to 3 Layer neural network. Note that F-measure gain for indoor objects is more significant. For difficult objects like skateboard, keyboard, laptop, bowl, cup and wine-glass, F-measure gain is 19- percent, 20-percent, 27-percent, 56-percent, 50-percent and 171-percent respectively. Fig. 3 shows the precision recall curves for a) entire test image set b) a subset of test images that contain 2 different object categories c) a subset of test images that contain 3 different object categories. We consider marginal probabilities of each observed class that our model produced to measure precision-recall curves for varying threshold values. Fig.4 shows comparison of plots of precision-recall curves of a subset of object classes: tennis racket, bed, keyboard and baseball glove."}, {"heading": "5.3 Qualitative Analysis", "text": "In this section, we investigate the class of images that triggered highest activation of node potentials for different latent nodes. Fig. 5 shows the top-12 images from test set that resulted in the highest activation of different latent nodes. It is observed that different latent nodes effectively capture different semantic information common to images containing neighboring object classes. For instance, the top-12 images of latent nodes h9 , h12, h4, h21, h3 and h5 resulted in a class of images appearing in scenes of forest, dining table, kitchen, living room, traffic and belonging to fruit category."}, {"heading": "5.4 Scene Classification on MIT-Indoor Dataset", "text": "The hidden nodes in CLTM model capture scene relevant information which can be used to perform scene classification tasks. In this section, we demonstrate scene classification capabilities of CLTM model. We use 529 images from MIT-Indoor data-set belonging to 4 different scenes: Kitchen, Bathroom, Living Room and Bedroom. We perform k-means on outputs of CLTM model and 3 layer neural network independent classifier to cluster images. We then optimally match these clusters to scenes to evaluate misclassification rate. Note that we never trained our model using scene labels and we just use them for validating the performance. In our experiments, we use marginal probabilities of observed and hidden nodes of CLTM , marginal probabilities of hidden nodes of CLTM and probabilities of individual classes resulted from 3 layer neural network conditioned on input features. Table 2 shows misclassification rates of different input features used for clustering. With out the need of object presence knowledge, clustering on marginal probabilities of hidden nodes alone resulted in the least misclassification rate."}, {"heading": "6 Conclusion and Future Work", "text": "In conclusion, with the proposed structure recovery method we could recover the structure of latent tree. This tree has natural hierarchy of related objects placed according to their co-appearance in different scenes. We use neural networks of different architectures to train conditional latent tree models. We evaluate CLTM on MS COCO data-set and there is a significant gain in precision, recall and F-measure compared to 3 layer neural network independent classifier. Latent nodes captured different semantic information to distinguish high level class information of images. Such an information is used for scene labeling task in an unsupervised manner. In future, we aim to model both spatial and co-occurance knowledge and apply the model to object localisation tasks using CNN (like RCNN)."}], "references": [{"title": "Network flows. In Optimization, pages 211\u2013369", "author": ["R. Ahuja", "T. Magnanti", "J. Orlin"], "venue": null, "citeRegEx": "1", "shortCiteRegEx": "1", "year": 1989}, {"title": "Conditional random field autoencoders for unsupervised structured prediction", "author": ["W. Ammar", "C. Dyer", "N.A. Smith"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2014}, {"title": "Learning deep structured models", "author": ["L.-C. Chen", "A.G. Schwing", "A.L. Yuille", "R. Urtasun"], "venue": "arXiv preprint arXiv:1407.2538,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2014}, {"title": "Learning latent tree graphical models", "author": ["M.J. Choi", "V.Y.F. Tan", "A. Anandkumar", "A.S. Willsky"], "venue": "J. Mach. Learn. Res.,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2011}, {"title": "Context models and out-of-context objects", "author": ["M.J. Choi", "A. Torralba", "A.S. Willsky"], "venue": "Pattern Recognition Letters,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2012}, {"title": "A tree-based context model for object recognition", "author": ["M.J. Choi", "A. Torralba", "A.S. Willsky"], "venue": "IEEE Trans. Pattern Anal. Mach. Intell.,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2012}, {"title": "On the nystr&#246;m method for approximating a gram matrix for improved kernel-based learning", "author": ["P. Drineas", "M.W. Mahoney"], "venue": "J. Mach. Learn. Res.,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2005}, {"title": "The pascal visual object classes (voc) challenge", "author": ["M. Everingham", "L. Gool", "C.K. Williams", "J. Winn", "A. Zisserman"], "venue": "Int. J. Comput. Vision,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2010}, {"title": "Rich feature hierarchies for accurate object detection and semantic segmentation", "author": ["R. Girshick", "J. Donahue", "T. Darrell", "J. Malik"], "venue": "In Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2014}, {"title": "Learning a tree of metrics with disjoint visual features", "author": ["K. Grauman", "F. Sha", "S.J. Hwang"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2011}, {"title": "Integrated structure and parameters learning in latent tree graphical models", "author": ["F. Huang", "N.U. N", "A. Anandkumar"], "venue": "ArXiv 1406.4566,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2014}, {"title": "Caffe: Convolutional architecture for fast feature embedding", "author": ["Y. Jia", "E. Shelhamer", "J. Donahue", "S. Karayev", "J. Long", "R. Girshick", "S. Guadarrama", "T. Darrell"], "venue": "arXiv preprint arXiv:1408.5093,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2014}, {"title": "Object bank: A high-level image representation for scene classification &amp; semantic feature sparsification", "author": ["L. jia Li", "H. Su", "L. Fei-fei", "E.P. Xing"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2010}, {"title": "Deep visual-semantic alignments for generating image descriptions", "author": ["A. Karpathy", "L. Fei-Fei"], "venue": "arXiv preprint arXiv:1412.2306,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2014}, {"title": "Imagenet classification with deep convolutional neural networks", "author": ["A. Krizhevsky", "I. Sutskever", "G.E. Hinton"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2012}, {"title": "Loss functions for discriminative training of energy-based models", "author": ["Y. Lecun", "F. Jie", "Jhuangfu"], "venue": "Proc. of the 10-th International Workshop on Artificial Intelligence and Statistics (AIStats05,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2005}, {"title": "\u03b8-mrf: Capturing spatial and semantic structure in the parameters for scene understanding", "author": ["C. Li", "A. Saxena", "T. Chen"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2011}, {"title": "Towards total scene understanding: Classification, annotation and segmentation in an automatic framework", "author": ["L.-J. Li", "R. Socher", "L. Fei-Fei"], "venue": "In Computer Vision and Pattern Recognition,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2009}, {"title": "Building and using a semantivisual image hierarchy", "author": ["L.-J. Li", "C. Wang", "Y. Lim", "D.M. Blei", "L. Fei-Fei"], "venue": "In Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2010}, {"title": "Microsoft COCO: common objects in context", "author": ["T. Lin", "M. Maire", "S. Belongie", "J. Hays", "P. Perona", "D. Ramanan", "P. Doll\u00e1r", "C.L. Zitnick"], "venue": "CoRR, abs/1405.0312,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2014}, {"title": "Learning and transferring mid-level image representations using convolutional neural networks", "author": ["M. Oquab", "L. Bottou", "I. Laptev", "J. Sivic"], "venue": "In Computer Vision and Pattern Recognition (CVPR),", "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2014}, {"title": "ImageNet Large Scale Visual Recognition Challenge", "author": ["O. Russakovsky", "J. Deng", "H. Su", "J. Krause", "S. Satheesh", "S. Ma", "Z. Huang", "A. Karpathy", "A. Khosla", "M. Bernstein", "A.C. Berg", "L. Fei-Fei"], "venue": "International Journal of Computer Vision (IJCV),", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2015}, {"title": "Kernel embeddings of conditional distributions: A unified kernel framework for nonparametric inference in graphical models", "author": ["L. Song", "K. Fukumizu", "A. Gretton"], "venue": "IEEE Signal Process. Mag.,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2013}, {"title": "Joint training of a convolutional network and a graphical model for human pose estimation", "author": ["J.J. Tompson", "A. Jain", "Y. LeCun", "C. Bregler"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "24", "shortCiteRegEx": "24", "year": 2014}, {"title": "Show and tell: A neural image caption generator", "author": ["O. Vinyals", "A. Toshev", "S. Bengio", "D. Erhan"], "venue": "arXiv preprint arXiv:1411.4555,", "citeRegEx": "25", "shortCiteRegEx": "25", "year": 2014}, {"title": "How transferable are features in deep neural networks", "author": ["J. Yosinski", "J. Clune", "Y. Bengio", "H. Lipson"], "venue": "CoRR, abs/1411.1792,", "citeRegEx": "26", "shortCiteRegEx": "26", "year": 2014}, {"title": "Improving object detection with deep convolutional networks via bayesian optimization and structured prediction", "author": ["Y. Zhang", "K. Sohn", "R. Villegas", "G. Pan", "H. Lee"], "venue": "arXiv preprint arXiv:1504.03293,", "citeRegEx": "27", "shortCiteRegEx": "27", "year": 2015}, {"title": "Object detectors emerge in deep scene cnns", "author": ["B. Zhou", "A. Khosla", "A. Lapedriza", "A. Oliva", "A. Torralba"], "venue": "arXiv preprint arXiv:1412.6856,", "citeRegEx": "28", "shortCiteRegEx": "28", "year": 2014}, {"title": "Learning deep features for scene recognition using places database", "author": ["B. Zhou", "A. Lapedriza", "J. Xiao", "A. Torralba", "A. Oliva"], "venue": "In Advances in Neural Information Processing Systems, pages 487\u2013495,", "citeRegEx": "29", "shortCiteRegEx": "29", "year": 2014}], "referenceMentions": [{"referenceID": 21, "context": "ILSVRC [22]), or binary classification, which makes binary decisions for each label independently (e.", "startOffset": 7, "endOffset": 11}, {"referenceID": 7, "context": "PASCAL VOC [8]).", "startOffset": 11, "endOffset": 14}, {"referenceID": 25, "context": "It is known that deep learning produces transferable features, which can be used to learn new tasks, which differ from tasks on which the neural networks were trained [26, 21].", "startOffset": 167, "endOffset": 175}, {"referenceID": 20, "context": "It is known that deep learning produces transferable features, which can be used to learn new tasks, which differ from tasks on which the neural networks were trained [26, 21].", "startOffset": 167, "endOffset": 175}, {"referenceID": 14, "context": "We extract features using pre-trained ImageNet CNN [15] from Caffe [12], and use it as input to the conditional latent tree model (CLTM), a type of conditional random field (CRF).", "startOffset": 51, "endOffset": 55}, {"referenceID": 11, "context": "We extract features using pre-trained ImageNet CNN [15] from Caffe [12], and use it as input to the conditional latent tree model (CLTM), a type of conditional random field (CRF).", "startOffset": 67, "endOffset": 71}, {"referenceID": 3, "context": "The tree dependency structure for this model is recovered using distance based methods [4], which requires pairwise conditional probabilities of object co-occurrences, conditioned on the input features.", "startOffset": 87, "endOffset": 90}, {"referenceID": 22, "context": "We employ the kernel conditional embedding framework [23] to compute these pairwise measures.", "startOffset": 53, "endOffset": 57}, {"referenceID": 19, "context": "We test performance of multi-object classification on a non-iconic image set Microsoft COCO [20] and we test its unsupervised scene learning capabilities on the MIT Indoor dataset [13].", "startOffset": 92, "endOffset": 96}, {"referenceID": 12, "context": "We test performance of multi-object classification on a non-iconic image set Microsoft COCO [20] and we test its unsupervised scene learning capabilities on the MIT Indoor dataset [13].", "startOffset": 180, "endOffset": 184}, {"referenceID": 0, "context": "For validation, we match these clusters to ground truth scene categories using maximum weight matching [1].", "startOffset": 103, "endOffset": 106}, {"referenceID": 6, "context": "While general non-parametric methods are computationally expensive, and not scalable to large datasets, we employ kernel methods only to estimate pairwise conditional probabilities, which can be carried out efficiently using randomized matrix techniques [7].", "startOffset": 254, "endOffset": 257}, {"referenceID": 10, "context": "Our tree structure estimation is scalable to large datasets using recent advances in parallel techniques for structure estimation [11].", "startOffset": 130, "endOffset": 134}, {"referenceID": 5, "context": "[6, 5] learn contextual relations between co-occurring objects using a tree structure graphical model to capture dependencies among different objects.", "startOffset": 0, "endOffset": 6}, {"referenceID": 4, "context": "[6, 5] learn contextual relations between co-occurring objects using a tree structure graphical model to capture dependencies among different objects.", "startOffset": 0, "endOffset": 6}, {"referenceID": 9, "context": "In many settings, the hierarchical structure representing the contextual relations between different objects is fixed and is based on semantic similarity [10], or may rely on text, in addition to image information [19].", "startOffset": 154, "endOffset": 158}, {"referenceID": 18, "context": "In many settings, the hierarchical structure representing the contextual relations between different objects is fixed and is based on semantic similarity [10], or may rely on text, in addition to image information [19].", "startOffset": 214, "endOffset": 218}, {"referenceID": 25, "context": "[26, 9, 21].", "startOffset": 0, "endOffset": 11}, {"referenceID": 8, "context": "[26, 9, 21].", "startOffset": 0, "endOffset": 11}, {"referenceID": 20, "context": "[26, 9, 21].", "startOffset": 0, "endOffset": 11}, {"referenceID": 8, "context": "[9] term this as supervised pre-training and employ them to train regional convolutional neural networks (R-CNN) for object localization.", "startOffset": 0, "endOffset": 3}, {"referenceID": 8, "context": "While [9] employ independent SVM classifiers for each class, we believe that incorporating our probabilistic framework for multi-object localization can significantly improve performance.", "startOffset": 6, "endOffset": 9}, {"referenceID": 26, "context": "Recently, [27] propose improving object detection using Bayesian optimization for fine grained search and a structured loss function that aims at both classification and localization.", "startOffset": 10, "endOffset": 14}, {"referenceID": 28, "context": "[29, 28] introduce the places dataset and use CNNs for scene classification.", "startOffset": 0, "endOffset": 8}, {"referenceID": 27, "context": "[29, 28] introduce the places dataset and use CNNs for scene classification.", "startOffset": 0, "endOffset": 8}, {"referenceID": 17, "context": "[18] propose a hierarchical generative model that performs multiple tasks in a coherent manner.", "startOffset": 0, "endOffset": 4}, {"referenceID": 16, "context": "[17] also consider the use of context by taking into account the spatial location of the regions of interest.", "startOffset": 0, "endOffset": 4}, {"referenceID": 16, "context": "While there is a large body of such works which use contextual information (see for instance [17]), they mostly do not incorporate latent variables in their modeling.", "startOffset": 93, "endOffset": 97}, {"referenceID": 1, "context": "For example, [2] propose to combine CRF and auto-encoder frameworks for unsupervised learning.", "startOffset": 13, "endOffset": 16}, {"referenceID": 23, "context": "Markov random fields are employed for pose estimation to encode the spatial relationships between joint locations in [24].", "startOffset": 117, "endOffset": 121}, {"referenceID": 2, "context": "[3] propose a joint framework for deep learning and probabilistic models.", "startOffset": 0, "endOffset": 3}, {"referenceID": 13, "context": "Finally, while many works have used MS-COCO for captioning and joint image-text related tasks [14, 25], there have been no attempts to improve multi-object classification over standard deep learning techniques, using images alone on MS-COCO and not the text data, to the best of our knowledge.", "startOffset": 94, "endOffset": 102}, {"referenceID": 24, "context": "Finally, while many works have used MS-COCO for captioning and joint image-text related tasks [14, 25], there have been no attempts to improve multi-object classification over standard deep learning techniques, using images alone on MS-COCO and not the text data, to the best of our knowledge.", "startOffset": 94, "endOffset": 102}, {"referenceID": 14, "context": "We consider pre-trained ImageNet [15] as a fixed feature extractor by considering the fc7 layer (4096-D vector) as the feature vector for a given input image.", "startOffset": 33, "endOffset": 37}, {"referenceID": 25, "context": "It is also demonstrated in [26] that such feature vectors can be effectively used for different tasks with different labels.", "startOffset": 27, "endOffset": 31}, {"referenceID": 3, "context": "3: Extract tree structure using [4] T \u2190 CLRG(D) 4: Training a NN with randomly initialized weights W: 5: repeat 6: randomly select a mini-batch M .", "startOffset": 32, "endOffset": 35}, {"referenceID": 6, "context": "So, we restrict using kernel methods to only evaluate pairwise conditional probabilities, and here, we can use randomized matrix methods to efficiently scale the computations [7].", "startOffset": 175, "endOffset": 178}, {"referenceID": 3, "context": "is estimated through CL grouping algorithm from [4].", "startOffset": 48, "endOffset": 51}, {"referenceID": 3, "context": "Although the method in [4] is serial, we note that recently there have been parallel versions of this method in [11].", "startOffset": 23, "endOffset": 26}, {"referenceID": 10, "context": "Although the method in [4] is serial, we note that recently there have been parallel versions of this method in [11].", "startOffset": 112, "endOffset": 116}, {"referenceID": 3, "context": "The estimated distance matrix is then used by distance-based methods for structure recovery [4].", "startOffset": 92, "endOffset": 95}, {"referenceID": 22, "context": "Kernel Embedding of Conditional Distribution The kernel conditional embedding framework, described in [23] gives us methods for modeling conditional and joint distributions.", "startOffset": 102, "endOffset": 106}, {"referenceID": 3, "context": "Among the available approaches for latent tree learning, we use the information distance based algorithm CLGrouping [4] which has provable computational efficiency guarantees.", "startOffset": 116, "endOffset": 119}, {"referenceID": 15, "context": "Energy-based learning provides a unified framework for many probabilistic and non-probabilistic approaches to structured output tasks [16], particularly for non-probabilistic training of graphical models and other structured models.", "startOffset": 134, "endOffset": 138}, {"referenceID": 15, "context": "For a given neural network architecture, weights are learned by backpropagating the gradient through some loss function [16].", "startOffset": 120, "endOffset": 124}, {"referenceID": 19, "context": "We use the non-iconic image data-set MS COCO [20] to evaluate our model.", "startOffset": 45, "endOffset": 49}], "year": 2015, "abstractText": "Deep learning has shown state-of-art classification performance on datasets such as ImageNet, which contain a single object in each image. However, multi-object classification is far more challenging. We present a unified framework which leverages the strengths of multiple machine learning methods, viz deep learning, probabilistic models and kernel methods to obtain state-of-art performance on Microsoft COCO, consisting of non-iconic images. We incorporate contextual information in natural images through a conditional latent tree probabilistic model (CLTM), where the object co-occurrences are conditioned on the extracted fc7 features from pre-trained Imagenet CNN as input. We learn the CLTM tree structure using conditional pairwise probabilities for object co-occurrences, estimated through kernel methods, and we learn its node and edge potentials by training a new 3-layer neural network, which takes fc7 features as input. Object classification is carried out via inference on the learnt conditional tree model, and we obtain significant gain in precision-recall and F-measures on MS-COCO, especially for difficult object categories. Moreover, the latent variables in the CLTM capture scene information: the images with top activations for a latent node have common themes such as being a grasslands or a food scene, and on on. In addition, we show that a simple k-means clustering of the inferred latent nodes alone significantly improves scene classification performance on the MIT-Indoor dataset, without the need for any retraining, and without using scene labels during training. Thus, we present a unified framework for multi-object classification and unsupervised scene understanding.", "creator": "LaTeX with hyperref package"}}}