{"id": "1509.08731", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "29-Sep-2015", "title": "Variational Information Maximisation for Intrinsically Motivated Reinforcement Learning", "abstract": "The mutual information is a core statistical quantity that has applications in all areas of machine learning, whether this is in training of density models over multiple data modalities, in maximising the efficiency of noisy transmission channels, or when learning behaviour policies for exploration by artificial agents. Most learning algorithms that involve optimisation of the mutual information rely on the Blahut-Arimoto algorithm --- an enumerative algorithm with exponential complexity that is not suitable for modern machine learning applications. This paper provides a new approach for scalable optimisation of the mutual information by merging techniques from variational inference and deep learning algorithms to provide a set of models to work. The paper also identifies a variety of approaches that could be applied to models. The paper explores the importance of a well-known, widely available, and useful approach to optimization in the field of machine learning.\n\n\n\nThe author recommends that readers read this article first before attempting to use this article, especially with the view that this is not suitable for machine learning in real life. If you use this article, then please feel free to contact me or make a comment here.\nPlease note that the content of this paper may not be used, in part, for personal or professional use.", "histories": [["v1", "Tue, 29 Sep 2015 13:04:03 GMT  (5560kb,D)", "http://arxiv.org/abs/1509.08731v1", "Proceedings of the 29th Conference on Neural Information Processing Systems (NIPS 2015)"]], "COMMENTS": "Proceedings of the 29th Conference on Neural Information Processing Systems (NIPS 2015)", "reviews": [], "SUBJECTS": "stat.ML cs.AI cs.LG", "authors": ["shakir mohamed", "danilo jimenez rezende"], "accepted": true, "id": "1509.08731"}, "pdf": {"name": "1509.08731.pdf", "metadata": {"source": "CRF", "title": "Variational Information Maximisation for Intrinsically Motivated Reinforcement Learning", "authors": ["Shakir Mohamed", "Danilo J. Rezende"], "emails": ["danilor}@google.com"], "sections": [{"heading": "1 Introduction", "text": "The problem of measuring and harnessing dependence between random variables is an inescapable statistical problem that forms the basis of a large number of applications in machine learning, including rate distortion theory [4], information bottleneck methods [26], population coding [1], curiositydriven exploration [24, 19], model selection [3], and intrinsically-motivated reinforcement learning [20]. In all these problems the core quantity that must be reasoned about is the mutual information. In general, the mutual information (MI) is intractable to compute and few existing algorithms are useful for realistic applications. The received algorithm for estimating mutual information is the Blahut-Arimoto algorithm [29] that effectively solves for the MI by enumeration \u2014 an approach with exponential complexity that is not suitable for modern machine learning applications. By combining the best current practice from variational inference with that of deep learning, we bring the generality and scalability seen in other problem domains to information maximisation problems. We provide a new approach for maximisation of the mutual information that has significantly lower complexity, allows for computation with high-dimensional sensory inputs, and that allows us to exploit modern computational resources.\nThe technique we derive is generally applicable, but we shall describe and develop our approach by focussing on one popular and increasingly topical application of the mutual information: as a measure of \u2018empowerment\u2019 in intrinsically-motivated reinforcement learning. Reinforcement learning (RL) has seen a number of successes in recent years that has now established it as a practical, scalable solution for realistic agent-based planning and decision making [15, 12]. A limitation of the standard RL approach is that an agent is only able to learn using external rewards obtained from its environment; truly autonomous agents will often exist in environments that lack such external rewards or in environments where rewards are sparsely distributed. Intrinsically-motivated reinforcement learning [23] attempts to address this shortcoming by equipping an agent with a number of internal drives or intrinsic reward signals, such as hunger, boredom or curiosity that allows the agent to continue to explore, learn and act meaningfully in a reward-sparse world. There are many\nar X\niv :1\n50 9.\n08 73\n1v 1\n[ st\nat .M\nL ]\n2 9\nSe p\n20 15\nways in which to formally define internal drives, but what all such definitions have in common is that they, in some unsupervised fashion, allow an agent to reason about the value of information in the action-observation sequences it experiences. The mutual information allows for exactly this type of reasoning and forms the basis of one popular intrinsic reward measure, known as empowerment.\nOur paper begins by describing the framework we use for online and self-motivated learning (section 2) and then describes the general problem associated with mutual information estimation and empowerment (section 3). We then make the following contributions: \u2022 We develop stochastic variational information maximisation, a new algorithm for scalable es-\ntimation of the mutual information and channel capacity that is applicable to both discrete and continuous settings. \u2022 We combine variational information optimisation and tools from deep learning to develop a scalable algorithm for intrinsically-motivated reinforcement learning, demonstrating a new application of the variational theory for problems in reinforcement learning and decision making. \u2022 We demonstrate that empowerment-based behaviours obtained using variational information maximisation match those using the exact computation. We then apply our algorithms to a broad range of high-dimensional problems for which it is not possible to compute the exact solution, but for which we are able to act according to empowerment \u2013 learning directly from pixel information."}, {"heading": "2 Intrinsically-motivated Reinforcement Learning", "text": "Intrinsically- or self-motivated learning attempts to address the question of where rewards come from and how they are used by an autonomous agent. Consider an online learning system that must model and reason about its incoming data streams and interact with its environment. This perception-action loop is common to many areas such as active learning, process control, black-box optimisation, and reinforcement learning. An extended view of this framework was presented by Singh et al. [23], who describe the environment as factored into external and internal components (figure 1). An agent receives observations and takes actions in the external environment. Importantly, the source and nature of any reward signals are not assumed to be provided by an oracle in the external environment, but is moved to an internal environment that is part of the agent\u2019s decisionmaking system; the internal environment handles the efficient processing of all input data and the choice and computation of an appropriate internal reward signal.\nThere are two important components of this framework: the state representation and the critic. We are principally interested in vision-based self-motivated systems, for which there are no solutions currently developed. To achieve this, our state representation system is a convolutional neural network [13]. The critic in figure 1 is responsible for providing intrinsic rewards that allow the agent to act under different types of internal motivations, and is where information maximisation enters the intrinsically-motivated learning problem.\nThe nature of the critic and in particular, the reward signal it provides is the main focus of this paper. A wide variety of reward functions have been proposed, and include: missing information or Bayesian surprise, which uses the KL divergence to measure the change in an agents internal belief after the observation of new data [8, 22]; measures based on prediction errors of future states such predicted L1 change, predicted mode change or probability gain [16], or salient event prediction [23]; and measures based on information-theoretic quantities such as predicted information gain (PIG) [14], causal entropic forces [28] or empowerment [21]. The paper by Oudeyer & Kaplan [18]\ncurrently provides the widest singular discussion of the breadth of intrinsic motivation measures. Although we have a wide choice of intrinsic reward measures, none of the available informationtheoretic approaches are efficient to compute or scalable to high-dimensional problems: they require either knowledge of the true transition probability or summation over all configurations of the state space, which is not tractable for complex environments or when the states are large images."}, {"heading": "3 Mutual Information and Empowerment", "text": "The mutual information is a core information-theoretic quantity that acts as a general measure of dependence between two random variables x and y, defined as:\nI(x,y) = Ep(y|x)p(x) [ log ( p(x,y)\np(x)p(y)\n)] , (1)\nwhere the p(x,y) is a joint distribution over the random variables, and p(x) and p(y) are the corresponding marginal distributions. x and y can be many quantities of interest: in computational neuroscience they are the sensory inputs and the spiking population code; in telecommunications they are the input signal to a channel and the received transmission; when learning exploration policies in RL, they are the current state and the action at some time in the future, respectively.\nFor intrinsic motivation, we use an internal reward measure referred to as empowerment [11, 21] that is obtained by searching for the maximal mutual information I(\u00b7, \u00b7), conditioned on a starting state s, between a sequence of K actions a and the final state reached s\u2032:\nE(s) = max \u03c9 I\u03c9(a, s\u2032|s) = max \u03c9 Ep(s\u2032|a,s)\u03c9(a|s)\n[ log ( p(a, s\u2032|s)\n\u03c9(a|s)p(s\u2032|s)\n)] , (2)\nwhere a = {a1, . . . , aK} is a sequence of K primitive actions ak leading to a final state s\u2032, and p(s\u2032|a, s) is the K-step transition probability of the environment. p(a, s\u2032|s) is the joint distribution of action sequences and the final state, \u03c9(a|s) is a distribution over K-step action sequences, and p(s\u2032|s) is the joint probability marginalised over the action sequence. Equation (2) is the definition of the channel capacity in information theory and is a measure of the amount of information contained in the action sequences a about the future state s\u2032. This measure is compelling since it provides a well-grounded, task-independent measure for intrinsic motivation that fits naturally within the framework for intrinsically motivated learning described by figure 1. Furthermore, empowerment, like the state- or action-value function in reinforcement learning, assigns a value E(s) to each state s in an environment. An agent that seeks to maximise this value will move towards states from which it can reach the largest number of future states within its planning horizon K. It is this intuition that has led authors to describe empowerment as a measure of agent \u2018preparedness\u2019, or as a means by which an agent may quantify the extent to which it can reliably influence its environment \u2014 motivating an agent to move to states of maximum influence [21].\nAn empowerment-based agent generates an open-loop sequence of actions K steps into the future \u2014 this is only used by the agent for its internal planning using \u03c9(a|s). When optimised using (2), the distribution \u03c9(a|s) becomes an efficient exploration policy that allows for uniform exploration of the state space reachable at horizon K, and is another compelling aspect of empowerment (we provide more intuition for this in appendix A). But this policy is not what is used by the agent for acting: when an agent must act in the world, it follows a closed-loop policy obtained by a planning algorithm using the empowerment value (e.g., Q-learning); we expand on this in sect. 4.3. A further consequence is that while acting, the agent is only \u2018curious\u2019 about parts of its environment that can be reached within its internal planning horizon K. We shall not explore the effect of the horizon in this work, but this has been widely-explored and we defer to the insights of Salge et al. [21]."}, {"heading": "4 Scalable Information Maximisation", "text": "The mutual information (MI) as we have described it thus far, whether it be for problems in empowerment, channel capacity or rate distortion, hides two difficult statistical problems. Firstly, computing the MI involves expectations over the unknown state transition probability. This can be seen by rewriting the MI in terms of the difference between conditional entropies H(\u00b7) as:\nI(a, s\u2032|s) = H(a|s)\u2212H(a|s\u2032, s), (3) where H(a|s) =\u2212E\u03c9(a|s)[log\u03c9(a|s)] and H(a|s\u2032, s) =\u2212Ep(s\u2032|a,s)\u03c9(a|s) [log p(a|s\u2032, s)]. This computation requires marginalisation over the K-step transition dynamics of the environment p(s\u2032|a, s),\nwhich is unknown in general. We could estimate this distribution by building a generative model of the environment, and then use this model to compute the MI. Since learning accurate generative models remains a challenging task, a solution that avoids this is preferred (and we also describe one approach for model-based empowerment in appendix B).\nSecondly, we currently lack an efficient algorithm for MI computation. There exists no scalable algorithm for computing the mutual information that allows us to apply empowerment to highdimensional problems and that allow us to easily exploit modern computing systems. The current solution is to use the Blahut-Arimoto algorithm [29], which essentially enumerates over all states, thus being limited to small-scale problems and not being applicable to the continuous domain. More scalable non-parametric estimators have been developed [7, 6]: these have a high memory footprint or require a very large number of observations, any approximation may not be a bound on the MI making reasoning about correctness harder, and they cannot easily be composed with existing (gradient-based) systems that allow us to design a unified (end-to-end) system. In the continuous domain, Monte Carlo integration has been proposed [10], but applications of Monte Carlo estimators can require a large number of draws to obtain accurate solutions and manageable variance. We have also explored Monte Carlo estimators for empowerment and describe an alternative importance sampling-based estimator for the MI and channel capacity in appendix B.1."}, {"heading": "4.1 Variational Information Lower Bound", "text": "The MI can be made more tractable by deriving a lower bound to it and maximising this instead \u2014 here we present the bound derived by Barber & Agakov [1]. Using the entropy formulation of the MI (3) reveals that bounding the conditional entropy component is sufficient to bound the entire mutual information. By using the non-negativity property of the KL divergence, we obtain the bound:\nKL[p(x|y)\u2016q(x|y)] \u2265 0\u21d2 H(x|y) \u2264 \u2212Ep(x|y) [log q\u03be(x|y)] I\u03c9(s) = H(a|s)\u2212H(a|s\u2032, s) \u2265 H(a) +Ep(s\u2032|a,s)\u03c9\u03b8(a|s)[log q\u03be(a|s\u2032, s)] = I\u03c9,q(s) (4)\nwhere we have introduced a variational distribution q\u03be(\u00b7) with parameters \u03be; the distribution \u03c9\u03b8(\u00b7) has parameters \u03b8. This bound becomes exact when q\u03be(a|s\u2032, s) is equal to the true action posterior distribution p(a|s\u2032, s). Other lower bounds for the mutual information are also possible: Jaakkola & Jordan [9] present a lower bound by using the convexity bound for the logarithm; Brunel & Nadal [2] use a Gaussian assumption and appeal to the Cramer-Rao lower bound.\nThe bound (4) is highly convenient (especially when compared to other bounds) since the transition probability p(s\u2032|a, s) appears linearly in the expectation and we never need to evaluate its probability \u2014 we can thus evaluate the expectation directly by Monte Carlo using data obtained by interaction with the environment. The bound is also intuitive since we operate using the marginal distribution on action sequences \u03c9\u03b8(a|s), which acts as a source (exploration distribution), the transition distribution p(s\u2032|a, s) acts as an encoder (transition distribution) from a to s\u2032, and the variational distribution q\u03be(a|s\u2032, s) conveniently acts as a decoder (planning distribution) taking us from s\u2032 to a."}, {"heading": "4.2 Variational Information Maximisation", "text": "A straightforward optimisation procedure based on (4) is an alternating optimisation for the parameters of the distributions q\u03be(\u00b7) and \u03c9\u03b8(\u00b7). Barber & Agakov [1] made the connection between this approach and the generalised EM algorithm and refer to it as the IM (information maximisation) algorithm and we follow the same optimisation principle. From an optimisation perspective, the maximisation of the bound I\u03c9,q(s) in (4) w.r.t. \u03c9(a|s) can be ill-posed (e.g., in Gaussian models, the variances can diverge). We avoid such divergent solutions by adding a constraint on the value of the entropy H(a), which results in the constrained optimisation problem:\nE\u0302(s) = max \u03c9,q I\u03c9,q(s) s.t. H(a|s)< , E\u0302(s) =max \u03c9,q Ep(s\u2032|a,s)\u03c9(a|s)[\u2212 1\u03b2 ln\u03c9(a|s)+ln q\u03be(a|s\u2032, s)] (5)\nwhere a is the action sequence performed by the agent when moving from s to s\u2032 and \u03b2 is an inverse temperature (which is a function of the constraint ).\nAt all times we use very general source and decoder distributions formed by complex non-linear functions using deep networks, and use stochastic gradient ascent for optimisation. We refer to our approach as stochastic variational information maximisation to highlight that we do all our computation on a mini-batch of recent experience from the agent. The optimisation for the decoder q\u03be(\u00b7) becomes a maximum likelihood problem, and the optimisation for the source \u03c9\u03b8(\u00b7) requires computation of an unnormalised energy-based model, which we describe next. We summmarise the overall procedure in algorithm 1."}, {"heading": "4.2.1 Maximum Likelihood Decoder", "text": "The first step of the alternating optimisation is the optimisation of equation (5) w.r.t. the decoder q, and is a supervised maximum likelihood problem. Given a set of data from past interactions with the environment, we learn a distribution from the start and termination states s, s\u2032, respectively, to the action sequences a that have been taken. We parameterise the decoder as an auto-regressive distribution over the K-step action sequence:\nq\u03be(a|s\u2032, s) = q(a1|s, s\u2032) K\u220f k=2 q(ak|f\u03be(ak\u22121, s, s\u2032)), (6)\nWe are free to choose the distributions q(ak) for each action in the sequence, which we choose as categorical distributions whose mean parameters are the result of the function f\u03be(\u00b7) with parameters \u03be. f is a non-linear function that we specify using a two-layer neural network with rectified-linear activation functions. By maximising this log-likelihood, we are able to make stochastic updates to the variational parameters \u03be of this distribution. The neural network models used are expanded upon in appendix D."}, {"heading": "4.2.2 Estimating the Source Distribution", "text": "Given a current estimate of the decoder q, the variational solution for the distribution \u03c9(a|s) computed by solving the functional derivative \u03b4I\u03c9(s)/\u03b4\u03c9(a|s) = 0 under the constraint that \u2211 a \u03c9(a|s) = 1, is given by \u03c9?(a|s) = 1Z(s) exp (u\u0302(s,a)) , where\nu(s,a) = Ep(s\u2032|s,a)[ln q\u03be(a|s, s\u2032)], u\u0302(s,a) = \u03b2u(s,a) and Z(s) = \u2211 a e\nu\u0302(s,a) is a normalisation term. By substituting this optimal distribution into the original objective (5) we find that it can be expressed in terms of the normalisation function Z(s) only, E(s) = 1\u03b2 logZ(s). The distribution \u03c9?(a|s) is implicitly defined as an unnormalised distribution \u2014 there are no direct mechanisms for sampling actions or computing the normalising function Z(s) for such distributions. We could use Gibbs or importance sampling, but these solutions are not satisfactory as they would require several evaluations of the unknown function u(s,a) per decision per state. We obtain a more convenient problem by approximating the unnormalised distribution \u03c9?(a|s) by a normalised (directed) distribution h\u03b8(a|s). This is equivalent to approximating the energy term u\u0302(s,a) by a function of the log-likelihood of the directed model, r\u03b8:\n\u03c9?(a|s) \u2248 h\u03b8(a|s)\u21d2 u\u0302(s,a) \u2248 r\u03b8(s,a); r\u03b8(s,a) = lnh\u03b8(a|s) + \u03c8\u03b8(s). (7) We introduced a scalar function \u03c8\u03b8(s) into the approximation, but since this is not dependent on the action sequence a it does not change the approximation (7), and can be verified by substituting (7) into \u03c9?(a|s). Since h\u03b8(a|s) is a normalised distribution, this leaves \u03c8\u03b8(s) to account for the normalisation term logZ(s), verified by substituting \u03c9?(a|s) and (7) into (5). We therefore obtain a cheap estimator of empowerment E(s) \u2248 1\u03b2\u03c8\u03b8(s). To optimise the parameters \u03b8 of the directed model h\u03b8 and the scalar function \u03c8\u03b8 we can minimise any measure of discrepancy between the two sides of the approximation (7). We minimise the squared error, giving the loss function L(h\u03b8,\u03c8\u03b8) for optimisation as:\nL(h\u03b8,\u03c8\u03b8)=Ep(s\u2032|s,A) [ (\u03b2 ln q\u03be(a|s,s\u2032)\u2212 r\u03b8(s,a))2 ] . (8)\nAt convergence of the optimisation, we obtain a compact function with which to compute the empowerment that only requires forward evaluation of the function \u03c8. h\u03b8(a|s) is parameterised using an auto-regressive distribution similar to (18), with conditional distributions specified by deep networks. The scalar function \u03c8\u03b8 is also parameterised using a deep network. Further details of these networks are provided in appendix D."}, {"heading": "4.3 Empowerment-based Behaviour policies", "text": "Using empowerment as an intrinsic reward measure, an agent will seek out states of maximal empowerment. We can treat the empowerment value E(s) as a state-dependent reward and can then utilise any standard planning algorithm, e.g., Q-learning, policy gradients or Monte Carlo search. We use the simplest planning strategy by using a one-step greedy empowerment maximisation. This amounts to choosing actions a = arg maxa C(s, a), where C(s, a) = Ep(s\u2032|s,a) [E(s)]. This policy does not account for the effect of actions beyond the planning horizon K. A natural enhancement is to use value iteration [25] to allow the agent to take actions by maximising its long term (potentially\nTr ue\nM I\nTr ue\nM I\nB ou\nnd M\nI\ny = \u22120.083 + 1 \u22c5 x, r2 = 0.903\n\u25cf \u25cf\n\u25cf \u25cf \u25cf\n\u25cf\n\u25cf\n\u25cf \u25cf \u25cf\n\u25cf \u25cf \u25cf\n\u25cf \u25cf\n\u25cf\n\u25cf\u25cf\n\u25cf\n\u25cf \u25cf \u25cf\n\u25cf\n\u25cf \u25cf\n\u25cf\n\u25cf\u25cf \u25cf\n1.5\n2.0\n2.5\n3.0\n1.5 2.0 2.5 3.0 True Empowerment (nats)\nAp pr\nox im\nat e\nEm po\nw er\nm en\nt ( na\nts )\nB ou\nnd M\nI\nAp pr\nox im\nat e\nEm po\nw er\nm en\nt ( na\nts )\nTrue Empowerment (nats)\ndiscounted) empowerment. A third approach would be to use empowerment as a potential function and the difference between the current and previous state\u2019s empowerment as a shaping function with in the planning [17]. A fourth approach is one where the agent uses the source distribution \u03c9(a|s) as its behaviour policy. The source distribution has similar properties to the greedy behaviour policy and can also be used, but since it effectively acts as an empowered agents internal exploration mechanism, it has a large variance (it is designed to allow uniform exploration of the state space). Understanding this choice of behaviour policy is an important line of ongoing research."}, {"heading": "4.4 Algorithm Summary and Complexity", "text": "The system we have described is a scalable and general purpose algorithm for mutual information maximisation and we summarise the core components using the computational graph in figure 2 and in algorithm 1. The state representation mechanism used throughout is obtained by transforming raw observations x,x\u2032 to produce the start and final states s, s\u2032, respectively. When the raw observations are pixels from vision, the state representation is a convolutional neural network [13, 15], while for other observations (such as continuous measurements) we use a fully-connected neural network \u2013 we indicate the parameters of these models using \u03bb. Since we use a unified loss function, we can apply gradient descent and backpropagate stochastic gradients through the entire model allowing for joint optimisation of both the information and representation parameters. For optimisation we use a preconditioned optimisation algorithm such as Adagrad [5].\nThe computational complexity of empowerment estimators involves the planning horizon K, the number of actionsN , and the number of states S. For the exact computation we must enumerate over the number of states, which for grid-worlds is S \u221d D2 (forD\u00d7D grids), or for binary images is S = 2D 2\n. The complexity of using the Blahut-Arimoto (BA) algorithm is O(NKS2) = O(NKD4) for grid worlds orO(NK22D 2\n) for binary images. The BA algorithm, even in environments with a small number of interacting objects becomes quickly intractable, since the state space grows exponentially with the number of possible interactions, and is also exponential in the planning horizon. In contrast, our approach deals directly on the image dimensions. Using visual inputs, the convolutional network produces a vector of size P , upon which all subsequent computation is based, consisting of an Llayer neural network. This gives a complexity for state representation of O(D2P + LP 2). The autoregressive distributions have complexity ofO(H2KN), whereH is the size of the hidden layer. Thus, our approach has at most quadratic complexity in the size of the hidden layers used and linear in other quantities, and matches the complexity of any currently employed large-scale vision-based models. In addition, since we use gradient descent throughout, we are able to leverage the power of GPUs and distributed gradient computations."}, {"heading": "5 Results", "text": "We demonstrate the use of empowerment and the effectiveness of variational information maximisation in two types of environments. Static environments consists of rooms and mazes in different configurations in which there are no objects with which the agent can interact, or other moving ob-\njects. The number of states in these settings is equal to the number of locations in the environment, so is still manageable for approaches that rely on state enumeration. In dynamic environments, aspects of the environment change, such as flowing lava that causes the agent to reset, or a predator that chases the agent. For the most part, we consider discrete action settings in which the agent has five actions (up, down, left, right, do nothing). The agent may have other actions, such as picking up a key or laying down a brick. There are no external rewards available and the agent must reason purely using visual (pixel) information. For all these experiments we used a horizon of K = 5."}, {"heading": "5.1 Effectiveness of the MI Bound", "text": "We first establish that the use of the variational information lower bound results in the same behaviour as that obtained using the exact mutual information in a set of static environments. We consider environments that have at most 400 discrete states and compute the true mutual information using the Blahut-Arimoto algorithm. We compute the variational information bound on the same environment using pixel information (on 20\u00d7 20 images). To compare the two approaches we look at the empowerment landscape obtained by computing the empowerment at every location in the environment and show these as heatmaps. For action selection, what matters is the location of the maximum empowerment, and by comparing the heatmaps in figure 3, we see that the empowerment landscape matches between the exact and the variational solution, and hence, will lead to the same agent-behaviour.\nIn each image in figure 3, we show a heat-map of the empowerment for each location in the environment. We then analyze the point of highest empowerment: for the large room it is in the centre of the room; for the cross-shaped room it is at the centre of the cross, and in a two-rooms environment, it is located near both doors. In addition, we show that the empowerment values obtained by our method constitute a close approximation to the true empowerment for the two-rooms environment (correlation coeff = 1.00, R2=0.90). These results match those by authors such as Klyubin et al. [11] (using empowerment) and Wissner-Gross & Freer [28] (using a different information-theoretic measure \u2014 the causal entropic force). The advantage of the variational approach is clear from this discussion: we are able to obtain solutions of the same quality as the exact computation, we have far more favourable computational scaling (one that is not exponential in the size of the state space and planning horizon), and we are able to plan directly from pixel information."}, {"heading": "5.2 Dynamic Environments", "text": "Having established the usefulness of the bound and some further understanding of empowerment, we now examine the empowerment behaviour in environments with dynamic characteristics. Even in small environments, the number of states becomes extremely large if there are objects that can be moved, or added and removed from the environment, making enumerative algorithms (such as BA) quickly infeasible, since we have an exponential explosion in the number of states. We first reproduce an experiment from Salge et al. [21, \u00a74.5.3] that considers the empowered behaviour of an agent in a room-environment, a room that: is empty, has a fixed box, has a moveable box, has a row of moveable boxes. Salge et al. [21] explore this setup to discuss the choice of the state representation, and that not including the existence of the box severely limits the planning ability of the agent. In our approach, we do not face this problem of choosing the state representation, since the agent will reason about all objects that appear within its visual observations, obviating the need for hand-designed state representations. Figure 4 shows that in an empty room, the empowerment is uniform almost everywhere except close to the walls; in a room with a fixed box, the fixed box limits the set of future reachable states, and as expected, empowerment is low around the box; in a room where the box can be moved, the box can now be seen as a tool and we have high empowerment near the box; similarly, when we have four boxes in a row, the empowerment is highest around the\nboxes. These results match those of Salge et al. [21] and show the effectiveness of reasoning from pixel information directly.\nFigure 6 shows how planning with empowerment works in a dynamic maze environment, where lava flows from a source at the bottom that eventually engulfs the maze. The only way the agent is able to safeguard itself, is to stem the flow of lava by building a wall at the entrance to one of the corridors. At every point in time t, the agent decides its next action by computing the expected empowerment after taking one action. In this environment, we show the planning for all 9 available actions and a bar graph with the empowerment values for each resulting state. The action that leads to the highest empowerment is taken and is indicated by the black panels1.\nFigure 5(left) shows two-rooms separated by a door. The agent is able to collect a key that allows it to open the door. Before collecting the key, the maximum empowerment is in the region around the key, once the agent has collected the key, the region of maximum empowerment is close to the door2. Figure 5(right) shows an agent in a corridor and must protect itself by building a wall of bricks, which it is able to do successfully using the same empowerment planning approach described for the maze setting."}, {"heading": "5.3 Predator-Prey Scenario", "text": "We demonstrate the applicability of our approach to continuous settings, by studying a simple 3D physics simulation [27], shown in figure 7. Here, the agent (blue) is followed by a predator (red) and is randomly reset to a new location in the environment if caught by the predator. Both the agent and the predator are represented as spheres in the environment that roll on a surface with friction. The state is the position, velocity and angular momentum of the agent and the predator, and the action is a 2D force vector. As expected, the maximum empowerment lies in regions away from the predator, which results in the agent learning to escape the predator3."}, {"heading": "6 Conclusion", "text": "We have developed a new approach for scalable estimation of the mutual information by exploiting recent advances in deep learning and variational inference. We focussed specifically on intrinsic motivation with a reward measure known as empowerment, which requires at its core the efficient computation of the mutual information. By using a variational lower bound on the mutual information, we developed a scalable model and efficient algorithm that expands the applicability of empowerment to high-dimensional problems, with the complexity of our approach being extremely favourable when compared to the complexity of the Blahut-Arimoto algorithm that is currently the standard. The overall system does not require a generative model of the environment to be built, learns using only interactions with the environment, and allows the agent to learn directly from visual information or in continuous state-action spaces. While we chose to develop the algorithm in terms of intrinsic motivation, the mutual information has wide applications in other domains, all which stand to benefit from a scalable algorithm that allows them to exploit the abundance of data and be applied to large-scale problems.\nAcknowledgements: We thank Daniel Polani for invaluable guidance and feedback.\n1 Video: http://youtu.be/eA9jVDa7O38 2 Video: http://youtu.be/eSAIJ0isc3Y 3 Videos: http://youtu.be/tMiiKXPirAQ; http://youtu.be/LV5jYY-JFpE"}, {"heading": "A Empowerment as Path-counting", "text": "We can obtain a further intuitive understanding of empowerment by examining analytical properties of equation (2). For simplicity, we focus on deterministic and discrete environments. In this setting, the transition probability p(s\u2032|s,a) is a delta distribution p(s\u2032|s,a) = \u03b4(s\u2032\u2212T (s,a)), where T (s,a) is a transition function that starts in state s, executes the action sequence a and provides the resulting state. Solving equation (2) for the optimal source distribution \u03c9(a|s), using Blahut-Arimoto [4], yields the fixed-point iteration:\n\u03c9(k+1)(a|s) = 1 Z(s) \u03c9(k)(a|s)\u2211 A\u2032:T (s,A\u2032)=T (s,A)\u03c9 (k)(a\u2032|s) , (9)\nwhere Z(s) is a normalising constant. By starting the recursion (9) with a uniform distribution, \u03c9(1)(a|s) \u221d 1, the solution to the recursion at the next iteration \u03c9(2)(a|s) is: \u03c9(2)(a|s) \u221d 1n(a,s) , where n(a, s) is the number of alternative action-paths a\u2032 that terminate at the same state as the action-path a, starting from the state s. We can also relate the quantity n(a, s) with a more intuitive number, n(s\u2032, s), which is the number of different action-paths that brings the agent from state s to the state s\u2032, n(a, s) = \u2211 s\u2032 p(s\n\u2032|a, s)n(s\u2032, s). If \u03c9(k)(a|s) = \u03c9(k)(a\u2032|s), for all a\u2032 such that T (s,a\u2032) = T (s,a) then the r.h.s. of (9) does not depend on \u03c9(k)(a|s). Since the function n(a, s) satisfies this property, we conclude that \u03c9(2)(a|s) is a fixed point of (9). The optimal source distribution and resulting empowerment are:\n\u03c9(\u221e)(a|s) = 1Z(s) 1n(a,s) ; E(s) = logZ(s) = log \u2211 A 1 n(a,s) = log n(s), (10)\nwhere n(s) is the number of different states that can be reached from state s at horizon K. We demonstrate this reasoning using a tree-structured environment in figure 8.\nAn agent selecting its actions uniformly will in general not visit all terminal states uniformly, unless every action-path terminates at a different state. However, if an agent selects its actions according the the distribution \u03c9(\u221e)(a|s) it will visit terminal states uniformly. This can be seen by computing the marginal distribution of terminal states p(s\u2032|s) = \u2211A \u03b4(s\u2032 \u2212 T (s,a))\u03c9(\u221e)(a|s) = 1n(s) . Therefore the distribution \u03c9(\u221e)(a|s) can be seen as an efficient exploration policy, that allows the agent to explore all states uniformly. This adds to a similar analysis presented by Salge et al. [3, \u00a74.4.6]."}, {"heading": "B Model-based Empowerment", "text": "The approach we described in the main text was \u2019model-free\u2019 in the sense that it did not use a model of the transition dynamics of the environment. Building accurate transition models can be hard and much success in RL has been achieved with model-free methods. Ideally, we would like to use a model-based method, since this will allow for reasoning about task-independent aspects of the world, allow for transfer learning across domains and potentially faster learning. We describe here model-based approaches that we developed for empowerment. These methods were not as efficient for reasons which we describe below, and hence were not part of our main text.\nB.1 Importance Sampling Estimator\nThe most-generic model-based empowerment method is to approximate the empowerment using generic importance-sampling estimator. We assume that a model of the environment p(s\u2032|ai, s) is available, but at this point will not specify how this model is obtained. We generate S samples ai from the source distribution \u03c9t(a|s) with importance weights \u03b1t,i (\u2211 i \u03b1t,i = 1, \u03b1t,i > 0\u2200i = 1 . . . S ) at iteration t, {ai, \u03b1t,i} \u223c \u03c9t(a|s). (11) The samples ai are kept constant through the optimization and only the importance weights are adapted to maximize the MI. Additionally, for each action-sequence sample ai we generate J futurestate samples s\u2032k,i from the transition model p(s\n\u2032|ai, s), s\u2032k,i \u223c p(s\u2032|ai, s)\u2200i = 1 . . . S, k = 1 . . . J. (12)\nWe could approximate all quantities required to compute the MI from the samples ai and s\u2032k,i, but we shall instead, directly approximate the Blahut-Arimoto iteration. For this we compute a distortion Dt,i at the t-th iteration using:\nDt,i \u2248 1\nJ J\u2211 k=1 ln p(s\u2032k,i|ai) pt(s\u2032k,i) , (13)\nwhere pt(s\u2032) = \u2211 i p(s\n\u2032|ai, s)\u03b1t,i and find a new set of normalized weights \u03b1t+1,i such that \u03c9t+1(a|s) best approximates the Blahut-Arimoto update. This yields a simple update rule for the importance weights,\nln\u03b1t+1,i = ln\u03b1t,i +Dt,i \u2212 ct+1, (14) where ct+1 = \u2211 i \u03b1t,i expDt,i is a normalizing constant. The algorithmic complexity of the update (14) is O(S), but the cost of computing the distortion (13) scales as O(JS2). This approach is applicable to the continuous domain, but typically requires a large number of samples for accurate estimation of the empowerment.\nB.2 Efficient Optimisation\nIn the case of smooth transition models p(s\u2032|ai, s) and policy \u03c9\u03b8(a|s), a more efficient algorithm can be derived using stochastic backpropagation [2, 1] in which we rewrite both the model and policy as s\u2032 = f(ai, s, \u03bem) and a = h\u03b8(s, \u03bep) where \u03bem, \u03bep \u223c N (0, I) and f and h are differentiable functions. Using this representation, we can rewrite the variational objective function 4 as an expectation under \u03bem, \u03bep: I\u03c9,q(s) = E\u03bem,\u03bep [log q\u03be(h\u03b8(s, \u03bep)|f(h\u03b8(s, \u03bep), s, \u03bem), s)\u2212 log\u03c9\u03b8(h\u03b8(s, \u03bep)|s)] (15) The reparametrised bound 15 can now be optimized with respect to the parameters \u03b8 of the policy using stochastic gradient ascent."}, {"heading": "C Deriving the Blahut-Arimoto Iterations from the Variational Bound", "text": "Here we show that the Blahut-Arimoto algorithm can be derived from the variational bound (8). The variational distribution q(a|s\u2032, s) that maximises the bound (8) is the posterior distribution over actions given present and future states,\nq?(a|s\u2032, s) = p(a|s\u2032, s) \u221d p(s\u2032|a, s)\u03c9(a|s). (16)\nThe Blahut-Arimoto algorithm is obtained by replacing equation (16) in equation (10) and rearranging the terms:\n\u03c9t+1(a|s) \u221d exp ( \u03b2Ep(s\u2032|s,A)[ln qt(a|s, s\u2032)] ) \u221d exp ( \u03b2Ep(s\u2032|s,A)[ln pt(a|s\u2032, s)]\n) \u221d exp ( \u03b2Ep(s\u2032|s,A) [ ln p(s\u2032|a, s)\u03c9t(a|s)\npt(s\u2032|s) ]) \u221d \u03c9t(a|s) exp ( \u03b2Ep(s\u2032|s,A) [ ln p(s\u2032|a, s) pt(s\u2032|s) ]) . (17)"}, {"heading": "D Neural Network Description", "text": "D.1 State representation using convolutional networks\nFor observations that are images, we make use of a convolutional network to obtain a state representation. We use the same convolutional network for all experiments. After each convolution we apply a rectified non-linearity. For all experiments , we make use a 10 filters for each layer of the convolution. The first convolution consists of 4 \u00d7 4 kernels with a stride of 1, and the second convolution consists of 3 \u00d7 3 kernels with a stride of 2. The output of the convolution is passed through a fully connected layer with 100 hidden units, followed by a rectified non-linearity. This 100-dimensional representation is what forms the state representation s, s\u2032 used for the variational information maximisation components that follow this processing stage.\nD.2 Parameterisation of other networks\nWe also use neural networks in the parameterisation of the decoder distribution q\u03be(a|s, s\u2032) and in the directed model h\u03b8(a|s). This distribution is of the form:\nq\u03be(a|s\u2032, s) = q(a1|s, s\u2032) K\u220f k=2 q(ak|f\u03be(ak\u22121, s, s\u2032)), (18)\nwhere we must specify the form of the per action distributions q(ak). This distribution is Gaussian distribution whose mean and variance are parameterised by a two-layer neural network:\nq(ak) =N (ak|\u00b5\u03be(ak\u22121, s, s\u2032), \u03c32\u03be (ak\u22121, s, s\u2032)) (19) \u00b5\u03be(ak\u22121, s, s \u2032) =g(W\u00b5\u03b7 + b) (20) log \u03c3\u03be(ak\u22121, s, s \u2032) =g(W\u03c3\u03b7 + b) (21) \u03b7 =`(W2g(W1x+ b1) + b2) (22)\nwhere \u03b7 is a two-layer neural network which forms the shared component of the distribution. g(\u00b7) is an element-wise non-linearity, which is the rectified non-linearity in our case: Rect(x) = max(0, x). The scalar function \u03c8\u03b8(s), also is specified by a two-layer neural network."}], "references": [{"title": "Stochastic gradient vb and the variational auto-encoder", "author": ["Kingma", "Diederik P", "Welling", "Max"], "venue": "International Conference on Learning Representations,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2014}, {"title": "Stochastic back-propagation and variational inference in deep latent gaussian models", "author": ["Rezende", "Danilo Jimenez", "Mohamed", "Shakir", "Wierstra", "Daan"], "venue": "In International Conference on Machine Learning,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2014}, {"title": "Empowerment\u2013an introduction", "author": ["C. Salge", "C. Glackin", "D. Polani"], "venue": "In Guided Self- Organization: Inception,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2014}, {"title": "The Blahut-Arimoto algorithms", "author": ["R.W. Yeung"], "venue": "In Information Theory and Network Coding,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2008}], "referenceMentions": [{"referenceID": 3, "context": "The problem of measuring and harnessing dependence between random variables is an inescapable statistical problem that forms the basis of a large number of applications in machine learning, including rate distortion theory [4], information bottleneck methods [26], population coding [1], curiositydriven exploration [24, 19], model selection [3], and intrinsically-motivated reinforcement learning [20].", "startOffset": 223, "endOffset": 226}, {"referenceID": 0, "context": "The problem of measuring and harnessing dependence between random variables is an inescapable statistical problem that forms the basis of a large number of applications in machine learning, including rate distortion theory [4], information bottleneck methods [26], population coding [1], curiositydriven exploration [24, 19], model selection [3], and intrinsically-motivated reinforcement learning [20].", "startOffset": 283, "endOffset": 286}, {"referenceID": 2, "context": "The problem of measuring and harnessing dependence between random variables is an inescapable statistical problem that forms the basis of a large number of applications in machine learning, including rate distortion theory [4], information bottleneck methods [26], population coding [1], curiositydriven exploration [24, 19], model selection [3], and intrinsically-motivated reinforcement learning [20].", "startOffset": 342, "endOffset": 345}, {"referenceID": 0, "context": "1 Variational Information Lower Bound The MI can be made more tractable by deriving a lower bound to it and maximising this instead \u2014 here we present the bound derived by Barber & Agakov [1].", "startOffset": 187, "endOffset": 190}, {"referenceID": 1, "context": "Other lower bounds for the mutual information are also possible: Jaakkola & Jordan [9] present a lower bound by using the convexity bound for the logarithm; Brunel & Nadal [2] use a Gaussian assumption and appeal to the Cramer-Rao lower bound.", "startOffset": 172, "endOffset": 175}, {"referenceID": 0, "context": "Barber & Agakov [1] made the connection between this approach and the generalised EM algorithm and refer to it as the IM (information maximisation) algorithm and we follow the same optimisation principle.", "startOffset": 16, "endOffset": 19}], "year": 2015, "abstractText": "The mutual information is a core statistical quantity that has applications in all areas of machine learning, whether this is in training of density models over multiple data modalities, in maximising the efficiency of noisy transmission channels, or when learning behaviour policies for exploration by artificial agents. Most learning algorithms that involve optimisation of the mutual information rely on the Blahut-Arimoto algorithm \u2014 an enumerative algorithm with exponential complexity that is not suitable for modern machine learning applications. This paper provides a new approach for scalable optimisation of the mutual information by merging techniques from variational inference and deep learning. We develop our approach by focusing on the problem of intrinsically-motivated learning, where the mutual information forms the definition of a well-known internal drive known as empowerment. Using a variational lower bound on the mutual information, combined with convolutional networks for handling visual input streams, we develop a stochastic optimisation algorithm that allows for scalable information maximisation and empowerment-based reasoning directly from pixels to actions.", "creator": "LaTeX with hyperref package"}}}