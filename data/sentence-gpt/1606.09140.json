{"id": "1606.09140", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "29-Jun-2016", "title": "Algebraic foundations for qualitative calculi and networks", "abstract": "A qualitative representation $\\phi$ is like an ordinary representation of a relation algebra, but instead of requiring $(a; b)^\\phi = a^\\phi | b^\\phi$, as we do for ordinary representations, we only require that $c^\\phi\\supseteq a^\\phi | b^\\phi \\iff c\\geq a ; b$, for each $c$ in the algebra. A constraint network is qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation, preserving the constraints. If a constraint network is satisfiable then it is clearly qualitatively satisfiable, but the converse can fail in any particular way. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. An explicit representation of the proposition is therefore qualitatively unsatisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network can be qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. This is true if the constraint network is not satisfiable, but the constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. The constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. This is true if the constraint network is not satisfiable, but the constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation. This is true if the constraint network is not satisfiable, but the constraint network is also qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation.", "histories": [["v1", "Wed, 29 Jun 2016 15:00:48 GMT  (27kb)", "https://arxiv.org/abs/1606.09140v1", "22 pages"], ["v2", "Thu, 21 Jul 2016 11:44:51 GMT  (28kb)", "http://arxiv.org/abs/1606.09140v2", "22 pages"], ["v3", "Mon, 19 Jun 2017 16:33:39 GMT  (34kb)", "http://arxiv.org/abs/1606.09140v3", "22 pages"]], "COMMENTS": "22 pages", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["robin hirsch", "marcel jackson", "tomasz kowalski"], "accepted": false, "id": "1606.09140"}, "pdf": {"name": "1606.09140.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": [], "sections": [{"heading": null, "text": "ar X\niv :1\n60 6.\n09 14\n0v 3\n[ cs\n.A I]\n1 9\nJu n\nsatisfiable, but the converse can fail, as we show. However, for a wide range of relation algebras including the point algebra, the Allen Interval Algebra, RCC8 and many others, a network is satisfiable if and only if it is qualitatively satisfiable.\nUnlike ordinary composition, the weak composition arising from qualitative representations need not be associative, so we can generalise by considering network satisfaction problems over non-associative algebras. We prove that computationally, qualitative representations have many advantages over ordinary representations: whereas many finite relation algebras have only infinite representations, every finite qualitatively representable algebra has a finite qualitative representation; the representability problem for (the atom structures of) finite non-associative algebras is NP-complete; the network satisfaction problem over a finite qualitatively representable algebra is always in NP; the validity of equations over qualitative representations is co-NPcomplete. On the other hand we prove that there is no finite axiomatisation of the class of qualitatively representable algebras."}, {"heading": "1. Introduction", "text": "Computer scientists have been solving systems of binary constraints for a long time. Temporal reasoning, for example, is often dealt with by solving a set of temporal constraints between events, represented in a network : a finite complete graph whose edges are labelled by a choice of alternative temporal relations. The network is satisfiable if it is possible to map the nodes to temporal events in such a way that each pair of nodes is mapped to a pair of events satisfying one of the alternative temporal relations labelling that edge. An algebra of these relations, in one of the simplest cases, is the point algebra, where the primitive alternative relations are =, <,> and the events are points on a linear flow of time. Relational compositions of these basic relations are recorded in the table in the upper left corner of Figure 1, where \u25e6 denotes composition of binary relations.\nThe second author was supported by ARC Future Fellowship FT120100666 and Discovery Project DP1094578. The third author was supported by ARC Future Fellowship FT100100952.\n1\nConsider the network over the point algebra given in Figure 1. It is satisfiable in a linear order of just four distinct points, but a representation of the point algebra has to be infinite, because <\u25e6< is identical to <, which entails not just transitivity (<\u25e6< is contained in <) but also density (< is contained in <\u25e6<). This discrepancy between an infinitely representable algebra and finitely satisfiable networks over it, is not too serious in this case because every finite linear order embeds into the rational numbers. Hence, if a network has a solution in some linear order then it can be embedded into a representation of the point algebra.\nTo deal with temporal intervals rather than point-events, the Allen Interval Algebra [All83] is very commonly used. Here, we have thirteen alternative primitive relations between intervals on a linear flow of time. For the Allen Interval Algebra, a solution to a constraint network would be a finite set of intervals in a linear order with an appropriate relation holding between each pair, but a representation of this algebra is again infinite: it consists of ordered pairs taken from a dense linear order without endpoints [LM94]. And again, there is no real discrepancy here because every finite arrangement of intervals in a linear order embeds into a set of intervals of rational numbers.\nBut when one tries to generalise the above examples to apply relational reasoning in other domains, the discrepancy becomes a real issue. A very clear example of this occurs in spatial reasoning, where an analogue of the Allen Interval Algebra with relations between spatial regions is used. This algebra is called RCC8. One of the basic relations considered in RCC8 is external connectedness (EC), whose intended interpretation is that xECy if regions x and y touch at the borders but only at the borders, for example as in the left-hand side of Figure 2. Now, RCC8 requires that EC \u25e6 EC \u2287 EC, which is reasonable if we think of regions topologically as open balls (open disks in R2; more generally, open sets with boundaries of genus 0), because then for any xECy we can find a z with xECzECy, as in the lefthand side of Figure 2. However, in real-life applications, this assumption is not\nalways warranted. For it happens that one region can be completely surrounded by another. This is the spatial relation San Marino bears to Italy, the Vatican City to Rome, and Lesotho to South Africa. When this happens, as in the right-hand side of Figure 2, where region y is the annulus surrounding region x, we have xECy, but (x, y) /\u2208 EC \u25e6 EC.\nThe problem was identified, and rightly diagnosed to be an anomaly. The remedy was to consider an algebra of binary relations where relational composition is replaced by another binary operation, called weak composition, approximating real composition from above (see, for example [LR04]). Weak composition is defined in such a way that when (x, y) is in the weak composition of EC with EC it is not mandatory that there is a z with xECzECy, it is merely permitted that such a z should exist. (Note, below we distinguish two different meanings of weak composition from the literature: either it is merely permitted that such a z should exist, or it is permitted and additionally there must be x\u2032, y\u2032, z\u2032 such that x\u2032ECz\u2032ECy\u2032 i.e. the composition has to be realised at least once. The two corresponding types of representations we consider are feeble and qualitative respectively, see below.) Since then, an impressive body of research has been conducted in qualitative reasoning based on these notions of weak composition (see [CCL+15] for a survey).\nOne restriction to this framework of qualitative reasoning is that the identity relation is assumed to be an indivisible primitive relation (an atom of the algebra), so that unary properties of states cannot be expressed directly. So, for example, suppose we want to assert that a certain time interval occurs during an interval where the printer is working. In the Allen Interval Algebra we can express that one interval i occurs during another interval j but we cannot assert properties of the interval j. In our framework we may introduce a subidentity atom w with intended semantics jwj if and only if the printer is working on the interval j. A similar extension was required for Kleene Algebra, where it was necessary to introduce the test operator in order to express properties of states, rather than relations [Koz97]. Here, we make no assumption that the identity is atomic.\nA further restriction is that the definition of weak composition only applies in the setting of finitely many primitive relations. However, there are applications in Artificial Intelligence where infinitely many different relations are needed. A number of different researchers who wished to add quantitative reasoning to qualitative constraint systems, adopted languages containing infinitely many constraints (e.g.\n[KL91, Mei96, Hir96] or see [OW08] for a survey of metric temporal logic, also see Example 6.7 below).\nIn this article we define the weak composition of two binary relations in general; our definition coincides with the original one where it applies, but covers a wider range of algebras of binary relations. We also define a corresponding notion of qualitative representation. In a classical representation of a relation algebra (referred to henceforth as a strong representation), given two points x, y for which it is consistent for there to be a z with (x, z) \u2208 a, (z, y) \u2208 b it is then mandatory that such a point z exists. This requirement is relaxed in a qualitative representation, see Definition 2 below. A constraint network is qualitatively satisfiable if it embeds into a qualitative representation. We will see that this corresponds much more closely to the intuitive approach to binary constraint problems, such as those illustrated in Figure 1. There, the four element chain is in fact a qualitative representation of the point algebra.\n1.1. Fixed vs. arbitrary representations. When considering the constraint satisfaction problem in its general setting one typically has a fixed domain for each variable and the interpretation of any relation symbols used in the constraints is also fixed. In keeping with that, a great deal of the research into qualitative reasoning focusses on a fixed set of relations on a fixed base set and considers the satisfiability of constraints in that setting, in other words the issue is the satisfiability of constraints in a single, fixed representation. To illustrate the value of this approach, suppose we wish to schedule a series of meetings in a discrete flow of time where there are exactly four time points, as in Figure 1. A set of binary constraints on the scheduling of events could be represented as a network over the point algebra, but the question to consider is not whether the network is satisfiable in some qualitative representation, it is whether the network can be satisfied in the qualitative representation of the point algebra consisting of a linear order of four points. For this kind of problem it is the satisfiability of a network in a fixed representation that should be considered. (The complexity of this problem can be fairly high, for example in [Lee14] a single model based on dipoles in the real plane, (i.e. elements of R4) is adopted and it is shown that the network satisfaction problem is \u2203R-complete for various algebras of relative directional constraints over this model. For a more extreme case, consider a graph algebra with three primitive constraints: equals, adjacent and non-adjacent. Let S be an undecidable set of finite connected graphs and let G be the disjoint union of all graphs in S. Given any finite connected graph F we can define a network on the same set of nodes, edges are labelled \u2018adjacent\u2019 and irreflexive non-edges are labelled \u2018non-adjacent\u2019. Since this network is qualitatively satisfiable in G if and only if F \u2208 S, the problem of determining whether a network is satisfiable in G is undecidable.)\nHowever, there are applications where the representation is not fixed, for example in spatial reasoning using RCC8 the exact topography of the relations between regions may not be known. Many of the theorems proved in the previously cited papers establish properties that hold over a whole class of representations, e.g. results in [Ren02] refer to the solvability of RCC8 constraints over non-empty, regular, closed regions, regardless of the particular topology under consideration. The main decision problem considered in the current paper is to decide if a given network is satisfiable in an arbitrary qualitative representation.\nResults obtained in this paper indicate that qualitative representations have computational advantages over strong representations. All the algebras of relations mentioned above have strong representations, but only on infinite base sets. In contrast, we show that if a finite algebra of relations (formally, a non-associative algebra) has a qualitative representation then it has one on a finite base set. A consequence is that the problem of determining whether a finite non-associative algebra is qualitatively representable is in NP (indeed it is NP-complete) whereas the strong representation problem is known to be undecidable [HH01b].\nFurthermore, although it happens to be the case that a consistent, atomic network of constraints (a consistent network with only a single primitive relation on each edge) is always satisfiable for the algebras of relations previously mentioned, and hence a polynomial time, non-deterministic algorithm can solve the network satisfaction problem for these algebras by guessing a primitive label for each edge and then checking their consistency, this does not work for other algebras of spatial relations. For example, consider the interval and duration algebra INDU whose twenty-five primitive relations are similar to Allen\u2019s thirteen primitive interval relations, but also determine whether the duration of the first interval is smaller, equal or greater in duration than the second interval [PKS99]. There are known, consistent, atomic INDU-networks which cannot be satisfied by intervals [Lig11,\nFigure 8.11]. Thus consistency of a network does not suffice to prove that the network is satisfiable, even if the network is atomic. Although the network satisfaction problem remains in NP for INDU-networks, there are known relation algebras where the problem has much worse complexity [Hir99]. On the other hand, for any finite algebra of relations the network satisfaction problem over qualitative representations always belongs to NP.\nSimilarly, although the validity of equations valid over strong representations was shown to be undecidable by Tarski, the validity of equations valid over all qualitative representations is decidable (indeed it is co-NP-complete). Our conclusion is that qualitative representations are not only more appropriate to express the kind of contraints that arise from many applications, but they are more amenable to algorithmic reasoning.\n1.2. Historical remarks. The structures we called algebras above, were conceived as calculi : formal rules for manipulating relations, invented and developed ad hoc, to suit the purpose at hand. This is evident in the naming: for example, RCC8 is so called because it was originally developed in [RCC92] as Region Connection Calculus, with 8 basic relations, hence the acronym RCC8 (although the names of the three authors might also have something to do with it). Later, mathematicians observed that such calculi, including the point algebra, Allen Interval Algebra and RCC8, were examples of Tarski\u2019s Relation Algebras. As far as we know, this observation was first made in [LM88, LM94]. In this setting, the basic relations are boolean atoms in a relation algebra, the edges of a network are labelled by arbitrary elements of the relation algebra and the network is satisfiable if its nodes can be mapped into some representation of the relation algebra in such a way that the label of an edge of the network holds at the corresponding two points in the representation. However, as we outlined above, there were\ndifficulties in restricting to strong representations, particularly for relation algebras such as RCC8, and this led to the weaker notion of qualitative representation, now very widely studied in knowledge representation and its applications, see [DWM01, LR04, LW06, MSW06, CCL+15, RL05], for example.\n1.3. Notation. We deal with abstract algebras and concrete representations as binary relations and separate the notation, to some extent. Working abstractly we use +,\u2212 as the basic boolean operators and introduce standard abbreviations, such as x \u00b7 y = \u2212(\u2212x + \u2212y) and x \u2264 y \u2194 x + y = y. The identity constant is 1\u2032, the converse operator is \u02d8 and any algebraic multiplication-like operator (including weak composition, below) will be denoted by ;. Working with concrete binary relations we write \u222a, \\ for the operators corresponding to +,\u2212 and we write IdD = {(x, x) : x \u2208 D} for the identity relation over a domain D, corresponding to the abstract 1\u2032, though we may drop the subscript D if it is clear from the context. The converse of a binary relation r will be written as r\u02d8 = {(y, x) : (x, y) \u2208 r}. We write r\u25e6s = {(x, y) \u2208 D \u00d7D : \u2203z \u2208 D (x, z) \u2208 r \u2227 (z, y) \u2208 s} for the composition of two binary relations r, s. Our convention is that converse has highest precedence, followed by composition which takes precedence over other operators, for example a \u00b7 b ; c\u0306 denotes a \u00b7 (b ; (c\u0306 )). For any set S we write \u2118(S) for the power set of S."}, {"heading": "2. Background", "text": "A qualitative calculus has traditionally been defined (see, for example, [LR04]) by specifying a finite partition \u03a0 = (R0, . . . , Rn) of the set D \u00d7D, for some fixed (usually infinite) domain D, with the following properties:\n(1) The identity relation IdD is an element of the partition, (2) \u03a0 is closed under relational converses, that is, R\u02d8\u2208 \u03a0 for every R \u2208 \u03a0.\nThe set {R0, . . . , Rn} generates a boolean subalgebra B of P(D \u00d7 D) under the usual set-theoretical operations. Clearly, R0, . . . , Rn are atoms of B; these include the identity relation. Moreover, B is closed under relational converses. However, B is not in general closed under relational composition, as the example of Figure 2 indicates. This is remedied by considering weak composition instead: an operation defined by\nS ; T = \u22c3 {R \u2208 \u03a0: R \u2229 (S \u25e6 T ) 6= \u2205}\nwhere S \u25e6 T stands for the true composition of S and T . So defined, S ; T is the smallest element of B containing S \u25e6 T .\nThus, a qualitative calculus carries a natural algebraic structure of the type of a relation algebra. Viewed from an abstract algebraic perspective, a qualitative calculus is a hybrid object: an abstract algebra together with a concrete interpretation, or a representation. As in [WHW14], one of our aims in this article is to separate the two sides of a qualitative calculus, into syntax (algebra) and semantics (representation), and so investigate the foundations of qualitative calculi in a manner similar to model theoretical analysis of classical mathematics.\nBefore we state the basic definitions, let us recall the two generalisations that we adopt from the outset. Firstly, we will lift the finiteness assumption. It is not necessary for a definition of weak composition, and from a universal algebraic point of view admitting infinite algebras is more natural, furthermore, as we have seen, there are applications where it is desirable to include infinite relation algebras, for example when we wish to express metric constraints. Secondly, we do not require\nthat the identity is an atom, as subidentity relations provide a natural way of modelling properties, that is, subsets of the domain, by representing a set Z \u2286 D by the relation {(z, z) : z \u2208 Z}.\nDEFINITION 1. Let D be a set and let S be a set of binary relations over D, that is, S \u2286 P(D \u00d7D). S is a herd if\n(1) S forms a boolean set algebra with top element D\u00d7D, so S is closed under finite intersections and complement relative to D \u00d7D, (2) IdD \u2208 S, (3) If A \u2208 S then the converse relation A\u02d8 is in S.\nIn a herd S given any two elements A,B \u2208 S if there is a minimal C \u2208 S containing A \u25e6 B then we say that the weak composition of A and B is C. If S is finite, then such a minimal element is sure to exist, since S is closed under finite intersections.\nFor herds with infinitely many relations, the weak composition of two elements is not always defined (a minimal element containing A \u25e6B may not exist), however the case we are interested in is the case where the weak composition of A and B is defined, and for the abstract algebraic structure corresponding to herds we include a binary composition operator ;, so the signature is the same as that of a relation algebra: it is a boolean algebra with an extra nullary operation 1\u2032 for identity, a unary operation \u02d8 for converse, and a binary operation ; to denote weak composition and it obeys all the axioms defining a relation algebra except perhaps associativity (see below). Maddux calls such an algebra a non-associative relation algebra [Mad82, Definition 1.2], or non-associative algebra for short. [LR04] already observed that their qualitative calculi are non-associative algebras and it is easily verified that the herds considered here are non-associative algebras too, in the cases where weak composition is defined.\nAn algebra A = (A, 0, 1,+,\u2212, 1\u2032, ,\u0306 ;) of the type of relation algebras belongs to the variety NA of non-associative algebras, if\n(1) (A, 0, 1,+,\u2212) is a boolean algebra, (2) (A, 1\u2032, ,\u0306 ;) is an involuted monoid, i.e. it satisfies\n(a) 1\u2032 ; x = x = x ; 1\u2032 (b) x\u0306 \u02d8= x (c) (x ; y)\u0306 = y\u02d8 ; x\u0306\n(3) \u02d8 and ; are normal additive operators, that is (a) 0\u0306 = x ; 0 = 0, (b) (x+ y)\u0306 = x\u0306 + y ,\u0306 x ; (y + z) = (x ; y) + (x ; z) (4) x ; y \u00b7 z\u02d8= 0 if and only if y ; z \u00b7 x\u0306 = 0 (Peircean law)\nBy additivity, the operators are monotone, e.g. y \u2264 z \u2192 x; y \u2264 x; z, etc. Since the operators ,\u0306 ; are conjugated it turns out that every non-associative algebra is completely additive, i.e. if S is a subset of the elements of A with a supremum \u03a3S then (\u03a3S )\u0306 is the supremum of {s\u0306 : s \u2208 S} and for any a \u2208 A the element a; \u03a3S is the supremum of {a; s : s \u2208 S} [JT51, Theorem 1.14].\nIn the following we define a qualitative representation as an isomorphism from an non-associative algebra to a herd. In [LR04, Definition 3] the corresponding definition is only required to be a homomorphism, injectivity is not required. One difficulty with this weaker notion of representation is that trivial map from an\narbitrary non-associative algebra to the herd on an empty domain is a non-injective homomorphism, and we wish to exclude this trivial case.\nDEFINITION 2. Let A = (A, 0, 1,+,\u2212, 1\u2032, ,\u0306 ;) be a non-associative algebra. A qualitative representation \u03c6 of an algebra A is an injection to a herd S of binary relations over base D, such that\n(1) 0\u03c6 = \u2205, 1\u03c6 = D \u00d7D, (1\u2032)\u03c6 = IdD, (2) (a+ b)\u03c6 = a\u03c6 \u222a b\u03c6, (\u2212a)\u03c6 = (D \u00d7D) \\ a\u03c6, (3) (a )\u0306\u03c6 = (a\u03c6 )\u0306 , (4) c\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6 \u2194 c \u2265 a ; b\nfor all a, b, c \u2208 A. If A has a qualitative representation, then we say that A is a qualitatively representable algebra. The class of all qualitatively representable algebras we will denote by QRA.\nIf (a ; b)\u03c6 = a\u03c6 \u25e6 b\u03c6 for all a, b \u2208 A then the qualitative representation \u03c6 is a strong representation. RRA is the variety generated by the class of all strongly representable relation algebras.\nIf \u03c6 is a qualitative representation of a non-associative algebra A, observe that a; b is always defined (for a, b,\u2208 A) and Definition 2.4 requires that it is the minimal solution of c \u2208 A, c\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6.\nThe class of strongly representable relation algebras is already known to be extremely complicated: without finite axiomatisation in first order logic, with undecidable equational theory and with undecidable membership problem for finite algebras [HH01b]. The class QRA is known to be a proper subclass of NA [LR04, WHW14], or see Example 6.4 below. We show below that the class QRA has intermediate difficulty: it is also without a finite axiomatisation (Theorem 19) but it is NP-complete to decide membership for finite algebras (Theorem 14).\nThe definition of qualitative representation (Definition 2) is based on the definition of weak composition for partition schemes given in [LR04, \u00a72.3], however our definition applies not just to finite partition schemes, it works even for infinite herds. Moreover, Ligozat and Renz appear to include two distinct notions of weak composition. In [RL05, abstract] they require that weak composition is \u201cthe strongest relation containing the real composition\u201d, in agreement with much of the relevant literature and in agreement with Definition 2 above. However, in [LR04, Definition 3] and in [Lig05, Definition 2] only the right to left implication of Definition 2.4 is required, that is, they only require (a ; b)\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6 and do not insist that c = a; b is the minimal solution of c\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6 as c ranges over elements of the algebra. We call this looser definition of a qualitative representation a feeble representation and investigate it separately in Section 6. Example 6.1 and 6.4 below show that there is a real discrepancy between qualitative representations and feeble representations. ([WHW14, Proposition 2] dispute a quite separate point in [RL05], concerning the notion of \u201cclosure under constraints\u201d.)\nLEMMA 3. Let \u03c6 : A \u2192 \u2118(D \u00d7 D) respect the boolean operators, the identity and the converse operator, i.e. 1\u03c6 = D \u00d7 D, (\u2212a)\u03c6 = (D \u00d7 D) \\ a\u03c6, (a + b)\u03c6 = a\u03c6\u222ab\u03c6, (1\u2032)\u03c6 = IdD and (a )\u0306 \u03c6 = {(y, x) : (x, y) \u2208 a\u03c6}. The following are equivalent\n(1) \u03c6 is a qualitative representation (2) for all a, b, c \u2208 A\n(a; b \u00b7 c 6= 0) \u2194 \u2203x, y, z \u2208 D((x, y) \u2208 a\u03c6 \u2227 (y, z) \u2208 b\u03c6 \u2227 (x, z) \u2208 c\u03c6).\nProof. For (1) \u21d2 (2), suppose \u03c6 is a qualitative representation. If there are x, y, z \u2208 D such that (x, y) \u2208 a\u03c6, (y, z) \u2208 b\u03c6, (x, z) \u2208 c\u03c6 then (a; b \u00b7 c)\u03c6 = (a; b)\u03c6 \u2229 c\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6 \u2229 c\u03c6 6= \u2205, so a; b \u00b7 c 6= 0. If no such x, y, z exist then a\u03c6 \u25e6 b\u03c6 \u2286 (\u2212c)\u03c6 and since (a; b)\u03c6 is smallest such that (a; b)\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6 it follows that (a; b)\u03c6 \u2286 (\u2212c)\u03c6, (a; b)\u03c6 \u2229 c\u03c6 = \u2205, so a; b \u00b7 c = 0.\nConversely assume (2). If (a; b)\u03c6 6\u2287 a\u03c6 \u25e6 b\u03c6 then there are x, y, z with (x, y) \u2208 a\u03c6, (y, z) \u2208 b\u03c6 and (x, z) \u2208 (\u2212(a; b))\u03c6, hence by (2) a; b \u00b7 (\u2212(a; b)) 6= 0, a contradiction. We conclude (a; b)\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6. If c\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6 then there do not exist x, y, z such that (x, y) \u2208 a\u03c6, (y, z) \u2208 b\u03c6 and (x, z) \u2208 (\u2212c)\u03c6 so by (2), a; b \u00b7 (\u2212c) = 0 and c \u2265 a; b, thus c = a; b is the minimal solution in A of c\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6, this proves that ; is correctly represented as weak composition."}, {"heading": "3. Atom Structures and Examples", "text": "In the case of an atomic algebra, a convenient way of specifying the operators is by defining its atom structure.\nDEFINITION 4. Let X be the set of atoms (minimal, non-zero elements) of a non-associative algebra A. The atom structure At(A) is defined as\nAt(A) = (X,E, ,\u0306 C)\nwhere E is the set of atoms below the identity, \u02d8 is the converse function restricted to atoms, and C is the set of consistent triples of atoms, that is, those triples of atoms (a, b, c) such that a ; b \u2265 c.\nConversely, given (X,E, ,\u0306 C), where E \u2286 X, \u02d8 is a unary function on X and C \u2286 X3 we may define the complex algebra Cm(X,E, ,\u0306 C) = (P(X),\u2205, X,\u222a, \\, E, ,\u0306 ;) where P(X) is the power set of X, E is the identity element, \u02d8 is extended to sets of atoms by taking unions, and multiplication is defined by S ; T = {x \u2208 X : \u2203s \u2208 S, t \u2208 T (s, t, x) \u2208 X}.\nFor any atomic non-associative algebra A with atoms X , the map defined by a 7\u2192 {x \u2208 X : x \u2264 a} is an embedding of A into Cm(At(A)) and in the case where A is complete and atomic, this map is surjective, i.e. an isomorphism. Observe, for finite algebras, that the number of atoms is the logarithm (base two) of the number of elements of the algebra. It is clear, by additivity, that the constant 1\u2032 and the operators ,\u0306 ; are determined by the atom structure, when the atom structure is finite and in fact, as we noted earlier, every non-associative algebra is completely additive so the operators of an arbitrary atomic, non-associative algebra are determined by its atom structure.\nThe next lemma is proved in [Mad82, Theorem 2.2(2)].\nLEMMA 5. Let (S,E, ,\u0306 C) consist of a set S, a subset E \u2286 S, a unary function \u02d8: S \u2192 S satisfying s\u0306 \u02d8 = s, and subset C \u2286 S\u00d7S\u00d7S. The following are equivalent\n\u2022 (S,E, ,\u0306 C) is the atom structure of some non-associative algebra, \u2022 For all a, b, c \u2208 S we have a = b iff there is e \u2208 E such that (e, a, b) \u2208 C, and if (a, b, c) \u2208 C then (b\u0306 , a ,\u0306 c\u0306 ) \u2208 C and (c\u0306 , a, b\u0306 ) \u2208 C.\nThe six triples (a, b, c), (b, c\u0306 , a\u0306 ), (c, b\u0306 , a), (a\u0306 , c, b), (b\u0306 , a\u0306 , c\u0306 ), (c\u0306 , a, b\u0306 ) are called the Peircean transforms of (a, b, c). In practice, the triples are given in composition tables such as the one used in Figure 1 to define the point algebra. The entry for\na ; b is the join of the set {c : (a, b, c) \u2208 C}, so if (a, b, c1), (a, b, c2), (a, b, c3) \u2208 C, the entry for a ; b will be c1 + c2 + c3.\nIn the following examples we define some finite non-associative algebras by giving their atom structures, except for the final example which is defined directly.\nEXAMPLES 6. (1) The first of our non-associative algebras has three atoms, {e, e\u2032, a}, hence eight elements. The identity is e+ e\u2032, each element is selfconverse, multiplication is defined in the table on the left below\n; e e\u2032 a e e 0 a e\u2032 0 e\u2032 a a a a 1\n0\n1\n2\ne\ne\u2032\ne\u2032\na\na\na\nMultiplication is not associative, for example (e ;e\u2032) ;a = 0 ;a = 0 but e ; (e\u2032 ; a) = e ;a = a. This non-associative algebra has a qualitative representation \u03c6 over a base of three points {0, 1, 2}, shown on the right, above: e\u03c6 = Id{0}, (e \u2032)\u03c6 = Id{1,2} and a \u03c6 = {(x, y) : x 6= y < 3}, \u03c6 is defined on sums of atoms by additivity. Now let \u03b8 be obtained by restricting the qualitative representation \u03c6 to the base {0, 1}, illustrated below.\n0 1\na\na\ne e\u2032\nSince (b; c)\u03b8 \u2287 b\u03b8 \u25e6c\u03b8 for any b, c in the algebra and all atoms are witnessed, \u03b8 is a feeble representation over the base {0, 1}. However, a\u03b8 \u25e6 a\u03b8 = Id{0,1} and a; a = 1 is not minimal subject to containing a\u03b8 \u25e6 a\u03b8 (the minimal solution is e + e\u2032 < 1), so \u03b8 is not a qualitative representation. (2) This non-associative algebra has atoms {1\u2032, a, a\u2032,\u00d7} (so sixteen elements). All elements are self-converse, this time the identity 1\u2032 is an atom, multiplication is defined by\n; 1\u2032 a a\u2032 \u00d7 1\u2032 1\u2032 a a\u2032 \u00d7 a a 1\u2032 + a 0 \u00d7 a\u2032 a\u2032 0 1\u2032 + a\u2032 \u00d7 \u00d7 \u00d7 \u00d7 \u00d7 1\u2032 + a+ a\u2032\nAgain, associativity fails because (a;a\u2032);a\u2032 = 0;a\u2032 = 0 but a;(a\u2032 ;a\u2032) = a;(1\u2032+ a\u2032) = a. A qualitative representation \u03b8 on base {0, 1, 2}\u222a {0\u2032, 1\u2032, 2\u2032}, shown below, is defined by (1\u2032)\u03b8 = Id{x,x\u2032:x<3}, a \u03b8 = {(m,n) : m 6= n, m, n < 3}, (a\u2032)\u03b8 = {(m\u2032, n\u2032) : m 6= n, m, n < 3}, \u00d7\u03b8 = {(m,n\u2032), (m\u2032, n) : m,n < 3}.\nHere and below, reflexive identity loops have been omitted.\n0 1\n2\na\na a\n0\u2032 1\u2032\n2\u2032\na\u2032 a\u2032 a\u2032\n\u00d7\n\u00d7\n\u00d7\n\u00d7\n(3) The next algebra has atoms {1\u2032, a, b, c} where the identity is 1\u2032, all atoms are self-converse and multiplication is defined by the table below, known to Maddux as relation algebra 2565, [Mad06]. A strong representation of it is illustrated on the right.\n; 1\u2032 a b c 1\u2032 1\u2032 a b c a a 1\u2032 c b b b c 1\u2032 a c c b a 1\u2032\n1 2\n3\n0\na\nc\nb\na\nc\nb\nThis algebra happens to be associative (hence a relation algebra). The only consistent triples of non-identity atoms are the permutations of (a, b, c). If we restrict the base to a set of three elements, say {1, 2, 3}, we obtain a different qualitative representation, no longer a strong representation because although 1\u2032 = c; c and (2, 2) is in the representation of 1\u2032, there is no point v in the base {1, 2, 3} such that (2, v) and (v, 2) are in the representation of c. This relation algebra can have no qualitative representation, nor even a feeble representation, on a base of more than four points, because it is impossible to colour the edges of K5 using three colours, a, b, c, while avoiding triangles with two edges of the same colour. In fact the two qualitative representations just mentioned are the only qualitative representations of this relation algebra, up to base isomorphism. (4) Our next example is a non-associative algebra which does not have a qualitative representation, though it has a feeble one. Its atoms are {e, e\u2032, a, a }\u0306, 1\u2032 = e+ e\u2032 and composition is given by\n; e e\u2032 a a\u02d8 e e 0 a 0 e\u2032 0 e\u2032 0 a\u02d8 a 0 a a a+ a\u02d8+ e a\u02d8 a\u02d8 0 a+ a\u02d8+ e\u2032 a\u02d8\nBy Lemma 5 this is the atom structure of a non-associative algebra (not associative because a = a; a = (a; e\u2032); a 6= a; (e\u2032; a) = a; 0 = 0). A feeble representation \u03b8 on the points 0, 1 is shown below\n0 1\na\u02d8\na\ne e\u2032\nIf \u03c6 were a qualitative representation then since a; a \u00b7 a 6= 0 there would be x, y, z in the base such that (x, y), (y, z), (x, z) \u2208 a\u03c6 and (y, y) \u2208 (1\u2032)\u03c6. Since 1\u2032 = e + e\u2032 either (y, y) \u2208 e\u03c6 or (y, y) \u2208 (e\u2032)\u03c6, in the former case (x, y) \u2208 a\u03c6 \u25e6 e\u03c6 \u2286 (a; e)\u03c6 = 0\u03c6 and in the latter case (y, z) \u2208 (e\u2032; a)\u03c6 = 0\u03c6, in each case we get a contradiction. (5) Examples of relation algebras not even possessing feeble representations are provided in the proof of Theorem 19 below. (6) This example shows that associativity does not suffice to ensure a qualitatively representable algebra has a strong representation. Let K be McKenzie\u2019s non-representable algebra (see [McK70]). It is defined by the following multiplication table for the atoms\n; 1\u2032 a a\u02d8 b 1\u2032 1\u2032 a a\u02d8 b a a a 1 a+ b a\u02d8 a\u02d8 1 a\u02d8 a\u02d8+ b b b a+ b a\u02d8+ b \u2212b\n\u2022\n\u2022\n88\u2663\u2663\u2663\u2663\u2663\u2663\n\u2022\n^^\u2742\u2742\u2742\u2742\u2742\u2742\u2742\u2742\n\u2022\nOO\n\u2022\nff\u25c6\u25c6\u25c6\u25c6\u25c6\u25c6 @@\u2701\u2701\u2701\u2701\u2701\u2701\u2701\u2701\nwhere b\u0306 = b. As McKenzie showed, it is associative but has no strong representation. Let N5 be the pentagon lattice considered as an ordered set, illustrated in the right above. It is easy to show that boolean combinations of the relations Id, <, >, # (where # stands for incomparability), form a herd over N5 \u00d7 N5, and the map 1\n\u2032 7\u2192 Id, a 7\u2192 <, a\u02d8 7\u2192 >, b 7\u2192 #, extends naturally to a qualitative representation of K. We leave it as an instructive exercise to prove that no qualitative representation can exist over a set with 4 or fewer elements. (Hint: you have to be able to compose incomparability with itself and get < and >.) (7) Our final example is an infinite relation algebra, for expressing metric constraints on a linearly ordered metric space. Its elements are finite unions of real intervals, e.g. (2, 5) \u222a [6, 8]. There is one identity atom, namely [0, 0], converse is defined by (m,n)\u0306 = (\u2212n,\u2212m), and composition is defined by (m,n); (m\u2032, n\u2032) = (m +m\u2032, n + n\u2032) for m > n, m\u2032 > n\u2032, with similar definitions for closed and semi-open intervals. A strong representation \u03b8 over the real numbers may be obtained by letting (x, y) \u2208 (m,n)\u03b8 \u21d0\u21d2 m < y\u2212x < n, with similar definitions for closed and semi-open intervals. This provides a useful way of expressing metric constraints between points, e.g. the constraint (x, y) \u2208 ([\u22123,\u22122] \u222a [2, 3])\u03b8 means that the distance between x and y is at least two and not more than three."}, {"heading": "4. Semi-associativity and associativity", "text": "In order to axiomatise the class of qualitatively representable algebras we might start by taking the axioms of non-associative relation algebra and add some weakening of the associativity law. Maddux defines two such weakenings: the semiassociative law x ; (1 ; 1) = (x ; 1) ; 1 and the weak-asociativity law [Mad82] (x \u00b7 1\u2032) ; (1 ; 1) = ((x \u00b7 1\u2032) ; 1) ; 1. In the definition of the qualitative calculus given by [LR04] the identity 1\u2032 is required to be an atom and for this case the weak associativity law is sure to hold (since x \u00b7 1\u2032 is either 0 or 1\u2032) as shown in [WHW14, Section 3]. However, when we consider cases where the identity is not an atom, we see that the algebra of Examples 6.1 above fails the weak associativity law (and consequently also fails the stronger semi-associativity law) because (e ; 1) ; 1 = (e + d) ; 1 = 1 but e ; (1 ; 1) = e ; 1 = e + d, so weak associativity is not valid over qualitative representations. On the other hand, since (a; b)\u03b8 \u2287 a\u03b8 \u25e6 b\u03b8, for any qualitative (or feeble) representation \u03b8 over domain D, it follows that the equation\n(1 ; x) ; 1 = 1 ; (x ; 1)\nis an example of a validity over qualitative (respectively, feeble) representations (in any herd on base D, both sides equal 1 = D\u00d7D if x 6= 0 and both sides equal 0 if x = 0).\nAn algebra is integral if x ; y = 0 \u2192 x = 0 or y = 0. It is known for semiassociative algebras that an algebra is integral iff the identity is an atom [Mad90, Theorem 4]. However, in the algebra of Example 6.2 above, the identity is an atom but the algebra is not integral. It follows that this algebra is not semi-associative, indeed d ; 1 = 1\u2032 + d+ f but (d ; 1) ; 1 = 1.\nSemi-associativity for weak composition was touched upon in [LR04] where it was shown that if relations are serial (have total domains) then the weak composition is semi-associative. In fact, in our more general setting where the identity need not be an atom, it suffices to assume that nonempty relations have pairwise overlapping domains.\nLEMMA 7. Let \u03c6 be a qualitative representation of a non-associative algebra A to a herd S. Then, the following are equivalent :\n(1) If a, b \u2208 A \\ {0} then (a\u03c6)\u0306 \u25e6 b\u03c6 6= \u2205 (nonempty relations have overlapping domains), (2) A is integral, (3) A is semi-associative and the identity is an atom.\nProof. As we noted, in semi-associative algebras integrality is equivalent to the identity being an atom so we get (3) \u21d2 (2). To prove (2) \u21d2 (3) we will show that integrality implies semi-associativity in non-associative algebras. Working backwards, suppose semi-associativity fails in A. By monotonicity of composition in non-associative algebras, since 1\u2032 \u2264 1, we have x ; (1 ; 1) = x ; 1 \u2264 (x ; 1) ; 1, for any x \u2208 A. Thus, the failure of semi-associativity is witnessed by some 0 6= a \u2208 A such that a ; 1 < (a; 1); 1. So, there is (a; 1); 1 \u2265 b 6= 0 such that a ; 1 \u00b7 b = 0. But then, a\u0306 ; b \u00b7 1 = 0 by the Peircean law, and so a\u0306 ; b = 0 where a\u0306 , b 6= 0 and the algebra is not integral. Thus the equivalence of (2) and (3) is true in any non-associative algebra.\nTo prove the equivalence of (2) and (1), observe that a = 0 \u21d0\u21d2 a\u0306 = 0 and (a\u0306 )\u03c6 \u25e6 b\u03c6 = \u2205 \u21d0\u21d2 (a\u0306 ; b)\u03c6 = \u2205 \u21d0\u21d2 a\u0306 ; b = 0, using the fact that c = a\u0306 ; b is the minimal solution of c\u03c6 \u2287 (a\u0306 )\u03c6 \u25e6 b\u03c6.\nLet A be a non-associative algebra, and \u03c6 be a qualitative representation, i.e. a map from A to P(D \u00d7D) for some set D satisfying the conditions of Definition 2. Consider the following condition on \u03c6:\n(*) (a\u03c6 \u25e6 b\u03c6) \u2229 (c\u03c6 \u25e6 d\u03c6) = \u2205 \u21d0\u21d2 (a ; b) \u00b7 (c ; d) = 0.\nIntuitively, (*) says that two consistent triangles share a label (the right-hand side) if and only if a quadrangle witnessing this fact can be found in the representation (the left-hand side). Observe that the right-to-left implication holds for any qualitative representation \u03c6, since (x; y)\u03c6 \u2287 x\u03c6 \u25e6 y\u03c6.\nTHEOREM 8. If there exists a qualitative representation of A satisfying (*), then A is associative.\nProof. To prove associativity, let a, b, c, d \u2208 A be arbitrary. Then\n((a ; b) ; c) \u00b7 d = 0 \u21d0\u21d2 (a ; b) \u00b7 (d ; c\u0306 ) = 0 by Peircean law for ;\n\u21d0\u21d2 (a\u03c6 \u25e6 b\u03c6) \u2229 (d\u03c6 \u25e6 c\u0306 \u03c6) = \u2205 (*)\n\u21d0\u21d2 ((a\u03c6 \u25e6 b\u03c6) \u25e6 c\u03c6) \u2229 d\u03c6 = \u2205 Peircean law for \u25e6\n\u21d0\u21d2 (a\u03c6 \u25e6 (b\u03c6 \u25e6 c\u03c6)) \u2229 d\u03c6 = \u2205 associativity of \u25e6\n\u21d0\u21d2 (b\u03c6 \u25e6 c\u03c6) \u2229 (a\u0306 \u03c6 \u25e6 d\u03c6) = \u2205 Peircean law for \u25e6\n\u21d0\u21d2 (b; c) \u00b7 (a\u0306 ; d) = 0 (*)\n\u21d0\u21d2 (a ; (b ; c)) \u00b7 d = 0 Peircean law for ;\nSince d is arbitrary it follows that (a; b); c = a; (b; c).\nObserve that the McKenzie algebraK is associative, but its qualitative representation of over the baseN5 does not satisfy (*), because we have (#\u25e6<)\u2229(#\u25e6>) = \u2205 whereas (b ; a) \u00b7 (b ; a\u0306 ) = b. However, there is a qualitative representation of K satisfying (*), for example over the base D = {\u22a5, a1, b1, c1, a2, b2, c2,\u22a4} with < defined as the transitive closure of \u22a5 < a1 < b1 < c1 < \u22a4, \u22a5 < a2 < b2 < c2 < \u22a4. The following conjecture remains open: if A is associative and has a qualitative representation then it has a qualitative representation satisfying (*)."}, {"heading": "5. Network Satisfaction Problem", "text": "DEFINITION 9. Let A be a non-associative algebra. A network (N, \u03bb) over A consists of a finite set N of nodes and a function \u03bb : (N \u00d7 N) \u2192 A. A network (N, \u03bb) is consistent if\n(a) \u03bb(x, x) \u2264 1\u2032, (b) \u03bb(x, y) ; \u03bb(y, z) \u00b7 \u03bb(x, z) 6= 0, for all nodes x, y, z \u2208 N , (c) \u03bb(x, y) \u00b7 \u03bb(y, x)\u0306 6= 0, (d) \u03bb(x, y) 6= 0, for all nodes x, y \u2208 N .\nA network (N, \u03bb) is path-consistent (or algebraically closed) if it is consistent and additionally \u03bb(x, y);\u03bb(y, z) \u2265 \u03bb(x, z), for all x, y, z \u2208 N . An atomic network (N, \u03bb) is a network where \u03bb(x, y) is always an atom of A. Every consistent atomic network is path-consistent.\nA network (N, \u03bb) embeds into a strong representation \u03c6 if there is a map \u2032 from N to the base of \u03c6 such that for all x, y \u2208 N we have (x\u2032, y\u2032) \u2208 \u03bb(x, y)\u03c6, similarly (N, \u03bb) embeds into a qualitative representation \u03b8 if there is a map \u2032 from N to the base of a qualitative representation \u03b8 such that for all x, y \u2208 N we have (x\u2032, y\u2032) \u2208 \u03bb(x, y)\u03b8. A network over A is strongly satisfiable if it embeds into some strong representation of A and it is qualitatively satisfiable if it embeds into some qualitative representation of A. Clearly, if (N, \u03bb) is strongly satisfiable then it is qualitatively satisfiable.\nA strong representation \u03c6 of the finite relation algebra A is universal if every consistent atomic network embeds into \u03c6.\nNote that the conditions (c) and (d) for a consistent network follow from (a) and (b) (see [HH02, Lemma 7.2]), so we could have left them out of the definition, but since they are naturally expected nonetheless, we decided to keep them in. Our definition of a consistent network coincides with what Hirsch and Hodkinson [HH02] call a network. We believe this less restrictive definition of a network (essentially, just as a labelled complete directed graph) to be more convenient in the present context as it is closer to the standard terminology used in the area of qualitative calculi as well as in constraint satisfaction.\nREMARK 10. Conisider the non-associative algebra of Example 6.1. It has a qualitative representation, but since it is not associative it can have no strong representation. The network shown in Example 6.1 is qualitatively satisfiable but not strongly satisfiable.\nLet A be an atomic relation algebra. If A has a universal representation then any network is qualitatively satisfiable iff it is strongly satisfiable. It is known that the point and interval algebras have universal representations [LM94] and it follows from results in [BW11] that RCC8 has a universal representation, hence for these three relation algebras a network is strongly satisfiable iff it is qualitatively satisfiable.\nLEMMA 11. Let A be a finite non-associative algebra. A has a qualitative representation if and only if there is a consistent atomic network (N, \u03bb) over A such that for each consistent triple of atoms (a, b, c) of A there are nodes x, y, z \u2208 N such that \u03bb(x, y) = a, \u03bb(y, z) = b and \u03bb(x, z) = c.\nProof. Let \u03c6 be a qualitative representation over base D. For each x, y \u2208 D let \u03bb(x, y) be the (unique) atom a such that (x, y) \u2208 a\u03c6, such an atom must exist since A is finite. Clearly (D,\u03bb) is consistent and atomic, though it might be infinite. Furthermore, if a, b, c are atoms such that a ; b \u2265 c then there must be x, y, z with \u03bb(x, y) = a, \u03bb(y, z) = b and \u03bb(x, z) = c, by Lemma 3. Hence there is a finite subset D0 \u2286 D such that the restriction of \u03bb to D0 is atomic, consistent and therefore an atomic network, and still witnesses all triples of atoms,\nConversely, if (N, \u03bb) is a consistent atomic network witnessing all consistent triples of atoms then the binary relation \u223c over the nodes of N defined by x \u223c y \u21d0\u21d2 N(x, y) \u2264 1\u2032 is easily seen to be an equivalence relation, indeed a congruence. The equivalence class of a node x is denoted [x]. We may define a qualitative representation \u03c6 whose base is the set of all \u223c-equivalence classes, by\na\u03c6 = {([x], [y]) : N(x, y) \u2264 a}\nfor a \u2208 A. Since \u223c is a congruence \u03c6 is well-defined, since edges are labelled by atoms \u03c6 respects the boolean operators, since the network is consistent it is clear that \u03c6 respects the converse operator, and since N(x, y) \u2264 1\u2032 \u21d0\u21d2 [x] = [y] the identity is correctly represented. By Lemma 3, \u03c6 is a qualitative representation.\nLEMMA 12. If A is a finite, qualitatively representable, atomic non-associative algebra then A has a qualitative representation with at most 3|At(A)|3 points in its base.\nProof. By the previous lemma, if A is qualitatively representable then there is a consistent atomic network witnessing all consistent triples of atoms. There are at most |At(A)|3 such triples, so 3|At(A)|3 points suffice to witness them all. The atomic network defined by restricting to this set of up to 3|At(A)|3 points is consistent and still witnesses all consistent triples of atoms, hence it defines a qualitative representation of the required size, by the proof of the right to left implication of Lemma 11.\nThe upper bound of Lemma 12 seems to overestimate the necessary size of a qualitative representation rather largely. Although we will not try to provide a sharper bound here, we will present an illustrative example. Consider RCC5: a version of RCC8 with no distinction between \u201ctangential\u201d and \u201cnon-tangential\u201d connectedness. Its composition table is\n; 1\u2032 \u03b5 \u03b5\u0306 \u03c0 \u03b4 1\u2032 1\u2032 \u03b5 \u03b5\u0306 \u03c0 \u03b4 \u03b5 \u03b5 \u03b5 1 \u03b5+ \u03c0 + \u03b4 \u03b4 \u03b5\u0306 \u03b5\u0306 1\u2032 + \u03b5+ \u03b5\u0306 + \u03c0 \u03b5\u0306 \u03b5\u0306 + \u03c0 \u03b5\u0306 + \u03c0 + \u03b4 \u03c0 \u03c0 \u03b5+ \u03c0 \u03b5\u0306 + \u03c0 + \u03b4 1 \u03b5\u0306 + \u03c0 + \u03b4 \u03b4 \u03b4 \u03b5+ \u03c0 + \u03b4 \u03b4 \u03b5+ \u03c0 + \u03b4 1\nwith \u03b5, \u03c0 and \u03b4 interpreted intuitively as proper part, proper overlap, and disjointness relations, respectively. This algebra has a qualitative representation over a base consisting of just eleven \u201cregions\u201d, namely, the following subsets of {1, . . . , 7}:\nA = {1, 6} B = {1, 2, 3, 5, 6} C = {1, 2, 6}\nD = {1, 2, 3, 5, 6, 7} E = {1} F = {1, 2, 3, 5}\nG = {2, 3} H = {1, 4, 6} I = {1, 3}\nJ = {1, 2, 3, 4, 5} K = {4, 5, 6}\nwith the relations \u03b5, \u03c0 and \u03b4 mapped, respectively, to proper subset relation, nonempty symmetric difference relation, and empty intersection relation.\nWe conjecture that our representation on the 11 regions A, . . . ,K is the smallest number of regions possible for a qualitative representation of RCC5.\nREMARK 13. The study of syllogistics [Aristotle, prior analytics] can be described using RCC5. Namely, setting:\nEvery S is P iff (S, P ) \u2208 1\u2032 + \u03b5\nSome S is P iff (S, P ) \u2208 1\u2032 + \u03b5+ \u03b5\u02d8+ \u03c0\nNo S is P iff (S, P ) \u2208 \u03b4\nSome S is not P iff (S, P ) \u2208 \u03b5\u02d8+ \u03c0 + \u03b4\nwe obtain a faithful interpretation of traditional logic of categorical propositions.\nWe turn to questions of computational complexity. We say that a finite atom structure has a qualitative representation if its complex algebra has one. We begin with a result that contrasts with the corresponding question for strong representations which is known to be undecidable [HH01b].\nTHEOREM 14. The problem of determining whether a finite atom structure has a qualitative representation is NP-complete.\nProof. If a finite atom structure with n atoms has a qualitative representation then, by Lemma 12, it has a qualitative representation of size at most 3n3. Hence a non-deterministic algorithm may simply construct a base with up to 3n3 points and guess an atom between each pair of points, then check to see if the resulting network is consistent and that every triple of atoms is witnessed (see Lemma 11). Since the run-time of this non-deterministic algorithm is bounded by a polynomial function, we conclude that the qualitative representation problem is in NP.\nFor NP-hardness, we reduce the 3-colour graph vertex problem for finite graphs. Let G = (V,E) be a finite graph with vertices V and directed edges E, where this edge set is symmetric and irreflexive. Cases where E = \u2205 are trivially 1-colourable, so we assume E 6= \u2205. If we extend G by adding some isolated vertices to V it will not affect the 3-colourability of the graph, so we assume that G has an independent set of size 5 (formally, there are v0, v1, . . . , v4 \u2208 V such that (vi, vj) 6\u2208 E, for i, j < 5) and a triangle containing one edge and two non-edges (there are u, v, w \u2208 V such that (u, v) \u2208 E but (u,w), (v, w) 6\u2208 E). Next, we extend G to G\u221e = (V \u221e,E\u221e), by adding a single node connected to all the nodes of V , i.e. V \u221e = V \u222a {\u221e}, E\u221e = E \u222a {(\u221e, u), (u,\u221e) : u \u2208 V }, where \u221e 6\u2208 V . It is clear that G\u221e is 4-colourable if and only if G is 3-colourable. Because G has an independent set of size 5, any 4- colouring of G\u221e must include non-adjacent nodes of the same colour, and because of the triangle with one edge and two non-edges any colouring must include nonadjacent nodes of different colours.\nWe define a non-associative atom structure (S,E, ,\u0306 C) as follows. The set of atoms is\nS = {1\u2032} \u222a SGG \u222a SCC \u222a SGC \u222a SCG\nwhere SGG = {suv : (u, v) \u2208 E \u221e}\u222a{g} (graph atoms, here g is a symbol not appearing in V \u221e, used for non-edges), SCC = {a, b, c} (colouring atoms), SGC = {y, n} (used to map graph nodes to colours) and SCG = {y\u0306 , n\u0306 } (the converses of SGC). The identity is an atom E = {1\u2032}, and all atoms are self-converse except suv\u02d8 = svu and the converses of y, n are y\u0306 , n\u0306 respectively. [The intention here is that atoms suv will be used to encode the edges (u, v) of the graph G\u221e, g (\u201cgap\u201d) corresponds to non-edges and the atoms a, b, c \u2208 SCC will encode the undirected edges of a graph with no more than four nodes (see Examples 6.3) and these nodes will represent distinct colours. y, y\u0306 (\u201cyes\u201d) and n, n\u0306 (\u201cno\u201d) will be used to connect this set of up to four nodes to the nodes of G\u221e while encoding a legitimate 4-colouring. A schematic of the desired qualitative representation is shown in Figure 3.]\nAll Peircean transforms of the following triples of atoms are forbidden.\n(I) (1\u2032, x, y) where x 6= y, (identity law) (II) (\u03b1, \u03b2, \u03b3), where \u03b1 \u2208 SIJ , \u03b2 \u2208 SJ\u2032K\u2032 and \u03b3 \u2208 SI\u2217K\u2217 , unless I = I\n\u2217, J = J \u2032, K \u2032 = K\u2217 (\u2208 {G,C}) (types must match),\n(III) (\u03b1, \u03b1, \u03b2) where \u03b1, \u03b2 \u2208 SCC , (see Examples 6.3, only permutations of the triple (a, b, c) are consistent for SCC atoms),\n(IV) (suv, sv\u2032w\u2032 , \u03b1) where (u, v), (v \u2032, w\u2032) \u2208 E\u221e, unless v = v\u2032 (node indices must\nmatch), (V) (suv, svw, g) where (u, v), (v, w) \u2208 E\n\u221e and either (u,w) \u2208 E\u221e or u = w, (g only allowed on non-edges),\n(VI) (s\u221eu, \u03b1, g) where u \u2208 V, \u03b1 \u2208 SGG (\u221e adjacent to all other nodes), (VII) (y, \u03b1, y) where \u03b1 \u2208 SCC (only one colour per node) (VIII) (suv, y, y) where (u, v) \u2208 E \u221e (adjacent nodes have different colours)\nThe set C of consistent triples of atoms consists of all triples not forbidden by (I)\u2013(VIII), above.\nThe reduction maps (V,E) to the atom structure (S,E, ,\u0306 C) just defined. We check that this reduction is correct. Suppose \u03c1 is a 4-colouring of the vertices of G\u221e such that adjacent nodes have different colours, there are non-adjacent nodes of the same colour and non-adjacent nodes of different colours. Let the colours be \u03b31, \u03b32, \u03b33, \u03b34. We define an atomic network (N, \u03bb) where N = V\n\u221e \u222a{\u03b31, \u03b32, \u03b33, \u03b34}. For the labelling \u03bb we let \u03bb(x, x) = 1\u2032 (all x \u2208 N), \u03bb(u, v) = suv for (u, v) \u2208 E\n\u221e, \u03bb(u, v) = g if u 6= v \u2208 V\u221e, (u, v) /\u2208 E. As in the strong representation for Examples 6.3, let \u03bb(\u03b31, \u03b32) = \u03bb(\u03b33, \u03b34) = a, \u03bb(\u03b31, \u03b33) = \u03bb(\u03b32, \u03b34) = b, \u03bb(\u03b31, \u03b34) = \u03bb(\u03b32, \u03b33) = c and \u03bb(\u03b3j , \u03b3i) = \u03bb(\u03b3i, \u03b3j) for 1 \u2264 i < j \u2264 4. Finally, for each u \u2208 V \u221e and for 1 \u2264 i \u2264 4, let \u03bb(v, \u03b3i) = y if \u03c1(v) = \u03b3i else (if \u03c1(v) 6= \u03b3i) \u03bb(v, \u03b3i) = n. The atoms y\u0306 and n\u0306 are used to label the converse edges for edges labelled y, n respectively. It is a routine check that this defines a consistent atomic network. Since there are non-adjacent nodes of the same colour the triple (g, y, y) is witnessed\nand since there are non-adjacent nodes of different colours (g, y, n) and (g, n, y) are also witnessed. It is easily checked that all other consistent triples of atoms are also witnessed hence, by Lemma 11, the complex algebra over (S,E, ,\u0306 C) is qualitatively representable.\nFor the converse, let (N, \u03bb) be any complete, consistent atomic network witnessing each consistent triple and containing no forbidden triples for the atom structure (S,E, ,\u0306 C): in other words, (N, \u03bb) provides a qualitative representation of (S,E, ,\u0306 C). We show that G\u221e is 4-colourable, hence G is 3-colourable. By forbidden triple II, a triple (\u03b1, \u03b2, \u03b3) is forbidden if exactly one or all three of \u03b1, \u03b2, \u03b3 belongs to SGC \u222a SCG. Hence the edges labelled by atoms in SGC \u222a SCG = {y, y\u0306 , n, n\u0306 } form a complete bipartite graph on N , say N is the disjoint union of N1 and N2. By forbidden triple II again, every edge with source in N1 (say) and target in N2 has a label in SGC , every edge with source in N2 and target in N1 has a label in SCG, edges with source and target within N1 have label in {1\n\u2032} \u222a SGG and edges with source and target in N2 have label in {1\n\u2032} \u222a SCC . Now we show that |N1| = |V\n\u221e| and that the labels suv define a graph on N1 isomorphic to G\u221e. Let u \u2208 V and let \u221e\u2032, u\u2032 \u2208 N1 denote the source and target of some edge labelled by s\u221eu. For each x \u2208 N1 \\ {\u221e\n\u2032} the edge (\u221e\u2032, x) must be labelled by s\u221ev for some v \u2208 V by forbidden triples II, IV and VI, and if (\u221e\n\u2032, y) is also labelled by s\u221e\u2032v then x = y by forbidden triple V. Hence there is a bijection \u2032 : V \u221e \u2192 N1 mapping \u221e to \u221e\n\u2032 and mapping v \u2208 V to the unique v\u2032 \u2208 N1 such that (\u221e\u2032, v\u2032) is labelled s\u221ev. So we may assume that N1 is identical to the set V\n\u221e, and that the label of each edge (\u221e, w) (for w \u2208 V ) is s\u221ew. By forbidden triples IV and V we see that the label of the edge (u, v) is suv if (u, v) \u2208 E, 1\n\u2032 if u = v and g otherwise. By forbidden triple III, N2 cannot have more than four points, (we saw in Examples 6.3 that N2 has either three or four points).\nLet u \u2208 N1. As (y, y, \u03b1) is always forbidden by VII, there is at most one edge labelled y leaving u and because (svu, y, n) is consistent and the edge labelled svu is unique (where (u, v) \u2208 E), there is exactly one edge labelled y leaving u. Thus, we may define a map \u03c1 : V \u221e \u2192 N2 by letting \u03c1(u) be the unique element of N2 such \u03bb(u, \u03c1(u)) = y, for each u \u2208 V \u221e = N1. Since (suv, y, y) is forbidden by VIII whenever (u, v) \u2208 E\u221e, \u03c1 is a valid 4-colouring of G\u221e.\nTHEOREM 15. Let A be a finite non-associative algebra. The network qualitative satisfaction problem over A is in NP.\nProof. For each consistent triple of atoms t, let (Tt, \u03bbt) be a partially labelled atomic network with three nodes, witnessing the triple of atoms. Assume for distinct consistent triples t, s that Tt\u2229Ts = \u2205. Given a network (N, \u03bb), take the disjoint union of (N, \u03bb) and the disjoint partial triangles (Tt, \u03bbt) as t ranges over consistent triples of atoms. Then, non-deterministically guess all unlabelled edges and for each edge (x, y) of N , guess an atom below \u03bb(x, y). Finally check that the resulting atomic network is consistent. By Lemma 11, this correctly tests qualitative satisfiability and runs non-deterministically in polynomial time.\nA traditional approach to solving the network satisfaction problem (for strong representations) is to refine a given network to a path consistent network on the same nodes. This path-consistent refinement may be computed deterministically in cubic time. If the refined network is inconsistent (has a zero label) then the original network is unsatisfiable. There are some algebras where the converse also\nholds \u2014 if the refined network is consistent then the original network must be satisfiable \u2014 for example, path-consistency entails satisfiability for networks over the Point Algebra [VKvB89, Theorem 5]. However, for many relation algebras the converse fails, for example, there are known path-consistent but unsatisfiable networks over the Allen Interval Algebra [All83, Figure 5]. The Allen Interval algebra possesses a universal representation (see Definition 9), so the satisfiability of a network may be tested along the lines of the proof of the preceding theorem, by non-deterministically picking an atom below the label of each edge of the network and checking the consistency of the resulting atomic refinement. Such satisfiability checkers may run faster if a network is first refined to a path-consistent network, before the non-deterministic choice of atoms is made. For algebras which do not have universal representations however, it is not sufficient to find a consistent atomic refinement of a network, for example, there are consistent atomic networks over the interval-with-duration calculus INDU, not satisfiable in any strong representation (see our remarks in Section 1.1). Indeed there are finite relation algebras for which the network satisfaction problem is undecidable [Hir99].\nNevertheless, for qualitative representations the non-deterministic algorithm given in the preceding theorem is necessary and sufficient for qualitative representability. Hence in general the network qualitative satisfaction problem can have much lower complexity than the network satisfaction problem.\nTHEOREM 16. The problem of determining whether an equation is valid over qualitative representations is co-NP-complete.\nProof. Let t(x\u0304) = s(x\u0304) be an equation that fails in some herd S, where x\u0304 = (x0, . . . , xk\u22121) is a finite tuple of variables. Then t(a\u0304)\nS 6= s(a\u0304)S holds for some tuple a\u0304 = (a0, . . . , ak\u22121) of relations in the herd S and there is a pair of points x, y from the base of S such that (x, y) belongs to one but not the other of t(a\u0304)S and s(a\u0304)S . Let X be a finite subset of the base of S including x and y and also including, for each subterm p; q occuring in either s or t, three points u, v, w such that (u, v) \u2208 p and (v, w) \u2208 q, provided such points exist in the base of S. The size of X is at most three times the length of the equation t(x\u0304) = s(x\u0304). Let S\u21beX be the herd on the base X consisting of the relations {r \u2229 (X \u00d7X) : r \u2208 S}. Lemma 3 and a simple induction shows that (u, v) \u2208 p(a0, . . . , ak\u22121)\nS \u21d0\u21d2 (u, v) \u2208 p(a0 \u2229 (X \u00d7 X), . . . , ak\u22121 \u2229 (X \u00d7 X))\nS\u21beX , for any u, v \u2208 X and any subterm p(x\u0304) of either t(x\u0304) or s(x\u0304). Hence (x, y) belongs to one but not the other of t(a0 \u2229 (X \u00d7X), . . . , ak\u22121 \u2229 (X \u00d7X)) S\u21beX , s(a0 \u2229 (X \u00d7X), . . . , ak\u22121 \u2229 (X \u00d7X)) S\u21beX and the equations t(x\u0304) = s(x\u0304) fails in a herd on a base of size at most three times the length of the equation. Thus, the failure of the equation may be tested nondeterministically by choosing a base of size at most three times the length of the equation, guessing which pairs of points belong to each of the relations x0, . . . , xk\u22121 and verifying that the equation fails. This proves that the validity of equations problem is co-NP.\nValidity is co-NP-hard because the validity problem for propositional formulas reduces to it.\nThe reader has probably guessed, or knows already, that the corresponding problem for strongly representable relation algebras is much harder: the equational theory of strongly representable relation algebras is undecidable [Tar41]."}, {"heading": "6. Feeble representations", "text": "We mentioned earlier that [LR04, Definition 3] only requires (a; b)\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6 in their definition of weak composition, and do not insist on minimality subject to that (although elsewhere in their paper they imply a definition which accords with our definition of qualitative representation, see Definition 2.4). In this section we investigate this weaker type of representability. Although qualitative representations are of greater relevance to much of the literature in qualitative calculi, feeble representations are more directly related to research on the binary constraint satisfaction problem, where for any constraints a, b and a solution for variables x, y, z, we may infer from a(x, y), b(y, z) that (a\u25e6 b)(x, z) holds, but there is no requirement, given (a \u25e6 b)(x, z), that there should be three variables x\u2032, y\u2032, z\u2032 such that a(x\u2032, y\u2032) and b(y\u2032, z\u2032).\nLet A be a non-associative algebra and let \u03c6 : A \u2192 \u2118(D \u00d7 D) (some base D) respect the boolean operators, represent 1\u2032 as the identity and respect the converse operator. If (a; b)\u03c6 \u2287 a\u03c6 \u25e6 b\u03c6 (for all a, b \u2208 A) then \u03c6 is called a feeble qualitative representation, or simply a feeble representation, of A. The proof of the following lemma is very similar to the proof of Lemma 11.\nLEMMA 17. Let A be a finite non-associative algebra. A has a feeble representation if and only if there is a consistent atomic network (N, \u03bb) over A such that for every atom a of A there are x, y \u2208 N with \u03bb(x, y) = a.\nIn a feeble representation of a finite algebra, instead of requiring a witness for each consistent triple of atoms, we only require a witness for each each single atom, while avoiding any forbidden triple of atoms.\nOne obvious shortcoming of this notion is that a feeble representation of an algebra A does not determine A, because some consistent triples may be absent in the representation. Indeed, we saw that the herd on a base of two points shown in the second part of Example 6.1 provides a feeble representation of two nonisomorphic non-associative algebras: the algebra of Example 6.1 and the algebra of Example 6.4. Unfortunately, the complexity of the feeble representation problem remains the same as that of the qualitative representation problem.\nTHEOREM 18. The problem of determining whether a finite atom structure has a feeble representation is NP-complete.\nProof. If a finite atom structure with n atoms has a feeble representation then we may restrict the base to a set of at most 2n points so that all atoms are still witnessed in the restriction, hence the atom structure has a feeble representation of size at most 2n. Thus, a non-deterministic algorithm may guess an atomic labelling over a set of at most 2n points and check if the labelling defines a feeble representation. So the feeble representation problem is in NP.\nFor NP-hardness, we reduce the Monochromatic Triangle problem for finite graphs. Let G = (V,E) be a finite graph with vertices V and directed, irreflexive, symmetric edges E (i.e. (u, v) \u2208 E \u21d0\u21d2 (v, u) \u2208 E). The Monochromatic Triangle problem asks if there is a 2-colouring of the edges, that is, a symmetric function \u03c1 : E \u2192 {r, b} such that \u03c1 is not constant over the three edges of any triangle of the graph. This problem is known to be NP-complete, see [GJ79, p. 191]. Any complete graph with six or more nodes is a no instance, hence we will only consider instances of this problem containing at least one non-edge.\nGiven a symmetric, irreflexive graph G = (V,E), we define a non-associative atom structure (S,E, ,\u0306 C) as follows.\nS = {1\u2032} \u222a {\u00d7} \u222a SGG \u222a S\u221eG \u222a SG\u221e\nwhere SGG = {cuv : c \u2208 {r, b}, (u, v) \u2208 E} \u222a {g}, S\u221eG = {pu, qu : u \u2208 V } and SG\u221e = {p\u0306 u, q\u0306 u : u \u2208 V }. The identity is an atom E = {1\n\u2032} and converse is defined by cuv\u02d8 = cvu (for any c \u2208 {r, b} and (u, v) \u2208 E) , the converses of pu, qu are p\u0306 u, q\u0306 u and 1\n\u2032,\u00d7, g are self-converse. Let C consist of all triples of atoms except for Peircean transforms of the following forbidden triples of atoms.\n(I) (1\u2032, x, y), where x 6= y, (II) (\u00d7,\u00d7,\u00d7) and (\u00d7, \u03b1, \u03b2), where \u00d7 6\u2208 {\u03b1, \u03b2}, (III) (\u03b1, \u03b2, \u03b3) where \u03b1 \u2208 SIJ , \u03b2 \u2208 SJ\u2032K and any atom \u03b3, unless J = J\n\u2032, (IV) (pu, cu1v, pv1), (qu, cu1v, qv), any c \u2208 {r, b} any u, u1, v, v1 \u2208 V , unless\nu = u1 and v = v1, (V) (pu, g, pv), (qu, g, qv), where (u, v) \u2208 E or u = v, (VI) (pu, \u03b1, qv), for any atom \u03b1 and any u, v \u2208 V , (VII) (cuv, cvw, cuw), any c \u2208 {r, b} and any u, v, w \u2208 V .\nNote that the set of atoms does not include a subset S\u221e\u221e, so triples III and II forbid all triples of non-identity atoms of the form (\u03b1, \u03b2, \u03b3) where \u03b1 \u2208 S\u221eG and \u03b2 \u2208 SG\u221e, thus pu; p\u0306 v equals 1\n\u2032 if u = v else it is zero, for all u, v \u2208 V . Also, there are no atoms cuu for c \u2208 {r, b} since (u, u) 6\u2208 E, so by forbidden triples II, III IV, V we have p\u0306 u; pu = 1 \u2032. Similarly qu; q\u0306 v \u2264 1 \u2032 and q\u0306 u; qu = 1 \u2032.\nThe reduction maps (V,E) to the complex algebra of the atom structure (S,E, ,\u0306 C) just defined. Before we prove the correctness of this reduction, we mention the intended roles of the atoms. Given any consistent, atomic network witnessing all atoms, the atom \u00d7 will define a bipartite edge relation over the set of nodes of the network (as in Examples 6.2). Each part of the network contains a copy of the graph together with a single auxiliary node and will encode a valid colouring of the graph, with atoms ruv and buv encoding edges coloured red and blue, respectively, while g (\u201cgap\u201d) corresponds to non-edges. The atom pu labels the edge from the auxiliary node to u in one part of the network while the atom qu is used in the other part. They are used to ensure that the encoding describes the way edges fit together correctly. Conversely, given an arbitrary edge colouring of G there is dual colouring obtained by swapping red and blue edge labels. By using the colouring on one copy of G and the dual colouring on another copy of G we may construct a consistent, atomic network in which each atom ruv and buv is witnessed. Such an atomic network is illustrated in Figure 4, based on a two colouring of a three node graph.\nNow we make this more precise by checking that the reduction is correct. Suppose \u03c1 : E \u2192 {r, b} is a symmetric colouring avoiding monochrome triangles. Let V+ consist of the nodes of V together with a single extra point \u221e and let V \u2032+ = {x\n\u2032 : x \u2208 V+} be a set of the same size as V+ disjoint from it. We will define an atomic network (V+ \u222a V \u2032 +, \u03bb) avoiding all forbidden triples (so consistent) and witnessing every atom, thereby showing that the complex algebra over (S,E, ,\u0306 C) has a feeble representation. To define \u03bb:\n\u03bb(x, x) = 1\u2032 x \u2208 V+ \u222a V \u2032 +\n\u03bb(x, y\u2032) = \u00d7 x \u2208 V+, y \u2032 \u2208 V \u2032+\n\u03bb(\u221e, u) = pu u \u2208 V \u03bb(\u221e\u2032, u\u2032) = qu u \u2208 V\n\u03bb(u, v) = cuv (u, v) \u2208 E, \u03c1(u, v) = c \u2208 {r, b}\n\u03bb(u\u2032, v\u2032) = c\u0304uv (u, v) \u2208 E, \u03c1(u, v) = c\n\u03bb(u, v) = \u03bb(u\u2032, v\u2032) = g (u, v) 6\u2208 E, u 6= v\nwhere c\u0304 denotes \u2018the other colour\u2019, for c \u2208 {r, b}, and each converse edge is labelled by the converse atom, e.g. \u03bb(u,\u221e) = p\u0306 u. It is a routine check that this defines a consistent atomic network and that every atom labels at least one edge. By Lemma 17, (S,E, ,\u0306 C) has a feeble representation.\nFor the converse, suppose the complex algebra over (S,E, ,\u0306 C) has a feeble representation, by Lemma 17 there is a consistent, atomic network (N, \u03bb) witnessing all atoms. We must show that G is a yes instance of the monochromatic triangle problem.\nBy forbidden triple II we have that for any x, y, z \u2208 N either none or exactly two of {\u03bb(x, y), \u03bb(x, z), \u03bb(y, z)} equal \u00d7. It follows that the set of pairs {(x, y) : x, y \u2208 N, \u03bb(x, y) = \u00d7} forms a complete bipartite graph with nodes N . So N is the disjoint union N1 \u222aN2, say, and \u03bb(x, y) = \u00d7 iff either x \u2208 N1, y \u2208 N2 or x \u2208 N2, y \u2208 N1.\nSince all atoms are witnessed there are nodes z, x \u2208 N such that \u03bb(z, x) = pu, without loss z, x \u2208 N1. By forbidden triple III, for every y \u2208 N1 \\ {z} the label \u03bb(z, y) belongs to S\u221eG, so it is pv or qv for some v \u2208 V , but it cannot be qv by\nforbidden triple VI. By forbidden triples IV and V,\n\u03bb(x, y) =\n\n\n 1\u2032 if u = v cuv if (u, v) \u2208 E, for some c \u2208 {r, b} g otherwise\nHence the map \u2217 : N1 \\ {z} \u2192 V which maps y \u2208 N1 \\ {z} to v \u2208 V iff \u03bb(z, y) = pv is a well-defined injection. Since each atom pv is witnessed in the network \u2217 is surjective, hence a bijection from N1 onto V . Define a function \u03c1 : E \u2192 {r, b} by letting \u03c1(u\u2217, v\u2217) = c if \u03bb(u, v) = cuv, for c \u2208 {r, b}. Since ruv\u02d8= rvu and buv\u02d8= bvu this colouring function is symmetric. By forbidden triple VII, \u03c1 is a valid colouring of the graph."}, {"heading": "7. Axiomatisability", "text": "THEOREM 19. If K is a class of algebras containing all strongly representable relation algebras and contained in the class of all feebly representable non-associative algebras, then K has no finite axiomatisation in first order logic.\nProof. An n-colouring of a set S is a symmetric function \u03c1 mapping pairs of distinct elements of S to a set of n colours, avoiding monochromatic triangles. Let n \u2265 3, let k(n) be the smallest integer such that there is no n-colouring on a set with k(n) elements (the Ramsey number) and let \u03b1n be the atom structure with atoms\n{1\u2032} \u222a\n{\nak0 : k < k(n)(k(n)\u2212 1)\n2\n}\n\u222a {ai : 0 < i < n}\nAll atoms are self-converse. All triples of atoms are consistent except those of the form (1\u2032, x, y) for x 6= y (and Peircean transforms of these) and triples of atoms with the same subscript, i.e. (ai, ai, ai) for 0 < i < n or (a k 0 , a k\u2032 0 , a k\u2217 0 ), for k, k\u2032, k\u2217 < k(n)(k(n)\u22121)2 . Let An be the complex algebra of \u03b1n (sometimes called a Monk Algebra, see [HH02, Definition 15.2]). Then An has no feeble representation because any atomic network witnessing all atoms has at least k(n)(k(n)\u22121)2 distinct edges (one for each atom ak0) hence k(n) distinct points, but no such network can be consistent since there is no n-colouring of a set with this many elements.\nNow consider a non-principal ultraproduct \u03b1 = \u220f\nn\u2208\u03c9 \u03b1n/U of the \u03b1n, where U is a non-principal ultrafilter over \u03c9. The atoms of \u03b1 are (up to isomorphism) {1\u2032} \u222a {ak0 : k < \u03ba} \u222a {ai : 0 < i < \u03b7} where \u03ba, \u03b7 are infinite ordinals, \u03ba is the nonprincipal ultraproduct of the k(n)s and \u03b7 is the non-principal ultraproduct of the ns. All atoms are self converse and the consistent triples of atoms are as in the definition of \u03b1n. We claim that the complex algebra Cm(\u03b1) is a strongly representable relation algebra. Since RRA is a variety, it suffices to prove that every finitely generated subalgebra of Cm(\u03b1) is representable. For this, observe that an element a \u2265 ai+aj, for any distinct i, j > 0 is flexible in that a;x \u2265 1 \u2212 1\u2032 for any atom x 6= 1\u2032. So a finite subset S of the elements of A generates a finite boolean subalgebra of the boolean part ofA, this finite boolean subalgebra generates (using 1\u2032, \u02d8 and ;) a finite subalgebra of A and this finite subalgebra contains at least one flexible atom. It is known that every relation algebra with a flexible atom is representable [Com84] or [Mad82, Theorem 5.19], this proves the claim. (For a proof in a more complicated but similar case, see [HH01a, Theorem 24, Proposition 26, Theorem 27].) Observe that the ultraproduct \u03a0n\u2208\u03c9An/U is a subalgebra of the complex algebra of \u03b1, so it is also strongly representable. Thus, none of the algebras An has a feeble\nrepresentation so An 6\u2208 K (for n < \u03c9) but an ultraproduct of them has a strong representation and is in K. By Los\u0301\u2019 Theorem, K cannot be defined by finitely many axioms.\nBy this theorem, the following classes cannot be defined by finitely many axioms: the class of non-associative algebras with feeble representations; with qualitative representations; with strong representations."}, {"heading": "8. Conclusion", "text": "Let us review some of the advantages of qualitative representations. For many applications in knowledge representation, it is natural to express that a certain relation may be decomposed in a certain way without insisting that such a decomposition must always exist, for example if one asserts that y occurs strictly later than x, it might be the case that there is a z occurring in between, but not necessarily. In order to model real world applications using relation-like algebras, it is often necessary to consider a type of representation for our algebras that would be ruled out if we were to restrict ourselves to strong representations. For relation algebras such as RCC8 where we may wish to consider disconnected regions and regions with holes it has been known for some time that strong relation algebra representations are problematic. So the fact that qualitative representations include along with strong representations a very wide class of different representations, significantly extends our ability to model various situations.\nMoreover, if a finite algebra has a qualitative representation then it has a qualitative representation on a finite base. This means, in general, that the network satisfaction problem is much easier for qualitative representations than the corresponding problem for strong representations, although for certain well-known relation algebras the two versions of the problem turn out to be equivalent. We have seen that several representation problems become computationally much easier in the context of qualitative representations compared to the corresponding strong representation problem.\nIn a subsequent paper we intend to investigate the universal algebra of QRA in more depth, by providing a recursive (but necessariliy infinite) axiomatisation of it, by considering complete qualitative representations and by showing that QRA generates a discriminator variety."}, {"heading": "Acknowledgement", "text": "The authors wish to thank Dr. Todd Niven for his essential input in the early development of this work."}], "references": [{"title": "Maintaining knowledge about temporal intervals", "author": ["James Allen"], "venue": "Communications of the ACM,", "citeRegEx": "Allen.,? \\Q1983\\E", "shortCiteRegEx": "Allen.", "year": 1983}, {"title": "RCC8 is polynomial on networks of bounded treewidth", "author": ["Manuel Bodirsky", "Stefan W\u00f6fl"], "venue": "Proceeding of the twenty-second international joint conference on Artificial Intelligence,", "citeRegEx": "Bodirsky and W\u00f6fl.,? \\Q2011\\E", "shortCiteRegEx": "Bodirsky and W\u00f6fl.", "year": 2011}, {"title": "A survey of qualitative spatial representations", "author": ["Juan Chen", "Anthony G. Cohn", "Dayou Liu", "Shengsheng Wang", "Jihong Ouyang", "Qiangyuan Yu"], "venue": "The Knowledge Engineering Review, 30:106\u2013136,", "citeRegEx": "Chen et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Chen et al\\.", "year": 2015}, {"title": "Combinatorial aspects of relations", "author": ["Stephen D. Comer"], "venue": "Algebra Universalis,", "citeRegEx": "Comer.,? \\Q1984\\E", "shortCiteRegEx": "Comer.", "year": 1984}, {"title": "A relation-algebraic approach to the region connected calculus", "author": ["Ivo D\u00fcntsch", "Hui Wang", "Steve McLoskey"], "venue": "Theoretical Computer Science,", "citeRegEx": "D\u00fcntsch et al\\.,? \\Q2001\\E", "shortCiteRegEx": "D\u00fcntsch et al\\.", "year": 2001}, {"title": "Computers and Intractability: A Guide to the Theory of NP-Completeness", "author": ["Michael R. Garey", "David S. Johnson"], "venue": null, "citeRegEx": "Garey and Johnson.,? \\Q1979\\E", "shortCiteRegEx": "Garey and Johnson.", "year": 1979}, {"title": "Relation algebras from cylindric algebras, II", "author": ["Robin Hirsch", "Ian Hodkinson"], "venue": "Ann. Pure. Appl. Logic,", "citeRegEx": "Hirsch and Hodkinson.,? \\Q2001\\E", "shortCiteRegEx": "Hirsch and Hodkinson.", "year": 2001}, {"title": "Representability is not decidable for finite relation algebras", "author": ["Robin Hirsch", "Ian Hodkinson"], "venue": "Trans. Amer. Math. Soc.,", "citeRegEx": "Hirsch and Hodkinson.,? \\Q2001\\E", "shortCiteRegEx": "Hirsch and Hodkinson.", "year": 2001}, {"title": "Relation algebras by games. North-Holland", "author": ["Robin Hirsch", "Ian Hodkinson"], "venue": null, "citeRegEx": "Hirsch and Hodkinson.,? \\Q2002\\E", "shortCiteRegEx": "Hirsch and Hodkinson.", "year": 2002}, {"title": "Relation Algebras of Intervals", "author": ["Robin Hirsch"], "venue": "Artificial Intelligence Journal,", "citeRegEx": "Hirsch.,? \\Q1996\\E", "shortCiteRegEx": "Hirsch.", "year": 1996}, {"title": "A relation algebra with undecidable network satisfaction problem", "author": ["Robin Hirsch"], "venue": "Bulletin of the Interest Group in Pure and Applied Logics,", "citeRegEx": "Hirsch.,? \\Q1999\\E", "shortCiteRegEx": "Hirsch.", "year": 1999}, {"title": "Boolean algebras with operators I", "author": ["Bjarni J\u00f3nsson", "Alfred Tarski"], "venue": "American Journal of Mathematics,", "citeRegEx": "J\u00f3nsson and Tarski.,? \\Q1951\\E", "shortCiteRegEx": "J\u00f3nsson and Tarski.", "year": 1951}, {"title": "Integrating metric and qualitative temporal reasoning. AAAI\u201991", "author": ["Henry Kautz", "Peter Ladkin"], "venue": "Proceedings of the ninth National conference on AI,", "citeRegEx": "Kautz and Ladkin.,? \\Q1991\\E", "shortCiteRegEx": "Kautz and Ladkin.", "year": 1991}, {"title": "Kleene algebra with tests", "author": ["Dexter Kozen"], "venue": "ACM Trans. Program. Lang. Syst.,", "citeRegEx": "Kozen.,? \\Q1997\\E", "shortCiteRegEx": "Kozen.", "year": 1997}, {"title": "The complexity of reasoning with relative directions", "author": ["Jae Lee"], "venue": "Frontiers in Artificial Intelligence and Applications,", "citeRegEx": "Lee.,? \\Q2014\\E", "shortCiteRegEx": "Lee.", "year": 2014}, {"title": "Categorical methods in qualitative reasoning: The case for weak representations", "author": ["G\u00e9rard Ligozat"], "venue": "In Spatial Information Theory, International Conference,", "citeRegEx": "Ligozat.,? \\Q2005\\E", "shortCiteRegEx": "Ligozat.", "year": 2005}, {"title": "Qualitative spatial and temporal reasoning", "author": ["G\u00e9rard Ligozat"], "venue": "Wiley-ISTE,", "citeRegEx": "Ligozat.,? \\Q2011\\E", "shortCiteRegEx": "Ligozat.", "year": 2011}, {"title": "On binary constraint networks", "author": ["Peter Ladkin", "Roger Maddux"], "venue": "Technical Report U.88.8, Kestrel Institute,", "citeRegEx": "Ladkin and Maddux.,? \\Q1988\\E", "shortCiteRegEx": "Ladkin and Maddux.", "year": 1988}, {"title": "Constraint problems", "author": ["Peter Ladkin", "Roger Maddux"], "venue": "Journal of the Association of Computing Machinery,", "citeRegEx": "Ladkin and Maddux.,? \\Q1994\\E", "shortCiteRegEx": "Ladkin and Maddux.", "year": 1994}, {"title": "What is a qualitative calculus? A general framework", "author": ["G\u00e9rard Ligozat", "Jochen Renz"], "venue": "editors, PRICAI,", "citeRegEx": "Ligozat and Renz.,? \\Q2004\\E", "shortCiteRegEx": "Ligozat and Renz.", "year": 2004}, {"title": "RCC8 binary constraint network can be consistently extended", "author": ["Sanjiang Li", "Huaiqing Wang"], "venue": "Artificial Intelligence Journal,", "citeRegEx": "Li and Wang.,? \\Q2006\\E", "shortCiteRegEx": "Li and Wang.", "year": 2006}, {"title": "Some varieties containing relation algebras", "author": ["Roger Maddux"], "venue": "Trans. Amer. Math. Soc.,", "citeRegEx": "Maddux.,? \\Q1982\\E", "shortCiteRegEx": "Maddux.", "year": 1982}, {"title": "Necessary subalgebras of simple nonintegral semiassociative relation algebras", "author": ["Roger Maddux"], "venue": "Algebra Universalis,", "citeRegEx": "Maddux.,? \\Q1990\\E", "shortCiteRegEx": "Maddux.", "year": 1990}, {"title": "Relation algebras, volume 150 of Studies in Logic: the Foundations of Mathematics", "author": ["Roger Maddux"], "venue": null, "citeRegEx": "Maddux.,? \\Q2006\\E", "shortCiteRegEx": "Maddux.", "year": 2006}, {"title": "Representations of integral relation algebras", "author": ["Ralph McKenzie"], "venue": "Michigan Math. J.,", "citeRegEx": "McKenzie.,? \\Q1970\\E", "shortCiteRegEx": "McKenzie.", "year": 1970}, {"title": "Combining qualitative and quantitative constraints in temporal reasoning", "author": ["Itay Meiri"], "venue": "Artificial Intelligence Journal,", "citeRegEx": "Meiri,? \\Q1996\\E", "shortCiteRegEx": "Meiri", "year": 1996}, {"title": "A categorical perspective on qualitative constraint calculi", "author": ["Till Mossakowski", "Lutz Schr\u00f6der", "Stefan W\u00f6lfl"], "venue": "In Qualitative Constraint Calculi: Applications and Integration,", "citeRegEx": "Mossakowski et al\\.,? \\Q2006\\E", "shortCiteRegEx": "Mossakowski et al\\.", "year": 2006}, {"title": "Some recent results in metric temporal logic", "author": ["Jo\u00ebl Ouaknine", "James Worrell"], "venue": null, "citeRegEx": "Ouaknine and Worrell.,? \\Q2008\\E", "shortCiteRegEx": "Ouaknine and Worrell.", "year": 2008}, {"title": "INDu: An Interval and Duration Network", "author": ["Arun Pujari", "Vijaya Kumari", "Abdul Sattar"], "venue": "In Advanced topics and artificial intelligence,", "citeRegEx": "Pujari et al\\.,? \\Q1999\\E", "shortCiteRegEx": "Pujari et al\\.", "year": 1999}, {"title": "A spatial logic based on regions and connection", "author": ["David A. Randell", "Zhan Cui", "Anthony G. Cohn"], "venue": "In Proceedings 3rd International Conference on Knowledge Representation and Reasoning", "citeRegEx": "Randell et al\\.,? \\Q1992\\E", "shortCiteRegEx": "Randell et al\\.", "year": 1992}, {"title": "The region connected calculus. In \u201cQuantitative Spatial Reasoning with Toplogical Information\u201d", "author": ["Jochen Renz"], "venue": null, "citeRegEx": "Renz.,? \\Q2002\\E", "shortCiteRegEx": "Renz.", "year": 2002}, {"title": "Weak composition for qualitative spatial and temporal reasoning", "author": ["Jochen Renz", "G\u00e9rard Ligozat"], "venue": "In Proceedings of Constraint Programming,", "citeRegEx": "Renz and Ligozat.,? \\Q2005\\E", "shortCiteRegEx": "Renz and Ligozat.", "year": 2005}, {"title": "Constraint propagation algorithms for temporal reasoning \u2014 a revised report", "author": ["M Vilain", "H Kautz", "P van Beek"], "venue": "In D S Weld and J de Kleer, editors, Readings in Qualitative Reasoning about Physical Systems,", "citeRegEx": "Vilain et al\\.,? \\Q1989\\E", "shortCiteRegEx": "Vilain et al\\.", "year": 1989}, {"title": "On the scope of qualitative constraint calculi", "author": ["Matthias Westphal", "Julien Hu\u00e9", "Stefan W\u00f6lfl"], "venue": "In KI 2014: Advances in Artificial Intelligence - 37th Annual German Conference on AI, Stuttgart,", "citeRegEx": "Westphal et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Westphal et al\\.", "year": 2014}], "referenceMentions": [], "year": 2017, "abstractText": "Binary Constraint Problems have traditionally been considered as Network Satisfaction Problems over some relation algebra. A constraint network is satisfiable if its nodes can be mapped into some representation of the relation algebra in such a way that the constraints are preserved. A qualitative representation \u03c6 is like an ordinary representation, but instead of requiring that (a;b) is the composition a\u25e6b of the relations a and b, as we do for ordinary representations, we only require that c \u2287 a\u25e6b \u21d0\u21d2 c \u2265 a;b, for each c in the algebra. A constraint network is qualitatively satisfiable if its nodes can be mapped to elements of a qualitative representation, preserving the constraints. If a constraint network is satisfiable then it is clearly qualitatively satisfiable, but the converse can fail, as we show. However, for a wide range of relation algebras including the point algebra, the Allen Interval Algebra, RCC8 and many others, a network is satisfiable if and only if it is qualitatively", "creator": "LaTeX with hyperref package"}}}