{"id": "1610.05036", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "17-Oct-2016", "title": "Encoding the Local Connectivity Patterns of fMRI for Cognitive State Classification", "abstract": "In this work, we propose a novel framework to encode the local connectivity patterns of brain, using Fisher Vectors (FV), Vector of Locally Aggregated Descriptors (VLAD) and Bag-of-Words (BoW) methods. We first obtain local descriptors, called Mesh Arc Descriptors (MADs) from fMRI data, by forming local meshes around anatomical regions, and estimating their relationship within a neighborhood. Then, we extract a dictionary of relationships, called \\textit{brain connectivity dictionary} by fitting a generative Gaussian mixture model (GMM) to a set of MADs, and selecting the codewords at the mean of each component of the mixture over time. These representations are described in a description in the Supporting Information. The following graph demonstrates the relationships of each MADs on two axes, which are based on the current data set. First, we can derive a model for each MADs and see how each MADs represent a network of nodes. Second, we generate a model for each model, as the data set has been drawn from a dataset of nodes. In addition to the existing maps, we are able to create an approximation of the mesh-distributed architecture, which includes a set of maps, for each MADs and a set of vectors for each MADs and a vector for each MADs. The maps are generated using Fourier Transform (F) and Gaussian Equation (GMM). The mesh-distributed architecture uses Fourier Transform and Gaussian Equation (GMM). In a previous work, we have used a Gaussian Equation (GMM) to estimate the spatial connectivity of two regions, called the top left or bottom right regions, in a Gaussian Gaussian Equation (GMM). Finally, we can estimate the spatial connectivity of each MADs by using Gaussian Equation (F) and Gaussian Equation (GMM). The data used in this study are from the FV dataset, available online at http://goo.gl/KGpMg\n\n\n\nIn a previous work, we have used Fourier Transform (F) and Gaussian Equation (GMM). The mesh-distributed architecture uses Fourier Transform and Gaussian Equation (GMM). The mesh-distributed architecture uses Fourier Transform and Gaussian Equation (GMM). In a previous work, we have used Fourier Transform (F) and Gaussian Equ", "histories": [["v1", "Mon, 17 Oct 2016 10:08:09 GMT  (2108kb,D)", "http://arxiv.org/abs/1610.05036v1", "8 pages, 5 figures"]], "COMMENTS": "8 pages, 5 figures", "reviews": [], "SUBJECTS": "cs.CV cs.LG", "authors": ["itir onal ertugrul", "mete ozay", "fatos t yarman vural"], "accepted": false, "id": "1610.05036"}, "pdf": {"name": "1610.05036.pdf", "metadata": {"source": "META", "title": "Encoding the Local Connectivity Patterns of fMRI for Cognitive State Classification ", "authors": ["Itir Onal Ertugrula", "Mete Ozayb", "Fatos T. Yarman Vurala"], "emails": ["itir@ceng.metu.edu.tr"], "sections": [{"heading": null, "text": "In this work, we propose a novel framework to encode the local connectivity patterns of brain, using Fisher Vectors (FV), Vector of Locally Aggregated Descriptors (VLAD) and Bag-of-Words (BoW) methods. We first obtain local descriptors, called Mesh Arc Descriptors (MADs) from fMRI data, by forming local meshes around anatomical regions, and estimating their relationship within a neighborhood. Then, we extract a dictionary of relationships, called brain connectivity dictionary by fitting a generative Gaussian mixture model (GMM) to a set of MADs, and selecting the codewords at the mean of each component of the mixture. Codewords represent the connectivity patterns among anatomical regions. We also encode MADs by VLAD and BoW methods using the k-Means clustering. We classify the cognitive states of Human Connectome Project (HCP) task fMRI dataset, where we train support vector machines (SVM) by the encoded MADs. Results demonstrate that, FV encoding of MADs can be successfully employed for classification of cognitive tasks, and outperform the VLAD and BoW representations. Moreover, we identify the significant Gaussians in mixture models by computing energy of their corresponding FV parts, and analyze their effect on classification accuracy. Finally, we suggest a new method to visualize the codewords of brain connectivity dictionary."}, {"heading": "1. Introduction", "text": "Functional Magnetic Resonance Imaging (fMRI) is a powerful tool used for capturing the neural activation observed in a wide range of cognitive tasks encoded in brain. Traditional approaches employ fMRI Blood Oxygenation Level Dependent (BOLD) response of voxels or anatomical regions for cognitive state classification (Haxby et al., 2001; Mitchell et al., 2004). Yet, recent findings show that connectivity between voxels or anatomical regions provides more information about activities in brain compared to the voxel BOLD responses. In addition, pairwise correlations between voxel BOLD responses are suggested to represent and classify cognitive tasks (Richiardi et al., 2011; Shirer et al., 2011). Pairwise global connectivity provides better classification performance compared to traditional approaches. Brain connectivity is also represented by a set of local meshes (Onal et al., 2015a,b), where relationships\n\u2217\u2217Corresponding author: Tel.: +90-555-557-9677; e-mail: itir@ceng.metu.edu.tr (Itir Onal Ertugrul)\namong multiple voxels are estimated within a predefined neighborhood. Estimated relationships, called Mesh Arc Descriptors (Ozay et al., 2012), are reported to give the best performance in cognitive state classification, compared to voxel BOLD responses and their pairwise relationships.\nEncoding approaches are widely used in pattern recognition literature to improve the representation power of local descriptors. In a popular encoding approach, called Bag-of-Words (BoW), first local descriptors are clustered using the k-means clustering method. Then, cluster centroids are defined as codewords to form a dictionary. Codewords are utilized as textual words in natural language processing, and visual words in image processing. In this approach, each descriptor is assigned to the closest codeword, and a sample is represented by a histogram of codewords, to which its local descriptors belong. BoW approach has been used to detect diseases using fMRI data (Solmaz et al., 2012), and to classify EEG time series data (Wang et al., 2013; Merino et al., 2013).\nIn another encoding approach, called Vector of Locally Aggregated Descriptors (VLAD), first, codewords are computed similar to BoW. However, VLAD aims to accumulate the dif-\nar X\niv :1\n61 0.\n05 03\n6v 1\n[ cs\n.C V\n] 1\n7 O\nct 2\n01 6\n2 ference between the codewords and local descriptors assigned to the codewords (Je\u0301gou et al., 2010). VLAD has been used in various applications including image (Delhumeau et al., 2013) and video (Abbas et al., 2015) processing, yet it has not been used to encode local descriptors obtained from fMRI data.\nFisher Vector (FV) encoding methods are employed for statistical data analysis by making use of the benefits of generative and discriminative models (Carvajal et al., 2016; Sa\u0301nchez et al., 2013). FV encoding is considered as an extension of BoW such that, rather than encoding the relative frequency of the descriptors, it encodes the information on distribution of the descriptors (Perronnin et al., 2010). Fisher kernels have been used to compute FVs utilizing a mechanism that incorporates generative probability models into discriminative classifiers in applications, including classification of protein domains (Jaakkola et al., 1999), action and event recognition (Oneata et al., 2013; Sekma et al., 2015), image classification (Liu et al., 2014; Simonyan et al., 2013; Sa\u0301nchez and Redolfi, 2015) and 3D object retrieval (Savelonas et al., 2016). FVs have been applied to model effective connectivity of the networks using MRI and PET data (Zhou et al., 2016). Yet, FVs have not been used to encode the connectivity patterns of fMRI data, which is very crucial to analyze the behavior of brain during cognitive tasks.\nThe major contribution of this study is to suggest a novel framework for encoding a set of local descriptors which models the connectivity patterns among the anatomic regions, based on the fMRI data. Inspired by the concept of visual words in image processing, our motivation is to generate a brain connectivity dictionary that represents relational patterns formed among anatomical regions in order to describe the cognitive states. The proposed framework enables us to examine various encoding methods such as FVs, VLAD and BoW for cognitive task classification. To our knowledge, our framework is the first that uses encoding methods to the connectivity analysis of fMRI data.\nIn order to generate the brain connectivity dictionary, we fit a Gaussian mixture model (GMM) to the set of MADs, obtained from all anatomic regions, and from all subjects, during all cognitive tasks. The mean vector of a Gaussian component corresponds to a codeword of brain connectivity dictionary. Then, by using the codewords, we encode MADs with FV, VLAD and BoW methods. In FV encoding, a generative model is estimated by fitting a Gaussian mixture to the MAD vectors. We represent each sample of a cognitive task, as a FV encoding to model the statistical deviation of the associated MAD from the corresponding GMMs. In VLAD, we cluster MADs using a kmeans clustering method and obtain a dictionary of MADs. We represent each sample by the accumulated difference between the MADs and the codewords to which they are assigned. For comparison, we also compute BoW models of MAD. We train linear SVM classifiers by the encoded MADs, obtained from BoW, VLAD and FV encoding methods. We observe that encoding MADs with FV provides the best performances and improves the performances of raw MADs in cognitive task classification. On the other hand, VLAD encoding provides similar performance to that of raw MADs. However, BoW encoding decreases the performance of raw MADs. Our results show\nthat the performance of SVM classifier heavily depends on the modality of the codewords, the dimension of feature vectors and degree of functional locality of meshes.\nAnother contribution of this work is the exploration of the relationship between energy of FV columns obtained from a particular Gaussian component and the classification accuracy. Our results reflect that Gaussian mixture components whose FV columns have higher energy are more discriminative compared to the ones with lower energy. Finally, we suggest a visualization method to depict and analyze codewords of the brain connectivity dictionary on a human brain template. We first sort the Gaussian mixture components based on the energy they provide for FV encoding. Then, we plot their codewords on brain, and sort them with respect to their discriminative power. The suggested framework is tested to classify the cognitive tasks in Human Connectomme Project (HCP). The results suggest that MADs having large values in the elements corresponding to occipital regions and low values in the rest of the elements, provide the most significant information to classify the cognitive tasks. On the other hand, MADs having large values in the elements corresponding to central structures (Putamen, Caudate and Thalamus) provide the least discriminative information."}, {"heading": "2. Data Representation", "text": "We use the benchmark task fMRI dataset of Human Connectome Project (HCP) (Barch et al., 2013). We employ task fMRI data of 97 healthy subjects collected for seven cognitive tasks, namely, Emotion (Emo), Gambling (Gam), Language Processing (Lan), Motor (Mot), Relational Processing (Rel), Social Processing (Soc) and Working Memory (WM). Number of scans and their duration vary for each task, yet they have equal duration for all participants (see Table 1).\nWe use R = 98 regions of Automated Anatomical Labeling (AAL) brain atlas Tzourio-Mazoyer et al. (2002) except the ones that cover Cerebellum. Each region is denoted by ri, where i = 1, 2, . . . ,R. Note that, each region contains a set of voxels. We denote a voxel by v j, where j = 1, 2, . . . , J, and J is the total number of voxels. We denote BOLD response obtained at each voxel v j by a function of time t by x j(t), \u2200 j and \u2200t. Then, for each region ri, we obtain a representative time series yi(t), \u2200t, by spatially averaging the BOLD responses obtained from voxels residing in that region as follows:\nyi(t) = 1 Ji \u2211 \u2200v j\u2208ri x j(t),\u2200t, (1)\nwhere Ji is the number of voxels residing in the ith region ri, \u2200i.\n3\nFig. 1: An overview of our proposed framework which is employed to generate a brain connectivity dictionary. For each cognitive task, we first form local meshes around all anatomical regions using their functionally nearest neighbors (in the figure, we represent only five representative meshes). Next, we estimate edge weights of meshes (MAD) for all tasks of all subjects. We apply PCA to reduce dimension of the MADs, and obtain uncorrelated descriptors. Then, we employ GMMs and k-means clustering methods on the descriptors using data obtained from all tasks. Finally, we obtain FV, VLAD and BoW encoding for each task."}, {"heading": "3. Encoding of Mesh Arc Descriptors", "text": "In this section, we introduce our framework in order to encode MADs. First, we estimate MADs to represent the local connectivity patterns of cognitive tasks. Next, we reduce the dimension of MAD space using Principal Component Analysis (PCA). Then, we fit GMMs to the set of MADs. Finally, we encode MADs using three methods by employing their distance to the centers of GMMs, namely, Fisher Vectors (FV), Vector of Locally Aggregated Descriptors (VLAD) and Bag of Words (BoW). The encoded MADs are used to train an SVM classifier for cognitive task classification. Fig. 1 represents the steps of our encoding framework."}, {"heading": "3.1. Estimation of Mesh Arc Descriptors (MADs)", "text": "In this study, we form a star mesh around each region ri,\u2200i, by connecting the region to its functionally nearest neighboring regions. Functionally p-nearest neighbors of a region are defined by the regions having the p-largest Pearson correlation coefficient associated to that region during a cognitive task.\nWe estimate the arc weights of each mesh formed around the region ri, in the p-nearest neighborhood \u03b7p(ri) of ri by assuming the following linear model;\nyi = \u2211\n\u2200r j\u2208\u03b7p(ri) ai, jy j + \u03bba2i, j + i,\u2200i, (2)\nwhere ai, j,\u2200i, j are estimated by minimizing the variance of error i using a ridge regression algorithm. In (2), \u03bb is the regularization parameter, and yi is a vector of average BOLD response for region ri, obtained during a cognitive task, such that yi = [yi(1), yi(2), . . . , yi(Tc)], where Tc denotes the number of time instances in fMRI measurements during task c \u2208 [1, 7].\nThe estimated arc weights ai, j represent the relationship between a region ri and its p-nearest neighbors \u03b7p(ri) while a subject is exposed to a cognitive stimulus of length Tc. For each task, we solve (2) for all regions ri. Consequently, we obtain a MAD vector ai = [ai,1, ai,2, . . . , ai,R] of size 1 \u00d7 R, for each cognitive task, such that ai, j = 0 if r j < \u03b7p(ri). Then, all the MADs are concatenated under a vector of size 1\u00d7R2, such that a = [a1, a2, . . . , aR]."}, {"heading": "3.2. Encoding Methods", "text": "In this subsection, we explain how MADs are encoded for fMRI data analysis."}, {"heading": "3.2.1. Fisher Vector (FV) Encoding", "text": "Given a set of vectors, FV method encodes deviation of distribution of the vectors from a dictionary, which is typically described by a diagonal Gaussian mixture model (GMM) (Carvajal et al., 2016). In the proposed framework, our vectors are MADs obtained from fMRI data. We obtain a brain connectivity dictionary of MADs by modeling the features using a GMM. In order to satisfy the assumption of diagonal covariance matrix of GMM and obtain linearly uncorrelated features, we apply PCA to MADs. For simplicity, we use the same notation for MADs at the output of PCA, such that ai represents the projection of a MADs in a D-dimensional space.\nLet A = {ai \u2208 RD}Ri=1 denote a set of D-dimensional MADs which are obtained from a single task of a single subject, and are sampled from the set of all MADs, A. Also, let uk be the kth component of GMM, which models the generative process for elements belonging to A. We denote the parameter set of all uk\u2019s by \u03bb = {wk,\u00b5k,\u03a3k}Kk=1, where wk, \u00b5k and \u03a3k are the mixture weight, mean vector and covariance matrix of the kth Gaussian, respectively. We compute the mixture u\u03bb by\n4 u\u03bb(ai) = K\u2211\nk=1 wkuk(ai), where uk(ai) denotes the kth Gaussian in\nthe mixture, and is computed by\nuk(ai) = 1\n(2\u03c0)D/2|\u03a3k |1/2 exp\n( \u2212 1\n2 (ai \u2212 \u00b5k)T\u03a3\u22121k (ai \u2212 \u00b5k)\n) . (3)\nWe estimate the parameters of GMM on a training set of MADs using Expectation Maximization (EM) algorithm. We assume that diagonal covariance matrices are identified by \u03c32k which denotes a vector of the diagonal entries of \u03a32k . Then, we compute the derivatives of log-likelihood of GMM with\nrespect to the parameters using GA\u03bb = R \u22121 R\u2211 i=1 \u2207\u03bb log u\u03bb(ai). The derivatives are only taken with respect to Gaussian means and variances, since the gradients computed with respect to the weight parameters, wi, provide less information (Perronnin et al., 2010). Therefore, we obtain a representation that captures the average first and second order differences between MADs and each of the GMM models. Then, we compute Ddimensional gradients using\nGA\u00b5k = 1\nR \u221a\nwk R\u2211 i=1 \u03b3i(k) ( ai \u2212 \u00b5k \u03c3k ) (4)\nand\nGA\u03c3k = 1\nR \u221a 2wk R\u2211 i=1 \u03b3i(k)  (ai \u2212 \u00b5k)2 \u03c32k \u2212 1  , (5)\nwhere \u03b3i(k) represents the soft assignment of the MAD vector ai to the kth Gaussian, and is defined by\n\u03b3i(k) = wkuk(ai) ( K\u2211\nl=1 wlul(ai)\n)\u22121 .\nA Fisher vector GA\u03bb is obtained by concatenating the gradients under a vector GA\u03bb = [ GA\u00b51 ,G A \u03c31 ,GA\u00b52 ,G A \u03c32 , . . . ,G A \u00b5K ,G A \u03c3K ] of size 2KD. We obtain Fisher Vectors for both training and test data. In order to obtain better accuracy, we further apply l2 normalization and square-root transformation on FVs as suggested in (Sa\u0301nchez et al., 2013)."}, {"heading": "3.2.2. Vector of Locally Aggregated Descriptors (VLAD)", "text": "VLAD encodes a set of descriptors into a dictionary, which is computed by k-means clustering method. In the proposed framework, we first perform k-means clustering of MADs on the training data. Hence, the cluster centroids {\u00b5}Kk=1 correspond to our codewords of brain connectivity dictionary. Then, we associate each MAD ai to its nearest codeword NN(ai) in the dictionary, such that NN(ai) = argmin\n\u00b5k\n\u2016ai \u2212 \u00b5k\u20162, where \u2016 \u00b7 \u20162 is\nthe Euclidean norm. Recall from the previous subsection that, A = {ai}Ri=1 represents the set of D-dimensional MADs belonging to a single task of a single subject, each of which is sampled from A that contains all MADs belonging to all tasks of all subjects. For each codeword \u00b5k, we compute the sum of the differences, (ai \u2212 \u00b5k), of the descriptors ai, which are assigned to the kth cluster by\nvAk = \u2211\nai:NN(ai)=\u00b5k\n(ai \u2212 \u00b5k). (6)\nWe concatenate the D-dimensional vectors vAk for all clusters, and obtain a KD dimensional VLAD encoding VA = [vA1 , vA2 , . . . , vAK]. Note that, we obtain VLAD encoding for each A, computed using training and test data."}, {"heading": "3.2.3. Bag-of-Words (BoW)", "text": "We also encode MADs using the BoW approach, where the words correspond to a set of selected MADs. We first cluster MADs obtained from training data using a k-means clustering method. Then, for each A, we compute the number of MADs, nAk , belonging to the k\nth cluster. Finally, we represent each sample by a K-dimensional vector such that NA = [nA1 , n A 2 , . . . , n A k ]."}, {"heading": "4. Experimental Results", "text": "We perform two sets of experiments. First, we classify the cognitive tasks of HCP datasets using the raw and encoded MADs to see the effect of encoding on MADs and compare the performance of various encoding methods. In order to examine the power of MADs compared to popular fMRI representation methods, we also classify the cognitive tasks by using average BOLD responses and their Pearson correlations. Finally, we visualize and analyze the codewords of the proposed brain connectivity dictionary."}, {"heading": "4.1. Classification Results", "text": "In order to perform classification, we first compute FV (GA\u03bb ), VLAD (VA) and BoW (NA) encoding of local MADs for all tasks and all participants. Then, we use the encoded MAD vectors to train and test linear SVM classifiers. We measure the classification performance using a 10-fold cross validation (CV) scheme by randomly splitting the data into 10 subsets according to a uniform distribution, training each model on 9 splits, and testing the learned model on the remaining split. Note that, training and test splits contain data associated to different participants for each fold. In the proposed framework, we use only training data for implementation of all methods that are employed in learning phase, such as computation of PCA using MADs, estimation of Gaussian mixture models, kmeans clustering and training SVM classifiers. We examine the proposed methods for various number of neighbors p \u2208 P = {10, 20, 30, 40}, in each mesh to observe the effect of degree of locality of the meshes. Considering the fact that MADs are R-dimensional vectors (before application of PCA), employment of smaller p values provides increased locality and sparser MAD vectors. Before employment of FV encoding, we project MADs onto d \u2208 {50, 60, 70, 80, 90} dimensional spaces. Moreover, we select the number of Gaussians in GMM and the number of clusters in k-means using k \u2208 {20, 40, 60, 80, 100, 120}. We compute average performance of 10-fold CV for all k and d. Accuracy values denoted in Table 2 show maximum of these performances with respect to the values of k and d.\nResults given in Table 2 show that, FV encoding of MADs computed by employment of PCA (FV-MAD with PCA) gives the best performance to classify cognitive tasks compared to VLAD (VLAD-MAD) and BoW encoding (BoW-MAD). We observe that VLAD encoding of MADs does not increase the\n5\ndiscrimination power of MADs. Although accuracy values of VLAD-MAD are comparable with that of MAD, BoW representations of MADs yield substantial decrease in accuracy. In order to observe the representation power of MAD compared to popular fMRI representation methods, we use average voxel BOLD responses and Pearson correlation pairs between them as the input feature vectors of SVM classifiers. When the average region BOLD responses are employed for classification, we obtain almost chance accuracy (14.29%). On the other hand, when pairwise correlations between all pairs of region BOLD responses are used as features, we obtain a classification accuracy of 77.49%. In Table 3, we observe a substantial increase (10 \u2212 15%) obtained by representing fMRI data by MADs. These observations show the power of MADs for representation of the connectivity of anatomic regions.\nNext, we examine the success of encoding for each cognitive task. We observe in Fig. 2 that the accuracy values obtained for Gambling and Relational Processing tasks are lower compared to the other tasks performed using FV-MAD and VLADMAD. However, accuracy values obtained from BoW-MAD for\nall classes are low, meaning that BoW is not successful to encode MADs. When we compare the results shown in Fig. 2a, Fig. 2b and Fig. 2c, we observe that we can boost the accuracy for Emotion and WM tasks compared to concatenated MADs by encoding MADs with FV and VLAD. Yet, the accuracy is decreased for Gambling task, especially for the lower values of p.\nWe also analyze the effect of employment of PCA to local MADs before computation of FV encoding. Our results verify the observation that dimension reduction using PCA is a key method used to boost the performance (see Table 2). We also observe from Table 2 that without PCA, FV encoding cannot improve the performance of concatenated MADs for any value of p. Similarly, we observe that performance decreases if we do\n6 Codeword1 Codeword2 Codeword3 Codeword4 Codeword5 Codeword6 Codeword7\nCodeword8 Codeword9 Codeword10 Codeword11 Codeword12 Codeword13 Codeword14\nCodeword15 Codeword16 Codeword17 Codeword18 Codeword19 Codeword20\nFig. 4: Codewods of brain connectivity dictionary obtained by FVs for encoding of MADs with p = 40. Codewords are visualized using BrainNet Viewer (Xia et al., 2013), and depicted in an order such that Codeword1 and Codeword20 represent the codeword of GHE, and GLE, respectively.\nnot employ PCA for MADs using VLAD and BoW. We examine how accuracy changes as dimension of MAD is decreased using PCA in Fig. 3 by plotting the average accuracy obtained over all values of k for different d \u2208 {50, 60, . . . , 90}. We observe that, if the dimension d of the low-dimensional space obtained using PCA increases, then average accuracy may increase. Moreover, without dimension reduction, the average accuracy decreases for most of the p \u2208 P values."}, {"heading": "4.2. Analysis of Codewords", "text": "In this subsection, we explore the contribution of a particular codeword (component of GMM) to classify the cognitive tasks by measuring the energy (Euclidean norm) of the corresponding\ncolumns of FVs. Recall that, the columns of the kth Gaussian in a FV encoding is [GA\u00b5K ,G A \u03c3K ] for a set A of MADs. If we denote the corresponding columns of the kth Gaussian in the FV encoding using all training data by Gk = [G\u00b5K ,G\u03c3K ], then the energy is measured by the Euclidean norm \u2016Gk\u20162. We denote a Gaussian whose FV columns have the lowest energy by GLE, and the one whose FV columns have the highest energy by GHE.\nNext, we visualize R-dimensional codewords obtained from MADs without using PCA. Each codeword corresponds to a mesh pattern formed around a seed voxel. Large values of codeword elements represent that, a MAD formed between the region corresponding to the codeword element and seed region has large value. Similarly, small values of codeword elements indicate small values of MADs between seed region and the corresponding region. As an example, we plot codewords for p = 40 and k = 20, in Fig. 4. Notice from Figure 4 that, codewords represent different mesh patterns. For example, Codeword1 represents a mesh pattern in which MADs formed between a seed region and regions residing in the occipital lobe have large values while MADs formed between a seed region and the other regions have smaller values. Recall that, each GMM component obtained without using PCA corresponds to 2R columns of FVs. In Fig. 4, we provide visualization of the Gaussians in an order from GHE to GLE by plotting the codewords of the corresponding Gaussians. The results show that codeword of GHE has large values mainly in the occipital lobe. On the other hand, codeword of GLE has large values in central structures including Caudate, Putamen and Thalamus.\n7\nSimonyan et al. (2013) showed that GHEs represent the facial features whereas the GLEs cover the background areas. In other words, they stated that GHEs are significant for comparing human face images. Following our results, we conjecture that the GHEs consisting of MADs convey class (task) discriminative information. In order to validate this assumption, and investigate the relationship between the energy of FV columns related to Gaussians and the classification accuracy, we employ an energy based feature selection scheme for FV encoding. For this purpose, we select and remove the corresponding columns from FVs, and perform classification. When we remove FV columns with minimum and maximum energy, we observe that the accuracy decreases slightly and significantly, respectively (see Fig. 5). We conclude that, GHEs provide more class (task) discrimination power to classifiers compared to GLEs."}, {"heading": "5. Discussion and Conclusion", "text": "In this study, we propose a novel framework to encode the local connectivity patterns of fMRI data for classification of the cognitive states of the HCP task fMRI data set. fMRI connectivity patterns are modeled by an ensemble of local meshes formed around each anatomic region. MADs are estimated by using ridge regression, assuming a linear relationship among anatomic regions. Several state-of-the-art methods, such as FV, VLAD and BoW, are used to encode MADs. We, also, generate a brain connectivity dictionary by fitting a GMM to the set of all MADs to analyze the connectivity patterns of fMRI data with respect to anatomical regions.\nWe observe that FV encoding of MADs is more successful compared to VLAD and BoW methods. Moreover, FV encoding improves the performance of models that employ MADs. We also observe that statistical decorrelation of MADs obtained using PCA is a significant step for FV encoding. We further analyze class (task) discrimination power of Gaussians obtained from FV encoding. We observe a relationship between the energy of FV columns corresponding to Gaussians and classification accuracy. Following that result, we visualize codewords of brain connectivity dictionary on a human brain template according to their discriminative power, which is measured by an energy function.\nIn this work, we constructed mesh structures of anatomical regions. As a future work, we plan to employ encoding of MADs by constructing mesh structures among the voxels in high dimensional spaces. In addition, we plan to employ the proposed framework to further analyze the relationship between different tasks and cognitive processes by visualizing feature maps of MADs and their encoding on the AAL brain atlas."}, {"heading": "Acknowledgments", "text": "This work was supported by CREST, JST, and TUBITAK Project No 114E045. Itir Onal Ertugrul was supported by TUBITAK."}], "references": [{"title": "Vectors of locally aggregated centers for compact video", "author": ["A. Abbas", "N. Deligiannis", "Y. Andreopoulos"], "venue": null, "citeRegEx": "Abbas et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Abbas et al\\.", "year": 2015}, {"title": "Function in the human connectome: task-fmri and individual differences", "author": ["D.M. Barch", "G.C. Burgess", "M.P. Harms", "S.E. Petersen", "B.L. Schlaggar", "M. Corbetta", "M.F. Glasser", "S. Curtiss", "S. Dixit", "C Feldt"], "venue": "in behavior", "citeRegEx": "Barch et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Barch et al\\.", "year": 2013}, {"title": "Joint recognition and segmentation of actions via probabilistic integration of spatio-temporal fisher vectors", "author": ["J. Carvajal", "C. McCool", "B. Lovell", "C. Sanderson"], "venue": null, "citeRegEx": "Carvajal et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Carvajal et al\\.", "year": 2016}, {"title": "Revisiting the vlad image representation, in: ACMMM", "author": ["J. Delhumeau", "P.H. Gosselin", "H. J\u00e9gou", "P. P\u00e9rez"], "venue": null, "citeRegEx": "Delhumeau et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Delhumeau et al\\.", "year": 2013}, {"title": "Distributed and overlapping representations of faces and objects in ventral temporal cortex", "author": ["J.V. Haxby", "M.I. Gobbini", "M.L. Furey", "A. Ishai", "J.L. Schouten", "P. Pietrini"], "venue": "Science 293,", "citeRegEx": "Haxby et al\\.,? \\Q2001\\E", "shortCiteRegEx": "Haxby et al\\.", "year": 2001}, {"title": "Exploiting generative models in discriminative classifiers", "author": ["T.S. Jaakkola", "D Haussler"], "venue": null, "citeRegEx": "Jaakkola and Haussler,? \\Q1999\\E", "shortCiteRegEx": "Jaakkola and Haussler", "year": 1999}, {"title": "Aggregating local descriptors into a compact image representation", "author": ["H. J\u00e9gou", "M. Douze", "C. Schmid", "P. P\u00e9rez"], "venue": "in: CVPR,", "citeRegEx": "J\u00e9gou et al\\.,? \\Q2010\\E", "shortCiteRegEx": "J\u00e9gou et al\\.", "year": 2010}, {"title": "Encoding high dimensional local features by sparse coding based fisher vectors", "author": ["L. Liu", "C. Shen", "L. Wang", "A. van den Hengel", "C. Wang"], "venue": null, "citeRegEx": "Liu et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Liu et al\\.", "year": 2014}, {"title": "A bag-of-words model for task-load prediction from eeg in complex", "author": ["L.M. Merino", "J. Meng", "S. Gordon", "B.J. Lance", "T. Johnson", "V. Paul", "K. Robbins", "J.M. Vettel", "Y. Huang"], "venue": null, "citeRegEx": "Merino et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Merino et al\\.", "year": 2013}, {"title": "Learning to decode cognitive states from brain", "author": ["T.M. Mitchell", "R. Hutchinson", "R.S. Niculescu", "F. Pereira", "X. Wang", "M. Just", "S. Newman"], "venue": "images. Machine Learning", "citeRegEx": "Mitchell et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Mitchell et al\\.", "year": 2004}, {"title": "Modeling voxel connectivity for brain decoding", "author": ["I. Onal", "M. Ozay", "F. Yarman Vural"], "venue": "in: IEEE PRNI, Stanford, CA, USA. pp", "citeRegEx": "Onal et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Onal et al\\.", "year": 2015}, {"title": "Functional mesh model with temporal measurements for brain", "author": ["I. Onal", "M. Ozay", "F.T. Yarman Vural"], "venue": null, "citeRegEx": "Onal et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Onal et al\\.", "year": 2015}, {"title": "Action and event recognition with fisher vectors on a compact feature", "author": ["D. Oneata", "J. Verbeek", "C. Schmid"], "venue": null, "citeRegEx": "Oneata et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Oneata et al\\.", "year": 2013}, {"title": "Mesh learning for classifying cognitive processes", "author": ["M. Ozay", "I. \u00d6ztekin", "U. \u00d6ztekin", "F.T. Yarman-Vural"], "venue": "CoRR abs/1205.2382", "citeRegEx": "Ozay et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Ozay et al\\.", "year": 2012}, {"title": "Improving the fisher kernel for large-scale image classification, in: ECCV", "author": ["F. Perronnin", "J. S\u00e1nchez", "T. Mensink"], "venue": null, "citeRegEx": "Perronnin et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Perronnin et al\\.", "year": 2010}, {"title": "Image classification with the fisher vector: Theory and practice", "author": ["J. S\u00e1nchez", "F. Perronnin", "T. Mensink", "J. Verbeek"], "venue": "Int. J. Comput. Vis", "citeRegEx": "S\u00e1nchez et al\\.,? \\Q2013\\E", "shortCiteRegEx": "S\u00e1nchez et al\\.", "year": 2013}, {"title": "Exponential family fisher vector for image classification", "author": ["J. S\u00e1nchez", "J. Redolfi"], "venue": "Pattern Recognition Letters", "citeRegEx": "S\u00e1nchez and Redolfi,? \\Q2015\\E", "shortCiteRegEx": "S\u00e1nchez and Redolfi", "year": 2015}, {"title": "2016. Fisher encoding of differential fast point feature histograms for partial 3d object retrieval", "author": ["M.A. Savelonas", "I. Pratikakis", "K. Sfikas"], "venue": "Pattern Recognition", "citeRegEx": "Savelonas et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Savelonas et al\\.", "year": 2016}, {"title": "Human action recognition based on multi-layer fisher vector encoding method", "author": ["M. Sekma", "M. Mejdoub", "C.B. Amar"], "venue": "Pattern Recognition Letters", "citeRegEx": "Sekma et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Sekma et al\\.", "year": 2015}, {"title": "Decoding subject-driven cognitive states with whole-brain connectivity patterns. Cerebral Cortex", "author": ["W.R. Shirer", "S. Ryali", "E. Rykhlevskaia", "V. Menon", "M.D. Greicius"], "venue": null, "citeRegEx": "Shirer et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Shirer et al\\.", "year": 2011}, {"title": "Fisher vector faces in the wild", "author": ["K. Simonyan", "O.M. Parkhi", "A. Vedaldi", "A. Zisserman"], "venue": "in: BMVC,", "citeRegEx": "Simonyan et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Simonyan et al\\.", "year": 2013}, {"title": "Adhd classification using bag of words approach on network", "author": ["B. Solmaz", "S. Dey", "A.R. Rao", "M. Shah"], "venue": null, "citeRegEx": "Solmaz et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Solmaz et al\\.", "year": 2012}, {"title": "Automated anatomical labeling of activations in spm using a macroscopic anatomical parcellation of the mni mri single-subject brain", "author": ["N. Tzourio-Mazoyer", "B. Landeau", "D. Papathanassiou", "F. Crivello", "O. Etard", "N. Delcroix", "B. Mazoyer", "M. Joliot"], "venue": null, "citeRegEx": "Tzourio.Mazoyer et al\\.,? \\Q2002\\E", "shortCiteRegEx": "Tzourio.Mazoyer et al\\.", "year": 2002}, {"title": "Bag-of-words representation for biomedical time series classification", "author": ["J. Wang", "P. Liu", "M.F. She", "S. Nahavandi", "A. Kouzani"], "venue": "Biomedical Signal Processing and Control", "citeRegEx": "Wang et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Wang et al\\.", "year": 2013}, {"title": "Brainnet viewer: a network visualization tool for human brain connectomics", "author": ["M. Xia", "J. Wang", "Y. He"], "venue": "PloS one 8,", "citeRegEx": "Xia et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Xia et al\\.", "year": 2013}, {"title": "Learning discriminative bayesian networks from high-dimensional continuous neuroimaging data", "author": ["L. Zhou", "L. Wang", "l. liu", "P. Ogunbona", "D. Shen"], "venue": "IEEE Trans. Pattern Anal. Mach. Intell", "citeRegEx": "Zhou et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Zhou et al\\.", "year": 2016}], "referenceMentions": [{"referenceID": 4, "context": "proaches employ fMRI Blood Oxygenation Level Dependent (BOLD) response of voxels or anatomical regions for cognitive state classification (Haxby et al., 2001; Mitchell et al., 2004).", "startOffset": 138, "endOffset": 181}, {"referenceID": 9, "context": "proaches employ fMRI Blood Oxygenation Level Dependent (BOLD) response of voxels or anatomical regions for cognitive state classification (Haxby et al., 2001; Mitchell et al., 2004).", "startOffset": 138, "endOffset": 181}, {"referenceID": 19, "context": "tion, pairwise correlations between voxel BOLD responses are suggested to represent and classify cognitive tasks (Richiardi et al., 2011; Shirer et al., 2011).", "startOffset": 113, "endOffset": 158}, {"referenceID": 13, "context": "Estimated relationships, called Mesh Arc Descriptors (Ozay et al., 2012), are reported to give the best performance in cognitive state classification, compared to voxel BOLD responses and their pairwise relationships.", "startOffset": 53, "endOffset": 72}, {"referenceID": 21, "context": "BoW approach has been used to detect diseases using fMRI data (Solmaz et al., 2012), and to classify EEG time series data (Wang et al.", "startOffset": 62, "endOffset": 83}, {"referenceID": 23, "context": ", 2012), and to classify EEG time series data (Wang et al., 2013; Merino et al., 2013).", "startOffset": 46, "endOffset": 86}, {"referenceID": 8, "context": ", 2012), and to classify EEG time series data (Wang et al., 2013; Merino et al., 2013).", "startOffset": 46, "endOffset": 86}, {"referenceID": 6, "context": "ference between the codewords and local descriptors assigned to the codewords (J\u00e9gou et al., 2010).", "startOffset": 78, "endOffset": 98}, {"referenceID": 3, "context": "VLAD has been used in various applications including image (Delhumeau et al., 2013) and video (Abbas et al.", "startOffset": 59, "endOffset": 83}, {"referenceID": 0, "context": ", 2013) and video (Abbas et al., 2015) processing, yet it has not been used to encode local descriptors obtained from fMRI data.", "startOffset": 18, "endOffset": 38}, {"referenceID": 2, "context": "Fisher Vector (FV) encoding methods are employed for statistical data analysis by making use of the benefits of generative and discriminative models (Carvajal et al., 2016; S\u00e1nchez et al., 2013).", "startOffset": 149, "endOffset": 194}, {"referenceID": 15, "context": "Fisher Vector (FV) encoding methods are employed for statistical data analysis by making use of the benefits of generative and discriminative models (Carvajal et al., 2016; S\u00e1nchez et al., 2013).", "startOffset": 149, "endOffset": 194}, {"referenceID": 14, "context": "FV encoding is considered as an extension of BoW such that, rather than encoding the relative frequency of the descriptors, it encodes the information on distribution of the descriptors (Perronnin et al., 2010).", "startOffset": 186, "endOffset": 210}, {"referenceID": 12, "context": ", 1999), action and event recognition (Oneata et al., 2013; Sekma et al., 2015), image classification (Liu et al.", "startOffset": 38, "endOffset": 79}, {"referenceID": 18, "context": ", 1999), action and event recognition (Oneata et al., 2013; Sekma et al., 2015), image classification (Liu et al.", "startOffset": 38, "endOffset": 79}, {"referenceID": 7, "context": ", 2015), image classification (Liu et al., 2014; Simonyan et al., 2013; S\u00e1nchez and Redolfi, 2015) and 3D object retrieval (Savelonas et al.", "startOffset": 30, "endOffset": 98}, {"referenceID": 20, "context": ", 2015), image classification (Liu et al., 2014; Simonyan et al., 2013; S\u00e1nchez and Redolfi, 2015) and 3D object retrieval (Savelonas et al.", "startOffset": 30, "endOffset": 98}, {"referenceID": 16, "context": ", 2015), image classification (Liu et al., 2014; Simonyan et al., 2013; S\u00e1nchez and Redolfi, 2015) and 3D object retrieval (Savelonas et al.", "startOffset": 30, "endOffset": 98}, {"referenceID": 17, "context": ", 2013; S\u00e1nchez and Redolfi, 2015) and 3D object retrieval (Savelonas et al., 2016).", "startOffset": 59, "endOffset": 83}, {"referenceID": 25, "context": "FVs have been applied to model effective connectivity of the networks using MRI and PET data (Zhou et al., 2016).", "startOffset": 93, "endOffset": 112}, {"referenceID": 1, "context": "We use the benchmark task fMRI dataset of Human Connectome Project (HCP) (Barch et al., 2013).", "startOffset": 73, "endOffset": 93}, {"referenceID": 22, "context": "We use R = 98 regions of Automated Anatomical Labeling (AAL) brain atlas Tzourio-Mazoyer et al. (2002) except the ones that cover Cerebellum.", "startOffset": 73, "endOffset": 103}, {"referenceID": 2, "context": "Given a set of vectors, FV method encodes deviation of distribution of the vectors from a dictionary, which is typically described by a diagonal Gaussian mixture model (GMM) (Carvajal et al., 2016).", "startOffset": 174, "endOffset": 197}, {"referenceID": 14, "context": "The derivatives are only taken with respect to Gaussian means and variances, since the gradients computed with respect to the weight parameters, wi, provide less information (Perronnin et al., 2010).", "startOffset": 174, "endOffset": 198}, {"referenceID": 15, "context": "In order to obtain better accuracy, we further apply l2 normalization and square-root transformation on FVs as suggested in (S\u00e1nchez et al., 2013).", "startOffset": 124, "endOffset": 146}, {"referenceID": 24, "context": "Codewords are visualized using BrainNet Viewer (Xia et al., 2013), and depicted in an order such that Codeword1 and Codeword20 represent the codeword of GHE, and GLE, respectively.", "startOffset": 47, "endOffset": 65}], "year": 2016, "abstractText": "In this work, we propose a novel framework to encode the local connectivity patterns of brain, using Fisher Vectors (FV), Vector of Locally Aggregated Descriptors (VLAD) and Bag-of-Words (BoW) methods. We first obtain local descriptors, called Mesh Arc Descriptors (MADs) from fMRI data, by forming local meshes around anatomical regions, and estimating their relationship within a neighborhood. Then, we extract a dictionary of relationships, called brain connectivity dictionary by fitting a generative Gaussian mixture model (GMM) to a set of MADs, and selecting the codewords at the mean of each component of the mixture. Codewords represent the connectivity patterns among anatomical regions. We also encode MADs by VLAD and BoW methods using the k-Means clustering. We classify the cognitive states of Human Connectome Project (HCP) task fMRI dataset, where we train support vector machines (SVM) by the encoded MADs. Results demonstrate that, FV encoding of MADs can be successfully employed for classification of cognitive tasks, and outperform the VLAD and BoW representations. Moreover, we identify the significant Gaussians in mixture models by computing energy of their corresponding FV parts, and analyze their effect on classification accuracy. Finally, we suggest a new method to visualize the codewords of brain connectivity dictionary.", "creator": "LaTeX with hyperref package"}}}