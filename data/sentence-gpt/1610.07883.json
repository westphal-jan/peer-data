{"id": "1610.07883", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "25-Oct-2016", "title": "Generalization Bounds for Weighted Automata", "abstract": "This paper studies the problem of learning weighted automata from a finite labeled training sample. We consider several general families of weighted automata defined in terms of three different measures: the norm of an automaton's weights, the norm of the function computed by an automaton, or the norm of the corresponding Hankel matrix. We present new data-dependent generalization guarantees for learning weighted automata expressed in terms of the Rademacher complexity of these families. We further describe these predictions through an open-access, peer-reviewed paper that is published in this January. This paper discusses the potential for the prediction of an algorithm that achieves the predictions of linear regression from its classification of automata from a finite class of three components, known as the Bayesian generalization model.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "histories": [["v1", "Tue, 25 Oct 2016 14:10:11 GMT  (40kb,D)", "http://arxiv.org/abs/1610.07883v1", null]], "reviews": [], "SUBJECTS": "cs.LG cs.FL", "authors": ["borja balle", "mehryar mohri"], "accepted": false, "id": "1610.07883"}, "pdf": {"name": "1610.07883.pdf", "metadata": {"source": "CRF", "title": "Generalization Bounds for Weighted Automata", "authors": ["B. Balle", "M. Mohri"], "emails": ["b.deballepigem@lancaster.ac.uk"], "sections": [{"heading": "1 Introduction", "text": "Weighted finite automata (WFAs) provide a general and highly expressive framework for representing functions mapping strings to real numbers. The mathematical theory behind WFAs, that of rational power series, has been extensively studied in the past [28, 53, 38, 14] and has been more recently the topic of a dedicated handbook [25]. WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.\nThe recent developments in spectral learning [31, 6] have triggered a renewed interest in the use of WFAs in machine learning, with several recent successes in\n\u2217Corresponding author: b.deballepigem@lancaster.ac.uk\nar X\niv :1\n61 0.\n07 88\n3v 1\n[ cs\n.L G\n] 2\nnatural language processing [8, 9] and reinforcement learning [16, 30]. The interest in spectral learning algorithms for WFAs is driven by the many appealing theoretical properties of such algorithms, which include their polynomial-time complexity, the absence of local minima, statistical consistency, and finite sample bounds a\u0300 la PAC [31]. However, the typical statistical guarantees given for the hypotheses used in spectral learning only hold in the realizable case. That is, these analyses assume that the labeled data received by the algorithm is sampled from some unknown WFA. While this assumption is a reasonable starting point for theoretical analyses, the results obtained in this setting fail to explain the good performance of spectral algorithms in many practical applications where the data is typically not generated by a WFA. See [11] for a recent survey of algorithms for learning WFAs with a discussion of the different assumptions and learning models.\nThere exists of course a vast literature in statistical learning theory providing tools to analyze generalization guarantees for different hypothesis classes in classification, regression, and other learning tasks. These guarantees typically hold in an agnostic setting where the data is drawn i.i.d. from an arbitrary distribution. For spectral learning of WFAs, an algorithm-dependent agnostic generalization bound was proven in [10] using a stability argument. This seems to have been the first analysis to provide statistical guarantees for learning WFAs in an agnostic setting. However, while [10] proposed a broad family of algorithms for learning WFAs parametrized by several choices of loss functions and regularizations, their bounds hold only for one particular algorithm within this family.\nIn this paper, we start the systematic development of algorithm-independent generalization bounds for learning with WFAs, which apply to all the algorithms proposed in [10], as well as to others using WFAs as their hypothesis class. Our approach consists of providing upper bounds on the Rademacher complexity of general classes of WFAs. The use of Rademacher complexity to derive generalization bounds is standard [37] (see also [13] and [49]). It has been successfully used to derive statistical guarantees for classification, regression, kernel learning, ranking, and many other machine learning tasks (e.g. see [49] and references therein). A key benefit of Rademacher complexity analyses is that the resulting generalization bounds are data-dependent.\nOur main results consist of upper bounds on the Rademacher complexity of three broad classes of WFAs. The main difference between these classes is the quantities used for their definition: the norm of the transition weight matrix or initial and final weight vectors of a WFA; the norm of the function computed by a WFA; and, the norm of the Hankel matrix associated to the function computed by a WFA. The formal definitions of these classes is given in Section 3. Let us point out that our analysis of the Rademacher complexity of the class of WFAs described in terms of Hankel matrices directly yields theoretical guarantees for a variety of spectral learning algorithms. We will return to this point when discussing the application of our results. As an application of our Rademacher complexity bounds we provide a variety of generalizations bounds for learning with WFAs using a bounded Lipschitz loss function; our bounds include both\ndata-dependent and data-independent bounds.\nRelated Work. To the best of our knowledge, this paper is the first to provide general tools for deriving learning guarantees for broad classes of WFAs. However, there exists some related work providing complexity bounds for some sub-classes of WFAs in agnostic settings. The VC-dimension of deterministic finite automata (DFAs) with n states over an alphabet of size k was shown by [33] to be in O(kn log n). This can be used to show that the Rademacher complexity of this class of DFA is bounded by O( \u221a nk log n/m). For probabilistic finite automata (PFAs), it was shown by [1] that, in an agnostic setting, a sample of size O\u0303(kT 2n2/\u03b52) is sufficient to learn a PFA with n states and k symbols whose log-loss error is at most \u03b5 away from the optimal one in the class when the error is measured on all strings of length T . New learning bounds on the Rademacher complexity of DFAs and PFAs follow as straightforward corollaries of the general results we present in this paper.\nAnother recent line of work, which aims to provide guarantees for spectral learning of WFAs in the non-realizable setting, is the so-called low-rank spectral learning approach [40]. This has led to interesting upper bounds on the approximation error between minimal WFAs of different sizes [39]. See [12] for a polynomial-time algorithm for computing these approximations. This approach, however, is more limited than ours for two reasons. First, because it is algorithm-dependent. And second, because it assumes that the data is actually drawn from some (probabilistic) WFA, albeit one that is larger than any of the WFAs in the hypothesis class considered by the algorithm.\nThe rest of this paper is organized as follows. Section 2 introduces the notation and technical concepts used throughout. Section 3 describes the three classes of WFAs for which we provide Rademacher complexity bounds. The bounds are formally stated and proven in Sections 4, 5, and 6. In Section 7 we provide additional bounds required for converting some sample-dependent bounds from Sections 5 and 6 into sample-independent bounds. Finally, the generalizations bounds obtained using the machinery developed in previous sections are given in Section 8."}, {"heading": "2 Preliminaries", "text": ""}, {"heading": "2.1 Weighted Automata, Rational Functions, and Hankel Matrices", "text": "Let \u03a3 be a finite alphabet of size k. Let denote the empty string and \u03a3? the set of all finite strings over the alphabet \u03a3. The length of u \u2208 \u03a3? is denoted by |u|. Given an integer L \u2265 0, we denote by \u03a3\u2264L the set of all strings with length at most L: \u03a3\u2264L = {x \u2208 \u03a3? : |x| \u2264 L}. Given two strings u, v \u2208 \u03a3? we write uv for their concatenation.\nA WFA over the alphabet \u03a3 with n \u2265 1 states is a tuple A = \u3008\u03b1,\u03b2, {Aa}a\u2208\u03a3\u3009 where \u03b1,\u03b2 \u2208 Rn are the initial and final weights, and Aa \u2208 Rn\u00d7n the transition\nmatrix whose entries give the weights of the transitions labeled with a. Every WFA A defines a function fA : \u03a3 ? \u2192 R defined for all x = a1 \u00b7 \u00b7 \u00b7 at \u2208 \u03a3? by\nfA(x) = fA(a1 \u00b7 \u00b7 \u00b7 at) = \u03b1>Aa1 \u00b7 \u00b7 \u00b7Aat\u03b2 = \u03b1>Ax\u03b2 , (1)\nwhere Ax = Aa1 \u00b7 \u00b7 \u00b7Aat . This algebraic expression in fact corresponds to summing the weights of all possible paths in the automaton indexed by the symbols in x, where the weight of a single path (q0, q1, . . . , qt) \u2208 [n]t+1 is obtained by multiplying the initial weight of q0, the weights of all transitions from qs\u22121 to qs labeled by xs, and the final weight if state qt. That is:\nfA(x) = \u2211\n(q0,...,qt)\u2208[n]t+1 \u03b1(q0)\n( t\u220f\ns=1\nAxs(qs\u22121, qs) ) \u03b2(qt) .\nSee Figure 1 for an example of WFA with 3 states given in terms of its algebraic representation and the equivalent representation as a weighted transition diagram between states.\nAn arbitrary function f : \u03a3? \u2192 R is said to be rational if there exists a WFA A such that f = fA. The rank of f is denoted by rank(f) and is defined as the minimal number of states of a WFA A such that f = fA. Note that minimal WFAs are not unique. In fact, it is not hard to see that, for any minimal WFA A = \u3008\u03b1,\u03b2, {Aa}\u3009 with f = fA and any invertible matrix Q \u2208 Rn\u00d7n, AQ = \u3008Q>\u03b1,Q\u22121\u03b2, {Q\u22121AaQ}\u3009 is also another minimal WFA computing f . We sometimes write A(x) instead of fA(x) to emphasize the fact that we are considering a specific parametrization of fA. Note that for the purpose of this paper we only consider weighted automata over the familiar field of real numbers with standard addition and multiplication (see [28, 53, 15, 38, 45] for more general definitions of WFAs over arbitrary semirings). Functions mapping strings to real numbers can also be viewed as non-commutative formal power series, which often helps deriving rigorous proofs in formal language theory [53, 15, 38]. We will not favor that point of view here, however, since we will not need to make explicit mention of the algebraic properties offered by that perspective.\nAn alternative method to represent rational functions independently of any WFA parametrization is via their Hankel matrices. The Hankel matrix Hf \u2208 R\u03a3?\u00d7\u03a3? of a function f : \u03a3? \u2192 R is the infinite matrix with rows and columns indexed by all strings with Hf (u, v) = f(uv) for all u, v \u2208 \u03a3?. By the theorem of Fliess [29] (see also [18] and [15]), Hf has finite rank n if and only if f is rational and there exists a WFA A with n states computing f , that is, rank(f) = rank(Hf )."}, {"heading": "2.2 Learning Scenario", "text": "Let Z denote a measurable subset of R. We assume a standard supervised learning scenario where training and test points are drawn i.i.d. according to some unknown distribution D over \u03a3? \u00d7 R.\nLet F be a subset of the family of functions mapping from X to Y, with Y \u2286 R, and let ` : Y \u00d7 Z \u2192 R+ be a loss function measuring the divergence between the prediction y \u2208 Y made by a function in F and the target label z \u2208 Z. The learner\u2019s objective consists of using a labeled training sample S = ((x1, z1), . . . , (xm, zm)) of size m to select a function f \u2208 F with small expected loss, that is\nLD(f) = E (x,z)\u223cD [`(f(x), z)] .\nOur objective is to derive learning guarantees for broad families of weighted automata or rational functions used as hypothesis sets in learning algorithms. To do so, we will derive upper bounds on the Rademacher complexity of different classes of rational functions f : \u03a3? \u2192 R. Thus, we start with a brief introduction to the main definitions and results regarding the Rademacher complexity of an arbitrary class of functions F = {f : X \u2192 Y} where X is the input space and Y \u2286 R the output space. Let D be a probability distribution over X \u00d7 Z for some Z \u2286 R and denote by DX the marginal distribution over X . Suppose S = (x1, . . . , xm)\niid\u223c DmX is a sample of m i.i.d. examples drawn from D. The empirical Rademacher complexity of F on S is defined as follows:\nR\u0302S(F) = E [ sup f\u2208F 1 m m\u2211 i=1 \u03c3if(xi) ] ,\nwhere the expectation is taken over the m independent Rademacher random variables \u03c3i \u223c Unif({+1,\u22121}). The Rademacher complexity of F is defined as the expectation of R\u0302S(F) over the draw of a sample S of size m:\nRm(F) = E S\u223cDmX\n[ R\u0302S(F) ] .\nThe Rademacher complexity of a hypothesis class can be used to derive generalization bounds for a variety of learning tasks [37, 13, 49]. To do so, we need to bound the Rademacher complexity of the associated loss class, for a given loss function ` : Y \u00d7 Z \u2192 R+.\nFor a given hypothesis class F the corresponding loss class ` \u25e6 F is given by the set of all functions ` \u25e6 f : X \u00d7 Z \u2192 R+ of the form (x, z) 7\u2192 `(f(x), z). By Talagrand\u2019s contraction lemma [41], the empirical Rademacher complexity of ` \u25e6 F can be bounded in terms of R\u0302S(F), when ` is \u00b5-Lipschitz with respect to its first argument for some \u00b5 > 0, that is when\n|`(y, z)\u2212 `(y\u2032, z)| \u2264 \u00b5|y \u2212 y\u2032|\nfor all y, y\u2032 \u2208 Y and z \u2208 Z. In that case, the following inequality holds: R\u0302S\u2032(` \u25e6 F) \u2264 \u00b5R\u0302S(F), where S\u2032 = ((x1, z1), . . . , (xm, zm)) is a sample of size m with (xi, zi) \u2208 X \u00d7 Z and S = (x1, . . . , xm) denotes the sample of elements in X obtained from S\u2032. When taking expectations over S\u2032\niid\u223c Dm and S iid\u223c DmX we obtain the same bound for the Rademacher complexities Rm(`\u25e6F) \u2264 \u00b5Rm(F). A typical example of a loss function that is \u00b5-Lipschitz with respect to its first argument is the absolute loss `(y, z) = |y\u2212z|, which satisfies the condition with \u00b5 = 1 for Y = Z = R."}, {"heading": "3 Classes of Rational Functions", "text": "In this section we introduce several classes of rational functions. Each of these classes is defined in terms of a different way to measure the complexity of rational functions. The first one is based on the weights of an explicit WFA representation, while the other two are based on intrinsic quantities associated to the function: the norm of the function, and the norm of the corresponding Hankel matrix when viewed as a linear operator on a certain Hilbert space. These three points of view measure different aspects of the complexity of a rational function, and each of them provides distinct benefits in the analysis of learning with WFAs. The Rademacher complexity of each of these classes will be analyzed in Sections 4, 5, and 6.\n3.1 The Class An,p,r We start by considering the case where each rational function is given by a fixed WFA representation. Our learning bounds would then naturally depend on the number of states and the weights of the WFA representations.\nFix an integer n > 0 and let An denote the set of all WFAs with n states. Note that any A \u2208 An is identified by the d = n(kn+ 2) parameters required to specify its initial, final, and transition weights. Thus, we can identify An with the vector space Rd by suitably defining addition and scalar multiplication. In particular, given A,A\u2032 \u2208 An and c \u2208 R, we define:\nA+A\u2032 = \u3008\u03b1,\u03b2, {Aa}\u3009+ \u3008\u03b1\u2032,\u03b2\u2032, {A\u2032a}\u3009 = \u3008\u03b1 + \u03b1\u2032,\u03b2 + \u03b2 \u2032, {Aa + A\u2032a}\u3009\ncA = c\u3008\u03b1,\u03b2, {Aa}\u3009 = \u3008c\u03b1, c\u03b2, {cAa}\u3009 .\nWe can view An as a normed vector space by endowing it with any norm from the following family. Let p, q \u2208 [1,+\u221e] be Ho\u0308lder conjugates, i.e. p\u22121 +q\u22121 = 1.\nIt is easy to check that the following defines a norm on An: \u2016A\u2016p,q = max { \u2016\u03b1\u2016p, \u2016\u03b2\u2016q,max\na \u2016Aa\u2016q\n} ,\nwhere \u2016A\u2016q denotes the matrix norm induced by the corresponding vector norm, that is \u2016A\u2016q = sup\u2016v\u2016q=1 \u2016Av\u2016q. Given p \u2208 [1,+\u221e] and q = 1/(1 \u2212 1/p), we denote by An,p,r the set of all WFAs A with n states and \u2016A\u2016p,q \u2264 r. Thus, An,p,r is the ball of radius r at the origin in the normed vector space (An, \u2016\u00b7\u2016p,q)."}, {"heading": "3.1.1 Examples", "text": "We consider first the class of deterministic finite automata (DFA). A DFA can be represented by a WFA where: \u03b1 is the indicator vector of the initial state; the entries of \u03b2 are values in {0, 1} indicating whether a state is accepting or rejecting; and, for any a \u2208 \u03a3 and any i \u2208 [n] we have that the ith row of Aa is either the all zero vector if there is no transition from the ith state labeled by a, or an indicator vector with a one on the jth position if taking an a-transition from state i leads to state j. Therefore, a DFA A = \u3008\u03b1,\u03b2, {Aa}\u3009 satisfies \u2016A\u20161,\u221e \u2264 1 and An,1,1 contains all DFA with n states.\nAnother important class of WFA contained in An,1,1 is that of probabilistic finite automata (PFA). To represent a PFA as a WFA we consider automata where: \u03b1 is a probability distribution over possible initial states; the vector \u03b2 contains stopping probabilities for every state; and for every a \u2208 \u03a3 and i, j \u2208 [n] the entry Aa(i, j) represents the probability of transitioning from state i to state j while outputting the symbol a. Any WFA satisfying these constraints clearly has \u2016\u03b1\u20161 = 1, \u2016\u03b2\u2016\u221e \u2264 1, and \u2016Aa\u2016\u221e = maxi \u2211 j |Aa(i, j)| \u2264 1. The function fA computed by a PFA A defines a probability distribution over \u03a3 ?; i.e. we have\nfA(x) \u2265 0 for all x \u2208 \u03a3? and \u2211 x\u2208\u03a3? fA(x) = 1.\n3.2 The Class Rp,r Next, we consider an alternative quantity measuring the complexity of rational functions that is independent of any WFA representation: their norm. Given p \u2208 [1,\u221e] and f : \u03a3? \u2192 R we use \u2016f\u2016p to denote the p-norm of f given by\n\u2016f\u2016p = [ \u2211 x\u2208\u03a3? |f(x)|p ] 1 p ,\nwhich in the case p =\u221e amounts to \u2016f\u2016\u221e = supx\u2208\u03a3? |f(x)|. Let Rp denote the class of rational functions with finite p-norm: f \u2208 Rp if and only if f is rational and \u2016f\u2016p < +\u221e. Given some r > 0 we also define Rp,r, the class of functions with p-norm bounded by r:\nRp,r = {f : \u03a3? \u2192 R | f rational and \u2016f\u2016p \u2264 r} .\nNote that this definition is independent of the WFA used to represent f ."}, {"heading": "3.2.1 Examples and Membership Testing", "text": "If A is a PFA, then the function fA is a probability distribution and we have fA \u2208 R1,1 and by extension Rp,1 for all p \u2208 [1,+\u221e]. On the other hand, if A is a DFA such that fA(x) = 1 for infinitely many x \u2208 \u03a3?, then fA \u2208 R\u221e,1, but fA /\u2208 Rp for any p < +\u221e. In fact, it is easy to see that for any n \u2265 0 we have An,1,1 \u2286 R\u221e. These examples show that An,1,1 \u2229 R1 6= \u2205 and An,1,1 \u2229 (R\u221e \\ R1) 6= \u2205. Thus, the classes Rp yield a more fine grained characterization of the complexity of rational functions than what the classes An,p,r can provide in general.\nHowever, while testing membership of a WFA in An,p,r is a straightforward task, testing membership in any of the Rp can be challenging. Membership in R1,r was shown to be semi-decidable in [7]. On the other hand, membership in R2,r can be decided in polynomial time [22]. The inclusion An,1,1 \u2286 R\u221e gives an easy to test sufficient condition for membership in R\u221e.\n3.3 The Class Hp,r Here, we introduce a third class of rational functions described via their Hankel matrices, a quantity that is also independent of their WFA representations. To do so, we represent a function f using its Hankel matrix Hf , interpret this matrix as a linear operator on a Hilbert space contained in the free vector space R\u03a3? , and consider the Schatten p-norm of Hf as a measure of complexity of f . To make this more precise we start by noting that the set\nL2 = {f : \u03a3? \u2192 R | \u2016f\u20162 <\u221e} together with the inner product \u3008f, g\u3009 = \u2211 x\u2208\u03a3? f(x)g(x) forms a separable Hilbert space. Note we have the obvious inclusionR2 \u2282 L2, but not all functions in L2 are rational. Given an arbitrary function f : \u03a3? \u2192 R we identify the Hankel matrix Hf with a (possibly unbounded) linear operator Hf : L2 \u2192 L2 defined by\n(Hfg)(x) = \u2211 y\u2208\u03a3? f(xy)g(y) .\nRecall that an operator Hf is bounded when its operator norm is finite; i.e. \u2016Hf\u2016 = sup\u2016g\u20162\u22641 \u2016Hfg\u20162 < \u221e. Furthermore, a bounded operator is compact if it can be obtained as the limit of a sequence of bounded finite-rank operators under an adequate notion of convergence. In particular, bounded finite-rank operators are compact. Our interest in compact operators on Hilbert spaces stems from the fact that these are precisely the operators for which a notion equivalent to the SVD for finite matrices can be defined. Thus, if f is a rational function of rank n such that Hf is bounded (note this implies compactness by Fliess\u2019 theorem), then we can use the singular values s1 \u2265 . . . \u2265 sn of Hf as a measure of the complexity of f . The following result follows from [12] and gives a useful condition for the boundedness of Hf .\nLemma 1. Suppose the function f : \u03a3? \u2192 R is rational. Then Hf is bounded if and only if \u2016f\u20162 <\u221e.\nWe see that every Hankel matrix Hf with f \u2208 R2 has a well-defined SVD. Therefore, for any f \u2208 R2 it makes sense to define its Schatten\u2013Hankel p-norm as the Schatten p-norm of its Hankel matrix: \u2016f\u2016H,p = \u2016Hf\u2016S,p = \u2016(s1, . . . , sn)\u2016p, where si = si(Hf ) is the ith singular value of Hf and rank(Hf ) = n. Using this notation, we can define several classes of rational functions. For a given p \u2208 [1,+\u221e], we denote by Hp the class of rational functions with \u2016f\u2016H,p <\u221e and, for any r > 0, we write Hp,r the for class of rational functions with \u2016f\u2016H,p \u2264 r.\nNote that the discussion above implies Hp = R2 for every p \u2208 [1,+\u221e], and therefore we can see the classes Hp,r as providing an alternative stratification of R2 than the classes R2,r. As a consequence of this containment we also have R1 \u2282 Hp for every p, and therefore the classesHp include all functions computed by probabilistic automata. Since membership in R2 is efficiently testable [22], a polynomial time algorithm from [12] can be used to compute \u2016f\u2016H,p and thus test membership in Hp,r.\n4 Rademacher Complexity of An,p,r In this section, we present an upper bound on the Rademacher complexity of the class of WFAs An,p,r. To bound Rm(An,p,r), we will use an argument based on covering numbers. We first introduce some notation, then state our general bound and related corollaries, and finally prove the main result of this section.\nLet S = (x1, . . . , xm) \u2208 (\u03a3?)m be a sample of m strings with maximum length LS = maxi |xi|. The expectation of this quantity over a sample of m strings drawn i.i.d. from some fixed distribution D will be denoted by Lm = ES\u223cDm [LS ]. It is interesting at this point to note that Lm appears in our bound and introduces a dependency on the distribution D which will exhibit different growth rates depending on the behavior of the tails of D. For example, it is well known that if the random variable |x| for x \u223c D is sub-Gaussian,1 then Lm = O( \u221a logm). Similarly, if the tail of D is sub-exponential, then Lm = O(logm) and if the tail is a power-law with exponent s + 1, s > 0, then Lm = O(m\n1/s). Note that in the latter case the distribution of |x| has finite variance if and only if s > 1.\nTheorem 2. The following inequality holds for every sample S \u2208 (\u03a3?)m:\nR\u0302S(An,p,r) \u2264 inf \u03b7>0 \u03b7 + rLS+2 \u221a\u221a\u221a\u221a2n(kn+ 2) log (2r + rLS+2(LS+2)\u03b7 ) m  . By considering the case r = 1 and choosing \u03b7 = (LS + 2)/m we obtain the\nfollowing corollary.\n1Recall that a non-negative random variable X is sub-Gaussian if P[X > k] \u2264 exp(\u2212\u2126(k2)), sub-exponential if P[X > k] \u2264 exp(\u2212\u2126(k)), and follows a power-law with exponent (s + 1) if P[X > k] \u2264 O(1/ks+1).\nCorollary 3. For any m \u2265 1 and n \u2265 1 the following inequalities holds: Rm(An,p,1) \u2264 \u221a 2n(kn+ 2) log(m+ 2)\nm + Lm + 2 m ,\nR\u0302S(An,p,1) \u2264 \u221a 2n(kn+ 2) log(m+ 2)\nm + LS + 2 m ."}, {"heading": "4.1 Proof of Theorem 2", "text": "We begin the proof by recalling several well-known facts and definitions related to covering numbers (see e.g. [24]). Let V \u2282 Rm be a set of vectors and S = (x1, . . . , xm) \u2208 (\u03a3?)m a sample of size m. Given a WFA A, we define A(S) \u2208 Rm by A(S) = (A(x1), . . . , A(xm)) \u2208 Rm. We say that V is an (`1, \u03b7)-cover for S with respect to An,p,r if for every A \u2208 An,p,r there exists some v \u2208 V such that\n1 m \u2016v \u2212A(S)\u20161 = 1 m m\u2211 i=1 |vi \u2212A(xi)| \u2264 \u03b7 .\nThe `1-covering number of S at level \u03b7 with respect to An,p,r is defined as follows:\nN1(\u03b7,An,p,r, S) = min {|V | : V \u2282 Rm is an (`1, \u03b7)-cover for S w.r.t. An,p,r} .\nA typical analysis based on covering numbers would now proceed to obtain a bound on the growth of N1(\u03b7,An,p,r, S) in terms of the number of strings m in S. Our analysis requires a slightly finer approach where the size of S is characterized by m and LS . Thus, we also define for every integer L \u2265 0 the following covering number\nN1(\u03b7,An,p,r,m,L) = max S\u2208(\u03a3\u2264L)m N1(\u03b7,An,p,r, S) .\nThe first step in the proof of Theorem 2 is to bound N1(\u03b7,An,p,r,m,L). In order to derive such a bound, we will make use of the following technical results.\nLemma 4 (Corollary 4.3 in [57]). A ball of radius R > 0 in a real d-dimensional Banach space can be covered by Rd(2 + 1/\u03c1)d balls of radius \u03c1 > 0.\nLemma 5. Let A,B \u2208 An,p,r. Then the following hold for any x \u2208 \u03a3?:\n1. |A(x)| \u2264 r|x|+2 ,\n2. |A(x)\u2212B(x)| \u2264 r|x|+1(|x|+ 2)\u2016A\u2212B\u2016p,q .\nProof. The first bound follows from applying Ho\u0308lder\u2019s inequality and the submultiplicativity of the norms in the definition of \u2016A\u2016p,q to (1). The second bound was proven in [10].\nCombining these lemmas yields the following bound on the covering number N1(\u03b7,An,p,r,m,L).\nLemma 6. N1(\u03b7,An,p,r,m,L) \u2264 rn(kn+2) ( 2 + rL+1(L+ 2)\n\u03b7\n)n(kn+2) .\nProof. Let d = n(kn+2). By Lemma 4 and Lemma 5, for any \u03c1 > 0, there exists a finite set C\u03c1 \u2282 An,p,r with |C\u03c1| \u2264 rd(2 + 1/\u03c1)d such that: for every A \u2208 An,p,r there exists B \u2208 C\u03c1 satisfying |A(x)\u2212B(x)| \u2264 r|x|+1(|x|+ 2)\u03c1 for every x \u2208 \u03a3?. Thus, taking \u03c1 = \u03b7/(rL+1(L + 2)) we see that for every S \u2208 (\u03a3\u2264L)m the set V = {B(S) : B \u2208 C\u03c1} \u2282 Rm is an \u03b7-cover for S with respect to An,p,r.\nThe last step of the proof relies on the following well-known result due to Massart.\nLemma 7 (Massart [42]). Given a finite set of vectors V = {v1, . . . ,vN} \u2282 Rm, the following holds\n1 m E [ max v\u2208V \u3008\u03c3,v\u3009 ] \u2264 ( max v\u2208V \u2016v\u20162 ) \u221a 2 log(N) m ,\nwhere the expectation is over the vector \u03c3 = (\u03c31, . . . , \u03c3m) whose entries are independent Rademacher random variables \u03c3i \u223c Unif({+1,\u22121}).\nFix \u03b7 > 0 and let VS,\u03b7 be an (`1, \u03b7)-cover for S with respect to An,p,r. By Massart\u2019s lemma, we can write\nR\u0302S(An,p,r) \u2264 \u03b7 + (\nmax v\u2208VS,\u03b7\n\u2016v\u20162 ) \u221a\n2 log |VS,\u03b7| m . (2)\nSince |A(xi)| \u2264 rLS+2 by Lemma 5, we can restrict the search for (`1, \u03b7)-covers for S to sets VS,\u03b7 \u2282 Rm where all v \u2208 VS,\u03b7 must satisfy \u2016v\u2016\u221e \u2264 rLS+2. By construction, such a covering satisfies maxv\u2208VS,\u03b7 \u2016v\u20162 \u2264 rLS+2 \u221a m. Finally, plugging in the bound for |VS,\u03b7| given by Lemma 6 into (2) and taking the infimum over all \u03b7 > 0 yields the desired result.\n5 Rademacher Complexity of Rp,r In this section, we study the complexity of rational functions from a different perspective. Instead of analyzing their complexity in terms of the parameters of WFAs computing them, we consider an intrinsic associated quantity: their norm. We present upper bounds on the Rademacher complexity of the classes of rational functions Rp,r for any p \u2208 [1,+\u221e] and r > 0.\nIt will be convenient for our analysis to identify a rational function f \u2208 Rp,r with an infinite-dimensional vector f \u2208 R\u03a3? with \u2016f\u2016p \u2264 r. That is, f is an infinite vector indexed by strings in \u03a3? whose xth entry is fx = f(x). An important observation is that using this notation, for any given x \u2208 \u03a3?, we can write f(x) as the inner product \u3008f , ex\u3009, where ex \u2208 R\u03a3 ?\nis the indicator vector corresponding to string x.\nTheorem 8. Let p\u22121 +q\u22121 = 1. Let S = (x1, . . . , xm) be a sample of m strings. Then, the following holds for any r > 0:\nR\u0302S(Rp,r) = r\nm E [\u2225\u2225\u2225\u2225 m\u2211 i=1 \u03c3iexi \u2225\u2225\u2225\u2225 q ] ,\nwhere the expectation is over the m independent Rademacher random variables \u03c3i \u223c Unif({+1,\u22121}).\nProof. In view of the notation just introduced described, we can write\nR\u0302S(Rp,r) = E [ sup\nf\u2208Rp,r\n1\nm m\u2211 i=1 \u3008f , \u03c3iexi\u3009\n] = 1\nm E\n[ sup\nf\u2208Rp,r\n\u2329 f , m\u2211 i=1 \u03c3iexi \u232a]\n= r\nm E [\u2225\u2225\u2225\u2225 m\u2211 i=1 \u03c3iexi \u2225\u2225\u2225\u2225 q ] ,\nwhere the last inequality holds by definition of the dual norm.\nThe next corollaries give non-trivial bounds on the Rademacher complexity in the case p = 1 and the case p = 2.\nCorollary 9. For any m \u2265 1 and any r > 0, the following inequalities hold: r\u221a 2m \u2264 Rm(R2,r) \u2264 r\u221a m .\nProof. The upper bound follows directly from Theorem 8 and Jensen\u2019s inequality:\nE [\u2225\u2225\u2225\u2225 m\u2211 i=1 \u03c3iexi \u2225\u2225\u2225\u2225 2 ] \u2264 \u221a\u221a\u221a\u221aE[\u2225\u2225\u2225\u2225 m\u2211 i=1 \u03c3iexi \u2225\u2225\u2225\u22252 2 ] = \u221a m .\nThe lower bound is obtained using Khintchine\u2013Kahane\u2019s inequality (see appendix of [49]):\nE [\u2225\u2225\u2225\u2225 m\u2211 i=1 \u03c3iexi \u2225\u2225\u2225\u2225 2 ]2 \u2265 1 2 E [\u2225\u2225\u2225\u2225 m\u2211 i=1 \u03c3iexi \u2225\u2225\u2225\u22252 2 ] = m 2 ,\nwhich completes the proof.\nThe following definition will be needed to present our next corollary. Given a sample S = (x1, . . . , xm) and a string x \u2208 \u03a3? we denote by sx = |{i : xi = x}| the number of times x appears in S. Let CS = maxs\u2208\u03a3? sx and note we have the straightforward bounds 1 \u2264 CS \u2264 m.\nCorollary 10. For any m \u2265 1, any S \u2208 (\u03a3?)m, and any r > 0, the following upper bound holds:\nR\u0302S(R1,r) \u2264 r \u221a 2CS log(2m)\nm .\nProof. Let S = (x1, . . . , xm) be a sample with m strings. For any x \u2208 \u03a3? define the vector vx \u2208 Rm given by vx(i) = Ixi=x. Let V be the set of vectors vx which are not identically zero, and note we have |V | \u2264 m. Also note that by construction we have maxvx\u2208V \u2016vx\u20162 = \u221a CS . Now, by Theorem 8 we have\nR\u0302S(R1,r) = r\nm E [\u2225\u2225\u2225\u2225 m\u2211 i=1 \u03c3iexi \u2225\u2225\u2225\u2225 \u221e ] = r m E [ max vx\u2208V \u222a(\u2212V ) \u3008\u03c3,vx\u3009 ] .\nTherefore, using Massart\u2019s Lemma we get R\u0302S(R1,r) \u2264 r \u221a 2CS log(2m)\nm .\nNote in this case we cannot rely on the Khintchine\u2013Kahane inequality to obtain lower bounds because there is no version of this inequality for the case q =\u221e.\nWe can easily convert the above empirical bound into a standard Rademacher complexity bound by defining the expectation Cm = ES\u223cDm [CS ] over a distribution D on \u03a3?. Note that Cm is the expected maximum number of collisions (repeated strings) in a sample of size m drawn from D. We shall provide a bound for Cm in terms of m in Section 7.\n6 Rademacher Complexity of Hp,r In this section, we present our last set of upper bounds on the Rademacher complexity of WFAs. Here, we characterize the complexity of WFAs in terms of the spectral properties of their Hankel matrix.\nThe Hankel matrix of a function f : \u03a3? \u2192 R is the bi-infinite matrix Hf \u2208 R\u03a3?\u00d7\u03a3? whose entries are defined by Hf (u, v) = f(uv). Note that any string x \u2208 \u03a3? admits |x|+ 1 decompositions x = uv into a prefix u \u2208 \u03a3? and a suffix v \u2208 \u03a3?. Thus, Hf contains a high degree of redundancy: for any x \u2208 \u03a3?, f(x) is the value of at least |x| + 1 entries of Hf and we can write f(x) = e>uHfev for any decomposition x = uv.\nLet si(M) denote the ith singular value of a matrix M. For 1 \u2264 p \u2264 \u221e, let \u2016M\u2016S,p denote the p-Schatten norm of M defined by \u2016M\u2016S,p = [\u2211 i\u22651 si(M) p ] 1 p .\nTheorem 11. Let p, q \u2265 1 with p\u22121 + q\u22121 = 1 and let S = (x1, . . . , xm) be a sample of m strings in \u03a3?. For any decomposition xi = uivi of the strings in S and any r > 0, the following inequality holds:\nR\u0302S(Hp,r) \u2264 r\nm E [\u2225\u2225\u2225\u2225 m\u2211 i=1 \u03c3ieuie > vi \u2225\u2225\u2225\u2225 S,q ] .\nProof. For any 1 \u2264 i \u2264 m, let xi = uivi be an arbitrary decomposition and let R = \u2211m i=1 \u03c3ieuie > vi . Then, in view of the identity f(xi) = e > uiHfevi =\nTr(evie > uiHf ), we can use the linearity of the trace to write\nR\u0302S(Hp,r) = E [ sup\nf\u2208Hp,r\n1\nm m\u2211 i=1 \u03c3ie > uiHfevi\n]\n= 1\nm E\n[ sup\nf\u2208Hp,r m\u2211 i=1 Tr ( \u03c3ievie > uiHf\n)] = 1\nm E\n[ sup\nf\u2208Hp,r \u3008R,Hf \u3009\n] .\nThen, by von Neumann\u2019s trace inequality [43] and Ho\u0308lder\u2019s inequality, the following holds:\nE [ sup\nf\u2208Hp,r \u3008R,Hf \u3009\n] \u2264 E  sup f\u2208Hp,r \u2211 j\u22651 sj(R) \u00b7 sj(Hf )  \u2264 E [ sup\nf\u2208Hp,r \u2016R\u2016S,q\u2016Hf\u2016S,p\n] = rE [ \u2016R\u2016S,q ] ,\nwhich completes the proof.\nNote that, in this last result, the equality condition for von Neumann\u2019s inequality cannot be used to obtain a lower bound on R\u0302S(Hp,r) since it requires the simultaneous diagonalizability of the two matrices involved, which is difficult to control in the case of Hankel matrices.\nAs in the previous sections, we now proceed to derive specialized versions of the bound of Theorem 11 for the cases p = 1 and p = 2. First, note that the corresponding q-Schatten norms have given names: \u2016R\u2016S,2 = \u2016R\u2016F is the Frobenius norm, and \u2016R\u2016S,\u221e = \u2016R\u2016op is the operator norm.\nCorollary 12. For any m \u2265 1 and any r > 0, the Rademacher complexity of H2,r can be bounded as follows:\nRm(H2,r) \u2264 r\u221a m .\nProof. In view of Theorem 11 and using Jensen\u2019s inequality, we can write\nRm(H2,r) \u2264 r m E [ \u2016R\u2016F ] \u2264 r m \u221a E [ \u2016R\u20162F ] = r\nm \u221a\u221a\u221a\u221aE [ m\u2211 i,j=1 \u03c3i\u03c3j\u3008euie>vi , euje>vj \u3009 ]\n= r\nm \u221a\u221a\u221a\u221aE [ m\u2211 i=1 \u3008euie>vi , euie>vi\u3009 ] = r\u221a m ,\nwhich concludes the proof.\nTo bound the Rademacher complexity of Hp,r in the case p = 1 we will need the following moment bound for the operator norm of a random matrix from [56].\nTheorem 13 (Corollary 7.3.2 [56]). Suppose M = \u2211 iMi is a sum of i.i.d.\nrandom matrices with E[Mi] = 0 and \u2016Mi\u2016op \u2264 M . Let \u2211 i E[MiM>i ] 4 V1,\u2211\ni E[M>i Mi] 4 V2, and V = diag(V1,V2). If d = Tr(V)/\u2016V\u2016op and \u03bd = \u2016V\u2016op, then we have\nE[\u2016M\u2016op] \u2264 2\n3\n( 1 + 4\nlog 2\n) M log(d+ 1) + ( 1 +\n4\u221a 2 log 2\n)\u221a 2\u03bd log(d+ 1) .\nWe now introduce a combinatorial number depending on S and the decomposition selected for each string xi. Let US = maxu\u2208\u03a3? |{i : ui = u}| and VS = maxv\u2208\u03a3? |{i : vi = v}|. Then, we define WS = min max{US , VS}, where then minimum is taken over all possible decompositions of the strings in S. It is easy to show that we have the bounds 1 \u2264 WS \u2264 m. Indeed, for the case WS = m consider a sample with m copies of the empty string, and for the case WS = 1 consider a sample with m different strings of length m. The following result can be stated using this definition.\nCorollary 14. For any m \u2265 1, any S \u2208 (\u03a3?)m, and any r > 0, the following upper bound holds:\nR\u0302S(H1,r) \u2264 r\nm\n[ 2\n3\n( 1 + 4\nlog 2\n) log(2m+ 1) + ( 1 +\n4\u221a 2 log 2\n)\u221a 2WS log(2m+ 1) ] .\nProof. First note that we can apply Theorem 13 to the random matrix R by letting V1 = \u2211 i euie > ui and V2 = \u2211 i evie > vi . In this case we have d = 2m,\n\u03bd = max{\u2016 \u2211 i euie > ui\u2016op, \u2016 \u2211 i evie > vi\u2016op}, and we get:\nE[\u2016R\u2016op] \u2264 ( 2\n3 +\n8\n3 log 2\n) log(2m+ 1) + (\u221a 2 +\n4\u221a log 2\n)\u221a \u03bd log(2m+ 1) .\nNext, observe that V1 = \u2211 i euie > ui \u2208 R\n\u03a3?\u00d7\u03a3? is a diagonal matrix with V1(u, u) =\u2211 i Iu=ui . Thus, \u2016V1\u2016op = maxuV1(u, u) = maxu\u2208\u03a3? |{i : ui = u}| = US . Similarly, we have \u2016V2\u2016op = VS . Thus, since the decomposition of the strings in S is arbitrary, we can choose it such that \u00b5 = WS . Applying Theorem 11 now yields the desired bound.\nWe can again convert the above empirical bound into a standard Rademacher complexity bound by defining the expectation Wm = ES\u223cDm [WS ] over a distribution D on \u03a3?. We provide a bound for Wm in terms of m in next section."}, {"heading": "7 Distribution-Dependent Rademacher Complex-", "text": "ity Bounds\nThe bounds for the Rademacher complexity of R1,r and H1,r we give above identify two important distribution-dependent parameters Cm = ES [CS ] and\nWm = ES [WS ] that reflect the impact of the distribution D on the complexity of learning these classes of rational functions. We now use upper bounds on Cm and Wm in terms of m to give bounds for the Rademacher complexities Rm(R1,r) and Rm(H1,r).\nWe start by rewriting CS in a convenient way. Let E = {ex : \u03a3? \u2192 R|x \u2208 \u03a3?} be the class of all indicator on \u03a3? given by ex(y) = 1 if x = y and ex(y) = 0 otherwise. Recall that given S = (x1, . . . , xm) we defined sx = |{i : xi = x}| and CS = supx\u2208\u03a3? sx. Using E we can rewrite these as sx = \u2211m i=1 ex(xi) and\nCS = sup ex\u2208E m\u2211 i=1 ex(xi) .\nLet Dmax = maxx\u2208\u03a3? PD[x] be the maximum probability of any strings with respect to the distribution D.\nLemma 15. mDmax \u2264 Cm \u2264 mDmax +O( \u221a m) .\nProof. We can bound Cm = ES [CS ] as follows:\nCm = E S\u223cDm [ sup ex\u2208E m\u2211 i=1 ex(xi) ]\n= E S\u223cDm [ sup ex\u2208E m\u2211 i=1 ( ex(xi) + E x\u2032i\u223cD [ex(x \u2032 i)]\u2212 E x\u2032i\u223cD [ex(x \u2032 i)] )]\n\u2264 E S\u223cDm [ sup ex\u2208E m\u2211 i=1 E x\u2032i\u223cD [ex(x \u2032 i)] ] + E S\u223cDm [ sup ex\u2208E m\u2211 i=1 ( ex(xi)\u2212 E x\u2032i\u223cD [ex(x \u2032 i)] )]\n= m sup ex\u2208E E x\u2032\u223cD\n[ex(x \u2032)] + E\nS\u223cDm [ sup ex\u2208E m\u2211 i=1 ( ex(xi)\u2212 E x\u2032i\u223cD [ex(x \u2032 i)] )]\n\u2264 m sup ex\u2208E E x\u2032\u223cD [ex(x \u2032)] + E S\u223cDm [ sup ex\u2208E \u2223\u2223\u2223\u2223\u2223 m\u2211 i=1 ( ex(xi)\u2212 E x\u2032i\u223cD [ex(x \u2032 i)] )\u2223\u2223\u2223\u2223\u2223 ] .\nNow note on the one hand we can write supex\u2208E Ex\u2032\u223cD[ex(x \u2032)] = supx\u2208\u03a3? Px\u2032\u223cD[x\u2032 = x] = Dmax. On the other hand, a standard symmetrization argument yields:\nE S\u223cDm [ sup ex\u2208E \u2223\u2223\u2223\u2223\u2223 m\u2211 i=1 ( ex(xi)\u2212 E x\u2032i\u223cD [ex(x \u2032 i)] )\u2223\u2223\u2223\u2223\u2223 ] \u2264 2mRm(E) = O( \u221a m) ,\nwhere in the last inequality we used that the VC-dimension of E is 1, in which case Dudley\u2019s chaining method [26] yields Rm(E) \u2264 C \u221a 1/m for some universal constant C > 0. Note that by Jensen\u2019s inequality we also have\nm sup ex\u2208E E x\u2032\u223cD\n[ex(x \u2032)] = sup\nex\u2208E E S\u223cDm [ m\u2211 i=1 ex(xi) ] \u2264 E S\u223cDm [ sup ex\u2208E m\u2211 i=1 ex(xi) ] ,\nand therefore the bound is tight up to the lower order terms.\nA straightforward application of Jensen\u2019s inequality now yields the following.\nCorollary 16. For any m \u2265 1 and any r > 0 we have:\nRm(R1,r) \u2264 r\u221a m\n\u221a 2(Dmax +O( \u221a 1/m)) log(2m).\nNext we provide bounds for Wm. Given a sample S = (x1, . . . , xm) we will say that the tuples of pairs of strings S\u2032 = ((u1, v1), . . . , (um, vm)) \u2208 (\u03a3?\u00d7\u03a3?)m form a split of S if xi = uivi for all 1 \u2264 i \u2264 m. We denote by S\u2228 the set of all possible splits of a sample S. We also define coordinate projections \u03c0j : \u03a3\n? \u00d7 \u03a3? \u2192 \u03a3? given by \u03c01(u, v) = u and \u03c02(u, v) = v. Now recall that Wm = ES [WS ] and note we can rewrite the definition of WS as\nWS = min S\u2032\u2208S\u2228 max j=1,2 sup ex\u2208E m\u2211 i=1 ex(\u03c0j(ui, vi))\n= min S\u2032\u2208S\u2228 sup e\u2208E\u2228 m\u2211 i=1 e(ui, vi) ,\nwhere E\u2228 = (E \u25e6 \u03c01) \u222a (E \u25e6 \u03c02) and E \u25e6 \u03c0j is the set of functions of the form ex(\u03c0j(u, v)). Finally, given a distribution D over \u03a3 ? we define the parameter\nD\u2228max = sup x\u2208\u03a3? max {\u2211 v\u2208\u03a3?\n1\n|x|+ |v|+ 1 PD[xv], \u2211 u\u2208\u03a3?\n1\n|x|+ |u|+ 1 PD[ux]\n} .\nWith these definitions we have the following result.\nLemma 17. Wm \u2264 mD\u2228max +O( \u221a m) .\nProof. We start by upper bounding the minS\u2032\u2208S\u2228 with the expectation ES\u2032\u223cUnif(S\u2228) over a split chosen uniformly at random:\nWm = E S\u223cDm [ min S\u2032\u2208S\u2228 sup e\u2208E\u2228 m\u2211 i=1 e(ui, vi) ]\n\u2264 E S\u223cDm E S\u2032\u223cUnif(S\u2228) [ sup e\u2208E\u2228 m\u2211 i=1 e(ui, vi) ]\n\u2264 sup e\u2208E\u2228 E S\u223cDm E S\u2032\u223cUnif(S\u2228) [ m\u2211 i=1 e(ui, vi) ]\n+ E S\u223cDm E S\u2032\u223cUnif(S\u2228) [ sup e\u2208E\u2228 \u2223\u2223\u2223\u2223\u2223 m\u2211 i=1 ( e(ui, vi)\u2212 E x\u2032i\u223cD E (u\u2032i,v \u2032 i)\u223cUnif({x\u2032i}\u2228) [e(u\u2032i, v \u2032 i)] )\u2223\u2223\u2223\u2223\u2223 ] .\nThe same standard argument we used above shows that the second term in the last sum above can be bounded by 2mRm(E\u2228) = O( \u221a m). To compute the\nfirst term in the sum note that given a string y and a random split (u, v) \u223c Unif({y}\u2228), the probability that u = x for some fixed x \u2208 \u03a3? is 1/(|y|+ 1) if x is a prefix of y and 0 otherwise. Thus, we let e = ex \u25e6 \u03c01 \u2208 E\u2228 and write\nE S\u223cDm E S\u2032\u223cUnif(S\u2228) [ m\u2211 i=1 e(ui, vi) ] = m E x\u2032\u223cD E (u,v)\u223cUnif({x\u2032}\u2228) ex(u)\n= mPx\u2032\u223cD,(u,v)\u223cUnif({x\u2032}\u2228)[u = x] = m \u2211\nx\u2032\u2208x\u03a3?\n1\n|x\u2032|+ 1 PD[x\u2032]\n= m \u2211 v\u2208\u03a3?\n1\n|x|+ |v|+ 1 PD[xv] .\nSimilarly, if we have e = ex \u25e6 \u03c02 \u2208 E\u2228 then\nE S\u223cDm E S\u2032\u223cUnif(S\u2228) [ m\u2211 i=1 e(ui, vi) ] = m \u2211 u\u2208\u03a3?\n1\n|x|+ |u|+ 1 PD[ux] .\nThus, we can combine these equations to show that Wm \u2264 mD\u2228max+O( \u221a m).\nUsing Jensen\u2019s inequality we now obtain the following bound.\nCorollary 18. For any m \u2265 1 and any r > 0 we have: Rm(H1,r) \u2264 ( 2\n3 +\n8\n3 log 2\n) r log(2m+ 1)\nm\n+ (\u221a 2 +\n4\u221a log 2 ) r\u221a m \u221a (D\u2228max +O( \u221a 1/m)) log(2m+ 1) ."}, {"heading": "8 Learning and Sample Complexity Bounds", "text": "We now have all the ingredients to give generalization bounds for learning with weighted automata. In particular, we will give bounds for learning with a Lipschitz bounded loss function on all the classes of weighted automata and rational functions considered above. In cases where we have different bounds for the empirical and expected Rademacher complexities we also give two versions of the bound. All these bounds can be used to derive learning algorithms for weighted automata provided the right-hand side can be optimized over the corresponding hypothesis class. We will discuss in the next section what are the open problems related to obtaining efficient algorithms to solve these optimization problems. The proofs of these theorems are a straightforward combination of the bounds on the Rademacher complexity with well-known generalization bounds [49].\nTheorem 19. Let D be a probability distribution over \u03a3? \u00d7 R and let S = ((xi, yi)) m i=1 be a sample of m i.i.d. examples from D. Assume that the loss ` : R\u00d7R\u2192 R+ is M -bounded and \u00b5-Lipschitz with respect to its first argument. Fix \u03b4 > 0. Then, the following holds:\n1. For all n \u2265 1 and p \u2208 [1,+\u221e], with probability at least 1\u2212 \u03b4 the following holds simultaneously for all A \u2208 An,p,1:\nLD(A) \u2264 L\u0302S(A)+ \u221a 8\u00b52n(kn+ 2) log(m+ 2)\nm +\n2\u00b5(Lm + 2)\nm +M\n\u221a log(1/\u03b4)\n2m .\n2. For all r > 0, with probability at least 1\u2212 \u03b4 the following holds simultaneously for all f \u2208 R2,r:\nLD(f) \u2264 L\u0302S(f) + 2\u00b5r\u221a m +M\n\u221a log(1/\u03b4)\n2m .\n3. For all r > 0, with probability at least 1\u2212 \u03b4 the following holds simultaneously for all f \u2208 R1,r:\nLD(f) \u2264 L\u0302S(f) + 2\u00b5r\u221a m\n\u221a 2(Dmax +O( \u221a 1/m)) log(2m) +M \u221a log(1/\u03b4)\n2m .\n4. For all r > 0, with probability at least 1\u2212 \u03b4 the following holds simultaneously for all f \u2208 H2,r:\nLD(f) \u2264 L\u0302S(f) + 2\u00b5r\u221a m +M\n\u221a log(1/\u03b4)\n2m .\n5. For all r > 0, with probability at least 1\u2212 \u03b4 the following holds simultaneously for all f \u2208 H1,r:\nLD(f) \u2264 L\u0302S(f) + (\u221a 2 + 4\u221a\nlog 2 ) 2\u00b5r\u221a m \u221a (D\u2228max +O( \u221a 1/m)) log(2m+ 1)\n+\n( 2\n3 +\n8\n3 log 2\n) 2\u00b5r log(2m+ 1)\nm +M\n\u221a log(1/\u03b4)\n2m .\nTheorem 20. Let D be a probability distribution over \u03a3? \u00d7 R and let S = ((xi, yi)) m i=1 be a sample of m i.i.d. examples from D. Suppose the loss ` : R \u00d7 R \u2192 R+ is M -bounded and \u00b5-Lipschitz with respect to its first argument. Fix \u03b4 > 0. Then, the following hold:\n1. For all n \u2265 1 and p \u2208 [1,+\u221e], with probability at least 1\u2212 \u03b4 the following holds simultaneously for all A \u2208 An,p,1:\nLD(A) \u2264 L\u0302S(A)+ \u221a 8\u00b52n(kn+ 2) log(m+ 2)\nm +\n2\u00b5(LS + 2)\nm +3M\n\u221a log(2/\u03b4)\n2m .\n2. For all r > 0, with probability at least 1\u2212 \u03b4 the following holds simultaneously for all f \u2208 R1,r:\nLD(f) \u2264 L\u0302S(f) + 2\u00b5r \u221a 2CS log(2m)\nm + 3M\n\u221a log(2/\u03b4)\n2m .\n3. For all r > 0, with probability at least 1\u2212 \u03b4 the following holds simultaneously for all f \u2208 H1,r:\nLD(f) \u2264 L\u0302S(f) + (\u221a 2 + 4\u221a\nlog 2\n) 2\u00b5r \u221a WS log(2m+ 1)\nm\n+\n( 2\n3 +\n8\n3 log 2\n) 2\u00b5r log(2m+ 1)\nm + 3M\n\u221a log(2/\u03b4)\n2m ."}, {"heading": "9 Conclusion", "text": "We presented the first algorithm-independent generalization bounds for learning with wide classes of WFAs. We introduced three ways to parametrize the complexity of WFAs and rational functions, each described by a different natural quantity associated with the automaton or function. We pointed out the merits of each description in the analysis of the problem of learning with WFAs, and proved upper bounds on the Rademacher complexity of several classes defined in terms of these parameters. An interesting property of these bounds is the appearance of different combinatorial parameters that tie the sample to the convergence rate: the length of the longest string LS for An,p,r; the maximum number of collisions CS for Rp,r; and, the minimum number of prefix or suffix collisions over all possible splits WS for Hp,r.\nAnother important feature of our bounds for the classes Hp,r is that they depend on spectral properties of Hankel matrices, which are commonly used in spectral learning algorithms for WFAs [31, 10]. We hope to exploit this connection in the future to provide more refined analyses of these learning algorithms. Our results can also be used to improve some aspects of existing spectral learning algorithms. For example, it might be possible to use the analysis of Theorem 11 for deriving strategies to help choose which prefixes and suffixes to consider in algorithms working with finite sub-blocks of an infinite Hankel matrix. This is a problem of practical relevance when working with large amounts of data which require balancing trade-offs between computation and accuracy [8].\nIt is possible to see that through a standard argument about the risk of the empirical risk minimizer, our generalization bounds can be used to establish that samples of size polynomial in the relevant parameters are enough to learn in all the classes considered. Nonetheless, the computational complexity of learning from such a sample might be hard, since we know this is the case for DFAs and PFAs [52, 36, 19]. In the case of DFAs, several authors have analyzed special cases which are tractable in polynomial time (e.g. [20] show DFAs are learnable from positive data generated by \u201ceasy\u201d distributions, and [55] showed that exact learning can be done efficiently when the sample contains short witnesses distinguishing every pair of states). For PFAs, spectral methods show that polynomial learnability is possible if a new parameter related to spectral properties of the Hankel matrix is added to the complexity [31]. In the case of general WFAs, there is no equivalent result identifying settings in which the problem is tractable. In [10], we proposed an efficient algorithm for\nlearning WFAs that works in two steps: a matrix completion procedure applied to Hankel matrices followed by a spectral method to obtain a WFA from such Hankel matrix. Although each of these two steps solves an optimization problem without local minima, it is not clear from the analysis that the solution of the combined procedure is close to the empirical risk minimizer of any of the classes introduced in this paper. Nonetheless, we expect that the tools developed in this paper will prove useful in analyzing variants of this algorithm and will also help design new algorithms for efficiently learning interesting classes of WFA."}], "references": [{"title": "On the computational complexity of approximating distributions by probabilistic automata", "author": ["Naoki Abe", "Manfred K Warmuth"], "venue": "Machine Learning,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 1992}, {"title": "Statistical modeling for unit selection in speech synthesis", "author": ["Cyril Allauzen", "Mehryar Mohri", "Michael Riley"], "venue": "In Proceedings of ACL,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2004}, {"title": "Sequence kernels for predicting protein essentiality", "author": ["Cyril Allauzen", "Mehryar Mohri", "Ameet Talwalkar"], "venue": "In Proceedings of ICML,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2008}, {"title": "Formal analysis of online algorithms", "author": ["Benjamin Aminof", "Orna Kupferman", "Robby Lampert"], "venue": "In Proceedings of ATVA,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2011}, {"title": "Model checking linear-time properties of probabilistic systems", "author": ["C. Baier", "M. Gr\u00f6\u00dfer", "F. Ciesinski"], "venue": "In Handbook of Weighted automata. Springer,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2009}, {"title": "Grammatical inference as a principal component analysis problem", "author": ["R. Bailly", "F. Denis", "L. Ralaivola"], "venue": "In ICML,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2009}, {"title": "Absolute convergence of rational series is semi-decidable", "author": ["Rapha\u00ebl Bailly", "Fran\u00e7ois Denis"], "venue": "Inf. Comput.,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2011}, {"title": "Spectral learning of weighted automata: A forward-backward perspective", "author": ["B. Balle", "X. Carreras", "F.M. Luque", "A. Quattoni"], "venue": "Machine Learning,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2014}, {"title": "Methods of moments for learning stochastic languages: Unified presentation and empirical comparison", "author": ["B. Balle", "W.L. Hamilton", "J. Pineau"], "venue": "In ICML,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2014}, {"title": "Spectral learning of general weighted automata via constrained matrix completion", "author": ["Borja Balle", "Mehryar Mohri"], "venue": "In NIPS,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2012}, {"title": "Learning weighted automata", "author": ["Borja Balle", "Mehryar Mohri"], "venue": "In CAI,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2015}, {"title": "A canonical form for weighted automata and applications to approximate minimization", "author": ["Borja Balle", "Prakash Panangaden", "Doina Precup"], "venue": "In Logic in Computer Science (LICS),", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2015}, {"title": "Rademacher and gaussian complexities: Risk bounds and structural results", "author": ["Peter L Bartlett", "Shahar Mendelson"], "venue": "In COLT,", "citeRegEx": "13", "shortCiteRegEx": "13", "year": 2001}, {"title": "Rational Series and Their Languages", "author": ["Jean Berstel", "Christophe Reutenauer"], "venue": null, "citeRegEx": "14", "shortCiteRegEx": "14", "year": 1988}, {"title": "Noncommutative rational series with applications", "author": ["Jean Berstel", "Christophe Reutenauer"], "venue": null, "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2011}, {"title": "Closing the learning-planning loop with predictive state representations", "author": ["B. Boots", "S. Siddiqi", "G. Gordon"], "venue": "In RSS,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2009}, {"title": "The OCRopus open source OCR system", "author": ["Thomas M. Breuel"], "venue": "In Proceedings of IS&T/SPIE,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2008}, {"title": "Realizations by stochastic finite automata", "author": ["Jack W. Carlyle", "Azaria Paz"], "venue": "J. Comput. Syst. Sci.,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 1971}, {"title": "Pre-reduction graph products: Hardnesses of properly learning dfas and approximating edp on dags", "author": ["P. Chalermsook", "B. Laekhanukit", "D. Nanongkai"], "venue": "In Proceedings of FOCS,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2014}, {"title": "Partially distribution-free learning of regular languages from positive samples", "author": ["Alexander Clark", "Franck Thollard"], "venue": "In Proceedings of the 20th international conference on Computational Linguistics,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2004}, {"title": "Rational kernels: Theory and algorithms", "author": ["Corinna Cortes", "Patrick Haffner", "Mehryar Mohri"], "venue": "Journal of Machine Learning Research,", "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2004}, {"title": "Lp distance and equivalence of probabilistic automata", "author": ["Corinna Cortes", "Mehryar Mohri", "Ashish Rastogi"], "venue": "International Journal of Foundations of Computer Science,", "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2007}, {"title": "Hierarchical phrase-based translation with weighted finite-state transducers and shallow-n grammars", "author": ["A. de Gispert", "G. Iglesias", "G. Blackwood", "E.R. Banga", "W. Byrne"], "venue": "Computational Linguistics,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2010}, {"title": "Combinatorial methods in density estimation", "author": ["Luc Devroye", "G\u00e1bor Lugosi"], "venue": null, "citeRegEx": "24", "shortCiteRegEx": "24", "year": 2001}, {"title": "Handbook of weighted automata", "author": ["Manfred Droste", "Werner Kuich", "Heiko Vogler", "editors"], "venue": "EATCS Monographs on Theoretical Computer Science. Springer,", "citeRegEx": "25", "shortCiteRegEx": "25", "year": 2009}, {"title": "Uniform central limit theorems, volume 23", "author": ["Richard M Dudley"], "venue": null, "citeRegEx": "26", "shortCiteRegEx": "26", "year": 1999}, {"title": "Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids", "author": ["Richard Durbin", "Sean R. Eddy", "Anders Krogh", "Graeme J. Mitchison"], "venue": null, "citeRegEx": "27", "shortCiteRegEx": "27", "year": 1998}, {"title": "Automata, Languages and Machines, volume A", "author": ["Samuel Eilenberg"], "venue": null, "citeRegEx": "28", "shortCiteRegEx": "28", "year": 1974}, {"title": "Matrices de Hankel", "author": ["M. Fliess"], "venue": "Journal de Mathe\u0301matiques Pures et Applique\u0301es,", "citeRegEx": "29", "shortCiteRegEx": "29", "year": 1974}, {"title": "Modelling sparse dynamical systems with compressed predictive state representations", "author": ["W.L. Hamilton", "M.M. Fard", "J. Pineau"], "venue": "In ICML,", "citeRegEx": "30", "shortCiteRegEx": "30", "year": 2013}, {"title": "A spectral algorithm for learning hidden Markov models", "author": ["D. Hsu", "S.M. Kakade", "T. Zhang"], "venue": "In COLT,", "citeRegEx": "31", "shortCiteRegEx": "31", "year": 2009}, {"title": "Image compression using weighted finite automata", "author": ["Karel Culik II", "Jarkko Kari"], "venue": "Computers & Graphics,", "citeRegEx": "32", "shortCiteRegEx": "32", "year": 1993}, {"title": "Vc-dimensions of finite automata and commutative finite automata with k letters and n states", "author": ["Yoshiyasu Ishigami", "Sei\u2019ichi Tani"], "venue": "Discrete Applied Mathematics,", "citeRegEx": "33", "shortCiteRegEx": "33", "year": 1997}, {"title": "Regular models of phonological rule systems", "author": ["Ronald M. Kaplan", "Martin Kay"], "venue": "Computational Linguistics,", "citeRegEx": "34", "shortCiteRegEx": "34", "year": 1994}, {"title": "The replace operator", "author": ["Lauri Karttunen"], "venue": "In Proceedings of ACL,", "citeRegEx": "35", "shortCiteRegEx": "35", "year": 1995}, {"title": "Cryptographic limitations on learning boolean formulae and finite automata", "author": ["Michael J. Kearns", "Leslie G. Valiant"], "venue": "Journal of ACM,", "citeRegEx": "36", "shortCiteRegEx": "36", "year": 1994}, {"title": "Rademacher processes and bounding the risk of function learning", "author": ["Vladimir Koltchinskii", "Dmitry Panchenko"], "venue": "In High Dimensional Probability II,", "citeRegEx": "37", "shortCiteRegEx": "37", "year": 2000}, {"title": "Semirings, Automata, Languages. Number 5 in EATCS Monographs on Theoretical Computer Science", "author": ["Werner Kuich", "Arto Salomaa"], "venue": null, "citeRegEx": "38", "shortCiteRegEx": "38", "year": 1986}, {"title": "Low-rank spectral learning with weighted loss functions", "author": ["A. Kulesza", "N. Jiang", "S. Singh"], "venue": "In AISTATS,", "citeRegEx": "39", "shortCiteRegEx": "39", "year": 2015}, {"title": "Low-Rank Spectral Learning", "author": ["Alex Kulesza", "N Raj Rao", "Satinder Singh"], "venue": "In AISTATS,", "citeRegEx": "40", "shortCiteRegEx": "40", "year": 2014}, {"title": "Some applications of concentration inequalities to statistics", "author": ["Pascal Massart"], "venue": "Annales de la Faculte\u0301 des Sciences de Toulouse,", "citeRegEx": "42", "shortCiteRegEx": "42", "year": 2000}, {"title": "A trace inequality of John von Neumann", "author": ["L. Mirsky"], "venue": "Monatshefte fr Mathematik,", "citeRegEx": "43", "shortCiteRegEx": "43", "year": 1975}, {"title": "Finite-state transducers in language and speech processing", "author": ["Mehryar Mohri"], "venue": "Computational Linguistics,", "citeRegEx": "44", "shortCiteRegEx": "44", "year": 1997}, {"title": "Weighted automata algorithms. In Handbook of Weighted Automata, Monographs in Theoretical Computer Science, pages 213\u2013254", "author": ["Mehryar Mohri"], "venue": null, "citeRegEx": "45", "shortCiteRegEx": "45", "year": 2009}, {"title": "Weighted automata in text and speech processing", "author": ["Mehryar Mohri", "Fernando Pereira", "Michael Riley"], "venue": "In Proceedings of ECAI-96 Workshop on Extended finite state models of language,", "citeRegEx": "46", "shortCiteRegEx": "46", "year": 1996}, {"title": "Dynamic compilation of weighted context-free grammars", "author": ["Mehryar Mohri", "Fernando C.N. Pereira"], "venue": "In Proceedings of COLING-ACL,", "citeRegEx": "47", "shortCiteRegEx": "47", "year": 1998}, {"title": "Speech recognition with weighted finite-state transducers", "author": ["Mehryar Mohri", "Fernando C.N. Pereira", "Michael Riley"], "venue": "In Handbook on Speech Processing and Speech Comm. Springer,", "citeRegEx": "48", "shortCiteRegEx": "48", "year": 2008}, {"title": "Foundations of machine learning", "author": ["Mehryar Mohri", "Afshin Rostamizadeh", "Ameet Talwalkar"], "venue": "MIT press,", "citeRegEx": "49", "shortCiteRegEx": "49", "year": 2012}, {"title": "An efficient compiler for weighted rewrite rules", "author": ["Mehryar Mohri", "Richard Sproat"], "venue": "In Proceedings of ACL,", "citeRegEx": "50", "shortCiteRegEx": "50", "year": 1996}, {"title": "Speech recognition by composition of weighted finite automata. In Finite-State Language Processing", "author": ["Fernando Pereira", "Michael Riley"], "venue": null, "citeRegEx": "51", "shortCiteRegEx": "51", "year": 1997}, {"title": "The minimum consistent DFA problem cannot be approximated within any polynomial", "author": ["Leonard Pitt", "Manfred K. Warmuth"], "venue": "Journal of the ACM,", "citeRegEx": "52", "shortCiteRegEx": "52", "year": 1993}, {"title": "Automata-Theoretic Aspects of Formal Power Series", "author": ["Arto Salomaa", "Matti Soittola"], "venue": null, "citeRegEx": "53", "shortCiteRegEx": "53", "year": 1978}, {"title": "A finite-state architecture for tokenization and graphemeto-phoneme conversion in multilingual text analysis", "author": ["Richard Sproat"], "venue": "In Proceedings of the ACL SIGDAT Workshop", "citeRegEx": "54", "shortCiteRegEx": "54", "year": 1995}, {"title": "Finite Automata: Behavior and Synthesis", "author": ["B Trakhtenbrot", "Y Barzdin"], "venue": null, "citeRegEx": "55", "shortCiteRegEx": "55", "year": 1973}, {"title": "An introduction to matrix concentration inequalities", "author": ["Joel A. Tropp"], "venue": "Foundations and Trends R  \u00a9 in Machine Learning,", "citeRegEx": "56", "shortCiteRegEx": "56", "year": 2015}, {"title": "Lectures in Geometrical Functional Analysis", "author": ["Roman Vershynin"], "venue": null, "citeRegEx": "57", "shortCiteRegEx": "57", "year": 2009}], "referenceMentions": [{"referenceID": 27, "context": "The mathematical theory behind WFAs, that of rational power series, has been extensively studied in the past [28, 53, 38, 14] and has been more recently the topic of a dedicated handbook [25].", "startOffset": 109, "endOffset": 125}, {"referenceID": 51, "context": "The mathematical theory behind WFAs, that of rational power series, has been extensively studied in the past [28, 53, 38, 14] and has been more recently the topic of a dedicated handbook [25].", "startOffset": 109, "endOffset": 125}, {"referenceID": 37, "context": "The mathematical theory behind WFAs, that of rational power series, has been extensively studied in the past [28, 53, 38, 14] and has been more recently the topic of a dedicated handbook [25].", "startOffset": 109, "endOffset": 125}, {"referenceID": 13, "context": "The mathematical theory behind WFAs, that of rational power series, has been extensively studied in the past [28, 53, 38, 14] and has been more recently the topic of a dedicated handbook [25].", "startOffset": 109, "endOffset": 125}, {"referenceID": 24, "context": "The mathematical theory behind WFAs, that of rational power series, has been extensively studied in the past [28, 53, 38, 14] and has been more recently the topic of a dedicated handbook [25].", "startOffset": 187, "endOffset": 191}, {"referenceID": 31, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 209, "endOffset": 229}, {"referenceID": 44, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 209, "endOffset": 229}, {"referenceID": 49, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 209, "endOffset": 229}, {"referenceID": 42, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 209, "endOffset": 229}, {"referenceID": 46, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 209, "endOffset": 229}, {"referenceID": 52, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 304, "endOffset": 311}, {"referenceID": 1, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 304, "endOffset": 311}, {"referenceID": 33, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 364, "endOffset": 376}, {"referenceID": 34, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 364, "endOffset": 376}, {"referenceID": 48, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 364, "endOffset": 376}, {"referenceID": 45, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 389, "endOffset": 393}, {"referenceID": 22, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 415, "endOffset": 419}, {"referenceID": 26, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 436, "endOffset": 443}, {"referenceID": 2, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 436, "endOffset": 443}, {"referenceID": 20, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 478, "endOffset": 482}, {"referenceID": 4, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 523, "endOffset": 529}, {"referenceID": 3, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 523, "endOffset": 529}, {"referenceID": 16, "context": "WFAs are widely used in modern applications, perhaps most prominently in image processing and speech recognition where the terminology of weighted automata seems to have been first introduced and made popular [32, 46, 51, 44, 48], in several other speech processing applications such as speech synthesis [54, 2], in phonological and morphological rule compilation [34, 35, 50], in parsing [47], machine translation [23], bioinformatics [27, 3], sequence modeling and prediction [21], formal verification and model checking [5, 4], in optical character recognition [17], and in many other areas.", "startOffset": 564, "endOffset": 568}, {"referenceID": 30, "context": "The recent developments in spectral learning [31, 6] have triggered a renewed interest in the use of WFAs in machine learning, with several recent successes in \u2217Corresponding author: b.", "startOffset": 45, "endOffset": 52}, {"referenceID": 5, "context": "The recent developments in spectral learning [31, 6] have triggered a renewed interest in the use of WFAs in machine learning, with several recent successes in \u2217Corresponding author: b.", "startOffset": 45, "endOffset": 52}, {"referenceID": 7, "context": "natural language processing [8, 9] and reinforcement learning [16, 30].", "startOffset": 28, "endOffset": 34}, {"referenceID": 8, "context": "natural language processing [8, 9] and reinforcement learning [16, 30].", "startOffset": 28, "endOffset": 34}, {"referenceID": 15, "context": "natural language processing [8, 9] and reinforcement learning [16, 30].", "startOffset": 62, "endOffset": 70}, {"referenceID": 29, "context": "natural language processing [8, 9] and reinforcement learning [16, 30].", "startOffset": 62, "endOffset": 70}, {"referenceID": 30, "context": "The interest in spectral learning algorithms for WFAs is driven by the many appealing theoretical properties of such algorithms, which include their polynomial-time complexity, the absence of local minima, statistical consistency, and finite sample bounds \u00e0 la PAC [31].", "startOffset": 265, "endOffset": 269}, {"referenceID": 10, "context": "See [11] for a recent survey of algorithms for learning WFAs with a discussion of the different assumptions and learning models.", "startOffset": 4, "endOffset": 8}, {"referenceID": 9, "context": "For spectral learning of WFAs, an algorithm-dependent agnostic generalization bound was proven in [10] using a stability argument.", "startOffset": 98, "endOffset": 102}, {"referenceID": 9, "context": "However, while [10] proposed a broad family of algorithms for learning WFAs parametrized by several choices of loss functions and regularizations, their bounds hold only for one particular algorithm within this family.", "startOffset": 15, "endOffset": 19}, {"referenceID": 9, "context": "In this paper, we start the systematic development of algorithm-independent generalization bounds for learning with WFAs, which apply to all the algorithms proposed in [10], as well as to others using WFAs as their hypothesis class.", "startOffset": 168, "endOffset": 172}, {"referenceID": 36, "context": "The use of Rademacher complexity to derive generalization bounds is standard [37] (see also [13] and [49]).", "startOffset": 77, "endOffset": 81}, {"referenceID": 12, "context": "The use of Rademacher complexity to derive generalization bounds is standard [37] (see also [13] and [49]).", "startOffset": 92, "endOffset": 96}, {"referenceID": 47, "context": "The use of Rademacher complexity to derive generalization bounds is standard [37] (see also [13] and [49]).", "startOffset": 101, "endOffset": 105}, {"referenceID": 47, "context": "see [49] and references therein).", "startOffset": 4, "endOffset": 8}, {"referenceID": 32, "context": "The VC-dimension of deterministic finite automata (DFAs) with n states over an alphabet of size k was shown by [33] to be in O(kn log n).", "startOffset": 111, "endOffset": 115}, {"referenceID": 0, "context": "For probabilistic finite automata (PFAs), it was shown by [1] that, in an agnostic setting, a sample of size \u00d5(kT n/\u03b5) is sufficient to learn a PFA with n states and k symbols whose log-loss error is at most \u03b5 away from the optimal one in the class when the error is measured on all strings of length T .", "startOffset": 58, "endOffset": 61}, {"referenceID": 39, "context": "Another recent line of work, which aims to provide guarantees for spectral learning of WFAs in the non-realizable setting, is the so-called low-rank spectral learning approach [40].", "startOffset": 176, "endOffset": 180}, {"referenceID": 38, "context": "This has led to interesting upper bounds on the approximation error between minimal WFAs of different sizes [39].", "startOffset": 108, "endOffset": 112}, {"referenceID": 11, "context": "See [12] for a polynomial-time algorithm for computing these approximations.", "startOffset": 4, "endOffset": 8}, {"referenceID": 27, "context": "Note that for the purpose of this paper we only consider weighted automata over the familiar field of real numbers with standard addition and multiplication (see [28, 53, 15, 38, 45] for more general definitions of WFAs over arbitrary semirings).", "startOffset": 162, "endOffset": 182}, {"referenceID": 51, "context": "Note that for the purpose of this paper we only consider weighted automata over the familiar field of real numbers with standard addition and multiplication (see [28, 53, 15, 38, 45] for more general definitions of WFAs over arbitrary semirings).", "startOffset": 162, "endOffset": 182}, {"referenceID": 14, "context": "Note that for the purpose of this paper we only consider weighted automata over the familiar field of real numbers with standard addition and multiplication (see [28, 53, 15, 38, 45] for more general definitions of WFAs over arbitrary semirings).", "startOffset": 162, "endOffset": 182}, {"referenceID": 37, "context": "Note that for the purpose of this paper we only consider weighted automata over the familiar field of real numbers with standard addition and multiplication (see [28, 53, 15, 38, 45] for more general definitions of WFAs over arbitrary semirings).", "startOffset": 162, "endOffset": 182}, {"referenceID": 43, "context": "Note that for the purpose of this paper we only consider weighted automata over the familiar field of real numbers with standard addition and multiplication (see [28, 53, 15, 38, 45] for more general definitions of WFAs over arbitrary semirings).", "startOffset": 162, "endOffset": 182}, {"referenceID": 51, "context": "Functions mapping strings to real numbers can also be viewed as non-commutative formal power series, which often helps deriving rigorous proofs in formal language theory [53, 15, 38].", "startOffset": 170, "endOffset": 182}, {"referenceID": 14, "context": "Functions mapping strings to real numbers can also be viewed as non-commutative formal power series, which often helps deriving rigorous proofs in formal language theory [53, 15, 38].", "startOffset": 170, "endOffset": 182}, {"referenceID": 37, "context": "Functions mapping strings to real numbers can also be viewed as non-commutative formal power series, which often helps deriving rigorous proofs in formal language theory [53, 15, 38].", "startOffset": 170, "endOffset": 182}, {"referenceID": 28, "context": "By the theorem of Fliess [29] (see also [18] and [15]), Hf has finite rank n if and only if f is rational and there exists a WFA A with n states computing f , that is, rank(f) = rank(Hf ).", "startOffset": 25, "endOffset": 29}, {"referenceID": 17, "context": "By the theorem of Fliess [29] (see also [18] and [15]), Hf has finite rank n if and only if f is rational and there exists a WFA A with n states computing f , that is, rank(f) = rank(Hf ).", "startOffset": 40, "endOffset": 44}, {"referenceID": 14, "context": "By the theorem of Fliess [29] (see also [18] and [15]), Hf has finite rank n if and only if f is rational and there exists a WFA A with n states computing f , that is, rank(f) = rank(Hf ).", "startOffset": 49, "endOffset": 53}, {"referenceID": 36, "context": "The Rademacher complexity of a hypothesis class can be used to derive generalization bounds for a variety of learning tasks [37, 13, 49].", "startOffset": 124, "endOffset": 136}, {"referenceID": 12, "context": "The Rademacher complexity of a hypothesis class can be used to derive generalization bounds for a variety of learning tasks [37, 13, 49].", "startOffset": 124, "endOffset": 136}, {"referenceID": 47, "context": "The Rademacher complexity of a hypothesis class can be used to derive generalization bounds for a variety of learning tasks [37, 13, 49].", "startOffset": 124, "endOffset": 136}, {"referenceID": 6, "context": "Membership in R1,r was shown to be semi-decidable in [7].", "startOffset": 53, "endOffset": 56}, {"referenceID": 21, "context": "On the other hand, membership in R2,r can be decided in polynomial time [22].", "startOffset": 72, "endOffset": 76}, {"referenceID": 11, "context": "The following result follows from [12] and gives a useful condition for the boundedness of Hf .", "startOffset": 34, "endOffset": 38}, {"referenceID": 21, "context": "Since membership in R2 is efficiently testable [22], a polynomial time algorithm from [12] can be used to compute \u2016f\u2016H,p and thus test membership in Hp,r.", "startOffset": 47, "endOffset": 51}, {"referenceID": 11, "context": "Since membership in R2 is efficiently testable [22], a polynomial time algorithm from [12] can be used to compute \u2016f\u2016H,p and thus test membership in Hp,r.", "startOffset": 86, "endOffset": 90}, {"referenceID": 23, "context": "[24]).", "startOffset": 0, "endOffset": 4}, {"referenceID": 55, "context": "3 in [57]).", "startOffset": 5, "endOffset": 9}, {"referenceID": 9, "context": "The second bound was proven in [10].", "startOffset": 31, "endOffset": 35}, {"referenceID": 40, "context": "Lemma 7 (Massart [42]).", "startOffset": 17, "endOffset": 21}, {"referenceID": 47, "context": "The lower bound is obtained using Khintchine\u2013Kahane\u2019s inequality (see appendix of [49]):", "startOffset": 82, "endOffset": 86}, {"referenceID": 41, "context": "Then, by von Neumann\u2019s trace inequality [43] and H\u00f6lder\u2019s inequality, the following holds:", "startOffset": 40, "endOffset": 44}, {"referenceID": 54, "context": "To bound the Rademacher complexity of Hp,r in the case p = 1 we will need the following moment bound for the operator norm of a random matrix from [56].", "startOffset": 147, "endOffset": 151}, {"referenceID": 54, "context": "2 [56]).", "startOffset": 2, "endOffset": 6}, {"referenceID": 25, "context": "where in the last inequality we used that the VC-dimension of E is 1, in which case Dudley\u2019s chaining method [26] yields Rm(E) \u2264 C \u221a 1/m for some universal constant C > 0.", "startOffset": 109, "endOffset": 113}, {"referenceID": 47, "context": "The proofs of these theorems are a straightforward combination of the bounds on the Rademacher complexity with well-known generalization bounds [49].", "startOffset": 144, "endOffset": 148}, {"referenceID": 30, "context": "Another important feature of our bounds for the classes Hp,r is that they depend on spectral properties of Hankel matrices, which are commonly used in spectral learning algorithms for WFAs [31, 10].", "startOffset": 189, "endOffset": 197}, {"referenceID": 9, "context": "Another important feature of our bounds for the classes Hp,r is that they depend on spectral properties of Hankel matrices, which are commonly used in spectral learning algorithms for WFAs [31, 10].", "startOffset": 189, "endOffset": 197}, {"referenceID": 7, "context": "This is a problem of practical relevance when working with large amounts of data which require balancing trade-offs between computation and accuracy [8].", "startOffset": 149, "endOffset": 152}, {"referenceID": 50, "context": "Nonetheless, the computational complexity of learning from such a sample might be hard, since we know this is the case for DFAs and PFAs [52, 36, 19].", "startOffset": 137, "endOffset": 149}, {"referenceID": 35, "context": "Nonetheless, the computational complexity of learning from such a sample might be hard, since we know this is the case for DFAs and PFAs [52, 36, 19].", "startOffset": 137, "endOffset": 149}, {"referenceID": 18, "context": "Nonetheless, the computational complexity of learning from such a sample might be hard, since we know this is the case for DFAs and PFAs [52, 36, 19].", "startOffset": 137, "endOffset": 149}, {"referenceID": 19, "context": "[20] show DFAs are learnable from positive data generated by \u201ceasy\u201d distributions, and [55] showed that exact learning can be done efficiently when the sample contains short witnesses distinguishing every pair of states).", "startOffset": 0, "endOffset": 4}, {"referenceID": 53, "context": "[20] show DFAs are learnable from positive data generated by \u201ceasy\u201d distributions, and [55] showed that exact learning can be done efficiently when the sample contains short witnesses distinguishing every pair of states).", "startOffset": 87, "endOffset": 91}, {"referenceID": 30, "context": "For PFAs, spectral methods show that polynomial learnability is possible if a new parameter related to spectral properties of the Hankel matrix is added to the complexity [31].", "startOffset": 171, "endOffset": 175}, {"referenceID": 9, "context": "In [10], we proposed an efficient algorithm for", "startOffset": 3, "endOffset": 7}], "year": 2016, "abstractText": "This paper studies the problem of learning weighted automata from a finite labeled training sample. We consider several general families of weighted automata defined in terms of three different measures: the norm of an automaton\u2019s weights, the norm of the function computed by an automaton, or the norm of the corresponding Hankel matrix. We present new data-dependent generalization guarantees for learning weighted automata expressed in terms of the Rademacher complexity of these families. We further present upper bounds on these Rademacher complexities, which reveal key new data-dependent terms related to the complexity of learning weighted automata.", "creator": "TeX"}}}