{"id": "1706.01554", "review": {"conference": "nips", "VERSION": "v1", "DATE_OF_SUBMISSION": "5-Jun-2017", "title": "Best of Both Worlds: Transferring Knowledge from Discriminative Learning to a Generative Visual Dialog Model", "abstract": "We present a novel training framework for neural sequence models, particularly for grounded dialog generation. The standard training paradigm for these models is maximum likelihood estimation (MLE), or minimizing the cross-entropy of the human responses. Across a variety of domains, a recurring problem with MLE trained generative neural dialog models (G) is that they tend to produce 'safe' and generic responses (\"I don't know\", \"I can't tell\"). In contrast, discriminative dialog models (D) that are trained to rank a list of candidate human responses outperform their generative counterparts; in terms of automatic metrics, diversity, and informativeness of the responses. However, D is not useful in practice since it can not be deployed to have real conversations with users. Rather, this training framework will focus primarily on the use of generative data, and will focus on the distribution of information between the different domains in the context of the analysis.\n\n\n\nIn the above discussion, we will describe a generalized approach to learning about neural sequence models. Given a strong, generalized model, we will describe a generalized approach to learning about neural sequence models, such as the \"Solo Brain\" paradigm. We will describe a generalized approach to learning about neural sequence models, such as the \"Solo Brain\" paradigm.\n\nOur approach is to analyze neural sequence models with a more generalized approach. For example, when a neural sequence is a collection of a number of neurons, it is able to represent each neural sequence in a new neural sequence, allowing us to identify each neural sequence as the whole of the new neural sequence. It is thus much easier to predict the distribution of information on the new neuron in the new neuron. For example, if one neuron is connected to a new neuron at a time and it is connected to the previous neuron at a time, it can be able to identify the entire neuron and its entire neural sequence by simply searching for the new neuron in the new neuron.\nIn this approach, we will focus on the distribution of information between the different neural sequence models, such as the \"Solo Brain\" paradigm. A large proportion of the neurons in a new neuron will be connected to the new neuron at a time, while the majority will be connected to the new neuron at a time and the majority will be connected to the new neuron at a time. This way, the new neuron will not have to be connected to the new neuron at a time in any way. In this model, the average", "histories": [["v1", "Mon, 5 Jun 2017 22:50:37 GMT  (644kb,D)", "http://arxiv.org/abs/1706.01554v1", "11 pages, 3 figures"], ["v2", "Fri, 27 Oct 2017 20:27:07 GMT  (888kb,D)", "http://arxiv.org/abs/1706.01554v2", "11 pages, 3 figures"]], "COMMENTS": "11 pages, 3 figures", "reviews": [], "SUBJECTS": "cs.CV cs.AI cs.CL", "authors": ["jiasen lu", "anitha kannan", "jianwei yang", "devi parikh", "dhruv batra"], "accepted": true, "id": "1706.01554"}, "pdf": {"name": "1706.01554.pdf", "metadata": {"source": "CRF", "title": "Best of Both Worlds: Transferring Knowledge from Discriminative Learning to a Generative Visual Dialog Model", "authors": ["Jiasen Lu", "Anitha Kannan", "Jianwei Yang", "Devi Parikh", "Dhruv Batra"], "emails": ["jiasenlu@vt.edu,", "akannan@fb.com,", "dbatra}@gatech.edu", "recall@10)."], "sections": [{"heading": "1 Introduction", "text": "One fundamental goal of artificial intelligence (AI) is the development of perceptually-grounded dialog agents \u2013 specifically, agents that can perceive or understand their environment (through vision, audio, or other sensors), and communicate their understanding with humans or other agents in natural language. Over the last few years, neural sequence models (e.g. [47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history. The standard training paradigm for neural dialog models is maximum likelihood estimation (MLE) or equivalently, minimizing the cross-entropy (under the model) of a \u2018ground-truth\u2019 human response. Across a variety of domains, a recurring problem with MLE trained neural dialog models is that they tend to produce \u2018safe\u2019 generic responses, such as \u2018Not sure\u2019 or \u2018I don\u2019t know\u2019 in text-only dialog [23], and \u2018I can\u2019t see\u2019 or \u2018I can\u2019t tell\u2019 in visual dialog [7, 8]. One reason for this emergent behavior is that the space of possible next utterances in a dialog is highly multi-modal (there are many possible paths\n\u2217Work was done while visiting Facebook AI Research.\nar X\niv :1\n70 6.\n01 55\n4v 1\n[ cs\n.C V\n] 5\nJ un\na dialog may take in the future). In the face of such highly multi-modal output distributions, models \u2018game\u2019 MLE by latching on to the head of the distribution or the frequent responses, which by nature tend to be generic and widely applicable. Such safe generic responses break the flow of a dialog and tend to disengage the human conversing with the agent, ultimately rendering the agent useless. It is clear that novel training paradigms are needed; that is the focus of this paper. One promising alternative to MLE training proposed by recent work [36, 27] is sequence-level training of neural sequence models, specifically, using reinforcement learning to optimize taskspecific sequence metrics such as BLEU [34], ROUGE [24], CIDEr [48]. Unfortunately, in the case of dialog, all existing automatic metrics correlate poorly with human judgment [26], which renders this alternative infeasible for dialog models. In this paper, inspired by the success of adversarial training [16], we propose to train a generative visual dialog model (G) to produce sequences that score highly under a discriminative visual dialog model (D). A discriminative dialog model receives as input a candidate list of possible responses and learns to sort this list from the training dataset. The generative dialog model (G) aims to produce a sequence that D will rank the highest in the list, as shown in Fig. 1 (a). Note that while our proposed approach is inspired by adversarial training, there are a number of subtle but crucial differences over generative adversarial networks (GANs). Unlike traditional GANs, one novelty in our setup is that our discriminator has access to more information than G \u2013 specifically, D receives a list of candidate responses and explicitly learns to reason about similarities and differences across candidates. In this process, D learns a task-dependent perceptual similarity [12, 19, 15] and learns to recognize multiple correct responses in the feature space. For example, as shown in Fig. 1 (b), given the image, dialog history, and question \u2018Do you see any bird?\u2019, besides the ground-truth answer \u2018No, I do not\u2019, D can also assign high scores to other options that are valid responses to the question, including the one generated by G: \u2018Not that I can see\u2019. In that sense, our proposed approach may be viewed as an instance of \u2018knowledge transfer\u2019 [17, 5] from D to G. We employ a metric-learning loss function and a self-attention answer encoding mechanism for D that makes it particularly conducive to this knowledge transfer by encouraging perceptually meaningful similarities to emerge. This is especially fruitful since prior work has demonstrated that discriminative dialog models significantly outperform their generative counterparts, but are not as useful since they necessarily need a list of candidate responses to rank, which is only available in a dialog dataset, not in real conversations with a user. In that context, our work aims to achieve the best of both worlds \u2013 the practical usefulness of G and the strong performance of D \u2013 via this knowledge transfer. Our primary technical contribution is an end-to-end trainable generative visual dialog model, where the generator receives gradients from the discriminator loss of the sequence sampled from G. Note that this is challenging because the output ofG is a sequence of discrete symbols, which na\u00efvely is not amenable to gradient-based training. We propose to leverage the recently proposed Gumbel-Softmax (GS) approximation to the discrete distribution [18, 30] \u2013 specifically, a Recurrent Neural Network (RNN) augmented with a sequence of GS samplers, which when coupled with the straight-through gradient estimator [2, 18] enables end-to-end differentiability. Our results show that our \u2018knowledge transfer\u2019 approach is indeed successful. Specifically, our discriminator-trained G outperforms the MLE-trained G by 1.7% on recall@5 on the VisDial dataset, essentially improving over state-of-the-art [7] by 2.43% recall@5 and 2.67% recall@10. Moreover, our generative model produces more diverse and informative responses (see Table 3). As a side contribution specific to this application, we introduce a novel encoder for neural visual dialog models, which maintains two separate memory banks \u2013 one for visual memory (where do we look in the image?) and another for textual memory (what facts do we know from the dialog history?), and outperforms the encoders used in prior work."}, {"heading": "2 Related Work", "text": "GANs for sequence generation. Generative Adversarial Networks (GANs) [16] have shown to be effective models for a wide range of applications involving continuous variables (e.g. images) c.f [10, 35, 22, 55]. More recently, they have also been used for discrete output spaces such as language generation \u2013 e.g. image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].\nThere are a few subtle but significant differences w.r.t. to our application, motivation, and approach. In these prior works, both the discriminator and the generator are trained in tandem, and from scratch. The goal of the discriminator in those settings has primarily been to discriminate \u2018fake\u2019 samples (i.e. generator\u2019s outputs) from \u2018real\u2019 samples (i.e. from training data). In contrast, we would like to transfer knowledge from the discriminator to the generator. We start with pre-trained D and G models suited for the task, and then transfer knowledge from D to G to further improve G, while keeping D fixed. As we show in our experiments, this procedure results in G producing diverse samples that are close in the embedding space to the ground truth, due to perceptual similarity learned in D. One can also draw connections between our work and Energy Based GAN (EBGAN) [54] \u2013 without the adversarial training aspect. The \u201cenergy\u201d in our case is a deep metric-learning based scoring mechanism, instantiated in the visual dialog application. Modeling image and text attention. Models for tasks at the intersection of vision and language \u2013 e.g., image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms. For image captioning, this may be attending to relevant regions in the image [49, 51, 28]. For VQA, this may be attending to relevant image regions alone [4, 50, 52] or co-attending to image regions and question words/phrases [29]. In the context of visual dialog, [7] uses attention to identify utterances in the dialog history that may be useful for answering the current question. However, when modeling the image, the entire image embedding is used to obtain the answer. In contrast, our proposed encoder HCIAE (Section 4.1) localizes the region in the image that can help reliably answer the question. In particular, in addition to the history and the question guiding the image attention, our visual dialog encoder also reasons about the history when identifying relevant regions of the image. This allows the model to implicitly resolve co-references in the text and ground them back in the image."}, {"heading": "3 Preliminaries: Visual Dialog", "text": "We begin by formally describing the visual dialog task setup as introduced by Das et al. [7]. The machine learning task is as follows. A visual dialog model is given as input an image I , caption c describing the image, a dialog history till round t\u2212 1,H = ( c\ufe38\ufe37\ufe37\ufe38\nH0 , (q1,a1)\ufe38 \ufe37\ufe37 \ufe38 H1 , . . . , (qt\u22121,at\u22121)\ufe38 \ufe37\ufe37 \ufe38 Ht\u22121 ), and\nthe followup question qt at round t. The visual dialog agent needs to return a valid response to the question. Given the problem setup, there are two broad classes of methods \u2013 generative and discriminative models. Generative models for visual dialog are trained by maximizing the log-likelihood of the ground truth answer sequence agtt \u2208 At given the encoded representation of the input (I,H, qt). On the other hand, discriminative models receive both an encoding of the input (I,H, qt) and as additional input a list of 100 candidate answers At = {a(1)t , . . . ,a (100) t }. These models effectively\nlearn to sort the list. Thus, by design, they cannot be used at test time without a list of candidates available."}, {"heading": "4 Approach: Backprop Through Discriminative Losses for Generative Training", "text": "In this section, we describe our approach to transfer knowledge from a discriminative visual dialog model (D) to generative visual dialog model (G). Fig. 1 (a) shows the overview of our approach. Given the input image I , dialog historyH , and question qt, the encoder converts the inputs into a joint representation et. The generator G takes et as input, and produces a distribution over answer sequences via a recurrent neural network (specifically an LSTM). At each word in the answer sequence, we use a Gumbel-Softmax sampler S to sample the answer token from that distribution. The discriminator D in it\u2019s standard form takes et, ground-truth answer a gt t and N \u2212 1 \u201cnegative\u201d answers {a\u2212t,i} N\u22121 i=1 as input, and learns an embedding space such that similarity(et, f(a gt t )) > similarity(et, f(a\u2212t,\u00b7)), where f(\u00b7) is the embedding function. When we enable the communication between D and G, we feed the sampled answer a\u0302t into discriminator, and optimize the generator G to produce samples that get higher scores in D\u2019s metric space. We now describe each component of our approach in detail."}, {"heading": "4.1 History-Conditioned Image Attentive Encoder (HCIAE)", "text": "An important characteristic in dialogs is the use of co-reference to avoid repeating entities that can be contextually resolved. In fact, in the VisDial dataset [7] nearly all (98%) dialogs involve at least one pronoun. This means that for a model to correctly answer a question, it would require a reliable mechanism for co-reference resolution. A common approach is to use an encoder architecture with an attention mechanism that implicitly performs co-reference resolution by identifying the portion of the dialog history that can help in answering the current question [7, 38, 39, 32]. while using a holistic representation for the image. Intuitively, one would also expect that the answer is also localized to regions in the image, and be consistent with the attended history. With this motivation, we propose a novel encoder architecture (called HCIAE) shown in Fig. 2. Our encoder first uses the current question to attend to the exchanges in the history, and then use the question and attended history to attend to the image, so as to obtain the final encoding.\n\u03b1ht = softmax(z h t ) (2)\nwhere 1 \u2208 Rt is a vector with all elements set to 1. Wh,Wq \u2208 Rt\u00d7d and wa \u2208 Rk are parameters to be learned. \u03b1 \u2208 Rk is the attention weight over history. The attended history feature m\u0302ht is a convex combination of columns of Mt, weighted appropriately by the elements of \u03b1ht . We further concatenatem q t and m\u0302 h t as the query vector and get the attended image feature v\u0302t in the similar manner. Subsequently, all three components are used to obtain the final embedding et:\net = tanh(We[m q t , m\u0302 h t , v\u0302t]) (3)\nwhereWe \u2208 Rd\u00d73d is weight parameters and [\u00b7] is the concatenation operation."}, {"heading": "4.2 Discriminator Loss", "text": "Discriminative visual dialog models produce a distribution over the candidate answer list At and maximize the log-likelihood of the correct option agtt . The loss function for D needs to be conducive for knowledge transfer. In particular, it needs to encourage perceptually meaningful similarities. Therefore, we use a metric-learning multi-class N-pair loss [43] defined as:\nLD = Ln\u2212pair ( {et,agtt , {a\u2212t,i} N\u22121 i=1 }, f ) = logistic loss\ufe37 \ufe38\ufe38 \ufe37 log ( 1 +\nN\u2211 i=1 exp ( e>t f(a \u2212 t,i)\u2212 e > t f(a gt t )\ufe38 \ufe37\ufe37 \ufe38\nscore margin\n)) (4)\nwhere f is an attention based LSTM encoder for the answer. This attention can help the discriminator better deal with paraphrases across answers. The attention weight is learnt through a 1-layer MLP over LSTM output at each time step. The N-pair loss objective encourages learning a space in which the ground truth answer is scored higher than other options, and at the same time, encourages options similar to ground truth answers to score better than dissimilar ones. This means that, unlike the multiclass logistic loss, the options that are correct but different from the correct option may not be overly penalized, and thus can be useful in providing a reliable signal to the generator. See Fig. 1 for an example. An added benefit of the n-pair loss is its computational efficiency: Batches can be constructed such that incorrect options for each example in the batch can be assigned on-the-fly. This leads to repeated use of the same options across the batch, and hence lesser computation."}, {"heading": "4.3 Discriminant Perceptual Loss and Knowledge Transfer from D to G", "text": "At a high-level, our approach for transferring knowledge from D to G is as follows: G repeatedly queries D with answers a\u0302t that it generates for an input embedding et to get feedback and update itself. In each such update, G\u2019s goal is to update its parameters to try and have a\u0302t score higher than the correct answer, agtt , under D\u2019s learned embedding and scoring function. Formally, the perceptual loss that G aims to optimize is given by:\nLG = L1\u2212pair ( {et, a\u0302t,agtt }, f ) = log ( 1 + exp ( e>t f(a gt t )\u2212 e>t f(a\u0302t) )) (5)\nwhere f is the embedding function learned by the discriminator as in (4). Intuitively, updating generator parameters to minimize LG can be interpreted as learning to produce an answer sequence a\u0302t that \u2018fools\u2019 the discriminator into believing that this answer should score higher than the human response agtt under the discriminator\u2019s learned embedding f(\u00b7) and scoring function. While it is straightforward to sample an answer a\u0302t from the generator and perform a forward pass through the discriminator, na\u00efvely, it is not possible to backpropagate the gradients to the generator parameters since sampling discrete symbols results in zero gradients w.r.t. the generator parameters. To overcome this, we leverage the recently introduced continuous relaxation of the categorical distribution \u2013 the Gumbel-softmax distribution or the Concrete distribution [18, 30]. At an intuitive level, the Gumbel-Softmax (GS) approximation uses the so called \u2018Gumbel-Max trick\u2019 to reparametrize sampling from a categorical distribution and replaces argmax with softmax to obtain a continuous relaxation of the discrete random variable. Formally, let x denote a K-ary categorical random variable with parameters denoted by (p1, . . . pK), or x \u223c Cat(p). Let ( gi )K 1\ndenote K IID samples from the standard Gumbel distribution, gi \u223c F (g) = e\u2212e \u2212g . Now, a sample from the Concrete distribution can be produced via the following transformation:\nyi = e(log pi+gi)/\u03c4\u2211K j=1 e (log pj+gj)/\u03c4 \u2200i \u2208 {1, . . . ,K} (6)\nwhere \u03c4 is a temperature parameter that control how close samples y from this Concrete distribution approximate the one-hot encoding of the categorical variable x. As illustrated in Fig. 1, we augment the LSTM in G with a sequence of GS samplers. Specifically, at each position in the answer sequence, we use a GS sampler to sample an answer token from that conditional distribution. When coupled with the straight-through gradient estimator [2, 18] this enables end-to-end differentiability. Specifically, during the forward pass we discretize the GS samples into discrete samples, and in the backward pass use the continuous relaxation to compute gradients. In our experiments, we held the temperature parameter fixed at 0.5."}, {"heading": "5 Experiments", "text": "Dataset and Setup. We evaluate our proposed approach on the VisDial dataset [7], which was collected by Das et al. by pairing two subjects on Amazon Mechanical Turk to chat about an image. One person was assigned the role of a \u2018questioner\u2019 and the other of \u2018answerer\u2019. One worker (the questioner) sees only a single line of text describing an image (caption from COCO [25]); the image remains hidden to the questioner. Their task is to ask questions about this hidden image to \u201cimagine the scene better\u201d. The second worker (the answerer) sees the image and caption and answers the questions. The two workers take turns asking and answering questions for 10 rounds. We perform experiments on VisDial v0.9 (the latest available release) containing 83k dialogs on COCO-train and 40k on COCO-val images, for a total of 1.2M dialog question-answer pairs. We split the 83k into 82k for train, 1k for val, and use the 40k as test, in a manner consistent with [7]. The caption is considered to be the first round in the dialog history. Evaluation Protocol. Following the evaluation protocol established in [7], we use a retrieval setting to evaluate the responses at each round in the dialog. Specifically, every question in VisDial is coupled with a list of 100 candidate answer options, which the models are asked to sort for evaluation purposes. D uses its score to rank these answer options, and G uses the log-likelihood of these options for ranking. Models are evaluated on standard retrieval metrics \u2013 (1) mean rank, (2) recall @k, and (3) mean reciprocal rank (MRR) \u2013 of the human response in the returned sorted list. Pre-processing. We truncate captions/questions/answers longer than 24/16/8 words respectively. We then build a vocabulary of words that occur at least 5 times in train, resulting in 8964 words. Training Details In our experiments, all 3 LSTMs are single layer with 512d hidden state. We use VGG-19 [42] to get the representation of image. We first rescale the images to be 224\u00d7 224 pixels, and take the output of last pooling layer (512\u00d7 7\u00d7 7) as image feature. We use the Adam optimizer with a base learning rate of 4e-4. We pre-train G using standard MLE for 20 epochs, and D with supervised training based on Eq (4) for 30 epochs. Following [43], we regularize the L2 norm of the embedding vectors to be small. Subsequently, we trainG with LG+\u03b1LMLE , which is a combination of discriminative perceptual loss and MLE loss. We set \u03b1 to be 0.5. We found that including LMLE (with teacher-forcing) is important for encouraging G to generate grammatically correct responses."}, {"heading": "5.1 Results and Analysis", "text": "Baselines. We compare our proposed techniques to the current state-of-art generative and discriminative models developed in [7]. Specifically, [7] introduced 3 encoding architectures \u2013 Late Fusion (LF), Hierarchical Recurrent Encoder (HRE), Memory Network (MN) \u2013 each trained with a generative (-G) and discriminative (-D) decoder. We compare to all 6 models. Our approaches. We present a few variants of our approach to systematically study the individual contributions of our training procedure, novel encoder (HCIAE), self-attentive answer encoding (ATT), and metric-loss (NP).\n\u2022 HCIAE-G-MLE is a generative model with our proposed encoder trained under the MLE objective. Comparing this variant to the generative baselines from [7] establishes the improvement due to our encoder (HCIAE).\n\u2022 HCIAE-G-DIS is a generative model with our proposed encoder trained under the mixed MLE and discriminator loss (knowledge transfer). This forms our best generative model. Comparing this model to HCIAE-G-MLE establishes the improvement due to our discriminative training.\n\u2022 HCIAE-D-MLE is a discriminative model with our proposed encoder, trained under the standard discriminative cross-entropy loss. The answer candidates are encoded using an LSTM (no attention). Comparing this variant to the discriminative baselines from [7] establishes the improvement due to our encoder (HCIAE) in the discriminative setting.\n\u2022 HCIAE-D-NP is a discriminative model with our proposed encoder, trained under the n-pair discriminative loss (as described in Section 4.2). The answer candidates are encoded using an LSTM (no attention). Comparing this variant to HCIAE-D-MLE establishes the improvement due to the n-pair loss.\n\u2022 HCIAE-D-NP-ATT is a discriminative model with our proposed encoder, trained under the n-pair discriminative loss (as described in Section 4.2), and using the self-attentive answer encoding. Comparing this variant to HCIAE-D-NP establishes the improvement due to the self-attention mechanism while encoding the answers.\nTable 1: Results (generative) on VisDial dataset.\nModel MRR R@1 R@5 R@10 Mean\nLF-G [7] 0.5199 41.83 61.78 67.59 17.07 HREA-G [7] 0.5242 42.28 62.33 68.17 16.79 MN-G [7] 0.5259 42.29 62.85 68.88 17.06\nHCIAE-G-MLE 0.5386 44.06 63.55 69.24 16.01 HCIAE-G-DIS 0.5467 44.35 65.28 71.55 14.23\nTable 2: Results (discriminative) on VisDial dataset.\nModel MRR R@1 R@5 R@10 Mean\nLF-D [7] 0.5807 43.82 74.68 84.07 5.78 HREA-D [7] 0.5868 44.82 74.81 84.36 5.66 MN-D [7] 0.5965 45.55 76.22 85.37 5.46\nHCIAE-D-MLE 0.6140 47.73 77.50 86.35 5.15 HCIAE-D-NP 0.6182 47.98 78.35 87.16 4.92 HCIAE-D-NP-ATT 0.6222 48.48 78.75 87.59 4.81\nResults. Tables 1, 2 present results for all our models and baselines in generative and discriminative settings. The key observations are:\n1. Main Results for HCIAE-G-DIS: Our final generative model with all \u2018bells and whistles\u2019, HCIAE-G-DIS, uniformly performs the best under all the metrics, outperforming the previous state-of-art model MN-G by 2.43% on R@5. This shows the importance of the knowledge transfer from the discriminator and the benefit from our encoder architecture.\n2. Knowledge transfer vs. encoder for G: To understand the relative importance of the proposed history conditioned image attentive encoder (HCIAE) and the knowledge transfer, we compared the performance of HCIAE-G-DIS with HCIAE-G-MLE, which uses our proposed encoder but without any feedback from the discriminator. This comparison highlights two points: first, HCIAE-G-MLE improves R@5 by 0.7% over the current state-of-art method (MN-D) confirming the benefits of our encoder. Secondly, and importantly, its performance is lower than HCIAE-G-DIS by 1.7% on R@5, confirming that the modifications to encoder alone will not be sufficient to gain improvements in answer generation; knowledge transfer from D greatly improves G.\n3. Metric loss vs. self-attentive answer encoding: In the purely discriminative setting, our final discriminative model (HCIAE-D-NP-ATT) also beats the performance of the corresponding state-of-art models [7] by 2.53% on R@5. The n-pair loss used in the discriminator is not only helpful for knowledge transfer but it also improves the performance of the discriminator by 0.85% on R@5 (compare HCIAE-D-NP to HCIAE-D-MLE). The improvements obtained by using the answer attention mechanism leads to an additional, albeit small, gains of 0.4% on R@5 to the discriminator performance (compare HCIAE-D-NP to HCIAE-D-NP-ATT)."}, {"heading": "5.2 Does updating discriminator help?", "text": "Recall that our model training happens as follows: we independently train the generative model HCIAE-G-MLE and the discriminative model HCIAE-D-NP-ATT. With HCIAE-G-MLE as the initialization, the generative model is updated based on the feedback from HCIAE-D-NP-ATT and this results in our final HCIAE-G-DIS. We performed two further experiments to answer the following questions:\n\u2022 What happens if we continue training HCIAE-D-NP-ATT in an adversarial setting? In particular, we continue training by maximizing the score of the ground truth answer agtt and minimizing the score of the generated answer a\u0302t, effectively setting up an adversarial training regime LD = \u2212LG. The resulting discriminator HCIAE-GAN1 has significant drop in performance, as can be seen in Table. 4 (45.78% R@5). This is perhaps expected because HCIAE-GAN1 updates its parameters based on only two answers, the ground truth and the generated sample (which is likely to be similar to ground truth). This wrecks the structure that HCIAE-D-NP-ATT had previously learned by leveraging additional incorrect options.\n\u2022 What happens if we continue structure-preserving training of HCIAE-D-NP-ATT? In addition to providing HCIAE-D-NP-ATT samples from G as fake answers, we also include incorrect options as negative answers so that the structure learned by the discriminator is preserved. HCIAE-D-NP-ATT continues to train under loss LD. In this case (HCIAE-GAN2 in Table. 4), we find that there is a small improvement in the performance of G. The additional computational overhead to training the discriminator supersedes the performance improvement. Also note that HCIAE-D-NP-ATT itself gets worse at the dialog task.\nOne might wonder, why not train a GAN for visual dialog? Formulating the task in a GAN setting would involve G and D training in tandem with D providing feedback as to whether a response that G generates is real or fake. We found this to be a particularly unstable setting, for two main reasons: First, consider the case when the ground truth answer and the generated answers are the same. This happens for answers that are typically short or \u2018cryptic\u2019 (e.g. \u2018yes\u2019). In this case, D can not train itself or provide feedback, as the answer is labeled both positive and negative. Second, in cases where the ground truth answer is descriptive but the generator provides a short answer, D can quickly become powerful enough to discard generated samples as fake. In this case, D is not able to provide any information to G to get better at the task. Our experience suggests that the discriminator, if one were to consider a \u2018GANs for visual dialog\u2019 setting, can not merely be focused on differentiating fake from real. It needs to be able to score similarity between the ground truth and other answers. Such a scoring mechanism provides a more reliable feedback to G. In fact, as we show in the previous two results, a pre-trained D that captures this structure is the key ingredient in sharing knowledge with G. The adversarial training of D is not central."}, {"heading": "5.3 Qualitative Comparison", "text": "In Table 3 we present a couple of qualitative examples that compares the responses generated by G-MLE and G-DIS. G-MLE predominantly produces \u2018safe\u2019 and less informative answers, such as\n\u2018Yes\u2019 and or \u2018I can\u2019t tell\u2019. In contrast, our proposed model G-DIS does so less frequently, and often generates more diverse yet informative responses (see 2nd example in particular)."}, {"heading": "6 Conclusion", "text": "Generative models for (visual) dialog are typically trained with an MLE objective. As a result, they tend to latch on to safe and generic responses. Discriminative (or retrieval) models on the other hand have been shown to significantly outperform their generative counterparts. However, discriminative models can not be deployed as dialog agents with a real user where canned candidate responses are not available. In this work, we propose transferring knowledge from a powerful discriminative visual dialog model to a generative model. We leverage the Gumbel-Softmax (GS) approximation to the discrete distribution \u2013specifically, a RNN augmented with a sequence of GS samplers, coupled with a ST gradient estimator for end-to-end differentiability. We also propose a novel visual dialog encoder that reasons about image-attention informed by the history of the dialog; and employ a metric learning loss along with a self-attentive answer encoding to enable the discriminator to learn meaningful structure in dialog responses. The result is a generative visual dialog model that significantly outperforms state-of-the-art."}], "references": [{"title": "Vqa: Visual question answering", "author": ["Stanislaw Antol", "Aishwarya Agrawal", "Jiasen Lu", "Margaret Mitchell", "Dhruv Batra", "C Lawrence Zitnick", "Devi Parikh"], "venue": "In Proceedings of the IEEE International Conference on Computer Vision,", "citeRegEx": "1", "shortCiteRegEx": "1", "year": 2015}, {"title": "Estimating or propagating gradients through stochastic neurons for conditional computation", "author": ["Yoshua Bengio", "Nicholas L\u00e9onard", "Aaron C. Courville"], "venue": "CoRR, abs/1308.3432,", "citeRegEx": "2", "shortCiteRegEx": "2", "year": 2013}, {"title": "Learning end-to-end goal-oriented dialog", "author": ["Antoine Bordes", "Jason Weston"], "venue": "arXiv preprint arXiv:1605.07683,", "citeRegEx": "3", "shortCiteRegEx": "3", "year": 2016}, {"title": "Abc-cnn: An attention based convolutional neural network for visual question answering", "author": ["Kan Chen", "Jiang Wang", "Liang-Chieh Chen", "Haoyuan Gao", "Wei Xu", "Ram Nevatia"], "venue": "arXiv preprint arXiv:1511.05960,", "citeRegEx": "4", "shortCiteRegEx": "4", "year": 2015}, {"title": "Net2net: Accelerating learning via knowledge transfer", "author": ["Tianqi Chen", "Ian Goodfellow", "Jonathon Shlens"], "venue": "arXiv preprint arXiv:1511.05641,", "citeRegEx": "5", "shortCiteRegEx": "5", "year": 2015}, {"title": "Towards diverse and natural image descriptions via a conditional gan", "author": ["Bo Dai", "Dahua Lin", "Raquel Urtasun", "Sanja Fidler"], "venue": "arXiv preprint arXiv:1703.06029,", "citeRegEx": "6", "shortCiteRegEx": "6", "year": 2017}, {"title": "Visual Dialog", "author": ["Abhishek Das", "Satwik Kottur", "Khushi Gupta", "Avi Singh", "Deshraj Yadav", "Jos\u00e9 M.F. Moura", "Devi Parikh", "Dhruv Batra"], "venue": "In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,", "citeRegEx": "7", "shortCiteRegEx": "7", "year": 2017}, {"title": "Learning cooperative visual dialog agents with deep reinforcement learning", "author": ["Abhishek Das", "Satwik Kottur", "Jos\u00e9 MF Moura", "Stefan Lee", "Dhruv Batra"], "venue": "arXiv preprint arXiv:1703.06585,", "citeRegEx": "8", "shortCiteRegEx": "8", "year": 2017}, {"title": "Guesswhat?! visual object discovery through multi-modal dialogue", "author": ["Harm de Vries", "Florian Strub", "Sarath Chandar", "Olivier Pietquin", "Hugo Larochelle", "Aaron Courville"], "venue": "arXiv preprint arXiv:1611.08481,", "citeRegEx": "9", "shortCiteRegEx": "9", "year": 2016}, {"title": "Deep generative image models using a laplacian pyramid of adversarial networks", "author": ["Emily L. Denton", "Soumith Chintala", "Arthur Szlam", "Robert Fergus"], "venue": "Neural Information Processing Systems,", "citeRegEx": "10", "shortCiteRegEx": "10", "year": 2015}, {"title": "Long-term Recurrent Convolutional Networks for Visual Recognition and Description", "author": ["Jeff Donahue", "Lisa Anne Hendricks", "Sergio Guadarrama", "Marcus Rohrbach", "Subhashini Venugopalan", "Kate Saenko", "Trevor Darrell"], "venue": "In CVPR,", "citeRegEx": "11", "shortCiteRegEx": "11", "year": 2015}, {"title": "Generating images with perceptual similarity metrics based on deep networks", "author": ["Alexey Dosovitskiy", "Thomas Brox"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "12", "shortCiteRegEx": "12", "year": 2016}, {"title": "Are you talking to a machine? dataset and methods for multilingual image question answering", "author": ["Haoyuan Gao", "Junhua Mao", "Jie Zhou", "Zhiheng Huang", "Lei Wang", "Wei Xu"], "venue": "In NIPS,", "citeRegEx": "14", "shortCiteRegEx": "14", "year": 2015}, {"title": "A neural algorithm of artistic style", "author": ["Leon A Gatys", "Alexander S Ecker", "Matthias Bethge"], "venue": "arXiv preprint arXiv:1508.06576,", "citeRegEx": "15", "shortCiteRegEx": "15", "year": 2015}, {"title": "Generative adversarial nets", "author": ["Ian Goodfellow", "Jean Pouget-Abadie", "Mehdi Mirza", "Bing Xu", "David Warde-Farley", "Sherjil Ozair", "Aaron Courville", "Yoshua Bengio"], "venue": "In Advances in neural information processing systems,", "citeRegEx": "16", "shortCiteRegEx": "16", "year": 2014}, {"title": "Distilling the knowledge in a neural network", "author": ["Geoffrey Hinton", "Oriol Vinyals", "Jeff Dean"], "venue": "arXiv preprint arXiv:1503.02531,", "citeRegEx": "17", "shortCiteRegEx": "17", "year": 2015}, {"title": "Categorical reparameterization with gumbel-softmax", "author": ["Eric Jang", "Shixiang Gu", "Ben Poole"], "venue": "arXiv preprint arXiv:1611.01144,", "citeRegEx": "18", "shortCiteRegEx": "18", "year": 2016}, {"title": "Perceptual losses for real-time style transfer and super-resolution", "author": ["Justin Johnson", "Alexandre Alahi", "Li Fei-Fei"], "venue": "In European Conference on Computer Vision,", "citeRegEx": "19", "shortCiteRegEx": "19", "year": 2016}, {"title": "Deep visual-semantic alignments for generating image descriptions", "author": ["Andrej Karpathy", "Li Fei-Fei"], "venue": "In CVPR,", "citeRegEx": "20", "shortCiteRegEx": "20", "year": 2015}, {"title": "Gans for sequences of discrete elements with the gumbel-softmax distribution", "author": ["Matt J. Kusner", "Jos\u00e9 Miguel Hern\u00e1ndez-Lobato"], "venue": null, "citeRegEx": "21", "shortCiteRegEx": "21", "year": 2016}, {"title": "Photo-realistic single image super-resolution using a generative adversarial network", "author": ["Christian Ledig", "Lucas Theis", "Ferenc Huszar", "Jose Caballero", "Andrew P. Aitken", "Alykhan Tejani", "Johannes Totz", "Zehan Wang", "Wenzhe Shi"], "venue": null, "citeRegEx": "22", "shortCiteRegEx": "22", "year": 2016}, {"title": "Adversarial learning for neural dialogue generation", "author": ["Jiwei Li", "Will Monroe", "Tianlin Shi", "Alan Ritter", "Dan Jurafsky"], "venue": "arXiv preprint arXiv:1701.06547,", "citeRegEx": "23", "shortCiteRegEx": "23", "year": 2017}, {"title": "Rouge: A package for automatic evaluation of summaries", "author": ["Chin-Yew Lin"], "venue": "In ACL 2004 Workshop,", "citeRegEx": "24", "shortCiteRegEx": "24", "year": 2004}, {"title": "Microsoft coco: Common objects in context", "author": ["Tsung-Yi Lin", "Michael Maire", "Serge Belongie", "James Hays", "Pietro Perona", "Deva Ramanan", "Piotr Doll\u00e1r", "C Lawrence Zitnick"], "venue": "In European Conference on Computer Vision,", "citeRegEx": "25", "shortCiteRegEx": "25", "year": 2014}, {"title": "How not to evaluate your dialogue system: An empirical study of unsupervised evaluation metrics for dialogue response generation", "author": ["Chia-Wei Liu", "Ryan Lowe", "Iulian V Serban", "Michael Noseworthy", "Laurent Charlin", "Joelle Pineau"], "venue": "arXiv preprint arXiv:1603.08023,", "citeRegEx": "26", "shortCiteRegEx": "26", "year": 2016}, {"title": "Optimization of image description metrics using policy gradient methods", "author": ["Siqi Liu", "Zhenhai Zhu", "Ning Ye", "Sergio Guadarrama", "Kevin Murphy"], "venue": "arXiv preprint arXiv:1612.00370,", "citeRegEx": "27", "shortCiteRegEx": "27", "year": 2016}, {"title": "Knowing when to look: Adaptive attention via A visual sentinel for image captioning", "author": ["Jiasen Lu", "Caiming Xiong", "Devi Parikh", "Richard Socher"], "venue": null, "citeRegEx": "28", "shortCiteRegEx": "28", "year": 2016}, {"title": "Hierarchical question-image co-attention for visual question answering", "author": ["Jiasen Lu", "Jianwei Yang", "Dhruv Batra", "Devi Parikh"], "venue": "In Advances In Neural Information Processing Systems,", "citeRegEx": "29", "shortCiteRegEx": "29", "year": 2016}, {"title": "The concrete distribution: A continuous relaxation of discrete random variables", "author": ["Chris J Maddison", "Andriy Mnih", "Yee Whye Teh"], "venue": "arXiv preprint arXiv:1611.00712,", "citeRegEx": "30", "shortCiteRegEx": "30", "year": 2016}, {"title": "Ask your neurons: A neural-based approach to answering questions about images", "author": ["Mateusz Malinowski", "Marcus Rohrbach", "Mario Fritz"], "venue": "In ICCV,", "citeRegEx": "31", "shortCiteRegEx": "31", "year": 2015}, {"title": "Coherent dialogue with attention-based language models", "author": ["Hongyuan Mei", "Mohit Bansal", "Matthew R Walter"], "venue": "arXiv preprint arXiv:1611.06997,", "citeRegEx": "32", "shortCiteRegEx": "32", "year": 2016}, {"title": "Image-grounded conversations: Multimodal context for natural question and response generation", "author": ["Nasrin Mostafazadeh", "Chris Brockett", "Bill Dolan", "Michel Galley", "Jianfeng Gao", "Georgios P Spithourakis", "Lucy Vanderwende"], "venue": "arXiv preprint arXiv:1701.08251,", "citeRegEx": "33", "shortCiteRegEx": "33", "year": 2017}, {"title": "Bleu: a method for automatic evaluation of machine translation", "author": ["Kishore Papineni", "Salim Roukos", "Todd Ward", "Wei-Jing Zhu"], "venue": "In ACL,", "citeRegEx": "34", "shortCiteRegEx": "34", "year": 2002}, {"title": "Unsupervised representation learning with deep convolutional generative adversarial networks", "author": ["Alec Radford", "Luke Metz", "Soumith Chintala"], "venue": "CoRR, abs/1511.06434,", "citeRegEx": "35", "shortCiteRegEx": "35", "year": 2015}, {"title": "Sequence level training with recurrent neural networks", "author": ["Marc\u2019Aurelio Ranzato", "Sumit Chopra", "Michael Auli", "Wojciech Zaremba"], "venue": "arXiv preprint arXiv:1511.06732,", "citeRegEx": "36", "shortCiteRegEx": "36", "year": 2015}, {"title": "Exploring models and data for image question answering", "author": ["Mengye Ren", "Ryan Kiros", "Richard Zemel"], "venue": "In NIPS,", "citeRegEx": "37", "shortCiteRegEx": "37", "year": 2015}, {"title": "Building end-to-end dialogue systems using generative hierarchical neural network models", "author": ["Iulian V Serban", "Alessandro Sordoni", "Yoshua Bengio", "Aaron Courville", "Joelle Pineau"], "venue": "arXiv preprint arXiv:1507.04808,", "citeRegEx": "38", "shortCiteRegEx": "38", "year": 2015}, {"title": "A hierarchical latent variable encoder-decoder model for generating dialogues", "author": ["Iulian Vlad Serban", "Alessandro Sordoni", "Ryan Lowe", "Laurent Charlin", "Joelle Pineau", "Aaron Courville", "Yoshua Bengio"], "venue": "arXiv preprint arXiv:1605.06069,", "citeRegEx": "39", "shortCiteRegEx": "39", "year": 2016}, {"title": "A hierarchical latent variable encoder-decoder model for generating dialogues", "author": ["Iulian Vlad Serban", "Alessandro Sordoni", "Ryan Lowe", "Laurent Charlin", "Joelle Pineau", "Aaron Courville", "Yoshua Bengio"], "venue": "In Thirty-First AAAI Conference on Artificial Intelligence,", "citeRegEx": "40", "shortCiteRegEx": "40", "year": 2017}, {"title": "Speaking the same language: Matching machine to human captions by adversarial training", "author": ["Rakshith Shetty", "Marcus Rohrbach", "Lisa Anne Hendricks", "Mario Fritz", "Bernt Schiele"], "venue": null, "citeRegEx": "41", "shortCiteRegEx": "41", "year": 2017}, {"title": "Very deep convolutional networks for large-scale image recognition", "author": ["Karen Simonyan", "Andrew Zisserman"], "venue": "arXiv preprint arXiv:1409.1556,", "citeRegEx": "42", "shortCiteRegEx": "42", "year": 2014}, {"title": "Improved deep metric learning with multi-class n-pair loss objective", "author": ["Kihyuk Sohn"], "venue": "In Advances in Neural Information Processing Systems,", "citeRegEx": "43", "shortCiteRegEx": "43", "year": 2016}, {"title": "A neural network approach to context-sensitive generation of conversational responses", "author": ["Alessandro Sordoni", "Michel Galley", "Michael Auli", "Chris Brockett", "Yangfeng Ji", "Margaret Mitchell", "Jian- Yun Nie", "Jianfeng Gao", "Bill Dolan"], "venue": "arXiv preprint arXiv:1506.06714,", "citeRegEx": "44", "shortCiteRegEx": "44", "year": 2015}, {"title": "End-to-end optimization of goal-driven and visually grounded dialogue systems", "author": ["Florian Strub", "Harm de Vries", "Jeremie Mary", "Bilal Piot", "Aaron Courville", "Olivier Pietquin"], "venue": "arXiv preprint arXiv:1703.05423,", "citeRegEx": "45", "shortCiteRegEx": "45", "year": 2017}, {"title": "End-to-end memory networks", "author": ["Sainbayar Sukhbaatar", "Jason Weston", "Rob Fergus"], "venue": "In Advances in neural information processing systems,", "citeRegEx": "46", "shortCiteRegEx": "46", "year": 2015}, {"title": "Sequence to sequence learning with neural networks", "author": ["Ilya Sutskever", "Oriol Vinyals", "Quoc V Le"], "venue": "In Advances in neural information processing systems,", "citeRegEx": "47", "shortCiteRegEx": "47", "year": 2014}, {"title": "Cider: Consensus-based image description evaluation", "author": ["Ramakrishna Vedantam", "C Lawrence Zitnick", "Devi Parikh"], "venue": "In CVPR,", "citeRegEx": "48", "shortCiteRegEx": "48", "year": 2015}, {"title": "Show and tell: A neural image caption generator", "author": ["Oriol Vinyals", "Alexander Toshev", "Samy Bengio", "Dumitru Erhan"], "venue": "In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,", "citeRegEx": "49", "shortCiteRegEx": "49", "year": 2015}, {"title": "Ask, attend and answer: Exploring question-guided spatial attention for visual question answering", "author": ["Huijuan Xu", "Kate Saenko"], "venue": "In European Conference on Computer Vision,", "citeRegEx": "50", "shortCiteRegEx": "50", "year": 2016}, {"title": "Show, attend and tell: Neural image caption generation with visual attention", "author": ["Kelvin Xu", "Jimmy Ba", "Ryan Kiros", "Kyunghyun Cho", "Aaron C. Courville", "Ruslan Salakhutdinov", "Richard S. Zemel", "Yoshua Bengio"], "venue": "CoRR, abs/1502.03044,", "citeRegEx": "51", "shortCiteRegEx": "51", "year": 2015}, {"title": "Stacked attention networks for image question answering", "author": ["Zichao Yang", "Xiaodong He", "Jianfeng Gao", "Li Deng", "Alex Smola"], "venue": "In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition,", "citeRegEx": "52", "shortCiteRegEx": "52", "year": 2016}, {"title": "Seqgan: Sequence generative adversarial nets with policy gradient", "author": ["Lantao Yu", "Weinan Zhang", "Jun Wang", "Yong Yu"], "venue": "AAAI Conference on Artificial Intelligence,", "citeRegEx": "53", "shortCiteRegEx": "53", "year": 2017}, {"title": "Energy-based generative adversarial", "author": ["Junbo Jake Zhao", "Micha\u00ebl Mathieu", "Yann LeCun"], "venue": "network. CoRR,", "citeRegEx": "54", "shortCiteRegEx": "54", "year": 2016}, {"title": "Unpaired image-to-image translation using cycle-consistent adversarial networks", "author": ["Jun-Yan Zhu", "Taesung Park", "Phillip Isola", "Alexei A Efros"], "venue": "arXiv preprint arXiv:1703.10593,", "citeRegEx": "55", "shortCiteRegEx": "55", "year": 2017}], "referenceMentions": [{"referenceID": 45, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 0, "endOffset": 12}, {"referenceID": 42, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 0, "endOffset": 12}, {"referenceID": 44, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 0, "endOffset": 12}, {"referenceID": 42, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 117, "endOffset": 132}, {"referenceID": 38, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 117, "endOffset": 132}, {"referenceID": 21, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 117, "endOffset": 132}, {"referenceID": 2, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 117, "endOffset": 132}, {"referenceID": 6, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 165, "endOffset": 182}, {"referenceID": 8, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 165, "endOffset": 182}, {"referenceID": 7, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 165, "endOffset": 182}, {"referenceID": 31, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 165, "endOffset": 182}, {"referenceID": 43, "context": "[47, 44, 46]) have emerged as the dominant paradigm across a variety of setting and datasets \u2013 from text-only dialog [44, 40, 23, 3] to more recently, visual dialog [7, 9, 8, 33, 45], where an agent must answer a sequence of questions grounded in an image, requiring it to reason about both visual content and the dialog history.", "startOffset": 165, "endOffset": 182}, {"referenceID": 21, "context": "Across a variety of domains, a recurring problem with MLE trained neural dialog models is that they tend to produce \u2018safe\u2019 generic responses, such as \u2018Not sure\u2019 or \u2018I don\u2019t know\u2019 in text-only dialog [23], and \u2018I can\u2019t see\u2019 or \u2018I can\u2019t tell\u2019 in visual dialog [7, 8].", "startOffset": 199, "endOffset": 203}, {"referenceID": 6, "context": "Across a variety of domains, a recurring problem with MLE trained neural dialog models is that they tend to produce \u2018safe\u2019 generic responses, such as \u2018Not sure\u2019 or \u2018I don\u2019t know\u2019 in text-only dialog [23], and \u2018I can\u2019t see\u2019 or \u2018I can\u2019t tell\u2019 in visual dialog [7, 8].", "startOffset": 258, "endOffset": 264}, {"referenceID": 7, "context": "Across a variety of domains, a recurring problem with MLE trained neural dialog models is that they tend to produce \u2018safe\u2019 generic responses, such as \u2018Not sure\u2019 or \u2018I don\u2019t know\u2019 in text-only dialog [23], and \u2018I can\u2019t see\u2019 or \u2018I can\u2019t tell\u2019 in visual dialog [7, 8].", "startOffset": 258, "endOffset": 264}, {"referenceID": 34, "context": "One promising alternative to MLE training proposed by recent work [36, 27] is sequence-level training of neural sequence models, specifically, using reinforcement learning to optimize taskspecific sequence metrics such as BLEU [34], ROUGE [24], CIDEr [48].", "startOffset": 66, "endOffset": 74}, {"referenceID": 25, "context": "One promising alternative to MLE training proposed by recent work [36, 27] is sequence-level training of neural sequence models, specifically, using reinforcement learning to optimize taskspecific sequence metrics such as BLEU [34], ROUGE [24], CIDEr [48].", "startOffset": 66, "endOffset": 74}, {"referenceID": 32, "context": "One promising alternative to MLE training proposed by recent work [36, 27] is sequence-level training of neural sequence models, specifically, using reinforcement learning to optimize taskspecific sequence metrics such as BLEU [34], ROUGE [24], CIDEr [48].", "startOffset": 227, "endOffset": 231}, {"referenceID": 22, "context": "One promising alternative to MLE training proposed by recent work [36, 27] is sequence-level training of neural sequence models, specifically, using reinforcement learning to optimize taskspecific sequence metrics such as BLEU [34], ROUGE [24], CIDEr [48].", "startOffset": 239, "endOffset": 243}, {"referenceID": 46, "context": "One promising alternative to MLE training proposed by recent work [36, 27] is sequence-level training of neural sequence models, specifically, using reinforcement learning to optimize taskspecific sequence metrics such as BLEU [34], ROUGE [24], CIDEr [48].", "startOffset": 251, "endOffset": 255}, {"referenceID": 24, "context": "Unfortunately, in the case of dialog, all existing automatic metrics correlate poorly with human judgment [26], which renders this alternative infeasible for dialog models.", "startOffset": 106, "endOffset": 110}, {"referenceID": 14, "context": "In this paper, inspired by the success of adversarial training [16], we propose to train a generative visual dialog model (G) to produce sequences that score highly under a discriminative visual dialog model (D).", "startOffset": 63, "endOffset": 67}, {"referenceID": 11, "context": "In this process, D learns a task-dependent perceptual similarity [12, 19, 15] and learns to recognize multiple correct responses in the feature space.", "startOffset": 65, "endOffset": 77}, {"referenceID": 17, "context": "In this process, D learns a task-dependent perceptual similarity [12, 19, 15] and learns to recognize multiple correct responses in the feature space.", "startOffset": 65, "endOffset": 77}, {"referenceID": 13, "context": "In this process, D learns a task-dependent perceptual similarity [12, 19, 15] and learns to recognize multiple correct responses in the feature space.", "startOffset": 65, "endOffset": 77}, {"referenceID": 15, "context": "In that sense, our proposed approach may be viewed as an instance of \u2018knowledge transfer\u2019 [17, 5] from D to G.", "startOffset": 90, "endOffset": 97}, {"referenceID": 4, "context": "In that sense, our proposed approach may be viewed as an instance of \u2018knowledge transfer\u2019 [17, 5] from D to G.", "startOffset": 90, "endOffset": 97}, {"referenceID": 16, "context": "We propose to leverage the recently proposed Gumbel-Softmax (GS) approximation to the discrete distribution [18, 30] \u2013 specifically, a Recurrent Neural Network (RNN) augmented with a sequence of GS samplers, which when coupled with the straight-through gradient estimator [2, 18] enables end-to-end differentiability.", "startOffset": 108, "endOffset": 116}, {"referenceID": 28, "context": "We propose to leverage the recently proposed Gumbel-Softmax (GS) approximation to the discrete distribution [18, 30] \u2013 specifically, a Recurrent Neural Network (RNN) augmented with a sequence of GS samplers, which when coupled with the straight-through gradient estimator [2, 18] enables end-to-end differentiability.", "startOffset": 108, "endOffset": 116}, {"referenceID": 1, "context": "We propose to leverage the recently proposed Gumbel-Softmax (GS) approximation to the discrete distribution [18, 30] \u2013 specifically, a Recurrent Neural Network (RNN) augmented with a sequence of GS samplers, which when coupled with the straight-through gradient estimator [2, 18] enables end-to-end differentiability.", "startOffset": 272, "endOffset": 279}, {"referenceID": 16, "context": "We propose to leverage the recently proposed Gumbel-Softmax (GS) approximation to the discrete distribution [18, 30] \u2013 specifically, a Recurrent Neural Network (RNN) augmented with a sequence of GS samplers, which when coupled with the straight-through gradient estimator [2, 18] enables end-to-end differentiability.", "startOffset": 272, "endOffset": 279}, {"referenceID": 6, "context": "7% on recall@5 on the VisDial dataset, essentially improving over state-of-the-art [7] by 2.", "startOffset": 83, "endOffset": 86}, {"referenceID": 14, "context": "Generative Adversarial Networks (GANs) [16] have shown to be effective models for a wide range of applications involving continuous variables (e.", "startOffset": 39, "endOffset": 43}, {"referenceID": 9, "context": "f [10, 35, 22, 55].", "startOffset": 2, "endOffset": 18}, {"referenceID": 33, "context": "f [10, 35, 22, 55].", "startOffset": 2, "endOffset": 18}, {"referenceID": 20, "context": "f [10, 35, 22, 55].", "startOffset": 2, "endOffset": 18}, {"referenceID": 53, "context": "f [10, 35, 22, 55].", "startOffset": 2, "endOffset": 18}, {"referenceID": 5, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 17, "endOffset": 24}, {"referenceID": 39, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 17, "endOffset": 24}, {"referenceID": 21, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 44, "endOffset": 48}, {"referenceID": 51, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 69, "endOffset": 73}, {"referenceID": 51, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 227, "endOffset": 242}, {"referenceID": 5, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 227, "endOffset": 242}, {"referenceID": 39, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 227, "endOffset": 242}, {"referenceID": 21, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 227, "endOffset": 242}, {"referenceID": 19, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 409, "endOffset": 417}, {"referenceID": 39, "context": "image captioning [6, 41], dialog generation [23], or text generation [53] \u2013 by either viewing the generative model as a stochastic parametrized policy that is updated using REINFORCE with the discriminator providing the reward [53, 6, 41, 23], or (closer to our approach) through continuous relaxation of discrete variables through Gumbel-Softmax to enable backpropagating the response from the discriminator [21, 41].", "startOffset": 409, "endOffset": 417}, {"referenceID": 52, "context": "One can also draw connections between our work and Energy Based GAN (EBGAN) [54] \u2013 without the adversarial training aspect.", "startOffset": 76, "endOffset": 80}, {"referenceID": 10, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 19, "endOffset": 35}, {"referenceID": 18, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 19, "endOffset": 35}, {"referenceID": 47, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 19, "endOffset": 35}, {"referenceID": 0, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 63, "endOffset": 78}, {"referenceID": 12, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 63, "endOffset": 78}, {"referenceID": 29, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 63, "endOffset": 78}, {"referenceID": 35, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 63, "endOffset": 78}, {"referenceID": 6, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 94, "endOffset": 111}, {"referenceID": 8, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 94, "endOffset": 111}, {"referenceID": 7, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 94, "endOffset": 111}, {"referenceID": 43, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 94, "endOffset": 111}, {"referenceID": 31, "context": ", image captioning [11, 13, 20, 49], visual question answering [1, 14, 31, 37], visual dialog [7, 9, 8, 45, 33] \u2013 typically involve attention mechanisms.", "startOffset": 94, "endOffset": 111}, {"referenceID": 47, "context": "For image captioning, this may be attending to relevant regions in the image [49, 51, 28].", "startOffset": 77, "endOffset": 89}, {"referenceID": 49, "context": "For image captioning, this may be attending to relevant regions in the image [49, 51, 28].", "startOffset": 77, "endOffset": 89}, {"referenceID": 26, "context": "For image captioning, this may be attending to relevant regions in the image [49, 51, 28].", "startOffset": 77, "endOffset": 89}, {"referenceID": 3, "context": "For VQA, this may be attending to relevant image regions alone [4, 50, 52] or co-attending to image regions and question words/phrases [29].", "startOffset": 63, "endOffset": 74}, {"referenceID": 48, "context": "For VQA, this may be attending to relevant image regions alone [4, 50, 52] or co-attending to image regions and question words/phrases [29].", "startOffset": 63, "endOffset": 74}, {"referenceID": 50, "context": "For VQA, this may be attending to relevant image regions alone [4, 50, 52] or co-attending to image regions and question words/phrases [29].", "startOffset": 63, "endOffset": 74}, {"referenceID": 27, "context": "For VQA, this may be attending to relevant image regions alone [4, 50, 52] or co-attending to image regions and question words/phrases [29].", "startOffset": 135, "endOffset": 139}, {"referenceID": 6, "context": "In the context of visual dialog, [7] uses attention to identify utterances in the dialog history that may be useful for answering the current question.", "startOffset": 33, "endOffset": 36}, {"referenceID": 6, "context": "[7].", "startOffset": 0, "endOffset": 3}, {"referenceID": 6, "context": "In fact, in the VisDial dataset [7] nearly all (98%) dialogs involve at least one pronoun.", "startOffset": 32, "endOffset": 35}, {"referenceID": 6, "context": "A common approach is to use an encoder architecture with an attention mechanism that implicitly performs co-reference resolution by identifying the portion of the dialog history that can help in answering the current question [7, 38, 39, 32].", "startOffset": 226, "endOffset": 241}, {"referenceID": 36, "context": "A common approach is to use an encoder architecture with an attention mechanism that implicitly performs co-reference resolution by identifying the portion of the dialog history that can help in answering the current question [7, 38, 39, 32].", "startOffset": 226, "endOffset": 241}, {"referenceID": 37, "context": "A common approach is to use an encoder architecture with an attention mechanism that implicitly performs co-reference resolution by identifying the portion of the dialog history that can help in answering the current question [7, 38, 39, 32].", "startOffset": 226, "endOffset": 241}, {"referenceID": 30, "context": "A common approach is to use an encoder architecture with an attention mechanism that implicitly performs co-reference resolution by identifying the portion of the dialog history that can help in answering the current question [7, 38, 39, 32].", "startOffset": 226, "endOffset": 241}, {"referenceID": 41, "context": "Therefore, we use a metric-learning multi-class N-pair loss [43] defined as:", "startOffset": 60, "endOffset": 64}, {"referenceID": 16, "context": "To overcome this, we leverage the recently introduced continuous relaxation of the categorical distribution \u2013 the Gumbel-softmax distribution or the Concrete distribution [18, 30].", "startOffset": 171, "endOffset": 179}, {"referenceID": 28, "context": "To overcome this, we leverage the recently introduced continuous relaxation of the categorical distribution \u2013 the Gumbel-softmax distribution or the Concrete distribution [18, 30].", "startOffset": 171, "endOffset": 179}, {"referenceID": 1, "context": "When coupled with the straight-through gradient estimator [2, 18] this enables end-to-end differentiability.", "startOffset": 58, "endOffset": 65}, {"referenceID": 16, "context": "When coupled with the straight-through gradient estimator [2, 18] this enables end-to-end differentiability.", "startOffset": 58, "endOffset": 65}, {"referenceID": 6, "context": "We evaluate our proposed approach on the VisDial dataset [7], which was collected by Das et al.", "startOffset": 57, "endOffset": 60}, {"referenceID": 23, "context": "One worker (the questioner) sees only a single line of text describing an image (caption from COCO [25]); the image remains hidden to the questioner.", "startOffset": 99, "endOffset": 103}, {"referenceID": 6, "context": "We split the 83k into 82k for train, 1k for val, and use the 40k as test, in a manner consistent with [7].", "startOffset": 102, "endOffset": 105}, {"referenceID": 6, "context": "Following the evaluation protocol established in [7], we use a retrieval setting to evaluate the responses at each round in the dialog.", "startOffset": 49, "endOffset": 52}, {"referenceID": 40, "context": "We use VGG-19 [42] to get the representation of image.", "startOffset": 14, "endOffset": 18}, {"referenceID": 41, "context": "Following [43], we regularize the L norm of the embedding vectors to be small.", "startOffset": 10, "endOffset": 14}, {"referenceID": 6, "context": "We compare our proposed techniques to the current state-of-art generative and discriminative models developed in [7].", "startOffset": 113, "endOffset": 116}, {"referenceID": 6, "context": "Specifically, [7] introduced 3 encoding architectures \u2013 Late Fusion (LF), Hierarchical Recurrent Encoder (HRE), Memory Network (MN) \u2013 each trained with a generative (-G) and discriminative (-D) decoder.", "startOffset": 14, "endOffset": 17}, {"referenceID": 6, "context": "Comparing this variant to the generative baselines from [7] establishes the improvement due to our encoder (HCIAE).", "startOffset": 56, "endOffset": 59}, {"referenceID": 6, "context": "Comparing this variant to the discriminative baselines from [7] establishes the improvement due to our encoder (HCIAE) in the discriminative setting.", "startOffset": 60, "endOffset": 63}, {"referenceID": 6, "context": "LF-G [7] 0.", "startOffset": 5, "endOffset": 8}, {"referenceID": 6, "context": "07 HREA-G [7] 0.", "startOffset": 10, "endOffset": 13}, {"referenceID": 6, "context": "79 MN-G [7] 0.", "startOffset": 8, "endOffset": 11}, {"referenceID": 6, "context": "LF-D [7] 0.", "startOffset": 5, "endOffset": 8}, {"referenceID": 6, "context": "78 HREA-D [7] 0.", "startOffset": 10, "endOffset": 13}, {"referenceID": 6, "context": "66 MN-D [7] 0.", "startOffset": 8, "endOffset": 11}, {"referenceID": 6, "context": "self-attentive answer encoding: In the purely discriminative setting, our final discriminative model (HCIAE-D-NP-ATT) also beats the performance of the corresponding state-of-art models [7] by 2.", "startOffset": 186, "endOffset": 189}], "year": 2017, "abstractText": "We present a novel training framework for neural sequence models, particularly for grounded dialog generation. The standard training paradigm for these models is maximum likelihood estimation (MLE), or minimizing the cross-entropy of the human responses. Across a variety of domains, a recurring problem with MLE trained generative neural dialog models (G) is that they tend to produce \u2018safe\u2019 and generic responses (\u2018I don\u2019t know\u2019, \u2018I can\u2019t tell\u2019). In contrast, discriminative dialog models (D) that are trained to rank a list of candidate human responses outperform their generative counterparts; in terms of automatic metrics, diversity, and informativeness of the responses. However, D is not useful in practice since it can not be deployed to have real conversations with users. Our work aims to achieve the best of both worlds \u2013 the practical usefulness of G and the strong performance of D \u2013 via knowledge transfer from D to G. Our primary contribution is an end-to-end trainable generative visual dialog model, where G receives gradients from D as a perceptual (not adversarial) loss of the sequence sampled from G. We leverage the recently proposed Gumbel-Softmax (GS) approximation to the discrete distribution \u2013 specifically, a RNN augmented with a sequence of GS samplers, coupled with the straight-through gradient estimator to enable end-to-end differentiability. We also introduce a stronger encoder for visual dialog, and employ a self-attention mechanism for answer encoding along with a metric learning loss to aid D in better capturing semantic similarities in answer responses. Overall, our proposed model outperforms state-of-the-art on the VisDial dataset by a significant margin (2.67% on recall@10).", "creator": "LaTeX with hyperref package"}}}