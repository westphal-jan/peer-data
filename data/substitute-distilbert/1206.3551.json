{"id": "1206.3551", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "13-Jun-2012", "title": "Sensitivity analysis in decision circuits", "abstract": "ordinary circuits have got developed to perform efficient evaluation based influence diagrams [ landau and shachter, 2007 ], building on the advances in arithmetic circuits for belief network inference [ rao, 2003 ]. in the processes of model building and analysis, we perform sensitivity learning to understand how the probable solution changes in response to changes in the model. when possible decision events under uncertainty are represented as objective circuits, we can exploit for efficient solution process embodied in the resulting circuit and the wealth of derivative information available to compute the value of information for the uncertainties in the problem and the effects of changes to model parameters on the value and the optimal strategy.", "histories": [["v1", "Wed, 13 Jun 2012 14:18:02 GMT  (270kb)", "http://arxiv.org/abs/1206.3551v1", "Appears in Proceedings of the Twenty-Fourth Conference on Uncertainty in Artificial Intelligence (UAI2008)"]], "COMMENTS": "Appears in Proceedings of the Twenty-Fourth Conference on Uncertainty in Artificial Intelligence (UAI2008)", "reviews": [], "SUBJECTS": "cs.AI", "authors": ["debarun bhattacharjya", "ross d shachter"], "accepted": false, "id": "1206.3551"}, "pdf": {"name": "1206.3551.pdf", "metadata": {"source": "CRF", "title": "Sensitivity analysis in decision circuits", "authors": ["Debarun Bhattacharjya"], "emails": ["debarunb@stanford.edu,", "shachter@stanford.edu"], "sections": [{"heading": null, "text": "Decision circuits have been developed to perform efficient evaluation of influence diagrams [Bhattacharjya and Shachter, 2007], building on the advances in arithmetic circuits for belief network inference [Darwiche, 2003]. In the process of model building and analysis, we perform sensitivity analysis to understand how the optimal solution changes in response to changes in the model. When sequential decision problems under uncertainty are represented as decision circuits, we can exploit the efficient solution process embodied in the decision circuit and the wealth of derivative information available to compute the value of information for the uncertainties in the problem and the effects of changes to model parameters on the value and the optimal strategy."}, {"heading": "1 INTRODUCTION", "text": "Influence diagrams are powerful communication tools and computational aids for the analysis of practical decision problems [Howard and Matheson, 1984]. Decision circuits are a recent graphical representation that have been introduced for the efficient evaluation of influence diagrams [Bhattacharjya and Shachter, 2007]. In this paper, we show that they are also useful for efficient sensitivity analysis in influence diagrams.\nThe phrase sensitivity analysis refers, in general, to understanding how the output for a system varies as a result of changes in the system\u2019s input(s). For influence diagrams, one may be concerned about how the optimal solution and the certain equivalent (CE) change with respect to a change in the parameters, i.e. the probabilities and the utilities, or a change in the informational assumptions of the problem. There are many questions that we can use sensitivity analysis to\nanswer. For example, suppose we vary one parameter keeping all other parameters constant. For what range of this varying parameter is the current optimal strategy still optimal? How does the value change as this parameter is varied? What if the structure of the influence diagram changes and an uncertainty that would not have been revealed before we make a decision is now observed before the first decision is made? These are only some of the queries on the model that we seek to answer.\nSeveral issues in sensitivity analysis of Bayesian belief networks have been studied, using arithmetic circuits [Darwiche, 2003] for efficient solutions [Chan and Darwiche, 2002; 2004; 2006]. Our work builds on this body of research. Arithmetic circuits are graphical representations that have been shown to be efficient at performing inference on belief networks. Decision circuits promise similar benefits in the context of sequential decision problems.\nIn sections 2, 3 and 4 we briefly discuss some preliminaries, and review literature on circuits and sensitivity analysis in influence diagrams. In section 5, we introduce key ideas of performing sensitivity analysis with decision circuits for normal form influence diagrams, i.e. influence diagrams involving a single decision node with no parents. We show how to perform some basic sensitivity analysis with decision circuits, such as: plotting the certain equivalent in a one-way sensitivity analysis, finding the range of a parameter over which the current optimal stays optimal, and computing the value of information of uncertainties that are not affected by decisions, using partial derivatives. This serves as an introduction to section 6, where we present results for influence diagrams that may contain multiple decision nodes. We show the challenges and necessary modifications from the previous section. Finally, section 7 describes our conclusions and directions for future work."}, {"heading": "2 PRELIMINARIES", "text": "We assume that the reader is familiar with graphical models such as Bayesian belief networks and influence diagrams (see Shachter (2007) for an overview). Consider the two examples shown in Figure 1. Figure 1a presents a belief network with two nodes, labelled W (Weather) and B (Bring umbrella). We are interested in knowing whether a friend will bring an umbrella, and we believe that it is easier to model this if we condition on the weather. Figure 1b shows the influence diagram for a decision problem in which our friend chooses whether to bring an umbrella based on her belief about the weather and her preferences, represented by the node U (Utility). She will observe a weather Report (R) before she makes her decision. We use these examples to demonstrate the concepts in later sections.\nWe make a distinction between extensive and normal form influence diagrams. When there is only one decision node and it has no parents, the diagram is said to be in normal form [Savage, 1954; Raiffa, 1968]. We extend that definition to allow for evidence, i.e. that we observe certain variables taking on specific values. Alternatively, when decisions are represented by separate nodes, or when the diagram has a decision node with at least one parent, the diagram is said to be in extensive form. There can be a large number of strategies in an influence diagram, one for each possible combination of observed uncertainties and decision alternatives. Although it is possible to convert any extensive form influence diagram into a normal form influence diagram, it may not be efficient to do so. The influence diagram shown in Figure 1b is in extensive form because the decision node B has a parent R.\nIn this paper we assume that the influence diagram has a single value node, referred to as utility node U . When making decisions, we choose the alternative that maximizes the probability that utility variable U = 1. The parents of utility node U , pa(U), are called the value attributes and we assess P (U = 1|pa(U)) = u(v(pa(U))) where u(.) is a von Neumann-Morgenstern utility function [von Neumann and Morgenstern, 1947] such that U = 1 is at least\nas good and U = 0 is at least as bad as anything that can happen, and v(.) characterizes the value of the attributes in terms of a single numeraire, which we assume is dollars. Therefore, the certain equivalent (CE) of an uncertain V , given by u\u22121(E[u(V )]), represents the certain payment that the decision-maker finds indifferent to V . Our sensitivity results will be expressed in terms of the certain equivalent because the utility values used for the internal computations have no intrinsic meaning. We also assume that the utility function u(.) is strictly increasing and continuously differentiable. The most common utility functions are linear, u(v) = av + b, and exponential, u(v) = \u2212ae\u2212v/\u03c1 + b, where a > 0 and \u03c1 > 0, both of which allow us to express the value of information exactly in closed form.\nWe will present some sensitivity analysis results for extensive form influence diagrams with the help of the influence diagram shown in Figure 2. In this example, our friend will decide whether to Gather evidence (G) and purchase a weather report. Her information gathering decision and the report will be known to her when she decides whether to bring her umbrella. If our friend does not gather evidence, the report is not informative and always states \u201csunny\u201d. The conditional probability tables and the value function v(.) are shown in the figure. We assume that the decision maker has an exponential utility function u(.) with risk tolerance \u03c1 = .02. The optimal strategy is to gather evidence and bring the umbrella when the report says \u201crainy\u201d and not to bring the umbrella when the report says \u201csunny\u201d. The CE of the decision problem is $52.5."}, {"heading": "3 ARITHMETIC AND DECISION CIRCUITS", "text": "We review basic concepts regarding arithmetic and decision circuits in this section. Throughout this paper,\nvariables are denoted by upper-case letters (X) and their values by lower-case letters (x). A bold-faced letter indicates a set of variables. If X is a variable with parents Pa(X), then XPa(X) is called the family for variable X. The values of a binary variable X are denoted x and x\u0304."}, {"heading": "3.1 Arithmetic Circuits", "text": "Belief networks are associated with a unique multilinear function over two kinds of variables, evidence indicators and network parameters. An evidence indicator \u03bbx is a binary (0-1) variable, with \u03bbx = 0 whenever X has been observed taking another value, i.e. it is observed not to be x. There is an evidence indicator associated with each possible instantiation x of each network variable X. A network parameter \u03b8x|pa(X) represents a conditional probability, \u03b8x|pa(X) = P (x|pa(X)), and there is a network parameter for each possible instantation xpa(X) of family XPa(X). Each term in the multi-linear function corresponds to one instantiation z of all the network variables Z, involving the product of all evidence indicators and network parameters consistent with z. The multi-linear function for a belief network is given as f = \u2211 z \u220f xpa(X)\u223cz \u03bbx\u03b8x|pa(X) where the sum is over every instantiation of all variables in the network and xpa(X) \u223c z represents all families consistent with z. For example, consider the belief network of Figure 1a. Suppose that W and B are binary variables with states w and w\u0304, and b and b\u0304 respectively. The multi-linear function for this network is: f = \u03bbw\u03bbb\u03b8w\u03b8b|w+\u03bbw\u0304\u03bbb\u03b8w\u0304\u03b8b|w\u0304+\u03bbw\u03bbb\u0304\u03b8w\u03b8b\u0304|w+\u03bbw\u0304\u03bbb\u0304\u03b8w\u0304\u03b8b\u0304|w\u0304.\nThe multi-linear function is a useful construct for answering inference queries in belief networks. By setting the evidence indicators to 0 or 1, we can find the probability of observing any set of network variables E. For instance, if we assign evidence to be e = b\u0304 by setting \u03bbb = 0 and all the other three evidence indicators as 1, the function returns P (b\u0304) = \u03b8w\u03b8b\u0304|w +\u03b8w\u0304\u03b8b\u0304|w\u0304. In general, the evidence indicators help in summing the appropriate entries in the joint probability distribution table for computing the probability of the evidence, P (e). Furthermore, the partial derivatives of the multi-linear function also provide solutions to several common probabilistic inference queries. We list two lemmas with important relationships between inference queries and the multi-linear function, as proven in Darwiche (2003):\nLemma 1. For evidence e, we have: P (e) = f(e).\nLemma 2. For every variable X and evidence e such that X /\u2208 E, we have: P (x, e) = \u2202f\u2202\u03bbx (e).\nArithmetic circuits are graphical structures that efficiently represent, evaluate, and differentiate multi-\nlinear functions. An arithmetic circuit is a rooted, directed acyclic graph whose leaf nodes are constants or variables and all other nodes represent either summation or multiplication. The size of an arithmetic circuit is the number of edges it contains.\nThe value of the multi-linear function is computed at the root of the circuit by evaluating the circuit in an upward pass, starting from the leaves and ending at the root. The result is denoted as f(e), where f(e) = P (e) (see Lemma 1). We can calculate partial derivatives by differentiating the circuit through a subsequent downward pass, in which the parents are visited before the children. The upward and downward passes are also referred to as sweeps. For further details, please see Darwiche (2003).\nCompact arithmetic circuits have been devised for belief networks that had previously been intractable [Darwiche, 2002; Chavira and Darwiche, 2005]. The circuit is compiled offline, where both the local structure (in the form of determinism and context-specific independence) as well as the conditional independencies of the graph at the global level are exploited. Several inference queries on the network can then be processed online, through subsequent operations on the compiled arithmetic circuit. Efficient sensitivity analysis of the belief network is possible with sweeps of the compiled circuit."}, {"heading": "3.2 Decision Circuits", "text": "Decision circuits are arithmetic circuits augmented with maximization nodes. They represent the dynamic programming function corresponding to a sequential decision problem. The size of a decision circuit is the number of edges it contains. Figure 3 presents a decision circuit corresponding to the influence diagram shown in Figure 1b.\nDecision circuits for influence diagrams can be constructed in the variable elimination order [Bhattacharjya and Shachter, 2007], similar to a construction technique for arithmetic circuits [Darwiche, 2000]. The evidence indicator \u03bbd for decision D is initialized to 0 only if the alternative d is no longer available to the decision maker. The network parameter \u03b8d|pa(D) for a decision D is initialized to 1 if the alternative is conditionally available under scenario pa(D), and 0 otherwise. Once compiled, the decision circuit can be evaluated in an upward sweep analogous to evaluation in arithmetic circuits. Decision circuits are evaluated with evidence e\u2032 = e \u222a {U = 1} when e is observed. The best outcome U = 1 is also deemed to be observed since this is an MEU problem and therefore the goal is to find optimal policies that maximize the probability of the best outcome given the evidence. The value\nof the root node of the circuit is denoted g(e\u2032). The optimal strategy is computed on the upward sweep at the maximization nodes, where the alternative d\u2217 with the highest value is chosen, breaking ties arbitrarily. The network parameter \u03b8d|u is set to 0 for all other alternatives d. The circuit can be differentiated in a subsequent downward sweep, by treating the maximization nodes as summation nodes. Although optimal policies are determined on the upward sweep, the MEU and CE are calculated also using results from the downward sweep. Specifically, from Bhattacharjya and Shachter (2007): Lemma 3. MEU = g(e \u2032)\n\u2202g \u2202\u03bbu (e\u2032)+ \u2202g\u2202\u03bbu\u0304 (e\u2032)\n.\nLemma 4. For utility function u(.), we have: CE = u\u22121 (MEU)."}, {"heading": "4 SENSITIVITY ANALYSIS IN INFLUENCE DIAGRAMS", "text": "The conditional probabilities in an influence diagram can be difficult to assess due to the paucity of data, expert judgments about key uncertainties, the decision maker\u2019s imprecision regarding preferences, and several other practical reasons. As a result, it is often beneficial to inspect the change in the outputs of the decision model based on variations in the inputs of the model. Such issues fall under the umbrella of sensitivity analysis.\nSensitivity analysis has been an essential aspect of decision analysis throughout the field\u2019s development. Sensitivity analysis aids in identifying the model\u2019s critical elements, forming the basis for iterative refinement of the model, and can also be used after the analysis for defending a particular strategy to the decision maker\n[Howard, 1983]. Sensitivity plots displaying the certain equivalents of different strategies can help identify the important variables. Sensitivity analysis for decision problems can be broadly classified in terms of whether one parameter is varied while others are kept constant (one-way sensitivity analysis) or when multiple parameters are simultaneously varied (n-way sensitivity analysis). One-way sensitivity analysis throws light upon the critical model variables whereas n-way sensitivity analysis provides insights into the general robustness of the model.\nSensitivity analysis in belief networks explores the sensitivity of inference queries such as the probability of evidence and conditional marginal probabilities given the evidence, to the conditional probabilities of the network [Laskey, 1995; Castillo et al, 1997; Kjaerulff and van der Gaag, 2000; van der Gaag and Renooij, 2001]. Sensitivity to inference queries using arithmetic circuits has also been studied [Chan and Darwiche, 2002; 2004] as has the sensitivity of Most Probable Explanations to parameter changes [Chan and Darwiche, 2006]. Our work differs from this line of research in that it uses decision circuits to determine sensitivity of the optimal strategy and the certain equivalent to parameter changes in decision problems.\nTo perform sensitivity analysis for decision problems, we will vary the model output with respect to metaparameters, similar to Chan and Darwiche (2002) and Nielsen and Jensen (2003). For a variable X, we analyze sensitivity to all parameters of the form \u03b8x|pa(X) as linear functions of a meta-parameter \u03c4 . For example if X is a binary variable with no parents, we can set \u03b8x = \u03c4 and \u03b8x\u0304 = 1 \u2212 \u03c4 . In this paper we assume that there are K meta-parameters, denoted \u03c4k, k = 1, ...,K, each between 0 and 1, and that these meta-parameters are drawn explicitly in the decision circuit, although it is also possible to allow the metaparameters to be implicit [Chan and Darwiche, 2002]. We assume that each meta-parameter is associated with only one variable. This ensures that the root value of the decision circuit is a piecewise-linear function of each meta-parameter. This can be extended to cases where the model inputs are non-linear functions of the meta-parameters, such as sensitivity to risk tolerance."}, {"heading": "5 ANALYZING NORMAL FORM INFLUENCE DIAGRAMS", "text": "When there is only one decision node in an influence diagram and it has no parents, the diagram is said to be in normal form. We extend this definition to allow the observation that E = e. We discuss sensitivity analysis for normal form influence diagrams in this\nsection."}, {"heading": "5.1 Partial derivatives", "text": "Consider an influence diagram with a single decision node D that has no parents. Let X be an arbitrary uncertain variable, with parents Pa (Note that D can be a parent of X). The dynamic programming function corresponding to this normal form influence diagram is given by g = maxd \u03b8d\u03bbd \u2211 z \u220f x,pa(X)\u223cz \u03b8x|pa(X)\u03bbx where d is an alternative for decision node D. In normal form, each alternative represents a strategy. Let EUd be the expected utility for strategy d. Then MEU = maxdEUd, optimal strategy d\u2217 = argmaxdEUd and CE = u\u22121(MEU). We will discuss many of the normal form sensitivity results using the following theorem, which outlines the significance of derivatives of g(e\u2032) and g(e). These are the root values of the decision circuit evaluated at evidence e\u2032 and e, respectively.\nTheorem 1. If evidence e\u2032 = e \u222a {U = 1} and e are swept through a decision circuit constructed for a normal form influence diagram, then for any node v:\n(i) \u2202EUd\u2202v = \u2202 \u2202v\n[ \u2202g(e\u2032) \u2202\u03b8d\ng(e)\n] = g(e) \u22022g(e\u2032) \u2202\u03b8d\u2202v \u2212 \u2202g(e)\u2202v \u2202g(e\u2032) \u2202\u03b8d\n(g(e))2 .\n(ii) If MEUPI is the maximal expected utility with perfect information on uncertainty X, then: MEUPI =\u2211 x maxd \u2202EUd \u2202\u03bbx . (iii) \u2202CEd\u2202v = \u2202EUd \u2202v u\u2032(CEd) .\nProof. (i): On the downward sweep the maximization nodes are treated as summation nodes, therefore g = \u2211 d \u03b8d\u03bbd \u2211 z \u220f x,pa(X)\u223cz \u03b8x|pa(X)\u03bbx for the downward sweep. Differentiating g with respect to \u03b8d and evaluating at evidence e\u2032 results in P (U = 1, e|d) since only terms associated with alternative d remain in the summation. The expected utility of alternative d is P (U = 1|e, d), therefore EUd = 1P (e) \u2202g(e\u2032) \u2202\u03b8d\n. The result follows by recognizing that P (e) = g(e) (e is not responsive to any strategy d), and differentiating with respect to node v using the quotient rule of differentiation. (ii): MEUPI = \u2211 x P (x|e) maxd P (U = 1|e, x, d)\n= \u2211 x maxd P (U = 1, x|e, d)\n= \u2211 x maxd \u2202EUd \u2202\u03bbx\n. We have used some results from the proof of part (i), and the fact that the uncertain variable X is not affected by the decision, thus P (x|e) = P (x|e, d)\u2200d. (iii) EUd = u(CEd); the result follows from differentiating both sides with respect to v using the chain rule of differentiation.\nTheorem 1 presents a recipe for computing \u2202EUd\u2202v and \u2202CEd \u2202v for any node v in the circuit, using g(e), g(e \u2032)\nand their derivatives. The single and double derivatives of the form used in Theorem 1 can be obtained in time linear in the size of the circuit [Darwiche, 2000]. The double derivatives \u2202\n2g(e\u2032) \u2202\u03b8d\u2202v are computed by sweep-\ning \u2202g(e \u2032)\n\u2202\u03b8d , for all strategies d, down the circuit. Thus\nthe time complexity for obtaining \u2202EUd\u2202v for all nodes is O((NS)(dc)) where NS is the number of strategies and dc is the size of the decision circuit. Note that the slope of CEd with respect to v is not constant unless the utility function is linear; it will depend on the value of CEd in general."}, {"heading": "5.2 One-way sensitivity analysis plots", "text": "In this sub-section, we show how to create a graph of the certain equivalent for the decision problem as a function of a particular meta-parameter when all others are kept at their reference values.\nThe expected utility for a particular strategy is a multi-linear function of all the meta-parameters. Therefore, the expected utility for a particular strategy d is a linear function of a particular meta-parameter \u03c4k, keeping all other meta-parameters at their reference values. We denote this linear function as EUd = \u03b1d(\u03c4k). We already have a point on this line from the initial sweep used to evaluate the circuit, which we denote as (\u03c40k , \u03b1 0 d). We also have the slope of this line, since it equals the partial derivative from part (i) of Theorem 1 choosing v = \u03c4k. We denote the slope as \u03b1\u2032d,k. Plotting the decision problem\u2019s CE with respect to changes in \u03c4k entails applying the inverse utility function u\u22121(.) to the maximum of the lines for all strategies. If the required resolution is , then the number of points required between 0 and 1 for the plot is 1/ . The time complexity for preparing the plot for all meta-parameters, once we have the lines for expected utilities of all strategies with respect to all meta-parameters, is O(( 1 )(K)(NS)) where K is the number of meta-parameters and NS is the number of strategies.\nAnother approach to plotting the CE against a metaparameter is the standard method of sample points, where the decision problem is re-evaluated for every sample point over a range. If the required resolution is , then the time complexity of this approach for obtaining plots for all meta-parameters isO(( 1 )(K)(dc))."}, {"heading": "5.3 Admissible intervals", "text": "Another sensitivity question in the spirit of one-way sensitivity analysis is the following one. Suppose a certain meta-parameter is allowed to vary, keeping all other meta-parameters constant at their reference values. What is the range of this meta-parameter over\nwhich the current optimal strategy remains optimal? We call this range the admissible interval for a metaparameter. In other words, we investigate how robust the optimal strategy is, with respect to changes in any meta-parameter.\nThe admissible intervals are easy to obtain for normal form influence diagrams, based on the ideas from the previous subsection. Since we have the lines for the expected utilities of all strategies with respect to all meta-parameters, we can obtain the admissible intervals Ik for all meta-parameters simultaneously. Suppose \u2206+ and \u2206\u2212 are the admissible positive and negative changes to \u03c4k from its reference value \u03c40k such that d\u2217 stays optimal. We present the following theorem, without proof, for computing \u2206+, \u2206\u2212 and the intervals Ik. The proof entails finding the points at which another strategy overtakes d\u2217 and recognising that \u03c4k lies between 0 and 1. The time complexity for computing these intervals for all meta-parameters, once we have the lines for expected utilities of all strategies with respect to all meta-parameters, is O((K)(NS)).\nTheorem 2. For meta-parameter \u03c4k, the admissible positive change \u2206+ = minds.t.\u03b1\u2032d,k>\u03b1\u2032d\u2217,k\n[ \u03b10d\u2217\u2212\u03b1 0 d\n\u03b1\u2032d,k\u2212\u03b1 \u2032 d\u2217,k\n] ,\nthe admissible negative change \u2206\u2212 = maxds.t.\u03b1\u2032d,k<\u03b1\u2032d\u2217,k\n[ \u03b10d\u2217\u2212\u03b1 0 d\n\u03b1\u2032d,k\u2212\u03b1 \u2032 d\u2217,k\n] , and the admissible\ninterval Ik = [ max ( 0, \u03c40k + \u2206+ ) ,min ( 1, \u03c40k + \u2206\u2212 )] .\nBinary search is another possible approach for finding the admissible intervals. The admissible interval for any meta-parameter \u03c4k is a convex set due to the linearity of the expected utilities for all strategies with respect to \u03c4k. We can therefore locate the end-points of this interval by re-evaluating the circuit at points chosen by binary search to check if the current optimal strategy is still optimal. If the required resolution is , then the number of sample points needed for the binary search is O(\u2212 ln( )). Thus the time complexity of obtaining admissible intervals for all meta-parameters by this method is O((\u2212 ln( )(K)(dc))."}, {"heading": "5.4 Value of information", "text": "The value of information for a particular uncertainty is a useful sensitivity analysis query in sequential decision problems, specifying the maximum that the decision maker should be willing to pay to observe the uncertainty before making the first decision [Howard, 1966; Raiffa, 1968]. The double derivatives from part (i) of Theorem 1 can also compute the value of information for all uncertainties that are not affected by the decision, using part (ii) of Theorem 1 (choose v = \u03bbx). Here MEUPI is the maximal expected utility with perfect information on uncertain variable X. If the decision maker\u2019s utility function u(.) is linear or\nexponential, then the value of information of the uncertain variable X is the increase in the certain equivalent u\u22121(MEUPI) \u2212 u\u22121(MEU). In general, this is usually a good approximation for the value of information, even if the decision maker\u2019s utility function has a form other than linear or exponential [Raiffa, 1968].\nOnce we have the results from Theorem 1, computing the value of information involves summing and maximizing the partial derivatives. If the number of variables analyzed for value of information is ]var, and assuming that the maximum number of possibilities for all of these variables is bounded by some constant, then the time complexity for obtaining the value of information for all these variables is O((NS)(]var))."}, {"heading": "6 ANALYZING EXTENSIVE FORM INFLUENCE DIAGRAMS", "text": "Sensitivity analysis in normal form influence diagrams is relatively easy to describe because we explicitly represent all the strategies. Here we discuss techniques for analyzing extensive form influence diagrams. All of these methods can also apply to normal form diagrams. We assume the standard conditions in the influence diagram literature such as \u201cno forgetting\u201d [Howard and Matheson, 1984; Shachter, 1986]."}, {"heading": "6.1 One-way sensitivity analysis plots", "text": "The sample points method from the previous section directly applies for extensive form influence diagrams as well. It is also possible to plot the CE for a particular strategy s against \u03c4k using decision circuits. To do this, the network parameters for decisions \u03b8d|pa(D) need to be set according to s. Note that these have been preset according to the current optimal strategy s\u2217 after the initial upward sweep to evaluate the optimal strategy, hence they need to be reset if s 6= s\u2217. Once the network parameters for decisions are chosen appropriately, we can sweep up and down the decision circuit, treating the maximization nodes as summation nodes on both sweeps.\nFigure 4 is a one-way sensitivity analysis plot for the influence diagram shown in Figure 2, with respect to meta-parameter \u03c41, the probability that the weather is sunny. The plot displays the variation in the CE of the decision problem as well as the CE of the current optimal strategy s\u2217 with respect to changes in \u03c41. We observe that for most values of the meta-parameter, the CE for the decision problem does not vary too much, and thus the model is robust to small changes in \u03c41 around its current value of 0.6. The figure supports the intuition that for extreme values of the probability of sunshine, it is optimal to decide whether to bring\nCE vs. probability of sunshine\nthe umbrella or not without paying for the evidence."}, {"heading": "6.2 Admissible intervals", "text": "In this section, as an extension of our discussion in the section on normal form influence diagrams, we present the admissible interval algorithm, which returns bounds on the range over a particular metaparameter for which the optimal strategy s\u2217 remains optimal when all other meta-parameters are kept at their reference values. The algorithm finds these bounds for all meta-parameters simultaneously. We assume that the optimal strategy s\u2217 and the MEU have already been evaluated from initial sweeps through the decision circuit. The algorithm computes partial derivatives from a downward sweep starting from every maximization node. Before we describe the algorithm, we distinguish between active and inactive max nodes in the decision circuit. Inactive max nodes are those maximization nodes such that the derivative of the root with respect to these nodes, from the initial downward sweep, equals 0. This condition implies that an inactive node does not affect the expected utility of s\u2217, because there is 0 probability of being in that situation. Active max nodes are those max nodes in the circuit that are not inactive.\nAdmissible Interval Algorithm: Given a decision circuit constructed for an influence diagram and evaluated at evidence e\u2032, with optimal strategy s\u2217 and maximal expected utility MEU . Determine tight and weak bounds on admissible intervals, IkT and IkW for all meta-parameters \u03c4k, k = 1, 2, ...,K.\n1. Initialize all intervals IkT and IkW to [0, 1].\n2. Consider active max node v in the circuit. Find the partial double derivatives for all alternatives (as described in section 5) by sweeping down the\nsubcircuit rooted at v.\n3. Find intervals for all meta-parameters over which the current optimal alternative remains optimal (as described in section 5). Take the intersection of these intervals with the corresponding intervals Ik W from the previous iteration and reset IkW to\nthese new intervals.\n4. Repeat steps 2 and 3 above for inactive max node v in the circuit, using IkT in this case instead of Ik W .\n5. Repeat steps 2 and 3 above for all active and inactive max nodes in the decision circuit, updating the two corresponding kinds of intervals.\n6. Set IkT to be the intersection of the corresponding intervals IkT and IkW that were computed from previous steps.\nIf there are no inactive max nodes then clearly IkW = Ik T , and this interval is the exact admissible interval. We now prove the correctness of this algorithm.\nTheorem 3. If \u03c4k lies in the interval IkT then s\u2217 stays optimal and if \u03c4k does not lie in the interval IkW then s\u2217 is no longer optimal.\nProof. Consider any meta-parameter \u03c4k and its associated interval IkT . For \u03c4k \u2208 IkT , the equations in step 3 hold for all max nodes, since the resulting interval Ik T is the intersection of intervals. Thus s\u2217 is the optimal strategy when \u03c4k \u2208 IkT . Now if \u03c4k /\u2208 IkW , there must be an active max node v such that the current optimal alternative for v is no longer optimal. Therefore, s\u2217 can no longer be the optimal strategy. When \u03c4k /\u2208 IkT and \u03c4k \u2208 IkW , we cannot be sure about whether s\u2217 stays optimal because it is possible for an inactive node to become active for the new value of \u03c4k.\nResults from applying the algorithm to the example shown in Figure 2 are presented in Table 1. Two metaparameters are considered for sensitivity analysis: the probability of the weather being sunny, \u03c41 = \u03b8w, and the specificity of the report, \u03c42 = \u03b8r\u0304|w\u0304, which is a measure of the expected number of false positives from the report. The table presents tight and weak intervals for both meta-parameters. The exact admissible interval for \u03c41 is [0.44, 0.84], as can be seen from Figure 4. Note that this interval contains the tight interval but lies within the weak interval. The algorithm is able to compute the exact admissible interval for \u03c42 since the specificity of the report does not affect the value when evidence is not gathered.\nTable 1: Results for the admissible interval algorithm for an example.\nMetaparameter Tight interval Weak interval description (IkT ) (IkW )\n\u03c41 = \u03b8w [.44, .67] [.44, .89] \u03c42 = \u03b8r\u0304|w\u0304 [.57, 1] [.57, 1]\nThe admissible interval algorithm yields other useful results as a by-product. If the decision maker is interested in analyzing which alternative is optimal at a particular max node in the circuit, given that all other policies are made by the current optimal strategy, then this is easy to compute with the help of the intermediate steps in the algorithm. In other words, the algorithm helps in analyzing neighbouring strategies to s\u2217, defined as strategies that differ from s\u2217 only by an alternative in one active max node of the decision circuit. For instance, the decision maker could analyze the optimal policy at the first decision by comparing all strategies to s\u2217 that differ in only one alternative at a max node in the decision circuit corresponding to the first decision node in the influence diagram.\nThe binary search method from the previous section directly applies in extensive form influence diagrams, for finding admissible intervals for all metaparameters. It computes these intervals exactly, one meta-parameter at a time. The admissible interval algorithm identifies bounds for these intervals, but for all meta-parameters simultaneously. We suggest that the analyst use the admissible interval algorithm as an initial test to identify potentially critical metaparameters, and then use the binary search technique to focus attention on specific meta-parameters."}, {"heading": "6.3 Value of information", "text": "The challenge of performing value of information analysis for extensive form influence diagrams is that it is difficult to keep track of all the derivatives for all the strategies. We propose a simple method to find the value of information for variables that are not affected by any decision, if they were to be observed before the first decision is made. The goal is to re-use the decision circuit that was formulated in the offline phase.\nAssuming that the decision circuit has been evaluated and therefore that the probability of evidence P (e) has already been computed, we can find the value of information for any variable X with the help of some upward sweeps. If we pass the evidence e, U = 1, x in an upward sweep, once each for every possible value of\nx, we obtain MEUPI (the maximal expected utility with perfect information on uncertain variable X), as shown in the following theorem. We state the theorem without proof; the proof is similar to Theorem 1, part (ii). Theorem 4. If we sweep upward with evidence e, U = 1, x, for every possible value of x, we obtain MEUPI =\n1 P (e) \u2211 x g(U = 1, x, e).\nIf the number of variables analyzed for value of information is ]var, and assuming that the maximum number of possibilities for all of these variables is bounded by some constant, then the time complexity for obtaining the value of information for all these variables is O((dc)(]var)). For the example in Figure 2, the value of information on the weather is: $ [ u\u22121 (g(U = 1, w) + g(U = 1, w\u0304))\u2212 52.5 ] , which equals $21.3. The report already provides some information about the weather, and further information is not worth more than $21.3."}, {"heading": "7 CONCLUSIONS AND FUTURE RESEARCH", "text": "Decision circuits are a graphical representation for the efficient analysis of influence diagrams, with the potential to exploit both the conditional independence in the graph as well as the local structure from asymmetry of real-world decision problems. Recent methods have been devised to create compact circuits using separability of the value function and operations such as pruning and coalescence [Bhattacharjya and Shachter, 2008]. If the analyst can compile an efficient decision circuit for an influence diagram, she can then use the compiled circuit to evaluate the optimal strategy and the CE, before performing sensitivity analyses of the kind demonstrated in this paper.\nWe explored several one-way sensitivity analysis queries and demonstrated techniques to answer them using decision circuits. We discussed sensitivity analysis for both normal form and extensive form influence diagrams. Sensitivity analysis is an essential technique to support decision problem modeling and it provides valuable insight about the critical assessments. n-way sensitivity analysis of influence diagrams can also be performed with decision circuits using higher order derivatives, similar to the techniques discussed in this paper and in Chan and Darwiche (2004). Likewise, the presented method for computing value of information can be extended to multiple variables, by sweeping evidence corresponding to every instantiation of the variables under consideration. Decision circuits allow a wide variety of queries about the model that can be addressed efficiently by decision circuit evaluation and differentiation."}, {"heading": "Acknowledgements", "text": "This research was partially funded by the Energy Modeling Forum. We thank John Weyant for his support, Mark Chavira for helpful answers to our queries, Adnan Darwiche for providing relevant references and the anonymous reviewers for their feedback."}], "references": [{"title": "Evaluating influence diagrams with decision circuits", "author": ["D. Bhattacharjya", "R. Shachter"], "venue": "Proceedings of the Twenty-third Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "Bhattacharjya and Shachter,? \\Q2007\\E", "shortCiteRegEx": "Bhattacharjya and Shachter", "year": 2007}, {"title": "Dynamic programming in decision circuits, Working paper", "author": ["D. Bhattacharjya", "R. Shachter"], "venue": null, "citeRegEx": "Bhattacharjya and Shachter,? \\Q2008\\E", "shortCiteRegEx": "Bhattacharjya and Shachter", "year": 2008}, {"title": "Sensitivity analysis in discrete Bayesian networks", "author": ["E. Castillo", "J.M. Gutierrez", "A.S. Hadi"], "venue": "IEEE Transactions on Systems, Man, and Cybernetics,", "citeRegEx": "Castillo et al\\.,? \\Q1997\\E", "shortCiteRegEx": "Castillo et al\\.", "year": 1997}, {"title": "When do numbers really matter", "author": ["H. Chan", "A. Darwiche"], "venue": "Journal of Artificial Intelligence Research,", "citeRegEx": "Chan and Darwiche,? \\Q2002\\E", "shortCiteRegEx": "Chan and Darwiche", "year": 2002}, {"title": "Sensitivity analysis in Bayesian networks: From single to multiple parameters", "author": ["H. Chan", "A. Darwiche"], "venue": "Proceedings of the Twentieth Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "Chan and Darwiche,? \\Q2004\\E", "shortCiteRegEx": "Chan and Darwiche", "year": 2004}, {"title": "On the robustness of Most Probable Explanations", "author": ["H. Chan", "A. Darwiche"], "venue": "In Proceedings of the Twenty Second Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "Chan and Darwiche,? \\Q2006\\E", "shortCiteRegEx": "Chan and Darwiche", "year": 2006}, {"title": "Compiling Bayesian networks with local structure", "author": ["M. Chavira", "A. Darwiche"], "venue": "In Proceedings of the Nineteenth International Joint Conference on Artificial Intelligence,", "citeRegEx": "Chavira and Darwiche,? \\Q2005\\E", "shortCiteRegEx": "Chavira and Darwiche", "year": 2005}, {"title": "A differential approach to inference in Bayesian networks", "author": ["A. Darwiche"], "venue": "Proceedings of the Sixteenth Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "Darwiche,? \\Q2000\\E", "shortCiteRegEx": "Darwiche", "year": 2000}, {"title": "A logical approach to factoring belief networks", "author": ["A. Darwiche"], "venue": "In Proceedings of International Conference on Knowledge Representation and Reasoning,", "citeRegEx": "Darwiche,? \\Q2002\\E", "shortCiteRegEx": "Darwiche", "year": 2002}, {"title": "A differential approach", "author": ["A. Darwiche"], "venue": null, "citeRegEx": "Darwiche,? \\Q2003\\E", "shortCiteRegEx": "Darwiche", "year": 2003}, {"title": "Information value theory, IEEE transactions on Systems", "author": ["R. Howard"], "venue": "Science and Cybernetics,", "citeRegEx": "Howard,? \\Q1966\\E", "shortCiteRegEx": "Howard", "year": 1966}, {"title": "The evolution of decision analysis", "author": ["R. Howard"], "venue": null, "citeRegEx": "Howard,? \\Q1983\\E", "shortCiteRegEx": "Howard", "year": 1983}, {"title": "Making sensitivity analysis computationally efficient", "author": ["U. Kjaerulff", "L.C. van der Gaag"], "venue": "Proceedings of the 16th Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "Kjaerulff and Gaag,? \\Q2000\\E", "shortCiteRegEx": "Kjaerulff and Gaag", "year": 2000}, {"title": "Sensitivity analysis for probability assessments in Bayesian networks", "author": ["K.B. Laskey"], "venue": "IEEE Transactions on Systems, Man, and Cybernetics,", "citeRegEx": "Laskey,? \\Q1995\\E", "shortCiteRegEx": "Laskey", "year": 1995}, {"title": "Sensitivity analysis in influence diagrams", "author": ["T. Nielsen", "F.V. Jensen"], "venue": "IEEE Transactions on Systems, Man, and Cybernetics - Part A: Systems and Humans,", "citeRegEx": "Nielsen and Jensen,? \\Q2003\\E", "shortCiteRegEx": "Nielsen and Jensen", "year": 2003}, {"title": "Decision Analysis: Introductory Lectures on Choices under Uncertainty, Addison-Wesley", "author": ["H. Raiffa"], "venue": null, "citeRegEx": "Raiffa,? \\Q1968\\E", "shortCiteRegEx": "Raiffa", "year": 1968}, {"title": "The Foundations of Statistics, Wiley, New York", "author": ["L. Savage"], "venue": null, "citeRegEx": "Savage,? \\Q1954\\E", "shortCiteRegEx": "Savage", "year": 1954}, {"title": "Evaluating influence diagrams", "author": ["R. Shachter"], "venue": "Operations Research,", "citeRegEx": "Shachter,? \\Q1986\\E", "shortCiteRegEx": "Shachter", "year": 1986}, {"title": "Model building with belief networks and influence diagrams", "author": ["R. Shachter"], "venue": "Advances in Decision Analysis: From Foundations to Applications,", "citeRegEx": "Shachter,? \\Q2007\\E", "shortCiteRegEx": "Shachter", "year": 2007}, {"title": "Analysing sensitivity data from probabilistic networks", "author": ["L.C. van der Gaag", "S. Renooij"], "venue": "Proceedings of the 17th Conference on Uncertainty in Artificial Intelligence,", "citeRegEx": "Gaag and Renooij,? \\Q2001\\E", "shortCiteRegEx": "Gaag and Renooij", "year": 2001}], "referenceMentions": [{"referenceID": 0, "context": "Decision circuits have been developed to perform efficient evaluation of influence diagrams [Bhattacharjya and Shachter, 2007], building on the advances in arithmetic circuits for belief network inference [Darwiche, 2003].", "startOffset": 92, "endOffset": 126}, {"referenceID": 9, "context": "Decision circuits have been developed to perform efficient evaluation of influence diagrams [Bhattacharjya and Shachter, 2007], building on the advances in arithmetic circuits for belief network inference [Darwiche, 2003].", "startOffset": 205, "endOffset": 221}, {"referenceID": 0, "context": "Decision circuits are a recent graphical representation that have been introduced for the efficient evaluation of influence diagrams [Bhattacharjya and Shachter, 2007].", "startOffset": 133, "endOffset": 167}, {"referenceID": 9, "context": "Several issues in sensitivity analysis of Bayesian belief networks have been studied, using arithmetic circuits [Darwiche, 2003] for efficient solutions [Chan and Darwiche, 2002; 2004; 2006].", "startOffset": 112, "endOffset": 128}, {"referenceID": 3, "context": "Several issues in sensitivity analysis of Bayesian belief networks have been studied, using arithmetic circuits [Darwiche, 2003] for efficient solutions [Chan and Darwiche, 2002; 2004; 2006].", "startOffset": 153, "endOffset": 190}, {"referenceID": 17, "context": "We assume that the reader is familiar with graphical models such as Bayesian belief networks and influence diagrams (see Shachter (2007) for an overview).", "startOffset": 121, "endOffset": 137}, {"referenceID": 16, "context": "When there is only one decision node and it has no parents, the diagram is said to be in normal form [Savage, 1954; Raiffa, 1968].", "startOffset": 101, "endOffset": 129}, {"referenceID": 15, "context": "When there is only one decision node and it has no parents, the diagram is said to be in normal form [Savage, 1954; Raiffa, 1968].", "startOffset": 101, "endOffset": 129}, {"referenceID": 7, "context": "We list two lemmas with important relationships between inference queries and the multi-linear function, as proven in Darwiche (2003):", "startOffset": 118, "endOffset": 134}, {"referenceID": 7, "context": "For further details, please see Darwiche (2003).", "startOffset": 32, "endOffset": 48}, {"referenceID": 8, "context": "Compact arithmetic circuits have been devised for belief networks that had previously been intractable [Darwiche, 2002; Chavira and Darwiche, 2005].", "startOffset": 103, "endOffset": 147}, {"referenceID": 6, "context": "Compact arithmetic circuits have been devised for belief networks that had previously been intractable [Darwiche, 2002; Chavira and Darwiche, 2005].", "startOffset": 103, "endOffset": 147}, {"referenceID": 0, "context": "Decision circuits for influence diagrams can be constructed in the variable elimination order [Bhattacharjya and Shachter, 2007], similar to a construction technique for arithmetic circuits [Darwiche, 2000].", "startOffset": 94, "endOffset": 128}, {"referenceID": 7, "context": "Decision circuits for influence diagrams can be constructed in the variable elimination order [Bhattacharjya and Shachter, 2007], similar to a construction technique for arithmetic circuits [Darwiche, 2000].", "startOffset": 190, "endOffset": 206}, {"referenceID": 0, "context": "Specifically, from Bhattacharjya and Shachter (2007):", "startOffset": 19, "endOffset": 53}, {"referenceID": 11, "context": "Sensitivity analysis aids in identifying the model\u2019s critical elements, forming the basis for iterative refinement of the model, and can also be used after the analysis for defending a particular strategy to the decision maker [Howard, 1983].", "startOffset": 227, "endOffset": 241}, {"referenceID": 13, "context": "Sensitivity analysis in belief networks explores the sensitivity of inference queries such as the probability of evidence and conditional marginal probabilities given the evidence, to the conditional probabilities of the network [Laskey, 1995; Castillo et al, 1997; Kjaerulff and van der Gaag, 2000; van der Gaag and Renooij, 2001].", "startOffset": 229, "endOffset": 331}, {"referenceID": 3, "context": "Sensitivity to inference queries using arithmetic circuits has also been studied [Chan and Darwiche, 2002; 2004] as has the sensitivity of Most Probable Explanations to parameter changes [Chan and Darwiche, 2006].", "startOffset": 81, "endOffset": 112}, {"referenceID": 5, "context": "Sensitivity to inference queries using arithmetic circuits has also been studied [Chan and Darwiche, 2002; 2004] as has the sensitivity of Most Probable Explanations to parameter changes [Chan and Darwiche, 2006].", "startOffset": 187, "endOffset": 212}, {"referenceID": 3, "context": ",K, each between 0 and 1, and that these meta-parameters are drawn explicitly in the decision circuit, although it is also possible to allow the metaparameters to be implicit [Chan and Darwiche, 2002].", "startOffset": 175, "endOffset": 200}, {"referenceID": 3, "context": "To perform sensitivity analysis for decision problems, we will vary the model output with respect to metaparameters, similar to Chan and Darwiche (2002) and Nielsen and Jensen (2003).", "startOffset": 128, "endOffset": 153}, {"referenceID": 3, "context": "To perform sensitivity analysis for decision problems, we will vary the model output with respect to metaparameters, similar to Chan and Darwiche (2002) and Nielsen and Jensen (2003). For a variable X, we analyze sensitivity to all parameters of the form \u03b8x|pa(X) as linear functions of a meta-parameter \u03c4 .", "startOffset": 128, "endOffset": 183}, {"referenceID": 7, "context": "The single and double derivatives of the form used in Theorem 1 can be obtained in time linear in the size of the circuit [Darwiche, 2000].", "startOffset": 122, "endOffset": 138}, {"referenceID": 10, "context": "cision maker should be willing to pay to observe the uncertainty before making the first decision [Howard, 1966; Raiffa, 1968].", "startOffset": 98, "endOffset": 126}, {"referenceID": 15, "context": "cision maker should be willing to pay to observe the uncertainty before making the first decision [Howard, 1966; Raiffa, 1968].", "startOffset": 98, "endOffset": 126}, {"referenceID": 15, "context": "In general, this is usually a good approximation for the value of information, even if the decision maker\u2019s utility function has a form other than linear or exponential [Raiffa, 1968].", "startOffset": 169, "endOffset": 183}, {"referenceID": 17, "context": "We assume the standard conditions in the influence diagram literature such as \u201cno forgetting\u201d [Howard and Matheson, 1984; Shachter, 1986].", "startOffset": 94, "endOffset": 137}, {"referenceID": 1, "context": "Recent methods have been devised to create compact circuits using separability of the value function and operations such as pruning and coalescence [Bhattacharjya and Shachter, 2008].", "startOffset": 148, "endOffset": 182}, {"referenceID": 3, "context": "n-way sensitivity analysis of influence diagrams can also be performed with decision circuits using higher order derivatives, similar to the techniques discussed in this paper and in Chan and Darwiche (2004). Likewise, the presented method for computing value of information can be extended to multiple variables, by sweeping evidence corresponding to every instantiation of the variables under consideration.", "startOffset": 183, "endOffset": 208}], "year": 2008, "abstractText": "Decision circuits have been developed to perform efficient evaluation of influence diagrams [Bhattacharjya and Shachter, 2007], building on the advances in arithmetic circuits for belief network inference [Darwiche, 2003]. In the process of model building and analysis, we perform sensitivity analysis to understand how the optimal solution changes in response to changes in the model. When sequential decision problems under uncertainty are represented as decision circuits, we can exploit the efficient solution process embodied in the decision circuit and the wealth of derivative information available to compute the value of information for the uncertainties in the problem and the effects of changes to model parameters on the value and the optimal strategy.", "creator": "TeX"}}}