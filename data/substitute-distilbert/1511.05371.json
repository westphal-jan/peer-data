{"id": "1511.05371", "review": {"conference": "arxiv", "VERSION": "v1", "DATE_OF_SUBMISSION": "17-Nov-2015", "title": "Constant Time EXPected Similarity Estimation using Stochastic Optimization", "abstract": "a new algorithm named expected similarity estimation ( expose ) was recently emerged to solve the problem of large - scale anomaly validation. it is a non - parametric and distribution free kernel method based on the hilbert norm embedding of probability measures. given a dataset of $ np $ samples, open needs only $ \\ mathcal { o } ( um ) $ ( fixed time ) to build a model and $ \\ mathcal { o } ( u ) $ ( variable time ) to make a prediction. in experimental work we improve 3d linear computational framework and show that an $ \\ epsilon $ - accurate model can be estimated in constant time, which has significant implications for large - scale learning problems. to achieve this goal, we cast the original expose formulation into a stochastic optimization problem. it is rumored that this approach exploits others to determine the type of iteration based on a desired accuracy $ \\ epsilon $, independent computing the dataset size $ n $. we will show that the proposed stochastic consistency reliability algorithm works in general ( possible infinite - dimensional ) hilbert spaces, generally easy to predict and requires no additional full - size parameters.", "histories": [["v1", "Tue, 17 Nov 2015 12:10:03 GMT  (362kb,D)", "http://arxiv.org/abs/1511.05371v1", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["markus schneider", "wolfgang ertel", "g\\\"unther palm"], "accepted": false, "id": "1511.05371"}, "pdf": {"name": "1511.05371.pdf", "metadata": {"source": "CRF", "title": "CONSTANT TIME EXPECTED SIMILARITY ESTIMATION USING STOCHASTIC OPTIMIZATION", "authors": ["markus schneider"], "emails": [], "sections": [{"heading": null, "text": "A new algorithm named EXPected Similarity Estimation (EXPoSE) was recently proposed to solve the problem of large-scale anomaly detection. It is a non-parametric and distribution free kernel method based on the Hilbert space embedding of probability measures. Given a dataset of n samples, EXPoSE needs only O(n) (linear time) to build a model and O(1) (constant time) to make a prediction. In this work we improve the linear computational complexity and show that an -accurate model can be estimated in constant time, which has significant implications for large-scale learning problems. To achieve this goal, we cast the original EXPoSE formulation into a stochastic optimization problem. It is crucial that this approach allows us to determine the number of iteration based on a desired accuracy , independent of the dataset size n. We will show that the proposed stochastic gradient descent algorithm works in general (possible infinite-dimensional) Hilbert spaces, is easy to implement and requires no additional step-size parameters."}, {"heading": "1 Introduction", "text": "EXPected Similarity Estimation (EXPoSE) was recently proposed to solve the problem of large-scale anomaly detection, where the number of training samples n and the dimension of the data d are too high for most other algorithms [SEP15]. Here, \u201canomaly detection refers to the problem of finding patterns in data that do not conform to expected behavior. These non-conforming patterns are often referred to as anomalies\u201d [CBK09].\nAs explained later in detail, the EXPoSE anomaly detection classifier\n\u03b7(y) = \u3008\u03c6(y),\u00b5[P]\u3009\ncalculates a score (the likelihood of y belonging to the class of normal data) using the inner product between a feature map \u03c6 and the kernel mean map \u00b5[P] of the distribution P (Fig. 1). Given a training dataset of size n, the authors provide a methodology to train this classifier in O(n) time and show that calculating a score for a query point can be done in O(1) time. The question arises if it is possible to improve on the linear training time and create an algorithm which is\n? Institute of Neural Information Processing, University of Ulm, Germany\n\u2020 Institute for Artificial Intelligence, Ravensburg-Weingarten University of Applied Sciences, Germany\ncompletely independent of the dataset size.\nThe answer to this question is positive if a high accuracy sample estimate of \u00b5[P] does not improve the anomaly detection performance. As Bousquet and Bottou [BB08] observed, for most machine learning applications there is no need to optimize below the statistical error. The authors argue that accurately minimizing an empirical cost function does not gain much since it is itself an approximation of the expected costs and therefore contains errors. We will see that it is possible to determine the number of samples needed to achieve a desired accuracy (the maximal deviation from the optimal model) of EXPoSE without any dependence on the datasets size n.\nar X\niv :1\n51 1.\n05 37\n1v 1\n[ cs\n.L G\n] 1\n7 N\nov 2\n01 5"}, {"heading": "1.1 CONTRIBUTIONS & RELATED WORK", "text": "In this work we derive a methodology to build an - accurate model w of \u00b5[P] using only a random subset of the training data by means of stochastic optimization.\nDefinition 1: We say an algorithm finds an -accurate solution w of an objective function f if\nf(w) 6 inf f+\nfor a given > 0. \u00ab\nWe will show that for the proposed objective function E[f(wt) \u2212 f(\u00b5[P])] 6 O(1/t), where wt only needs access to t random dataset elements, t \u2208 {1, 2, . . . ,n}. The key observation is that for a given an > 0 we can reach \u2016wt \u2212 \u00b5[P]\u2016 < in a fixed number of iterations independent of the dataset size. Moreover, it can be shown that (without further assumptions) the O(1/t) rate is optimal for stochastic optimization [Aga+11].\nDue to the low iteration costs, stochastic optimization and especially stochastic gradient (SG) methods [BB08; RSB12], are widely used for training machine learning models on very large-scale datasets. Such algorithms are used for example to train support vector machines [SS+11], logistic regression [Bac14] and lasso models [SST11]. However, this is the first time that EXPoSE is considered as an optimization problem and we will show that the derived algorithms is of general interest for applications of the kernel mean map \u00b5[P].\nOther optimization techniques such as projected gradient decent [BV04] or Nesterov\u2019s accelerated gradient descent [Nes83; Nes04] are also applicable in principle, however a single gradient evaluation takes already O(n) time and hence would be slower than the originally proposed EXPoSE approach. Other stochastic gradient methods [RSB12] can obtain a better convergence rate than O(1/t) for an objective composed of a sum of smooth functions. However this requires multiple passes over the datasets is therefor of no benefit."}, {"heading": "2 Problem Description", "text": "EXPoSE is a probabilistic approach which assumes that the normal, non-anomalous data is distributed according to some measure P. More formally, let X be a random variable taking values in a measure space (X, X ) with distribution P. We denote the reproducing kernel Hilbert space (RKHS) associated with the kernel k : X\u00d7X\u2192 R with (H, \u3008\u00b7, \u00b7\u3009). A RKHS is a Hilbert space of functions g : X\u2192 R, where the evaluation functional \u03b4x : g 7\u2192 g(x) is continuous. The function \u03c6 : X \u2192 H\nwith\nk(x,y) = \u3008\u03c6(x),\u03c6(y)\u3009\nis called feature map denoted by \u03c6(x) = k(x, \u00b7). Throughout the paper, we use \u2016\u00b7\u2016H to denote the norm induced by the inner product defined as \u2016g\u2016H = \u221a \u3008g,g\u3009.\nEXPoSE calculates a score which can be interpreted as the likelihood of a query point belonging to the distribution of normal data P. This is done in the following way.\nDefinition 2: The expected similarity of y \u2208 X to the (probability) distribution P is defined as\n\u03b7(y) = \u222b X k(y, x)dP(x),\nwhere k : X\u00d7X\u2192 R is a reproducing kernel. \u00ab\nIntuitively speaking the query point y is compared to all other points of the distribution P. It can be shown [SEP15] that this equation can be rewritten as an inner product between the feature map \u03c6(y) and the kernel embedding \u00b5[P] of P as\n\u03b7(y) = \u222b X k(y, x)dP(x)\n= \u3008\u03c6(y),\u00b5[P]\u3009,\nwhere the kernel embedding is defined as follows.\nDefinition 3: The kernel embedding or kernel mean map \u00b5[P] associated with the continuous, bounded and positive-definite kernel function k is\n\u00b5[P] = \u222b X \u03c6(x)dP(x),\nwhere P is a Borel probability measure on X. \u00ab\nTo facilitate the further analysis, we assume that the kernel k is measurable and bounded such that \u00b5[P] exists for all P \u2208M1+(X) [SFL11]. Since the underlying distribution P is in general unknown and only a set of n \u2208 N samples {x1, . . . , xn} from P is available for analysis, the empirical measure\nPn = 1\nn n\u2211 i=1 \u03b4xi ,\nact as a surrogate, where \u03b4x is the Dirac measure. Pn can be used to construct an approximation \u00b5[Pn] of \u00b5[P] as\n\u00b5[P] \u2248 \u00b5[Pn] = \u222b X \u03c6(x) dPn(x) = 1 n n\u2211 i=1 \u03c6(xi)\nwhich is called empirical kernel embedding [Smo+07].\nThe consequence of the equation above is, that the empirical kernel embedding \u00b5[Pn] has a computational complexity with linear dependence on n and responsible for the linear EXPoSE training time. Next, we will look at the EXPoSE classifier from the perspective of a stochastic optimization problem to deliver an -accurate approximation of \u00b5[P] in constant time. A reduction of the computationally complexity from linear to constant for the empirical kernel mean map has significant impact on a variety of applications based on the kernel embedding such as for example statistical hypotheses testing [Gre+12] or independence testing [Gre+05].\nHowever the main focus of this work is to improve the EXPoSE training time from linear to constant."}, {"heading": "3 Stochastic Optimization", "text": "This sections derives the stochastic optimization problem together with some general conditions which will be necessary at a later stage. Obviously \u00b5[P] \u2208 H is the solution of the following unconstrained optimization problem\nmin w\u2208H g(w) = min w\u2208H \u2016\u00b5[P] \u2212w\u20162H = min w\u2208H \u3008w,w\u3009\u2212 2\u3008\u00b5[P],w\u3009+ \u3008\u00b5[P],\u00b5[P]\u3009\n= min w\u2208H\n1 2 \u3008w,w\u3009\u2212 \u3008\u00b5[P],w\u3009.\nThis is equivalent to the stochastic optimization problem, where we minimize over the expectation of an objective function\nmin w\u2208H E[f(w)] = min w\u2208H \u222b X f(w) dP(x),\nwith\nf(w) = 1\n2 \u3008w,w\u3009\u2212 \u3008\u03c6(X),w\u3009,\nwhere the expectation is taken with respect to the random variable X.\nWe will assume that we can generate independent samples from P and furthermore require an oracle which returns a stochastic subgradient \u2207\u0303f(w) of f at w. A stochastic subgradient has the property that\nE[\u2207\u0303f(w)] = \u2207f(w) \u2208 \u2202f(w)\nwhich means its expectation is equal to a subgradient \u2207f(w). Here \u2202f(w) denotes the set of all subgradients at w called the subdifferential which is a subset of the dual\nH\u2217 of H defined by\n\u2202f(x) = { \u03be\u2217 \u2208 H\u2217 \u2223\u2223 f(y) \u2212 f(x) > \u03be\u2217(y\u2212 x)}. Proposition 1: The random variable\n\u2207\u0303f(w) = w\u2212\u03c6(X)\nis a stochastic unbiased gradient of f at w. \u00ab\nProof: The expectation of \u2207\u0303f(w) is given by\nE[\u2207\u0303f(w)] = \u222b w\u2212\u03c6(X)dP(x)\n= w\u2212 \u00b5[P] \u2208 \u2202f(w)\nwhich is a stochastic unbiased (sub)gradient by definition.\nWe are going to solve this optimization problem with the stochastic approximation algorithm [RM51] described next."}, {"heading": "3.1 STOCHASTIC APPROXIMATION", "text": "Let H be a Hilbert space, H \u2286 H be a subset and f : H\u2192 R some objective function. Furthermore let\n\u03a0H(w) = arg min v\u2208H \u2016w\u2212 v\u2016H\nbe the metric projection operator. \u03a0H is in general nonexpanding such that\n\u2016\u03a0H(w) \u2212\u03a0H(w \u2032)\u2016H 6 \u2016w\u2212w \u2032\u2016H\nholds. Then the classic stochastic approximation algorithm [RM51] creates the sequence (wt) as\nwt+1 = \u03a0H ( wt \u2212 \u03b3t\u2207\u0303f(wt) ) ,\nto solve the stochastic optimization problem\nmin w\u2208H E[f(w)]\nstarting at some w1 \u2208 H. Here (\u03b3t) is a sequence of positive step sizes and the optimal solution to the problem is denoted by w?.\nNemirovski et al. [Nem+09] considered H = Rd and showed that stochastic approximation can obtain a O(1/t) convergence rate if the objective function f is differentiable and \u03b1-strongly convex on H. Here, \u03b1strongly convex means there exists a constant \u03b1 > 0 such that\nf(y) > f(x) + \u3008\u2207f(x),y\u2212 x\u3009+ 1 2 \u03b1\u2016y\u2212 x\u20162H\nfor all x,y \u2208 H. An additional requirement is that the stochastic subgradient has to be bounded in expectation\nE [ \u2016\u2207\u0303f(w)\u20162H ] 6M2 \u2200w \u2208 H,M > 0\nand the step sizes need to be \u03b3t = \u03b8t for some \u03b8 > 1 2\u03b1 . Under these conditions, Nemirovski et al. demonstrated that\nE [ \u2016wt \u2212w?\u20162H ] 6 Q(\u03b8)\nt (1)\nwhere Q(\u03b8) = max { \u03b82M2(2\u03b1\u03b8\u2212 1)\u22121, \u2016w1 \u2212w?\u20162H } .\nFurthermore, if the gradient is Lipschitz continuous, i.e. there is a constant \u03b2 > 0 such that\n\u2016\u2207f(x) \u2212\u2207f(y)\u2016H 6 \u03b2\u2016x\u2212 y\u2016H\nfor all x,y \u2208 H, then\nE [ f(wt) \u2212 f(w ?) ] 6 1\n2\n\u03b2Q(\u03b8)\nt . (2)\nFor Lipschitz continuous strongly convex functions, the O(1/t) rate of convergence is unimprovable [Aga+11].\nWe will see that the bound from Nemirovski et al. does also hold when H is a (possibly infinite-dimensional) Hilbert space as in the problem considered in this work. However, some care has to be taken since, unlike in finite-dimensional spaces, being closed and bounded does not imply that a set is compact when H is infinitedimensional. We also refer to [JN10] for a discussion on primal-dual subgradient methods in non-Euclidean spaces."}, {"heading": "4 Stochastic Optimization of EXPoSE", "text": "In this section we show the existence and uniqueness of a solution for the previously defined stochastic optimization problem of EXPoSE and also that it meets all requirements for a O(1/t) convergence rate.\nIn the following let H be a RKHS space with a bounded kernel k such that \u2016k(x,y)\u2016 6 M2. Let H \u2286 H be a weakly sequentially closed and bounded set with \u2016H\u2016H 6 M. It is not hard to show the existence of a minimizer of\nmin w\u2208H E[f(w)] = min w\u2208H\n\u222b 1\n2 \u3008w,w\u3009\u2212 \u3008\u03c6(X),w\u3009 dP, (3)\nsince we already know the solution w? = \u00b5[P] assuming\nthat \u00b5[P] \u2208 H. This assumption holds since\n\u2016\u00b5[P]\u20162H = \u2225\u2225\u2225\u222b\nX\n\u03c6(x)dP(x) \u2225\u2225\u22252 H\n6 \u222b X \u2016\u03c6(x)\u20162H dP(x)\n= \u222b X k(x, x)dP(x) 6M2.\nThis solution is also unique. The proof requires f(w) to be strongly convex, which is subject of the following property:\nProposition 2: The objective function f(w) is \u03b1-strongly convex and its gradient is \u03b2-Lipschitz with \u03b1 = \u03b2 = 1.\u00ab\nProof: A function f is \u03b1-strongly convex if and only if w 7\u2192 f(w) \u2212 \u03b12 \u2016w\u2016 2 H is convex.\nf(w) \u2212 1\n2 \u2016w\u20162H =\n1 2 \u3008w,w\u3009\u2212 \u3008\u03c6(X),w\u3009\u2212 1 2 \u2016w\u20162H\n= \u2212\u3008\u03c6(X),w\u3009\nwhich is convex in w. Hence \u03b1 = 1.\nFurthermore Df(w) : z 7\u2192 \u3008w \u2212 \u03c6(X), z\u3009 is the Fr\u00e9chet derivative of f at w since\nlim h\u21920 \u2016f(w+ h) \u2212 f(w) \u2212 \u3008Df(w)|h\u3009\u2016 \u2016h\u2016H = 0\nwith dual pairing \u3008\u00b7|\u00b7\u3009. The gradient \u2207f(w) = w\u2212\u03c6(X) is \u03b2-Lipschitz since\n\u2016\u2207f(w) \u2212\u2207f(v)\u2016H = \u2016w\u2212\u03c6(X) \u2212 v+\u03c6(X)\u2016H = \u2016w\u2212 v\u2016H\nfor all w, v \u2208 H due to Riesz representation. Besides the existence of a minimizer, its uniqueness plays an important role. The sufficient conditions for w? to be unique are given by [Pey15, Corollary 2.19] which states the following: Corollary 1: Let H be reflexive. If f : H \u2192 R \u222a {+\u221e} is proper, convex, coercive and lower-semicontinuous, then arg min f is nonempty and weakly compact. If, moreover f is strictly convex, then arg min f is a singleton. \u00ab\nProof: w? is unique: All Hilbert spaces are reflexive. Since f is continuous, proper (dom(f) 6= {}) and strongly convex it is also convex, coercive and lowersemicontinuous.\nNext we state the two main theorems of this paper.\nTheorem 1: Using the sequence\nwt+1 = \u03a0H ( wt \u2212 \u03b3t\u2207\u0303f(wt) ) ,\nwith f given by Eq. (3) we have\nE [ \u2016wt \u2212w?\u20162H ] 6 M2\nt\nfor all t \u2208N. \u00ab Proof: Since Q(\u03b8) attains its optimal value at \u03b8 = 1/\u03b1 we get from Eq. (1) that\nE [ \u2016wt \u2212w?\u20162H ] 6 t\u22121max { \u03b1\u22122M2, \u2016w1 \u2212w?\u20162H } and we have\nE [ \u2016w1 \u2212w?\u20162H ] 6 M2\n\u03b12\nsince strong convexity implies\n\u3008w\u2212w?,\u2207f(w)\u3009 > \u03b1\u2016w\u2212w?\u20162H \u3008w\u2212w?,\u2207f(w)\u30092 > \u03b12\u2016w\u2212w?\u20164H\nand by Cauchy-Schwartz inequality we get\n\u2016w\u2212w?\u20162H \u00b7 \u2016\u2207f(w)\u20162H > \u3008w\u2212w?,\u2207f(w)\u30092\nwhich yields\n\u2016w\u2212w?\u20162H \u00b7 \u2016\u2207f(w)\u20162H > \u03b12\u2016w\u2212w?\u20164H \u2016\u2207f(w)\u20162H > \u03b12\u2016w\u2212w?\u20162H\nfor all w. Taking exponents on both sides and the bound \u2016\u2207f(w)\u20162H 6M2 we get\nE [ \u2016w\u2212w?\u20162H ] 6 \u03b1\u22122M2\nwhich concludes the proof using \u03b1 = 1 (Proposition 2).\nNotice that \u2016\u2207f(w)\u20162H 6 M2 does indeed hold since \u2207f(w) = w \u2212 \u03c6(X) \u2208 H. The following theorems describes the convergence rate of the objective function f in terms of the number of iterations t.\nTheorem 2: Under the prerequisites of Theorem 1 it holds that\nE [ f(wt) \u2212 f(w ?) ] 6 1\n2\nM2\nt .\nProof: Using Eq. (2) and the bound for Q(\u03b8) derived before yields the desired result.\nWe showed above that (in expectation) the distance between the optimal objective f(w?) and f(wt) decays as O(1/t). Another question is how this effects the EXPoSE decision rule \u03b7(y) = \u3008\u03c6(y),\u00b5[P]\u3009. By definition and the application of the Cauchy\u2013Schwarz inequality\nit holds that\n\u2016\u3008\u03c6(y),\u00b5[P]\u3009\u2212 \u3008\u03c6(y),wt\u3009\u2016 = \u2016\u3008\u03c6(y),\u00b5[P] \u2212wt\u3009\u2016 6 \u2016\u03c6(y)\u2016H \u00b7 \u2016\u00b5[P] \u2212wt\u2016H\nfor all y \u2208 H. Taking expectations yields\nE [ \u2016\u3008\u03c6(y),\u00b5[P]\u3009\u2212 \u3008\u03c6(y),wt\u3009\u20162 ] 6 \u2016\u03c6(y)\u20162H M2\nt\nfor all t \u2208N.\nAlgorithm 1 EXPoSE using Stochastic Optimization\nRequire: 1: T : the number of iterations or : accuracy Algorithm: 2: Set w1 \u2190 0 3: for t\u2190 1, 2, . . . , T do 4: Sample xt uniformly from P 5: Set \u03b3t \u2190 1t 6: Set \u2207\u0303f(wt)\u2190 wt \u2212\u03c6(xt) 7: Update wt+1 \u2190 wt \u2212 \u03b3t\u2207\u0303f(wt) 8: Project wt+1 \u2190 wt+1 \u00b7max{1,M\u2016wt+1\u2016}\u22121\n9: return wT+1\nThe stochastic optimization procedure for EXPoSE is summarized in Algorithm 1. Please note that the stochastic optimization procedure presented here is relatively simple and requires only a few lines of code to implement. It also does not introduce additional parameters since the optimal step-size in known. Step-sizes are crucial and difficult to determine in most optimization algorithms as they have a significant effect on the results. The bound M of the kernel is typically known and the number of iterations T determines the computing time and accuracy. Alternatively, the number of iterations T can be calculated given a desired accuracy using Theorem 1. The projection operator \u03a0H(w) in the last step takes a form which can efficiently be computed, projecting w onto the sphere H.\nWe emphasize that the stochastic optimization procedure introduce here does not improve on the O(1/ \u221a t)) convergence rate of the empirical kernel mean map as demonstrated in Theorem 1, but introduces a methodology to reduce the computational complexity from linear to constant."}, {"heading": "4.1 CONVERGENCE OF EXPOSE", "text": "Since w \u2192 w? converges, this implies also the weak convergence [Pey15] from w\u21c0 w? namely\nlim t\u2192\u221e\u3008u,wt\u3009 = \u3008u,w?\u3009, \u2200u \u2208 H\nand especially\nlim t\u2192\u221e\u3008\u03c6(y),wt\u3009 = \u3008\u03c6(y),\u00b5[P]\u3009, \u2200y \u2208 X\nwhich justifies the use of wt as a surrogate for \u00b5[P]."}, {"heading": "4.2 REGULARIZATION", "text": "We would like to mention that the reformulation of EXPoSE as an optimization problem also introduces the opportunity to add constraints or similar properties to the objective function. One approach is to define a general regularizer \u03bb\u2126(w) on H replacing 12 \u3008w,w\u3009 in Eq. (3) which yields\nmin w\u2208H E[f(w)] = min w\u2208H\n\u222b \u03bb\u2126(w) \u2212 \u3008\u03c6(X),w\u3009 dP\nwith some regularization parameter \u03bb > 0. An example would be to add a roughness penalty to the space of functions setting\n\u03bb\u2126(w) = \u03bb\u3008D2w,D2w\u3009\nwhere D denote the differential operator. Another possibility is to places a sparsity constraint on w. If H admits it, we can use\n\u03bb\u2126(w) = \u03bb\u2016w\u20161,\nwhere \u2016\u00b7\u20161 is the l1-norm.\nThe disadvantage of other objective functions is, that these are in general not strongly-convex and hence yielding a slower convergence rate and may require additional parameters which are difficult to tune."}, {"heading": "5 Experimental Evaluation", "text": "We present experimental results demonstrating the benefit of the proposed approach. Since the true distribution P is often unknown and a closed form solution of \u00b5[P] is not available, we will use the empirical distribution Pn as its surrogate in the objective function and measure the behavior of\n\u2016wt \u2212 \u00b5[Pn]\u2016H\nas t increases. For sufficiently large sample sizes n we can expect \u00b5[Pn] to be a good proxy for \u00b5[P] by the law of large numbers. Besides the convergence of the model wt \u2192 \u00b5[P], we will examine and compare the anomaly\ndetection scores\n\u03b7n(y) = \u3008\u03c6(y),\u00b5[Pn]\u3009 and \u03b7t(y) = \u3008\u03c6(y),wt\u3009\ncalculated by the empirical distribution (which is the original EXPoSE predictor proposed in [SEP15]) and the stochastic optimization approximation, respectively."}, {"heading": "5.1 APPROXIMATE FEATURE MAPS", "text": "While it is theoretically possible to calculate quantities like \u2016wt \u2212 \u00b5[Pn]\u2016H for any kernel k, this is extremely slow and intractable for most large-scale datasets. For datasets with a small sample size n we cannot expect \u00b5[Pn] to be a good proxy for \u00b5[P]. We therefore omit an experiment with explicit features as we either cannot compute \u00b5[Pn] (large n) or \u00b5[Pn] is not a good estimate for \u00b5[P] (small n).\nIn order to overcome this problem, EXPoSE exploits the idea of approximate feature maps for its computational efficiency. The aim is to find approximations \u03c6\u0302 : X\u2192 Rr of \u03c6 such that\nk(x,y) \u2248 \u3008\u03c6\u0302(x), \u03c6\u0302(y)\u3009\nfor all x,y \u2208 X and r \u2208 N. We will utilize the Random Kitchen Sinks (RKS) approach [RR07; RR08] which is based on Bochner\u2019s theorem for translation invariant kernels (such as the Gaussian RBF, Laplace, Mat\u00e9rn covariance, etc.). For example in the following experiments we will use the Gaussian RBF kernel k(x,y) = exp ( \u2212 1 2\u03c32 \u2016x \u2212 y\u20162 ) , which can be approximated by\nZ \u2208 Rr\u00d7d with Zij \u223c N(0,\u03c32)\n\u03c6\u0302(x) = 1\u221a r exp(\u0131Zx),\nwhere d is the dimension of X \u2286 Rd. The parameter r \u2208 N determines the number of kernel expansions and is typically around 20,000. The specific choice of approximate feature map does not affect the previous theoretical analysis and other feature map approximations [LIS10; VZ12; KK12] can be used as well."}, {"heading": "5.2 DATASETS", "text": "The following datasets, which all have purposely very different feature characteristics, are used to perform anomaly detection. We refer to [SEP15] for a detailed description of the datasets and feature characteristic.\n\u2022 The MNIST database contains 70,000 images of\nhandwritten digits. Using the raw pixel values yield an input space dimension of 784.\n\u2022 KDD-CUP 99 is an intrusion detection dataset which contains 4,898,431 connection records of network traffic. As in [SEP15] we rescale the 34 continuous features to [0, 1] and apply a binary encoding for the 7 symbolic features.\n\u2022 The third dataset contains 600,000 instances of the Google Street View House Numbers (SVHN) [Net+11] where we use the Histogram of Oriented Gradients (HOG) with a cell size of 3 to get a 2592- dimensional feature vector.\nThe kernel bandwidth \u03c32 used for these datasets are 7.0, 5.6 and 7.8 respectively, which we found to yield a reasonable anomaly detection performance.\nSince SVHN and MNIST are multi-class and not anomaly detection datasets we use the digit 1 as normal class and all other digits as anomaly instances.1 At each iteration of Algorithm 1 we uniformly choose an instance from the (training) dataset not used previously. We then update the model wt according to the algorithm. Every 200 iterations, wt is used to calculate an anomaly detection score for 10,000 dedicated random instances of the (test) dataset using the full model \u03b7n(y) and the stochastic optimization approximation \u03b7t(y)."}, {"heading": "5.3 DISCUSSION", "text": "The experimental results with approximate feature maps are shown in Fig. 2. The first row contains traces of the objective function f(wt) \u2212 f(w?), where w? \u2248 \u00b5[Pn] for all three datasets. The stochastic optimization algorithm already reaches a reasonable low objective after a few hundred iterations. A further improvement is only visible on a logarithmic scale (dashed blue) on the second y-axis on the right. More important, we observe a similar effect in the second row when comparing \u2016wt \u2212w?\u2016. We get near to w? relatively fast, but it takes much more samples to estimate w? with a high accuracy. However, we will see that a high accuracy estimation is necessary for a good anomaly detection performance. To measure the anomaly detection rate, we first plug wt and w? into the EXPoSE estimators \u03b7t(y) and \u03b7n(y) respectively and calculate scores for all instances in the test dataset. The difference of these scores are shown in row number three. We see again, that the stochastic optimization approximation \u03b7t(y) yields similar scores as the full \u03b7n(y). The last row illustrates the development of the classification error as\n1A different normal/anomaly setup had no significant impact on the experimental results.\nmore iterations are performed2. After only a few hundred iterations \u03b7t(y) reaches the same classification error as the original EXPoSE predictor \u03b7n(y). This confirms that a high accuracy approximation of w? does not necessarily lead to a better predictor. The key is, that for a given we can reach \u2016wt \u2212w?\u2016 < in a fixed number of iterations, independent of the dataset size n which reduced the computational complexity from O(n) to O(1).\nWe emphasize that, unlike other regularized risk minimization problems, EXPoSE does not have a regularization parameter. This is important as the authors of Pegasos noticed that \u201c[. . .] the runtime to achieve a predetermined suboptimality threshold would increase in proportion to \u03bb [the regularization parameter]. Very small values of \u03bb (small amounts of regularization) result in rather long runtimes\u201d [SS+11]."}, {"heading": "6 Conclusion", "text": "In this work we cast the EXPoSE anomaly detection algorithm into a stochastic optimization problem. This enables us to fine an -accurate approximation of the kernel mean map \u00b5[P] in constant time, independent of the training dataset size n. In particular, this approximations reduces the computational complexity of EXPoSE and the empirical kernel mean map from the previous O(n) to O(1) whenever an -accurate estimation is sufficient. More precisely, we are able to determine the number of necessary stochastic optimization iterations T for a user defined error threshold such that \u2016wT \u2212w?\u2016 < . The intuition is that a very high accuracy estimation w? does not necessarily result in a better anomaly detection performance and hence there is no benefit in spending more computational resources. This intuition is also confirmed experimentally on three large-scale datasets, where we reach the same anomaly detection performance long before all data is incorporated into the model. This is the first time that an optimization routine is used for EXPoSE and we provide a detailed theoretical analysis of this algorithm. We emphasize that the proposed algorithm does not introduce any additional parameters which have to be tuned and the gradient descent step-sizes are determined automatically. This has significant implications for large-scale applications such as anomaly detection problems and other techniques which are based on the kernel mean embedding.\n2The prediction score threshold is determined by means of crossvalidation."}], "references": [{"title": "Information-Theoretic Lower Bounds on the Oracle Complexity of Convex Optimization Convex optimization", "author": ["A. Agarwal"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Agarwal,? \\Q2011\\E", "shortCiteRegEx": "Agarwal", "year": 2011}, {"title": "Adaptivity of averaged stochastic gradient descent to local strong convexity for logistic regression", "author": ["F. Bach"], "venue": "The Journal of Machine Learning Research", "citeRegEx": "Bach.,? \\Q2014\\E", "shortCiteRegEx": "Bach.", "year": 2014}, {"title": "The tradeoffs of large scale learning", "author": ["O. Bousquet", "L. Bottou"], "venue": "Advances in neural information processing systems", "citeRegEx": "Bousquet and Bottou.,? \\Q2008\\E", "shortCiteRegEx": "Bousquet and Bottou.", "year": 2008}, {"title": "Convex optimization", "author": ["S. Boyd", "L. Vandenberghe"], "venue": "Cambridge university press", "citeRegEx": "BV04", "shortCiteRegEx": null, "year": 2004}, {"title": "Anomaly detection: A survey", "author": ["V. Chandola", "A. Banerjee", "V. Kumar"], "venue": "ACM Computing Surveys (CSUR)", "citeRegEx": "Chandola et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Chandola et al\\.", "year": 2009}, {"title": "Measuring statistical dependence with Hilbert-Schmidt norms", "author": ["A. Gretton"], "venue": "Algorithmic learning theory. Springer", "citeRegEx": "Gretton,? \\Q2005\\E", "shortCiteRegEx": "Gretton", "year": 2005}, {"title": "A kernel two-sample test", "author": ["A. Gretton"], "venue": "The Journal of Machine Learning Research", "citeRegEx": "Gretton,? \\Q2012\\E", "shortCiteRegEx": "Gretton", "year": 2012}, {"title": "Primal-dual subgradient methods for minimizing uniformly convex functions", "author": ["A. Juditsky", "Y. Nesterov"], "venue": null, "citeRegEx": "Juditsky and Nesterov.,? \\Q2010\\E", "shortCiteRegEx": "Juditsky and Nesterov.", "year": 2010}, {"title": "Random feature maps for dot product kernels", "author": ["P. Kar", "H. Karnick"], "venue": "In: International Conference on Artificial Intelligence and Statistics", "citeRegEx": "Kar and Karnick.,? \\Q2012\\E", "shortCiteRegEx": "Kar and Karnick.", "year": 2012}, {"title": "Random Fourier approximations for skewed multiplicative histogram kernels", "author": ["F. Li", "C. Ionescu", "C. Sminchisescu"], "venue": "Pattern Recognition. Springer,", "citeRegEx": "Li et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Li et al\\.", "year": 2010}, {"title": "Robust stochastic approximation approach to stochastic programming", "author": ["A. Nemirovski"], "venue": "SIAM Journal on Optimization", "citeRegEx": "Nemirovski,? \\Q2009\\E", "shortCiteRegEx": "Nemirovski", "year": 2009}, {"title": "Introductory lectures on convex optimization", "author": ["Y. Nesterov"], "venue": "Vol. 87. Springer Science & Business Media", "citeRegEx": "Nes04", "shortCiteRegEx": null, "year": 2004}, {"title": "A method of solving a convex programming problem with convergence rate O (1/k2)", "author": ["Y. Nesterov"], "venue": "Soviet Mathematics Doklady", "citeRegEx": "Nesterov.,? \\Q1983\\E", "shortCiteRegEx": "Nesterov.", "year": 1983}, {"title": "Reading digits in natural images with unsupervised feature learning", "author": ["Y. Netzer"], "venue": "NIPS workshop on deep learning and unsupervised feature learning", "citeRegEx": "Netzer,? \\Q2011\\E", "shortCiteRegEx": "Netzer", "year": 2011}, {"title": "A stochastic approximation method", "author": ["H. Robbins", "S. Monro"], "venue": null, "citeRegEx": "Robbins and Monro.,? \\Q1951\\E", "shortCiteRegEx": "Robbins and Monro.", "year": 1951}, {"title": "Weighted sums of random kitchen sinks: Replacing minimization with randomization in learning", "author": ["A Rahimi", "B Recht"], "venue": "Advances in neural information processing systems", "citeRegEx": "Rahimi and Recht.,? \\Q2008\\E", "shortCiteRegEx": "Rahimi and Recht.", "year": 2008}, {"title": "A stochastic gradient method with an exponential convergence _rate for finite training sets", "author": ["N.L. Roux", "M. Schmidt", "F.R. Bach"], "venue": "Advances in Neural Information Processing Systems", "citeRegEx": "Roux et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Roux et al\\.", "year": 2012}, {"title": "Expected Similarity Estimation for Large Scale Anomaly Detection", "author": ["M. Schneider", "W. Ertel", "G. Palm"], "venue": "In: International Joint Conference on Neural Networks. IEEE,", "citeRegEx": "Schneider et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Schneider et al\\.", "year": 2015}, {"title": "Universality, characteristic kernels and RKHS embedding of measures", "author": ["B.K. Sriperumbudur", "K. Fukumizu", "G.R.G. Lanckriet"], "venue": "The Journal of Machine Learning Research", "citeRegEx": "Sriperumbudur et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Sriperumbudur et al\\.", "year": 2011}, {"title": "A Hilbert space embedding for distributions", "author": ["A.J. Smola"], "venue": "Algorithmic Learning Theory. Springer", "citeRegEx": "Smola,? \\Q2007\\E", "shortCiteRegEx": "Smola", "year": 2007}, {"title": "Pegasos: Primal estimated sub-gradient solver for SVM", "author": ["S. Shalev-Shwartz"], "venue": "Mathematical Programming. Vol. 127", "citeRegEx": "Shalev.Shwartz,? \\Q2011\\E", "shortCiteRegEx": "Shalev.Shwartz", "year": 2011}, {"title": "Stochastic methods for l 1-regularized loss minimization", "author": ["S. Shalev-Shwartz", "A. Tewari"], "venue": "The Journal of Machine Learning Research", "citeRegEx": "Shalev.Shwartz and Tewari.,? \\Q2011\\E", "shortCiteRegEx": "Shalev.Shwartz and Tewari.", "year": 2011}, {"title": "Efficient Additive Kernels via Explicit Feature Maps", "author": ["A. Vedaldi", "A. Zisserman"], "venue": "Pattern Analysis and Machine Intelligence, IEEE Transactions on 34.3", "citeRegEx": "Vedaldi and Zisserman.,? \\Q2012\\E", "shortCiteRegEx": "Vedaldi and Zisserman.", "year": 2012}], "referenceMentions": [{"referenceID": 3, "context": "Other optimization techniques such as projected gradient decent [BV04] or Nesterov\u2019s accelerated gradient descent [Nes83; Nes04] are also applicable in principle, however a single gradient evaluation takes already O(n) time and hence would be slower than the originally proposed EXPoSE approach.", "startOffset": 64, "endOffset": 70}, {"referenceID": 11, "context": "Other optimization techniques such as projected gradient decent [BV04] or Nesterov\u2019s accelerated gradient descent [Nes83; Nes04] are also applicable in principle, however a single gradient evaluation takes already O(n) time and hence would be slower than the originally proposed EXPoSE approach.", "startOffset": 114, "endOffset": 128}], "year": 2015, "abstractText": "A new algorithm named EXPected Similarity Estimation (EXPoSE) was recently proposed to solve the problem of large-scale anomaly detection. It is a non-parametric and distribution free kernel method based on the Hilbert space embedding of probability measures. Given a dataset of n samples, EXPoSE needs only O(n) (linear time) to build a model and O(1) (constant time) to make a prediction. In this work we improve the linear computational complexity and show that an -accurate model can be estimated in constant time, which has significant implications for large-scale learning problems. To achieve this goal, we cast the original EXPoSE formulation into a stochastic optimization problem. It is crucial that this approach allows us to determine the number of iteration based on a desired accuracy , independent of the dataset size n. We will show that the proposed stochastic gradient descent algorithm works in general (possible infinite-dimensional) Hilbert spaces, is easy to implement and requires no additional step-size parameters.", "creator": "LaTeX with hyperref package"}}}