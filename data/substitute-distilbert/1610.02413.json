{"id": "1610.02413", "review": {"conference": "NIPS", "VERSION": "v1", "DATE_OF_SUBMISSION": "7-Oct-2016", "title": "Equality of Opportunity in Supervised Learning", "abstract": "people propose a criterion promoting discrimination against a specified sensitive attribute in supervised learning, where the goal is to predict some target based on sample features. assuming data which the predictor, target, and membership in the protected group are available, we show how to optimally adjust different learned predictor so often to remove discrimination according to our definition. our framework also improves incentives by shifting the cost of poor classification from random demographics to the decision maker, who can respond by keeping the classification accuracy.", "histories": [["v1", "Fri, 7 Oct 2016 20:16:29 GMT  (483kb,D)", "http://arxiv.org/abs/1610.02413v1", null]], "reviews": [], "SUBJECTS": "cs.LG", "authors": ["moritz hardt", "eric price", "nati srebro"], "accepted": true, "id": "1610.02413"}, "pdf": {"name": "1610.02413.pdf", "metadata": {"source": "META", "title": "Equality of Opportunity in Supervised Learning", "authors": ["Moritz Hardt", "Eric Price", "Nathan Srebro"], "emails": [], "sections": [{"heading": null, "text": "In line with other studies, our notion is oblivious: it depends only on the joint statistics of the predictor, the target and the protected attribute, but not on interpretation of individual features. We study the inherent limits of defining and identifying biases based on such oblivious measures, outlining what can and cannot be inferred from different oblivious tests.\nWe illustrate our notion using a case study of FICO credit scores."}, {"heading": "1 Introduction", "text": "As machine learning increasingly affects decisions in domains protected by anti-discrimination law, there is much interest in algorithmically measuring and ensuring fairness in machine learning. In domains such as advertising, credit, employment, education, and criminal justice, machine learning could help obtain more accurate predictions, but its effect on existing biases is not well understood. Although reliance on data and quantitative measures can help quantify and eliminate existing biases, some scholars caution that algorithms can also introduce new biases or perpetuate existing ones [BS16]. In May 2014, the Obama Administration\u2019s Big Data Working Group released a report [PPM+14] arguing that discrimination can sometimes \u201cbe the inadvertent outcome of the way big data technologies are structured and used\u201d and pointed toward \u201cthe potential of encoding discrimination in automated decisions\u201d. A subsequent White House report [Whi16] calls for \u201cequal opportunity by design\u201d as a guiding principle in domains such as credit scoring.\nDespite the demand, a vetted methodology for avoiding discrimination against protected attributes in machine learning is lacking. A na\u00efve approach might require that the algorithm should ignore all protected attributes such as race, color, religion, gender, disability, or family status. However, this idea of \u201cfairness through unawareness\u201d is ineffective due to the existence of redundant encodings, ways of predicting protected attributes from other features [PRT08].\nAnother common conception of non-discrimination is demographic parity. Demographic parity requires that a decision\u2014such as accepting or denying a loan application\u2014be independent of the protected attribute. In the case of a binary decision Y\u0302 \u2208 {0,1} and a binary protected attribute A \u2208 {0,1}, this constraint can be formalized by asking that Pr{Y\u0302 = 1 | A = 0} = Pr{Y\u0302 =\nar X\niv :1\n61 0.\n02 41\n3v 1\n[ cs\n.L G\n] 7\nO ct\n2 01\n6\n1 | A = 1}. In other words, membership in a protected class should have no correlation with the decision. Through its various equivalent formalizations this idea appears in numerous papers. Unfortunately, as was already argued by Dwork et al. [DHP+12], the notion is seriously flawed on two counts. First, it doesn\u2019t ensure fairness. Indeed, the notion permits that we accept qualified applicants in the demographic A = 0, but unqualified individuals in A = 1, so long as the percentages of acceptance match. This behavior can arise naturally, when there is little or no training data available within A = 1. Second, demographic parity often cripples the utility that we might hope to achieve. Just imagine the common scenario in which the target variable Y\u2014whether an individual actually defaults or not\u2014is correlated with A. Demographic parity would not allow the ideal predictor Y\u0302 = Y ,which can hardly be considered discriminatory as it represents the actual outcome. As a result, the loss in utility of introducing demographic parity can be substantial.\nIn this paper, we consider non-discrimination from the perspective of supervised learning, where the goal is to predict a true outcome Y from features X based on labeled training data, while ensuring they are \u201cnon-discriminatory\u201d with respect to a specified protected attribute A. As in the usual supervised learning setting, we assume that we have access to labeled training data, in our case indicating also the protected attribute A. That is, to samples from the joint distribution of (X,A,Y ). This data is used to construct a predictor Y\u0302 (X) or Y\u0302 (X,A), and we also use such data to test whether it is unfairly discriminatory.\nUnlike demographic parity, our notion always allows for the perfectly accurate solution of Y\u0302 = Y . More broadly, our criterion is easier to achieve the more accurate the predictor Y\u0302 is, aligning fairness with the central goal in supervised learning of building more accurate predictors.\nThe notion we propose is \u201coblivious\u201d, in that it is based only on the joint distribution, or joint statistics, of the true target Y , the predictions Y\u0302 , and the protected attribute A. In particular, it does not evaluate the features in X nor the functional form of the predictor Y\u0302 (X) nor how it was derived. This matches other tests recently proposed and conducted, including demographic parity and different analyses of common risk scores. In many cases, only oblivious analysis is possible as the functional form of the score and underlying training data are not public. The only information about the score is the score itself, which can then be correlated with the target and protected attribute. Furthermore, even if the features or the functional form are available, going beyond oblivious analysis essentially requires subjective interpretation or casual assumptions about specific features, which we aim to avoid."}, {"heading": "1.1 Summary of our contributions", "text": "We propose a simple, interpretable, and actionable framework for measuring and removing discrimination based on protected attributes. We argue that, unlike demographic parity, our framework provides a meaningful measure of discrimination, while demonstrating in theory and experiment that we also achieve much higher utility. Our key contributions are as follows:\n\u2022 We propose an easily checkable and interpretable notion of avoiding discrimination based on protected attributes. Our notion enjoys a natural interpretation in terms of graphical dependency models. It can also be viewed as shifting the burden of uncertainty in classification from the protected class to the decision maker. In doing so, our notion helps to incentivize the collection of better features, that depend more directly on the target rather then the protected attribute, and of data that allows better prediction for all protected classes.\n\u2022 We give a simple and effective framework for constructing classifiers satisfying our criterion from an arbitrary learned predictor. Rather than changing a possibly complex training pipeline, the result follows via a simple post-processing step that minimizes the loss in utility.\n\u2022 We show that the Bayes optimal non-discriminating (according to our definition) classifier is the classifier derived from any Bayes optimal (not necessarily non-discriminating) regressor using our post-processing step. Moreover, we quantify the loss that follows from imposing our non-discrimination condition in case the score we start from deviates from Bayesian optimality. This result helps to justify the approach of deriving a fair classifier via post-processing rather than changing the original training process.\n\u2022 We capture the inherent limitations of our approach, as well as any other oblivious approach, through a non-identifiability result showing that different dependency structures with possibly different intuitive notions of fairness cannot be separated based on any oblivious notion or test.\nThroughout our work, we assume a source distribution over (Y ,X,A), where Y is the target or true outcome (e.g. \u201cdefault on loan\u201d), X are the available features, and A is the protected attribute. Generally, the features X may be an arbitrary vector or an abstract object, such as an image. Our work does not refer to the particular form X has.\nThe objective of supervised learning is to construct a (possibly randomized) predictor Y\u0302 = f (X,A) that predicts Y as is typically measured through a loss function. Furthermore, we would like to require that Y\u0302 does not discriminate with respect to A, and the goal of this paper is to formalize this notion."}, {"heading": "2 Equalized odds and equal opportunity", "text": "We now formally introduce our first criterion.\nDefinition 2.1 (Equalized odds). We say that a predictor Y\u0302 satisfies equalized odds with respect to protected attribute A and outcome Y , if Y\u0302 and A are independent conditional on Y .\nUnlike demographic parity, equalized odds allows Y\u0302 to depend on A but only through the target variable Y . As such, the definition encourages the use of features that allow to directly predict Y , but prohibits abusing A as a proxy for Y .\nAs stated, equalized odds applies to targets and protected attributes taking values in any space, including binary, multi-class, continuous or structured settings. The case of binary random variables Y , Y\u0302 and A is of central importance in many applications, encompassing the main conceptual and technical challenges. As a result, we focus most of our attention on this case, in which case equalized odds are equivalent to:\nPr { Y\u0302 = 1 | A = 0,Y = y } = Pr { Y\u0302 = 1 | A = 1,Y = y } , y \u2208 {0,1}\nFor the outcome y = 1, the constraint requires that Y\u0302 has equal true positive rates across the two demographics A = 0 and A = 1. For y = 0, the constraint equalizes false positive rates. The definition aligns nicely with the central goal of building highly accurate classifiers, since Y\u0302 = Y is always an acceptable solution. However, equalized odds enforces that the accuracy is equally high in all demographics, punishing models that perform well only on the majority."}, {"heading": "2.1 Equal opportunity", "text": "In the binary case, we often think of the outcome Y = 1 as the \u201cadvantaged\u201d outcome, such as \u201cnot defaulting on a loan\u201d, \u201cadmission to a college\u201d or \u201creceiving a promotion\u201d. A possible relaxation of equalized odds is to require non-discrimination only within the \u201cadvantaged\u201d outcome group. That is, to require that people who pay back their loan, have an equal opportunity of getting the loan in the first place (without specifying any requirement for those that will ultimately default). This leads to a relaxation of our notion that we call \u201cequal opportunity\u201d.\nDefinition 2.2 (Equal opportunity). We say that a binary predictor Y\u0302 satisfies equal opportunity with respect to A and Y if Pr { Y\u0302 = 1 | A = 0,Y = 1 } = Pr { Y\u0302 = 1 | A = 1,Y = 1 } .\nEqual opportunity is a weaker, though still interesting, notion of non-discrimination, and thus typically allows for stronger utility as we shall see in our case study."}, {"heading": "2.2 Real-valued scores", "text": "Even if the target is binary, a real-valued predictive score R = f (X,A) is often used (e.g. FICO scores for predicting loan default), with the interpretation that higher values of R correspond to greater likelihood of Y = 1 and thus a bias toward predicting Y\u0302 = 1. A binary classifier Y\u0302 can be obtained by thresholding the score, i.e. setting Y\u0302 = I{R > t} for some threshold t. Varying this threshold changes the trade-off between sensitivity (true positive rate) and specificity (true negative rate).\nOur definition for equalized odds can be applied also to such score functions: a score R satisfies equalized odds if R is independent of A given Y . If a score obeys equalized odds, then any thresholding Y\u0302 = I{R > t} of it also obeys equalized odds (as does any other predictor derived from R alone).\nIn Section 4, we will consider scores that might not satisfy equalized odds, and see how equalized odds predictors can be derived from them and the protected attribute A, by using different (possibly randomized) thresholds depending on the value of A. The same is possible for equality of opportunity without the need for randomized thresholds."}, {"heading": "2.3 Oblivious measures", "text": "As stated before, our notions of non-discrimination are oblivious in the following formal sense.\nDefinition 2.3. A property of a predictor Y\u0302 or score R is said to be oblivious if it only depends on the joint distribution of (Y ,A, Y\u0302 ) or (Y ,A,R), respectively.\nAs a consequence of being oblivious, all the information we need to verify our definitions is contained in the joint distribution of predictor, protected group and outcome, (Y\u0302 ,A,Y ). In the binary case, when A and Y are reasonably well balanced, the joint distribution of (Y\u0302 ,A,Y ) is determined by 8 parameters that can be estimated to very high accuracy from samples. We will therefore ignore the effect of finite sample perturbations and instead assume that we know the joint distribution of (Y\u0302 ,A,Y )."}, {"heading": "3 Comparison with related work", "text": "There is much work on this topic in the social sciences and legal scholarship; we point the reader to Barocas and Selbst [BS16] for an excellent entry point to this rich literature. See also the survey by Romei and Ruggieri [RR14], and the references at http://www.fatml.org/resources.html.\nIn its various equivalent notions, demographic parity appears in many papers, such as [CKP09, Zli15, BZVGRG15] to name a few. Zemel et al. [ZWS+13] propose an interesting way of achieving demographic parity by aiming to learn a representation of the data that is independent of the protected attribute, while retaining as much information about the features X as possible. Louizos et al. [LSL+15] extend on this approach with deep variational auto-encoders. Feldman et al. [FFM+15] propose a formalization of \u201climiting disparate impact\u201d. For binary classifiers, the condition states that Pr { Y\u0302 = 1 | A = 0 } 6 0.8 \u00b7Pr { Y\u0302 = 1 | A = 1 } . The authors argue that this corresponds to the \u201c80% rule\u201d in the legal literature. The notion differs from demographic parity mainly in that it compares the probabilities as a ratio rather than additively, and in that it allows a one-sided violation of the constraint.\nWhile simple and seemingly intuitive, demographic parity has serious conceptual limitations as a fairness notion, many of which were pointed out in work of Dwork et al. [DHP+12]. In our experiments, we will see that demographic parity also falls short on utility. Dwork et al. [DHP+12] argue that a sound notion of fairness must be task-specific, and formalize fairness based on a hypothetical similarity measure d(x,x\u2032) requiring similar individuals to receive a similar distribution over outcomes. In practice, however, in can be difficult to come up with a suitable metric. Our notion is task-specific in the sense that it makes critical use of the final outcome Y , while avoiding the difficulty of dealing with the features X.\nIn a recent concurrent work, Kleinberg, Mullainathan and Raghavan [KMR16] showed that in general a score that is calibrated within each group does not satisfy a criterion equivalent to equalized odds for binary predictors. This result highlights that calibration alone does not imply non-discrimination according to our measure. Conversely, achieving equalized odds may in general compromise other desirable properties of a score.\nEarly work of Pedreshi et al. [PRT08] and several follow-up works explore a logical rulebased approach to non-discrimination. These approaches don\u2019t easily relate to our statistical approach."}, {"heading": "4 Achieving equalized odds and equality of opportunity", "text": "We now explain how to find an equalized odds or equal opportunity predictor Y\u0303 derived from a, possibly discriminatory, learned binary predictor Y\u0302 or score R. We envision that Y\u0302 or R are whatever comes out of the existing training pipeline for the problem at hand. Importantly, we do not require changing the training process, as this might introduce additional complexity, but rather only a post-learning step. In particular, we will construct a non-discriminating predictor which is derived from Y\u0302 or R:\nDefinition 4.1 (Derived predictor). A predictor Y\u0303 is derived from a random variable R and the protected attribute A if it is a possibly randomized function of the random variables (R,A) alone. In particular, Y\u0303 is independent of X conditional on (R,A).\nThe definition asks that the value of a derived predictor Y\u0303 should only depend on R and the protected attribute, though it may introduce additional randomness. But the formulation of\nY\u0303 (that is, the function applied to the values of R and A), depends on information about the joint distribution of (R,A,Y ). In other words, this joint distribution (or an empirical estimate of it) is required at training time in order to construct the predictor Y\u0303 , but at prediction time we only have access to values of (R,A). No further data about the underlying features X, nor their distribution, is required.\nLoss minimization. It is always easy to construct a trivial predictor satisfying equalized odds, by making decisions independent of X,A and R. For example, using the constant predictor Y\u0302 = 0 or Y\u0302 = 1. The goal, of course, is to obtain a good predictor satisfying the condition. To quantify the notion of \u201cgood\u201d, we consider a loss function ` : {0,1}2 \u2192 R that takes a pair of labels and returns a real number `(y\u0302, y) \u2208 R which indicates the loss (or cost, or undesirability) of predicting y\u0302 when the correct label is y. Our goal is then to design derived predictors Y\u0303 that minimize the expected loss E`(Y\u0303 ,Y ) subject to one of our definitions."}, {"heading": "4.1 Deriving from a binary predictor", "text": "We will first develop an intuitive geometric solution in the case where we adjust a binary predictor Y\u0302 and A is a binary protected attribute The proof generalizes directly to the case of a discrete protected attribute with more than two values. For convenience, we introduce the notation\n\u03b3a(Y\u0302 ) def= ( Pr { Y\u0302 = 1 | A = a,Y = 0 } , Pr { Y\u0302 = 1 | A = a,Y = 1 }) . (4.1)\nThe first component of \u03b3a(Y\u0302 ) is the false positive rate of Y\u0302 within the demographic satisfying A = a. Similarly, the second component is the true positive rate of Y\u0302 within A = a. Observe that we can calculate \u03b3a(Y\u0302 ) given the joint distribution of (Y\u0302 ,A,Y ). The definitions of equalized odds and equal opportunity can be expressed in terms of \u03b3(Y\u0302 ), as formalized in the following straight-forward Lemma:\nLemma 4.2. A predictor Y\u0302 satisfies:\n1. equalized odds if and only if \u03b30(Y\u0302 ) = \u03b31(Y\u0302 ), and\n2. equal opportunity if and only if \u03b30(Y\u0302 ) and \u03b31(Y\u0302 ) agree in the second component, i.e., \u03b30(Y\u0302 )2 = \u03b31(Y\u0302 )2.\nFor a \u2208 {0,1}, consider the two-dimensional convex polytope defined as the convex hull of four vertices:\nPa(Y\u0302 ) def= convhull { (0,0),\u03b3a(Y\u0302 ),\u03b3a(1\u2212 Y\u0302 ), (1,1) } (4.2)\nOur next lemma shows that P0(Y\u0302 ) and P1(Y\u0302 ) characterize exactly the trade-offs between false positives and true positives that we can achieve with any derived classifier. The polytopes are visualized in Figure 1.\nLemma 4.3. A predictor Y\u0303 is derived if and only if for all a \u2208 {0,1}, we have \u03b3a(Y\u0303 ) \u2208 Pa(Y\u0302 ).\nProof. Since a derived predictor Y\u0303 can only depend on (Y\u0302 ,A) and these variables are binary, the predictor Y\u0303 is completely described by four parameters in [0,1] corresponding to the probabilities Pr { Y\u0303 = 1 | Y\u0302 = y\u0302,A = a } for y\u0302, a \u2208 {0,1}. Each of these parameter choices leads to one\nof the points in Pa(Y\u0302 ) and every point in the convex hull can be achieved by some parameter setting.\nCombining Lemma 4.2 with Lemma 4.3, we see that the following optimization problem gives the optimal derived predictor with equalized odds:\nmin Y\u0303 E`(Y\u0303 ,Y ) (4.3)\ns.t. \u2200a \u2208 {0,1} : \u03b3a(Y\u0303 ) \u2208 Pa(Y\u0302 ) (derived) \u03b30(Y\u0303 ) = \u03b31(Y\u0303 ) (equalized odds)\nFigure 1 gives a simple geometric picture for the solution of the linear program whose guarantees are summarized next.\nProposition 4.4. The optimization problem (4.3) is a linear program in four variables whose coefficients can be computed from the joint distribution of (Y\u0302 ,A,Y ). Moreover, its solution is an optimal equalized odds predictor derived from Y\u0302 and A.\nProof of Proposition 4.4. The second claim follows by combining Lemma 4.2 with Lemma 4.3. To argue the first claim, we saw in the proof of Lemma 4.3 that a derived predictor is specified by four parameters and the constraint region is an intersection of two-dimensional linear constraints. It remains to show that the objective function is a linear function in these parameters. Writing out the objective, we have\nE [ `(Y\u0303 ,Y ) ] = \u2211 y,y\u2032\u2208{0,1} `(y,y\u2032)Pr { Y\u0303 = y\u2032 ,Y = y } .\nFurther, Pr { Y\u0303 = y\u2032 ,Y = y } = Pr { Y\u0303 = y\u2032 ,Y = y | Y\u0303 = Y\u0302 } Pr { Y\u0303 = Y\u0302 } + Pr { Y\u0303 = y\u2032 ,Y = y | Y\u0303 , Y\u0302 } Pr { Y\u0303 , Y\u0302\n} = Pr { Y\u0302 = y\u2032 ,Y = y } Pr { Y\u0303 = Y\u0302 } + Pr { Y\u0302 = 1\u2212 y\u2032 ,Y = y } Pr { Y\u0303 , Y\u0302 } .\nAll probabilities in the last line that do not involve Y\u0303 can be computed from the joint distribution. The probabilities that do involve Y\u0303 are each a linear function of the parameters that specify Y\u0303 .\nThe corresponding optimization problem for equation opportunity is the same except that it has a weaker constraint \u03b30(Y\u0303 )2 = \u03b31(Y\u0303 )2. The proof is analogous to that of Proposition 4.4. Figure 1 explains the solution geometrically."}, {"heading": "4.2 Deriving from a score function", "text": "We now consider deriving non-discriminating predictors from a real valued score R \u2208 [0,1]. The motivation is that in many realistic scenarios (such as FICO scores), the data are summarized by a one-dimensional score function and a decision is made based on the score, typically by thresholding it. Since a continuous statistic can carry more information than a binary outcome Y , we can hope to achieve higher utility when working with R directly, rather then with a binary predictor Y\u0302 .\nA \u201cprotected attribute blind\u201d way of deriving a binary predictor fromRwould be to threshold it, i.e. using Y\u0302 = I {R > t}. If R satisfied equalized odds, then so will such a predictor, and the optimal threshold should be chosen to balance false positive and false negatives so as to minimize the expected loss. When R does not already satisfy equalized odds, we might need to use different thresholds for different values of A (different protected groups), i.e. Y\u0303 = I {R > tA}. As we will see, even this might not be sufficient, and we might need to introduce additional randomness as in the preceding section.\nCentral to our study is the ROC (Receiver Operator Characteristic) curve of the score, which captures the false positive and true positive (equivalently, false negative) rates at different thresholds. These are curves in a two dimensional plane, where the horizontal axes is the false positive rate of a predictor and the vertical axes is the true positive rate. As discussed in the previous section, equalized odds can be stated as requiring the true positive and false positive rates, (Pr { Y\u0302 = 1 | Y = 0,A = a } ,Pr { Y\u0302 = 1 | Y = 1,A = a } ), agree between different values of a of the protected attribute. That is, that for all values of the protected attribute, the conditional behavior of the predictor is at exactly the same point in this space. We will therefor consider the A-conditional ROC curves\nCa(t) def= ( Pr { R\u0302 > t | A = a,Y = 0 } ,Pr { R\u0302 > t | A = a,Y = 1 }) .\nSince the ROC curves exactly specify the conditional distributions R|A,Y , a score function obeys equalized odds if and only if the ROC curves for all values of the protected attribute agree, that is Ca(t) = Ca\u2032 (t) for all values of a and t. In this case, any thresholding of R yields an equalized odds predictor (all protected groups are at the same point on the curve, and the same point in false/true-positive plane).\nWhen the ROC curves do not agree, we might choose different thresholds ta for the different protected groups. This yields different points on each A-conditional ROC curve. For the resulting predictor to satisfy equalized odds, these must be at the same point in the false/truepositive plane. This is possible only at points where all A-conditional ROC curves intersect. But the ROC curves might not all intersect except at the trivial endpoints, and even if they do, their point of intersection might represent a poor tradeoff between false positive and false negatives.\nAs with the case of correcting a binary predictor, we can use randomization to fill the span of possible derived predictors and allow for significant intersection in the false/true-positive plane. In particular, for every protected group a, consider the convex hull of the image of the conditional ROC curve:\nDa def= convhull {Ca(t) : t \u2208 [0,1]} (4.4)\nThe definition of Da is analogous to the polytope Pa in the previous section, except that here we do not consider points below the main diagonal (line from (0,0) to (1,1)), which are worse than \u201crandom guessing\u201d and hence never desirable for any reasonable loss function.\nDeriving an optimal equalized odds threshold predictor. Any point in the convex hull Da represents the false/true positive rates, conditioned on A = a, of a randomized derived predictor based on R. In particular, since the space is only two-dimensional, such a predictor Y\u0303 can always be taken to be a mixture of two threshold predictors (corresponding to the convex hull of two points on the ROC curve). Conditional on A = a, the predictor Y\u0303 behaves as\nY\u0303 = I {R > Ta} ,\nwhere Ta is a randomized threshold assuming the value ta with probability pa and the value ta with probability pa. In other words, to construct an equalized odds predictor, we should choose a point in the intersection of these convex hulls, \u03b3 = (\u03b30,\u03b31) \u2208 \u2229aDa, and then for each protected group realize the true/false-positive rates \u03b3 with a (possible randomized) predictor Y\u0303 |(A = a) = I {R > Ta} resulting in the predictor Y\u0303 = PrI {R > TA}. For each group a, we either use a fixed threshold Ta = ta or a mixture of two thresholds ta < ta. In the latter case, if A = a and R < ta we always set Y\u0303 = 0, if R > ta we always set Y\u0303 = 1, but if ta < R < ta, we flip a coin and set Y\u0303 = 1 with probability p\na .\nThe feasible set of false/true positive rates of possible equalized odds predictors is thus the intersection of the areas under the A-conditional ROC curves, and above the main diagonal (see Figure 2). Since for any loss function the optimal false/true-positive rate will always be on the upper-left boundary of this feasible set, this is effectively the ROC curve of the equalized odds predictors. This ROC curve is the pointwise minimum of all A-conditional ROC curves. The performance of an equalized odds predictor is thus determined by the minimum performance among all protected groups. Said differently, requiring equalized odds incentivizes the learner to build good predictors for all classes. For a given loss function, finding the optimal tradeoff\namounts to optimizing (assuming w.l.o.g. `(0,0) = `(1,1) = 0):\nmin \u2200a : \u03b3\u2208Da \u03b30`(1,0) + (1\u2212\u03b31)`(0,1) (4.5)\nThis is no longer a linear program, since Da are not polytopes, or at least are not specified as such. Nevertheless, (4.5) can be efficiently optimized numerically using ternary search.\nDeriving an optimal equal opportunity threshold predictor. The construction follows the same approach except that there is one fewer constraint. We only need to find points on the conditional ROC curves that have the same true positive rates in both groups. Assuming continuity of the conditional ROC curves, this means we can always find points on the boundary of the conditional ROC curves. In this case, no randomization is necessary. The optimal solution corresponds to two deterministic thresholds, one for each group. As before, the optimization problem can be solved efficiently using ternary search over the target true positive value. Here we use, as Figure 2 illustrates, that the cost of the best solution is convex as a function of its true positive rate."}, {"heading": "5 Bayes optimal predictors", "text": "In this section, we develop the theory a theory for non-discriminating Bayes optimal classification. We will first show that a Bayes optimal equalized odds predictor can be obtained as an derived threshold predictor of the Bayes optimal regressor. Second, we quantify the loss of deriving an equalized odds predictor based on a regressor that deviates from the Bayes optimal regressor. This can be used to justify the approach of first training classifiers without any fairness constraint, and then deriving an equalized odds predictor in a second step.\nDefinition 5.1 (Bayes optimal regressor). Given random variables (X,A) and a target variable Y , the Bayes optimal regressor is R = argminr(x,a)E [ (Y \u2212 r(X,A))2 ] = r\u2217(X,A) with r\u2217(x,a) = E[Y | X = x,A = a].\nThe Bayes optimal classifier, for any proper loss, is then a threshold predictor of R, where the threshold depends on the loss function (see, e.g., [Was10]). We will extend this result to the case where we additionally ask the classifier to satisfy an oblivious property, such as our non-discrimination properties.\nProposition 5.2. For any source distribution over (Y ,X,A) with Bayes optimal regressor R(X,A), any loss function, and any oblivious property C, there exists a predictor Y \u2217(R,A) such that:\n1. Y \u2217 is an optimal predictor satisfying C. That is, E`(Y \u2217,Y ) 6 E`(Y\u0302 ,Y ) for any predictor Y\u0302 (X,A) which satisfies C.\n2. Y \u2217 is derived from (R,A).\nProof. Consider an arbitrary classifier Y\u0302 on the attributes (X,A), defined by a (possibly randomized) function Y\u0302 = f (X,A). Given (R = r,A = a), we can draw a fresh X \u2032 from the distribution (X | R = r,A = a), and set Y \u2217 = f (X \u2032 , a). This satisfies (2). Moreover, since Y is binary with expectation R, Y is independent of X conditioned on (R,A). Hence (Y ,X,R,A) and (Y ,X \u2032 ,R,A) have identical distributions, so (Y \u2217,A,Y ) and (Y\u0302 ,A,Y ) also have identical distributions. This implies Y \u2217 satisfies (1) as desired.\nCorollary 5.3 (Optimality characterization). An optimal equalized odds predictor can be derived from the Bayes optimal regressor R and the protected attribute A. The same is true for an optimal equal opportunity predictor."}, {"heading": "5.1 Near optimality", "text": "We can furthermore show that if we can approximate the (unconstrained) Bayes optimal regressor well enough, then we can also construct a nearly optimal non-discriminating classifier.\nTo state the result, we introduce the following distance measure on random variables.\nDefinition 5.4. We define the conditional Kolmogorov distance between two random variables R,R\u2032 \u2208 [0,1] in the same probability space as A and Y as:\ndK(R,R \u2032) def= max\na,y\u2208{0,1} sup t\u2208[0,1] \u2223\u2223\u2223Pr {R > t | A = a,Y = y} \u2212Pr {R\u2032 > t | A = a,Y = y}\u2223\u2223\u2223 . (5.1) Without the conditioning onA and Y , this definition coincides with the standard Kolmogorov distance. Closeness in Kolmogorov distance is a rather weak requirement. We need the slightly stronger condition that the Kolmogorov distance is small for each of the four conditionings on A and Y . This captures the distance between the restricted ROC curves, as formalized next.\nLemma 5.5. Let R,R\u2032 \u2208 [0,1] be random variables in the same probability space as A and Y . Then, for any point p on a restricted ROC curve of R, there is a point q on the corresponding restricted ROC curve of R\u2032 such that \u2016p \u2212 q\u20162 6 \u221a 2 \u00b7 dK (R,R\u2032).\nProof. Assume the point p is achieved by thresholding R at t \u2208 [0,1]. Let q be the point on the ROC curve achieved by thresholding R\u2032 at the same threshold t\u2032 . After applying the definition to bound the distance in each coordinate, the claim follows from Pythagoras\u2019 theorem.\nWe can now show that an equalized odds predictor derived from a nearly optimal regressor is still nearly optimal among all equal odds predictors, while quantifying the loss in terms of the conditional Kolmogorov distance.\nTheorem 5.6 (Near optimality). Assume that ` is a bounded loss function, and let R\u0302 \u2208 [0,1] be an arbitrary random variable. Then, there is an optimal equalized odds predictor Y \u2217 and an equalized odds predictor Y\u0302 derived from (R\u0302,A) such that\nE`(Y\u0302 ,Y ) 6 E`(Y \u2217,Y ) + 2 \u221a 2 \u00b7 dK(R\u0302,R\u2217) ,\nwhere R\u2217 is the Bayes optimal regressor. The same claim is true for equal opportunity.\nProof of Theorem 5.6. We prove the claim for equalized odds. The case of equal opportunity is analogous.\nFix the loss function ` and the regressor R\u0302. Take Y \u2217 to be the predictor derived from the Bayes optimal regressor R\u2217 and A. By Corollary 5.3, we know that this is an optimal equalized odds predictor as required by the lemma. It remains to construct a derived equalized odds predictor Y\u0302 and relate its loss to that of Y \u2217.\nRecall the optimization problem for defining the optimal derived equalized odds predictor. Let D\u0302a be the constraint region defined by R\u0302. Likewise, let D\u2217a be the constraint region under R\n\u2217. The optimal classifier Y \u2217 corresponds to a point p\u2217 \u2208D\u22170 \u2229D \u2217 1. As a consequence of Lemma 5.5, we can find (not necessarily identical) points q0 \u2208 D\u03020 and q1 \u2208 D\u03021 such that for all a \u2208 {0,1},\n\u2016p\u2217 \u2212 qa\u20162 6 \u221a 2 \u00b7 dK(R\u0302,R\u2217) .\nWe claim that this means we can also find a feasible point q \u2208 D\u03020 \u2229 D\u03021 such that\n\u2016p\u2217 \u2212 q\u20162 6 2 \u00b7 dK(R\u0302,R\u2217) .\nTo see this, assume without loss of generality that the first coordinate of q1 is greater than the first coordinate of q0, and that all points p\u2217,q0,q1 lie above the main diagonal. By definition of D\u03021, we know that the entire line segment L1 from (0,0) to q1 is contained in D\u03021. Similarly, the entire line segment L0 between q0 and (1,1) is contained in D\u03020. Now, take q \u2208 L0 \u2229 L1. By construction, q \u2208 D\u03020 \u2229 D\u03021 defines a classifier Y\u0302 derived from R\u0302 and A. Moreover,\n\u2016p\u2217 \u2212 q\u201622 6 \u2016p \u2217 \u2212 q0\u201622 + \u2016p \u2217 \u2212 q0\u201622 6 4 \u00b7 dK(R\u0302,R \u2217)2 .\nFinally, by assumption on the loss function, there is a vector v with \u2016v\u20162 6 \u221a\n2 such that E`(Y\u0302 ,Y ) = \u3008v,q\u3009 and E`(Y \u2217,Y ) = \u3008v,p\u2217\u3009. Applying Cauchy-Schwarz,\nE`(Y\u0302 ,Y )\u2212E`(Y \u2217,Y ) = \u3008v,q \u2212 p\u2217\u30096 \u2016v\u20162 \u00b7 \u2016q \u2212 p\u2217\u20162 6 2 \u221a 2 \u00b7 dK(R\u0302,R\u2217) .\nThis completes the proof."}, {"heading": "6 Oblivious identifiability of discrimination", "text": "Before turning to analyzing data, we pause to consider to what extent \u201cblack box\u201d oblivious tests like ours can identify discriminatory predictions. To shed light on this issue, we introduce two possible scenarios for the dependency structure of the score, the target and the protected attribute. We will argue that while these two scenarios can have fundamentally different interpretations from the point of view of fairness, they can be indistinguishable from their joint distribution. In particular, no oblivious test can resolve which of the two scenarios applies.\nScenario I Consider the dependency structure depicted in Figure 4. Here, X1 is a feature highly (even deterministically) correlated with the protected attribute A, but independent of the target Y given A. For example, X1 might be \u201clanguages spoken at home\u201d or \u201cgreat great grandfather\u2019s profession\u201d. The target Y has a statistical correlation with the protected attribute. There\u2019s a second real-valued feature X2 correlated with Y , but only related to A through Y . For example, X2\nmight capture an applicant\u2019s driving record if applying for insurance, financial activity if applying for a loan, or criminal history in criminal justice situations. An intuitively \u201cfair\u201d predictor here is to use only the feature X2 through the score R\u0303 = X2. The score R\u0303 satisfies equalized odds, since X2 and A are independent conditional on Y . Because of the statistical correlation between A and Y , a better statistical predictor, with greater power, can be obtained by taking into account also the protected attribute A, or perhaps its surrogate X1. The statistically optimal predictor would have the form R\u2217 = r\u2217I (X2,X1), biasing the score according to the protected attribute A. The score R\u2217 does not satisfy equalized odds, and in a sense seems to be \u201cprofiling\u201d based on A.\nScenario II Now consider the dependency structure depicted in Figure 5. Here X3 is a feature, e.g. \u201cwealth\u201d or \u201cannual income\u201d, correlated with the protected attribute A and directly predictive of the target Y . That is, in this model, the probability of paying back of a loan is just a function of an individual\u2019s wealth, independent of their race. Using X3 on its own as a predictor, e.g. using the score R\u2217 = X3, does not naturally seem directly discriminatory. However, as can be seen from the dependency structure, this score does not satisfy equalized odds. We can correct it to satisfy equalized odds and consider the optimal non-discriminating predictor R\u0303 = r\u0303II (X3,A)\nthat does satisfy equalized odds. If A and X3, and thus A and Y , are positively correlated, then R\u0303 would depend inversely on A (see numerical construction below), introducing a form of \u201ccorrective discrimination\u201d, so as to make R\u0303 is independent of A given Y (as is required by equalized odds)."}, {"heading": "6.1 Unidentifiability", "text": "The above two scenarios seem rather different. The optimal score R\u2217 is in one case based directly on A or its surrogate, and in another only on a directly predictive feature, but this is not apparent by considering the equalized odds criterion, suggesting a possible shortcoming of equalized odds. In fact, as we will now see, the two scenarios are indistinguishable using any oblivious test. That is, no test based only on the target labels, the protected attribute and the score would give different indications for the optimal score R\u2217 in the two scenarios. If it were judged unfair in one scenario, it would also be judged unfair in the other.\nWe will show this by constructing specific instantiations of the two scenarios where the joint distributions over (Y ,A,R\u2217, R\u0303) are identical. The scenarios are thus unidentifiable based only on these joint distributions.\nWe will consider binary targets and protected attributes taking values in A,Y \u2208 {\u22121,1} and real valued features. We deviate from our convention of {0,1}-values only to simplify the resulting expressions. In Scenario I, let:\n\u2022 Pr {A = 1} = 1/2, and X1 = A\n\u2022 Y follows a logistic model parametrized based on A: Pr {Y = y | A = a} = 11+exp(\u22122ay) ,\n\u2022 X2 is Gaussian with mean Y : X2 = Y +N (0,1)\n\u2022 Optimal unconstrained and equalized odds scores are given by: R\u2217 = X1 +X2 = A+X2, and R\u0303 = X2\nIn Scenario II, let:\n\u2022 Pr {A = 1} = 1/2.\n\u2022 X3 conditional on A = a is a mixture of two Gaussians: N (a+ 1,1) with weight 11+exp(\u22122a) andN (a\u2212 1,1) with weight 11+exp(2a) .\n\u2022 Y follows a logistic model parametrized based on X3: Pr {Y = y | X3 = x3} = 11+exp(\u22122yx3) .\n\u2022 Optimal unconstrained and equalized odds scores are given by: R\u2217 = X3, and R\u0303 = X3 \u2212A\nThe following proposition establishes the equivalence between the scenarios and the optimality of the scores (proof at end of section):\nProposition 6.1. The joint distributions of (Y ,A,R\u2217, R\u0303) are identical in the above two scenarios. Moreover, R\u2217 and R\u0303 are optimal unconstrained and equalized odds scores respectively, in that their ROC curves are optimal and for any loss function an optimal (unconstrained or equalized odds) classifier can be derived from them by thresholding.\nNot only can an oblivious test (based only on (Y ,A,R)) not distinguish between the two scenarios, but even having access to the features is not of much help. Suppose we have access to all three feature, i.e. to a joint distribution over (Y ,A,X1,X2,X3)\u2014since the distributions over (Y ,A,R\u2217, R\u0303) agree, we can construct such a joint distribution with X2 = R\u0303 and X3 = R\u0303. The features are correlated with each other, with X3 = X1 +X2. Without attaching meaning to the features or making causal assumptions about them, we do not gain any further insight on the two scores. In particular, both causal structures depicted in Figure 6 are possible."}, {"heading": "6.2 Comparison of different oblivious measures", "text": "It is interesting to consider how different oblivious measures apply to the scores R\u0303 and R\u2217 in these two scenarios.\nAs discussed in Section 4.2, a score satisfies equalized odds iff the conditional ROC curves agree for both values of A, which we refer to as having identical ROC curves.\nDefinition 6.2 (Identical ROC Curves). We say that a score R has identical conditional ROC curves if Ca(t) = Ca\u2032 (t) for all groups of a,a\u2032 and all t \u2208 R.\nIn particular, this property is achieved by an equalized odds score R\u0303. Within each protected group, i.e. for each value A = a, the score R\u2217 differs from R\u0303 by a fixed monotone transformation, namely an additive shift R\u2217 = R\u0303 +A. Consider a derived threshold predictor Y\u0302 (R\u0303) = I { R\u0303 > t } based on R\u0303. Any such predictor obeys equalized odds. We can also derive the same predictor\ndeterministically from R\u2217 andA as Y\u0302 (R\u2217,A) = I {R\u2217 > tA}where tA = t\u2212A. That is, in our particular example, R\u2217 is special in that optimal equalized odds predictors can be derived from it (and the protected attribute A) deterministically, without the need to introduce randomness as in Section 4.2. In terms of the A-conditional ROC curves, this happens because the images of the conditional ROC curves C0 and C1 overlap, making it possible to choose points in the true/false-positive rate plane that are on both ROC curves. However, the same point on the conditional ROC curves correspond to different thresholds! Instead of C0(t) = C1(t), for R\u2217 we have C0(t) = C1(t \u2212 1). We refer to this property as \u201cmatching\u201d conditional ROC curves:\nDefinition 6.3 (Matching ROC curves). We say that a score R has matching conditional ROC curves if the images of all A-conditional ROC curves are the same, i.e., for all groups a,a\u2032 , {Ca(t) : t \u2208 R} = {Ca\u2032 (t) : t \u2208 R} .\nHaving matching conditional ROC curves corresponds to being deterministically correctable to be non-discriminating: If a predictor R has matching conditional ROC curves, then for any loss function the optimal equalized odds derived predictor is a deterministic function of R and A. But as our examples show, having matching ROC curves does not at all mean the score is itself non-discriminatory: it can be biased according to A, and a (deterministic) correction might be necessary in order to ensure equalized odds.\nHaving identical or matching ROC curves are properties of the conditional distribution R|Y ,A, also referred to as \u201cmodel errors\u201d. Oblivious measures can also depend on the conditional distribution Y |R,A, also referred to as \u201ctarget population errors\u201d. In particular, one might consider the following property:\nDefinition 6.4 (Matching frequencies). We say that a score R has matching conditional frequencies, if for all groups a,a\u2032 and all scores t, we have\nPr {Y = 1 | R = t,A = a} = Pr { Y = 1 | R = t,A = a\u2032 } .\nMatching conditional frequencies state that at a given score, both groups have the same probability of being labeled positive. The definition can also be phrased as requiring that the conditional distribution Y |R,A be independent of A. In other words, having matching conditional frequencies is equivalent to A and Y being independent conditioned on R. The corresponding dependency structure is Y \u2212 R \u2212A. That is, the score R includes all possible information the protected attribute can provide on the target Y . Indeed having matching conditional frequencies means that the score is in a sense \u201coptimally dependent\u201d on the protected attribute A. Formally, for any loss function the optimal (unconstrained, possibly discriminatory) derived predictor Y\u0302 (R,A) would be a function of R alone, since R already includes all relevant information about A. In particular, an unconstrained optimal score, like R\u2217 in our constructions, would satisfy matching conditional frequencies. Having matching frequencies can therefore be seen as a property indicating utilizing the protected attribute for optimal predictive power, rather then protecting discrimination based on it.\nIt is also worth noting the similarity between matching frequencies and a binary predictor Y\u0302 having equal conditional precision, that is Pr { Y = 1 | Y\u0302 = y\u0302,A = a } = Pr { Y = 1 | Y\u0302 = y\u0302,A = a\u2032 } .\nViewing Y\u0302 as a score that takes two possible values, the notions agree. But R having matching conditional frequencies does not imply the threshold predictors Y\u0302 (R) = I {R > t} will have matching precision\u2014the conditional distributions R|A might be different, and these are involved in marginalizing over R > t and R6 t.\nTo summarize, the properties of the scores in our scenarios are:\n\u2022 R\u2217 is optimal based on the features and protected attribute, without any constraints.\n\u2022 R\u0303 is optimal among all equalized odds scores.\n\u2022 R\u0303 does satisfy equal odds, R\u2217 does not satisfy equal odds.\n\u2022 R\u0303 has identical (thus matching) ROC curves, R\u2217 has matching but non-identical ROC curves.\n\u2022 R\u2217 has matching conditional frequencies, while R\u0303 does not.\nProof of Proposition 6.1\nFirst consider Scenario I. The score R\u0303 = X2 obeys equalized odds due to the dependency structure. More broadly, if a score R = f (X2,X1) obeys equalized odds, for some randomized function f , it cannot depend on X1: conditioned on Y , X2 is independent of A = X1, and so any dependency of f on X1 would create a statistical dependency on A = X1 (still conditioned on Y ) which is not allowed. We can verify that Pr {Y = y | X2 = x2} \u221d Pr {Y = y}Pr {X2 = x2 | Y = y} \u221d exp(2yx2) which is monotone in X2, and so for any loss function we would just want to threshold X2 and any function monotone in X2 would make an optimal equalized odds predictor.\nTo obtain the optimal unconstrained score consider\nPr {Y = y | X1 = x1,X2 = x2} \u221d Pr {A = x1}Pr {Y = y | A = x1}Pr {X2 = x2 | Y = y} \u221d exp(2y(x1 + x2)).\nThat is, optimal classification only depends on x1 + x2 and so R\u2217 = X1 +X2 is optimal. Turning to scenario II, since P (Y |X3) is monotone in X3, any monotone function of it is optimal (unconstrained), and the dependency structure implies its optimal even if we allow dependence on A. Furthermore, the conditional distribution Y |X3 matched that of Y |R\u2217 from scenario I since again we have Pr {Y = y|X3 = x3} \u221d exp(2yx3) by construction. Since we defined R\u2217 = X3, we have that the conditionals R\u2217|Y match. We can also verify that by construction X3|A matches R\u2217|A in scenario I. Since in scenario I, R\u2217 is optimal even dependent on A, we have that A is independent of Y conditioned on R\u2217, as in scenario II when we condition on X3 = R\u2217. This establishes the joint distribution over (A,Y ,R\u2217) is the same in both scenarios. Since R\u0303 is the same deterministic function of A and R\u2217 in both scenarios, we can further conclude the joint distributions over A,Y ,R\u2217 and R\u0303 are the same. Since equalized odds is an oblivious property, once these distributions match, if R\u0303 obeys equalized odds in scenario I, it also obeys it in scenario II."}, {"heading": "7 Case study: FICO scores", "text": "We examine various fairness measures in the context of FICO scores with the protected attribute of race. FICO scores are a proprietary classifier widely used in the United States to predict credit worthiness. Our FICO data is based on a sample of 301536 TransUnion TransRisk scores from 2003 [Res07]. These scores, ranging from 300 to 850, try to predict credit risk; they form our score R. People were labeled as in default if they failed to pay a debt for at least 90 days on at least one account in the ensuing 18-24 month period; this gives an outcome Y . Our protected attribute A is race, which is restricted to four values: Asian, white non-Hispanic (labeled \u201cwhite\u201d\nin figures), Hispanic, and black. FICO scores are complicated proprietary classifiers based on features, like number of bank accounts kept, that could interact with culture\u2014and hence race\u2014in unfair ways. A credit score cutoff of 620 is commonly used for prime-rate loans1,\nwhich corresponds to an any-account default rate of 18%. Note that this measures default on any account TransUnion was aware of; it corresponds to a much lower (\u2248 2%) chance of default on individual new loans. To illustrate the concepts, we use any-account default as our target Y\u2014a higher positive rate better illustrates the difference between equalized odds and equal opportunity.\nWe therefore consider the behavior of a lender who makes money on default rates below this, i.e., for whom whom false positives (giving loans to people that default on any account) is 82/18 as expensive as false negatives (not giving a loan to people that don\u2019t default). The lender thus wants to construct a predictor Y\u0302 that is optimal with respect to this asymmetric loss. A typical classifier will pick a threshold per group and set Y\u0302 = 1 for people with FICO scores above the threshold for their group. Given the marginal distributions for each group (Figure 7), we can study the optimal profit-maximizing classifier under five different constraints on allowed predictors:\n\u2022 Max profit has no fairness constraints, and will pick for each group the threshold that maximizes profit. This is the score at which 82% of people in that group do not default.\n\u2022 Race blind requires the threshold to be the same for each group. Hence it will pick the single threshold at which 82% of people do not default overall, shown in Figure 8.\n\u2022 Demographic parity picks for each group a threshold such that the fraction of group members that qualify for loans is the same.\n\u2022 Equal opportunity picks for each group a threshold such that the fraction of non-defaulting group members that qualify for loans is the same.\n1http://www.creditscoring.com/pages/bar.htm (Accessed: 2016-09-20)\n\u2022 Equalized odds requires both the fraction of non-defaulters that qualify for loans and the fraction of defaulters that qualify for loans to be constant across groups. This cannot be achieved with a single threshold for each group, but requires randomization. There are many ways to do it; here, we pick two thresholds for each group, so above both thresholds people always qualify and between the thresholds people qualify with some probability.\nWe could generalize the above constraints to allow non-threshold classifiers, but we can show that each profit-maximizing classifier will use thresholds. As shown in Section 4, the optimal thresholds can be computed efficiently; the results are shown in Figure 9. Our proposed fairness definitions give thresholds between those of max-profit/race-blind thresholds and of demographic parity. Figure 10 plots the ROC curves for each group. It should be emphasized that differences in the ROC curve do not indicate differences in default behavior but rather differences in prediction accuracy\u2014lower curves indicate FICO scores are less predictive for those populations. This demonstrates, as one should expect, that the majority (white) group is classified more accurately than minority groups, even over-represented minority groups like Asians.\nThe left side of Figure 11 shows the fraction of people that wouldn\u2019t default that would qualify for loans by the various metrics. Under max-profit and race-blind thresholds, we find that black people that would not default have a significantly harder time qualifying for loans than others. Under demographic parity, the situation is reversed.\nThe right side of Figure 11 gives the profit achieved by each method, as a fraction of the max profit achievable. We show this as a function of the non-default rate above which loans are profitable (i.e. 82% in the other figures). At 82%, we find that a race blind threshold gets 99.3% of the maximal profit, equal opportunity gets 92.8%, equalized odds gets 80.2%, and demographic parity gets 69.8%. So equal opportunity fairness costs less than a quarter what demographic parity costs\u2014and if the classifier improves, this would reduce further.\nThe difference between equal odds and equal opportunity is that under equal opportunity, the classifier can make use of its better accuracy among whites. Under equal odds this is viewed as unfair, since it means that white people who wouldn\u2019t pay their loans have a harder time getting them than minorities who wouldn\u2019t pay their loans. An equal odds classifier must classify everyone as poorly as the hardest group, which is why it costs over twice as much in this case. This also leads to more conservative lending, so it is slightly harder for non-defaulters of all groups to get loans.\nThe equal opportunity classifier does make it easier for defaulters to get loans if they are minorities, but the incentives are aligned properly. Under max profit, a small group may not be worth figuring out how to classify and so be treated poorly, since the classifier can\u2019t identify the qualified individuals. Under equal opportunity, such poorly-classified groups are instead treated better than well-classified groups. The cost is thus born by the company using the classifier, which can decide to invest in better classification, rather than the classified group, which cannot. Equalized odds gives a similar, but much stronger, incentive since the cost for a small group is not proportional to its size.\nWhile race blindness achieves high profit, the fairness guarantee is quite weak. As with max profit, small groups may be classified poorly and so treated poorly, and the company has little incentive to improve the accuracy. Furthermore, when race is redundantly encoded, race blindness degenerates into max profit."}, {"heading": "8 Conclusions", "text": "We proposed a fairness measure that accomplishes two important desiderata. First, it remedies the main conceptual shortcomings of demographic parity as a fairness notion. Second, it is fully\naligned with the central goal of supervised machine learning, that is, to build higher accuracy classifiers. In light of our results, we draw several conclusions aimed to help interpret and apply our framework effectively.\nChoose reliable target variables. Our notion requires access to observed outcomes such as default rates in the loan setting. This is precisely the same requirement that supervised learning\ngenerally has. The broad success of supervised learning demonstrates that this requirement is met in many important applications. That said, having access to reliable \u201clabeled data\u201d is not always possible. Moreover, the measurement of the target variable might in itself be unreliable or biased. Domain-specific scrutiny is required in defining and collecting a reliable target variable.\nMeasuring unfairness, rather than proving fairness. Due to the limitations we described, satisfying our notion (or any other oblivious measure) should not be considered a conclusive proof of fairness. Similarly, violations of our condition are not meant to be a proof of unfairness. Rather we envision our framework as providing a reasonable way of discovering and measuring potential concerns that require further scrutiny. We believe that resolving fairness concerns is ultimately impossible without substantial domain-specific investigation. This realization echoes earlier findings in \u201cFairness through Awareness\u201d [DHP+12] describing the task-specific nature of fairness.\nIncentives. Requiring equalized odds creates an incentive structure for the entity building the predictor that aligns well with achieving fairness. Achieving better prediction with equalized odds requires collecting features that more directly capture the target Y , unrelated to its correlation with the protected attribute. Deriving an equalized odds predictor from a score involves considering the pointwise minimum ROC curve among different protected groups, encouraging constructing of predictors that are accurate in all groups, e.g., by collecting data appropriately or basing prediction on features predictive in all groups.\nWhen to use our post-processing step. An important feature of our notion is that it can be achieved via a simple and efficient post-processing step. In fact, this step requires only aggregate information about the data and therefore could even be carried out in a privacypreserving manner (formally, via Differential Privacy). In contrast, many other approaches require changing a usually complex machine learning training pipeline, or require access to raw data. Despite its simplicity, our post-processing step exhibits a strong optimality principle. If the underlying score was close to optimal, then the derived predictor will be close to optimal among all predictors satisfying our definition. However, this does not mean that the predictor is necessarily good in an absolute sense. It also does not mean that the loss compared to the original predictor is always small. An alternative to using our post-processing step is always to invest in better features and more data. Only when this is no longer an option, should our post-processing step be applied.\nPredictive affirmative action. In some situations, including Scenario II in Section 6, the equalized odds predictor can be thought of as introducing some sort of affirmative action: the optimally predictive score R\u2217 is shifted based on A. This shift compensates for the fact that, due to uncertainty, the score is in a sense more biased then the target label (roughly, R\u2217 is more correlated with A then Y is correlated with A). Informally speaking, our approach transfers the burden of uncertainty from the protected class to the decision maker. We believe this is a reasonable proposal, since it incentivizes the decision maker to invest additional resources toward building a better model."}], "references": [{"title": "Building classifiers with independency constraints", "author": ["T. Calders", "F. Kamiran", "M. Pechenizkiy"], "venue": "In In Proc. IEEE International Conference on Data Mining Workshops,", "citeRegEx": "Calders et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Calders et al\\.", "year": 2009}, {"title": "Fairness through awareness", "author": ["Cynthia Dwork", "Moritz Hardt", "Toniann Pitassi", "Omer Reingold", "Richard S. Zemel"], "venue": "In Proc. ACM ITCS,", "citeRegEx": "Dwork et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Dwork et al\\.", "year": 2012}, {"title": "Certifying and removing disparate impact", "author": ["Michael Feldman", "Sorelle A. Friedler", "John Moeller", "Carlos Scheidegger", "Suresh Venkatasubramanian"], "venue": "In Proc. 21st ACM SIGKDD,", "citeRegEx": "Feldman et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Feldman et al\\.", "year": 2015}, {"title": "Inherent tradeoffs in the fair determination of risk", "author": ["Jon M. Kleinberg", "Sendhil Mullainathan", "Manish Raghavan"], "venue": "scores. CoRR,", "citeRegEx": "Kleinberg et al\\.,? \\Q2016\\E", "shortCiteRegEx": "Kleinberg et al\\.", "year": 2016}, {"title": "The variational fair autoencoder", "author": ["Christos Louizos", "Kevin Swersky", "Yujia Li", "Max Welling", "Richard S. Zemel"], "venue": "CoRR, abs/1511.00830,", "citeRegEx": "Louizos et al\\.,? \\Q2015\\E", "shortCiteRegEx": "Louizos et al\\.", "year": 2015}, {"title": "Big data: Seizing opportunities and preserving values", "author": ["John Podesta", "Penny Pritzker", "Ernest J. Moniz", "John Holdren", "Jefrey Zients"], "venue": "Executive Office of the President,", "citeRegEx": "Podesta et al\\.,? \\Q2014\\E", "shortCiteRegEx": "Podesta et al\\.", "year": 2014}, {"title": "Discrimination-aware data mining", "author": ["Dino Pedreshi", "Salvatore Ruggieri", "Franco Turini"], "venue": "In Proc. 14th ACM SIGKDD,", "citeRegEx": "Pedreshi et al\\.,? \\Q2008\\E", "shortCiteRegEx": "Pedreshi et al\\.", "year": 2008}, {"title": "A multidisciplinary survey on discrimination analysis", "author": ["Andrea Romei", "Salvatore Ruggieri"], "venue": "The Knowledge Engineering Review, 29:582\u2013638,", "citeRegEx": "Romei and Ruggieri.,? \\Q2014\\E", "shortCiteRegEx": "Romei and Ruggieri.", "year": 2014}, {"title": "On the relation between accuracy and fairness in binary classification", "author": ["Indre Zliobaite"], "venue": "CoRR, abs/1505.05723,", "citeRegEx": "Zliobaite.,? \\Q2015\\E", "shortCiteRegEx": "Zliobaite.", "year": 2015}, {"title": "Learning fair representations", "author": ["Richard S. Zemel", "Yu Wu", "Kevin Swersky", "Toniann Pitassi", "Cynthia Dwork"], "venue": "In Proc. 30th ICML,", "citeRegEx": "Zemel et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Zemel et al\\.", "year": 2013}], "referenceMentions": [], "year": 2016, "abstractText": "We propose a criterion for discrimination against a specified sensitive attribute in supervised learning, where the goal is to predict some target based on available features. Assuming data about the predictor, target, and membership in the protected group are available, we show how to optimally adjust any learned predictor so as to remove discrimination according to our definition. Our framework also improves incentives by shifting the cost of poor classification from disadvantaged groups to the decision maker, who can respond by improving the classification accuracy. In line with other studies, our notion is oblivious: it depends only on the joint statistics of the predictor, the target and the protected attribute, but not on interpretation of individual features. We study the inherent limits of defining and identifying biases based on such oblivious measures, outlining what can and cannot be inferred from different oblivious tests. We illustrate our notion using a case study of FICO credit scores.", "creator": "LaTeX with hyperref package"}}}