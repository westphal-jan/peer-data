{"id": "1403.1349", "review": {"conference": "ACL", "VERSION": "v1", "DATE_OF_SUBMISSION": "6-Mar-2014", "title": "Learning Soft Linear Constraints with Application to Citation Field Extraction", "abstract": "Accurately segmenting has iso four into agricultural for amongst, classic, \u017e. is a challenging challenges because the sector typically svo various policy processes. Previous works fact presenting fact creative soft constraints, they place model neither moreover, but certain must without ignore to constraints, unlike constrained improve segmentation thanks. On long other looking, each imposing hard constraints, dual decomposition unlike similar popular useful for capabilities suggests taken existing algorithms from unconstrained inference. We extend saw technique could various prediction subject either thick adequate. Moreover, rest instead piece a performing inference given much budgetary, always is kind out automatically generate several families related limitations and sure certain offset with brought way orientable optimization problem during combat. This maintain 50 actually enables substantial despite a accuracy on to for, challenging essay extraction dataset.", "histories": [["v1", "Thu, 6 Mar 2014 05:24:02 GMT  (26kb)", "https://arxiv.org/abs/1403.1349v1", null], ["v2", "Fri, 17 Oct 2014 13:27:02 GMT  (26kb)", "http://arxiv.org/abs/1403.1349v2", "appears in Proc. the 52nd Annual Meeting of the Association for Computational Linguistics (ACL2014)"]], "reviews": [], "SUBJECTS": "cs.CL cs.DL cs.IR", "authors": ["sam anzaroot", "alexandre passos", "david belanger", "andrew mccallum"], "accepted": true, "id": "1403.1349"}, "pdf": {"name": "1403.1349.pdf", "metadata": {"source": "CRF", "title": null, "authors": [], "emails": ["mccallum}@cs.umass.edu"], "sections": [{"heading": null, "text": "ar X\niv :1\n40 3.\n13 49\nv2 [\ncs .C\nL ]\n1 7\nO ct\n2 01\n4"}, {"heading": "1 Introduction", "text": "Citation field extraction, an instance of information extraction, is the task of segmenting and labeling research paper citation strings into their constituent parts, including authors, editors, year, journal, volume, conference venue, etc. This task is important because citation data is often provided only in plain text; however, having an accurate structured database of bibliographic information is necessary for many scientometric tasks, such as mapping scientific sub-communities, discovering research trends, and analyzing networks of researchers. Automated citation field extraction needs further research because it has not yet reached a level of accuracy at which it can be practically deployed in real-world systems.\nHidden Markov models and linear-chain conditional random fields (CRFs) have previously been applied to citation extraction (Hetzner, 2008; Peng and McCallum, 2004) . These models support efficient dynamic-programming inference, but only model local dependencies in the output label sequence. However citations have strong global regularities not captured by these models. For example many book citations contain both an author section and an editor section, but none have two disjoint author sections. Since linearchain models are unable to capture more than Markov dependencies, the models sometimes mislabel the editor as a second author. If we could enforce the global constraint that there should be only one author section, accuracy could be improved.\nOne framework for adding such global constraints into tractable models is constrained inference, in which at inference time the original model is augmented with restrictions on the outputs such that they obey certain global regularities. When hard constraints can be encoded as linear equations on the output variables, and the underlying model\u2019s inference task can be posed as linear optimization, one can formulate this constrained inference problem as an integer linear program (ILP) (Roth and Yih, 2004). Alternatively, one can employ dual decomposition (Rush et al., 2010). Dual decompositions\u2019s advantage over ILP is is that it can leverage existing inference algorithms for the original model as a black box. Such a modular algorithm is easy to implement, and works quite well in practice, providing certificates of optimality for most examples.\nThe above two approaches have previously been applied to impose hard constraints on a model\u2019s output. On the other hand, recent work has demonstrated improvements in citation field extraction by imposing soft constraints (Chang et al., 2012). Here, the model is not required obey the global\nconstraints, but merely pays a penalty for their violation.\nThis paper introduces a novel method for imposing soft constraints via dual decomposition. We also propose a method for learning the penalties the prediction problem incurs for violating these soft constraints. Because our learning method drives many penalties to zero, it allows practitioners to perform \u2018constraint selection,\u2019 in which a large number of automatically-generated candidate global constraints can be considered and automatically culled to a smaller set of useful constraints, which can be run quickly at test time.\nUsing our new method, we are able to incorporate not only all the soft global constraints of Chang et al. (2012), but also far more complex data-driven constraints, while also providing stronger optimality certificates than their beam search technique. On a new, more broadly representative, and challenging citation field extraction data set, we show that our methods achieve a 17.9% reduction in error versus a linear-chain conditional random field. Furthermore, we demonstrate that our inference technique can use and benefit from the constraints of Chang et al. (2012), but that including our data-driven constraints on top of these is beneficial. While this paper focusses on an application to citation field extraction, the novel methods introduced here would easily generalize to many problems with global output regularities."}, {"heading": "2 Background", "text": ""}, {"heading": "2.1 Structured Linear Models", "text": "The overall modeling technique we employ is to add soft constraints to a simple model for which we have an existing efficient prediction algorithm. For this underlying model, we employ a chain-structured conditional random field (CRF), since CRFs have been shown to perform better than other simple unconstrained models like hidden markov models for citation extraction (Peng and McCallum, 2004). We produce a prediction by performing MAP inference (Koller and Friedman, 2009).\nThe MAP inference task in a CRF be can ex-\npressed as an optimization problem with a linear objective (Sontag, 2010; Sontag et al., 2011). Here, we define a binary indicator variable for each candidate setting of each factor in the graphical model. Each of these indicator variables is associated with the score that the factor takes on when it has the indictor variable\u2019s corresponding value. Since the log probability of some y in the CRF is proportional to sum of the scores of all the factors, we can concatenate the indicator variables as a vector y and the scores as a vector w and write the MAP problem as\nmax. \u3008w, y\u3009 s.t. y \u2208 U ,\n(1)\nwhere the set U represents the set of valid configurations of the indicator variables. Here, the constraints are that all neighboring factors agree on the components of y in their overlap.\nStructured Linear Models are the general family of models where prediction requires solving a problem of the form (1), and they do not always correspond to a probabilistic model. The algorithms we present in later sections for handling soft global constraints and for learning the penalties of these constraints can be applied to general structured linear models, not just CRFs, provided we have an available algorithm for performing MAP inference."}, {"heading": "2.2 Dual Decomposition for Global Constraints", "text": "In order to perform prediction subject to various global constraints, we may need to augment the problem (1) with additional constraints. Dual Decomposition is a popular method for performing MAP inference in this scenario, since it leverages known algorithms for MAP in the base problem where these extra constraints have not been added (Komodakis et al., 2007; Sontag et al., 2011; Rush and Collins, 2012). In this case, the MAP problem can be formulated as a structured linear model similar to equation (1), for which we have a MAP algorithm, but where we have imposed some additional constraints Ay \u2264 b that no longer allow us to use the algorithm. In\nAlgorithm 1 DD: projected subgradient for dual decomposition with hard constraints\n1: while has not converged do 2: y(t) = argmaxy\u2208U \u2329 w + AT\u03bb, y \u232a 3: \u03bb(t) = \u03a00\u2264\u00b7 [ \u03bb(t\u22121) \u2212 \u03b7(t)(Ay \u2212 b) ]\nother words, we consider the problem\nmax. \u3008w, y\u3009 s.t. y \u2208 U\nAy \u2264 b, (2)\nfor an arbitrary matrix A and vector b. We can write the Lagrangian of this problem as\nL(y, \u03bb) = \u3008w, y\u3009 + \u03bbT (Ay \u2212 b). (3)\nRegrouping terms and maximizing over the primal variables, we have the dual problem\nmin.\u03bbD(\u03bb) = max y\u2208U\n\u2329 w +AT\u03bb, y \u232a \u2212 \u03bbT b. (4)\nFor any \u03bb, we can evaluate the dual objective D(\u03bb), since the maximization in (4) is of the same form as the original problem (1), and we assumed we had a method for performing MAP in this. Furthermore, a subgradient of D(\u03bb) is Ay\u2217 \u2212 b, for an y\u2217 which maximizes this inner optimization problem. Therefore, we can minimize D(\u03bb) with the projected subgradient method (Boyd and Vandenberghe, 2004), and the optimal y can be obtained when evaluating D(\u03bb\u2217). Note that the subgradient of D(\u03bb) is the amount by which each constraint is violated by \u03bb when maximizing over y.\nAlgorithm 1 depicts the basic projected subgradient descent algorithm for dual decomposition. The projection operator \u03a0 consists of truncating all negative coordinates of \u03bb to 0. This is necessary because \u03bb is a vector of dual variables for inequality constraints. The algorithm has converged when each constraint is either satisfied by y(t) with equality or its corresponding component of \u03bb is 0, due to complimentary slackness (Boyd and Vandenberghe, 2004)."}, {"heading": "3 Soft Constraints in Dual Decomposition", "text": "We now introduce an extension of Algorithm 1 to handle soft constraints. In our formulation, a soft-constrained model imposes a penalty for each unsatisfied constraint, proportional to the amount\nby which it is violated. Therefore, our derivation parallels how soft-margin SVMs are derived from hard-margin SVMs by introducing auxiliary slack variables (Cortes and Vapnik, 1995). Note that when performing MAP subject to soft constraints, optimal solutions might not satisfy some constraints, since doing so would reduce the model\u2019s score by too much.\nConsider the optimization problems of the form:\nmax. \u3008w, y\u3009 \u2212 \u3008c, z\u3009 s.t. y \u2208 U\nAy \u2212 b \u2264 z \u2212z \u2264 0,\n(5)\nFor positive ci, it is clear that an optimal zi will be equal to the degree to which aTi y \u2264 bi is violated. Therefore, we pay a cost ci times the degree to which the ith constraint is violated, which mirrors how slack variables are used to represent the hinge loss for SVMs. Note that ci has to be positive, otherwise this linear program is unbounded and an optimal value can be obtained by setting zi to infinity.\nUsing a similar construction as in section 2.2 we write the Lagrangian as:\n(6)L(y, z, \u03bb, \u00b5) = \u3008w, y\u3009 \u2212 \u3008c, z\u3009\n+ \u03bbT (Ay \u2212 b\u2212 z) + \u00b5T (\u2212z).\nThe optimality constraints with respect to z tell us that \u2212c\u2212 \u03bb\u2212 \u00b5 = 0, hence \u00b5 = \u2212c\u2212 \u03bb. Substituting, we have\nL(y, \u03bb) = \u3008w, y\u3009+ \u03bbT (Ay \u2212 b), (7)\nexcept the constraint that \u00b5 = \u2212c\u2212 \u03bb implies that for \u00b5 to be positive \u03bb \u2264 c.\nSince this Lagrangian has the same form as equation (3), we can also derive a dual problem, which is the same as in equation (4), with the additional constraint that each \u03bbi can not be bigger than its cost ci. In other words, the dual problem can not penalize the violation of a constraint more than the soft constraint model in the primal would penalize you if you violated it.\nThis optimization problem can still be solved with projected subgradient descent and is depicted in Algorithm 2. The only modifications to Algorithm 1 are replacing the coordinate-wise projection \u03a00\u2264\u00b7 with \u03a00\u2264\u00b7\u2264c and how we check for convergence. Now, we check for the KKT conditions of (5), where for every constraint i, either\nAlgorithm 2 Soft-DD: projected subgradient for dual decomposition with soft constraints\n1: while has not converged do 2: y(t) = argmaxy\u2208U \u2329 w + AT\u03bb, y \u232a 3: \u03bb(t) = \u03a00\u2264\u00b7\u2264c [ \u03bb(t\u22121) \u2212 \u03b7(t)(Ay \u2212 b) ]\nthe constraint is satisfied with equality, \u03bbi = 0, or \u03bbi = ci.\nTherefore, implementing soft-constrained dual decomposition is as easy as implementing hardconstrained dual decomposition, and the periteration complexity is the same. We encourage further applications of soft-constraint dual decomposition to existing and new NLP problems."}, {"heading": "3.1 Learning Penalties", "text": "One consideration when using soft v.s. hard constraints is that soft constraints present a new training problem, since we need to choose the vector c, the penalties for violating the constraints. An important property of problem (5) in the previous section is that it corresponds to a structured linear model over y and z. Therefore, we can apply known training algorithms for estimating the parameters of structured linear models to choose c.\nAll we need to employ the structured perceptron algorithm (Collins, 2002) or the structured SVM algorithm (Tsochantaridis et al., 2004) is a blackbox procedure for performing MAP inference in the structured linear model given an arbitrary cost vector. Fortunately, the MAP problem for (5) can be solved using Soft-DD, in Algorithm 2.\nEach penalty ci has to be non-negative; otherwise, the optimization problem in equation (5) is ill-defined. This can be ensured by simple modifications of the perceptron and subgradient descent optimization of the structured SVM objective simply by truncating c coordinate-wise to be non-negative at every learning iteration.\nIntuitively, the perceptron update increases the penalty for a constraint if it is satisfied in the ground truth and not in an inferred prediction, and decreases the penalty if the constraint is satisfied in the prediction and not the ground truth. Since we truncate penalties at 0, this suggests that we will learn a penalty of 0 for constraints in three categories: constraints that do not hold in the ground truth, constraints that hold in the ground truth but are satisfied in practice by performing inference in the base CRF model, and constraints that are satisfied in practice as a side-effect of imposing\nnon-zero penalties on some other constraints . A similar analysis holds for the structured SVM approach.\nTherefore, we can view learning the values of the penalties not just as parameter tuning, but as a means to perform \u2018constraint selection,\u2019 since constraints that have a penalty of 0 can be ignored. This property allows us to consider large families of constraints, from which the useful ones are automatically identified.\nWe found it beneficial, though it is not theoretically necessary, to learn the constraints on a heldout development set, separately from the other model parameters, as during training most constraints are satisfied due to overfitting, which leads to an underestimation of the relevant penalties."}, {"heading": "4 Citation Extraction Data", "text": "We consider the UMass citation dataset, first introduced in Anzaroot and McCallum (2013). It has over 1800 citation from many academic fields, extracted from the arXiv. This dataset contains both coarse-grained and fine-grained labels; for example it contains labels for the segment of all authors, segments for each individual author, and for the first and last name of each author. There are 660 citations in the development set and 367 citation in the test set.\nThe labels in the UMass dataset are a concatenation of labels from a hierarchically-defined schema. For example, a first name of an author is tagged as: authors/person/first. In addition, individual tokens are labeled using a BIO label schema for each level in the hierarchy. BIO is a commonly used labeling schema for information extraction tasks. BIO labeling allows individual labels on tokens to label segmentation information as well as labels for the segments. In this schema, labels that begin segments are prepended with a B, labels that continue a segment are prepended with an I, and tokens that don\u2019t have a labeling in this schema are given an O label. For example, in a hierarchical BIO label schema the first token in the first name for the second author may be labeled as: I-authors/B-person/B-first.\nAn example labeled citation in this dataset can be viewed in figure 1."}, {"heading": "5 Global Constraints for Citation Extraction", "text": ""}, {"heading": "5.1 Constraint Templates", "text": "We now describe the families of global constraints we consider for citation extraction. Note these constraints are all linear, since they depend only on the counts of each possible conditional random field label. Moreover, since our labels are BIO-encoded, it is possible, by counting B tags, to count how often each citation tag itself appears in a sentence. The first two families of constraints that we describe are general to any sequence labeling task while the last is specific to hierarchical labeling such as available in the UMass dataset.\nOur sequence output is denoted as y and an element of this sequence is yk.\nWe denote [[yk = i]] as the function that outputs 1 if yk has a 1 at index i and 0 otherwise. Here, yk represents an output tag of the CRF, so if [[yk = i]] = 1, then we have that yk was given a label with index i."}, {"heading": "5.2 Singleton Constraints", "text": "Singleton constraints ensure that each label can appear at most once in a citation. These are same global constraints that were used for citation field extraction in Chang et al. (2012). We define s(i) to be the number of times the label with index i is predicted in a citation, formally:\ns(i) = \u2211\nyk\u2208y\n[[yk = i]]\nThe constraint that each label can appear at most once takes the form:\ns(i) <= 1"}, {"heading": "5.3 Pairwise Constraints", "text": "Pairwise constraints are constraints on the counts of two labels in a citation. We define z1(i, j) to be\nz1(i, j) = \u2211\nyk\u2208y\n[[yk = i]] + \u2211\nyk\u2208y\n[[yk = j]]\nand z2(i, j) to be\nz2(i, j) = \u2211\nyk\u2208y\n[[yk = i]]\u2212 \u2211\nyk\u2208y\n[[yk = j]]\nWe consider all constraints of the forms: z(i, j) \u2264 0, 1, 2, 3 and z(i, j) \u2265 0, 1, 2, 3.\nNote that some pairs of these constraints are redundant or logically incompatible. However, we are using them as soft constraints, so these constraints will not necessarily be satisfied by the output of the model, which eliminates concern over enforcing logically impossible outputs. Furthermore, in section 3.1 we described how our procedure for learning penalties will drive some penalties to 0, which effectively removes them from our set of constraints we consider. It can be shown, for example, that we will never learn non-zero penalties for certain pairs of logically incompatible constraints using the perceptron-style algorithm described in section 3.1 ."}, {"heading": "5.4 Hierarchical Equality Constraints", "text": "The labels in the citation dataset are hierarchical labels. This means that the labels are the concatenation of all the levels in the hierarchy. We can create constraints that are dependent on only one or couple of elements in the hierarchy.\nWe define C(x, i) as the function that returns 1 if the output x contains the label i in the hierarchy and 0 otherwise. We define e(i, j) to be\ne(i, j) = \u2211\nyk\u2208y\n[[C(yk, i)]]\u2212 \u2211\nyk\u2208y\n[[C(yk, j)]]\nHierarchical equality constraints take the forms:\ne(i, j) \u2265 0 (8)\ne(i, j) \u2264 0 (9)"}, {"heading": "5.5 Local constraints", "text": "We constrain the output labeling of the chainstructured CRF to be a valid BIO encoding. This both improves performance of the underlying model when used without global constraints, as well as ensures the validity of the global constraints we impose, since they operate only on B labels. The constraint that the labeling is valid BIO can be expressed as a collection of pairwise constraints on adjacent labels in the sequence. Rather than enforcing these constraints using dual decomposition, they can be enforced directly when performing MAP inference in the CRF by modifying the dynamic program of the Viterbi algorithm to only allow valid pairs of adjacent labels."}, {"heading": "5.6 Constraint Pruning", "text": "While the techniques from section 3.1 can easily cope with a large numbers of constraints at training time, this can be computationally costly, specially if one is considering very large constraint families. This is problematic because the size of some constraint families we consider grows quadratically with the number of candidate labels, and there are about 100 in the UMass dataset. Such a family consists of constraints that the sum of the counts of two different label types has to be bounded (a useful example is that there can\u2019t be more than one out of \u201cphd thesis\u201d and \u201cjournal\u201d). Therefore, quickly pruning bad constraints can save a substantial amount of training time, and can lead to better generalization.\nTo do so, we calculate a score that estimates how useful each constraint is expected to be. Our score compares how often the constraint is vio-\nlated in the ground truth examples versus our predictions. Here, prediction is done with respect to the base chain-structured CRF tagger and does not include global constraints. Note that it may make sense to consider a constraint that is sometimes violated in the ground truth, as the penalty learning algorithm can learn a small penalty for it, which will allow it to be violated some of the time. Our importance score is defined as, for each constraint c on labeled set D,\nimp(c) =\n\u2211\nd\u2208D[[maxyw T d y]]c\n\u2211 d\u2208D[[yd]]c , (10)\nwhere [[y]]c is 1 if the constraint is violated on output y and 0 otherwise. Here, yd denotes the ground truth labeling and wd is the vector of scores for the CRF tagger.\nWe prune constraints by picking a cutoff value for imp(c). A value of imp(c) above 1 implies that the constraint is more violated on the predicted examples than on the ground truth, and hence that we might want to keep it.\nWe also find that the constraints that have the largest imp values are semantically interesting."}, {"heading": "6 Related Work", "text": "There are multiple previous examples of augmenting chain-structured sequence models with terms capturing global relationships by expanding the chain to a more complex graphical\nmodel with non-local dependencies between the outputs. Inference in these models can be performed, for example, with loopy belief propagation (Bunescu and Mooney, 2004; Sutton and McCallum, 2004) or Gibbs sampling (Finkel et al., 2005). Belief propagation is prohibitively expensive in our model due to the high cardinalities of the output variables and of the global factors, which involve all output variables simultaneously. There are various methods for exploiting the combinatorial structure of these factors, but performance would still have higher complexity than our method. While Gibbs sampling has been shown to work well tasks such as named entity recognition (Finkel et al., 2005), our previous experiments show that it does not work well for citation extraction, where it found only low-quality solutions in practice because the sampling did not mix well, even on a simple chain-structured CRF.\nRecently, dual decomposition has become a popular method for solving complex structured prediction problems in NLP (Koo et al., 2010; Rush et al., 2010; Rush and Collins, 2012; Paul and Eisner, 2012; Chieu and Teow, 2012). Soft constraints can be implemented inefficiently using hard constraints and dual decomposition\u2014 by introducing copies of output variables and an auxiliary graphical model, as in Rush et al. (2012). However, at every iteration of dual decomposition, MAP must be run in this auxiliary model. Furthermore the copying of variables doubles the number of iterations needed for information to flow between output variables, and thus slows convergence. On the other hand, our approach to soft constraints has identical per-iteration complexity as for hard constraints, and is a very easy modification to existing hard constraint code.\nInitial work in machine learning for citation extraction used Markov models with no global constraints. Hidden Markov models (HMMs), were originally employed for automatically extracting information from research papers on the CORA dataset (Seymore et al., 1999; Hetzner, 2008). Later, CRFs were shown to perform better on CORA, improving the results from the Hmm\u2019s token-level F1 of 86.6 to 91.5 with a CRF(Peng and McCallum, 2004).\nRecent work on globally-constrained inference in citation extraction used an HMMCCM , which\nis an HMM with the addition of global features that are restricted to have positive weights (Chang et al., 2012). Approximate inference is performed using beam search. This method increased the HMM token-level accuracy from 86.69 to 93.92 on a test set of 100 citations from the CORA dataset. The global constraints added into the model are simply that each label only occurs once per citation. This approach is limited in its use of an HMM as an underlying model, as it has been shown that CRFs perform significantly better, achieving 95.37 token-level accuracy on CORA (Peng and McCallum, 2004). In our experiments, we demonstrate that the specific global constraints used by Chang et al. (2012) help on the UMass dataset as well."}, {"heading": "7 Experimental Results", "text": "Our baseline is the one used in Anzaroot and McCallum (2013), with some labeling errors removed. This is a chain-structured CRF trained to maximize the conditional likelihood using LBFGS with L2 regularization.\nWe use the same features as Anzaroot and McCallum (2013), which include word type, capitalization, binned location in citation, regular expression matches, and matches into lexicons. In addition, we use a rule-based segmenter that segments the citation string based on punctuation as well as probable start or end segment words (e.g. \u2018in\u2019 and \u2018volume\u2019). We add a binary feature to tokens that correspond to the start of a segment in the output of this simple segmenter. This final feature improves the F1 score on the cleaned test set from 94.0 F1 to 94.44 F1, which we use as a baseline score.\nWe then use the development set to learn the penalties for the soft constraints, using the perceptron algorithm described in section 3.1. MAP inference in the model with soft constraints is performed using Soft-DD, shown in Algorithm 2.\nWe instantiate constraints from each template in section 5.1, iterating over all possible labels that contain a B prefix at any level in the hierarchy and pruning all constraints with imp(c) < 2.75 calculated on the development set. We asses performance in terms of field-level F1 score, which is the harmonic mean of precision and recall for predicted segments.\nTable 1 shows how each type of constraint family improved the F1 score on the dataset. Learning\nall the constraints jointly provides the largest improvement in F1 at 95.39. This improvement in F1 over the baseline CRF as well as the improvement in F1 over using only-one constraints was shown to be statistically significant using the Wilcoxon signed rank test with p-values < 0.05. In the all-constraints settings, 32.96% of the constraints have a learned parameter of 0, and therefore only 421 constraints are active. Soft-DD converges, and thus solves the constrained inference problem exactly, for all test set examples after at most 41 iterations. Running Soft-DD to convergence requires 1.83 iterations on average per example. Since performing inference in the CRF is by far the most computationally intensive step in the iterative algorithm, this means our procedure requires approximately twice as much work as running the baseline CRF on the dataset. On examples where unconstrained inference does not satisfy the constraints, Soft-DD converges after 4.52 iterations on average. For 11.99% of the examples, the Soft-DD algorithm satisfies constraints that were not satisfied during unconstrained inference, while in the remaining 11.72% Soft-DD converges with some constraints left unsatisfied, which is possible since we are imposing them as soft constraints.\nWe could have enforced these constraints as hard constraints rather than soft ones. This experiment is shown in the last row of Table 1, where F1 only improves to 94.6. In addition, running the DD algorithm with these constraints takes 5.21 iterations on average per example, which is 2.8 times slower than Soft-DD with learned penalties.\nIn Figure 2, we analyze the performance of Soft-DD when we don\u2019t necessarily run it to convergence, but stop after a fixed number of iterations on each test set example. We find that a large portion of our gain in accuracy can be obtained when we allow ourselves as few as 2 dual decomposition iterations. However, this only amounts to 1.24 times as much work as running the baseline CRF on the dataset, since the constraints are satisfied immediately for many examples.\nIn Figure 2 we consider two applications of our Soft-DD algorithm, and provide analysis in the caption.\nWe train and evaluate on the UMass dataset instead of CORA, because it is significantly larger, has a useful finer-grained labeling schema, and its annotation is more consistent. We were able to obtain better performance on CORA using our base-\nline CRF than the HMMCCM results presented in Chang et al. (2012), which include soft constraints. Given this high performance of our base model on CORA, we did not apply our Soft-DD algorithm to the dataset. Furthermore, since the dataset is so small, learning the penalties for our large collection of constraints is difficult, and test set results are unreliable. Rather than compare our work to Chang et al. (2012) via results on CORA, we apply their constraints on the UMass data using Soft-DD and demonstrate accuracy gains, as discussed above."}, {"heading": "7.1 Examples of learned constraints", "text": "We now describe a number of the useful constraints that receive non-zero learned penalties and have high importance scores, defined in Section 5.6. The importance score of a constraint provides information about how often it is violated by the CRF, but holds in the ground truth, and a non-zero penalty implies we enforce it as a soft constraint at test time.\nThe two singleton constraints with highest importance score are that there should only be at most one title segment in a citation and that there should be at most one author segment in a citation. The only one author constraint is particularly useful for correctly labeling editor segments in cases where unconstrained inference mislabels them as author segments. As can be seen in Table 3, editor fields are among the most improved with our new method, largely due to this constraint.\nThe two hierarchical constraints with the highest importance scores with non-zero learned penalties constrain the output such that number of person segments does not exceed the number of first segments and vice-versa. Together, these constraints penalize outputs in which the number of person segments do not equal the number of\nfirst segments, i.e., every author should have a first name.\nOne important pairwise constraint penalizes outputs in which thesis segments don\u2019t co-occur with school segments. School segments label the name of the university that the thesis was submitted to. The application of this constraint increases the performance of the model on school segments dramatically, as can be seen in table 3.\nAn interesting form of pairwise constraints penalize outputs in which some labels do not cooccur with other labels. Some examples of constraints in this form enforce that journal segments should co-occur with pages segments and that booktitle segments should co-occur with address segments. An example of the latter constraint being employed during inference is the first example in Figure 2. Here, the constrained inference penalizes output which contains a booktitle segment but no address segment. This penalization leads allows the constrained inference to correctly label the booktitle segment as a title segment.\nThe above example constraints are almost always satisfied on the ground truth, and would be useful to enforce as hard constraints. However, there are a number of learned constraints that are often violated on the ground truth but are still useful as soft constraints. Take, for example, the constraint that the number of number segments does not exceed the number of booktitle segments, as well as the constraint that it does not exceed the number of journal segments. These constraints are moderately violated on ground truth examples, however. For example, when booktitle segments co-occur with number segments but not with journal segments, the second constraint is violated. It is still useful to impose these soft constraints, as strong evidence from the CRF allows us to violate them, and they can guide the model to good predictions when the CRF is unconfident."}, {"heading": "8 Conclusion", "text": "We introduce a novel modification to the standard projected subgradient dual decomposition algorithm for performing MAP inference subject to hard constraints to one for performing MAP in the presence of soft constraints. In addition, we offer an easy-to-implement procedure for learning the penalties on soft constraints. This method drives many penalties to zero, which allows users to automatically discover discriminative constraints from large families of candidates.\nWe show via experiments on a recent substantial dataset that using soft constraints, and selecting which constraints to use with our penalty-learning procedure, can lead to significant gains in accuracy. We achieve a 17% gain in accuracy over a chain-structured CRF model, while only needing to run MAP in the CRF an average of less than 2 times per example. This minor incremental cost over Viterbi, plus the fact that we obtain certificates of optimality on 100% of our test examples in practice, suggests the usefulness of our algorithm for large-scale applications. We encourage further use of our Soft-DD procedure for other structured prediction problems."}, {"heading": "Acknowledgments", "text": "This work was supported in part by the Center for Intelligent Information Retrieval, in part by DARPA under agreement number FA8750-132-0020, in part by NSF grant #CNS-0958392, and in part by IARPA via DoI/NBC contract #D11PC20152. The U.S. Government is authorized to reproduce and distribute reprint for Governmental purposes notwithstanding any copyright annotation thereon. Any opinions, findings and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect those of the sponsor."}], "references": [{"title": "A new dataset for finegrained citation field extraction", "author": ["Anzaroot", "McCallum2013] Sam Anzaroot", "Andrew McCallum"], "venue": "In ICML Workshop on Peer Reviewing and Publishing Models", "citeRegEx": "Anzaroot et al\\.,? \\Q2013\\E", "shortCiteRegEx": "Anzaroot et al\\.", "year": 2013}, {"title": "Collective information", "author": ["Bunescu", "Mooney2004] Razvan Bunescu", "Raymond J Mooney"], "venue": null, "citeRegEx": "Bunescu et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Bunescu et al\\.", "year": 2004}, {"title": "Structured learning with constrained conditional models", "author": ["Chang et al.2012] M. Chang", "L. Ratinov", "D. Roth"], "venue": "Machine Learning,", "citeRegEx": "Chang et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Chang et al\\.", "year": 2012}, {"title": "Combining local and non-local information with dual decomposition for named entity recognition from text", "author": ["Chieu", "Teow2012] Hai Leong Chieu", "Loo-Nin Teow"], "venue": "In Information Fusion (FUSION),", "citeRegEx": "Chieu et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Chieu et al\\.", "year": 2012}, {"title": "Discriminative training methods for hidden markov models: Theory and experiments with perceptron algorithms", "author": ["Michael Collins"], "venue": "In Proceedings of the ACL-02 conference on Empirical methods in natural language processing-Volume", "citeRegEx": "Collins.,? \\Q2002\\E", "shortCiteRegEx": "Collins.", "year": 2002}, {"title": "Incorporating non-local information into information extraction systems by gibbs sampling", "author": ["Trond Grenager", "Christopher Manning"], "venue": "In Proceedings of the 43rd Annual Meeting on Association", "citeRegEx": "Finkel et al\\.,? \\Q2005\\E", "shortCiteRegEx": "Finkel et al\\.", "year": 2005}, {"title": "Probabilistic graphical models: principles and techniques", "author": ["Koller", "Friedman2009] Daphne Koller", "Nir Friedman"], "venue": null, "citeRegEx": "Koller et al\\.,? \\Q2009\\E", "shortCiteRegEx": "Koller et al\\.", "year": 2009}, {"title": "Mrf optimization via dual decomposition: Message-passing revisited", "author": ["Nikos Paragios", "Georgios Tziritas"], "venue": "In Computer Vision,", "citeRegEx": "Komodakis et al\\.,? \\Q2007\\E", "shortCiteRegEx": "Komodakis et al\\.", "year": 2007}, {"title": "Dual decomposition for parsing with non-projective head automata", "author": ["Koo et al.2010] Terry Koo", "Alexander M Rush", "Michael Collins", "Tommi Jaakkola", "David Sontag"], "venue": "In Proceedings of the 2010 Conference on Empirical Methods", "citeRegEx": "Koo et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Koo et al\\.", "year": 2010}, {"title": "Implicitly intersecting weighted automata using dual decomposition", "author": ["Paul", "Eisner2012] Michael J Paul", "Jason Eisner"], "venue": "In Proceedings of the 2012 Conference of the North American Chapter of the Association", "citeRegEx": "Paul et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Paul et al\\.", "year": 2012}, {"title": "Accurate information extraction from research papers using conditional random fields", "author": ["Peng", "McCallum2004] Fuchun Peng", "Andrew McCallum"], "venue": null, "citeRegEx": "Peng et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Peng et al\\.", "year": 2004}, {"title": "A linear programming formulation for global inference in natural language", "author": ["Roth", "Yih2004] Dan Roth", "Wen-tau Yih"], "venue": null, "citeRegEx": "Roth et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Roth et al\\.", "year": 2004}, {"title": "A tutorial on dual decomposition and lagrangian relaxation for inference in natural language processing", "author": ["Rush", "Collins2012] Alexander M. Rush", "Michael Collins"], "venue": "J. Artif. Intell. Res. (JAIR),", "citeRegEx": "Rush et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Rush et al\\.", "year": 2012}, {"title": "On dual decomposition and linear programming relaxations for natural language processing", "author": ["David Sontag", "Michael Collins", "Tommi Jaakkola"], "venue": "In Proceedings of the 2010 Conference on Empirical Methods", "citeRegEx": "Rush et al\\.,? \\Q2010\\E", "shortCiteRegEx": "Rush et al\\.", "year": 2010}, {"title": "Improved parsing and pos tagging using inter-sentence consistency constraints", "author": ["Roi Reichart", "Michael Collins", "Amir Globerson"], "venue": "In Proceedings of the 2012 Joint Conference on Empirical Methods in Natural", "citeRegEx": "Rush et al\\.,? \\Q2012\\E", "shortCiteRegEx": "Rush et al\\.", "year": 2012}, {"title": "Learning hidden markov model structure for information extraction", "author": ["Andrew McCallum", "Roni Rosenfeld"], "venue": "Workshop on Machine Learning for Information Extraction,", "citeRegEx": "Seymore et al\\.,? \\Q1999\\E", "shortCiteRegEx": "Seymore et al\\.", "year": 1999}, {"title": "Introduction to dual decomposition for inference", "author": ["Sontag et al.2011] David Sontag", "Amir Globerson", "Tommi Jaakkola"], "venue": null, "citeRegEx": "Sontag et al\\.,? \\Q2011\\E", "shortCiteRegEx": "Sontag et al\\.", "year": 2011}, {"title": "Approximate Inference in Graphical Models using LP Relaxations", "author": ["David Sontag"], "venue": "Ph.D. thesis,", "citeRegEx": "Sontag.,? \\Q2010\\E", "shortCiteRegEx": "Sontag.", "year": 2010}, {"title": "Collective segmentation and labeling of distant entities in information extraction", "author": ["Sutton", "McCallum2004] Charles Sutton", "Andrew McCallum"], "venue": null, "citeRegEx": "Sutton et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Sutton et al\\.", "year": 2004}, {"title": "Support vector machine learning for interdependent and structured output spaces", "author": ["Thomas Hofmann", "Thorsten Joachims", "Yasemin Altun"], "venue": null, "citeRegEx": "Tsochantaridis et al\\.,? \\Q2004\\E", "shortCiteRegEx": "Tsochantaridis et al\\.", "year": 2004}], "referenceMentions": [{"referenceID": 13, "context": "Alternatively, one can employ dual decomposition (Rush et al., 2010).", "startOffset": 49, "endOffset": 68}, {"referenceID": 2, "context": "strated improvements in citation field extraction by imposing soft constraints (Chang et al., 2012).", "startOffset": 79, "endOffset": 99}, {"referenceID": 2, "context": "Using our new method, we are able to incorporate not only all the soft global constraints of Chang et al. (2012), but also far more complex data-driven constraints, while also providing stronger optimality certificates than their beam search technique.", "startOffset": 93, "endOffset": 113}, {"referenceID": 2, "context": "Using our new method, we are able to incorporate not only all the soft global constraints of Chang et al. (2012), but also far more complex data-driven constraints, while also providing stronger optimality certificates than their beam search technique. On a new, more broadly representative, and challenging citation field extraction data set, we show that our methods achieve a 17.9% reduction in error versus a linear-chain conditional random field. Furthermore, we demonstrate that our inference technique can use and benefit from the constraints of Chang et al. (2012), but that including our data-driven constraints on top of these is beneficial.", "startOffset": 93, "endOffset": 573}, {"referenceID": 17, "context": "The MAP inference task in a CRF be can expressed as an optimization problem with a linear objective (Sontag, 2010; Sontag et al., 2011).", "startOffset": 100, "endOffset": 135}, {"referenceID": 16, "context": "The MAP inference task in a CRF be can expressed as an optimization problem with a linear objective (Sontag, 2010; Sontag et al., 2011).", "startOffset": 100, "endOffset": 135}, {"referenceID": 7, "context": "Dual Decomposition is a popular method for performing MAP inference in this scenario, since it leverages known algorithms for MAP in the base problem where these extra constraints have not been added (Komodakis et al., 2007; Sontag et al., 2011; Rush and Collins, 2012).", "startOffset": 200, "endOffset": 269}, {"referenceID": 16, "context": "Dual Decomposition is a popular method for performing MAP inference in this scenario, since it leverages known algorithms for MAP in the base problem where these extra constraints have not been added (Komodakis et al., 2007; Sontag et al., 2011; Rush and Collins, 2012).", "startOffset": 200, "endOffset": 269}, {"referenceID": 4, "context": "All we need to employ the structured perceptron algorithm (Collins, 2002) or the structured SVM algorithm (Tsochantaridis et al.", "startOffset": 58, "endOffset": 73}, {"referenceID": 19, "context": "All we need to employ the structured perceptron algorithm (Collins, 2002) or the structured SVM algorithm (Tsochantaridis et al., 2004) is a blackbox procedure for performing MAP inference in the structured linear model given an arbitrary cost vector.", "startOffset": 106, "endOffset": 135}, {"referenceID": 2, "context": "These are same global constraints that were used for citation field extraction in Chang et al. (2012). We define s(i) to be the number of times the label with index i is predicted in a citation, formally:", "startOffset": 82, "endOffset": 102}, {"referenceID": 5, "context": "Inference in these models can be performed, for example, with loopy belief propagation (Bunescu and Mooney, 2004; Sutton and McCallum, 2004) or Gibbs sampling (Finkel et al., 2005).", "startOffset": 159, "endOffset": 180}, {"referenceID": 5, "context": "While Gibbs sampling has been shown to work well tasks such as named entity recognition (Finkel et al., 2005), our previous experiments show that it does not work well for citation extraction, where it found only low-quality solutions in practice because the sampling did not mix well, even on a simple chain-structured CRF.", "startOffset": 88, "endOffset": 109}, {"referenceID": 8, "context": "Recently, dual decomposition has become a popular method for solving complex structured prediction problems in NLP (Koo et al., 2010; Rush et al., 2010; Rush and Collins, 2012; Paul and Eisner, 2012; Chieu and Teow, 2012).", "startOffset": 115, "endOffset": 221}, {"referenceID": 13, "context": "Recently, dual decomposition has become a popular method for solving complex structured prediction problems in NLP (Koo et al., 2010; Rush et al., 2010; Rush and Collins, 2012; Paul and Eisner, 2012; Chieu and Teow, 2012).", "startOffset": 115, "endOffset": 221}, {"referenceID": 4, "context": ", 2010; Rush and Collins, 2012; Paul and Eisner, 2012; Chieu and Teow, 2012). Soft constraints can be implemented inefficiently using hard constraints and dual decomposition\u2014 by introducing copies of output variables and an auxiliary graphical model, as in Rush et al. (2012). However, at every iteration of dual decomposition, MAP must be run in this auxiliary model.", "startOffset": 17, "endOffset": 276}, {"referenceID": 15, "context": "Hidden Markov models (HMMs), were originally employed for automatically extracting information from research papers on the CORA dataset (Seymore et al., 1999; Hetzner, 2008).", "startOffset": 136, "endOffset": 173}, {"referenceID": 2, "context": "Recent work on globally-constrained inference in citation extraction used an HMM , which is an HMM with the addition of global features that are restricted to have positive weights (Chang et al., 2012).", "startOffset": 181, "endOffset": 201}, {"referenceID": 2, "context": "Recent work on globally-constrained inference in citation extraction used an HMM , which is an HMM with the addition of global features that are restricted to have positive weights (Chang et al., 2012). Approximate inference is performed using beam search. This method increased the HMM token-level accuracy from 86.69 to 93.92 on a test set of 100 citations from the CORA dataset. The global constraints added into the model are simply that each label only occurs once per citation. This approach is limited in its use of an HMM as an underlying model, as it has been shown that CRFs perform significantly better, achieving 95.37 token-level accuracy on CORA (Peng and McCallum, 2004). In our experiments, we demonstrate that the specific global constraints used by Chang et al. (2012) help on the UMass dataset as well.", "startOffset": 182, "endOffset": 787}, {"referenceID": 2, "context": "line CRF than the HMM results presented in Chang et al. (2012), which include soft constraints.", "startOffset": 43, "endOffset": 63}, {"referenceID": 2, "context": "line CRF than the HMM results presented in Chang et al. (2012), which include soft constraints. Given this high performance of our base model on CORA, we did not apply our Soft-DD algorithm to the dataset. Furthermore, since the dataset is so small, learning the penalties for our large collection of constraints is difficult, and test set results are unreliable. Rather than compare our work to Chang et al. (2012) via results on CORA, we apply their constraints on the UMass data using Soft-DD and demonstrate accuracy gains, as discussed above.", "startOffset": 43, "endOffset": 416}], "year": 2014, "abstractText": "Accurately segmenting a citation string into fields for authors, titles, etc. is a challenging task because the output typically obeys various global constraints. Previous work has shown that modeling soft constraints, where the model is encouraged, but not require to obey the constraints, can substantially improve segmentation performance. On the other hand, for imposing hard constraints, dual decomposition is a popular technique for efficient prediction given existing algorithms for unconstrained inference. We extend dual decomposition to perform prediction subject to soft constraints. Moreover, with a technique for performing inference given soft constraints, it is easy to automatically generate large families of constraints and learn their costs with a simple convex optimization problem during training. This allows us to obtain substantial gains in accuracy on a new, challenging citation extraction dataset.", "creator": "LaTeX with hyperref package"}}}